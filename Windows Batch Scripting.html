<base target="_blank"><html><head><title>Windows Batch Scripting</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script src="https://williamkpchan.github.io/lazyload.min.js"></script>
<script src='https://williamkpchan.github.io/mainscript.js'></script>
<script src="https://williamkpchan.github.io/commonfunctions.js"></script>
<script>
  var showTopicNumber = true;
  var topicEnd = "<br>";
  var bookid = "Windows Batch Scripting"
  var markerName = "h2"
</script>
<style>
body{width:80%;margin-left: 10%; font-size:24px;}
h1, h2 {color: gold;}
strong {color: orange;}
img {max-width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%; border-radius:3px;}
</style></head><body onkeypress="chkKey()"><center>
<h1>Windows Batch Scripting</h1>
<a href="#mustWatch" class="red goldbs" target="_self">Must Watch!</a><br><br>
<div id="toc"></div></center><br><br>
<div id="mustWatch"><center><span class="red">MustWatch</span></center>
<a href="LibDocs\batchTips.html" class="whitebut ">batchTips</a>

<br></div>
<pre><br><br>

<h2><span class="orange">Introduction</span></h2>
This book addresses 32-bit Windows commands applicable to modern versions of Windows based on the Windows NT environment. 
It does not address commands that are specific to DOS environments and to DOS-based operating systems, such as Windows 95, Windows 98, and Windows Me, whose Microsoft-supplied command interpreters are in fact DOS programs, not Win32 programs.
You can find out which version of cmd.exe you are running using the <a href="#VER">VER</a> command.
This book first describes using the Windows NT command interpreter, how it receives, parses, and processes commands from users. 
Then it describes various commands available.
To obtain an extensive list of Windows commands and their short summaries, open the command prompt on any Windows computer, and type <b class="bord"><tt>help</tt></b>. 
To find out about a particular command, type the name of the command followed by "/?".
The subject of this book is also known as "batch programming", even though "batch" refers not only to batch files for MS DOS and Windows command interpreter. 
Other subject terms include "batch file programming", "batch file scripting", "Windows batch command", "Windows batch file", "Windows command line", "Windows command prompt", and "Windows shell scripting".
<h2><span class="orange">Using the Windows command interpreter</span></h2>
<h2>How a command line is interpreted</h2>
The parsing of a command line into a sequence of commands is complex, and varies subtly from command interpreter to command interpreter. 
There are, however, four main components:
<dl>
<dt>Variable substitution</dt>
<dd>A command line is scanned for variable specifications, and any found are replaced with the contents of those variables.</dd>
<dt>Quoting</dt>
<dd>Special characters can be quoted, to remove their special meanings.</dd>
<dt>Syntax</dt>
<dd>Command lines are developed into a sequence of commands according to a syntax.</dd>
<dt>Redirection</dt>
<dd>Redirection specifications are applied, and removed from the command line, before an individual command in a sequence is executed.</dd>
</dl>
<h4><span id="Variable_substitution">Variable substitution</span></h4>
Command lines can contain <b id="limeword">variable specifications</b>. 
These comprise a <b id="limeword"><tt>%</tt> character followed by a name. 
The name is ended by a second <tt>%</tt></b> character, except in special cases such as the batch file parameters <tt>%1</tt>, <tt>%2</tt>, and so forth.
Variable specifications are replaced with values. 
The value used to replace a variable specification is as follows:
<li>For variable specification names that match the names of environment variables, the replacement is the value of the named environment variable. 
For example: <tt>%PATH%</tt> is replaced by the value of the PATH environment variable.</li><li>For variable specifications that name batch file parameters (i.e. 
that are non-negative decimal numbers), the replacement is the value of the parameter taken from the arguments with which the batch file was invoked (subject to any subsequent modifications by the <b>SHIFT</b> command). 
For example: <tt>%2</tt> is replaced by the value of the second batch file parameter.</li>

<h5><span id="Special_names">Special names</span></h5>
Some variable names are not visible using <a href="#SET">SET</a> command. 
Rather, they are made available for reading using the% notation. 
To find out about them, type "help set".
<b id="limeword">Special variable names</b> and what they expand to:
<table>
<tr>
<th>Name</th>
<th>Replacement Value Used</th>
</tr>
<tr>
<td>%CD%</td>
<td>The current directory, not ending in a slash character if it is not in the root directory of the current drive</td>
</tr>
<tr>
<td>%TIME%</td>
<td>The system time in HH:MM:SS.mm format.</td>
</tr>
<tr>
<td>%DATE%</td>
<td>The system date in a format specific to localization.</td>
</tr>
<tr>
<td>%RANDOM%</td>
<td>A generated pseudo-random number between 0 and 32767.</td>
</tr>
<tr>
<td>%ERRORLEVEL%</td>
<td>The error level returned by the last executed command, or by the last called batch script.</td>
</tr>
<tr>
<td>%CMDEXTVERSION%</td>
<td>The version number of the Command Processor Extensions currently used by cmd.exe.</td>
</tr>
<tr>
<td>%CMDCMDLINE%</td>
<td>The content of the command line used when the current cmd.exe was started.</td>
</tr>
</table>


<h4><span id="Quoting_and_escaping">Quoting and escaping</span></h4>
You can prevent the special characters that control command syntax from having their special meanings as follows, except for the percent sign (%):
<li>You can <b id="limeword">surround a string containing a special character by quotation marks</b>.</li><li>You can <b id="limeword">place caret (^), an escape character, immediately before the special characters. 
In a command located after a pipe (|), you need to use three carets (^^^) for this to work.</b></li>

The special characters that need quoting or escaping are usually &lt;, &gt;, |, &amp;, and ^. 
In some circumstances,! and \ may need to be escaped. 
A newline can be escaped using caret as well.
When you surround the string using quotation marks, they become part of the argument passed to the command invoked. 
By contrast, when you use caret as an escape character, the caret does not become part of the argument passed.
The percent sign (%) is a special case. 
On the command line, it does not need quoting or escaping unless two of them are used to indicate a variable, such as%OS%. 
<b id="redword">But in a batch file, you have to use a double percent sign (%%) to yield a single percent sign (%)</b>. 
Enclosing the percent sign in quotation marks or preceding it with caret does not work.
Examples
<li>echo "Johnson &amp; son"
<li>Echoes the complete string rather than splitting the command line at the &amp; character. 
Quotes are echoed as well</li></li><li>echo Johnson ^&amp; son
<li>As above, but using caret before the special character ampersand. 
No quotes are echoed.</li></li><li>echo Johnson &amp; son
<li>Does not use an escape character and therefore, "son" is interpreted as a separate command, usually leading to an error message that command son is not found.</li></li><li>echo A ^^ B
<li>Echoes A ^ B. 
Caret needs escaping as well or else it is interpreted as escaping a space.</li></li><li>if 1 equ 1 ^<br />
echo Equal &amp;^<br />
echo Indeed, equal
<li>Echoes the two strings. 
The caret at the end of the line escapes the newlines, leading to the three lines being treated as if they were a single line. 
The space before the first caret is necessary or else 1 gets joined with the following echo to yield 1echo.</li></li><li>attrib File^ 1.txt
<li>Does not shows attributes of file named "File 1.txt" since escaping of space does not work. 
Using quotes, as in attrib "File 1.txt", works.</li></li><li>echo The ratio was 47%.
<li>If run from a batch, the percent sign is ignored.</li></li><li>echo The ratio was 47%%.
<li>If run from a batch, the percent sign is output once.</li></li><li>set /a modulo=14%%3
<li>If run from a batch, sets modulo variable to 2, the remainder of dividing 14 by 3. 
Does not work with single%.</li></li><li>for %%i in (1,2,3) do echo %%i
<li>If run from a batch, outputs 1, 2 and 3.</li></li><li>echo %temp%
<li>Outputs the content of temp variable even if run from a batch file. 
Use of the percent sign in a batch to access environment variables and passed arguments needs no escaping.</li></li><li>echo //comment line | findstr \//
<li>Command <a href="#FINDSTR">FINDSTR</a> uses backslash (\) for espacing. 
Unlike caret, this is internal to the command and unknown to the command shell.</li></li>



<h4><span id="Syntax">Syntax</span></h4>
Command lines are developed into a sequence of commands according to a syntax. 
In that syntax, <i>simple commands</i> may be combined to form <i>pipelines</i>, which may in turn be combined to form <i>compound commands</i>, which finally may be turned into <i>parenthesized commands</i>.
A simple command is just a command name, a command tail, and some redirection specifications. 
An example of a simple command is <tt>dir *.txt &gt; somefile</tt>.
A pipeline is several simple commands joined together with the "pipe" metacharacterâ€”"|", also known as the "vertical bar". 
The standard output of the simple command preceding each vertical bar is connected to the standard input of the simple command following it, via a pipe. 
The command interpreter runs all of the simple commands in the pipeline in parallel. 
An example of a pipeline (comprising two simple commands) is <tt>dir *.txt | more</tt>.
A compound command is a set of pipelines separated by conjunctions. 
The pipelines are executed sequentially, one after the other, and the conjunction controls whether the command interpreter executes the next pipeline or not. 
An example of a compound command (comprising two pipelines, which themselves are just simple commands) is <tt>move file.txt file.bak &amp;&amp; dir &gt; file.txt</tt>.
The conjunctions:
<li><b>&amp;</b> - An unconditional conjunction. 
The next pipeline is always executed after the current one has completed executing.</li><li><b>&amp;&amp;</b> - A positive conditional conjunction. 
The next pipeline is executed if the current one completes executing with a zero exit status.</li><li><b>||</b> - A negative conditional conjunction. 
The next pipeline is executed if the current one completes executing with a non-zero exit status.</li>

A parenthesized command is a compound command enclosed in parentheses (i.e. 
<tt>(</tt> and <tt>)</tt>). 
From the point of view of syntax, this turns a compound command into a simple command, whose overall output can be redirected.
For example: The command line <tt>( pushd temp &amp; dir &amp; popd ) &gt; somefile</tt> causes the standard output of the entire compound command <tt>( pushd temp &amp; dir &amp; popd )</tt> to be redirected to <i>somefile</i>.


<h4><span id="Redirection">Redirection</span></h4>
Redirection specifications are applied, and removed from the command line, before an individual command in a sequence is executed. 
Redirection specifications control where the standard input, standard output, and standard error file handles for a simple command point. 
They override any effects to those file handles that may have resulted from pipelining. 
(See the preceding section on command syntax.) Redirection signs &gt; and &gt;&gt; can be prefixed with 1 for the standard output (same as no prefix) or 2 for the standard error.
The redirection specifications are:
<dl>
<dt><tt>&lt; filename</tt></dt>
<dd>Redirect standard input to read from the named file.</dd>
<dt><tt>&gt; filename</tt></dt>
<dd>Redirect standard output to write to the named file, overwriting its previous contents.</dd>
<dt><tt>&gt;&gt; filename</tt></dt>
<dd>Redirect standard output to write to the named file, appending to the end of its previous contents.</dd>
<dt><tt>&gt;&amp;<i>h</i></tt></dt>
<dd>Redirect to handle <i>h</i>, where handle is any of 0â€”standard input, 1â€”standard output, 2â€”standard error, and more.</dd>
<dt><tt>&lt;&amp;<i>h</i></tt></dt>
<dd>Redirect from handle <i>h</i>.</dd>
</dl>
Examples:
<li>dir *.txt &gt;listing.log
<li>Redirects the output of the dir command to listing.log file.</li></li><li>dir *.txt &gt; listing.log
<li>As above; the space before the file name makes no difference. 
However, if you type this into the command window, auto-completion with tab after typing "&gt; l" actually works, while it does not work with "&gt;listing.log".</li></li><li>dir *.txt 2&gt;NUL
<li>Redirects errors of the dir command to nowhere.</li></li><li>dir *.txt &gt;&gt;listing.log
<li>Redirects the output of the dir command to listing.log file, appending to the file. 
Thereby, the content of the file before the redirected command was executed does not get lost.</li></li><li>dir *.txt &gt;listing.log 2&gt;&amp;1
<li>Redirects the output of the dir command to listing.log file, along with the error messages.</li></li><li>dir *.txt &gt;listing.log 2&gt;listing-errors.log
<li>Redirects the output of the dir command to listing.log file, and the error messages to listing-errors.log file.</li></li><li>&gt;myfile.txt echo Hello
<li>The redirection can precede the command.</li></li><li>echo Hello &amp; echo World &gt;myfile.txt
<li>Only the 2nd echo gets redirected.</li></li><li>(echo Hello &amp; echo World) &gt;myfile.txt
<li>Output of both echos gets redirected.</li></li><li>type con &gt;myfile.txt
<li>Redirects console input (con) to the file. 
Thus, allows multi-line user input terminated by user pressing Control + Z. 
See also <a href="#User_input">#User input</a>.</li></li><li>(for %i in (1,2,3) do @echo %i) &gt; myfile.txt
<li>Redirects the entire output of the loop to the file.</li></li><li>for %i in (1,2,3) do @echo %i &gt; myfile.txt
<li>Starts redirection anew each time the body of the loop is entered, losing the output of all but the latest loop iteration.</li></li>



<h2>How a command is executed</h2>
(...)
<h2>Batch reloading</h2>
The command interpreter reloads the content of a batch after each execution of a line or a bracketed group.
If you start the following batch and change "echo A" to "echo B" in the batch shortly after starting it, the output will be B.

@echo off
ping -n 6 127.0.0.1 &gt;nul &amp; REM wait
echo A

What is on a single line does matter; changing "echo A" in the following batch after running it has no impact:

@echo off
ping -n 6 127.0.0.1 &gt;nul &amp; echo A

Nor have after-start changes have any impact on commands bracketed with ( and ). 
Thus, changing "echo A" after starting the following batch has no impact:

@echo off
for /L %%i in (1,1,10) do (
  echo A
  ping -n 2 127.0.0.1 &gt;nul &amp; REM wait
)

Ditto for any other enclosing, including this one:

@echo off
(
ping -n 6 127.0.0.1 &gt;nul &amp; REM wait
echo A
)

<h2>Environment variables</h2>
The environment variables of the command interpreter process are inherited by the processes of any (external) commands that it executes. 
A few environment variables are used by the command interpreter itself. 
Changing them changes its operation.
Environment variables are affected by the <a href="#SET">SET</a>, <a href="#PATH">PATH</a>, and <a href="#PROMPT">PROMPT</a> commands.
To unset a variable, set it to empty string, such as "set myvar=".
The command interpreter inherits its initial set of environment variables from the process that created it. 
In the case of command interpreters invoked from desktop shortcuts this will be Windows Explorer, for example.
Command interpreters generally have textual user interfaces, not graphical ones, and so do not recognize the Windows message that informs applications that the environment variable template in the Registry has been changed. 
Changing the environment variables in Control Panel will cause Windows Explorer to update its own environment variables from the template in the Registry, and thus change the environment variables that any <i>subsequently invoked</i> command interpreters will inherit. 
However, it will not cause command interpreters that <i>are already running</i> to update their environment variables from the template in the Registry.
<h4><span id="COMSPEC">COMSPEC</span></h4>
The COMSPEC environment variable contains the full pathname of the command interpreter program file. 
This is just inherited from the parent process, and is thus indirectly derived from the setting of COMSPEC in the environment variable template in the Registry.
<h4><span id="PATH">PATH</span></h4>
The value of the PATH environment variable comprises a list of directory names, separated by semi-colon characters. 
This is the list of directories that are searched, in order, when locating the program file of an external command to execute.
<h4><span id="PATHEXT">PATHEXT</span></h4>
The value of the PATHEXT environment variable comprises a list of filename extensions, separated by semi-colon characters. 
This is the list of filename extensions that are applied, in order, when locating the program file of an external command to execute.
An example content of PATHEXT printed by "echo %PATHEXT%":
<li>.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC</li>

By adding ".PL" to the variable, you can ensure Perl programs get run from the command line even when typed without the ".pl" extension. 
Thus, instead of typing "mydiff.pl a.txt b.txt", you can type "mydiff a.txt b.txt".
Adding ".PL" to the variable in Windows Vista and later:
<li>setx PATHEXT%PATHEXT%;.PL
<li>If you use "set" available in Windows XP, the effect will be temporary and impacting only the current console or process.</li></li>



<h4><span id="PROMPT">PROMPT</span></h4>
The PROMPT environment variable controls the text emitted when the command interpreter displays the prompt. 
The command interpreter displays the prompt when prompting for a new command line in interactive mode, or when echoing a batch file line in batch file mode.
Various special character sequences in the value of the PROMPT environment variable cause various special effects when the prompt is displayed, as in the following table:
<table>
<tr>
<th>Characters</th>
<th>Expansion Result</th>
</tr>
<tr>
<td>$$</td>
<td>$ character itself</td>
</tr>
<tr>
<td>$A</td>
<td>&amp; symbol AKA ampersand. 
A convenience, since it is difficult to place a literal <tt>&amp;</tt> in the value of the PROMPT environment variable using the SET command.</td>
</tr>
<tr>
<td>$B</td>
<td>Vertical bar '|' (pipe symbol)</td>
</tr>
<tr>
<td>$C</td>
<td>Left parenthesis '('</td>
</tr>
<tr>
<td>$D</td>
<td>Current date</td>
</tr>
<tr>
<td>$E</td>
<td>ESC (ASCII code 27)</td>
</tr>
<tr>
<td>$F</td>
<td>Right parenthesis ')'</td>
</tr>
<tr>
<td>$G</td>
<td>Greater-than symbol '&gt;'</td>
</tr>
<tr>
<td>$H</td>
<td>Backspace (deletes previous character)</td>
</tr>
<tr>
<td>$L</td>
<td>Less-than symbol '&lt;'</td>
</tr>
<tr>
<td>$M</td>
<td>Remote name linked to the current drive if it is a network drive; empty string otherwise.</td>
</tr>
<tr>
<td>$N</td>
<td>Current drive letter</td>
</tr>
<tr>
<td>$P</td>
<td>Current drive letter and full path</td>
</tr>
<tr>
<td>$Q</td>
<td>'=' (equals sign)</td>
</tr>
<tr>
<td>$S</td>
<td>' ' (space character)</td>
</tr>
<tr>
<td>$T</td>
<td>Current system time</td>
</tr>
<tr>
<td>$V</td>
<td>Windows version number</td>
</tr>
<tr>
<td>$_</td>
<td>&lt;CR&gt; (carriage return character, aka "enter")</td>
</tr>
<tr>
<td>$+</td>
<td>As many plus signs (+) as there are items on the <a href="#PUSHD">pushd</a> directory stack</td>
</tr>
</table>


<h2>Switches</h2>
Most Windows commands provide switches AKA options to direct their behavior.
Observations:
<li>Switches most often consist of a single-letter; some switches consist of a sequence of multiple letters.</li><li>Switches are preceded with a slash (/) rather than, as in some other operating systems, with a minus sign (-).</li><li>Switches are case-insensitive rather than, as in some other operating systems, case-sensitive.</li><li>If a command from another operating system is ported to Windows (such as grep), it usually retains the option conventions from the original operating system, including the use of minus sign and case-sensitivity.</li>

Examples:
<li>dir /?
<li>Displays the help. 
This option is provided by many commands.</li></li><li>dir /b /s
<li>Lists all files and folders in the current folder recursively. 
Two switches are used: b and s.</li></li><li>dir /bs
<li>Does not work; switches cannot be accumulated behind a single slash.</li></li><li>findstr /ric:"id: *[0-9]*" File.txt
<li>Unlike many other commands, findstr allows the accumulation of switches behind a single slash. 
Indeed, r, i and c are single-letter switches.</li></li><li>dir/b/s
<li>Works. 
In dir, removing whitespace between the command and the first switch or between the switches does not make a difference; thus, does the same as dir /b /s.</li></li><li>tree/f/a
<li>Does not work, unlike tree /f /a. 
In tree, separation by whitespace is mandatory. 
Nor does find/i/v work.</li></li><li>dir /od
<li>The switch letter o is further modified by a single letter specifying that ordering should be by date. 
The letter d is not a switch by itself. 
Similar cases include dir /ad and more /t4.</li></li><li>dir /B /S
<li>The switches are case-insensitive, unlike in some other operating systems.</li></li><li>sort /r file.txt
<li>Sorts the file in a reverse order.</li></li><li>sort /reverse file.txt
<li>Sort allows the switch string to be longer than a single-letter.</li></li><li>sort /reve file.txt
<li>Sort allows the specified switch string to be a substring of the complete long name of the switch. 
Thus, does the same as the above.</li></li><li>sort /reva file.txt
<li>Does not work, since "reva" is not a substring of "reverse".</li></li><li>taskkill /im AcroRd32.exe
<li>Taskkill requires a multiletter switch name for /im; shortening to /i does not work.</li></li><li>java -version
<li>Java, which originated in the environment of another operating system family, uses the minus convention for its switches AKA options.</li></li><li>grep --help
<li>If GNU grep is installed, it requires multi-letter switches to be preceded by two dashes.</li></li>

<h2>Error level</h2>
Commands usually set error level at the end of their execution. 
In Windows NT and later, it is a 32-bit signed integer; in MS DOS, it used to be an integer from 0 to 255. 
Keywords: return code, exit code, exit status.
The conventional meaning of the error level:
<li>0 - success</li><li>not 0 - failure</li><li>The error levels being set are usually positive.</li><li>If the command does not distinguish various kinds of failure, the error level on failure is usually 1.</li>

Uses of the error level:
<li>It can be tested using &amp;&amp; and ||; see also <a href="#Syntax">#Syntax</a>.</li><li>It can be tested using <a href="#IF">IF</a>.</li><li>The value can be accessed from ERRORLEVEL variable.</li>

Examples:
<li>dir &gt;NUL &amp;&amp; echo Success
<li>The part after &amp;&amp; is executed only if the error level is zero.</li></li><li>color 00 || echo Failure
<li>The part after || is executed only if the error level is non-zero, whether positive or negative.</li></li><li>color 00 || (<br />
echo Failure<br />
)
<li>Multiline bracketing works as well.</li></li><li>echo %ERRORLEVEL%
<li>Displays the error level without changing it.</li></li><li>if%errorlevel% equ 0 echo The error level is zero, meaning success.</li><li>if%errorlevel% neq 0 echo The error level is non-zero, meaning failure.</li><li>if errorlevel 1 echo The error level is &gt;= 1, meaning failure via positive error level.
<li>Does not cover failure via negative error level. 
Note the "&gt;=" part: this is not the same as if%errorlevel% equ 1.</li></li><li>exit /b 1
<li>Returns a batch file, setting the error level to 1.</li></li><li>cmd /c "exit /b 10"
<li>In the middle of a batch file or on the command line, sets the error level to 10.</li></li><li>(cmd /c "exit /b 0" &amp;&amp; Echo Success) &amp; (cmd /c "exit /b -1" || Echo Failure)
<li>As above, showing the error level is indeed affected.</li></li><li>(cmd /c "exit /b 0" &amp; cmd /c "exit /b 1") || Echo Failure
<li>The error level of a chain created by &amp; is the error level of the last command of the chain.</li></li><li>cmd /c "exit /b -1" &amp; if not errorlevel 1 echo Would-be success
<li>The "if not errorlevel 1" test, which might appear to test for success, passes on negative numbers: it tests on "not error level &gt;= 1", which is "error level &lt;= 0".</li></li><li>set myerrorlevel=%errorlevel%
<li>Remembers the error level for later.</li></li><li>set errorlevel=0
<li>To be avoided: overshadows the built-in errorlevel variable. 
Ensures that subsequent accesses via%ERRORLEVEL% return 0 rather than the actual error level.</li></li><li>cmd /c "exit /b 0"<br />
if 1 equ 1 ( cmd /c "exit /b 1" &amp; echo %errorlevel% )
<li>Displays 0, since%errorlevel% gets expanded before cmd /c "exit /b 1" gets executed.</li></li>



<h2>String processing</h2>
Getting a substring of a variable by position and length:
Before running the following examples, ensure that%a% equals "abcd" by running this:
<li>set a=abcd</li>

The examples:
<li>echo %a:~0,1%
<li>Result: a</li></li><li>echo %a:~1,1%
<li>Result: b</li></li><li>echo %a:~0,2%
<li>Result: ab</li></li><li>echo %a:~1,2%
<li>Result: bc</li></li><li>echo %a:~1%
<li>Result: bcd</li></li><li>echo %a:~-1%
<li>Result: d</li></li><li>echo %a:~-2%
<li>Result: cd</li></li><li>echo %a:~0,-2%
<li>Result: ab</li></li><li>echo %a:~0,-1%
<li>Result: abc</li></li><li>echo %a:~1,-1%
<li>Result: bc</li></li>

Testing substring containment:
<li>if not "%a:bc=%"=="%a%" echo yes
<li>If variable a contains "bc" as a substring, echo "yes".</li><li>This test is a trick that uses string replacement, discussed below.</li><li>This test does not work if the variable contains a quotation mark.</li></li>

Testing for "starts with":
<li>if%a:~0,1%==a echo yes
<li>If variable a starts with "a", echo "yes".</li></li><li>if%a:~0,2%==ab echo yes
<li>If variable a starts with "ab", echo "yes".</li></li>

String replacement:
<li>set a=abcd &amp; echo %a:c=%
<li>Result: abd</li></li><li>set a=abcd &amp; echo %a:c=e%
<li>Result: abed</li></li><li>set a=abcd &amp; echo %a:*c=%
<li>Result: d</li><li>The asterisk only works at the beginning of the sought pattern; it does not work at the end or in the middle.</li></li>

See also the help for <a href="#SET">SET</a> command: set /?.
Splitting a string by any of " ", ",", and ";": ["space", "comma" and "semicolon":]
<dl>
<dd>set myvar=a b,c;d</dd>
<dd>for %%a in (%myvar%) do echo %%a</dd>
</dl>
Splitting a string by semicolon, assuming the string contains no quotation marks:

@echo off
set myvar=a b;c;d
set strippedvar=%myvar%
:repeat
for /f "delims=;" %%a in ("%strippedvar%") do echo %%a
set prestrippedvar=%strippedvar%
set strippedvar=%strippedvar:*;=%
if not "%prestrippedvar:;=%"=="%prestrippedvar%" goto :repeat

<h2>Command-line arguments</h2>
The command-line arguments AKA command-line parameters passed to a batch script are accessible as%1,%2, ...,%9. 
There can be more than nine arguments; to access them, see how to loop over all of them below.
The syntax%0 does not refer to a command-line argument but rather to the name of the batch file.
Testing for whether the first command-line argument has been provided:


<span class="k">if</span> <span class="k">not</span> -<span class="nv">%1</span>-<span class="o">==</span>-- <span class="k">echo</span> Argument one provided
<span class="k">if</span> -<span class="nv">%1</span>-<span class="o">==</span>-- <span class="k">echo</span> Argument one not provided <span class="p">&amp;</span> <span class="k">exit</span> /b

A robust looping over all command-line arguments using <a href="#SHIFT">SHIFT</a> (for each command-line argument, ...):


<span class="p">:</span><span class="nl">argactionstart</span>
<span class="k">if</span> -<span class="nv">%1</span>-<span class="o">==</span>-- <span class="k">goto</span> <span class="nl">argactionend</span>
<span class="k">echo</span> <span class="nv">%1</span> <span class="p">&amp;</span> <span class="c1">REM Or do any other thing with the argument</span>
<span class="k">shift</span>
<span class="k">goto</span> <span class="nl">argactionstart</span>
<span class="p">:</span><span class="nl">argactionend</span>

A robust looping over all command-line arguments using <a href="#SHIFT">SHIFT</a> without modifying%1,%2, etc.:


<span class="k">call</span> <span class="p">:</span><span class="nl">argactionstart</span> <span class="nv">%*</span>
<span class="k">echo</span> Arg one: <span class="nv">%1</span> <span class="p">&amp;</span> <span class="c1">REM %1, %2, etc. 
are unmodified in this location</span>
<span class="k">exit</span> /b

<span class="p">:</span><span class="nl">argactionstart</span>
<span class="k">if</span> -<span class="nv">%1</span>-<span class="o">==</span>-- <span class="k">goto</span> <span class="nl">argactionend</span>
<span class="k">echo</span> <span class="nv">%1</span> <span class="p">&amp;</span> <span class="c1">REM Or do any other thing with the argument</span>
<span class="k">shift</span>
<span class="k">goto</span> <span class="nl">argactionstart</span>
<span class="p">:</span><span class="nl">argactionend</span>
<span class="k">exit</span> /b

Transferring command-line arguments to environment variables:


<span class="k">setlocal</span> EnableDelayedExpansion
<span class="c1">REM Prevent affecting possible callers of the batch</span>
<span class="c1">REM Without delayed expansion, !arg%argno%! used below won't work.</span>
<span class="k">set</span> <span class="nv">argcount</span><span class="p">=</span>0
<span class="p">:</span><span class="nl">argactionstart</span>
<span class="k">if</span> -<span class="nv">%1</span>-<span class="o">==</span>-- <span class="k">goto</span> <span class="nl">argactionend</span>
<span class="k">set</span> <span class="k">/a</span> <span class="nv">argcount</span><span class="o">+=</span><span class="mi">1</span>
<span class="k">set</span> <span class="nv">arg%argcount%</span><span class="p">=</span><span class="nv">%1</span>
<span class="k">shift</span>
<span class="k">goto</span> <span class="nl">argactionstart</span>
<span class="p">:</span><span class="nl">argactionend</span>

<span class="k">set</span> <span class="nv">argno</span><span class="p">=</span>0
<span class="p">:</span><span class="nl">loopstart</span>
<span class="k">set</span> <span class="k">/a</span> <span class="nv">argno</span><span class="o">+=</span><span class="mi">1</span>
<span class="k">if</span> <span class="nv">%argno%</span> <span class="ow">gtr</span> <span class="nv">%argcount%</span> <span class="k">goto</span> <span class="nl">loopend</span>
<span class="k">echo</span> <span class="nv">!arg%argno%!</span> <span class="p">&amp;</span> <span class="c1">REM Or do any other thing with the argument</span>
<span class="k">goto</span> <span class="nl">loopstart</span>
<span class="p">:</span><span class="nl">loopend</span>

Looping over all command-line arguments, albeit not a robust one:


<span class="k">for</span> <span class="se">%%</span>i <span class="k">in</span> <span class="p">(</span><span class="nv">%*</span><span class="p">)</span> <span class="k">do</span> <span class="p">(</span>
  <span class="k">echo</span> <span class="se">%%</span>i
<span class="p">)</span>

This looks elegant but is non-robust, maltreating arguments containing wildcards (*,?). 
In particular, the above for command replaces arguments that contain wildcards (*,?) with file names that match them, or drops them if no files match. 
Nonetheless, the above loop works as expected as long as the passed arguments do not contain wildcards.
Finding the number of command-line arguments, in a non-robust way:


<span class="k">set</span> <span class="nv">argcount</span><span class="p">=</span>0
<span class="k">for</span> <span class="se">%%</span>i <span class="k">in</span> <span class="p">(</span><span class="nv">%*</span><span class="p">)</span> <span class="k">do</span> <span class="k">set</span> <span class="k">/a</span> <span class="nv">argcount</span><span class="o">+=</span><span class="mi">1</span>

Again, this does not work with arguments containing wildcards.
The maximum possible number of arguments is greater than 4000, as empirically determined on a Windows Vista machine. 
The number can differ on Windows XP and Windows 7.
In passing arguments to a batch script, characters used for argument separation are the following ones:
<li>space</li><li>comma</li><li>semicolon</li><li>equal sign</li><li>tab character</li>

Thus, the following lines pass the same four arguments:
<li>test.bat a b c d</li><li>test.bat a,b,c,d</li><li>test.bat a, b, c, d</li><li>test.bat a;b;c;d</li><li>test.bat a=b=c=d</li><li>test.bat a b,c;,;=d</li>

Yes, even the line with "a b,c;,;=d" passes four arguments, since a sequence of separating characters is considered a single separator.
To have a space, comma or semicolon in the argument value, you can pass the value enclosed in quotation marks. 
However, the quotation marks become part of the argument value. 
To get rid of the enclosing quotation marks when referring to the argument in the script, you can use%~&lt;number&gt; described in <a href="#Percent_tilde">#Percent tilde</a>.


<h2>Wildcards</h2>
Many commands accept file name wildcards--characters that do not stand for themselves and enable matching of a group of filenames.
Wildcards:
<li>* (asterisk): any sequence of characters</li><li>? (question mark): a single character other than a period (".") or, if part of a sequence of question marks at the end of a maximum period-free part of a file name, possibly zero number of characters; see examples for clarification</li>

Examples:
<li>dir *.txt
<li>Matches Myfile.txt, Plan.txt and any other file with the .txt extension.</li></li><li>dir *txt
<li>The period does not need to be included. 
However, this will also match files named without the period convention, such as myfiletxt.</li></li><li>ren *.cxx *.cpp
<li>Renames all files with .cxx extension to have .cpp extension.</li></li><li>dir a?b.txt
<li>Matches files aab.txt, abb.txt, a0b.txt, etc.</li><li>Does not match ab.txt, since a question mark followed by a character other than a question mark or period cannot match zero characters.</li><li>Does not match a.b.txt, since a question mark cannot match a period.</li></li><li>dir???.txt
<li>Matches .txt, a.txt, aa.txt, and aaa.txt, among others, since each question mark in the sequence followed by a period can match zero number of characters.</li></li><li>dir a???.b???.txt???
<li>Matches a.b.txt, among others. 
While the last question mark sequence is not followed by a period, it is still a sequence at the end of a maximum period-free part of a file name.</li></li><li>dir????????.txt &amp; @REM eight question marks
<li>Matches the same files as *.txt, since each file also has a short file name that has no more than 8 characters before .txt.</li></li>

Quirk with short file names: the wildcard matching is performed both on long file names and the usually hidden short 8 chars + period + 3 chars file names. 
This can lead to bad surprises.
Unlike shells of some other operating systems, the cmd.exe shell does not perform wildcard expansion (replacement of the pattern containing wildcards with the list of file names matching the pattern) on its own. 
It is the responsibility of each program to treat wildcards as such. 
This enables such things as "ren *.txt *.bat", since the ren command actually sees the * wildcard rather than a list of files matching the wildcard. 
Thus, "echo *.txt" does not display files in the current folder matching the pattern but rather literally displays "*.txt". 
Another consequence is that you can write "findstr a.*txt" without fearing that the "a.*txt" part gets replaced with the names of some files in the current folder. 
Furthermore, recursive "findstr /s pattern *.txt" is possible, while in some other operating systems, the "*.txt" part would get replaced with the file names found in the current folder, disregarding nested folders.
Commands accepting wildcards include <a href="#ATTRIB">ATTRIB</a>, <a href="#COPY">COPY</a>, <a href="#DIR">DIR</a>, <a href="#FINDSTR">FINDSTR</a>, <a href="#FOR">FOR</a>, <a href="#REN">REN</a>, etc.


<h2>User input</h2>
You can get input from the user using the following methods:
<li><a href="#SET">SET</a> /P command</li><li><a href="#CHOICE">CHOICE</a> command</li><li>Using "type con &gt;myfile.txt", for which the multi-line user input is terminated by user pressing Control + Z.</li>

<h2>Percent tilde</h2>
When a <a href="#Command-line_arguments">command-line argument</a> contains a file name, special syntax can be used to get various information about the file.
The following syntaxes expand to various information about the file passed as%1:
<table>
<tr>
<th>Syntax</th>
<th>Expansion Result</th>
<th>Example</th>
</tr>
<tr>
<td>%~1</td>
<td>%1 with no enclosing quotation marks</td>
<td>Not provided</td>
</tr>
<tr>
<td>%~f1</td>
<td>Full path with a drive letter</td>
<td>C:\Windows\System32\notepad.exe</td>
</tr>
<tr>
<td>%~d1</td>
<td>Drive letter</td>
<td>C:</td>
</tr>
<tr>
<td>%~p1</td>
<td>Drive-less path with the trailing backslash</td>
<td>\Windows\System32\</td>
</tr>
<tr>
<td>%~n1</td>
<td>For a file, the file name without path and extension
For a folder, the folder name
</td>
<td>notepad</td>
</tr>
<tr>
<td>%~x1</td>
<td>File name extension including the period</td>
<td>.exe</td>
</tr>
<tr>
<td>%~s1</td>
<td>Modify of f, n and x to use short name</td>
<td>Not provided</td>
</tr>
<tr>
<td>%~a1</td>
<td>File attributes</td>
<td>--a------</td>
</tr>
<tr>
<td>%~t1</td>
<td>Date and time of last modification of the file</td>
<td>02.11.2006 11:45</td>
</tr>
<tr>
<td>%~z1</td>
<td>File size</td>
<td>151040</td>
</tr>
<tr>
<td>%~pn1</td>
<td>A combination of p and n</td>
<td>\Windows\System32\notepad</td>
</tr>
<tr>
<td>%~dpnx1</td>
<td>A combination of several letters</td>
<td>C:\Windows\System32\notepad.exe</td>
</tr>
<tr>
<td>%~$PATH:1</td>
<td>The full path of the first match found in the folders present in the PATH variable, or an empty string in no match.</td>
</tr>
<tr>
<td>%~n0</td>
<td>%~n applied to%0:
The extensionless name of the batch
</td>
<td>tildetest</td>
</tr>
<tr>
<td>%~nx0</td>
<td>%~nx applied to%0:
The name of the batch
</td>
<td>tildetest.bat</td>
</tr>
<tr>
<td>%~d0</td>
<td>%~f applied to%0:
The drive letter of the batch
</td>
<td>C:</td>
</tr>
<tr>
<td>%~dp0</td>
<td>%~dp applied to%0:
The folder of the batch with trailing backslash
</td>
<td>C:\Users\Joe Hoe\</td>
</tr>
</table>
The same syntax applies to single-letter variables created by <a href="#FOR">FOR</a> command, such as "%%i".
To learn about this subject from the command line, type "call /?" or "for /?".


<h2>Functions</h2>
Functions AKA subprograms can be emulated using <a href="#CALL">CALL</a>, labels, <a href="#SETLOCAL">SETLOCAL</a> and <a href="#ENDLOCAL">ENDLOCAL</a>.
An example of a function that determines arithmetic power:


<span class="p">@</span><span class="k">echo</span> off
<span class="k">call</span> <span class="p">:</span><span class="nl">power</span> 2 4
<span class="k">echo</span> <span class="nv">%result%</span>
<span class="c1">rem Prints 16, determined as 2 * 2 * 2 * 2</span>
<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>

<span class="c1">rem __Function power______________________</span>
<span class="c1">rem Arguments: %1 and %2</span>
<span class="p">:</span><span class="nl">power</span>
<span class="k">setlocal</span>
<span class="k">set</span> <span class="nv">counter</span><span class="p">=</span><span class="nv">%2</span>
<span class="k">set</span> <span class="nv">interim_product</span><span class="p">=</span><span class="nv">%1</span>
<span class="p">:</span><span class="nl">power_loop</span>
<span class="k">if</span> <span class="nv">%counter%</span> <span class="ow">gtr</span> 1 <span class="p">(</span>
  <span class="k">set</span> <span class="k">/a</span> <span class="nv">interim_product</span><span class="o">=</span><span class="nv">interim_product</span> <span class="o">*</span> <span class="o">%</span><span class="mi">1</span>
  <span class="k">set</span> <span class="k">/a</span> <span class="nv">counter</span><span class="o">=</span><span class="nv">counter</span> <span class="o">-</span> <span class="mi">1</span>
  <span class="k">goto</span> <span class="p">:</span><span class="nl">power_loop</span>
<span class="p">)</span>
<span class="k">endlocal</span> <span class="p">&amp;</span> <span class="k">set</span> <span class="nv">result</span><span class="p">=</span><span class="nv">%interim_product%</span>
<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>

While the goto:eof at the end of the function is not really needed, it has to be there in the general case in which there is more than one function.
The variable into which the result should be stored can be specified on the calling line as follows:


<span class="p">@</span><span class="k">echo</span> off
<span class="k">call</span> <span class="p">:</span><span class="nl">sayhello</span> result=world
<span class="k">echo</span> <span class="nv">%result%</span>
<span class="k">exit</span> /b

<span class="p">:</span><span class="nl">sayhello</span>
<span class="k">set</span> <span class="nv">%1</span><span class="p">=</span>Hello <span class="nv">%2</span>
<span class="c1">REM Set %1 to set the returning value</span>
<span class="k">exit</span> /b

In the example above, exit /b is used instead of goto:eof to the same effect.
Also, remember that the equal sign is a way to separate parameters. 
Thus, the following items achieve the same:
<li>call:sayhello result=world</li><li>call:sayhello result world</li><li>call:sayhello result,world</li><li>call:sayhello result;world</li>

(See <a href="#Command-line_arguments">Command-line arguments</a> as a reminder)
<h2>Calculation</h2>
Batch scripts can do simple 32-bit integer arithmetic and bitwise manipulation using <a href="#SET">SET</a> /a command. 
The largest supported integer is 2147483647 = 2 ^ 31 - 1. 
The smallest supported integer is -2147483648 = - (2 ^ 31), assignable with the trick of set /a num=-2147483647-1. 
The syntax is reminiscent of the C language.
Arithmetic operators include *, /,% (modulo), +, -. 
In a batch, modulo has to be entered as "%%".
Bitwise operators interpret the number as a sequence of 32 binary digits. 
These are ~ (complement), &amp; (and), | (or), ^ (xor), &lt;&lt; (left shift), &gt;&gt; (right shift).
A logical operator of negation is!: it turns zero into one and non-zero into zero.
A combination operator is ,: it allows more calculations in one set command.
Combined assignment operators are modeled on "+=", which, in "a+=b", means "a=a+b". 
Thus, "a-=b" means "a=a-b". 
Similarly for *=, /=,%=, &amp;=, ^=, |=, &lt;&lt;=, and &gt;&gt;=.
The precedence order of supported operators, is as follows:
<ol><li>( )</li><li>* /% + -</li><li>&lt;&lt; &gt;&gt;</li><li>&amp;</li><li>^</li><li>|</li><li>= *= /=%= += -= &amp;= ^= |= &lt;&lt;= &gt;&gt;=</li><li>,</li>
</ol>
Literals can be entered as decimal (1234), hexadecimal (0xffff, leading 0x), and octal (0777, leading 0).
The internal bit representation of negative numbers is two's complement. 
This provides a connection between arithmetic operations and bit operations. 
For instance, -2147483648 is represented as 0x80000000, and therefore set /a num=~(-2147483647-1) yields 2147483647, which equals 0x7FFFFFFF (type set /a num=0x7FFFFFFF to check).
As some of the operators have special meaning for the command interpreter, an expression using them needs to be enclosed in quotation marks, such as this:
<li>set /a num="255^127"</li><li>set /a "num=255^127"
<li>Alternative placement of quotation marks.</li></li><li>set /a num=255^^127
<li>Escape ^ using ^ instead of quotation marks.</li></li>

Examples:
<li>set n1=40 &amp; set n2=25
set /a n3=%n1%+%n2%
<li>Uses the standard percent notation for variable expansion.</li></li><li>set n1=40 &amp; set n2=25
set /a n3=n1+n2
<li>Avoids the percent notation around variable names as unneeded for /a.</li></li><li>set /a num="255^127"
<li>Encloses "^" in quotation marks to prevent its special meaning for the command interpreter.</li></li><li>set /a n1 = (10 + 5)/5
<li>The spaces around = do not matter with /a. 
However, getting used to it lends itself to writing "set var = value" without /a, which sets the value of "var " rather than "var".</li></li><li>set /a n1=2+3,n2=4*7
<li>Performs two calculations.</li></li><li>set /a n1=n2=2
<li>Has the same effect as n1=2,n2=2.</li></li><li>set n1=40 &amp; set n2=25 &amp; set /a n3=n1+n2
<li>Works as expected.</li></li><li>set /a n1=2,n2=3,n3=n1+n2
<li>Works as expected.</li></li><li>set n1=40 &amp; set n2=25 &amp; set /a n3=%n1%+%n2%
<li>Does not work unless n1 and n2 were set previously. 
The variable specifications "%n1%" and "%n2"% get expanded <i>before</i> the first set command is executed. 
Dropping percent notation makes it work.</li></li><li>set /a n1=2,n2=3,n3=%n1%+%n2%
<li>Does not work unless n1 and n2 were set previously, for the reason stated in the previous example.</li></li><li>set /a n1=0xffff
<li>Sets n1 using hexadecimal notation.</li></li><li>set /a n1=0777
<li>Sets n1 using octal notation.</li></li>

An example calculation that prints prime numbers:


<span class="p">@</span><span class="k">echo</span> off
<span class="k">setlocal</span>
<span class="k">set</span> <span class="nv">n</span><span class="p">=</span>1
<span class="p">:</span><span class="nl">print_primes_loop</span>
<span class="k">set</span> <span class="k">/a</span> <span class="nv">n</span><span class="o">=</span><span class="nv">n</span><span class="o">+</span><span class="mi">1</span>
<span class="k">set</span> <span class="nv">cand_divisor</span><span class="p">=</span>1
<span class="p">:</span><span class="nl">print_primes_loop2</span>
<span class="k">set</span> <span class="k">/a</span> <span class="nv">cand_divisor</span><span class="o">=</span><span class="nv">cand_divisor</span><span class="o">+</span><span class="mi">1</span>
<span class="k">set</span> <span class="k">/a</span> <span class="nv">cand_divisor_squared</span><span class="o">=</span><span class="nv">cand_divisor</span><span class="o">*</span><span class="nv">cand_divisor</span>
<span class="k">if</span> <span class="nv">%cand_divisor_squared%</span> <span class="ow">gtr</span> <span class="nv">%n%</span> <span class="k">echo</span> Prime <span class="nv">%n%</span> <span class="p">&amp;</span> <span class="k">goto</span> <span class="p">:</span><span class="nl">print_primes_loop</span>
<span class="k">set</span> <span class="k">/a</span> <span class="nv">modulo</span><span class="o">=</span><span class="nv">n</span><span class="o">%%</span><span class="nv">cand_divisor</span>
<span class="k">if</span> <span class="nv">%modulo%</span> <span class="ow">equ</span> 0 <span class="k">goto</span> <span class="p">:</span><span class="nl">print_primes_loop</span><span class="c1"> </span><span class="p">&amp;</span> <span class="c1">REM Not a prime</span>
<span class="k">goto</span> <span class="p">:</span><span class="nl">print_primes_loop2</span>



<h2>Finding files</h2>
Files can be found using <a href="#DIR">#DIR</a>, <a href="#FOR">#FOR</a>, <a href="#FINDSTR">#FINDSTR</a>, <a href="#FORFILES">#FORFILES</a>, and <a href="#WHERE">#WHERE</a>.
Examples:
<li>dir /b /s *base*.doc*
<li>Outputs all files in the current folder and its subfolders such that the file name before the extension contains the word "base" and whose extension starts with "doc", which includes "doc" and "docx". 
The files are output with full paths, one file per line.</li></li><li>dir /b /s *.txt | findstr /i pers.*doc
<li>Combines the result of outputting files including their complete paths with the findstr filtering command supporting limited regular expressions, yielding a versatile and powerful combination for finding files by names and the names of their directories.</li></li><li>for /r%i in (*) do @if%~zi geq 1000000 echo %~zi%i
<li>For each file in the current folder and its subfolders that has the size greater than or equal to 1,000,000 bytes, outputs the file size in bytes and the full path of the file. 
For the syntax in%~zi, see <a href="#Percent_tilde">#Percent tilde</a>.</li></li><li>forfiles /s /d 06/10/2015 /c "cmd /c echo @fdate @path"
<li>For each file in the current folder and its subfolders modified on 10 June 2015 or later, outputs the file modification date and full file path. 
The date format after /d is locale specific. 
Thus, allows to find most recently modified files.</li></li><li>(for /r%i in (*) do @echo %~ti::%i) | findstr 2015.*::
<li>Searching the current folder recursively, outputs files whose last modification date is in year 2015. 
Places the modification date and time, followed by a double colon, before the file name. 
Works as long as the used version of Windows and locale displays dates in a format that contains four-digit years. 
The double colon is used to make sure the findstr command is matching the date and not the file name.</li></li><li>for /r%i in (*) do @echo %~ti | findstr 2015 &gt;NUL &amp;&amp; echo %i
<li>As above, outputs files changed in 2015. 
Unlike the above, only outputs the files, not the modification dates.</li></li><li>findstr /i /s /m cat.*mat *.txt
<li>Finds files by their content. 
Performs a full text search for regular expression cat.*mat in files with names ending in .txt, and outputs the files names. 
The /m switch ensures only the file names are output.</li></li><li>where *.bat
<li>Outputs all .bat files in the current directory and in the directories that are in PATH.</li></li>

<h2>Keyboard shortcuts</h2>
When using Windows command line from the standard console that appears after typing cmd.exe after pressing Windows + R, you can use multiple keyboard shortcuts, including function keys:
<li>Tab: Completes the relevant part of the typed string from file names or folder names in the current folder. 
The relevant part is usually the last space-free part, but use of quotation marks changes that. 
Generally considers both files and folders for completion, but cd command only considers folders.</li><li>Up and down arrow keys: Enters commands from the command history, one at a time.</li><li>Escape: Erases the current command line being typed.</li><li>F1: Types the characters from the single previously entered command from the command history, one character at a time. 
Each subsequent press of F1 enters one more character.</li><li>F2: Asks you to type a character, and enters the shortest prefix of the previous command from the command history that does not include the typed character. 
Thus, if the previous command was echo Hello world and you typed o, enters ech.</li><li>F3: Enters the single previous command from the command history. 
Repeated pressing has no further effect.</li><li>F4: Asks you to type a character, and erases the part of the currently typed string that starts at the current cursor location, continues to the right, and ends with the character you entered excluding that character. 
Thus, if you type echo Hello world, place the cursor at H using left arrow key, press F4 and then w, you get echo world.</li><li>F5: Enters previous commands from the command history, one at a time.</li><li>F6: Enters Control+Z character.</li><li>F7: Opens a character-based popup window with the command history, and lets you use arrow key and enter to select a command. 
After you press enter in the popup, the command is immediately executed.</li><li>F8: Given an already typed string, shows items from the command history that have that string as a prefix, one at a time.</li><li>F9: Lets you enter the number of the command from the command history, and then executes the command.</li><li>Alt + F7: Erases the command history.</li>

The above are also known as command prompt keyboard shortcuts.
The availability of the above shortcuts does not seem to depend on running <a href="#DOSKEY">DOSKEY</a>.


<h2>Perl one-liners</h2>
Some tasks can be conveniently achieved with Perl one-liners. 
Perl is a scripting language originating in the environment of another operating system. 
Since many Windows computing environments have Perl installed, Perl one-liners are a natural and compact extension of Windows batch scripting.
Examples:
<li>echo "abcbbc"| perl -pe "s/a.*?c/ac/"
<li>Lets Perl act as sed, the utility that supports textual replacements specified using regular expressions.</li></li><li>echo a b| perl -lane "print $F[1]"
<li>Lets Perl act as cut command, displaying the 2nd field or column of the line, in this case b. 
Use $F[2] to display 3rd field; indexing starts at zero. 
Native solution: <a href="#FOR">FOR</a> /f.</li></li><li>perl -ne "print if /\x22hello\x22/" file.txt
<li>Acts as grep or <a href="#FINDSTR">FINDSTR</a>, outputting the lines in file.txt that match the regular expression after if. 
Uses the powerful Perl regular expressions, more powerful than those of <a href="#FINDSTR">FINDSTR</a>.</li></li><li>perl -ne "$. 
&lt;= 10 and print" MyFile.txt
<li>Lets Perl act as head -10 command, outputting the first 10 lines of the file.</li></li><li>perl -e "sleep 5"
<li>Waits for 5 seconds.</li></li><li>for /f%i in ('perl -MPOSIX -le "print strftime '%Y-%m-%d', localtime"') do @set isodate=%i
<li>Gets current date in the ISO format into isodate variable.</li></li><li>perl -MWin32::Clipboard -e "print Win32::Clipboard-&gt;Get()"
<li>Outputs the text content of the clipboard. 
When stored to getclip.bat, yields a handy getclip command to complement <a href="#CLIP">CLIP</a> command.</li></li>

On the web, Perl one-liners are often posted in the command-line conventions of another operating system, including the use of apostrophe (') to surround the arguments instead of Windows quotation marks. 
These need to be tweaked for Windows.


<h2>Limitations</h2>
There is no touch command familiar from other operating systems. 
The touch command would modify the last-modification timestamp of a file without changing its content.
One workaround, with unclear reliability and applicability across various Windows versions, is this:
<li>copy /b file.txt+,,</li>



<h2><span class="orange">Built-in commands</span></h2>
These commands are all built in to the command interpreter itself, and cannot be changed. 
Sometimes this is because they require access to internal command interpreter data structures, or modify properties of the command interpreter process itself.
<h2>Overview</h2>
<table>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
<tr>
<td><a href="#ASSOC">ASSOC</a></td>
<td>Associates an extension with a file type (FTYPE).</td>
</tr>
<tr>
<td><a href="#BREAK">BREAK</a></td>
<td>Sets or clears extended CTRL+C checking.</td>
</tr>
<tr>
<td><a href="#CALL">CALL</a></td>
<td>Calls one batch program from another.</td>
</tr>
<tr>
<td><a href="#CD">CD</a>, <a href="#CHDIR">CHDIR</a></td>
<td>Displays or sets the current directory.</td>
</tr>
<tr>
<td><a href="#CHCP">CHCP</a></td>
<td>Displays or sets the active code page number.</td>
</tr>
<tr>
<td><a href="#CLS">CLS</a></td>
<td>Clears the screen.</td>
</tr>
<tr>
<td><a href="#COLOR">COLOR</a></td>
<td>Sets the console foreground and background colors.</td>
</tr>
<tr>
<td><a href="#COPY">COPY</a></td>
<td>Copies files.</td>
</tr>
<tr>
<td><a href="#DATE">DATE</a></td>
<td>Displays and sets the system date.</td>
</tr>
<tr>
<td><a href="#DEL">DEL</a>, <a href="#ERASE">ERASE</a></td>
<td>Deletes one or more files.</td>
</tr>
<tr>
<td><a href="#DIR">DIR</a></td>
<td>Displays a list of files and subdirectories in a directory.</td>
</tr>
<tr>
<td><a href="#ECHO">ECHO</a></td>
<td>Displays messages, or turns command echoing on or off.</td>
</tr>
<tr>
<td><a href="#ELSE">ELSE</a></td>
<td>Performs conditional processing in batch programs when "IF" is not true.</td>
</tr>
<tr>
<td><a href="#ENDLOCAL">ENDLOCAL</a></td>
<td>Ends localization of environment changes in a batch file.</td>
</tr>
<tr>
<td><a href="#EXIT">EXIT</a></td>
<td>Quits the CMD.EXE program (command interpreter).</td>
</tr>
<tr>
<td><a href="#FOR">FOR</a></td>
<td>Runs a specified command for each file in a set of files.</td>
</tr>
<tr>
<td><a href="#FTYPE">FTYPE</a></td>
<td>Sets the file type command.</td>
</tr>
<tr>
<td><a href="#IF">IF</a></td>
<td>Performs conditional processing in batch programs.</td>
</tr>
<tr>
<td><a href="#MD">MD</a>, <a href="#MKDIR">MKDIR</a></td>
<td>Creates a directory.</td>
</tr>
<tr>
<td><a href="#MOVE">MOVE</a></td>
<td>Moves a file to a new location</td>
</tr>
<tr>
<td><a href="#PATH">PATH</a></td>
<td>Sets or modifies the PATH environment</td>
</tr>
<tr>
<td><a href="#PAUSE">PAUSE</a></td>
<td>Causes the command session to pause for user input.</td>
</tr>
<tr>
<td><a href="#POPD">POPD</a></td>
<td>Changes to the drive and directory poped from the directory stack</td>
</tr>
<tr>
<td><a href="#PROMPT">PROMPT</a></td>
<td>Sets or modifies the string displayed when waiting for input.</td>
</tr>
<tr>
<td><a href="#PUSHD">PUSHD</a></td>
<td>Pushes the current directory onto the stack, and changes to the new directory.</td>
</tr>
<tr>
<td><a href="#RD">RD</a> / <a href="#RMDIR">RMDIR</a></td>
<td>Removes the directory.</td>
</tr>
<tr>
<td><a href="#REM">REM</a></td>
<td>A comment command. 
Unlike double-colon (::), the command can be executed.</td>
</tr>
<tr>
<td><a href="#REN">REN</a> / <a href="#RENAME">RENAME</a></td>
<td>Renames a file or directory</td>
</tr>
<tr>
<td><a href="#SET">SET</a></td>
<td>Sets or displays shell environment variables</td>
</tr>
<tr>
<td><a href="#SETLOCAL">SETLOCAL</a></td>
<td>Creates a child-environment for the batch file.</td>
</tr>
<tr>
<td><a href="#SHIFT">SHIFT</a></td>
<td>Moves the batch parameters forward.</td>
</tr>
<tr>
<td><a href="#START">START</a></td>
<td>Starts a program with various options.</td>
</tr>
<tr>
<td><a href="#TIME">TIME</a></td>
<td>Displays or sets the system clock</td>
</tr>
<tr>
<td><a href="#TITLE">TITLE</a></td>
<td>Changes the window title</td>
</tr>
<tr>
<td><a href="#TYPE">TYPE</a></td>
<td>Prints the content of a file to the console.</td>
</tr>
<tr>
<td><a href="#VER">VER</a></td>
<td>Shows the command processor, operating system versions.</td>
</tr>
<tr>
<td><a href="#VERIFY">VERIFY</a></td>
<td>Verifies that file copy has been done correctly.</td>
</tr>
<tr>
<td><a href="#VOL">VOL</a></td>
<td>Shows the label of the current volume.</td>
</tr>
</table>
<h2>ASSOC</h2>
Associates an extension with a file type (FTYPE), displays existing associations, or deletes an association. 
See also <a href="#FTYPE">FTYPE</a>.
Examples:
<li>assoc
<li>Lists all associations, in the format "&lt;file extension&gt;=&lt;file type&gt;", as, for example, ".pl=Perl" or ".xls=Excel.Sheet.8".</li></li><li>assoc | find ".doc"
<li>Lists all associations containing ".doc" substring.</li></li>



<h2>BREAK</h2>
In Windows versions based on Windows NT, does nothing; kept for compatibility with MS DOS.


<h2>CALL</h2>
Calls one batch program from another, or calls a subprogram within a single batch program. 

Purpose: Calls another batch file and then returns to the current batch file to continue processing.
Example

To run the files STARTER.BAT, TESTER.BAT, and FINISH.BAT in sequence, enter the following three lines in your batch file:
call starter
call tester
call finish

CALL is the normal way to call another bat file within a .bat and return to the caller.

However, all batch file processing will cease if the CALLed batch file has a fatal syntax error, or if the CALLed script terminates with EXIT without the /B option.

You can guarantee control will return to the caller if you execute the 2nd script via the CMD command.

cmd /c "calledFile.bat"

But this has a limitation that the environment variables set by the called batch will not be preserved upon return.

If you really need to preserve variables while using CMD, then you can have the "called" script write the variable changes to a temp file, and then have the caller read the temp file and re-establish the variables.

call is necessary for .bat or .cmd files, else the control will not return to the caller.

Start isn't the same as call, it creates a new cmd.exe instance, so it can run a called batch file asynchronosly



<h2>CD</h2>
Changes to a different directory, or displays the current directory. 
However, if a different drive letter is used, it does not switch to that different drive or volume.
Examples:
<li>cd</li><li>cd C:\Program Files</li><li>cd \Program Files</li><li>cd Documents</li><li>cd%USERPROFILE%</li><li>cd /d C:\Program Files
<li>Changes to the directory of the C: drive even if C: is not the current drive.</li></li><li>C: &amp; cd C:\Program Files.
<li>Changes to the directory of the C: drive even if C: is not the current drive.</li></li><li>cd ..
<li>Changes to the parent directory. 
Does nothing if already in the root directory.</li></li><li>cd ..\..
<li>Changes to the parent directory two levels up.</li></li><li>C: &amp; cd C:\Windows\System32 &amp; cd ..\..\Program Files
<li>Uses ".." to navigate through the directory three up and down</li></li>

No surrounding quotes are needed around paths with spaces.


<h2>CHDIR</h2>
A synonym of <a href="#CD">CD</a>.
<h2>CLS</h2>
Clears the screen.
<h2>COLOR</h2>
Sets the console foreground and background colors.
Examples:
<li>color f9
<li>Use white background and blue foreground.</li></li><li>color
<li>Restore the original color setting.</li></li>



<h2>COPY</h2>
Copies files. 
See also <a href="#MOVE">MOVE</a>.
Examples:
<li>copy F:\File.txt
<li>Copies the file into the current directory, assuming the current directory is not F:\.</li></li><li>copy "F:\My File.txt"
<li>As above; quotation marks are needed to surround a file with spaces.</li></li><li>copy F:\*.txt
<li>Copies the files located at F:\ and ending in dot txt into the current directory, assuming the current directory is not F:\.</li></li><li>copy F:\*.txt .
<li>Does the same as the above command.</li></li><li>copy File.txt
<li>Issues an error message, as File.txt cannot be copied over itself.</li></li><li>copy File1.txt File2.txt
<li>Copies File1.txt to File2.txt, overwriting File2.txt if confirmed by the user or if run from a batch script.</li></li><li>copy File.txt "My Directory"
<li>Copies File.txt into "My Directory" directory, assuming "My Directory" exists.</li></li><li>copy Dir1 Dir2
<li>Copies all files directly located in directory Dir1 into Dir2, assuming Dir1 and Dir2 are directories. 
Does not copy files located in nested directories of Dir1.</li></li><li>copy *.txt *.bak
<li>For each *.txt file in the current folder, makes a copy ending with "bak" rather than "txt".</li></li>



<h2>DEL</h2>
Deletes files. 
<i>Use with caution, especially in combination with wildcards.</i> Only deletes files, not directories, for which see <a href="#RD">RD</a>. 
For more, type "del /?".
Examples:
<li>del File.txt</li><li>del /s *.txt
<li>Deletes the files recursively including nested directories, but keeps the directories; mercilessly deletes all matching files without asking for confirmation.</li></li><li>del /p /s *.txt
<li>As above, but asks for confirmation before every single file.</li></li>



<h2>DIR</h2>
Lists the contents of a directory. 
Offers a range of options. 
Type "dir /?" for more help.
Examples:
<li>dir
<li>Lists the files and folders in the current folder, excluding hidden files and system files; uses a different manner of listing if DIRCMD variable is non-empty and contains switches for dir.</li></li><li>dir D:</li><li>dir /b C:\Users</li><li>dir /s
<li>Lists the contents of the directory and all subdirectories recursively.</li></li><li>dir /s /b
<li>Lists the contents of the directory and all subdirectories recursively, one file per line, displaying complete path for each listed file or directory.</li></li><li>dir *.txt
<li>Lists all files with .txt extension.</li></li><li>dir /a
<li>Includes hidden files and system files in the listing.</li></li><li>dir /ah
<li>Lists hidden files only.</li></li><li>dir /ad
<li>Lists directories only. 
Other letters after /A include S, I, R, A and L.</li></li><li>dir /ahd
<li>Lists hidden directories only.</li></li><li>dir /a-d
<li>Lists files only, omitting directories.</li></li><li>dir /a-d-h
<li>Lists non-hidden files only, omitting directories.</li></li><li>dir /od
<li>Orders the files and folders by the date of last modification. 
Other letters after /O include N (by name), E (by extension), S (by size), and G (folders first)</li></li><li>dir /o-s
<li>Orders the files by the size descending; the impact on folder order is unclear.</li></li><li>dir /-c /o-s /a-d
<li>Lists files ordered by size descending, omitting the thousands separator via /-C, excluding folders.</li></li><li>dir /s /b /od
<li>Lists the contents of the directory and all subdirectories recursively, ordering the files in each directory by the date of last modification. 
The ordering only happens per directory; the complete set of files so found is not ordered as a whole.</li></li>



<h2>DATE</h2>
Displays or sets the date. 
The way the date is displayed depends on country settings. 
Date can also be displayed using "echo %DATE%".
Getting date in the iso format, like "2000-01-28": That is nowhere easy, as the date format depends on country settings.
<li>If you can assume the format of "Mon 01/28/2000", the following will do:
<li>set isodate=%date:~10,4%-%date:~4,2%-%date:~7,2%</li></li><li>If you have <a href="#WMIC">WMIC</a>, the following is locale independent:
<li>for /f%i in ('wmic os get LocalDateTime') do @if%i lss a if%i gtr 0 set localdt=%i<br />
set isodate=%localdt:~0,4%-%localdt:~4,2%-%localdt:~6,2%</li><li>To use the above in a batch, turn%i into%%i and remove @ from before if.</li></li><li>If you have Perl installed:
<li>for /f%i in ('perl -MPOSIX -le "print strftime '%Y-%m-%d', localtime"') do @set isodate=%i</li></li>



<h2>ECHO</h2>
Displays messages, or turns command echoing on or off.
Examples:
<li>echo on</li><li>@echo off</li><li>echo Hello</li><li>echo "hello"
<li>Displays the quotes too.</li></li><li>echo %PATH%
<li>Displays the contents of PATH variable.</li></li><li>echo Owner ^&amp; son
<li>Uses caret (^) to escape ampersand (&amp;), thereby enabling echoing ampersands.</li></li><li>echo 1&amp;echo 2&amp;echo 3
<li>Displays three strings, each followed by a newline.</li></li><li>echo %random%&gt;&gt;MyRandomNumbers.txt
<li>While it seems to output random numbers to MyRandomNumbers.txt, it actually does not do so for numbers 0-9, since these, when placed before &gt;&gt;, indicate which channel is to be redirected. 
See also <a href="#Redirection">#Redirection</a>.</li></li><li>echo 2&gt;&gt;MyRandomNumbers.txt
<li>Instead of echoing 2, redirects standard error to the file.</li></li><li>(echo 2)&gt;&gt;MyRandomNumbers.txt
<li>Echoes even a small number (in this case 2) and redirects the result.</li></li><li>&gt;&gt;MyRandomNumbers.txt echo 2
<li>Another way to echo even a small number and redirect the result.</li></li>

Displaying a string without a newline requires a trick:
<li>set &lt;NUL /p=Output of a command:
<li>Displays "Output of a command:". 
The output of the next command will be displayed immediately after ":".</li></li><li>set &lt;NUL /p=Current time: &amp; time /t
<li>Displays "Current time: " followed by the output of "time /t".</li></li><li>(set &lt;NUL /p=Current time: &amp; time /t) &gt;tmp.txt
<li>Like before, with redirecting the output of both commands to a file.</li></li>



<h2>ELSE</h2>
An example:


<span class="k">if</span> <span class="k">exist</span> file.txt <span class="p">(</span>
  <span class="k">echo</span> The file exists.
<span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
  <span class="k">echo</span> The file does not exist.
<span class="p">)</span>

See also <a href="#IF">IF</a>.
<h2>ENDLOCAL</h2>
Ends local set of environment variables started using <a href="#SETLOCAL">SETLOCAL</a>. 
Can be used to create subprograms: see <a href="#Functions">Functions</a>.


<h2>ERASE</h2>
A synonym of <a href="#DEL">DEL</a>.
<h2>EXIT</h2>
Exits the DOS console or, with /b, only the currently running batch or the currently executed subroutine. 
If used without /b in a batch file, causes the DOS console calling the batch to close.
Examples:
<li>exit</li><li>exit /b</li>



<h2>FOR</h2>
Iterates over a series of values, executing a command.
In the following examples, %i is to be used from the command line while %%i is to be used from a batch.
Examples:
<li>for %%i in (1,2,3) do echo %%i
<li>In a batch, echoes 1, 2, and 3. 
In a batch, the command must use a <b>double percent sign</b>.</li><li>The remaining examples are intended to be directly pasted into a command line, so they use a single percent sign and include "@" to prevent repetitive display.</li></li><li>for %i in (1,2,3) do @echo %i
<li>From a command line, echoes 1, 2, and 3.</li><li>The for command tries to interpret the items as file names and as patterns of file names containing wildcards.</li><li>It does not complain if the items do not match existing file names, though.</li></li><li>for %i in (1,2,a*d*c*e*t) do @echo %i
<li>Unless you happen to have a file matching the third pattern, echoes 1 and 2, discarding the third item.</li></li><li>for %i in (1 2,3;4) do @echo %i
<li>Echoes 1, 2, 3, and 4. 
Yes, a mixture of item separators is used.</li></li><li>for %i in (*.txt) do @echo %i
<li>Echoes file names of files located in the current folder and having the .txt extension.</li></li><li>for %i in ("C:\Windows\system32\*.exe") do @echo %i
<li>Echoes file names matching the pattern.</li></li><li>for /r%i in (*.txt) do @echo %i
<li>Echoes file names with full paths, of files having the extension .txt located anywhere in the current folder including nested folders.</li></li><li>for /d%i in (*) do @echo %i
<li>Echoes the names of all folders in the current folder.</li></li><li>for /r /d%i in (*) do @echo %i
<li>Echoes the names including full paths of all folders in the current folder, including nested folders.</li></li><li>for /r%i in (*) do @if%~zi geq 1000000 echo %~zi%i
<li>For each file in the current folder and its subfolders that has the size greater than or equal to 1,000,000 bytes, outputs the file size in bytes and the full path of the file. 
For the syntax in%~zi, see <a href="#Percent_tilde">#Percent tilde</a>.</li></li><li>for /l%i in (1,1,10) do @echo %i
<li>Echoes the numbers from 1 to 10.</li></li><li>for /f "tokens=*"%i in (list.txt) do @echo %i
<li>For each line in a file, echoes the line.</li></li><li>for /f "tokens=*"%i in (list1.txt list2.txt) do @echo %i
<li>For each line in the files, echoes the line.</li></li><li>for /f "tokens=*"%i in (*.txt) do @echo %i
<li>Does nothing. 
Does not accept wildcards to match file names.</li></li><li>for /f "tokens=1-3 delims=:"%a in ("First:Second::Third") do @echo %c-%b-%a
<li>Parses a string into tokens delimited by ":".</li><li>The quotation marks indicate the string is not a file name.</li><li>The second and third tokens are stored in%b and%c even though%b and%c are not expressly mentioned in the part of the command before "do".</li><li>The two consecutive colons are treated as one separator;%c is not "" but rather "Third".</li><li>Does some of the job of the cut command from other operating systems.</li></li><li>for /f "tokens=1-3* delims=:"%a in ("First:Second::Third:Fourth:Fifth") do @echo %c-%b-%a:%d
<li>As above, just that the 4th and 5th items get captured in%d as "Fourth:Fifth", including the separator.</li></li><li>for /f "tokens=1-3* delims=:,"%a in ("First,Second,:Third:Fourth:Fifth") do @echo %c-%b-%a:%d
<li>Multiple delimiters are possible.</li></li><li>for /f "tokens=1-3"%a in ("First Second Third,item") do @echo %c-%b-%a
<li>The default delimiters are space and tab. 
Thus, they differ from the separators used to separate arguments passed to a batch.</li></li><li>for /f "tokens=*"%i in ('cd') do @echo %i
<li>For each line of the result of a command, echoes the line.</li></li><li>for /f "tokens=*"%i in ('dir /b /a-d-h') do @echo %~nxai
<li>For each non-hidden file in the current folder, displays the file attributes followed by the file name. 
In the string "%~nxai", uses the syntax described at <a href="#Percent_tilde">#Percent tilde</a>.</li></li><li>for /f "usebackq tokens=*"%i in (`dir /b /a-d-h`) do @echo %~nxai
<li>As above, but using the backquote character (`) around the command to be executed.</li></li><li>for /f "tokens=*"%i in ('tasklist ^| sort ^&amp; echo End') do @echo %i
<li>Pipes and ampersands in the command to be executed must be escaped using caret (^).</li></li><li>(for %i in (1,2,3) do @echo %i) &gt; anyoldtemp.txt
<li>To redirect the entire result of a for loop, place the entire loop inside brackets before redirecting. 
Otherwise, the redirection will tie to the body of the loop, so each new iteration of the body of the loop will override the results of the previous iterations.</li></li><li>for %i in (1,2,3) do @echo %i &gt; anyoldtemp.txt
<li>An example related to the one above. 
It shows the consequence of failing to put the loop inside brackets.</li></li>

<i>Continue:</i> To jump to the next iteration of the loop and thus emulate the continue statement known from many languages, you can use goto provided you put the loop body in a subroutine, as shown in the following:


<span class="k">for</span> <span class="se">%%</span>i <span class="k">in</span> <span class="p">(</span>a b c<span class="p">)</span> <span class="k">do</span> <span class="k">call</span> <span class="p">:</span><span class="nl">for_body</span> <span class="se">%%</span>i
<span class="k">exit</span> /b

<span class="p">:</span><span class="nl">for_body</span>
    <span class="k">echo</span> 1 <span class="nv">%1</span>
    <span class="k">goto</span> <span class="p">:</span><span class="nl">cont</span>
    <span class="k">echo</span> 2 <span class="nv">%1</span>
  <span class="p">:</span><span class="nl">cont</span>
<span class="k">exit</span> /b

If you use goto directly inside the for loop, the use of goto breaks the loop bookkeeping. 
The following fails:


<span class="k">for</span> <span class="se">%%</span>i <span class="k">in</span> <span class="p">(</span>a b c<span class="p">)</span> <span class="k">do</span> <span class="p">(</span>
    <span class="k">echo</span> 1 <span class="se">%%</span>i
    <span class="k">goto</span> <span class="p">:</span><span class="nl">cont</span>
    <span class="k">echo</span> 2 <span class="se">%%</span>i
  <span class="p">:</span><span class="nl">cont</span>
    <span class="k">echo</span> 3 <span class="se">%%</span>i
<span class="p">)</span>



<h2>FTYPE</h2>
Displays or sets the command to be executed for a file type. 
See also <a href="#ASSOC">ASSOC</a>.
Examples:
<li>ftype
<li>Lists all associations of commands to be executed with file types, as, for example, 'Perl="C:\Perl\bin\perl.exe" "%1"%*'</li></li><li>ftype | find "Excel.Sheet"
<li>Lists only associations whose display line contains "Excel.Sheet"</li></li>



<h2>GOTO</h2>
Goes to a label.
An example:


<span class="k">goto</span> <span class="p">:</span><span class="nl">mylabel</span>
<span class="k">echo</span> Hello 1
<span class="c1">REM Hello 1 never gets printed.</span>

<span class="p">:</span><span class="nl">mylabel</span>
<span class="k">echo</span> Hello 2
<span class="k">goto</span> <span class="p">:</span><span class="nl">eof</span>

<span class="k">echo</span> Hello 3
<span class="c1">REM Hello 3 never gets printed. 
Eof is a virtual label standing for the end of file.</span>

Goto within the body of a for loop makes cmd forget about the loop, even if the label is within the same loop body.


<h2>IF</h2>
Conditionally executes a command. 
Documentation is available by entering IF /? to CMD prompt.
Available elementary tests:
<li>exist &lt;filename&gt;</li><li>&lt;string&gt;==&lt;string&gt;</li><li>&lt;expression1&gt; equ &lt;expression2&gt; -- equals</li><li>&lt;expression1&gt; neq &lt;expression2&gt; -- not equal</li><li>&lt;expression1&gt; lss &lt;expression2&gt; -- less than</li><li>&lt;expression1&gt; leq &lt;expression2&gt; -- less than or equal</li><li>&lt;expression1&gt; gtr &lt;expression2&gt; -- greater then</li><li>&lt;expression1&gt; geq &lt;expression2&gt; -- greater than or equal</li><li>defined &lt;variable&gt;</li><li>errorlevel &lt;number&gt;</li><li>cmdextversion &lt;number&gt;</li>

To each elementary test, "not" can be applied. 
Apparently there are no operators like AND, OR, etc. 
to combine elementary tests.
The /I switch makes the == and equ comparisons ignore case.
An example:


<span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="nv">%targetpath%</span> <span class="p">(</span>
  <span class="k">echo</span> Target path not found.
  <span class="k">exit</span> /b
<span class="p">)</span>

Examples:
<li>if not 1 equ 0 echo Not equal</li><li>if 1 equ 0 echo A &amp; echo B
<li>Does nothing; both echo commands are subject to the condition.</li></li><li>if not 1 equ 0 goto:mylabel</li><li>if not a geq b echo Not greater</li><li>if b geq a echo Greater</li><li>if b geq A echo Greater in a case-insensitive comparison</li><li>if B geq a echo Greater in a case-insensitive comparison</li><li>if 0 equ 00 echo Numerical equality</li><li>if not 0==00 echo String inequality</li><li>if 01 geq 1 echo Numerical comparison</li><li>if not "01" geq "1" echo String comparison</li><li>if 1 equ 0 (echo Equal) else echo Unequal
<li>Notice the brackets around the positive then-part to make it work.</li></li><li>if not a==A echo Case-sensitive inequality</li><li>if /i a==A echo Case-insensitive equality</li><li>if /i==/i echo This does not work</li><li>if "/i"=="/i" echo Equal, using quotation marks to prevent the literal meaning of /i</li>



<h2>MD</h2>
Creates a new directory or directories. 
Has a synonym <a href="#MKDIR">MKDIR</a>; see also its antonym <a href="#RD">RD</a>.
Examples:
<li>md Dir
<li>Creates one directory in the current directory.</li></li><li>md Dir1 Dir2
<li>Creates two directories in the current directory.</li></li><li>md "My Dir With Spaces"
<li>Creates a directory with a name containing spaces in the current directory.</li></li>



<h2>MKDIR</h2>
A synonym for <a href="#MD">MD</a>.
<h2>MKLINK</h2>
Makes a symbolic link or other type of link. 
Available since Windows Vista.


<h2>MOVE</h2>
Moves files or directories between directories, or renames them. 
See also <a href="#REN">REN</a>.
Examples:
<li>move File1.txt File2.txt
<li>Renames File1.txt to File2.txt, overwriting File2.txt if confirmed by the user or if run from a batch script.</li></li><li>move File.txt Dir
<li>Moves File.txt file into Dir directory, assuming File.txt is a file and Dir is a directory; overwrites target file Dir\a.txt if conditions for overwriting are met.</li></li><li>move Dir1 Dir2
<li>Renames directory Dir1 to Dir2, assuming Dir1 is a directory and Dir2 does not exist.</li></li><li>move Dir1 Dir2
<li>Moves directory Dir1 into Dir2, resulting in existence of Dir2\Dir1, assuming both Dir1 and Dir2 are existing directories.</li></li><li>move F:\File.txt
<li>Moves the file to the current directory.</li></li><li>move F:\*.txt
<li>Moves the files located at F:\ and ending in dot txt into the current directory, assuming the current directory is not F:\.</li></li>



<h2>PATH</h2>
Displays or sets the value of the PATH environment variable.


<h2>PAUSE</h2>
Prompts the user and waits for a line of input to be entered.

<h2>POPD</h2>
Changes to the drive and directory poped from the directory stack. 
The directory stack is filled using the <a href="#PUSHD">PUSHD</a> command.

<h2>PROMPT</h2>
Can be used to change or reset the cmd.exe prompt. 
It sets the value of the PROMPT environment variable.


C<span class="p">:</span><span class="nl">\</span><span class="c1">&gt;PROMPT MyPrompt$G</span>

MyPrompt<span class="p">&gt;</span>CD
C<span class="p">:</span><span class="nl">\</span>

MyPrompt<span class="p">&gt;</span>PROMPT

C<span class="p">:</span><span class="nl">\</span><span class="c1">&gt;</span>

The PROMPT command is used to set the prompt to "MyPrompt&gt;". 
The CD shows that the current directory path is "C:\". 
Using PROMPT without any parameters sets the prompt back to the directory path.

<h2>PUSHD</h2>
Pushes the current directory onto the directory stack, making it available for the <a href="#POPD">POPD</a> command to retrieve, and, if executed with an argument, changes to the directory stated as the argument.

<h2>RD</h2>
Removes directories. 
See also its synonym <a href="#RMDIR">RMDIR</a> and antonym <a href="#MD">MD</a>. 
Per default, only empty directories can be removed. 
Also type "rd /?".
Examples:
<li>rd Dir1</li><li>rd Dir1 Dir2</li><li>rd "My Dir With Spaces"</li><li>rd /s Dir1
<li>Removes the directory Dir1 including all the files and subdirectories in it, asking for confirmation once before proceeding with the removal. 
To delete files recursively in nested directories with a confirmation per file, use <a href="#DEL">DEL</a> with /s switch.</li></li><li>rd /q /s Dir1
<li>Like above, but without asking for confirmation.</li></li>



<h2>REN</h2>
Renames files and directories.
Examples:
<li>ren filewithtpyo.txt filewithtypo.txt</li><li>ren *.cxx *.cpp</li>



<h2>RENAME</h2>
This is a synonym of <a href="#REN">REN</a> command.
<h2>REM</h2>
Used for remarks in batch files, preventing the content of the remark from being executed.
An example:


<span class="c1">REM A remark that does not get executed</span>
<span class="k">echo</span> Hello REM This remark gets displayed by echo
<span class="k">echo</span> Hello <span class="p">&amp;</span> <span class="c1">REM This remark gets ignored as wished</span>
<span class="p">:</span><span class="c1">: This sentence has been marked as a remark using double colon.</span>

REM is typically placed at the beginning of a line. 
If placed behind a command, it does not work, unless preceded by an ampersand, as shown in the example above.
An alternative to REM is double colon.


<h2>RMDIR</h2>
This is a synonym of <a href="#RD">RD</a>.
<h2>SET</h2>
Displays or sets environment variables. 
With /P switch, it asks the user for input, storing the result in the variable. 
With /A switch, it performs simple arithmetic calculations, storing the result in the variable. 
With string assignments, there must be no spaces before and after the equality sign; thus, "set name = Peter" does not work, while "set name=Peter" does.
Examples:
<li>set
<li>Displays a list of environment variables</li></li><li>set HOME
<li>Displays the values of the environment variables whose names start with "HOME"</li></li><li>set MYNUMBER=56</li><li>set HOME=%HOME%;C:\Program Files\My Bin Folder</li><li>set /P user_input=Enter an integer:</li><li>set /A result = 4 * ( 6 / 3 )
<li>Sets the result variable with the result of a calculation. 
See also <a href="#Calculation">#Calculation</a>.</li></li>



<h2>SETLOCAL</h2>
When used in a batch file, makes all further changes to environment variables local to the current batch file. 
When used outside of a batch file, does nothing. 
Can be ended using <a href="#ENDLOCAL">ENDLOCAL</a>. 
Exiting a batch file automatically calls "end local". 
Can be used to create subprograms: see <a href="#Functions">Functions</a>.
Furthermore, can be used to <i>enable delayed expansion</i> like this: "setlocal EnableDelayedExpansion". 
Delayed expansion consists in the names of variables enclosed in exclamation marks being replaced with their values only after the execution reaches the location of their use rather than at an earlier point.
The following is an example of using delayed expansion in a script that prints the specified number of first lines of a file, providing some of the function of the command "head" known from other operating systems:


<span class="p">@</span><span class="k">echo</span> off

<span class="k">call</span> <span class="p">:</span><span class="nl">myhead</span> 2 File.txt
<span class="k">exit</span> /b

<span class="p">:</span><span class="c1">: Function myhead</span>
<span class="p">:</span><span class="c1">: ===============</span>
<span class="p">:</span><span class="c1">: %1 - lines count, %2 - file name</span>
<span class="p">:</span><span class="nl">myhead</span>
<span class="k">setlocal</span> EnableDelayedExpansion
<span class="k">set</span> <span class="nv">counter</span><span class="p">=</span>1
<span class="k">for</span> <span class="k">/f</span> <span class="s2">"tokens=*"</span> <span class="se">%%</span>i <span class="k">in</span> <span class="p">(</span><span class="nv">%2</span><span class="p">)</span> <span class="k">do</span> <span class="p">(</span> 
  <span class="k">echo</span> <span class="se">%%</span>i
  <span class="k">set</span> <span class="k">/a</span> <span class="nv">counter</span><span class="o">=!</span><span class="nv">counter</span><span class="o">!+</span><span class="mi">1</span>
  <span class="k">if</span> <span class="nv">!counter!</span> <span class="ow">gtr</span> <span class="nv">%1</span> <span class="k">exit</span> /b
<span class="p">)</span>
<span class="k">exit</span> /b



<h2>SHIFT</h2>
Shifts the batch file arguments along, but does not affect%*. 
Thus, if%1=Hello 1,%2=Hello 2, and%3=Hello 3, then, after SHIFT,%1=Hello 2, and%2=Hello 3, but%* is "Hello 1" "Hello 2" "Hello 3".


<h2>START</h2>
Starts a program in new window, or opens a document. 
Uses an unclear algorithm to determine whether the first passed argument is a window title or a program to be executed; hypothesis: it uses the presence of quotes around the first argument as a hint that it is a window title.
Examples:
<li>start notepad.exe &amp; echo "Done."
<li>Starts notepad.exe, proceeding to the next command without waiting for finishing the started one. 
Keywords: asynchronous.</li></li><li>start "notepad.exe"
<li>Launches a new console window with notepad.exe being its title, apparently an undesired outcome.</li></li><li>start "" "C:\Program Files\Internet Explorer\iexplore.exe"
<li>Starts Internet Explorer. 
The empty "" passed as the first argument is the window title of a console that actually does not get opened, or at least not visibly so.</li></li><li>start "C:\Program Files\Internet Explorer\iexplore.exe"
<li>Launches a new console window with "C:\Program Files\Internet Explorer\iexplore.exe" being its title, apparently an undesired outcome.</li></li><li>start /wait notepad.exe &amp; echo "Done."
<li>Starts notepad.exe, waiting for it to end before proceeding.</li></li><li>start /low notepad.exe &amp; echo "Done."
<li>As above, but starting the program with a low priority.</li></li><li>start "" MyFile.xls
<li>Opens the document in the program assigned to open it.</li></li><li>start
<li>Starts a new console (command-line window) in the same current folder.</li></li><li>start .
<li>Opens the current folder in Windows Explorer.</li></li><li>start ..
<li>Opens the parent folder in Windows Explorer.</li></li><li>start "" "mailto:"
<li>Starts the application for writing a new email.</li></li><li>start /b TODO:example-application-where-this-is-useful
<li>Starts the application without opening a new console window, redirecting the output to the console from which the start command was called.</li></li>



<h2>TIME</h2>
Displays or sets the system time.


<h2>TITLE</h2>
Sets the title displayed in the console window.


<h2>TYPE</h2>
Prints the content of a file or files to the output.
Examples:
<li>type filename.txt</li><li>type a.txt b.txt</li><li>type *.txt</li><li>type NUL &gt; tmp.txt
<li>Create an empty file (blank file).</li></li>



<h2>VER</h2>
Shows the command processor or operating system version.


C:\&gt;VER

Microsoft Windows XP [Version 5.1.2600]

C:\&gt;

Some version strings:
<li>Microsoft Windows XP [Version 5.1.2600]</li><li>Microsoft Windows [Version 6.0.6000]</li><li>...</li>

The word "version" appears localized.


<h2>VERIFY</h2>
Sets or clears the setting to verify whether COPY files etc. 
are written correctly.


<h2>VOL</h2>
Displays volume labels.


<h2><span class="orange">External commands</span></h2>
External commands available to Windows command interpreter are separate executable program files, supplied with the operating system by Microsoft, or bundled as standard with the third-party command interpreters. 
By replacing the program files, the meanings and functions of these commands can be changed.
Many, but not all, external commands support the "/?" convention, causing them to write on-line usage information to their standard output and then to exit with a status code of 0.
<h2>ARP</h2>
Displays or changes items in the address resolution protocol cache, which maps IP addresses to physical addresses.


<h2>AT</h2>
Schedules a program to be run at a certain time. 
See also <a href="#SCHTASKS">SCHTASKS</a>.


<h2>ATTRIB</h2>
Displays or sets file attributes. 
With no arguments, it displays the attributes of all files in the current directory. 
With no attribute modification instructions, it displays the attributes of the files and directories that match the given search wildcard specifications. 
Similar to <a href="/wiki/Guide_to_Unix/Commands/File_System_Utilities#chmod" title="Guide to Unix/Commands/File System Utilities">chmod</a> of other operating systems.
Modification instructions:
<li>To add an attribute, attach a '+' in front of its letter.</li><li>To remove an attribute, attach a '-' in front of its letter</li><li>Attributes:
<li>A - Archived</li><li>H - Hidden</li><li>S - System</li><li>R - Read-only</li><li>...and possibly others.</li></li>

Examples:
<li>attrib
<li>Displays the attributes of all files in the current directory.</li></li><li>attrib File.txt
<li>Displays the attributes of the file.</li></li><li>attrib +r File.txt
<li>Adds the "Read-only" attribute to the file.</li></li><li>attrib -a File.txt
<li>Removes the "Archived" attribute from the file.</li></li><li>attrib -a +r File.txt
<li>Removes the "Archived" attribute and adds the "Read-only" attribute to the file.</li></li><li>attrib +r *.txt
<li>Acts on a set of files.</li></li><li>attrib /S +r *.txt
<li>Acts recursively in subdirectories.</li></li>

For more, type "attrib /?".


<h2>BCDEDIT</h2>
(Not in XP). 
Edits Boot Configuration Data (BCD) files. 
For more, type "bcdedit /?".


<h2>CACLS</h2>
Shows or changes discretionary access control lists (DACLs). 
See also <a href="#ICACLS">ICACLS</a>. 
For more, type "cacls /?".


<h2>CHCP</h2>
Displays or sets the active code page number. 
For more, type "chcp /?".


<h2>CHKDSK</h2>
Checks disks for disk problems, listing them and repairing them if wished. 
For more, type "chkdsk /?".


<h2>CHKNTFS</h2>
Shows or sets whether system checking should be run when the computer is started. 
The system checking is done using Autochk.exe. 
The "NTFS" part of the command name is misleading, since the command works not only with NTFS file system but also with FAT and FAT32 file systems. 
For more, type "chkntfs /?".


<h2>CHOICE</h2>
Lets the user choose one of multiple options by pressing a single key, and sets the error level as per the chosen option. 
Absent in Windows 2000 and Windows XP, it was reintroduced in Windows Vista, and has remained in Windows 7 and 8.
Examples:
<li>choice /m "Do you agree"
<li>Presents the user with a yes/no question, setting the error level to 1 for yes and to 2 for no. 
If the user presses Control + C, the error level is 0.</li></li><li>choice /c rgb /m "Which color do you prefer"
<li>Presents the user with a question, and indicates the letters for the user. 
Responds to user pressing r, g or b, setting the error level to 1, 2 or 3.</li></li>

An alternative is "set /p"; see <a href="#SET">SET</a>.


<h2>CIPHER</h2>
Shows the encryption state, encrypts or decrypts folders on a NTFS volume.


<h2>CLIP</h2>
(Not in XP) Places the piped input to the clipboard.
Examples:
<li>set | clip
<li>Places the listing of environment variables to the clipboard.</li></li><li>clip &lt; File1.txt
<li>Places the content of File1.txt to the clipboard.</li></li>



<h2>CMD</h2>
Invokes another instance of Microsoft's CMD.


<h2>COMP</h2>
Compares files. 
See also <a href="#FC">FC</a>.


<h2>COMPACT</h2>
Shows or changes the compression of files or folders on NTFS partitions.


<h2>CONVERT</h2>
Converts a volume from FAT16 or FAT32 file system to NTFS file system.


<h2>DEBUG</h2>
Allows to interactively examine file and memory contents in assembly language, hexadecimal or ASCII. 
Available in 32-bit Windows including Windows 7; the availability in 64-bit Windows is unclear. 
In modern Windows, useful as a quick hack to view hex content of a file. 
Keywords: hex dump, hexdump, hexadecimal dump, view hex, view hexadecimal, disassembler.
Debug offers its own command line. 
Once on its command like, type "?" to find about debug commands.
To view hex of a file, invoke debug.exe with the file name as a parameter, and then repeatedly type "d" followed by enter on the debug command line.
Limitations:
<li>Being a DOS program, debug chokes on long file names. 
Use dir /x to find the 8.3 file name, and apply debug on that one.</li><li>Debug cannot view larger files.</li>



<h2>DISKCOMP</h2>
Compares the content of two floppies.


<h2>DISKCOPY</h2>
Copies the content of one floppy to another.


<h2>DISKPART</h2>
Shows and configures the properties of disk partitions.


<h2>DOSKEY</h2>
Above all, creates macros known from other operating systems as aliases. 
Moreover, provides functions related to command history, and enhanced command-line editing. 
Macros are an alternative to very short batch scripts.
Macro-related examples:
<li>doskey da=dir /s /b
<li>Creates a single macro called "da"</li></li><li>doskey np=notepad $1
<li>Creates a single macro that passes its first argument to notepad.</li></li><li>doskey /macrofile=doskeymacros.txt
<li>Loads macro definitions from a file.</li></li><li>doskey /macros
<li>Lists all defined macros with their definitions.</li></li><li>doskey /macros | find "da"
<li>Lists all macro definitions that contain "da" as a substring; see also <a href="#FIND">FIND</a>.</li></li>

Command history-related examples:
<li>doskey /history
<li>Lists the complete command history.</li></li><li>doskey /history | find "dir"
<li>Lists each line of command history that contains "dir" as a substring</li></li><li>doskey /listsize=100
<li>Sets the size of command history to 100.</li></li>

To get help on doskey from command line, type "doskey /?".


<h2>DRIVERQUERY</h2>
Shows all installed device drivers and their properties.


<h2>EXPAND</h2>
Extracts files from compressed .cab cabinet files. 
See also <a href="#MAKECAB">#MAKECAB</a>.


<h2>FC</h2>
Compares files, displaying the differences in their content in a peculiar way.
Examples:
<li>fc File1.txt File2.txt &gt;NUL &amp;&amp; Echo Same || echo Different or error
<li>Detects difference using the error level of fc. 
The error level of zero means the files are the same; non-zero can mean the files differ but also that one of the files does not exist.</li></li>



<h2>FIND</h2>
Searches for a string in files or input, outputting matching lines. 
Unlike <a href="#FINDSTR">FINDSTR</a>, it cannot search folders recursively, cannot search for a regular expression, requires quotation marks around the sought string, and treats space literally rather than as a logical or.
Examples:
<li>find "(object" *.txt</li><li>dir /S /B | find "receipt"</li><li>dir /S /B | find /I /V "receipt"
<li>Prints all non-matching lines in the output of the dir command, ignoring letter case.</li></li><li>find /C "inlined" *.h
<li>Instead of outputting the matching lines, outputs their count. 
If more than one file is searched, outputs one count number per file preceded with a series of dashes followed by the file name; does not output the total number of matching lines in all files.</li></li><li>find /C /V "" &lt; file.txt
<li>Outputs the number of lines AKA line count in "file.txt". 
Does the job of "wc -l" of other operating systems. 
Works by treating "" as a string not found on the lines. 
The use of redirection prevents the file name from being output before the number of lines.</li></li><li>type file.txt | find /C /V ""
<li>Like the above, with a different syntax.</li></li><li>type *.txt 2&gt;NUL | find /C /V ""
<li>Outputs the sum of line counts of the files ending in ".txt" in the current folder. 
The "2&gt;NUL" is a redirection of standard error that removes the names of files followed by empty lines from the output.</li></li><li>find "SchÃ¶nheit" *.txt
<li>If run from a batch file saved in unicode UTF-8 encoding, searches for the search term "SchÃ¶nheit" in UTF-8 encoded *.txt files. 
For this to work, the batch file must not contain the byte order mark written by Notepad when saving in UTF-8. 
Notepad++ is an example of a program that lets you write UTF-8 encoded plain text files without byte order mark. 
While this works with find command, it does not work with <a href="#FINDSTR">#FINDSTR</a>.</li></li><li>find "Copyright" C:\Windows\system32\a*.exe
<li>Works with binary files no less than text files.</li></li>



<h2>FINDSTR</h2>
Searches for regular expressions or text strings in files. 
Does some of the job of "grep" command known from other operating systems, but is much more limited in the regular expressions it supports.
Treats space in a regular expression as a disjunction AKA logical or unless prevented with /c option.
Examples:
<li>findstr /s "[0-9][0-9].*[0-9][0-9]" *.h *.cpp
<li>Searches recursively all files whose name ends with dot h or dot cpp, printing only lines that contain two consecutive decimal digits followed by anything followed by two consecutive decimal digits.</li></li><li>findstr "a.*b a.*c" File.txt
<li>Outputs all lines in File.txt that match any of the <i>two</i> regular expressions separated by the space. 
Thus, the effect is one of <i>logical or</i> on regular expressions.</li></li><li>echo world | findstr "hello wo.ld"
<li>Does not match. 
Since the 1st item before the space does not look like a regex, findstr treats the whole search term as a plain search term.</li></li><li>echo world | findstr /r "hello wo.ld"
<li>Matches. 
The use of /r forces regex treatment.</li></li><li>findstr /r /c:"ID: *[0-9]*" File.txt
<li>Outputs all lines in File.txt that match the single regular expression containing a space. 
The use of /c prevents the space from being treated as a logical or. 
The use of /r switches the regular expression treatment on, which was disabled by default by the use of /c. 
To test this, try the following:
<li>echo ID: 12|findstr /r /c:"ID: *[0-9]*$"
<li>Matches.</li></li><li>echo ID: 12|findstr /c:"ID: *[0-9]*$"
<li>Does not match, as the search string is not interpreted as a regular expression.</li></li><li>echo ID: abc|findstr "ID: *[0-9]*$"
<li>Matches despite the output of echo failing to match the complete regular expression: the search is interpreted as one for lines matching "ID:" <i>or</i> "*[0-9]*$".</li></li></li></li><li>findstr /ric:"id: *[0-9]*" File.txt
<li>Does the same as the previous example, but in a case-insensitive manner.</li><li>While findstr enables this sort of accumulation of switches behind a single "/", this is not possible with any command. 
For instance, "dir /bs" does not work, while "dir /b /s" does.</li><li>To test this, try the following:
<li>echo ID: 12|findstr /ric:"id: *[0-9]*$"</li><li>echo ID: ab|findstr /ric:"id: *[0-9]*$"</li></li></li><li>findstr /msric:"id: *[0-9]*" *.txt
<li>Like above, but recursively for all files per /s, displaying only matching files rather than matching lines per /m.</li></li><li>echo hel lo | findstr /c:"hel lo" /c:world
<li>/c switch can be used multiple times to create logical or.</li></li><li>echo \hello\ | findstr "\hello\"
<li>Does not match. 
Backslash before quotation marks and multiple other characters acts as an escape; thus, \" matches ".</li></li><li>echo \hello\ | findstr "\\hello\\"
<li>Matches. 
Double backslash passed to findstr stands for a single backslash.</li></li><li>echo \hello\ | findstr \hello\
<li>Matches. 
None of the single backslashes passed to findstr is followed by a character on which the backslash acts as an escape.</li></li><li>echo ^"hey | findstr \^"hey | more
<li>To search for a quote (quotation mark), you need to escape it two times: once for the shell using caret (^), and once for findstr using backslash (\).</li></li><li>echo ^"hey | findstr ^"\^"hey there^" | more
<li>To search for a quote and have the search term enclosed in quotes as well, the enclosing quotes need to be escaped for the shell using caret (^).</li></li><li>echo //comment line | findstr \//
<li>If forward slash (/) is the 1st character in the search term, it needs to be escaped with a backslash (\). 
The escaping is needed even if the search term is enclosed in quotes.</li></li><li>findstr /f:FileList.txt def.*():
<li>Search in the files stated in FileList.txt, one file per line. 
File names in FileList.txt can contain spaces and do not need to be surrounded with quotation marks for this to work.</li></li><li>findstr /g:SearchTermsFile.txt *.txt
<li>Search for the search terms found in SearchTermsFile.txt, one search term per line. 
A space does not serve to separate two search terms; rather, each line is a complete search term. 
A line is matched if at least one of the search terms matches. 
If the first search term looks like a regex, the search will be a regex one, but if it looks like a plain search term, the whole search will be a plain one even if 2nd or later search terms look like regex.</li></li><li>findstr /xlg:File1.txt File2.txt
<li>Outputs set intersection: lines present in both files.</li></li><li>findstr /xlvg:File2.txt File1.txt
<li>Outputs set difference: File1.txt - File2.txt.</li></li><li>findstr /m Microsoft C:\Windows\system32\*.com
<li>Works with binary files no less than text files.</li></li>

Limitations of the regular expressions of "findstr", as compared to "grep":
<li>No support of groups -- "\(", "\)".</li><li>No support of greedy iterators -- "*?".</li><li>No support of "zero or one of the previous" -- "?".</li><li>And more.</li>

Other limitations: There is a variety of limitations and strange behaviors as documented at <a rel="nofollow" class="external text" href="http://stackoverflow.com/questions/8844868/what-are-the-undocumented-features-and-limitations-of-the-windows-findstr-comman">What are the undocumented features and limitations of the Windows FINDSTR command?</a>.
Also consider typing "findstr /?".


<h2>FORFILES</h2>
Finds files by their modification date and file name pattern, and executes a command for each found file. 
Is very limited, especially compared to the find command of other operating systems. 
Available since Windows Vista. 
For more, type "forfiles /?".
Examples:
<li>forfiles /s /d 06/10/2015 /c "cmd /c echo @fdate @path"
<li>For each file in the current folder and its subfolders modified on 10 June 2015 or later, outputs the file modification date and full file path. 
The date format after /d is locale specific. 
Thus, allows to find most recently modified files. 
Keywords: most recently changed files.</li></li><li>forfiles /m *.txt /s /d 06/10/2015 /c "cmd /c echo @fdate @path"
<li>As above, but only for files ending in .txt.</li></li>



<h2>FORMAT</h2>
Formats a disk to use Windows-supported file system such as FAT, FAT32 or NTFS, thereby overwriting the previous content of the disk. 
To be used with great caution.


<h2>FSUTIL</h2>
A powerful tool performing actions related to FAT and NTFS file systems, to be ideally only used by powerusers with an extensive knowledge of the operating systems.

<li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_behavior.mspx">Fsutil: behavior</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_dirty.mspx">Fsutil: dirty</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_file.mspx">Fsutil: file</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_fsinfo.mspx">Fsutil: fsinfo</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_hardlink.mspx">Fsutil: hardlink</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_objectid.mspx">Fsutil: objectid</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_quota.mspx">Fsutil: quota</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_reparsepoint.mspx">Fsutil: reparsepoint</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_sparse.mspx">Fsutil: sparse</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_usn.mspx">Fsutil: usn</a></li><li><a rel="nofollow" class="external text" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/fsutil_volume.mspx">Fsutil: volume</a></li></li>

<h2>GPRESULT</h2>
Displays group policy settings and more for a user or a computer.


<h2>GRAFTABL</h2>
Enables the display of an extended character set in graphics mode. 
Fore more, type "graftabl /?".


<h2>HELP</h2>
Shows command help.
Examples:
<li>help
<li>Shows the list of Windows-supplied commands.</li></li><li>help copy
<li>Shows the help for COPY command, also available by typing "copy /?".</li></li>



<h2>ICACLS</h2>
(Not in XP) Shows or changes discretionary access control lists (DACLs) of files or folders. 
See also <a href="#CACLS">CACLS</a>. 
Fore more, type "icacls /?".


<h2>IPCONFIG</h2>
Displays Windows IP Configuration. 
Shows configuration by connection and the name of that connection (i.e. 
Ethernet adapter Local Area Connection) Below that the specific info pertaining to that connection is displayed such as DNS suffix and ip address and subnet mask.


<h2>LABEL</h2>
Adds, sets or removes a disk label.


<h2>MAKECAB</h2>
Places files into compressed .cab cabinet file. 
See also <a href="#EXPAND">#EXPAND</a>.


<h2>MODE</h2>
A multi-purpose command to display device status, configure ports and devices, and more.


<h2>MORE</h2>
Displays the contents of a file or files, one screen at a time. 
When redirected to a file, performs some conversions, also depending on the used switches.
Examples:
<li>more Test.txt</li><li>more *.txt</li><li>grep -i sought.*string Source.txt | more /p &gt;Out.txt
<li>Taking the output of a non-Windows grep command that produces line breaks consisting solely of LF character without CR character, converts LF line breaks to CR-LF line breaks. 
CR-LF newlines are also known as DOS line breaks, Windows line breaks, DOS newlines, Windows newlines, and CR/LF line endings,as opposed to LF line breaks used by some other operating systems.</li><li>In some setups, seems to output gibberish if the input contains LF line breaks and tab characters at the same time.</li><li>In some setups, for the conversion, /p may be unneeded. 
Thus, "more" would convert the line breaks even without /p.</li></li><li>more /t4 Source.txt &gt;Target.txt
<li>Converts tab characters to 4 spaces.</li><li>In some setups, tab conversion takes place automatically, even without the /t switch. 
If so, it is per default to 8 spaces.</li></li>

Switch /e:
<li>The online documentation for "more" in Windows XP and Windows Vista does not mention the switch.</li><li>The switch /e is mentioned in "more /?" at least in Windows XP and Windows Vista.</li><li>Per "more /?", the switch is supposed to enable extended features listed at the end of "more /?" help such as showing the current row on pressing "=". 
However, in Windows XP and Windows Vista, that seems to be enabled by default even without /e.</li><li>Hypothesis: In Windows XP and Windows Vista, /e does not do anything; it is present for compatibility reasons.</li>



<h2>NET</h2>
Provides various network services, depending on the command used. 
Available variants per command:
<li>net accounts</li><li>net computer</li><li>net config</li><li>net continue</li><li>net file</li><li>net group</li><li>net help</li><li>net helpmsg</li><li>net localgroup</li><li>net name</li><li>net pause</li><li>net print</li><li>net send</li><li>net session</li><li>net share</li><li>net start</li><li>net statistics</li><li>net stop</li><li>net time</li><li>net use</li><li>net user</li><li>net view</li>



<h2>OPENFILES</h2>
Performs actions pertaining to open files, especially those opened by other users over the network. 
The actions involve querying, displaying, and disconnecting. 
For more, type "openfiles /?".


<h2>PING</h2>
Syntax:
<li>PING /?</li><li>PING address</li><li>PING hostname</li>

Send <a href="//en.wikipedia.org/wiki/Internet_Control_Message_Protocol" class="extiw" title="w:Internet Control Message Protocol">ICMP/IP</a> "echo" packets over the network to the designated address (or the first IP address that the designated hostname maps to via name lookup) and print all responses received.


<h2>RECOVER</h2>
Recovers as much information as it can from damaged files on a defective disk.


<h2>REPLACE</h2>
Replaces files in the destination folder with same-named files in the source folder.


<h2>ROBOCOPY</h2>
(Not in XP) Copies files and folders. 
See also <a href="#XCOPY">XCOPY</a> and <a href="#COPY">COPY</a>.


<h2>RUNDLL32</h2>
Runs a function available from a DLL. 
The available DLLs and their functions differ among Windows versions.
Examples:
<li><span class="gold">rundll32 sysdm.cpl,EditEnvironmentVariables</span>
<li>In some Windows versions, opens the dialog for editing environment variables.</li></li>



<h2>SCHTASKS</h2>
Schedules a program to be run at a certain time, more powerful than <a href="#AT">AT</a>.


<h2>SETX</h2>
Like <a href="#SET">SET</a>, but affecting the whole machine rather than the current console or process. 
Not available in Windows XP; available in Windows Vista and later.


<h2>SHUTDOWN</h2>
Shuts down a computer, or logs off the current user.


<h2>SORT</h2>
Sorts alphabetically, from A to Z or Z to A. 
Cannot sort numerically: if the input contains one integer per line, "12" comes before "9".
Examples:
<li>sort File.txt
<li>Outputs the sorted content of File.txt.</li></li><li>sort /r File.txt
<li>Sorts in reverse order, Z to A.</li></li><li>dir /b | sort</li>



<h2>SUBST</h2>
Assigns a drive letter to a local folder, displays current assignments, or removes an assignment.
Examples:
<li>subst p: .
<li>Assigns p: to the current folder.</li></li><li>subst
<li>Shows all assignments previously made using subst.</li></li><li>subst /d p:
<li>Removes p: assignment.</li></li>



<h2>SYSTEMINFO</h2>
Shows configuration of a computer and its operating system.


<h2>TASKKILL</h2>
Ends one or more tasks.
Examples:
<li>taskkill /im AcroRd32.exe
<li>Ends all process with the name "AcroRd32.exe"; thus, ends all open instances of Acrobat Reader. 
The name can be found using <a href="#TASKLIST">tasklist</a>.</li></li><li>taskkill /f /im AcroRd32.exe
<li>As above, but <i>forced</i>. 
Succeeds in ending some processes that do not get ended without /f.</li></li><li>tasklist | find "notepad"
taskkill /PID 5792
<li>Ends the process AKA task with process ID (PID) of 5792; the assumption is you have found the PID using tasklist.</li></li>



<h2>TASKLIST</h2>
Lists tasks, including task name and process id (PID).
Examples:
<li>tasklist | sort</li><li>tasklist | find "AcroRd"</li><li>tasklist | find /C "chrome.exe"
<li>Displays the number of tasks named "chrome.exe", belonging to Google Chrome browser.</li></li>



<h2>TIMEOUT</h2>
Waits a specified number of seconds, displaying the number of remaining seconds as time passes, allowing the user to interrupt the waiting by pressing a key. 
Also known as delay or sleep. 
Available in Windows Vista and later.
Examples:
<li>timeout /t 5
<li>Waits for five seconds, allowing the user to cancel the waiting by pressing a key.</li></li><li>timeout /t 5 /nobreak
<li>Waits for five seconds, ignoring user input other than Control + C.</li></li><li>timeout /t 5 /nobreak &gt;nul
<li>As above, but with no output.</li></li>

Workaround in Windows XP:
<li>ping -n 6 127.0.0.1 &gt;nul
<li>Waits for five seconds; the number after -n is the number of seconds to wait plus 1.</li></li>

Perl-based workaround in Windows XP, requiring Perl installed:
<li>perl -e "sleep 5"
<li>Waits for 5 seconds.</li></li>



<h2>TREE</h2>
Displays a tree of all subdirectories of the current directory to any level of recursion or depth. 
If used with /F switch, displays not only subdirectories but also files.
Examples:
<li>tree</li><li>tree /f
<li>Includes files in the listing, in addition to directories.</li></li><li>tree /f /a
<li>As above, but uses 7-bit ASCII characters including "+", "-" and \" to draw the tree.</li></li>

A snippet of a tree using 8-bit ASCII characters:

â”œâ”€â”€â”€winevt
â”‚   â”œâ”€â”€â”€Logs
â”‚   â””â”€â”€â”€TraceFormat
â”œâ”€â”€â”€winrm

A snippet of a tree using 7-bit ASCII characters:

+---winevt
|   +---Logs
|   \---TraceFormat
+---winrm



<h2>WHERE</h2>
Outputs one or more locations of a file or a file name pattern, where the file or pattern does not need to state the extension if it listed in <a href="#PATHEXT">PATHEXT</a>, such as .exe. 
Searches in the current directory and in the PATH by default. 
Does some of the job of "which" command of some other operating systems, but is more flexible.
Available on Windows 2003, Windows Vista, Windows 7, and later; not available on Windows XP. 
An alternative to be used with Windows XP is in the examples below.
Does not find internal commands, as there are no dot exe files for them to match.
Examples:
<li>where find
<li>Outputs the location of the find command, possibly "C:\Windows\System32\find.exe". 
The .exe extension does not need to be specified as long as it is listed in <a href="#PATHEXT">PATHEXT</a>, which it is by default.</li><li>If there are more find commands in the path, outputs paths to both. 
In some situations, it can output the following:
C:\Windows\System32\find.exe<br />
C:\Program Files\GnuWin32\bin\find.exe</li></li><li>for %i in (find.exe) do @echo %~$PATH:i
<li>Outputs the location of "find.exe" on Windows XP. 
The name has to include ".exe", unlike with the where command.</li></li><li>where /r . 
Tasks*
<li>Searches for files whose name matches "Task*" recursively from the current folder. 
Similar to "dir /b /s Tasks*". 
The /r switch disables search in the folders in PATH.</li></li><li>where *.bat
<li>Outputs all .bat files in the current directory and in the directories that are in PATH. 
Thus, outputs all .bat files that you can run without entering their full path.</li></li><li>where ls*.bat
<li>As above, constraining also the beginning of the name of the .bat files.</li></li><li>where ls*
<li>As above, but with no constraint on the extension. 
Finds lsdisks.bat, lsmice.pl, and lsmnts.py if in the current directory or in the path.</li></li><li>where *.exe *.com | more
<li>Displays countless .exe and .com files in the path and in the current folder, including those in C:\Windows\System32.</li></li><li>where $path:*.bat
<li>Outputs .bat files in the path but not those in the current folder unless the current folder is in PATH. 
Instead of path, another environment variable containing a list of directories can be used.</li></li><li>where $windir:*.exe
<li>Outputs .exe files found in the folder stated in WINDIR environment variable.</li></li><li>where $path:*.bat $windir:*.exe
<li>A combination is possible. 
Outputs all files matching either of the two queries.</li></li><li>where /q *.bat &amp;&amp; echo Found
<li>Suppresses both standard and error output, but sets the error level, enabling testing on it. 
The error level is set either way, with or without /q.</li></li>



<h2>WMIC</h2>
Starts Windows Management Instrumentation Command-line (WMIC), or with arguments given, passes the arguments as commands to WMIC. 
Not in Windows XP Home. 
For more, type "wmic /?".
Examples:
<li>wmic logicaldisk get caption,description
<li>Lists drives (disks) accessible under a drive letter, whether local hard drives, CD-ROM drives, removable flash drives, network drives or drives created using <a href="#SUBST">#SUBST</a>.</li></li>



<h2>XCOPY</h2>
Copies files and directories in a more advanced way than <a href="#COPY">COPY</a>, deprecated in Windows Vista and later. 
Type xcopy /? to learn more, including countless options.
Examples:
<li>xcopy C:\Windows\system
<li>Copies all files, but not files in nested folders, from the source folder ("C:\Windows\system") to the current folder.</li></li><li>xcopy /s /i C:\Windows\system C:\Windows-2\system
<li>Copies all files and folders to any nesting depth (via "/s") from the source folder ("C:\Windows\system") to "C:\Windows-2\system", creating "Windows-2\system" if it does not exist (via "/i").</li></li><li>xcopy /s /i /d:09-01-2014 C:\Windows\system C:\Windows-2\system
<li>As above, but copies only files changed on 1 September 2014 or later. 
Notice the use of the month-first convention even if you are on a non-US locale of Windows.</li></li><li>xcopy /L /s /i /d:09-01-2014 C:\Windows\system C:\Windows-2\system
<li>As above, but in a test mode via /L (list-only, output-only, display-only). 
Thus, does not do any actual copying, merely lists what would be copied.</li></li>



<h2>echo a newline in a batch file</h2>
echo hello
echo,
echo world

echo hello & echo,world
This means you could define & echo. as a constant for a newline \n.

For printing just an empty line, you could use one of
echo,
echo;
echo(
echo/
echo+
echo=
But the use of echo., echo\ or echo: should be avoided, as they can be really slow, depending of the location where the script will be executed, like a network drive.

<h2>editing environment variables</h2>
rundll32 sysdm.cpl,EditEnvironmentVariables

<h2>Doskey syntax</h2>
DOSKEY [/REINSTALL] [/LISTSIZE=size] [/MACROS[:ALL | :exename]] [/HISTORY] [/INSERT | /OVERSTRIKE] [/EXENAME=exename] [/MACROFILE=filename] [macroname=[text]]

<table class="mtable3 tab">
<tr><td>/REINSTALL</td><td>Installs a new copy of Doskey.</td></tr>
<tr><td>/LISTSIZE=size</td><td>Sets the size of command history <a href="https://www.computerhope.com/jargon/b/buffer.htm">buffer</a>.</td></tr>
<tr><td>/MACROS</td><td>Displays all Doskey <a href="https://www.computerhope.com/jargon/m/macro.htm">macros</a>.</td></tr>
<tr><td>/MACROS:ALL</td><td>Displays all Doskey macros for all executables which have Doskey macros.</td></tr>
<tr><td>/MACROS:exename</td><td>Displays all Doskey macros for the given executable.</td></tr>
<tr><td>/HISTORY</td><td>Displays all commands stored in memory.</td></tr>
<tr><td>/INSERT</td><td>Specifies that new text you type is inserted in the old text.</td></tr>
<tr><td>/OVERSTRIKE</td><td>Specifies that new text overwrites old text.</td></tr>
<tr><td>/EXENAME=exename</td><td>Specifies the executable.</td></tr>
<tr><td>/MACROFILE=filename</td><td>Specifies a file of macros to install.</td></tr>
<tr><td>macroname</td><td>Specifies a name for a macro you create.</td></tr>
<tr><td>text</td><td>Specifies commands you want to record.</td></tr>
</table>
Option keys

<table class="mtable3 tab">
<tr><td>UP,DOWN</td>
<td>The <a href="https://www.computerhope.com/jargon/a/arrowkey.htm">up and down arrows</a> recall commands.</td></tr>
<tr><td>Esc</td><td>Clears current command.</td></tr>
<tr><td>F7</td><td>Displays command history.</td></tr>
<tr><td>Alt+F7</td><td>Clears command history.</td></tr>
<tr><td>[chars]F8</td><td>Searches for command beginning with [chars].</td></tr>
<tr><td>F9</td><td>Selects a command by number.</td></tr>
<tr><td>Alt+F10</td><td>Clears macro definitions.</td></tr>
</table>
The following are some special codes in Doskey macro definitions:

<table class="mtable3 tab">
<tr><td>$T</td><td>Command separator. Allows multiple commands in a macro.</td></tr>
<tr><td>$1-$9</td><td>Batch parameters. Equivalent to %1-%9 in batch programs.</td></tr>
<tr><td>$*</td><td>Symbol replaced by everything following macro name on the command line.</td></tr>
</table>
<h3 class="tab" id="xp">Windows XP and earlier syntax</h3>
DOSKEY [/switch ...] [macroname=[text]]

<table class="mtable3 tab">
<tr><td>/BUFSIZE:size</td><td>Sets the size of macro and command buffer.</td><td>(default:512)</td></tr>
<tr><td>/ECHO:on|off</td><td>Enables/disables echo of macro expansions.</td><td>(default:on)</td></tr>
<tr><td>/FILE:file</td><td>Specifies file containing a list of macros.</td><td></td></tr>
<tr><td>/HISTORY</td><td>Displays all commands stored in memory.</td><td></td></tr>
<tr><td>/INSERT</td><td>Inserts new characters into line when typing.</td><td></td></tr>
<tr><td>/KEYSIZE:size</td><td>Sets the size of keyboard type-ahead buffer.</td><td>(default:15)</td></tr>
<tr><td>/LINE:size</td><td>Sets the maximum size of line edit buffer.</td><td>(default:128)</td></tr>
<tr><td>/MACROS</td><td>Displays all Doskey macros.</td><td></td></tr>
<tr><td>/OVERSTRIKE</td><td>Overwrites new characters onto the line when typing.</td><td>(default)</td></tr>
<tr><td>/REINSTALL</td><td>Installs a new copy of Doskey.</td><td></td></tr>
<tr><td>macroname</td><td>Specifies a name for a macro you create.</td><td></td></tr>
<tr><td>text</td><td>Specifies commands you want to assign to the macro.</td><td></td></tr>
</table>
Option keys

<table class="mtable3 tab">
<tr><td>UP,DOWN</td><td>Arrows recall commands.</td></tr>
<tr><td>Esc</td><td>Clears current command.</td></tr>
<tr><td>F7</td><td>Displays command history.</td></tr>
<tr><td>Alt+F7</td><td>Clears command history.</td></tr>
<tr><td>[chars]F8</td><td>Searches for command beginning with [chars].</td></tr>
<tr><td>F9</td><td>Selects a command by number.</td></tr>
<tr><td>Alt+F10</td><td>Clears macro definitions.</td></tr>
</table>
Below are special codes you can use in Doskey macro definitions.

<table class="mtable3 tab">
<tr><td>$T</td><td>Command separator: allows multiple commands in a macro.</td></tr>
<tr><td>$1-$9</td><td>Batch parameters: equivalent to %1-%9 in batch programs.</td></tr>
<tr><td>$*</td><td>Symbol replaced by everything following macro name on the command line.</td></tr>
</table>
<h2 id="examples">Doskey examples</h2>
doskey

Starts doskey and allows you to press the up or down command to see history, or right or left to retype the previous command.

doskey /history

Show the history of commands run at the command prompt. Since doskey is loaded by default with recent versions of Windows, this command is a quick way to determine what commands were <a href="https://www.computerhope.com/jargon/r/run.htm">run</a> on any open Windows command line window.

<h2>MS-DOS Batch file pause with enter key</h2>
pause command, example:

dir
pause
echo Now about to end...
pause

<h2>display time</h2>
@echo off
@echo %time%
@echo HOUR:%time:~0,2%
@echo MINUTE:%time:~3,2%

Now type: SET/?

Usage: Checktime  15:05 (for example)
@echo off
set Scr="%temp%\TempVBS.vbs"
(  echo if minutes(CDate("%1"^)^) ^> minutes(Now^) Then WScript.Quit 0 Else WScript.Quit 1
   echo Function minutes(dDate^)
   echo   minutes = Hour(dDate^) * 60 + Minute(dDate^)
   echo End Function) > %Scr%
cscript //nologo %Scr%
if %ErrorLevel%==0 (echo Current time is ^< %1) else (echo Current time is ^>= %1)

<h2>play video</h2>
@Echo off
set "file2=res\FORTNITESKINS.mp4"
set wmplayer="%ProgramFiles(x86)%\Windows Media Player\wmplayer.exe" /prefetch:1

%wmplayer% "%file2%" /fullscreen

<h2>Running vbscript from batch file</h2>

VBS synchronously run in the same window
@echo off
pushd %~dp0
cscript necdaily.vbs

VBS to synchronously run in a new window, then

@echo off
pushd %~dp0
start /wait "" cmd /c cscript necdaily.vbs

VBS to asynchronously run in the same window

@echo off
pushd %~dp0
start /b "" cscript necdaily.vbs

VBS to asynchronously run in a new window

@echo off
pushd %~dp0
start "" cmd /c cscript necdaily.vbs

<h2>open a cmd window in a specific location</h2>
<a href="https://stackoverflow.com/questions/60904/how-can-i-open-a-cmd-window-in-a-specific-location" class="whitebut ">open a cmd window in a specific location</a>
In File Explorer, press and hold the Shift key, then right click or press and hold on a folder or drive that you want to open the command prompt at that location for, and click/tap on Open Command Prompt Here option.

<h2>Batch Script - Variables</h2>
There are two types of variables in batch files. 
One is for parameters which can be passed when the batch file is called and the other is done via the set command.

<h3>Command Line Arguments</h3>
Batch scripts support the concept of command line arguments wherein arguments can be passed to the batch file when invoked. 
The arguments can be called from the batch files through the variables %1, %2, %3, and so on.

The following example shows a batch file which accepts 3 command line arguments and echoâ€™s them to the command line screen.

echo off 
echo %1 
echo %2 
echo %3

If the above batch script is stored in a file called test.bat and we were to run the batch as

Test.bat 1 2 3

Following is a screenshot of how this would look in the command prompt when the batch file is executed.

<img src="https://www.tutorialspoint.com/batch_script/images/command_line_arguments.jpg">

The above command produces the following output.

1 
2 
3

If we were to run the batch as

Example 1 2 3 4

The output would still remain the same as above. 
However, the fourth parameter would be ignored.

<h2>Set Command</h2>
The other way in which variables can be initialized is via the â€˜setâ€™ command. 
Following is the syntax of the set command.

<h3>Syntax</h3>
set /A variable-name=value

where,
<b>variable-name</b> is the name of the variable you want to set.
<b>value</b> is the value which needs to be set against the variable.
<b>/A â€“</b> This switch is used if the value needs to be numeric in nature.

The following example shows a simple way the set command can be used.

<h3>Example</h3>
echo off 
set message=Hello World 
echo %message%

In the above code snippet, a variable called message is defined and set with the value of "Hello World".
To display the value of the variable, <span class="red">note that the variable needs to be enclosed in the <span class="gold">%</span> sign</span>.

<h3>Output</h3>
The above command produces the following output.

Hello World
<h3>Working with Numeric Values</h3>
In batch script, it is also possible to define a variable to hold a numeric value. 
This can be done by using the /A switch.

The following code shows a simple way in which numeric values can be set with the /A switch.

echo off 
SET /A a = 5 
SET /A b = 10 
SET /A c = %a% &plus; %b% 
echo %c%

We are first setting the value of 2 variables, a and b to 5 and 10 respectively.
We are adding those values and storing in the variable c.
Finally, we are displaying the value of the variable c.

The output of the above program would be 15.

All of the arithmetic operators work in batch files. 
The following example shows arithmetic operators can be used in batch files.

echo off 
SET /A a = 5 
SET /A b = 10 
SET /A c = %a% &plus; %b% 
echo %c% 
SET /A c = %a% - %b% 
echo %c% 
SET /A c = %b% / %a% 
echo %c% 
SET /A c = %b% * %a% 
echo %c%

The above command produces the following output.

15 
-5 
2 
50
<h2>Local vs Global Variables</h2>
In any programming language, there is an option to mark variables as having some sort of scope, i.e. 
the section of code on which they can be accessed. 
Normally, variable having a global scope can be accessed anywhere from a program whereas local scoped variables have a defined boundary in which they can be accessed.

DOS scripting also has a definition for locally and globally scoped variables. 
By default, variables are global to your entire command prompt session. 
Call the SETLOCAL command to make variables local to the scope of your script. 
After calling SETLOCAL, any variable assignments revert upon calling ENDLOCAL, calling EXIT, or when execution reaches the end of file (EOF) in your script. 
The following example shows the difference when local and global variables are set in the script.

<h3>Example</h3>
echo off 
set globalvar = 5
SETLOCAL
set var = 13145
set /A var = %var% + 5
echo %var%
echo %globalvar%
ENDLOCAL

Few key things to note about the above program.

The â€˜globalvarâ€™ is defined with a global scope and is available throughout the entire script.
The â€˜varâ€˜ variable is defined in a local scope because it is enclosed between a â€˜SETLOCALâ€™ and â€˜ENDLOCALâ€™ block. 
Hence, this variable will be destroyed as soon the â€˜ENDLOCALâ€™ statement is executed.

<h3>Output</h3>
The above command produces the following output.

13150
5

You will notice that the command echo %var% will not yield anything because after the ENDLOCAL statement, the â€˜varâ€™ variable will no longer exist.

<h2>Working with Environment Variables</h2>
If you have variables that would be used across batch files, then it is always preferable to use environment variables. 
Once the environment variable is defined, it can be accessed via the % sign. 
The following example shows how to see the JAVA_HOME defined on a system. 
The JAVA_HOME variable is a key component that is normally used by a wide variety of applications.

echo off 
echo %JAVA_HOME%

The output would show the JAVA_HOME directory which would depend from system to system. 
Following is an example of an output.

C:\Atlassian\Bitbucket\4.0.1\jre

<h2>print one single line in a different color</h2>
<a href="https://stackoverflow.com/questions/2048509/how-to-echo-with-different-colors-in-the-windows-command-line" class="whitebut ">print one single line in a different color</a>
Use ANSI Escape Sequences.
<strong>Windows before 10 - no native support for ANSI colors on the console</strong>
For Windows version below 10, the Windows command console doesn't support output coloring by default. You could install either <a href="http://cmder.net/" rel="noreferrer">Cmder</a>, <a href="https://conemu.github.io/" rel="noreferrer">ConEmu</a>, <a href="https://github.com/adoxa/ansicon/releases" rel="noreferrer">ANSICON</a> or <a href="https://mintty.github.io/" rel="noreferrer">Mintty</a> (used by default in GitBash and Cygwin) to add coloring support to your Windows command console.
<strong>Windows 10 - Command Line Colors</strong>
Starting from Windows 10 the Windows console support ANSI Escape Sequences and some colors by default. The feature shipped with the Threshold 2 Update in Nov 2015.
<strong><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/mt638032(v=vs.85).aspx" rel="noreferrer">MSDN Documentation</a></strong>
<strong>Update</strong> (05-2019): The <a href="https://github.com/Microsoft/Terminal/tree/master/src/tools/ColorTool" rel="noreferrer">ColorTool</a> enables you to change the color scheme of the console. It's part of the Microsoft <a href="https://github.com/microsoft/Terminal" rel="noreferrer">Terminal</a> project.
<strong>Demo</strong>
<a href="https://i.stack.imgur.com/gpDPE.png"><img src="https://i.stack.imgur.com/gpDPE.png" alt="enter image description here" /></a>
<strong>Batch Command</strong>
The <a href="https://gist.github.com/mlocati/fdabcaeb8071d5c75a2d51712db24011#file-win10colors-cmd" rel="noreferrer"><code>win10colors.cmd</code></a> was written by <a href="https://github.com/mlocati" rel="noreferrer">Michele Locati</a>:
<em>The text below is stripped of special characters and will not work. You must copy it from <a href="https://gist.githubusercontent.com/mlocati/fdabcaeb8071d5c75a2d51712db24011/raw/b710612d6320df7e146508094e84b92b34c77d48/win10colors.cmd" rel="noreferrer">here</a>.</em>


<h2>load the a text file into a batch file variable</h2>
https://stackoverflow.com/questions/134001/how-can-i-load-the-contents-of-a-text-file-into-a-batch-file-variable/66714820#66714820

If your set command supports the /p switch, then you can pipe input that way.

- Create a file called "SetFile.bat" that contains no carriage return at the end

set FileContents=

Then in batch file do something like this...
   @echo off
   copy SetFile.bat + %1 $tmp$.bat > nul
   call $tmp$.bat
   del $tmp$.bat

%1 is the name of your input file and %FileContents% will contain the contents of the input file after the call. 
This will only work on a one line file though (i.e. a file containing no carriage returns). 
You could strip out/replace carriage returns from the file before calling the %tmp%.bat if needed.

- or:
for /f "delims=" %%i in (count.txt) do set c=%%i
echo %c%
pause

- If your set command supports the /p switch, then you can pipe input that way.

set /p VAR1=&lt;test.txt
set /? |find "/P"

The /P switch allows you to set the value of a variable to a line of input entered by the user.
Displays the specified promptString before reading the line of input. The promptString can be empty.

This has the added benefit of working for un-registered file types (which the accepted answer does not).

- Use for, something along the lines of:

set content=
for /f "delims=" %%i in ('filename') do set content=%content% %%i

Maybe youâ€™ll have to do setlocal enabledelayedexpansion and/or use !content! rather than %content%.

The best batch-file-black-magic-reference:
http://www.rsdn.ru/article/winshell/batanyca.xml.

- set content=
for /f "delims=" %%i in ('type text.txt') do set content=!content! %%i


<h2>batch files command line arguments</h2>
https://www.tutorialspoint.com/batch_script/batch_script_variables.htm
Batch scripts support the concept of command line arguments wherein arguments can be passed to the batch file when invoked. The arguments can be called from the batch files through the variables %1, %2, %3, and so on.

The following example shows a batch file which accepts 3 command line arguments and echoâ€™s them to the command line screen.

@echo off 
echo %1 
echo %2 
echo %3

If the above batch script is stored in a file called test.bat and we were to run the batch as

Test.bat 1 2 3
The above command produces the following output.
1 
2 
3

use %* to mean "all".

Set Command
The other way in which variables can be initialized is via the â€˜setâ€™ command. Following is the syntax of the set command.

Syntax
set /A variable-name=value
where,

variable-name is the name of the variable you want to set.

value is the value which needs to be set against the variable.

/A â€“ This switch is used if the value needs to be numeric in nature.

The following example shows a simple way the set command can be used.

Example
@echo off 
set message=Hello World 
echo %message%
In the above code snippet, a variable called message is defined and set with the value of "Hello World".

To display the value of the variable, note that the variable needs to be enclosed in the % sign.

Output
The above command produces the following output.

Hello World
Working with Numeric Values
In batch script, it is also possible to define a variable to hold a numeric value. This can be done by using the /A switch.

The following code shows a simple way in which numeric values can be set with the /A switch.

@echo off 
SET /A a = 5 
SET /A b = 10 
SET /A c = %a% + %b% 
echo %c%
We are first setting the value of 2 variables, a and b to 5 and 10 respectively.

We are adding those values and storing in the variable c.

Finally, we are displaying the value of the variable c.

The output of the above program would be 15.

All of the arithmetic operators work in batch files. The following example shows arithmetic operators can be used in batch files.

@echo off 
SET /A a = 5 
SET /A b = 10 
SET /A c = %a% + %b% 
echo %c% 
SET /A c = %a% - %b% 
echo %c% 
SET /A c = %b% / %a% 
echo %c% 
SET /A c = %b% * %a% 
echo %c%
The above command produces the following output.

15 
-5 
2 
50
Local vs Global Variables
In any programming language, there is an option to mark variables as having some sort of scope, i.e. the section of code on which they can be accessed. Normally, variable having a global scope can be accessed anywhere from a program whereas local scoped variables have a defined boundary in which they can be accessed.

DOS scripting also has a definition for locally and globally scoped variables. By default, variables are global to your entire command prompt session. Call the SETLOCAL command to make variables local to the scope of your script. After calling SETLOCAL, any variable assignments revert upon calling ENDLOCAL, calling EXIT, or when execution reaches the end of file (EOF) in your script. The following example shows the difference when local and global variables are set in the script.

Example
@echo off 
set globalvar = 5
SETLOCAL
set var = 13145
set /A var = %var% + 5
echo %var%
echo %globalvar%
ENDLOCAL
Few key things to note about the above program.

The â€˜globalvarâ€™ is defined with a global scope and is available throughout the entire script.

The â€˜varâ€˜ variable is defined in a local scope because it is enclosed between a â€˜SETLOCALâ€™ and â€˜ENDLOCALâ€™ block. Hence, this variable will be destroyed as soon the â€˜ENDLOCALâ€™ statement is executed.

Output
The above command produces the following output.

13150
5
You will notice that the command echo %var% will not yield anything because after the ENDLOCAL statement, the â€˜varâ€™ variable will no longer exist.

Working with Environment Variables
If you have variables that would be used across batch files, then it is always preferable to use environment variables. Once the environment variable is defined, it can be accessed via the % sign. The following example shows how to see the JAVA_HOME defined on a system. The JAVA_HOME variable is a key component that is normally used by a wide variety of applications.

@echo off 
echo %JAVA_HOME%
The output would show the JAVA_HOME directory which would depend from system to system. Following is an example of an output.

C:\Atlassian\Bitbucket\4.0.1\jre


<h2>command-prompt execute vbs</h2>
Open a command window
cscript filename.vbs
The output of the script appears in the command window.

To execute VBScript.vbs as a Windows application
Select Start, Run... from the Windows toolbar.
select the script file.

<h2>stash the vbscript in a batch/vbscript file hybrid</h2>
Converter.bat
::' VBS/Batch Hybrid
::' --- Batch portion ---------
rem^ &@echo off
rem^ &call :'sub
rem^ &exit /b

:'sub
rem^ &echo begin batch
rem^ &cscript //nologo //e:vbscript "%~f0"
rem^ &echo end batch
rem^ &exit /b

'----- VBS portion -----
Dim tester
tester = "Convert data here"
Msgbox tester















<script src='https://williamkpchan.github.io/LibDocs/readbook.js'></script>
<script>
var lazyLoadInstance = new LazyLoad({
    elements_selector: ".lazy"
});
</script>
</body></html>