<base href="https://www.computerhope.com">
<head>
<meta http-equiv="Content-Type" content="text/html;  charset=utf-8">

<style type="text/css">

body {
 margin-top: 5%; 
 margin-bottom: 5%; 
 margin-right: 10%; 
 margin-left: 10%; 
 background-color: #000000; 
 color: #109080; 
 font-size: 24px; 
}
a { text-decoration: none; 
	color: #28B8B8; }
a:visited {	color: #389898; }
A:hover {	color: yellow; }
A:focus {	color: red; }
code { color: #28B8B8;  background-color: #002030}
pre { color: gray;  background-color: #001010;  font-size: 16px; }
div {display: inline-block;  width: 48%;  padding: 2px;  border-radius: 4px;  
border: 1px solid gray;  margin: 3px;  vertical-align:middle; }
</STYLE>
</head>
<body>

<h1>How to create a bootable Windows USB drive</h1>

<p class="intro">A common use of a bootable USB flash drive is to use it to boot into Windows. Booting from removable media such as a USB drive allows you to perform diagnostics on a computer that is having trouble booting from the hard drive. You can also use the flash drive to install Windows, instead of using the Windows installation CD.</p>
<p class="tab">This guide will outline making a bootable USB flash drive with Windows XP, Vista, or 7. Before we begin, it is important to note that the computer you want to use your bootable USB drive must be able to use a USB drive as a boot device. Most computers built since Windows Vista was released are capable of booting to a USB device. Prior to the Windows Vista time frame, it's hit or miss with motherboards.</p>
<p class="ce"><img src="/issues/pictures/biosusb.jpg" alt="USB boot options in BIOS (CMOS) setup" width="405" height="463" class="resize450"></p>
<p class="tab">To determine if a computer is capable of booting to a USB device, <a href="/issues/ch000192.htm">access the computer's BIOS</a> and check the bootable device list. If a USB device is listed, set the USB drive to be the first boot device. If you do not see a USB device in the list of bootable devices, your BIOS is not capable of booting to a USB device.</p>
<p class="dtab"><span class="warn">Note:</span> You may need to have your USB flash drive plugged in when you access the BIOS).</p>
<div class="pagenav">
<ul>
<li><a href="#windows-7">Windows Vista and Windows 7 users</a></li>
<li><a href="#winxp">Windows XP users</a></li>
</ul>
</div>
<h2 id="windows-7">Windows Vista and Windows 7 users</h2>
<p class="tab">To make a bootable USB drive for Windows Vista or Windows 7, you need to have Windows Vista or 7 installed on your computer. It is recommended that you have a flash drive of at least 4 GB in size, to store all the necessary files.</p>
<p class="dtab"><span class="tips">Tip:</span> Before you start, plug in the USB drive and backup any files you have stored on the USB drive. The drive will be formatted during this process and all files on it will be deleted.</p>
<p class="dtab"><span class="warn">Note:</span> You need to have a Windows Vista or Windows 7 DVD for these instructions to be successful.</p>
<p class="numdef"><span class="num">1.</span> Open an <a href="/jargon/e/elevated.htm">elevated Windows command line</a> window by clicking <a href="/jargon/s/start.htm">Start</a>, typing in <b>cmd</b> in the search text field, then pressing <b>Ctrl+Shift+Enter</b> on your keyboard (at the same time). You can also access this by navigating to Start, All Programs, Accessories, <a href="/jargon/r/righclic.htm">right-click</a> with your <a href="/jargon/m/mouse.htm">mouse</a> on the Command Prompt menu item and select <b>Run as Administrator</b>.</p>
<p class="numdef"><span class="num">2.</span> At the command prompt, type <b>cd c:\windows\system32</b> to change the directory to the Windows system32 directory. Ensure your USB drive is plugged in, type <b>DISKPART</b>, then press Enter. Type <b>LIST DISK</b> and press Enter.</p>
<ul>
<li>See our <a href="/diskpart.htm">diskpart command</a> page for additional information on this command.</li>
</ul>
<p class="numdef"><span class="num">3.</span> You will see a listing of the disk drives connected to your computer. Find the disk number of your USB drive and type <b>SELECT DISK [USB disk #]</b>, where "[USB disk #]" is the disk # for your USB drive. It should now state that your USB drive is the selected disk. If you're not sure what disk is the USB disk, eject the USB drive, perform step number 2 again, connect the USB drive again, and compare the results. Usually the USB drive will be the last drive.</p>
<p class="numdef"><span class="num">4.</span> Type in the following commands, one by one, pressing Enter after each command.</p>
<p class="tab tcy">CLEAN<br>
<br>
CREATE PARTITION PRIMARY<br>
<br>
SELECT PARTITION 1<br>
<br>
ACTIVE<br>
<br>
FORMAT FS=NTFS<br>
(may take a couple minutes, depending on the USB drive size)<br>
<br>
ASSIGN<br>
<br>
EXIT</p>
<p class="tab">Keep the command prompt window open, but you can minimize it for a little bit.</p>
<p class="numdef"><span class="num">5.</span> You will now need your Windows Vista or 7 Installation DVD. Put the DVD in your computer's DVD drive. Open up <a href="/jargon/m/mycomput.htm">My Computer</a> and note which drive letter is assigned to your DVD Drive and your USB flash drive.</p>
<p class="numdef"><span class="num">6.</span> Go back to the command prompt window and type in <b>D: CD BOOT</b> (substitute your DVD drive letter for "D:", if necessary) and press Enter. Type <b>CD BOOT</b> again and press Enter. Lastly, type <b>BOOTSECT.EXE /NT60 H:</b> (substitute your USB flash drive letter for "H:", if necessary) and press Enter.</p>
<p class="numdef"><span class="num">7.</span> The last step is to copy the entire contents of the Windows DVD to your USB flash drive. To do this, in the My Computer window (opened in step 5 above), right-click on the DVD drive and select <b>Open</b> to view the contents of the DVD. Copy all the files and folders on the DVD to the USB flash drive.</p>
<p class="tab">Your USB flash drive is now set up to be a bootable USB drive for Windows Vista or 7.</p>
<h2 id="winxp">Windows XP users</h2>
<p class="tab">To make the bootable USB drive for Windows XP, it is recommended that you have a flash drive of at least 4 GB in size, to store all the necessary files. You also need to download <b>Windows Server 2003 SP1</b>.</p>
<ul>
<li><a href="https://www.microsoft.com/en-us/download/details.aspx?id=11435" target="_blank">Windows Server 2003 SP1</a></li>
</ul>
<p class="dtab"><span class="tips">Tip:</span> Before you start, plug in the USB drive and backup any files you have stored on the USB drive. The drive will be formatted during this process and all files on it will be deleted.</p>
<p class="dtab"><span class="warn">Note:</span> You need to have a Windows XP
Professional CD for these instructions to be successful. Windows XP Home Edition does not work.</p>
<p class="numdef"><span class="num">1.</span> Install PE Builder on your computer. For the sake of ease, install the program to a <b>C:\PEBuilder</b> folder. After you've installed PE Builder, create a folder titled <b>SRSP1</b> in the PEBuilder folder.</p>
<p class="numdef"><span class="num">2.</span> Now you need to extract two files from Windows Server 2003 SP1. The file name is quite long, so it is recommended that you <a href="/issues/ch000846.htm">rename the file</a> to something shorter, like <b>WS-SP1.exe</b>. Open a command prompt (<a href="/jargon/s/start.htm">Start</a> &gt; Run, type cmd and press Enter) and use the <a href="/cdhlp.htm">cd command</a> to change to the folder where you downloaded the Windows Server 2003 SP1 file to (i.e. <b><i>cd c:\downloads</i></b> to change to the c:\downloads folder). Then, type <b>WS-SP1.exe -x</b> to extract the files. A window should open asking where to extract the files. You can enter the same folder where the file was downloaded.</p>
<p class="numdef"><span class="num">3.</span> A new folder titled i386 will be created by the extraction process. Type <b>cd i386</b> to change to that folder. You now need to copy the setupldr.bin file to the SRSP1 folder you created in the PE Builder folder. Type <b>copy setupldr.bin c:\PEBuilder\SRSP1</b> to copy the file.</p>
<p class="numdef"><span class="num">4.</span> You also need to expand the ramdisk.sys file to the SRSP1 folder.<br>
Type <b>expand -r ramdisk.sy_ c:\PEBuilder\SRSP1</b></p>
<p class="numdef"><span class="num">5.</span> Open <a href="/jargon/m/mycomput.htm">My Computer</a> and navigate to the c:\PEBuilder\SRSP1 folder and verify the two files are there.</p>
<p class="numdef"><span class="num">6.</span> Next, you need to create a compressed version of Windows XP using PE
Builder. Make sure the Windows XP Professional CD is in your computer's CD drive, then launch the PE Builder program. In the Source field, type in the drive letter assigned to your CD Drive (you can check in My Computer if you are not sure) (e.g. "<b>d:</b>"). In the Output field, type <b>BartPE</b>. Make sure the <b>None</b> option is selected in the Media output section. Then click the <b>Build</b> button.</p>
<p class="ce"><img src="/issues/pictures/bartpe.jpg" alt="Bart PE" width="391" height="328" class="resize400"></p>
<p class="tab">A progress report shows the progress of the bootable image build. When the build process is complete, click the Close button.</p>
<p class="numdef"><span class="num">7.</span> Now, you can create the bootable USB flash drive. Open a command prompt again and type <b>cd c:\PEBuilder</b> to change to the PEBuilder folder. Make sure your USB drive is plugged in to your computer. Then, type <b>pe2usb -f e:</b> (change "e:" to the drive letter assigned to your USB flash drive, if necessary) to create the bootable drive. When prompted to begin the process, type <b>YES</b>. When the process is complete, press any key to exit the program.</p>
<p class="tab">Your USB flash drive is now set up to be a bootable USB drive for Windows XP using the Bart PE interface.</p>


</body>
</html>