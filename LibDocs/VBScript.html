<base target="_blank"><html><head><title>VBScript Scripting Techniques</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script src="https://williamkpchan.github.io/lazyload.min.js"></script>
<script src='https://williamkpchan.github.io/mainscript.js'></script>
<script src="https://williamkpchan.github.io/commonfunctions.js"></script>
<script>
  var showTopicNumber = false;
  var topicEnd = "<br>";
  var bookid = "VBScript Scripting Techniques"
  var markerName = "h2"
</script>
<style>
body{width:80%;margin-left: 10%; font-size:24px;}
h1, h2 {color: gold;}
k, strong {color: orange;}
img {max-width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%; border-radius:3px;}

</style></head><body onkeypress="chkKey()"><center>
<h1>VBScript Scripting Techniques</h1>
<div id="toc"></div></center><br><br>
<pre><br><br>
<a href="https://www.robvanderwoude.com/vbstech.php" class="whitebut ">robvanderwoude</a>

<h2><k>Debugging Your Scripts</k></h2>
Scripts will seldom be perfect right away.
This page describes some (debugging) techniques that will help you avoid errors in VBScript, or to find and correct them.

<a href="#NeverAssume">Never assume anything</a>
<a href="#OptionExplicit">Always use <code>Option Explicit</code> and declare all variables</a>
<a href="#OnErrorResumeNext">(Temporarily) disable all <code>On Error Resume Next</code> lines</a>
<a href="#Modularize">Modularize your scripts with functions and subroutines</a>
<a href="#DescriptiveNames">Use descriptive names for variables, functions and subroutines</a>
<a href="#Initialize">Initialize variables</a>
<a href="#NestedFunctions">Avoid nested functions</a>
<a href="#Log">Display or log intermediate results like variable values and return codes</a>
<a href="#DebugWindow">Create and use a debug window</a>
<a href="#Editor">Use a VBScript aware editor or IDE with built-in debugger</a>
<a href="#Comments">Document your scripts with useful comments</a>
<a href="#ErrorHandling">Use custom error handling</a>
<a href="#Cleanup">Clean up</a>
<a href="#WSHVersion">Check the WSH version</a>
<a href="#Debugger">Use a debugger, if available</a>

<strong>For HTAs only:</strong>
<a href="#MSHTA">Test for 32-bit MSHTA.EXE on 64-bit Windows</a>




<h2 id="NeverAssume">&emsp;Never assume anything</h2>
This may be <em>the</em> most important thing to keep in mind when scripting &mdash; <em>in any language.</em>


Never assume a WSH version.
Check it using <code>WScript.Version</code>!
Read more about <a href="#WSHVersion">WSH versions</a>.
Never assume a Windows version.
Check it!
Never assume Windows' "bittedness" (32-bit vs. 64-bit), test in case it might be critical (i.e. when third party COM objects or external commands are used).
Never even assume the script runs in a 64-bit environment when on 64-bit Windows!
See the paragraph "<a href="#MSHTA">Test for 32-bit MSHTA.EXE on 64-bit Windows</a>" below to see how you can test this in HTAs.
Never assume .NET Framework is installed.
<a href="softwarerequirements.php#RegLocations">Check it</a>!
Never assume a script runs with administrative rights.
Check it!
Never assume access to WMI is allowed.
Use custom error handling to check it!
Never assume write access.
Again, check it!
Never assume an open Internet connection.
Check, check, check!
If you create a new instance of an object, use custom error handling with <code>Err</code> and <code>IsObject</code> to check if it was successfully created.
Always check if required extensions are available before trying to use them!
Well, you get the idea...


Use common sense.

Make sure you log any requirements that aren't met, and/or display descriptive error messages.



<h2 id="OptionExplicit">&emsp;Always use <code>Option Explicit</code> and declare all variables</h2>
It may seem a nuisance to force yourself to declare all variables, but trust me, <code>Option Explicit</code> will save you a <em>lot</em> of time searching for errors caused by typos in variable names.
It will also help you find variables with the wrong scope (local vs. global).



<h2 id="OnErrorResumeNext">&emsp;(Temporarily) disable all <code>On Error Resume Next</code> lines</h2>
When you're looking for the cause of an error, you <em>do</em> want to see the error messages stating which line in the code generates the error.
So "comment out" any <code>On Error Resume Next</code> lines while testing/debugging.
And whenever you really <em>do</em> need to use <code>On Error Resume Next</code>, check for errors (<code>If Err Then...</code>), and switch back to <code>On Error Goto 0</code> as soon as possible.



<h2 id="Modularize">&emsp;Modularize your scripts with functions and subroutines</h2>
Any block of code that will be used more than once can be moved into a subroutine or function.
Dividing the code into logical subroutines and functions will improve readability of your script, and thus will make maintenance a lot easier.
If a "self-contained" subroutine or function has been debugged, it will save debugging time when you reuse it in another script.

If your function or subroutine receives parameters, use distinctive parameter names to avoid conflicts with global variables.
Do not use an existing variable name for a parameter name.
As you may have noticed, I use the prefix <code>my</code> for parameter names in my own scripts.
Choose any naming system you want, but be consistent, and keep in mind that some day others may need to understand your code.

To be completely on the safe side, use <code>ByVal</code> as in

Function MyFunc( ByVal varParameter )

to prevent changing the value of an existing global variable named <code>varParameter</code> in the global scope.

Experiment with <a href="./files/byvalref_vbs.txt">Denis St-Pierre's ByVal/ByRef test script</a> to become familiar with the concepts.



<h2 id="DescriptiveNames">&emsp;Use descriptive names for variables, functions and subroutines</h2>
You are (almost) completely free to use any name for a variable, subroutine or function.
However, instead of using a name like <code>f</code>, why not use <code>objFSO</code> for a FileSystem object?
Or <code>Decode</code> instead of <code>dec</code> as a function name?
Imagine what a difference it will make when someone else needs to read and understand your code (or you yourself a couple of months from now...).
By choosing logical, descriptive names, you may also save yourself time while debugging.

You may have noticed that many scripters use the first character, or the first 3 characters, of variable names to specify the data type: <code><em>obj</em>FSO</code> for a (FileSystem) <em>obj</em>ect, <code><em>int</em>DaysPerWeek</code> for <em>int</em>egers, etc.
Though in VBScript <em>any</em> variable can contain <em>any</em> type of data at <em>any</em> time, this naming convention helps make clear what type of data a variable is <em>supposed</em> to contain.

For function or subroutine that receive parameters, use distinctive parameter names to avoid conflicts with global variables.
Using existing variable names for parameter names spells trouble.
As you may have noticed, I use the prefix <code>my</code> for parameter names in my own scripts.
You can choose any naming system you want.
But <em>do</em> keep it consistent.
Keep in mind that some day others may need to understand your code.

Again, to be completely on the safe side, use <code>ByVal</code> as in

Function MyFunc( ByVal varParameter )

to prevent changing the value of an existing global variable named <code>varParameter</code> in the global scope.

I urge you to try <a href="./files/byvalref_vbs.txt">Denis St-Pierre's ByVal/ByRef test script</a> to build an understanding of the concepts.
It may save you <em>days</em> of stressful debugging.



<h2 id="Initialize">&emsp;Initialize variables</h2>
This may be important when you use loop counters other than <code>For</code> loops: make sure the counter variable has a valid value to start with.
Also watch out for global variables that are used in subroutines or functions.



<h2 id="NestedFunctions">&emsp;Avoid nested functions</h2>
A one-liner like:

strFullPath   = "C:\Documents and Settings\Me\Application Data"
strParentName = Right( Left( strFullPath, InStrRev( strFullPath, "\" ) - 1 ),  _
 Len( Left( strFullPath, InStrRev( strFullPath, "\" ) - 1 ) ) - _
 InStrRev( Left( strFullPath, InStrRev( strFullPath, "\" ) - 1 ), "\" ) )

is hard to debug if it returns the wrong result.
Split it up in several lines, each without nested functions, and use variables to contain the intermediate results:

strFullPath   = "C:\Documents and Settings\Me\Application Data"
intLastSlash  = InStrRev( strFullPath, "\" )
strParentName = Left( strFullPath, intLastSlash - 1 )
intParentLen  = Len( strParentName ) - InStrRev( strParentName, "\" )
strParentName = Right( strParentName, intParentLen )

Now, if the code doesn't do what it is supposed to do, you can have a look at the intermediate results to check where the problem lies.



<h2 id="Log">&emsp;Display or log intermediate results like variable values and return codes</h2>
To check the script's program flow, and the values of variables during execution, it helps to display variable names and their values during run time.
If external commands or objects are used, display their return codes as well.

Write every detail in a log file too, preferably with a timestamp in order to detect possible delays.
If subroutines or (user defined) functions are used, log each call to these subroutines, it will help you follow the program flow.

If I expect problems with a script, I often add an optional <code>/DEBUG</code> command line switch, which will tell the script to log even more details.



<h2 id="DebugWindow">&emsp;Create and use a debug window (obsolete as of June 15, 2022)</h2>
This is a trick I learned from Don Jones, who describes it in his book VBScript, WMI, and ADSI Unleashed: Using VBScript, WMI, and ADSI to Automate Windows Administration.

Dim objIEDebugWindow

Debug "This is a great way to display intermediate results in a separate window."


Sub Debug( myText )
' Uncomment the next line to turn off debugging
' Exit Sub

If Not IsObject( objIEDebugWindow ) Then
Set objIEDebugWindow = CreateObject( "InternetExplorer.Application" )
objIEDebugWindow.Navigate "about:blank"
objIEDebugWindow.Visible = True
objIEDebugWindow.ToolBar = False
objIEDebugWindow.Width   = 200
objIEDebugWindow.Height  = 300
objIEDebugWindow.Left    = 10
objIEDebugWindow.Top     = 10
Do While objIEDebugWindow.Busy
WScript.Sleep 100
Loop
objIEDebugWindow.Document.Title = "IE Debug Window"
objIEDebugWindow.Document.Body.InnerHTML = "&lt;b>" & Now & "&lt;/b>&lt;/br>"
End If

objIEDebugWindow.Document.Body.InnerHTML = objIEDebugWindow.Document.Body.InnerHTML & myText & "&lt;br />" & vbCrLf
End Sub


Notes:
Notes:(1)Since Internet Explorer support ended June 15, 2022, this technique is <strong>no longer recommended.</strong>
(2)<code>objIEDebugWindow</code> <em>must</em> be declared in the main script body, not in the subroutine (must be global)!
(3)Do <em>not</em> discard the <code>objIEDebugWindow</code> object at the end of the script, or your debug window will vanish!


And this is what the debug window looks like:

<img data-src="https://www.robvanderwoude.com/pictures/ie_debugwindow.gif" width="250" height="300" />



<h2 id="Editor">&emsp;Use a VBScript aware editor or IDE</h2>
<h3>&emsp;with built-in debugger and object browser</h3>
There are several VBScript aware editors (IDEs) available, some with built-in debugger.
The main advantages of these editors are:


Different colors for commands and keywords: a typo will result in the wrong color
IntelliSense <sup>&trade;</sup> like "intelligence" and <a href="vbstech_objectbrowsers.php">object browser</a>: type a dot after an object name and you'll get a drop-down list of available properties and methods
Built-in debugger: run the script "inside" the editor, add breakpoints, monitor variable values, get improved error handling


My personal favorite is <a href="http://www.vbsedit.com/">VbsEdit</a>, which saves me a lot of time and frustration when writing in VBScript.

Because there are more editors and more scripting languages, I compiled a <a href="scripteditors.php">list of script editors and IDEs</a>.



<h2 id="Comments">&emsp;Document your scripts with useful comments</h2>
It is always wise to add comments explaining what a script, or part of the script, does.
However, make sure the comments are relevant for future use &mdash; scripts need maintenance every now and then, and comments can help make this easier.

If you intend to reuse code, like subroutines or user defined functions, it is essential to describe the functionality in comments.
Include a description of what the routine is intended for, its requirements, input parameters, output and/or return codes.

In short, describe it as a "black box": what goes in, what comes out, and how are the two related.



<h2 id="ErrorHandling">&emsp;Use custom error handling</h2>
It is ok to use the scripting engine's built-in error handling, but adding your own custom error handling may result in a better "user experience".

Insert a line <code>On Error Resume Next</code> just before some code that <em>might</em> cause trouble.
Insert another block of code <em>after</em> that suspect code to deal with potential errors.
Use <code>Err</code> or <code>Err.Number</code> and <code>Err.Description</code> to detect and log and maybe even correct errors.
If no more problems are expected, insert a line <code>On Error Goto 0</code> after the custom error handling code to restore the default built-in error handling.

On Error Resume Next

' some code that might raise an error

If Err Then
WScript.Echo "Error # " & Err.Number
WScript.Echo Err.Description
' take some action, or in this case, abort the script with return code 1
WScript.Quit 1
End If



<h2 id="Cleanup">&emsp;Clean up</h2>
It is usually advisable to clean up any leftover objects at the end of the script.
Objects like the FileSystem object, Internet Explorer and others may cause memory leaks if they aren't discarded and new instances are being opened all the time.

Just make sure to add a <code>Set <em>objectName</em> = Nothing</code> line at each "exit" (just before each <code>WScript.Quit</code>) and end of the program flow.

Objects that are "created" inside a subroutine or function should always be discarded at the end of the routine.
A known exception to this rule is the <a href="#DebugWindow">Internet Explorer Debug Window</a> discussed before.



<h2 id="WSHVersion">&emsp;Check the WSH version</h2>
<img data-src="https://www.robvanderwoude.com/pictures/vbscriptversion.gif" width="196" height="129" /><img data-src="https://www.robvanderwoude.com/pictures/wshversion58_343x169.gif" width="343" height="169" />

Ok, so you wrote your script, tested it on your own computer, maybe even on multiple computers, and everything seems to work fine.
Does that mean your script is ready to be distributed?

Would I ask if it were? &#x1f609;

No, we are not done yet.
A final screening is necessary to find out the minimum WSH version required to run the script.

Browse through your script and for each command you used, look up the WSH version required in MSDN's <a href="http://msdn.microsoft.com/en-us/library/4y5y7bh5%28VS.85%29.aspx">VBScript Version Information</a> tables (<a href="http://msdn.microsoft.com/en-us/library/s4esdbwz%28VS.85%29.aspx">JScript Version Information</a> is available too).
The WSH version required for a particular command can be found in the page's <em>second</em> table.


Note:
Note:Besides using the MSDN links above, you can also use the <a href="http://download.microsoft.com/download/winscript56/Install/5.6/W982KMeXP/EN-US/scrdoc56en.exe">WSH documentation in .chm format</a>


Write down any required WSH version <em>greater than</em> 1.0.
The highest/latest version you wrote down is the minimum WSH version required to run your script.
Now check the <a href="http://msdn.microsoft.com/en-us/library/4y5y7bh5%28VS.85%29.aspx">VBScript Version Information</a> page's <em>first</em> table to see if the minimum WSH version requirement is met by all client computers you had in mind...

In case you aren't sure about the client computers, you can make your script itself perform a check, using:

intMajorVerion = 0 + CInt( Mid( WScript.Version, 1, InStr( WScript.Version, "." ) - 1 ) )
intMinorVerion = 0 + CInt( Mid( WScript.Version, InStr( WScript.Version, "." ) + 1 ) )
intCheckVersion = 1000 * intMajorVerion + intMinorVerion
If intCheckVersion &lt; 5005 Then
WScript.Echo "Sorry, this script requires WSH 5.5 or later"
WScript.Quit intCheckVersion
End If


Note:
Note:Yes, this check is safe, all commands and functions used were available in the very first WSH version




<h2 id="Debugger">&emsp;Use a debugger, if available</h2>
This tip was sent by Tom Hoff: use <code>CSCRIPT //X <em>yourscript.vbs</em></code> to execute your script in a debugger.

You will be prompted to choose a debugger from a list of available debuggers.

Debuggers that can be used for VBScript include (but are, most likely, not limited to):


<a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=2F465BE0-94FD-4569-B3C4-DFFDF19CCD99">Microsoft Script Debugger</a>
Microsoft Script Editor (comes with Microsoft Office)
<a href="http://www.microsoft.com/express/downloads/">Visual Studio's debugger</a>




<h2><k>For HTAs only:</k></h2>
<h2 id="MSHTA">&emsp;Test for 32-bit MSHTA.EXE on 64-bit Windows</h2>
Sometimes an HTA can cause trouble when running with 32-bit MSHTA.EXE on a 64-bit Windows.
This is especially true when 64-bit external commands need to be executed: a 32-bit MSHTA process simply cannot start a 64-bit external command.

The following sample code warns the user for this condition when the HTA is loaded:

Sub Window_OnLoad( )
Dim colItems, intMSHTA, intWindows, objItem, objWMIService
' intMSHTA will contain MSHTA.EXE's "bittedness"
intMSHTA = CInt( Right( window.navigator.platform, 2 ) )
' Use WMI to determine Windows' own "bittedness"
Set objWMIService = GetObject( "winmgmts://./root/cimv2" )
Set colItems = objWMIService.ExecQuery( "SELECT * FROM Win32_Processor" )
For Each objItem in colItems
' intWindows will contain Windows' "bittedness"
intWindows = CInt( objItem.AddressWidth )
Next
Set objWMIService = Nothing
' Display a warning message if the "bittednesses" don't match
If intWindows &lt;> intMSHTA Then
MsgBox "You are running this HTA with the " _
 & intMSHTA _
 & "-bit MSHTA on a " _
 & intWindows _
 & "-bit Windows"
End If
End Sub



<img data-src="https://www.robvanderwoude.com/pictures/32bitmshtaon64bitwindows436x154.jpg" width="436" height="154" />

<h2><k>Arrays</k></h2>
<a href="#Sort">Sort</a>
Case insensitive bubble sort subroutine
<a href="#Display">Display</a>
Display the entire array's content on screen
<a href="#Reverse">Reverse</a>
Reverse the order of array elements




<h2 id="Sort">&emsp;Sort</h2>
<a href="http://www.microsoft.com/technet/scriptcenter/resources/qanda/nov04/hey1122.mspx">Bubble sort algorithm</a> borrowed from the Scripting Guys.

Case insensitive sorting subroutine.

<h4>Usage:</h4>

Sort <em>array_name</em>

<h4>VBScript code:</h4>

Sub Sort( ByRef myArray )
Dim i, j, strHolder

For i = ( UBound( myArray ) - 1 ) to 0 Step -1
For j= 0 to i
If UCase( myArray( j ) ) > UCase( myArray( j + 1 ) ) Then
strHolder        = myArray( j + 1 )
myArray( j + 1 ) = myArray( j )
myArray( j )     = strHolder
End If
Next
Next 
End Sub




<h2 id="Display">&emsp;Display</h2>
List the contents of an array on screen.

<h4>VBScript code:</h4>

WScript.Echo Join( <em>myArray</em>, vbCrLf )



<h2 id="Reverse">&emsp;Reverse</h2>
Subroutine to reverse the order of array elements.

<h4>Usage:</h4>

Reverse <em>array_name</em>

<h4>VBScript code:</h4>

Sub Reverse( ByRef myArray )
Dim i, j, idxLast, idxHalf, strHolder

idxLast = UBound( myArray )
idxHalf = Int( idxLast / 2 )

For i = 0 To idxHalf
strHolder              = myArray( i )
myArray( i )           = myArray( idxLast - i )
myArray( idxLast - i ) = strHolder
Next
End Sub


<h2><k>ArrayLists</k></h2>
<a href="vbstech_data_array.php">Arrays</a> can be used in <em>any</em> version of VBScript, and in <em>any</em> Windows version, provided that Windows Script Host is installed.

A (minor) disadvantage of VBScript arrays is that, in order to add an element to an existing array, and then sort that array, you need to:

' [1] Retrieve the index number of the last element in the array
idxLast = UBound( myArray )
' [2] Resize the array, preserving the current content
ReDim Preserve myArray( idxLast + 1 )
' [3] Add the new element to the array
myArray( idxLast + 1 ) = strNewValue
' [4] Sort the array using a <a href="http://www.microsoft.com/technet/scriptcenter/resources/qanda/nov04/hey1122.mspx">"bubble sort" algorithm</a> borrowed from the Scripting Guys
For i = ( UBound( myArray ) - 1 ) to 0 Step -1
For j= 0 to i
If UCase( myArray( j ) ) > UCase( myArray( j + 1 ) ) Then
strHolder = myArray( j + 1 )
myArray( j + 1 ) = myArray( j )
myArray( j ) = strHolder
End If
Next
Next

In <a href="http://technet.microsoft.com/en-us/magazine/2007.01.heyscriptingguy.aspx">this article by the Scripting Guys</a> an alternative technique is discussed: <em>ArrayLists</em>.
The ArrayList is a .NET Framework class, which means it requires the <a href="http://support.microsoft.com/?scid=ph;en-us;548">.NET Framework</a>.

The following code is used to create an ArrayList and "populate" it with some data:

' this code creates and populates an ArrayList
Set myArrayList = CreateObject( "System.Collections.ArrayList" )
myArrayList.Add "F"
myArrayList.Add "B"
myArrayList.Add "D"
myArrayList.Add "C"

Now, to add an element and sort the ArrayList, all we need to do is:

' [1] add the new element to the ArrayList
myArrayList.Add "Z"
' [2] sort the ArrayList
myArrayList.Sort

And how about deleting an element?
In an array you would need to "shift" the elements to fill the gap and then ReDim the array again.
In an ArrayList you would use either <code>myArrayList.Remove "element_value"</code> or <code>myArrayList.RemoveAt "element_index"</code>.

To learn more about the possibilities of the ArrayList class, read this Scripting Guys' <a href="http://technet.microsoft.com/en-us/magazine/2007.01.heyscriptingguy.aspx">article</a>, browse the <a href="https://msdn.microsoft.com/en-us/library/system.collections.arraylist%28v=vs.113%29.aspx">MSDN Library</a>, and <a href="./files/arraylst.zip">download</a> and try my own <a href="./files/arraylist_vbs.txt">ArrayLst.vbs demo script</a>.

<h2><k>SortedList</k></h2>
The .NET SortedList class provides a hash table with automatically sorted key/value pairs.

The available methods and properties are very similar to the ones available in <a href="vbstech_data_arraylist.php">ArrayList</a>.

The following code creates a SortedList and populates it with some key/value pairs:

Set objSortedList = CreateObject( "System.Collections.Sortedlist" )

objSortedList.Add "First", "Hello"
objSortedList.Add "Second", ","
objSortedList.Add "Third", "world"
objSortedList.Add "Fourth", "!"

For i = 0 To objSortedList.Count - 1
WScript.Echo objSortedList.GetKey(i) & vbTab & objSortedList.GetByIndex(i)
Next

This is the resulting output:

FirstHello
Fourth!
Second,
Thirdworld

Note how the list is automatically sorted by <em>keys</em>; it is not possible to sort the list by <em>values</em>.

Like <a href="vbstech_data_arraylist.php">ArrayLists</a>, SortedLists have Count and Capacity properties, and a TrimToSize method, demonstrated in the following code:

WScript.Echo "Size     : " & objSortedList.Count
WScript.Echo "Capacity : " & objSortedList.Capacity
WScript.Echo

objSortedList.TrimToSize

WScript.Echo "Size     : " & objSortedList.Count
WScript.Echo "Capacity : " & objSortedList.Capacity

This will result in the following output:

Size     : 4
Capacity : 16

Size     : 4
Capacity : 4

Cloning a SortedList is a piece of cake:

Set objList2 = objSortedList.Clone
WScript.Echo "Sorted List Key(1) = " & objSortedList.GetKey(1)
WScript.Echo "Cloned List Key(1) = " & objList2.GetKey(1)

The result:

Sorted List Key(1) = Fourth
Cloned List Key(1) = Fourth

Available methods and properties are:

<h4>Methods:</h4>


AddAdds an element with the specified key and value to a SortedList object
ClearRemoves all elements from a SortedList object
CloneCreates a shallow copy of a SortedList object
ContainsDetermines whether a SortedList object contains a specific key
ContainsKeyDetermines whether a SortedList object contains a specific key
ContainsValueDetermines whether a SortedList object contains a specific value
GetByIndexGets the value at the specified index of a SortedList object
GetKeyGets the key at the specified index of a SortedList object
IndexOfKeyReturns the zero-based index of the specified key in a SortedList object
IndexOfValueReturns the zero-based index of the first occurrence of the specified value in a SortedList object
RemoveRemoves the element with the specified key from a SortedList object
RemoveAtRemoves the element at the specified index of a SortedList object
SetByIndexReplaces the value at a specific index in a SortedList object
TrimToSizeSets the capacity to the actual number of elements in a SortedList object


<h4>Properties:</h4>


CapacityGets or sets the capacity of a SortedList object
CountGets the number of elements contained in a SortedList object




<h2 id="Related">&emsp;Related Stuff:</h2>
Microsoft's <a href="http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.aspx">SortedList Class</a> Reference

<h2><k>Integers</k></h2>
<h3>& Integer Divides</h3>
There are 3 distinct methods for Integer Divides in VBScript: <code>x \ y, <span>Int</span>( x / y )</code> and <code><span>CInt</span>( x / y )</code>
The best way to explain the differences between the 3 available Integer Divide methods may be by showing some examples.
The following table lists the outcomes of the 3 methods for a range of values:

<span id="MathDiv"></span>
Demonstration of 3 integer divide methods
Abs(x\y) &lt;=Abs(x/y)Int(x/y) &lt;= x/yCInt(x/y) = x/y roundedto <em>nearest</em> integer

-7\3=-2Int(-7/3)=-3CInt(-7/3)=-2
-6\3=-2Int(-6/3)=-2CInt(-6/3)=-2
-5\3=-1Int(-5/3)=-2CInt(-5/3)=-2
-4\3=-1Int(-4/3)=-2CInt(-4/3)=-1
-3\3=-1Int(-3/3)=-1CInt(-3/3)=-1
-2\3= 0Int(-2/3)=-1CInt(-2/3)=-1
-1\3= 0Int(-1/3)=-1CInt(-1/3)= 0
0\3= 0Int( 0/3)= 0CInt( 0/3)= 0
1\3= 0Int( 1/3)= 0CInt( 1/3)= 0
2\3= 0Int( 2/3)= 0CInt( 2/3)= 1
3\3= 1Int( 3/3)= 1CInt( 3/3)= 1
4\3= 1Int( 4/3)= 1CInt( 4/3)= 1
5\3= 1Int( 5/3)= 1CInt( 5/3)= 2
6\3= 2Int( 6/3)= 2CInt( 6/3)= 2
7\3= 2Int( 7/3)= 2CInt( 7/3)= 2


<h2><k>Random Numbers</k></h2>
<h2 id="WSH">&emsp;WSH</h2>
The following code uses standard VBScript only to generate a random number in the 1..100 range:

Randomize
Wscript.Echo Int( ( 100 - 1 + 1 ) * Rnd + 1 )


The general equation is:

Int( ( <em>upperbound</em> - <em>lowerbound</em> + 1 ) * Rnd + <em>lowerbound</em> )

<h2 id="DotNET">&emsp;.NET Framework</h2>
The following code, borrowed from <a href="http://technet.microsoft.com/en-us/magazine/2007.01.heyscriptingguy.aspx">the Scripting Guys</a>, requires the .NET Framework:

Set objRandom = CreateObject( "System.Random" )
WScript.Echo objRandom.Next_2( 1, 100 )

Looking at this example, the general equation isn't hard to guess:

objRandom.Next_2( <em>lowerbound</em>, <em>upperbound</em> )

<h2 id="TrueRandom">&emsp;<em>True</em> Random Numbers</h2>
Computer generated random numbers are <em>not</em> true random numbers.
They are retrieved from a stored semi-random sequence.
Try the <a href="#WSH">WSH sample</a> <em>without</em> <code>Randomize</code>, have it retrieve multiple random numbers, and then run the script several times.
<em>The outcome will be the same each time you run the script.</em>

That is why websites like <a href="http://www.random.org/">random.org</a> and <a href="http://random.irb.hr/">random.irb.hr</a> exist.
They use atmospheric noise and photonic emission in semiconductors respectively, which is more truly random than anything that computer software can generate.

I wrote 2 functions, a class and a Windows Script Component to retrieve random integers from <a href="http://www.random.org/">random.org</a>:


<a href="vbstech_internet_random.php#RndInt">RndInt</a>, function which returns a single random integer within a specified range
<a href="vbstech_internet_random.php#RndIntArr">RndIntArr</a>, function which returns an array of random integers within the specified range
<a href="vbstech_internet_random_class.php#Random">Random</a>, class which returns an array of random integers within the specified range
<a href="vbstech_internet_random_comp.php#RandomWSC">Random.wsc</a>, component which returns an array of random integers within the specified range


The <a href="vbstech_internet_random.php#SampleScript">sample script</a> on the True Random Functions page shows how to call these functions.
The <a href="vbstech_internet_random_class.php#SampleScript">sample script</a> on the True Random Class page shows how to use the class.
The <a href="vbstech_internet_random_comp.php#SampleScript">sample script</a> on the True Random Windows Script Component page shows how to use the component.

<h2><k>True Random Numbers</k></h2>
<a href="#RndInt">RndInt</a> (Function using <a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
<a href="#RndIntArr">RndIntArr</a> (Function using <a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
<a href="vbstech_internet_random_class.php#Random">Random</a> (Class using <a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
<a href="vbstech_internet_random_comp.php#RandomWSC">Random.wsc</a> (Windows Script Component using <a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
    







RndInt (<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
VBScript Code:

Function RndInt( myMin, myMax )
' Retrieves a single TRUE random integer from http://www.random.org/
'
' Arguments:
' myMin  [int]  lowest possible value for the random integer
' myMax  [int]  highest possible value for the random integer
'
' Returns:
' [int]  random integer within the specified range
'        OR a [string] error message
'
' Note:
' Read http://www.random.org/quota/ if you intend to use this script often
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim intStatus, objHTTP, strAgent, strResult, strURL

If Not IsNumeric( myMin ) Then
    RndInt = "Error (" & myMin & " is not a number)"
    Exit Function
End If

If Not IsNumeric( myMax ) Then
    RndInt = "Error (" & myMax & " is not a number)"
    Exit Function
End If

If Not CInt( myMin ) = myMin Then
    RndInt = "Error (" & myMin & " is not an integer)"
    Exit Function
End If

If Not CInt( myMax ) = myMax Then
    RndInt = "Error (" & myMax & " is not an integer)"
    Exit Function
End If

strURL   = "http://www.random.org/integers/?num=1" _
         & "&min=" & myMin _
         & "&max=" & myMax _
         & "&col=1&base=10&format=plain&rnd=new"
strAgent = "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"

Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", strURL, False
objHTTP.SetRequestHeader "User-Agent", strAgent

On Error Resume Next
objHTTP.Send
intStatus = objHTTP.Status
strResult = Trim( Replace( objHTTP.ResponseText, vbLf, " " ) )
On Error Goto 0

If intStatus = 200 Then
    RndInt = strResult
Else
    RndInt = "Error (Status " & intStatus & ")"
End If

Set objHTTP = Nothing
End Function
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
RndIntArr (<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
VBScript Code:

Function RndIntArr( myMin, myMax, myLength )
' Retrieves TRUE random integers from http://www.random.org/
'
' Arguments:
' myMin     [int]  lowest possible value for the random integer
' myMax     [int]  highest possible value for the random integer
' myLength  [int]  the number of random integers that should be retrieved
'
' Returns:
' [array of int]   array with the requested number of random integers within
'                  the specified range OR an [array of string] error message
'
' Note:
' Read http://www.random.org/quota/ if you intend to use this script often
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim arrResult, i, intStatus, objHTTP, strAgent, strResult, strURL

If Not IsNumeric( myMin ) Then
    RndInt = "Error (" & myMin & " is not a number)"
    Exit Function
End If

If Not IsNumeric( myMax ) Then
    RndInt = "Error (" & myMax & " is not a number)"
    Exit Function
End If

If Not IsNumeric( myLength ) Then
    RndInt = "Error (" & myLength & " is not a number)"
    Exit Function
End If

If Not CInt( myMin ) = myMin Then
    RndInt = "Error (" & myMin & " is not an integer)"
    Exit Function
End If

If Not CInt( myMax ) = myMax Then
    RndInt = "Error (" & myMax & " is not an integer)"
    Exit Function
End If

If Not Abs( CInt( myLength ) ) = myLength Then
    RndInt = "Error (" & myLength & " is not an integer)"
    Exit Function
End If

If myLength &lt; 1 Then
    RndInt = "Error (" & myLength & " is not a valid number of requests)"
    Exit Function
End If

strURL   = "http://www.random.org/integers/" _
         & "?num=" & myLength _
         & "&min=" & myMin _
         & "&max=" & myMax _
         & "&col=1&base=10&format=plain&rnd=new"
strAgent = "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"

Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", strURL, False
objHTTP.SetRequestHeader "User-Agent", strAgent

On Error Resume Next
objHTTP.Send
intStatus = objHTTP.Status
strResult = Trim( Replace( objHTTP.ResponseText, vbLf, " " ) )
arrResult = Split( strResult )
ReDim Preserve arrResult( myLength - 1 )
On Error Goto 0

If intStatus = 200 Then
    RndIntArr = arrResult
Else
    RndIntArr = Array( "Error (Status " & intStatus & ")" )
End If

Set objHTTP = Nothing
End Function
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
Sample Script
VBScript Code:

Option Explicit

Dim arrTest

' Cast 1 die with the RndInt function,
' which returns a single random integer
WScript.Echo RndInt( 1, 6 )

' Cast 2 dice with the RndIntArr function, which
' returns multiple random integers in an array
arrTest = RndIntArr( 1, 6, 2 )
WScript.Echo arrTest(0) & vbCrLf & arrTest(1)
Sample output:
4
6
6




<h2><k>True Random Numbers (Class)</k></h2>
Random (<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
VBScript Code:

Class Random
' This class uses random.org to retrieve true random integers
'
' Properties:
' Busy        R   [boolean]   If TRUE results aren't available yet
' Debug       R   [string]    Debugging information
' Error       R   [boolean]   If TRUE check Debug property for description
' LowerLimit  R/W [integer]   Lower limit of the integer to be returned
' NumRequests R/W [integer]   Number of integers to be returned (default=1)
' Result      R   [array int] Resulting random integers
' UpperLimit  R/W [integer]   Upper limit of the integer to be returned
' Version     R   [string]    This class' version number
'
' Methods:
' Query( )        Start the request for (a) new random integer(s)
' Init( )         Reset all properties
'
' Change Log:
' August 12, 2007               First public release
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Local variables holding the values for the public properties
Private m_LowerLimit, m_UpperLimit, m_NumRequests
Private m_Result, m_Busy, m_Debug, m_Error, m_Version
' Local variables for the Query subroutine (cannot use Private
' inside a subroutine, and using Dim would expose the variables)
Private arrResult, i, intStatus, objHTTP, strAgent, strResult, strURL

' Initialize the variables when the class is initialized
Private Sub Class_Initialize
    m_Debug   = m_Debug & vbCrLf _
   & "[" & Now & "] Class initialization started"
    m_Version = "1.00"
    Init
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Class initialization ended normally"
End Sub

' Get the LowerLimit value
Public Property Get LowerLimit
    m_Debug   = m_Debug & vbCrLf _
   & "[" & Now & "] LowerLimit value read (" & m_LowerLimit & ")"
    LowerLimit = m_LowerLimit
End Property

' Set the LowerLimit value
Public Property Let LowerLimit( myLimit )
    m_Debug  = m_Debug & vbCrLf _
  & "[" & Now & "] Trying to set LowerLimit value to " _
  & myLimit & vbCrLf _
  & Space(22) & "Resetting Result value"
    m_Result = Array( "N/A" )
    If IsNumeric( myLimit ) Then
        If CStr( CInt( myLimit ) ) = CStr( myLimit ) Then
 m_LowerLimit = myLimit
 m_Debug = m_Debug & vbCrLf _
         & "[" & Now & "] LowerLimit value set to " & myLimit
        Else
 m_Debug = m_Debug & vbCrLf _
         & "[" & Now & "] Specified LowerLimit (" _
         & myLimit & ") is not an integer"
 m_Error = True
        End If
    Else
        m_Debug = m_Debug & vbCrLf _
     & "[" & Now & "] Specified LowerLimit (" _
     & myLimit & ") is not a number"
        m_Error = True
    End If
End Property

' Get the UpperLimit value
Public Property Get UpperLimit
    m_Debug   = m_Debug & vbCrLf _
   & "[" & Now & "] UpperLimit value read (" & m_UpperLimit & ")"
    UpperLimit = m_UpperLimit
End Property

' Set the UpperLimit value
Public Property Let UpperLimit( myLimit )
    m_Debug  = m_Debug & vbCrLf _
  & "[" & Now & "] Trying to set UpperLimit value to " _
  & myLimit & vbCrLf _
  & Space(22) & "Resetting Result value"
    m_Result = Array( "N/A" )
    If IsNumeric( myLimit ) Then
        If CStr( CInt( myLimit ) ) = CStr( myLimit ) Then
 m_UpperLimit = myLimit
 m_Debug = m_Debug & vbCrLf _
         & "[" & Now & "] UpperLimit value set to " & myLimit
        Else
 m_Debug = m_Debug & vbCrLf _
         & "[" & Now & "] Specified UpperLimit (" _
         & myLimit & ") is not an integer"
 m_Error = True
        End If
    Else
        m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Specified UpperLimit (" _
 & myLimit & ") is not a number"
        m_Error = True
    End If
End Property

' Get the NumRequests value
Public Property Get NumRequests
    m_Debug     = m_Debug & vbCrLf _
     & "[" & Now & "] NumRequests value read (" & m_NumRequests & ")"
    NumRequests = m_NumRequests
End Property

' Set the NumRequests value
Public Property Let NumRequests( myNum )
    m_Debug  = m_Debug & vbCrLf _
  & "[" & Now & "] Trying to set NumRequests value to " _
  & myNum & vbCrLf _
  & Space(22) & "Resetting Result value"
    m_Result = Array( "N/A" )
    If IsNumeric( myNum ) Then
        If CStr( CInt( myNum ) ) = CStr( myNum ) And myNum > 0 Then
 m_NumRequests = myNum
 m_Debug = m_Debug & vbCrLf _
         & "[" & Now & "] NumRequests value set to " & myNum
        Else
 m_Debug = m_Debug & vbCrLf _
         & "[" & Now & "] Specified NumRequests (" _
         & myNum & ") is not an integer greater than zero"
 m_Error = True
        End If
    Else
        m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Specified NumRequests (" _
 & myNum & ") is not a number"
        m_Error = True
    End If
End Property

' Get the Busy value
Public Property Get Busy
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Busy value read (" & m_Busy & ")"
    Busy = m_Busy
End Property

' Get the Debug value
Public Property Get Debug
'        m_Debug = m_Debug & vbCrLf _
'                & "[" & Now & "] Debug value read (" & m_Debug & ")"
    Debug   = m_Debug
End Property

' Get the Error value
Public Property Get Error
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Error value read (" & m_Error & ")"
    Error   = m_Error
End Property

' Get the Result value
Public Property Get Result
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Result value read (" & Join( m_Result, " " ) & ")"
    Result  = m_Result
End Property

' Get the Version value
Public Property Get Version
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Version value read (" & m_Version & ")"
    Version = m_Version
End Property

' Start the HTTP request to random.org
Public Sub Query( )
    m_Debug  = m_Debug & vbCrLf _
  & "[" & Now & "] Query method started" & vbCrLf _
  & Space(22) & "Resetting Result value"
    m_Result = Array( "N/A" )
    ' Check if a valid LowerLimit was specified
    If Not IsNumeric( m_LowerLimit ) Then
        m_Debug = m_Debug & vbCrLf _
     & "[" & Now & "] LowerLimit value not set (" & m_LowerLimit & ")"
        m_Error = True
    End If
    ' Check if a valid UpperLimit was specified
    If Not IsNumeric( m_UpperLimit ) Then
        m_Debug = m_Debug & vbCrLf _
     & "[" & Now & "] UpperLimit value not set (" & m_UpperLimit & ")"
        m_Error = True
    End If
    ' Check for ANY error
    If m_Error Then
        m_Debug = m_Debug & vbCrLf _
     & "[" & Now & "] An error has occurred (Error=" _
     & m_Error & ")" & vbCrLf _
     & Space(22) & "Aborting Query method"
        m_Result      = Array( "N/A" )
        m_NumRequests = 1
        Exit Sub
    End If

    ' Format the URL for a HTTP request to random.org
    strURL   = "http://www.random.org/integers/" _
  & "?num=" & m_NumRequests _
  & "&min=" & m_LowerLimit  _
  & "&max=" & m_UpperLimit  _
  & "&col=1&base=10&format=plain&rnd=new"
    m_Debug  = m_Debug & vbCrLf _
  & "[" & Now & "] URL string set to:" & vbCrLf _
  & Space(22) & " & strURL & "
    ' User agent string (not critical)
    strAgent = "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"
    m_Debug  = m_Debug & vbCrLf _
  & "[" & Now & "] Agent string set to:" & vbCrLf _
  & Space(22) & " & strAgent & "

    ' Prepare the HTTP request to random.org
    On Error Resume Next
    Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
    If Err Then
        m_Debug = m_Debug & vbCrLf _
     & "[" & Now & "] Could not instantiate WinHTTPRequest object " _
     & "(error: " & Err.Number & ")" & vbCrLf _
     & Space(22) & "Aborting Query method"
        Exit Sub
    Else
        m_Debug = m_Debug & vbCrLf _
     & "[" & Now & "] WinHTTPRequest object instantiated successfully"
    End If
    objHTTP.Open "GET", strURL, False
    objHTTP.SetRequestHeader "User-Agent", strAgent

    ' Set Busy status
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Set Busy status"
    m_Busy = True

    ' Send the HTTP request and store the results
    objHTTP.Send
    If Err Then
        m_Debug = m_Debug & vbCrLf _
     & "[" & Now & "] Error sending WinHTTPRequest"              & vbCrLf _
     & Space(22) & "Error Number      : " & Err.Number           & vbCrLf _
     & Space(22) & "Error Description : " & Err.Description      & vbCrLf _
     & Space(22) & "Error Source      : " & Err.Source           & vbCrLf _
     & Space(22) & "Returned Status   : " & objHTTP.Status       & vbCrLf _
     & Space(22) & "Returned Response : " & objHTTP.ResponseText & vbCrLf _
     & Space(22) & "Aborting Query method"
        Exit Sub
    Else
        intStatus = objHTTP.Status
        strResult = Trim( Replace( objHTTP.ResponseText, vbLf, " " ) )
        arrResult = Split( strResult )
        ReDim Preserve arrResult( m_NumRequests - 1 )
        m_Debug = m_Debug & vbCrLf _
     & "[" & Now & "] WinHTTPRequest sent" & vbCrLf _
     & Space(22) & "Returned Status   : " & intStatus & vbCrLf _
     & Space(22) & "Returned Response : " & strResult
    End If

    On Error Goto 0

    If intStatus = 200 Then
        m_Result = arrResult
    Else
        ' Debug info
        m_Result      = Array( "N/A" )
        m_NumRequests = 1
        m_Error       = True
    End If

    ' Clear Busy status and release WinHTTPRequest object
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Clear Busy status"
    m_Busy = False
    Set objHTTP = Nothing
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Query method ended normally"
End Sub

' Reinitialize all properties
Public Sub Init( )
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Init method started"
    m_Busy        = False
    m_Error       = False
    m_LowerLimit  = "N/A"
    m_NumRequests = 1
    m_UpperLimit  = "N/A"
    m_Result      = Array( "N/A" )
    m_Debug = m_Debug & vbCrLf _
 & "[" & Now & "] Init method ended normally"
End Sub
End Class
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
Sample Script
VBScript Code:

Option Explicit

Dim intRequests

intRequests = 10
Test

intRequests =  0
Test


Sub Test( )
' This is a demo/test subroutine for the Random class
Dim arrTest, clsRandom, i, intTest

Set clsRandom = New Random
clsRandom.LowerLimit  = 1
clsRandom.UpperLimit  = 6
clsRandom.NumRequests = intRequests
clsRandom.Query

WScript.Echo "Version    : " & clsRandom.Version
WScript.Echo "NumRequests: " & intRequests
WScript.Echo "Lower Limit: " & clsRandom.LowerLimit
WScript.Echo "Upper Limit: " & clsRandom.UpperLimit
WScript.Echo "Error      : " & clsRandom.Error & vbCrLf

intTest = 0
arrTest = clsRandom.Result
If IsNumeric( arrTest(0) ) Then
    For i = 0 To clsRandom.NumRequests -1
        WScript.Echo "Result " & i & "   : " & arrTest(i)
        intTest = intTest + arrTest(i)
    Next
    WScript.Echo "Average    : " & ( intTest / clsRandom.NumRequests )
End If
WScript.Echo vbCrLf & "Debug Info : " & clsRandom.Debug & vbCrLf

Set clsRandom = Nothing
End Sub
Sample output:

Version    : 1.00
NumRequests: 10
Lower Limit: 1
Upper Limit: 6
Error      : False

Result 0   : 1
Result 1   : 3
Result 2   : 1
Result 3   : 6
Result 4   : 1
Result 5   : 6
Result 6   : 5
Result 7   : 6
Result 8   : 1
Result 9   : 4
Average    : 3.4

Debug Info : 
[13-08-2007 10:53:03] Class initialization started
[13-08-2007 10:53:03] Init method started
[13-08-2007 10:53:03] Init method ended normally
[13-08-2007 10:53:03] Class initialization ended normally
[13-08-2007 10:53:03] Trying to set LowerLimit value to 1
       Resetting Result value
[13-08-2007 10:53:03] LowerLimit value set to 1
[13-08-2007 10:53:03] Trying to set UpperLimit value to 6
       Resetting Result value
[13-08-2007 10:53:03] UpperLimit value set to 6
[13-08-2007 10:53:03] Trying to set NumRequests value to 10
       Resetting Result value
[13-08-2007 10:53:03] NumRequests value set to 10
[13-08-2007 10:53:03] Query method started
       Resetting Result value
[13-08-2007 10:53:03] URL string set to:
       "http://www.random.org/integers/?num=10&min=1&max=6&col=1&base=10&format=plain&rnd=new"
[13-08-2007 10:53:03] Agent string set to:
       "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"
[13-08-2007 10:53:03] WinHTTPRequest object instantiated successfully
[13-08-2007 10:53:03] Set Busy status
[13-08-2007 10:53:06] WinHTTPRequest sent
       Returned Status   : 200
       Returned Response : 1 3 1 6 1 6 5 6 1 4
[13-08-2007 10:53:06] Clear Busy status
[13-08-2007 10:53:06] Query method ended normally
[13-08-2007 10:53:06] Version value read (1.00)
[13-08-2007 10:53:06] LowerLimit value read (1)
[13-08-2007 10:53:06] UpperLimit value read (6)
[13-08-2007 10:53:06] Error value read (False)
[13-08-2007 10:53:06] Result value read (1 3 1 6 1 6 5 6 1 4)
[13-08-2007 10:53:06] NumRequests value read (10)
[13-08-2007 10:53:06] NumRequests value read (10)

Version    : 1.00
NumRequests: 0
Lower Limit: 1
Upper Limit: 6
Error      : True


Debug Info : 
[13-08-2007 10:53:06] Class initialization started
[13-08-2007 10:53:06] Init method started
[13-08-2007 10:53:06] Init method ended normally
[13-08-2007 10:53:06] Class initialization ended normally
[13-08-2007 10:53:06] Trying to set LowerLimit value to 1
       Resetting Result value
[13-08-2007 10:53:06] LowerLimit value set to 1
[13-08-2007 10:53:06] Trying to set UpperLimit value to 6
       Resetting Result value
[13-08-2007 10:53:06] UpperLimit value set to 6
[13-08-2007 10:53:06] Trying to set NumRequests value to 0
       Resetting Result value
[13-08-2007 10:53:06] Specified NumRequests (0) is not an integer greater than zero
[13-08-2007 10:53:06] Query method started
       Resetting Result value
[13-08-2007 10:53:06] An error has occurred (Error=True)
       Aborting Query method
[13-08-2007 10:53:06] Version value read (1.00)
[13-08-2007 10:53:06] LowerLimit value read (1)
[13-08-2007 10:53:06] UpperLimit value read (6)
[13-08-2007 10:53:06] Error value read (True)
[13-08-2007 10:53:06] Result value read (N/A)




<h2><k>Convert decimal numbers to Roman Numerals vv.</k></h2>
In this section I'll introduce two code snippets to convert 2007 to MMVII to 2007 again.
Only "basic" VBScript is used, so this code should work in any Windows version, in stand-alone scripts, HTAs, or even ASP.

More information on Roman numerals can be found on <a href="http://en.wikipedia.org/wiki/Roman_numerals">WikiPedia</a>.






Decimal2Roman
<strong>VBScript Code:</strong>

Function Decimal2Roman( ByVal intDecimal )
' This Function converts intDecimal to its Roman numeral value.
' Written by: Rob van der Woude, http://www.robvanderwoude.com
'
' intDecimal should be an integer in the range of 1..4999.
'
' For the Roman numeral "modern" notation is used, i.e. 1999
' will be written as MCMXCIX, not MIM.
'
' More information on Roman numerals can be found on WikiPedia:
' http://en.wikipedia.org/wiki/Roman_numerals

' Some housekeeping
Dim strRoman
strRoman = ""

' First, add an "M" for every multiple of 1000
Do While intDecimal >= 1000
    intDecimal = intDecimal - 1000
    strRoman = strRoman & "M"
Loop

' Next, add "CM" for 900, or "D" for 500, or "CD" for 400
If intDecimal >= 900 Then
    intDecimal = intDecimal - 900
    strRoman = strRoman & "CM"
ElseIf intDecimal >= 500 Then
    intDecimal = intDecimal - 500
    strRoman = strRoman & "D"
ElseIf intDecimal >= 400 Then
    intDecimal = intDecimal - 400
    strRoman = strRoman & "CD"
End If

' Add a "C" for every remaining multiple of 100
Do While intDecimal >= 100
    intDecimal = intDecimal - 100
    strRoman = strRoman & "C"
Loop

' Add "XC" for 90, or "L" for 50, or "XL" for 40
If intDecimal >= 90 Then
    intDecimal = intDecimal - 90
    strRoman = strRoman & "XC"
ElseIf intDecimal >= 50 Then
    intDecimal = intDecimal - 50
    strRoman = strRoman & "L"
ElseIf intDecimal >= 40 Then
    intDecimal = intDecimal - 40
    strRoman = strRoman & "XL"
End If

' Add an "X" for every remaining multiple of 10
Do While intDecimal >= 10
    intDecimal = intDecimal - 10
    strRoman = strRoman & "X"
Loop

' Add "IX" for 9, or "V" for 5, or "IV" for 4
If intDecimal >= 9 Then
    intDecimal = intDecimal - 9
    strRoman = strRoman & "IX"
ElseIf intDecimal >= 5 Then
    intDecimal = intDecimal - 5
    strRoman = strRoman & "V"
ElseIf intDecimal >= 4 Then
    intDecimal = intDecimal - 4
    strRoman = strRoman & "IV"
End If

' Finally, add an "I" for every remaining multiple of 1
Do While intDecimal >= 1
    intDecimal = intDecimal - 1
    strRoman = strRoman & "I"
Loop

' Return the result
Decimal2Roman = strRoman
End Function
Requirements:
Windows version:any
Network:N/A
Client software:N/A
Script Engine:any
Summarized:Works in any Windows version, with any scripting engine.
Roman2Decimal
VBScript Code:

Function Roman2Decimal( ByVal strRoman )
' This Function converts strRoman to its decimal numerical value.
' Written by: Rob van der Woude, http://www.robvanderwoude.com
'
' Roman numerals "old style" will still be converted correctly
' into decimal numbers. However, numerals like "MIIIM" for 1997
' would be invalid in any notation, and consequently will
' return invalid results.
'
' More information on Roman numerals can be found on WikiPedia:
' http://en.wikipedia.org/wiki/Roman_numerals

' Some housekeeping
Dim arrRoman( ), intRoman
ReDim arrRoman( Len( strRoman ) -1 )
intRoman = 0

' Store each "digit" of the Roman numeral in an array
For i = 0 To UBound( arrRoman )
    arrRoman( i ) = Mid( strRoman, i + 1, 1 )
Next

' Then convert each "digit" to its numeric value
For i = 0 To UBound( arrRoman )
    Select Case arrRoman( i )
        Case "M"
 arrRoman( i ) = 1000
        Case "D"
 arrRoman( i ) = 500
        Case "C"
 arrRoman( i ) = 100
        Case "L"
 arrRoman( i ) = 50
        Case "X"
 arrRoman( i ) = 10
        Case "V"
 arrRoman( i ) = 5
        Case "I"
 arrRoman( i ) = 1
    End Select
Next

' Now comes the hard part: for each "digit" decide if it will be
' added or subtracted, based on the value of the following "digit"
For i = 0 To UBound( arrRoman ) - 1
    If     arrRoman( i ) &lt; arrRoman( i + 1 ) Then
        ' E.g. "I" in "IX" (9): subtract 1
        intRoman = intRoman - arrRoman( i )
    ElseIf arrRoman( i ) = arrRoman( i + 1 ) Then
        ' E.g. "I" in "XII" (12), "III" (3) or in "IIX" (ancient notation for 8).
        ' The latter should actually be "VIII" in "modern" roman numerals, but
        ' "IIX" was used in ancient times, so let's just be prepared.
        ' We'll add the value to the next position in the array, so it will be
        ' reevaluated in the next iteration of the loop.
        ' Note: this trick will definitely fail on invalid notations like "IIIX".
        arrRoman( i + 1 ) = arrRoman( i ) + arrRoman( i + 1 )
        arrRoman( i )     = 0
    Else ' arrRoman( i ) > arrRoman( i + 1 )
        ' E.g. "V" in "XV" (15): add 5
        intRoman = intRoman + arrRoman( i )
    End If
Next

' The last "digit" doesn't have a following "digit" so it
' can, be added without having to test a following "digit"
intRoman= intRoman + arrRoman( UBound( arrRoman ) )

' Return the calculated value
Roman2Decimal = intRoman
End Function


Sub Syntax( ByVal strErr )
If strErr &lt;> "" Then
    strMsg = vbCrLf & strErr & vbCrLf & vbCrLf
Else
    strMsg = vbCrLf
End If
strMsg = strMsg _
       & "Romans.vbs,  Version 1.01" & vbCrLf _
       & "Convert between Roman and decimal numerals." & vbCrLf & vbCrLf _
       & "Usage:  ROMANS.VBS  numeral" & vbCrLf & vbCrLf _
       & "Where:             ""numeral""  is either a (decimal) integer in the" & vbCrLf _
       & "                              range of 1..4999, or a Roman numeral." & vbCrLf & vbCrLf _
       & "Notes:  [1] Returned Roman numerals follow ""modern"" conventions," & vbCrLf _
       & "            i.e. 1999 will be written as ""MCMXCIX"" instead of ""MIM""." & vbCrLf _
       & "            However, these Roman numerals ""old style"" will still be" & vbCrLf _
       & "            converted correctly into decimal numbers." & vbCrLf _
       & "            Numerals like ""MIIIM"" for 1997 would be invalid in any" & vbCrLf _
       & "            notation, and consequently will return invalid results." & vbCrLf _
       & "        [2] More information on Roman numerals can be found on WikiPedia:" & vbCrLf _
       & "            http://en.wikipedia.org/wiki/Roman_numerals" & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" & vbCrLf _
       & "http://www.robvanderwoude.com"
WScript.Echo strMsg
WScript.Quit( 1 )
End Sub

Requirements:
Windows version:any
Network:N/A
Client software:N/A
Script Engine:any
Summarized:Works in any Windows version, with any scripting engine.




<h2><k>Strings</k></h2>
<a href="#Val">Denis St-Pierre's <code>Val( )</code> function</a>
<a href="#Pad">Pad strings</a>







Val( )
VBScript Code:

Function Val( myString )
' Val Function for VBScript (aka ParseInt Function in VBScript).
' By Denis St-Pierre.
' Natively VBScript has no function to extract numbers from a string.
' Based shamelessly on MS' Helpfile example on RegExp object.
' CAVEAT: Returns only the *last* match found
'         (or, with objRE.Global = False, only the *first* match)

Dim colMatches, objMatch, objRE, strPattern

' Default if no numbers are found
Val = 0

strPattern = "[-+0-9]+"       ' Numbers positive and negative; use
' "&circ;[-+0-9]+" to emulate Rexx' Value()
' function, which returns 0 unless the
' string starts with a number or sign.
Set objRE = New RegExp        ' Create regular expression object.
objRE.Pattern    = strPattern ' Set pattern.
objRE.IgnoreCase = True       ' Set case insensitivity.
objRE.Global     = True       ' Set global applicability:
'   True  => return last match only,
'   False => return first match only.
Set colMatches = objRE.Execute( myString )  ' Execute search.
For Each objMatch In colMatches             ' Iterate Matches collection.
    Val = objMatch.Value
Next
Set objRE= Nothing
End Function
Requirements:
Windows version:Windows 2000 or later, or Internet Explorer 5.0 or later
Network:any
Client software:Internet Explorer 5.0 or later for pre-Windows 2000
Script Engine:any
Summarized:Works in Windows 2000 or later, or Internet Explorer 5.0 or later.
Sample Script
VBScript Code:

Option Explicit

WScript.Echo Val( "That 18 year old is darned hot." )
WScript.Echo Val( "That 18 year old is darned hot. She was born in 1980" )
Sample output:

18
1980






<h2 id="Pad">&emsp;Pad strings</h2>
Sometimes I need to display results in columns.
Using tabs may help but isn't exactly "fail-safe".

For that reason I wrote the VBScript functions
<a href="#LeftPad">LeftPad</a> and
<a href="#RightPad">RightPad</a>.

Some examples to explain their usage:

myString = "ABCDEF"
WScript.Echo Left( myString, 3 )
WScript.Echo Left( myString, 9 )


will display:

ABC
ABCDEF


myString = "ABCDEF"
WScript.Echo LeftPad( myString, 3, "+" )
WScript.Echo LeftPad( myString, 9, "+" )


will display:

ABC
ABCDEF+++


LeftPad will often be used to pad strings with spaces.

RightPad is LeftPad's counterpart:

myString = "ABCDEF"
WScript.Echo Right( myString, 3 )
WScript.Echo Right( myString, 9 )


will display:

DEF
ABCDEF


myString = "ABCDEF"
WScript.Echo RightPad( myString, 3, "+" )
WScript.Echo RightPad( myString, 9, "+" )


will display:

ABC
+++ABCDEF


RightPad will often be used to pad numbers (in strings) with zeroes.

Look at this combination:

Dim arrName(1)
Dim arrAge(1)
arrName(0) = "John Doe"
arrName(1) = "Vanessa James"
arrAge(0)  = 9
arrAge(1)  = 65
WScript.Echo LeftPad( "NAME:", 20, " " ) & RightPad( "AGE:", 4, " " )
For i = 0 To UBound( arrName )
WScript.Echo LeftPad( arrName(i), 20, " " ) & RightPad( arrAge(i), 4, " " )
Next


will display:


NAME:               AGE:
John Doe               9
Vanessa James         65


LeftPad, optionally combined with RightPad, is perfect for
displaying lists, e.g. WMI class properties and their values.



<strong>VBScript code:</strong>

Function LeftPad( strText, intLen, chrPad )
'LeftPad( "1234", 7, "x" ) = "1234xxx"
'LeftPad( "1234", 3, "x" ) = "123"
LeftPad = Left( strText & String( intLen, chrPad ), intLen )
End Function


Function RightPad( strText, intLen, chrPad )
'RightPad( "1234", 7, "x" ) = "xxx1234"
'RightPad( "1234", 3, "x" ) = "234"
RightPad = Right( String( intLen, chrPad ) & strText, intLen )
End Function



<h2><k>Environment Variables</k></h2>
There are several ways to read or write environment variables:


Use the <a href="#WSHShell">WSH Shell object</a>
Use <a href="#Win32_Environment">WMI's Win32_Environment class</a>
Read/write the variables directly from/to the registry


As directly accessing the registry is both risky <em>and</em> usually requires a reboot for the changes to take effect, I would not recommend using it, unless all other methods fail.

<h2 id="WSHShell">&emsp;WSH Shell Object</h2>
<h3>&emsp;Read Environment Variables</h3>
Reading an environment variable is simple:

Set wshShell = CreateObject( "WScript.Shell" )
WScript.Echo wshShell.ExpandEnvironmentStrings( "%PATHEXT%" )
wshShell = Nothing

The output will look like this:

.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH

The <code>ExpandEnvironmentStrings</code> method can expand environment variables embedded in a string too:

Set wshShell = CreateObject( "WScript.Shell" )
WScript.Echo wshShell.ExpandEnvironmentStrings( "PATH=%PATH%" )
wshShell = Nothing

The output will look like this (but probably longer):

PATH=C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem

This behaviour is exactly like that of a batch file: the environment variable is replaced by its value when the string is processed.

<img data-src="https://www.robvanderwoude.com/pictures/envvarscpl.gif" width="384" height="430" />

Some environment variables are actually the result of two variables being merged.
The environment variable <code>PATH</code>, for example, is defined in the <em>system</em> environment as well as in the <em>user</em> environment, as can be seen in this screenshot of the "System" Control Panel applet.

In this case, if we query the <code>PATH</code> environment variable like we did just before, the result will look like this:

PATH=C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;D:\Test

As we can see, the PATH value from the <em>user environment</em> was appended to the value from the <em>system environment</em>.

Other user variables, like <code>TEMP</code>, <em>overwrite</em> their system counterpart:

Set wshShell = CreateObject( "WScript.Shell" )
WScript.Echo wshShell.ExpandEnvironmentStrings( "TEMP=%TEMP%" )
wshShell = Nothing

The output will look like this:

TEMP=C:\DOCUME~1\<em>You</em>\LOCALS~1\Temp


Note:In fact, it gets even more complicated: if you look in the "System" Control Panel applet, you'll notice that the <code>TEMP</code> value in the user environment displays the long path name, not the short 8.3 notation.


Only the <em>system environment values</em> will be available to other users logging on to the same computer, the <em>user environment values</em> are part of the (roaming) profile and hence will be different or even absent for other users.

As you may already have guessed, this technique is not suited for <em>setting</em> environment variables.

To <em>set</em> an environment variable, we first need to find a way to specify <em>in which environment</em> we would like to set that variable.

That is where we use the WSH Shell's <code>Environment</code> method:

Set wshShell = CreateObject( "WScript.Shell" )
Set wshSystemEnv = wshShell.Environment( "SYSTEM" )
WScript.Echo "SYSTEM:  TEMP=" & wshSystemEnv( "TEMP" )
Set wshSystemEnv = Nothing
Set wshShell     = Nothing

Valid parameters for <code>Environment</code> are <code>PROCESS, SYSTEM, USER</code> and <code>VOLATILE</code>.

The resulting output will look like this:

SYSTEM:  TEMP=%SystemRoot%\TEMP

Had we used the <code>PROCESS</code> parameter, the output would have looked like this:

PROCESS:  TEMP=C:\DOCUME~1\Rob\LOCALS~1\Temp

This is the value the WSH Shell's <code>ExpandEnvironmentStrings</code> method would return; <code>ExpandEnvironmentStrings</code> can only read the <em>process environment</em>.

OK, time for a demonstration:

Set wshShell = CreateObject( "WScript.Shell" )
WScript.Echo Left( "Expanded" & Space( 12 ), 12 ) & wshShell.ExpandEnvironmentStrings( "TEMP=%TEMP%" )
arrEnvironments = Array( "PROCESS", "SYSTEM", "USER", "VOLATILE" )
For Each strEnv In arrEnvironments
Set wshEnv = wshShell.Environment( strEnv )
WScript.Echo Left( strEnv & Space( 12 ), 12 ) & "TEMP=" & wshEnv( "TEMP" )
Next
Set wshEnv   = Nothing
Set wshShell = Nothing

This is what the resulting output will look like:

Expanded    TEMP=C:\DOCUME~1\<em>You</em>\LOCALS~1\Temp
PROCESS     TEMP=C:\DOCUME~1\<em>You</em>\LOCALS~1\Temp
SYSTEM      TEMP=%SystemRoot%\TEMP
USER        TEMP=%USERPROFILE%\Local Settings\Temp
VOLATILE    TEMP=

Experiment, play with the code.
So far all we did is <em>read</em> environment variables, which is absolutely harmless.



<h3>&emsp;Set Environment Variables</h3>
After having read the chapter on <em>reading</em> environment variables, <em>setting</em> them is only a small step.

We will use the WSH Shell's <code>Environment</code> method again:

<span>Set wshShell = CreateObject( "WScript.Shell" )
Set wshSystemEnv = wshShell.Environment( "SYSTEM" )
' Display the current value
WScript.Echo "TestSystem=" & wshSystemEnv( "TestSystem" )</span>

' Set the environment variable
wshSystemEnv( "TestSystem" ) = "Test System"

<span>' Display the result
WScript.Echo "TestSystem=" & wshSystemEnv( "TestSystem" )
' Delete the environment variable
wshSystemEnv.Remove( "TestSystem" )
' Display the result once more
WScript.Echo "TestSystem=" & wshSystemEnv( "TestSystem" )
Set wshSystemEnv = Nothing
Set wshShell     = Nothing</span>

The output should look like this:

TestSystem=
TestSystem=Test System
TestSystem=



<h3>&emsp;List Environment Variables</h3>
To list all variables in the <em>user</em> environment:

Set wshShell = CreateObject( "WScript.Shell" )
Set wshUserEnv = wshShell.Environment( "USER" )
For Each strItem In wshUserEnv
WScript.Echo strItem
Next
Set wshUserEnv = Nothing
Set wshShell   = Nothing

The result will look like this:

TEMP=%USERPROFILE%\Local Settings\Temp
TMP=%USERPROFILE%\Local Settings\Temp

If you read the previous chapters you will know how to list the variables from the other environments too.



<h2 id="Win32_Environment">&emsp;WMI's Win32_Environment Class</h2>
Besides being able to access environment variables on remote computers, WMI's Win32_Environment class also allows us to access (read <em>and</em> set) environment variables for other users!

See <a href="http://msdn.microsoft.com/en-us/library/aa394143(VS.85).aspx">MSDN</a> for detailed information on this class' properties.

<h3>&emsp;Read or List Environment Variables</h3>
The following code, created with the help of <a href="https://www.computerperformance.co.uk/vbscript/wmi-scriptomatic/">Scriptomatic</a>, lists all TEMP variables on the local computer:

Set objWMIService = GetObject( "winmgmts://./root/CIMV2" )
strQuery = "SELECT * FROM Win32_Environment WHERE Name='TEMP'"
Set colItems = objWMIService.ExecQuery( strQuery, "WQL", 48 )

For Each objItem In colItems
WScript.Echo "Caption        : " & objItem.Caption
WScript.Echo "Description    : " & objItem.Description
WScript.Echo "Name           : " & objItem.Name
WScript.Echo "Status         : " & objItem.Status
WScript.Echo "SystemVariable : " & objItem.SystemVariable
WScript.Echo "UserName       : " & objItem.UserName
WScript.Echo "VariableValue  : " & objItem.VariableValue
WScript.Echo
Next

Set colItems      = Nothing
Set objWMIService = Nothing

<h3>&emsp;Set Environment Variables</h3>
To set a variable, specify new values for its <code>Name, UserName</code> and/or <code>VariableValue</code> properties.





The following code, from the book Windows Server Cookbook</a> by Robbie Allen, creates a new system environment variable called FOOBAR:

strVarName = "FOOBAR"
strVarValue = "Foobar Value"

Set objVarClass = GetObject( "winmgmts://./root/cimv2:Win32_Environment" )
Set objVar      = objVarClass.SpawnInstance_
objVar.Name          = strVarName
objVar.VariableValue = strVarValue
objVar.UserName      = "&lt;SYSTEM>"
objVar.Put_
WScript.Echo "Created environment variable " & strVarName
Set objVar      = Nothing
Set objVarClass = Nothing

And the following code removes the environment variable again by giving it an empty value: 

strVarName = "FOOBAR"

Set objVarClass = GetObject( "winmgmts://./root/cimv2:Win32_Environment" )
Set objVar      = objVarClass.SpawnInstance_
objVar.Name          = strVarName
objVar.VariableValue = ""
objVar.UserName      = "&lt;SYSTEM>"
objVar.Put_
WScript.Echo "Removed environment variable " & strVarName
Set objVar      = Nothing
Set objVarClass = Nothing

Replace the dot in the <code>GetObject</code> commands by a remote computer name to manage environment variables on that remote computer.

<h2><k>Read MS-Access databases</k></h2>
ADODB
VBScript Code:

Option Explicit

Dim arrTables( ), i, idxTables, intValidArgs
Dim blnContent, blnFieldNames
Dim objConn, objFSO, objRS, objSchema
Dim strConnect, strHeader, strOutput
Dim strFile, strResult, strSQL, strTable

Const adSchemaTables = 20

' Check command line arguments
With WScript.Arguments
If .Unnamed.Count = 1 Then
    strFile = .Unnamed(0)
Else
    Syntax
End If
blnFieldNames = True
blnContent    = True
If .Named.Count > 0 Then
    intValidArgs = 0
    If .Named.Exists( "T" ) Then
        blnFieldNames = False
        blnContent    = False
        intValidArgs  = intValidArgs + 1
    End If
    If .Named.Exists( "TF" ) Then
        blnContent    = False
        intValidArgs  = intValidArgs + 1
    End If
    If intValidArgs &lt;> .Named.Count Then Syntax
End If
End With

' Check if the specified database file exists
Set objFSO = CreateObject( "Scripting.FileSystemObject" )
If Not objFSO.FileExists( strFile ) Then Syntax
Set objFSO = Nothing

' Connect to the MS-Access database
Set objConn = CreateObject( "ADODB.Connection" )
strConnect = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strFile
objConn.Open strConnect

' Search for user tables and list them in an array
Set objSchema = objConn.OpenSchema( adSchemaTables )
idxTables = -1
Do While Not objSchema.EOF
If objSchema.Fields.Item(3).Value = "TABLE" Then
    idxTables = idxTables + 1
    ReDim Preserve arrTables( idxTables )
    arrTables( idxTables ) = objSchema.Fields.Item(2).Value
End If
objSchema.MoveNext
Loop

' List all tables, their column names and their contents
For Each strTable In arrTables
strSQL = "Select * From " & strTable
Set objRS = objConn.Execute( strSQL )
If IsObject( objRS ) Then
    ' Display the current table's name
    If blnContent Then
        WScript.Echo "Table: " & strTable & "
    Else
        WScript.Echo " & strTable & "
    End If
    If blnFieldNames Then
        strOutput = "
        Do While Not objRS.EOF
 ' Create a header line with the column names and data types
 strHeader = "
 For i = 0 To objRS.Fields.Count - 1
     strHeader = strHeader & ","[" _
               & GetDataTypeDesc( objRS.Fields.Item(i).Type ) & "] " _
               & objRS.Fields.Item(i).Name & "
 Next
 strHeader = Mid( strHeader, 2 )
 If blnContent Then
     ' List the fields of the current record in comma delimited format
     strResult = "
     For i = 0 To objRS.Fields.Count - 1
         strResult = strResult & "," & objRS.Fields.Item(i).Value & "
     Next
     ' Add the current record to the output string
     strOutput = strOutput & Mid( strResult, 2 ) & vbCrLf
 End If
 ' Next record
 objRS.MoveNext
        Loop
        ' List the results for the current table
        WScript.Echo strHeader & vbCrLf & strOutput & vbCrLf
    End If
End If
Next

objRS.Close
objSchema.Close
objConn.Close
Set objRS     = Nothing
Set objSchema = Nothing
Set objConn   = Nothing


Function GetDataTypeDesc( myTypeNum )
Dim arrTypes( 8192 ), i
For i = 0 To UBound( arrTypes )
    arrTypes( i ) = "????"
Next
arrTypes(0)     = "Empty"
arrTypes(2)     = "SmallInt"
arrTypes(3)     = "Integer"
arrTypes(4)     = "Single"
arrTypes(5)     = "Double"
arrTypes(6)     = "Currency"
arrTypes(7)     = "Date"
arrTypes(8)     = "BSTR"
arrTypes(9)     = "IDispatch"
arrTypes(10)    = "Error"
arrTypes(11)    = "Boolean"
arrTypes(12)    = "Variant"
arrTypes(13)    = "IUnknown"
arrTypes(14)    = "Decimal"
arrTypes(16)    = "TinyInt"
arrTypes(17)    = "UnsignedTinyInt"
arrTypes(18)    = "UnsignedSmallInt"
arrTypes(19)    = "UnsignedInt"
arrTypes(20)    = "BigInt"
arrTypes(21)    = "UnsignedBigInt"
arrTypes(64)    = "FileTime"
arrTypes(72)    = "GUID"
arrTypes(128)   = "Binary"
arrTypes(129)   = "Char"
arrTypes(130)   = "WChar"
arrTypes(131)   = "Numeric"
arrTypes(132)   = "UserDefined"
arrTypes(133)   = "DBDate"
arrTypes(134)   = "DBTime"
arrTypes(135)   = "DBTimeStamp"
arrTypes(136)   = "Chapter"
arrTypes(138)   = "PropVariant"
arrTypes(139)   = "VarNumeric"
arrTypes(200)   = "VarChar"
arrTypes(201)   = "LongVarChar"
arrTypes(202)   = "VarWChar"
arrTypes(203)   = "LongVarWChar"
arrTypes(204)   = "VarBinary"
arrTypes(205)   = "LongVarBinary"
arrTypes(8192)  = "Array"
GetDataTypeDesc = arrTypes( myTypeNum )
End Function


Sub Syntax
Dim strMsg
strMsg = strMsg & vbCrLf _
       & "AccessRd.vbs,  Version 1.01" & vbCrLf _
       & "Display MS Access database (user) tables and, optionally, their contents"  _
       & vbCrLf & vbCrLf _
       & "Usage:  CSCRIPT  //NOLOGO  ACCESSRD.VBS  access_db_file  [ /T | /TF ]" _
       & vbCrLf & vbCrLf _
       & "Where:  "access_db_file"   is an MS-Access database file"   & vbCrLf _
       & "        /T                 list table names only"             & vbCrLf _
       & "        /TF                list table and field names only"   & vbCrLf _
       & "                           (default is list tables, field names AND contents)" _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" & vbCrLf _
       & "http://www.robvanderwoude.com"
WScript.Echo strMsg
WScript.Quit(1)
End Sub
Requirements:
Windows version:2000 with <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en">MDAC 2.8</a>, XP (SP1 or later), Server 2003, or Vista
Network:any
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en">MDAC 2.8</a> for Windows 2000
Script Engine:any
Summarized:Works in Windows 2000 or later, Windows 2000 requires <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en">MDAC 2.8</a>.







Note:This source code does not contain the full list of constants, only the one used in this sample.
If you intend to experiment with this code, download and use the <a href="./files/officeautomation.zip">full source code</a>.


<h2><k>Read Excel files</k></h2>
ADODB
VBScript Code:

Function ReadExcel( myXlsFile, mySheet, my1stCell, myLastCell, blnHeader )
' Function :  ReadExcel
' Version  :  3.00
' This function reads data from an Excel sheet without using MS-Office
'
' Arguments:
' myXlsFile   [string]   The path and file name of the Excel file
' mySheet     [string]   The name of the worksheet used (e.g. "Sheet1")
' my1stCell   [string]   The index of the first cell to be read (e.g. "A1")
' myLastCell  [string]   The index of the last cell to be read (e.g. "D100")
' blnHeader   [boolean]  True if the first row in the sheet is a header
'
' Returns:
' The values read from the Excel sheet are returned in a two-dimensional
' array; the first dimension holds the columns, the second dimension holds
' the rows read from the Excel sheet.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim arrData( ), i, j
Dim objExcel, objRS
Dim strHeader, strRange

Const adOpenForwardOnly = 0
Const adOpenKeyset      = 1
Const adOpenDynamic     = 2
Const adOpenStatic      = 3

' Define header parameter string for Excel object
If blnHeader Then
    strHeader = "HDR=YES;"
Else
    strHeader = "HDR=NO;"
End If

' Open the object for the Excel file
Set objExcel = CreateObject( "ADODB.Connection" )
' IMEX=1 includes cell content of any format; tip by Thomas Willig.
' Connection string updated by Marcel Ni&euml;nkemper to open Excel 2007 (.xslx) files.
objExcel.Open "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & _
   myXlsFile & ";Extended Properties=""Excel 12.0;IMEX=1;" & _
   strHeader & """"

' Open a recordset object for the sheet and range
Set objRS = CreateObject( "ADODB.Recordset" )
strRange = mySheet & "$" & my1stCell & ":" & myLastCell
objRS.Open "Select * from [" & strRange & "]", objExcel, adOpenStatic

' Read the data from the Excel sheet
i = 0
Do Until objRS.EOF
    ' Stop reading when an empty row is encountered in the Excel sheet
    If IsNull( objRS.Fields(0).Value ) Or Trim( objRS.Fields(0).Value ) = "" Then Exit Do
    ' Add a new row to the output array
    ReDim Preserve arrData( objRS.Fields.Count - 1, i )
    ' Copy the Excel sheet's row values to the array "row"
    ' IsNull test credits: Adriaan Westra
    For j = 0 To objRS.Fields.Count - 1
        If IsNull( objRS.Fields(j).Value ) Then
 arrData( j, i ) = ""
        Else
 arrData( j, i ) = Trim( objRS.Fields(j).Value )
        End If
    Next
    ' Move to the next row
    objRS.MoveNext
    ' Increment the array "row" number
    i = i + 1
Loop

' Close the file and release the objects
objRS.Close
objExcel.Close
Set objRS    = Nothing
Set objExcel = Nothing

' Return the results
ReadExcel = arrData
End Function
Requirements:
Windows version:2000 with <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en">MDAC 2.8</a>, XP (SP1 or later), Server 2003, or Vista
Network:any
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en">MDAC 2.8</a> for Windows 2000
Script Engine:any
Summarized:Works in Windows 2000 or later, Windows 2000 requires <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en">MDAC 2.8</a>.
Sample Script
VBScript Code:

Option Explicit

Dim arrSheet, intCount

' Read and display columns A,B, rows 2..6 of "ReadExcelTest.xlsx"
arrSheet = ReadExcel( "ReadExcelTest.xlsx", "Sheet1", "A1", "B6", True )
For intCount = 0 To UBound( arrSheet, 2 )
WScript.Echo arrSheet( 0, intCount ) & vbTab & arrSheet( 1, intCount )
Next

WScript.Echo "==============="

' An alternative way to get the same results
arrSheet = ReadExcel( "ReadExcelTest.xlsx", "Sheet1", "A2", "B6", False )
For intCount = 0 To UBound( arrSheet, 2 )
WScript.Echo arrSheet( 0, intCount ) & vbTab & arrSheet( 1, intCount )
Next







Note:The source code can be downloaded <a href="./files/officeautomation.zip">here</a>.


<h2><k>XML</k></h2>
To test the code on this page yourself will require some preparation.

I will be using an XML file created by exporting data from <a href="http://www.invelos.com/Products.aspx">DVD Profiler</a>.
So you may want to <a href="http://www.intervocative.com/Downloads.aspx">download the free version</a> first, and start creating your own database.
As an alternative, you can copy and paste this <a href="dvdcoll_xml_src.php">single record from my own DVD database</a>, but it doesn't demonstrate the queries quite as good as a "real" populated database does.

Next you may want to download and install Microsoft's free <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=72D6AA49-787D-4118-BA5F-4F30FE913628&displaylang=en">XML Notepad 2007</a>.
It can be used to display the XML file in <a href="pictures/dvdcoll_treeview.gif">tree view</a> and <a href="pictures/dvdcoll_xslview.gif">XSL view</a>, which makes it easier to see and understand the queries we are going to build.
Or as alternatives, download <a href="http://www.xmlfox.com/">XMLFox</a>, or use your browser, or Notepad, or any other text or <a href="scripteditors.php">programmer's editor</a> (or for the diehards: <a href="type.php">TYPE</a> and MORE).




Checklist:

<input id="xmlfile" name="xmlfile" value="0" type="CHECKBOX" /><label for="xmlfile">XML file "dvdcoll.xml", created by DVD profiler's export function, and preferably located in the current directory</label>
<input id="xmleditor" name="xmleditor" value="0" type="CHECKBOX" /><label for="xmleditor">XML editor</label>
<input id="scripteditor" name="scripteditor" value="0" type="CHECKBOX" /><label for="scripteditor">script editor or IDE, preferably with integrated object browser</label>




Let's get started.
In your editor, IDE or whatever, type the following code:

Set xmlDoc = CreateObject( "Microsoft.XMLDOM" )
xmlDoc.Async = "False"
xmlDoc.Load( "dvdcoll.xml" )


If you have an integrated object browser, you'll probably see a reference to MSXML being inserted.

We'll start with simple query, display each DVD's title:

strQuery = "/Collection/DVD/Title"
Set colNodes = xmlDoc.selectNodes( strQuery )
For Each objNode in colNodes
WScript.Echo objNode.nodeName & ": " & objNode.text
Next


Save the code as a VBScript file and run it.
The result will look like this:

Title: Wild Down Under
Title: Pride
Title: Gandhi
Title: The Abyss
Title: Shouf Shouf Habibi


So, why was the query built like this?

<img data-src="https://www.robvanderwoude.com/pictures/dvdcoll_structure.gif" width="474" height="164" />

Take a look at the image on the right, a fragment of a screenshot of XML Notepad's "XSL Output" window with our XML file loaded (or open the XML file in a plain text editor).

What we see is an opening tag <code>&lt;Collection></code> as the first tag.
This translates to <code>/Collection</code> in the query.
Then, between the opening <code>&lt;Collection></code> and closing <code>&lt;/Collection></code> tags ("inside" the <code>Collection</code>), note the "recordsets" of <code>&lt;DVD></code> and <code>&lt;/DVD></code> tags.
These translate to the <code>DVD</code> part of the query: in the root we find <code>Collections</code>, and inside (or under) <code>Collections</code> we find <code>DVD</code> &mdash; just like a directory structure on a disk.
Inside (or under) <code>DVD</code> there are several tags, <code>Title</code> being one of them.
So now we have <code>/Collection/DVD/Title</code>.


Note:Queries are case sensitive!
Capitalization must match the XML tags exactly.


Now let's move to the next level of complexity for our queries, display multiple properties:

strQuery = "/Collection/DVD/ ( Title | Genres )"



Note:This is the query definition only.
Replace the previous query definition by this new one.
The rest of the script remains unaltered.


The part of the query between parentheses is a list of choices, separated by "pipe" characters (<code>|</code>).
Tags will be listed if they match <em>any</em> of these choices, so <code>Title</code> as well as <code>Genres</code> will be shown for each DVD in the collection.

The result will look like this:

Title: Wild Down Under
Genres: Documentary Special Interest
Title: Pride
Genres: Documentary
Title: Gandhi
Genres: Drama Classic
Title: The Abyss
Genres: Science-Fiction Suspense/Thriller
Title: Shouf Shouf Habibi
Genres: Comedy


The genres are listed as single lines, where each line can contain one (or zero) or more genres.

If you look further down in the XML structure, you'll notice that some keys or tags have subkeys: <code>Genres</code> for example uses <code>Genre</code> subkeys.
Subkeys are used when multiple values are possible.
They can be viewed best in <a href="pictures/dvdcoll_treeview.gif">XML Notepad's treeview</a>.
To list each individual genre we must use <code>/Collection/DVD/Genres/Genre</code>.

So next, let's display the Title <em>and</em> each <em>individual</em> Genre:

strQuery = "/Collection/DVD/ ( Title | Genres/Genre )"

Roughly translated: display anything that matches <code>"/Collection/DVD/Title"</code> or <code>"/Collection/DVD/Genres/Genre"</code>

The result will look like this:

Title: Wild Down Under
Genre: Documentary
Genre: Special Interest
Title: Pride
Genre: Documentary
Title: Gandhi
Genre: Drama
Genre: Classic
Title: The Abyss
Genre: Science-Fiction
Genre: Suspense/Thriller
Title: Shouf Shouf Habibi
Genre: Comedy


Note how some DVDs have multiple Genres.

OK, listing properties for each item in a collection no longer has any secrets for you.
Let's select specific items (DVDs) from the collection.
List the titles and genres of all documentaries:

strQuery = "/Collection/DVD [ Genres/Genre = 'Documentary' ] / ( Title | Genres/Genre )"

The result will look like this:

Title: Wild Down Under
<span>Genre: Documentary</span>
Genre: Special Interest
Title: Pride
<span>Genre: Documentary</span>
Title: March of the Penguins
<span>Genre: Documentary</span>
Title: Alaska: Spirit of the Wild
<span>Genre: Documentary</span>
Genre: Special Interest
Title: Wilderness Journey - Canyon Suites
<span>Genre: Documentary</span>
Genre: Special Interest
Genre: Music


It is possible to select based on genre without displaying it:

strQuery = "/Collection/DVD [ Genres/Genre = 'Documentary' ] /Title"

would only display the titles of the documentaries.

Finally, the selection can be narrowed down by using <code>and</code> and <code>or</code>.
Note that these are case sensitive, so <code>And</code> will <em>not</em> work.

List titles and all formats for each documentary that supports 16x9 format:

strQuery = "/Collection/DVD " _
     & "[ Genres/Genre = 'Documentary' and Format/Format16X9 = 'True' ] " _
     & "/ ( Title | Format/* )"


The result will look like this:

Title: Wild Down Under
FormatAspectRatio: 1.78
FormatVideoStandard: PAL
FormatLetterBox: True
FormatPanAndScan: False
FormatFullFrame: False
<span>Format16X9: True</span>
FormatDualSided: False
FormatDualLayered: False
FormatFlipper: False
Title: Pride
FormatVideoStandard: PAL
FormatLetterBox: True
FormatPanAndScan: False
FormatFullFrame: True
<span>Format16X9: True</span>
FormatDualSided: False
FormatDualLayered: True
FormatFlipper: False




<strong>. . . TO BE CONTINUED . . .</strong>




<h2 id="Related">&emsp;Related Stuff:</h2>
<a href="http://msdn.microsoft.com/en-us/library/ms763798%28v=vs.85%29.aspx">XML DOM Properties</a>
<a href="http://msdn.microsoft.com/en-us/library/ms757828%28v=vs.85%29.aspx">XML DOM Methods</a>
<a href="http://www.westphil.nl/systemadministration/vbscript/index.php?name=createxml">Save information to an XML file</a>, by Adriaan Westra
<a href="http://www.westphil.nl/systemadministration/vbscript/index.php?name=getxmlelement">Get information from an XML file</a>, by Adriaan Westra




<h2><k>Force a script to run in CSCRIPT</k></h2>
There are several valid reasons to demand that a script runs in CSCRIPT instead of WSCRIPT, like for example to allow the use of Standard Input or to prevent a separate popup for each <code>WScript.Echo</code> line.

The following code can be copied and pasted at the top of your own scripts to force them to run in CSCRIPT:

Dim strArgs, strCmd, strEngine, i, objDebug, wshShell

Set wshShell = CreateObject( "WScript.Shell" )

strEngine = UCase( Right( WScript.FullName, 12 ) )

If strEngine &lt;> "\CSCRIPT.EXE" Then
' Recreate the list of command line arguments
strArgs = "
If WScript.Arguments.Count > 0 Then
For i = 0 To WScript.Arguments.Count - 1
strArgs = strArgs & " " & WScript.Arguments(i)
Next
End If

' Create the complete command line to rerun this script in CSCRIPT
strCmd = "CSCRIPT.EXE //NoLogo " & WScript.ScriptFullName & " & strArgs

' Rerun the script in CSCRIPT
Set objDebug = wshShell.Exec( strCmd )

' Wait until the script exits
Do While objDebug.Status = 0
WScript.Sleep 100
Loop

' Exit with CSCRIPT's return code
WScript.Quit objDebug.ExitCode
End If

The code may look more complicated than necessary, that's because it returns CSCRIPT's return code to the WSCRIPT engine, just in case this return code is monitored by the program that started the script in WSCRIPT.

In case you want to force a script to run in <em>WSCRIPT</em> instead, just substitute WSCRIPT.EXE for CSCRIPT.EXE.

Thanks to Howard Bayne who corrected an error in the code (I had forgotten to subtract 1 from the WScript.Arguments.Count in the loop, causing an out-of-range error).

<h2><k>Handle DOS Wildcards</k></h2>
RegExp: GetFiles
List matching file names, absolute or relative path allowed in input filespec, output contains fully qualified paths
VBScript Code:<a href="./files/wildcards.zip">Download</a> <a href="./files/wildcards.zip">&#x1f4be;</a>
<span>Option</span> Explicit WScript<span>.Echo</span> <a href="http://www.google.com/search?q=JOIN+site:msdn.microsoft.com"><span>Join</span></a><span>&#40;</span> GetFiles<span>&#40;</span> WScript<span>.Arguments.Unnamed.Item&#40;0&#41;</span> <span>&#41;</span>, vbCrLf <span>&#41;</span>  <span>Function</span> GetFiles<span>&#40;</span> strFilespec <span>&#41;' Name     : GetFiles' Function : List all files matching the specified filespec, all DOS wildcards allowed' Returns  : An array of fully qualified paths of all matching files, or a single element array with the text "Error"' Remarks  : If no folder is specified, the current directory will be assumed.'            DOS wildcards "*" and "?" are allowed in the FILE name and/or extension, but NOT in the DIRECTORIES.'            E.g. "D:\folder\*file*_*.??" is allowed, but "D:\folder\*\file*.??" is NOT.' Author   : Rob van der Woude, http://www.robvanderwoude.com' Version  : 1.00, 2017-01-31</span> <span>Dim</span> colFiles, objFile, objFolder, objFSO, objRE, wshShell<span>Dim</span> strFiles, strFolder, strPattern GetFiles = <a href="http://www.google.com/search?q=ARRAY+site:msdn.microsoft.com"><span>Array</span></a><span>&#40;</span> <span>"Error"</span> <span>&#41;</span> <span>' Return "Error" if no filespec is specifiedIf</span> <a href="http://www.google.com/search?q=TRIM+site:msdn.microsoft.com"><span>Trim</span></a><span>&#40;</span> strFilespec <span>&#41;</span> = <span>"</span> <span>Then</span> <span>Exit</span> <span>Function</span> <span>' Handle (unlikely) error in specified UNC pathSet</span> objRE = <span>New</span> RegExpobjRE<span>.Pattern</span> = <span>"^\\\\"</span> <span>' Check if filespec starts with double backslashIf</span> objRE<span>.Test&#40;</span> strFilespec <span>&#41;</span> <span>Then' Check if filespec is a valid UNC path: \\server\share\relativepath</span>objRE<span>.Pattern</span> = <span>"^\\\\[\w-]+\\[\w\$-]+\\[^\\]"If</span> <span>Not</span> objRE<span>.Test&#40;</span> strFilespec <span>&#41;</span> <span>ThenSet</span> objRE = <span>NothingExit</span> <span>FunctionEnd</span> <span>IfEnd</span> <span>If</span> <span>Set</span> wshShell = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Shell"</span> <span>&#41;Set</span> objFSO   = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;</span> <span>If</span> <a href="http://www.google.com/search?q=INSTR+site:msdn.microsoft.com"><span>InStr</span></a><span>&#40;</span> strFilespec, <span>"\"</span> <span>&#41;</span> <span>And</span> Len<span>&#40;</span> strFilespec <span>&#41;</span> <span>></span> <span>1</span> <span>Then' If filespec starts with single backslash, prefix it with current directory's driveIf</span> <a href="http://www.google.com/search?q=LEFT+site:msdn.microsoft.com"><span>Left</span></a><span>&#40;</span> strFilespec, <span>1</span> <span>&#41;</span> = <span>"\"</span> <span>And</span> <span>Not</span> <a href="http://www.google.com/search?q=LEFT+site:msdn.microsoft.com"><span>Left</span></a><span>&#40;</span> strFilespec, <span>2</span> <span>&#41;</span> = <span>"\\"</span> <span>Then</span>strFilespec = objFSO<span>.GetDriveName&#40;</span> wshShell<span>.CurrentDirectory</span> <span>&#41;</span> & strFilespec<span>End</span> <span>If' Split filespec into parent directory and actual FILE spec</span>strFolder   = Mid<span>&#40;</span> strFilespec, <span>1</span>, <a href="http://www.google.com/search?q=INSTRREV+site:msdn.microsoft.com"><span>InStrRev</span></a><span>&#40;</span> strFilespec, <span>"\"</span> <span>&#41;</span> <span>&#41;</span>strFilespec = Mid<span>&#40;</span> strFilespec, <a href="http://www.google.com/search?q=INSTRREV+site:msdn.microsoft.com"><span>InStrRev</span></a><span>&#40;</span> strFilespec, <span>"\"</span> <span>&#41;</span> <span>+</span> <span>1</span> <span>&#41;End</span> <span>If' Assume current directory if no parent directory is specifiedIf</span> strFolder = <span>"</span> <span>Then</span> strFolder = wshShell<span>.CurrentDirectory' Quit if folder does not existIf</span> <span>Not</span> objFSO<span>.FolderExists&#40;</span> strFolder <span>&#41;</span> <span>ThenSet</span> objRE    = <span>NothingSet</span> objFSO   = <span>NothingSet</span> wshShell = <span>NothingExit</span> <span>FunctionEnd</span> <span>If</span> <span>' Convert DOS wildcards to regex pattern</span>objRE<span>.Pattern</span>    = <span>"([\.\(\)\[\]\{\}\$])"</span>objRE<span>.Global</span>     = <span>True</span>objRE<span>.IgnoreCase</span> = <span>True</span>strPattern       = objRE<span>.</span><a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strFilespec, <span>"\$1"</span> <span>&#41;</span>strPattern       = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strPattern,  <span>"?"</span>, <span>"[^\\]"</span>  <span>&#41;</span>strPattern       = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strPattern,  <span>"*"</span>, <span>"[^\\]*"</span> <span>&#41;</span>objRE<span>.Pattern</span>    = <span>"(^|\\)"</span> & strPattern & <span>"$"</span> <span>' Get a collection of filesSet</span> objFolder = objFSO<span>.GetFolder&#40;</span> strFolder <span>&#41;Set</span> colFiles  = objFolder<span>.Files</span>strFiles = <span>"' Iterate through the list of filesFor</span> <span>Each</span> objFile <span>In</span> colFiles<span>' Check if the file name matches filespecIf</span> objRE<span>.Test&#40;</span> objFile<span>.Path</span> <span>&#41;</span> <span>Then' Add the file to the list</span>strFiles = strFiles & <span>";"</span> & objFile<span>.PathEnd</span> <span>IfNext</span> <span>' Return the list of files as an array</span>GetFiles = <a href="http://www.google.com/search?q=SPLIT+site:msdn.microsoft.com"><span>Split</span></a><span>&#40;</span> Mid<span>&#40;</span> strFiles, <span>2</span> <span>&#41;</span>, <span>";"</span> <span>&#41;</span> <span>' CleanupSet</span> colFiles  = <span>NothingSet</span> objFolder = <span>NothingSet</span> objRE     = <span>NothingSet</span> objFSO    = <span>NothingSet</span> wshShell  = <span>NothingEnd</span> <span>Function</span>
Requirements:
Windows version:any
Network:any
Script Engine:any
Summarized:Works in all Windows versions with all scripting engines.






RegExp: GetFilesLE
<strong>GetFiles L</strong>ight <strong>E</strong>dition: file names only for input (no path), output contains matching file <em>names</em> (and extensions) only
VBScript Code:<a href="./files/wildcards.zip">Download</a> <a href="./files/wildcards.zip">&#x1f4be;</a>
<span>Option</span> Explicit WScript<span>.Echo</span> <a href="http://www.google.com/search?q=JOIN+site:msdn.microsoft.com"><span>Join</span></a><span>&#40;</span> GetFilesLE<span>&#40;</span> WScript<span>.Arguments.Unnamed.Item&#40;0&#41;</span> <span>&#41;</span>, vbCrLf <span>&#41;</span>  <span>Function</span> GetFilesLE<span>&#40;</span> strFilespec <span>&#41;' Name     : GetFilesLE' Function : List all files matching the specified filespec, all DOS wildcards allowed;'            Light Edition of GetFiles( ) function, but FILE names only, no directories' Returns  : An array of all matching file names (no path), or a single element array with the text "Error"' Remarks  : Since no folder can be specified, the current directory will be assumed.'            DOS wildcards "*" and "?" are allowed in the file name as well as in the extension.' Author   : Rob van der Woude, http://www.robvanderwoude.com' Version  : 1.00, 2017-02-02</span> <span>Dim</span> colFiles, objFile, objFSO, objRE, wshShell<span>Dim</span> strFiles, strPattern <span>' Return "Error" on missing or invalid filespec</span>GetFilesLE = <a href="http://www.google.com/search?q=ARRAY+site:msdn.microsoft.com"><span>Array</span></a><span>&#40;</span> <span>"Error"</span> <span>&#41;If</span> <a href="http://www.google.com/search?q=TRIM+site:msdn.microsoft.com"><span>Trim</span></a><span>&#40;</span> strFilespec <span>&#41;</span> = <span>"</span>  <span>Then</span> <span>Exit</span> <span>FunctionIf</span> <a href="http://www.google.com/search?q=INSTR+site:msdn.microsoft.com"><span>InStr</span></a><span>&#40;</span> strFilespec, <span>"\"</span> <span>&#41;</span> <span>Then</span> <span>Exit</span> <span>Function</span> <span>Set</span> wshShell = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Shell"</span> <span>&#41;Set</span> objFSO   = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;Set</span> objRE    = <span>New</span> RegExp <span>' Convert DOS wildcards to regex pattern</span>objRE<span>.Pattern</span>    = <span>"([\.\(\)\[\]\{\}\$])"</span>objRE<span>.Global</span>     = <span>True</span>objRE<span>.IgnoreCase</span> = <span>True</span>strPattern       = objRE<span>.</span><a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strFilespec, <span>"\$1"</span> <span>&#41;</span>strPattern       = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strPattern,  <span>"?"</span>, <span>"[^\\]"</span>  <span>&#41;</span>strPattern       = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strPattern,  <span>"*"</span>, <span>"[^\\]*"</span> <span>&#41;</span>objRE<span>.Pattern</span>    = <span>"(^|\\)"</span> & strPattern & <span>"$"</span> <span>' Get a collection of filesSet</span> colFiles  = objFSO<span>.GetFolder&#40;</span> wshShell<span>.CurrentDirectory</span> <span>&#41;.Files</span>strFiles = <span>"' Iterate through the list of filesFor</span> <span>Each</span> objFile <span>In</span> colFiles<span>' Check if the file name matches filespecIf</span> objRE<span>.Test&#40;</span> objFile<span>.Path</span> <span>&#41;</span> <span>Then' Add the file to the list</span>strFiles = strFiles & <span>";"</span> & objFile<span>.NameEnd</span> <span>IfNext</span> <span>' Return the list of files as an array</span>GetFilesLE = <a href="http://www.google.com/search?q=SPLIT+site:msdn.microsoft.com"><span>Split</span></a><span>&#40;</span> Mid<span>&#40;</span> strFiles, <span>2</span> <span>&#41;</span>, <span>";"</span> <span>&#41;</span> <span>' CleanupSet</span> colFiles  = <span>NothingSet</span> objRE     = <span>NothingSet</span> objFSO    = <span>NothingSet</span> wshShell  = <span>NothingEnd</span> <span>Function</span>
Requirements:
Windows version:any
Network:any
Script Engine:any
Summarized:Works in all Windows versions with all scripting engines.




<h2><k>Getting started with Regular Expressions</k></h2>
<dl>
<dt>Interpreter:</dt>
<dd>The interpreter is the "engine" that executes scripts.
Regular expressions are used in other languages, so you only need an interpreter for that language.
For scripting languages without built-in regular expression support, you'll need additional software, like Patrick McPhee's <a href="http://pages.interlog.com/~ptjm/">RexxRE</a> for Rexx, or <a href="http://unxutils.sourceforge.net/">EGREP</a> or <a href="csharpexamples.php#RxGrep">RxGrep</a> for DOS/Windows.</dd>
<dt>Development software:</dt>
<dd>EDIT (MS-DOS), Notepad (Windows), E (OS/2), or <em>any</em> other <strong>ASCII</strong> editor will do, as will your <a href="scripteditors.php">editor or IDE</a> for your scripting language.
Like the scripts themselves, a regular expression is "just" a string of text.
To help you write your regular expressions, several <a href="regexptools.php">expression builders & evaluators</a> are available.</dd>
<dt>Help files:</dt>
<dd>Online reference and tutorial: <a href="http://www.regular-expressions.info/">regular-expressions.info</a>.
Library of expressions: <a href="http://regexlib.com/default.aspx">Regular Expression Library</a>.</dd>
<dt>Books:</dt>
<dd>I compiled a list of <a href="booksregexp.php">books on regular expressions</a>.</dd>
<dt>Samples:</dt>
<dd>Start by examining <a href="regexpexamples.php">sample scripts using regular expressions</a> and exploring <a href="regexplinks.php">other regular expressions related sites</a>.</dd>
<dt>Newsgroup:</dt>
<dd><a href="http://groups.google.com/group/regex/">regex</a> newsgroup</dd>
</dl>

<h2><k>CAB Files</k></h2>
<a href="#MakeCab">Create CAB files with MakeCab</a>
<a href="vbstech_files_zip.php#CopyHereUNZIP">Extract CAB files with System.Shell Folders' CopyHere method</a>








MakeCab
VBScript Code:

CabCreate "D:\test.cab", Array( "D:\test.bat", "D:\Test.pdf" )

Sub CabCreate( myCabFile, arrFiles )
' This function creates a CAB file and adds a
' number of files from an array to the CAB file.
'
' Arguments:
' myCabFile    The fully qualified path for the CAB file to be created
' arrFiles     An array of fully qualified paths of the files to be added
'
' Requirements:
' MakeCab requires .NET FrameWork 2.0 or later
'
' Based on a script by Rinaldo Ferreira
' http://www.codecomments.com/archive299-2006-1-783560.html
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim i, objCab, objFSO
Set objFSO = CreateObject( "Scripting.FileSystemObject" )
Set objCab = CreateObject( "MakeCab.MakeCab.1" )
' CStr() is necessary, because MakeCab object
' only accepts string arguments, not variants
objCab.CreateCab CStr( myCabFile ), False, False, False
For i = 0 To UBound( arrFiles )
    objCab.AddFile CStr( arrFiles(i) ), _
        CStr( objFSO.GetFileName( arrFiles(i) ) )
Next
objCab.CloseCab
End Sub

Requirements:
Windows version:2000, XP, Server 2003, or Vista
Network:any
Client software:.NET FrameWork 2.0
Script Engine:any
Summarized:Works in Windows 2000 or later with .NET FrameWork 2.0 or later installed.




<h2><k>Read & Write INI Files</k></h2>
<a href="#ReadINI">ReadINI</a>
<a href="#WriteINI">WriteINI</a>
<a href="#DeleteINI">DeleteINI</a>
<a href="#SampleScript">Sample Script</a>
<a href="#Related">Related stuff</a>






ReadINI
VBScript Code:

Function ReadIni( myFilePath, mySection, myKey )
' This function returns a value read from an INI file
'
' Arguments:
' myFilePath  [string]  the (path and) file name of the INI file
' mySection   [string]  the section in the INI file to be searched
' myKey       [string]  the key whose value is to be returned
'
' Returns:
' the [string] value for the specified key in the specified section
'
' CAVEAT:     Will return a space if key exists but value is blank
'
' Written by Keith Lacelle
' Modified by Denis St-Pierre and Rob van der Woude

Const ForReading   = 1
Const ForWriting   = 2
Const ForAppending = 8

Dim intEqualPos
Dim objFSO, objIniFile
Dim strFilePath, strKey, strLeftString, strLine, strSection

Set objFSO = CreateObject( "Scripting.FileSystemObject" )

ReadIni     = "
strFilePath = Trim( myFilePath )
strSection  = Trim( mySection )
strKey      = Trim( myKey )

If objFSO.FileExists( strFilePath ) Then
    Set objIniFile = objFSO.OpenTextFile( strFilePath, ForReading, False )
    Do While objIniFile.AtEndOfStream = False
        strLine = Trim( objIniFile.ReadLine )

        ' Check if section is found in the current line
        If LCase( strLine ) = "[" & LCase( strSection ) & "]" Then
 strLine = Trim( objIniFile.ReadLine )

 ' Parse lines until the next section is reached
 Do While Left( strLine, 1 ) &lt;> "["
     ' Find position of equal sign in the line
     intEqualPos = InStr( 1, strLine, "=", 1 )
     If intEqualPos > 0 Then
         strLeftString = Trim( Left( strLine, intEqualPos - 1 ) )
         ' Check if item is found in the current line
         If LCase( strLeftString ) = LCase( strKey ) Then
             ReadIni = Trim( Mid( strLine, intEqualPos + 1 ) )
             ' In case the item exists but value is blank
             If ReadIni = " Then
                 ReadIni = " "
             End If
             ' Abort loop when item is found
             Exit Do
         End If
     End If

     ' Abort if the end of the INI file is reached
     If objIniFile.AtEndOfStream Then Exit Do

     ' Continue with next line
     strLine = Trim( objIniFile.ReadLine )
 Loop
        Exit Do
        End If
    Loop
    objIniFile.Close
Else
    WScript.Echo strFilePath & " doesn't exists. Exiting..."
    Wscript.Quit 1
End If
End Function
Requirements:
Windows version:any
Network:any
Client software:N/A
Script Engine:any
Summarized:Works in any Windows version, with any engine.
WriteINI
VBScript Code:

Sub WriteIni( myFilePath, mySection, myKey, myValue )
' This subroutine writes a value to an INI file
'
' Arguments:
' myFilePath  [string]  the (path and) file name of the INI file
' mySection   [string]  the section in the INI file to be searched
' myKey       [string]  the key whose value is to be written
' myValue     [string]  the value to be written (myKey will be
'                       deleted if myValue is &lt;DELETE_THIS_VALUE>)
'
' Returns:
' N/A
'
' CAVEAT:     WriteIni function needs ReadIni function to run
'
' Written by Keith Lacelle
' Modified by Denis St-Pierre, Johan Pol and Rob van der Woude

Const ForReading   = 1
Const ForWriting   = 2
Const ForAppending = 8

Dim blnInSection, blnKeyExists, blnSectionExists, blnWritten
Dim intEqualPos
Dim objFSO, objNewIni, objOrgIni, wshShell
Dim strFilePath, strFolderPath, strKey, strLeftString
Dim strLine, strSection, strTempDir, strTempFile, strValue

strFilePath = Trim( myFilePath )
strSection  = Trim( mySection )
strKey      = Trim( myKey )
strValue    = Trim( myValue )

Set objFSO   = CreateObject( "Scripting.FileSystemObject" )
Set wshShell = CreateObject( "WScript.Shell" )

strTempDir  = wshShell.ExpandEnvironmentStrings( "%TEMP%" )
strTempFile = objFSO.BuildPath( strTempDir, objFSO.GetTempName )

Set objOrgIni = objFSO.OpenTextFile( strFilePath, ForReading, True )
Set objNewIni = objFSO.CreateTextFile( strTempFile, False, False )

blnInSection     = False
blnSectionExists = False
' Check if the specified key already exists
blnKeyExists     = ( ReadIni( strFilePath, strSection, strKey ) &lt;> " )
blnWritten       = False

' Check if path to INI file exists, quit if not
strFolderPath = Mid( strFilePath, 1, InStrRev( strFilePath, "\" ) )
If Not objFSO.FolderExists ( strFolderPath ) Then
    WScript.Echo "Error: WriteIni failed, folder path (" _
    & strFolderPath & ") to ini file " _
    & strFilePath & " not found!"
    Set objOrgIni = Nothing
    Set objNewIni = Nothing
    Set objFSO    = Nothing
    WScript.Quit 1
End If

While objOrgIni.AtEndOfStream = False
    strLine = Trim( objOrgIni.ReadLine )
    If blnWritten = False Then
        If LCase( strLine ) = "[" & LCase( strSection ) & "]" Then
 blnSectionExists = True
 blnInSection = True
        ElseIf InStr( strLine, "[" ) = 1 Then
 blnInSection = False
        End If
    End If

    If blnInSection Then
        If blnKeyExists Then
 intEqualPos = InStr( 1, strLine, "=", vbTextCompare )
 If intEqualPos > 0 Then
     strLeftString = Trim( Left( strLine, intEqualPos - 1 ) )
     If LCase( strLeftString ) = LCase( strKey ) Then
         ' Only write the key if the value isn't empty
         ' Modification by Johan Pol
         If strValue &lt;> "&lt;DELETE_THIS_VALUE>" Then
             objNewIni.WriteLine strKey & "=" & strValue
         End If
         blnWritten   = True
         blnInSection = False
     End If
 End If
 If Not blnWritten Then
     objNewIni.WriteLine strLine
 End If
        Else
 objNewIni.WriteLine strLine
     ' Only write the key if the value isn't empty
     ' Modification by Johan Pol
     If strValue &lt;> "&lt;DELETE_THIS_VALUE>" Then
         objNewIni.WriteLine strKey & "=" & strValue
     End If
 blnWritten   = True
 blnInSection = False
        End If
    Else
        objNewIni.WriteLine strLine
    End If
Wend

If blnSectionExists = False Then ' section doesn't exist
    objNewIni.WriteLine
    objNewIni.WriteLine "[" & strSection & "]"
        ' Only write the key if the value isn't empty
        ' Modification by Johan Pol
        If strValue &lt;> "&lt;DELETE_THIS_VALUE>" Then
 objNewIni.WriteLine strKey & "=" & strValue
        End If
End If

objOrgIni.Close
objNewIni.Close

' Delete old INI file
objFSO.DeleteFile strFilePath, True
' Rename new INI file
objFSO.MoveFile strTempFile, strFilePath

Set objOrgIni = Nothing
Set objNewIni = Nothing
Set objFSO    = Nothing
Set wshShell  = Nothing
End Sub
Requirements:
Windows version:any
Network:any
Client software:Requires the ReadINI function
Script Engine:any
Summarized:Works in any Windows version, with any engine; requires the ReadINI function.
DeleteINI
To delete a <em>key</em> in an INI file, use <a href="#WriteINI">WriteINI</a> with a <em>value</em> <code>"&lt;DELETE_THIS_VALUE>"</code>.
Sample Script
VBScript Code:

WriteIni "C:\test.ini", "TEST1", "My1stKey", "My1stValue"
WriteIni "C:\test.ini", "TEST2", "My1stKey", "My1stValue"
WScript.Echo ReadIni( "C:\test.ini", "TEST1", "My1stKey" )
WriteIni "C:\test.ini", "TEST1", "My1stKey", "My2ndValue"
WScript.Echo ReadIni( "C:\test.ini", "TEST1", "My1stKey" )
Sample output:

My1stValue
My2ndValue






<h2 id="Related">&emsp;Related Stuff:</h2>
Use KiXtart's easy INI access in VBScript with <a href="wshexamples.php?fc=K#KixINI">KixINI.vbs</a>
Adriaan Westra's <a href="http://www.westphil.nl/systemadministration/vbscript/index.php?name=writeini">WriteIni</a> function


<h2><k>Calculate MD5 Checksums</k></h2>
<a href="http://www.xstandard.com/en/documentation/xmd5/">X-MD5</a>
VBScript Code:

WScript.Echo "Comparing 2 strings:"
strString = "Meet John Doe"
WScript.Echo "MD5 Checksum for """ & strString _
       & """: " & GetStringCheckSum( strString )
strString = "meet John Doe"
WScript.Echo "MD5 Checksum for """ & strString _
       & """: " & GetStringCheckSum( strString )
WScript.Echo
WScript.Echo "Comparing 2 files:"
strFile1 = "C:\WINDOWS\System32\wmpcore.dll"
strFile2 = "C:\WINDOWS\System32\dllcache\wmpcore.dll"
WScript.Echo "MD5 Checksum for " & strFile1 _
       & ":          " & GetFileCheckSum( strFile1 )
WScript.Echo "MD5 Checksum for " & strFile2 _
       & ": " & GetFileCheckSum( strFile2 )



Function GetFileCheckSum( myFile )
' This function uses X-standards.com's X-MD5 component to calculate
' the MD5 checksum of a file.
'
' Argument:
' myFile [string] the file name whose checksum is to be calculated
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
' The X-MD5 component is available at:
' http://www.xstandard.com/page.asp?p=C8AACBA3-702F-4BF0-894A-B6679AA949E6
' For more information on available functionality read:
' http://www.xstandard.com/printer-friendly.asp?id=44AFBB03-EDC1-49FE-94CC-333AE728331E
Dim objMD5
Set objMD5 = CreateObject( "XStandard.MD5" )
GetFileCheckSum = objMD5.GetCheckSumFromFile( myFile )
Set objMD5 = Nothing
End Function


Function GetStringCheckSum( myString )
' This function uses X-standards.com's X-MD5 component to calculate
' the MD5 checksum of a string.
'
' Argument:
' myString [string] the string whose checksum is to be calculated
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
' The X-MD5 component is available at:
' http://www.xstandard.com/page.asp?p=C8AACBA3-702F-4BF0-894A-B6679AA949E6
' For more information on available functionality read:
' http://www.xstandard.com/printer-friendly.asp?id=44AFBB03-EDC1-49FE-94CC-333AE728331E
Dim objMD5
Set objMD5 = CreateObject( "XStandard.MD5" )
GetStringCheckSum = objMD5.GetCheckSumFromString( myString )
Set objMD5 = Nothing
End Function

Requirements:
Windows version:any
Network:any
Client software:<a href="http://www.xstandard.com/en/documentation/xmd5/">X-MD5</a> component
Script Engine:any
Summarized:Works in any Windows version with the <a href="http://www.xstandard.com/en/documentation/xmd5/">X-MD5</a> component installed.




<h2><k>File Encoding</k></h2>
<a href="#ADODB.Stream">Check a file's Byte Order Mark (BOM) to determine its text encoding</a>








<a href="https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/stream-object-ado">ADODB.Stream</a>
VBScript Code:
' Based on information from
' https://en.wikipedia.org/wiki/Byte_order_mark
'
'Encoding       Hex BOM
'========       =======
'BOCU-1         FB EE 28
'GB-18030       84 31 95 33
'SCSU           0E FE FF
'UTF-1          F7 64 4C
'UTF-7          2B 2F 76 (38|39|2B|2F)
'UTF-8          EF BB BF
'UTF-16 (BE)    FE FF
'UTF-16 (LE)    FF FE
'UTF-32 (BE)    00 00 FE FF
'UTF-32 (LE)    FF FE 00 00
'UTF-EBCDIC     DD 73 66 73

Option Explicit

Const adTypeBinary = 1
Const adTypeText   = 2

Dim i, intRC
Dim dicBOMs, objFSO, objStream
Dim strBOM, strFile, strHead, strType, strUTF7

If WScript.Arguments.Unnamed.Count &lt;> 1 Then Syntax
If WScript.Arguments.Named.Count    > 0 Then Syntax

intRC   = 0
strFile = WScript.Arguments.Unnamed(0)
strType = "Unknown"
strUTF7 = "38;39;2B;2F" ' Allowed values for 4th byte of UTF-7 BOM

Set objFSO = CreateObject( "Scripting.FileSystemObject" )
If Not objFSO.FileExists( strFile ) Then Syntax
Set objFSO = Nothing

Set dicBOMs = CreateObject( "Scripting.Dictionary" )
dicBOMs.Add "0000FEFF", "UTF-32 (BE)"
dicBOMs.Add "0EFEFF",   "SCSU"
dicBOMs.Add "2B2F76",   "UTF-7" ' First 3 bytes of BOM only, 4th byte can have several values
dicBOMs.Add "84319533", "GB-18030"
dicBOMs.Add "DD736673", "UTF-EBCDIC"
dicBOMs.Add "EFBBBF",   "UTF-8"
dicBOMs.Add "F7644C",   "UTF-1"
dicBOMs.Add "FBEE28",   "BOCU-1"
dicBOMs.Add "FEFF",     "UTF-16 (BE)"
dicBOMs.Add "FFFE",     "UTF-16 (LE)"
dicBOMs.Add "FFFE0000", "UTF-32 (LE)"

On Error Resume Next
Set objStream = CreateObject( "ADODB.Stream" )
objStream.Open
objStream.Type = adTypeBinary
objStream.LoadFromFile strFile
If Err Then intRC = 1
objStream.Position = 0
strHead = "
For i = 0 To 3
    strHead = strHead & UCase( Right( "0" & Hex( AscB( objStream.Read( 1 ) ) ), 2 ) )
    If Err Then intRC = 1
Next
objStream.Close
Set objStream = Nothing
On Error Goto 0

If intRC = 1 Then Syntax

For i = 8 To 4 Step -2 ' Try the longest match (4 bytes) first, next try 3 bytes, finally try 2 bytes
    If strType = "Unknown" Then
 strBOM = Left( strHead, i )
 If dicBOMs.Exists( strBOM ) Then
         If dicBOMs( strBOM ) = "UTF-7" Then
                 If InStr( strUTF7, Right( strHead, 2 ) ) Then strType = "UTF-7"
         Else
                 strType = dicBOMs( strBOM )
         End If
 End If
    End If
Next

If strType = "Unknown" Then intRC = 1

WScript.Echo "File Name     : " & strFile & vbcrlf _
       & "First 4 bytes : " & strHead & vbcrlf _
       & "Matching BOM  : " & strBOM  & vbcrlf _
       & "File Encoding : " & strType

WScript.Quit intRC


Sub Syntax
    Dim strMsg
    strMsg = vbCrLf _
           & "CheckBOM.vbs,  Version 1.00" _
           & vbCrLf _
           & "Check a file's Byte Order Mark (BOM) to determine its text encoding" _
           & vbCrLf & vbCrLf _
           & "Usage:  CheckBOM.vbs  textfilename" _
           & vbCrLf & vbCrLf _
           & "Note:   The file encoding is displayed on screen, e.g. "UTF-7" or" _
           & vbCrLf _
           & "        "UTF-32 (LE)", or "Unknown" if not recognized." _
           & vbCrLf _
           & "        Check this script's source code for a list of recognized BOMs." _
           & vbCrLf & vbCrLf _
           & "Written by Rob van der Woude" _
           & vbCrLf _
           & "http://www.robvanderwoude.com"
    WScript.Echo strMsg
    WScript.Quit 1
End Sub


Requirements:
Windows version:2000 and later
Network:any
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en">MDAC 2.8</a> for Windows 2000
Script Engine:any
Summarized:Works in Windows 2000 or later, Windows 2000 requires <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en">MDAC 2.8</a>.




<h2><k>Convert ASCII to UTF-8</k></h2>
Convert plain text files to UTF-8 with <a href="http://msdn.microsoft.com/en-us/library/ms675032(VS.85).aspx">ADODB.Stream</a>
VBScript Code:

Option Explicit

Dim objFSO, strFileIn, strFileOut

strFileIn = WScript.ScriptName

Set objFSO = CreateObject( "Scripting.FileSystemObject" )
strFileOut = objFSO.GetBaseName( strFileIn ) & "_utf8.txt"
Set objFSO = Nothing

UTF8 strFileIn, strFileOut


Function UTF8( myFileIn, myFileOut )
' UTF8()  Version 1.00
' Open a "plain" text file and save it again in UTF-8 encoding
' (overwriting an existing file without asking for confirmation).
'
' Based on a sample script from JTMar:
' http://bytes.com/groups/asp/52959-save-file-utf-8-format-asp-vbscript
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

Dim objStream

' Valid Charset values for ADODB.Stream
Const CdoBIG5        = "big5"
Const CdoEUC_JP      = "euc-jp"
Const CdoEUC_KR      = "euc-kr"
Const CdoGB2312      = "gb2312"
Const CdoISO_2022_JP = "iso-2022-jp"
Const CdoISO_2022_KR = "iso-2022-kr"
Const CdoISO_8859_1  = "iso-8859-1"
Const CdoISO_8859_2  = "iso-8859-2"
Const CdoISO_8859_3  = "iso-8859-3"
Const CdoISO_8859_4  = "iso-8859-4"
Const CdoISO_8859_5  = "iso-8859-5"
Const CdoISO_8859_6  = "iso-8859-6"
Const CdoISO_8859_7  = "iso-8859-7"
Const CdoISO_8859_8  = "iso-8859-8"
Const CdoISO_8859_9  = "iso-8859-9"
Const cdoKOI8_R      = "koi8-r"
Const cdoShift_JIS   = "shift-jis"
Const CdoUS_ASCII    = "us-ascii"
Const CdoUTF_7       = "utf-7"
Const CdoUTF_8       = "utf-8"

' ADODB.Stream file I/O constants
Const adTypeBinary          = 1
Const adTypeText            = 2
Const adSaveCreateNotExist  = 1
Const adSaveCreateOverWrite = 2

On Error Resume Next

Set objStream = CreateObject( "ADODB.Stream" )
objStream.Open
objStream.Type = adTypeText
objStream.Position = 0
objStream.Charset = CdoUTF_8
objStream.LoadFromFile myFileIn
objStream.SaveToFile myFileOut, adSaveCreateOverWrite
objStream.Close
Set objStream = Nothing

If Err Then
    UTF8 = False
Else
    UTF8 = True
End If

On Error Goto 0
End Function
Requirements:
Windows version:Windows XP SP2 and later, or Windows 2000 with <a href="http://www.microsoft.com/downloads/details.aspx?familyid=78cac895-efc2-4f8e-a9e0-3a1afbd5922e">MDAC 2.8 SP1</a> installed
Network:any
Client software:MDAC 2.8 component
Script Engine:any
Summarized:Works in any Windows 2000 with <a href="http://www.microsoft.com/downloads/details.aspx?familyid=78cac895-efc2-4f8e-a9e0-3a1afbd5922e">MDAC 2.8 SP1</a> installed, or Windows XP SP2 and later.




<h2><k>Base64 Encode & Decode Files</k></h2>
<a href="http://www.xstandard.com/en/documentation/xbase64/">X-Base64</a>
VBScript Code:

Option Explicit

Dim errResult

WScript.Echo "Base64 encoding . . ."
errResult = Base64Encode( "b64coder.vbs", "b64coder.enc" )
<span>
If errResult &lt;> 0 Then
ShowError errResult
End If
</span>

WScript.Echo "Decoding again . . ."
errResult = Base64Decode( "b64coder.enc", "b64coder.dec" )
<span>
If errResult &lt;> 0 Then
ShowError errResult
Else
</span>
WScript.Echo "Done." & vbCrLf _
           & "Compare the files ""b64coder.vbs"" and " _
           & """b64coder.dec"", they should be identical."
End If


<span>
Sub ShowError( myError )
On Error Resume Next
Err.Raise myError
WScript.Echo "ERROR " & Err.Number & ": " & Err.Description
Err.Clear
On Error Goto 0
WScript.Quit
End Sub
</span>


Function Base64Encode( myFileIn, myFileOut )
' This function uses Belus Technology's XBase64 component to Base64 encode a file.
' The XBase64 component is available at
' http://www.xstandard.com/en/documentation/xbase64/
'
' Arguments:
' myFileIn   [string]  the file to be encoded
' myFileOut  [string]  the encoded file to be created
'
' Return Code:
' 0 if all goes well, otherwise the appropriate error number
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim i, objBase64, objFSO, objFileIn, objFileOut
Dim objStreamIn, strCode, strText

Const ForAppending       =  8
Const ForReading         =  1
Const ForWriting         =  2
Const TristateFalse      =  0
Const TristateMixed      = -2
Const TristateTrue       = -1
Const TristateUseDefault = -2
Const otSafeArray        =  0
Const otString           =  2

' Use custom error handling
'On Error Resume Next

' Open a file system object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Open the input file if it exists
If objFSO.FileExists( myFileIn ) Then
    Set objFileIn   = objFSO.GetFile( myFileIn )
    Set objStreamIn = objFileIn.OpenAsTextStream( ForReading, TristateFalse )
Else
    ' Error 53: File not found
    Base64Encode = 53
    ' Close input file and release objects
    objStreamIn.Close
    Set objStreamIn = Nothing
    Set objFileIn   = Nothing
    Set objFSO      = Nothing
    ' Abort
    Exit Function
End If

' Create the output file, unless it already exists
If objFSO.FileExists( myFileOut ) Then
    ' Error 58: File already exists
    Base64Encode = 58
    ' Close input file and release objects
    objStreamIn.Close
    Set objStreamIn = Nothing
    Set objFileIn   = Nothing
    Set objFSO      = Nothing
    ' Abort
    Exit Function
Else
    Set objFileOut = objFSO.CreateTextFile( myFileOut, True, False )
End If

' Read the text from the input file and close the file
strText = objStreamIn.ReadAll( )
objStreamIn.Close

' Base64 encode the text stream
Set objBase64 = CreateObject( "XStandard.Base64" )
strCode       = objBase64.Encode( strText, otString )
Set objBase64 = Nothing

' Write the result to the output file and close the file
objFileOut.Write strCode
objFileOut.Close

' Release the objects
Set objStreamIn = Nothing
Set objFileIn   = Nothing
Set objFileOut  = Nothing
Set objFSO      = Nothing

' Return any error codes
Base64Encode = Err.Number
On Error Goto 0
End Function


Function Base64Decode( myFileIn, myFileOut )
' This function uses Belus Technology's XBase64 component to Base64 decode a file.
' The XBase64 component is available at
' http://www.xstandard.com/en/documentation/xbase64/
'
' Arguments:
' myFileIn   [string]  the file to be decoded
' myFileOut  [string]  the decoded file to be created
'
' Return Code:
' 0 if all goes well, otherwise the appropriate error number
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim i, objBase64, objFSO, objFileIn, objFileOut
Dim objStreamIn, strCode, strText

Const ForAppending       =  8
Const ForReading         =  1
Const ForWriting         =  2
Const TristateFalse      =  0
Const TristateMixed      = -2
Const TristateTrue       = -1
Const TristateUseDefault = -2
Const otSafeArray        =  0
Const otString           =  2

' Use custom error handling
'On Error Resume Next

' Open a file system object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Open the input file if it exists
If objFSO.FileExists( myFileIn ) Then
    Set objFileIn   = objFSO.GetFile( myFileIn )
    Set objStreamIn = objFileIn.OpenAsTextStream( ForReading, TristateFalse )
Else
    ' Error 53: File not found
    Base64Decode = 53
    ' Close input file and release objects
    objStreamIn.Close
    Set objStreamIn = Nothing
    Set objFileIn   = Nothing
    Set objFSO      = Nothing
    ' Abort
    Exit Function
End If

' Create the output file, unless it already exists
If objFSO.FileExists( myFileOut ) Then
    ' Error 58: File already exists
    Base64Decode = 58
    ' Close input file and release objects
    objStreamIn.Close
    Set objStreamIn = Nothing
    Set objFileIn   = Nothing
    Set objFSO      = Nothing
    ' Abort
    Exit Function
Else
    Set objFileOut = objFSO.CreateTextFile( myFileOut, True, False )
End If

' Read the encoded text from the input file and close the file
strCode = objStreamIn.ReadAll( )
objStreamIn.Close

' Base64 decode the text stream
Set objBase64 = CreateObject( "XStandard.Base64" )
strText       = objBase64.Decode( strCode, otString )
Set objBase64 = Nothing

' Write the result to the output file and close the file
objFileOut.Write strText
objFileOut.Close

' Release the objects
Set objStreamIn = Nothing
Set objFileIn   = Nothing
Set objFileOut  = Nothing
Set objFSO      = Nothing

' Return any error codes
Base64Decode = Err.Number
On Error Goto 0
End Function

Requirements:
Windows version:any
Network:any
Client software:<a href="http://www.xstandard.com/en/documentation/xbase64/">X-Base64</a> component
Script Engine:any
Summarized:Works in any Windows version with the <a href="http://www.xstandard.com/en/documentation/xbase64/">X-Base64</a> component installed.




<h2><k>XOR</k></h2>
<h3>&emsp;Encrypt Files Using Exclusive OR</h3>
XOR
VBScript Code:

Option Explicit

Dim arrKey, errResult

arrKey = GetKey( "This is a short and simple ""passphrase""" )

WScript.Echo "Encoding . . ."
errResult = Encode( "coder.vbs", "coder.enc", arrKey )
<span>
If errResult &lt;> 0 Then
ShowError errResult
End If
</span>

WScript.Echo "Decoding again . . ."
errResult = Encode( "coder.enc", "coder.dec", arrKey )
<span>
If errResult &lt;> 0 Then
ShowError errResult
Else
</span>
WScript.Echo "Done." & vbCrLf _
           & "Compare the files ""coder.vbs"" and ""coder.dec"", " _
           & "they should be identical."
<span>
End If
</span>


<span>
Sub ShowError( myError )
On Error Resume Next
Err.Raise myError
WScript.Echo "ERROR " & Err.Number & ": " & Err.Description
Err.Clear
On Error Goto 0
WScript.Quit
End Sub
</span>


Function Encode( myFileIn, myFileOut, arrCode )
' This function provides a simple (ASCII) text encoder/decoder using XOR.
' Because it uses XOR, both encoding and decoding can be performed by the
' same function, with the same key.
'
' Arguments:
' myFileIn   [string]        input text file (file to be encoded)
' myFileOut  [string]        output file (encoded text)
' arrCode    [array of int]  "key", consisting of any number of integers
'                            from 1 to 255; avoid 0, though it can be used,
'                            it doesn't encode anything.
'                            Use any number of elements in the "key" array,
'                            each element multiplies the number of possible
'                            keys by 255 (not 256 since 0 is avoided).
'                            If only a single element is used, it may be
'                            passed either as an array or as a single integer.
'
' Return code:
' 0 if all went well, otherwise the appropriate error number.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim i, objFSO, objFileIn, objFileOut, objStreamIn

Const ForAppending       =  8
Const ForReading         =  1
Const ForWriting         =  2
Const TristateFalse      =  0
Const TristateMixed      = -2
Const TristateTrue       = -1
Const TristateUseDefault = -2

' Use custom error handling
On Error Resume Next

' If the "key" is a single digit, convert it to an array
If Not IsArray( arrCode ) Then
    arrCode = Array( arrCode )
End If

' Check if a valid "key" array is used
For i = 0 To UBound( arrCode )
    If Not IsNumeric( arrCode(i) ) Then
        ' 1032    Invalid character
        Encode = 1032
        Exit Function
    End If
    If arrCode(i) &lt; 0 Or arrCode(i) > 255 Then
        ' 1031    Invalid number
        Encode = 1031
        Exit Function
    End If
Next

' Open a file system object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Open the input file if it exists
If objFSO.FileExists( myFileIn ) Then
    Set objFileIn   = objFSO.GetFile( myFileIn )
    Set objStreamIn = objFileIn.OpenAsTextStream( ForReading, TriStateFalse )
Else
    ' Error 53: File not found
    Encode = 53
    ' Close input file and release objects
    objStreamIn.Close
    Set objStreamIn = Nothing
    Set objFileIn   = Nothing
    Set objFSO      = Nothing
    ' Abort
    Exit Function
End If

' Create the output file, unless it already exists
If objFSO.FileExists( myFileOut ) Then
    ' Error 58: File already exists
    Encode = 58
    ' Close input file and release objects
    objStreamIn.Close
    Set objStreamIn = Nothing
    Set objFileIn   = Nothing
    Set objFSO      = Nothing
    ' Abort
    Exit Function
Else
    Set objFileOut = objFSO.CreateTextFile( myFileOut, True, False )
End If

' Encode the text from the input file and write it to the output file
i = 0
Do Until objStreamIn.AtEndOfStream
    i = ( i + 1 ) \ ( UBound( arrCode ) + 1 )
    objFileOut.Write Chr( Asc( objStreamIn.Read( 1 ) ) Xor arrCode(i) )
Loop

' Close files and release objects
objFileOut.Close
objStreamIn.Close
Set objStreamIn = Nothing
Set objFileIn   = Nothing
Set objFileOut  = Nothing
Set objFSO      = Nothing

' Return the error number as status information
Encode = Err.Number

' Done
Err.Clear
On Error Goto 0
End Function


Function GetKey( myPassPhrase )
' This function converts a password or passphrase
' into a "key" array for the Encode function.
Dim i, arrCode( )
ReDim arrCode( Len( myPassPhrase ) - 1 )
For i = 0 To UBound( arrCode )
    arrCode(i) = Asc( Mid( myPassPhrase, i + 1, 1 ) )
Next
GetKey = arrCode
End Function

Requirements:
Windows version:any
Network:any
Client software:N/A
Script Engine:any
Summarized:Works in any Windows version, with any scripting engine.




<h2><k>Self-Destruct</k></h2>
WSH (WScript.ScriptFullName)
VBScript Code:

' Author:   Denis St-Pierre
' Function: Make a script delete itself
Set objFSO = CreateObject( "Scripting.FileSystemObject" )
objFSO.DeleteFile WScript.ScriptFullName
WScript.Quit

Requirements:
Windows version:any
Network:any
Client software:N/A
Script Engine:WSH
Summarized:Works in any Windows version, with WSH script engine (WSCRIPT.EXE and CSCRIPT.EXE).




<h2><k>XML</k></h2>
To test the code on this page yourself will require some preparation.

I will be using an XML file created by exporting data from <a href="http://www.invelos.com/Products.aspx">DVD Profiler</a>.
So you may want to <a href="http://www.intervocative.com/Downloads.aspx">download the free version</a> first, and start creating your own database.
As an alternative, you can copy and paste this <a href="dvdcoll_xml_src.php">single record from my own DVD database</a>, but it doesn't demonstrate the queries quite as good as a "real" populated database does.

Next you may want to download and install Microsoft's free <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=72D6AA49-787D-4118-BA5F-4F30FE913628&displaylang=en">XML Notepad 2007</a>.
It can be used to display the XML file in <a href="pictures/dvdcoll_treeview.gif">tree view</a> and <a href="pictures/dvdcoll_xslview.gif">XSL view</a>, which makes it easier to see and understand the queries we are going to build.
Or as alternatives, download <a href="http://www.xmlfox.com/">XMLFox</a>, or use your browser, or Notepad, or any other text or <a href="scripteditors.php">programmer's editor</a> (or for the diehards: <a href="type.php">TYPE</a> and MORE).




Checklist:

<input id="xmlfile" name="xmlfile" value="0" type="CHECKBOX" /><label for="xmlfile">XML file "dvdcoll.xml", created by DVD profiler's export function, and preferably located in the current directory</label>
<input id="xmleditor" name="xmleditor" value="0" type="CHECKBOX" /><label for="xmleditor">XML editor</label>
<input id="scripteditor" name="scripteditor" value="0" type="CHECKBOX" /><label for="scripteditor">script editor or IDE, preferably with integrated object browser</label>




Let's get started.
In your editor, IDE or whatever, type the following code:

Set xmlDoc = CreateObject( "Microsoft.XMLDOM" )
xmlDoc.Async = "False"
xmlDoc.Load( "dvdcoll.xml" )


If you have an integrated object browser, you'll probably see a reference to MSXML being inserted.

We'll start with simple query, display each DVD's title:

strQuery = "/Collection/DVD/Title"
Set colNodes = xmlDoc.selectNodes( strQuery )
For Each objNode in colNodes
WScript.Echo objNode.nodeName & ": " & objNode.text
Next


Save the code as a VBScript file and run it.
The result will look like this:

Title: Wild Down Under
Title: Pride
Title: Gandhi
Title: The Abyss
Title: Shouf Shouf Habibi


So, why was the query built like this?

<img data-src="https://www.robvanderwoude.com/pictures/dvdcoll_structure.gif" width="474" height="164" />

Take a look at the image on the right, a fragment of a screenshot of XML Notepad's "XSL Output" window with our XML file loaded (or open the XML file in a plain text editor).

What we see is an opening tag <code>&lt;Collection></code> as the first tag.
This translates to <code>/Collection</code> in the query.
Then, between the opening <code>&lt;Collection></code> and closing <code>&lt;/Collection></code> tags ("inside" the <code>Collection</code>), note the "recordsets" of <code>&lt;DVD></code> and <code>&lt;/DVD></code> tags.
These translate to the <code>DVD</code> part of the query: in the root we find <code>Collections</code>, and inside (or under) <code>Collections</code> we find <code>DVD</code> &mdash; just like a directory structure on a disk.
Inside (or under) <code>DVD</code> there are several tags, <code>Title</code> being one of them.
So now we have <code>/Collection/DVD/Title</code>.


Note:Queries are case sensitive!
Capitalization must match the XML tags exactly.


Now let's move to the next level of complexity for our queries, display multiple properties:

strQuery = "/Collection/DVD/ ( Title | Genres )"



Note:This is the query definition only.
Replace the previous query definition by this new one.
The rest of the script remains unaltered.


The part of the query between parentheses is a list of choices, separated by "pipe" characters (<code>|</code>).
Tags will be listed if they match <em>any</em> of these choices, so <code>Title</code> as well as <code>Genres</code> will be shown for each DVD in the collection.

The result will look like this:

Title: Wild Down Under
Genres: Documentary Special Interest
Title: Pride
Genres: Documentary
Title: Gandhi
Genres: Drama Classic
Title: The Abyss
Genres: Science-Fiction Suspense/Thriller
Title: Shouf Shouf Habibi
Genres: Comedy


The genres are listed as single lines, where each line can contain one (or zero) or more genres.

If you look further down in the XML structure, you'll notice that some keys or tags have subkeys: <code>Genres</code> for example uses <code>Genre</code> subkeys.
Subkeys are used when multiple values are possible.
They can be viewed best in <a href="pictures/dvdcoll_treeview.gif">XML Notepad's treeview</a>.
To list each individual genre we must use <code>/Collection/DVD/Genres/Genre</code>.

So next, let's display the Title <em>and</em> each <em>individual</em> Genre:

strQuery = "/Collection/DVD/ ( Title | Genres/Genre )"

Roughly translated: display anything that matches <code>"/Collection/DVD/Title"</code> or <code>"/Collection/DVD/Genres/Genre"</code>

The result will look like this:

Title: Wild Down Under
Genre: Documentary
Genre: Special Interest
Title: Pride
Genre: Documentary
Title: Gandhi
Genre: Drama
Genre: Classic
Title: The Abyss
Genre: Science-Fiction
Genre: Suspense/Thriller
Title: Shouf Shouf Habibi
Genre: Comedy


Note how some DVDs have multiple Genres.

OK, listing properties for each item in a collection no longer has any secrets for you.
Let's select specific items (DVDs) from the collection.
List the titles and genres of all documentaries:

strQuery = "/Collection/DVD [ Genres/Genre = 'Documentary' ] / ( Title | Genres/Genre )"

The result will look like this:

Title: Wild Down Under
<span>Genre: Documentary</span>
Genre: Special Interest
Title: Pride
<span>Genre: Documentary</span>
Title: March of the Penguins
<span>Genre: Documentary</span>
Title: Alaska: Spirit of the Wild
<span>Genre: Documentary</span>
Genre: Special Interest
Title: Wilderness Journey - Canyon Suites
<span>Genre: Documentary</span>
Genre: Special Interest
Genre: Music


It is possible to select based on genre without displaying it:

strQuery = "/Collection/DVD [ Genres/Genre = 'Documentary' ] /Title"

would only display the titles of the documentaries.

Finally, the selection can be narrowed down by using <code>and</code> and <code>or</code>.
Note that these are case sensitive, so <code>And</code> will <em>not</em> work.

List titles and all formats for each documentary that supports 16x9 format:

strQuery = "/Collection/DVD " _
     & "[ Genres/Genre = 'Documentary' and Format/Format16X9 = 'True' ] " _
     & "/ ( Title | Format/* )"


The result will look like this:

Title: Wild Down Under
FormatAspectRatio: 1.78
FormatVideoStandard: PAL
FormatLetterBox: True
FormatPanAndScan: False
FormatFullFrame: False
<span>Format16X9: True</span>
FormatDualSided: False
FormatDualLayered: False
FormatFlipper: False
Title: Pride
FormatVideoStandard: PAL
FormatLetterBox: True
FormatPanAndScan: False
FormatFullFrame: True
<span>Format16X9: True</span>
FormatDualSided: False
FormatDualLayered: True
FormatFlipper: False




<strong>. . . TO BE CONTINUED . . .</strong>




<h2 id="Related">&emsp;Related Stuff:</h2>
<a href="http://msdn.microsoft.com/en-us/library/ms763798%28v=vs.85%29.aspx">XML DOM Properties</a>
<a href="http://msdn.microsoft.com/en-us/library/ms757828%28v=vs.85%29.aspx">XML DOM Methods</a>
<a href="http://www.westphil.nl/systemadministration/vbscript/index.php?name=createxml">Save information to an XML file</a>, by Adriaan Westra
<a href="http://www.westphil.nl/systemadministration/vbscript/index.php?name=getxmlelement">Get information from an XML file</a>, by Adriaan Westra




<h2><k>XML</k></h2>
To test the code on this page yourself will require some preparation.

I will be using an XML file created by exporting data from <a href="http://www.invelos.com/Products.aspx">DVD Profiler</a>.
So you may want to <a href="http://www.intervocative.com/Downloads.aspx">download the free version</a> first, and start creating your own database.
As an alternative, you can copy and paste this <a href="dvdcoll_xml_src.php">single record from my own DVD database</a>, but it doesn't demonstrate the queries quite as good as a "real" populated database does.

Next you may want to download and install Microsoft's free <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=72D6AA49-787D-4118-BA5F-4F30FE913628&displaylang=en">XML Notepad 2007</a>.
It can be used to display the XML file in <a href="pictures/dvdcoll_treeview.gif">tree view</a> and <a href="pictures/dvdcoll_xslview.gif">XSL view</a>, which makes it easier to see and understand the queries we are going to build.
Or as alternatives, download <a href="http://www.xmlfox.com/">XMLFox</a>, or use your browser, or Notepad, or any other text or <a href="scripteditors.php">programmer's editor</a> (or for the diehards: <a href="type.php">TYPE</a> and MORE).




Checklist:

<input id="xmlfile" name="xmlfile" value="0" type="CHECKBOX" /><label for="xmlfile">XML file "dvdcoll.xml", created by DVD profiler's export function, and preferably located in the current directory</label>
<input id="xmleditor" name="xmleditor" value="0" type="CHECKBOX" /><label for="xmleditor">XML editor</label>
<input id="scripteditor" name="scripteditor" value="0" type="CHECKBOX" /><label for="scripteditor">script editor or IDE, preferably with integrated object browser</label>




Let's get started.
In your editor, IDE or whatever, type the following code:

Set xmlDoc = CreateObject( "Microsoft.XMLDOM" )
xmlDoc.Async = "False"
xmlDoc.Load( "dvdcoll.xml" )


If you have an integrated object browser, you'll probably see a reference to MSXML being inserted.

We'll start with simple query, display each DVD's title:

strQuery = "/Collection/DVD/Title"
Set colNodes = xmlDoc.selectNodes( strQuery )
For Each objNode in colNodes
WScript.Echo objNode.nodeName & ": " & objNode.text
Next


Save the code as a VBScript file and run it.
The result will look like this:

Title: Wild Down Under
Title: Pride
Title: Gandhi
Title: The Abyss
Title: Shouf Shouf Habibi


So, why was the query built like this?

<img data-src="https://www.robvanderwoude.com/pictures/dvdcoll_structure.gif" width="474" height="164" />

Take a look at the image on the right, a fragment of a screenshot of XML Notepad's "XSL Output" window with our XML file loaded (or open the XML file in a plain text editor).

What we see is an opening tag <code>&lt;Collection></code> as the first tag.
This translates to <code>/Collection</code> in the query.
Then, between the opening <code>&lt;Collection></code> and closing <code>&lt;/Collection></code> tags ("inside" the <code>Collection</code>), note the "recordsets" of <code>&lt;DVD></code> and <code>&lt;/DVD></code> tags.
These translate to the <code>DVD</code> part of the query: in the root we find <code>Collections</code>, and inside (or under) <code>Collections</code> we find <code>DVD</code> &mdash; just like a directory structure on a disk.
Inside (or under) <code>DVD</code> there are several tags, <code>Title</code> being one of them.
So now we have <code>/Collection/DVD/Title</code>.


Note:Queries are case sensitive!
Capitalization must match the XML tags exactly.


Now let's move to the next level of complexity for our queries, display multiple properties:

strQuery = "/Collection/DVD/ ( Title | Genres )"



Note:This is the query definition only.
Replace the previous query definition by this new one.
The rest of the script remains unaltered.


The part of the query between parentheses is a list of choices, separated by "pipe" characters (<code>|</code>).
Tags will be listed if they match <em>any</em> of these choices, so <code>Title</code> as well as <code>Genres</code> will be shown for each DVD in the collection.

The result will look like this:

Title: Wild Down Under
Genres: Documentary Special Interest
Title: Pride
Genres: Documentary
Title: Gandhi
Genres: Drama Classic
Title: The Abyss
Genres: Science-Fiction Suspense/Thriller
Title: Shouf Shouf Habibi
Genres: Comedy


The genres are listed as single lines, where each line can contain one (or zero) or more genres.

If you look further down in the XML structure, you'll notice that some keys or tags have subkeys: <code>Genres</code> for example uses <code>Genre</code> subkeys.
Subkeys are used when multiple values are possible.
They can be viewed best in <a href="pictures/dvdcoll_treeview.gif">XML Notepad's treeview</a>.
To list each individual genre we must use <code>/Collection/DVD/Genres/Genre</code>.

So next, let's display the Title <em>and</em> each <em>individual</em> Genre:

strQuery = "/Collection/DVD/ ( Title | Genres/Genre )"

Roughly translated: display anything that matches <code>"/Collection/DVD/Title"</code> or <code>"/Collection/DVD/Genres/Genre"</code>

The result will look like this:

Title: Wild Down Under
Genre: Documentary
Genre: Special Interest
Title: Pride
Genre: Documentary
Title: Gandhi
Genre: Drama
Genre: Classic
Title: The Abyss
Genre: Science-Fiction
Genre: Suspense/Thriller
Title: Shouf Shouf Habibi
Genre: Comedy


Note how some DVDs have multiple Genres.

OK, listing properties for each item in a collection no longer has any secrets for you.
Let's select specific items (DVDs) from the collection.
List the titles and genres of all documentaries:

strQuery = "/Collection/DVD [ Genres/Genre = 'Documentary' ] / ( Title | Genres/Genre )"

The result will look like this:

Title: Wild Down Under
<span>Genre: Documentary</span>
Genre: Special Interest
Title: Pride
<span>Genre: Documentary</span>
Title: March of the Penguins
<span>Genre: Documentary</span>
Title: Alaska: Spirit of the Wild
<span>Genre: Documentary</span>
Genre: Special Interest
Title: Wilderness Journey - Canyon Suites
<span>Genre: Documentary</span>
Genre: Special Interest
Genre: Music


It is possible to select based on genre without displaying it:

strQuery = "/Collection/DVD [ Genres/Genre = 'Documentary' ] /Title"

would only display the titles of the documentaries.

Finally, the selection can be narrowed down by using <code>and</code> and <code>or</code>.
Note that these are case sensitive, so <code>And</code> will <em>not</em> work.

List titles and all formats for each documentary that supports 16x9 format:

strQuery = "/Collection/DVD " _
     & "[ Genres/Genre = 'Documentary' and Format/Format16X9 = 'True' ] " _
     & "/ ( Title | Format/* )"


The result will look like this:

Title: Wild Down Under
FormatAspectRatio: 1.78
FormatVideoStandard: PAL
FormatLetterBox: True
FormatPanAndScan: False
FormatFullFrame: False
<span>Format16X9: True</span>
FormatDualSided: False
FormatDualLayered: False
FormatFlipper: False
Title: Pride
FormatVideoStandard: PAL
FormatLetterBox: True
FormatPanAndScan: False
FormatFullFrame: True
<span>Format16X9: True</span>
FormatDualSided: False
FormatDualLayered: True
FormatFlipper: False




<strong>. . . TO BE CONTINUED . . .</strong>




<h2 id="Related">&emsp;Related Stuff:</h2>
<a href="http://msdn.microsoft.com/en-us/library/ms763798%28v=vs.85%29.aspx">XML DOM Properties</a>
<a href="http://msdn.microsoft.com/en-us/library/ms757828%28v=vs.85%29.aspx">XML DOM Methods</a>
<a href="http://www.westphil.nl/systemadministration/vbscript/index.php?name=createxml">Save information to an XML file</a>, by Adriaan Westra
<a href="http://www.westphil.nl/systemadministration/vbscript/index.php?name=getxmlelement">Get information from an XML file</a>, by Adriaan Westra




<h2><k>ZIP Files</k></h2>
<a href="#X-ZIP">ZIP files and/or folders with X-ZIP</a>
<a href="#CopyHereZIP">ZIP <em>folders</em> with System.Shell Folders' CopyHere method</a>
<a href="#X-UNZIP">UNZIP with X-ZIP</a>
<a href="#CopyHereUNZIP">UNZIP with System.Shell Folders' CopyHere method</a>








ZIP files with
<a href="http://www.xstandard.com/en/documentation/xzip/">X-ZIP</a>
VBScript Code:

Zip "C:\boot.ini", "C:\testzip.zip"


Function Zip( myFileSpec, myZip )
' This function uses X-standards.com's X-zip component to add
' files to a ZIP file.
' If the ZIP file doesn't exist, it will be created on-the-fly.
' Compression level is set to maximum, only relative paths are
' stored.
'
' Arguments:
' myFileSpec    [string] the file(s) to be added, wildcards allowed
'                        (*.* will include subdirectories, thus
'                        making the function recursive)
' myZip         [string] the fully qualified path to the ZIP file
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
' The X-zip component is available at:
' http://www.xstandard.com/en/documentation/xzip/
' For more information on available functionality read:
' http://www.xstandard.com/printer-friendly.asp?id=C9891D8A-5390-44ED-BC60-2267ED6763A7
Dim objZIP
On Error Resume Next
Err.Clear
Set objZIP = CreateObject( "XStandard.Zip" )
objZIP.Pack myFileSpec, myZip, , , 9
Zip = Err.Number
Err.Clear
Set objZIP = Nothing
On Error Goto 0
End Function

Requirements:
Windows version:any
Network:any
Client software:<a href="http://www.xstandard.com/en/documentation/xzip/">X-ZIP</a> component
Script Engine:any
Summarized:Works in any Windows version with the <a href="http://www.xstandard.com/en/documentation/xzip/">X-ZIP</a> component installed.
ZIP <em>folders</em> with System.Shell Folder's <a href="http://msdn.microsoft.com/en-us/library/ms723207.aspx">CopyHere</a> method
VBScript Code:

Option Explicit

Dim arrResult

arrResult = ZipFolder( "C:\Documents and Settings\MyUserID\Application Data", "C:\MyUserID.zip" )
If arrResult(0) = 0 Then
If arrResult(1) = 1 Then
    WScript.Echo "Done; 1 empty subfolder was skipped."
Else
    WScript.Echo "Done; " & arrResult(1) & " empty subfolders were skipped."
End If
Else
WScript.Echo "ERROR " & Join( arrResult, vbCrLf )
End If


Function ZipFolder( myFolder, myZipFile )
' This function recursively ZIPs an entire folder into a single ZIP file,
' using only Windows' built-in ("native") objects and methods.
'
' Last Modified:
' October 12, 2008
'
' Arguments:
' myFolder   [string]  the fully qualified path of the folder to be ZIPped
' myZipFile  [string]  the fully qualified path of the target ZIP file
'
' Return Code:
' An array with the error number at index 0, the source at index 1, and
' the description at index 2. If the error number equals 0, all went well
' and at index 1 the number of skipped empty subfolders can be found.
'
' Notes:
' [1] If the specified ZIP file exists, it will be overwritten
'     (NOT APPENDED) without notice!
' [2] Empty subfolders in the specified source folder will be skipped
'     without notice; lower level subfolders WILL be added, whether
'     empty or not.
' [3] There seems to be an undocumented limit to the number of files
'     that can be added, possibly due to timeouts; limits may vary from
'     200 to 700 files; better stay well below 200 files just to be safe.
' [4] ZIP files can NEVER exceed 2 GB! This is a limitation in the ZIP
'     format itself.
'
' Based on a VBA script (http://www.rondebruin.nl/win/s7/win001.htm)
' by Ron de Bruin, http://www.rondebruin.nl
'
' (Re)written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim intSkipped, intSrcItems
Dim objApp, objFolder, objFSO, objItem, objTxt
Dim strSkipped

Const ForWriting = 2

intSkipped = 0

' Make sure the path ends with a backslash
If Right( myFolder, 1 ) &lt;> "\" Then
    myFolder = myFolder & "\"
End If

' Use custom error handling
On Error Resume Next

' Create an empty ZIP file
Set objFSO = CreateObject( "Scripting.FileSystemObject" )
Set objTxt = objFSO.OpenTextFile( myZipFile, ForWriting, True )
objTxt.Write "PK" & Chr(5) & Chr(6) & String( 18, Chr(0) )
objTxt.Close
Set objTxt = Nothing

' Abort on errors
If Err Then
    ZipFolder = Array( Err.Number, Err.Source, Err.Description )
    Err.Clear
    On Error Goto 0
    Exit Function
End If

' Create a Shell object
Set objApp = CreateObject( "Shell.Application" )

' Copy the files to the compressed folder
For Each objItem in objApp.NameSpace( myFolder ).Items
    If objItem.IsFolder Then
        ' Check if the subfolder is empty, and if
        ' so, skip it to prevent an error message
        Set objFolder = objFSO.GetFolder( objItem.Path )
        If objFolder.Files.Count + objFolder.SubFolders.Count = 0 Then
 intSkipped = intSkipped + 1
        Else
 objApp.NameSpace( myZipFile ).CopyHere objItem
        End If
    Else
        objApp.NameSpace( myZipFile ).CopyHere objItem
    End If
Next

Set objFolder = Nothing
Set objFSO    = Nothing

' Abort on errors
If Err Then
    ZipFolder = Array( Err.Number, Err.Source, Err.Description )
    Set objApp = Nothing
    Err.Clear
    On Error Goto 0
    Exit Function
End If

' Keep script waiting until compression is done
intSrcItems = objApp.NameSpace( myFolder  ).Items.Count
Do Until objApp.NameSpace( myZipFile ).Items.Count + intSkipped = intSrcItems
    WScript.Sleep 200
Loop
Set objApp = Nothing

' Abort on errors
If Err Then
    ZipFolder = Array( Err.Number, Err.Source, Err.Description )
    Err.Clear
    On Error Goto 0
    Exit Function
End If

' Restore default error handling
On Error Goto 0

' Return message if empty subfolders were skipped
If intSkipped = 0 Then
    strSkipped = "
Else
    strSkipped = "skipped empty subfolders"
End If

' Return code 0 (no error occurred)
ZipFolder = Array( 0, intSkipped, strSkipped )
End Function
Requirements:
Windows version:Windows 2000, XP, Server 2003 & Vista
Network:any
Client software:N/A
Script Engine:any
Summarized:Should work in Windows 2000 and later.
<em>Will not work in Windows 95, 98, ME or NT.</em>
UNZIP with <a href="http://www.xstandard.com/en/documentation/xzip/">X-ZIP</a>
VBScript Code:

UnZip "C:\testzip.zip", "D:\", "*.ini"


Function UnZip( myZip, myTargetDir, myFileSpec )
' This function uses X-standards.com's X-zip component to extract files from a ZIP file.
'
' Arguments:
' myZip         [string] the fully qualified path to the ZIP file
' myTargetDir   [string] the directory where the extracted files will be located
' myFileSpec    [string] the file(s) to be extracted, wildcards allowed
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
' The X-zip component is available at:
' http://www.xstandard.com/en/documentation/xzip/
' For more information on available functionality read:
' http://www.xstandard.com/printer-friendly.asp?id=C9891D8A-5390-44ED-BC60-2267ED6763A7
Dim objZIP
On Error Resume Next
Err.Clear
Set objZIP = CreateObject( "XStandard.Zip" )
objZIP.UnPack myZip, myTargetDir, myFileSpec
UnZip = Err.Number
Err.Clear
Set objZIP = Nothing
On Error Goto 0
End Function

Requirements:
Windows version:any
Network:any
Client software:<a href="http://www.xstandard.com/en/documentation/xzip/">X-ZIP</a> component
Script Engine:any
Summarized:Works in any Windows version with the <a href="http://www.xstandard.com/en/documentation/xzip/">X-ZIP</a> component installed.
UNZIP with System.Shell Folder's <a href="http://msdn.microsoft.com/en-us/library/ms723207.aspx">CopyHere</a> method

<em>(can also be used to extract CAB files and other archives,
or to copy folders while displaying a progress bar)</em>
VBScript Code:

Option Explicit

' UnZip "C:\test.zip" into the folder "C:\test1"
Extract "C:\test.zip", "C:\test1"

' Extract "C:\test.cab" into the folder "C:\test2"
Extract "C:\test.cab", "C:\test2"

' Copy the contents of folder "C:\test2" to the folder "C:\test3"
Extract "C:\test2", "C:\test3"


Sub Extract( ByVal myZipFile, ByVal myTargetDir )
' Function to extract all files from a compressed "folder"
' (ZIP, CAB, etc.) using the Shell Folders' CopyHere method
' (http://msdn2.microsoft.com/en-us/library/ms723207.aspx).
' All files and folders will be extracted from the ZIP file.
' A progress bar will be displayed, and the user will be
' prompted to confirm file overwrites if necessary.
'
' Note:
' This function can also be used to copy "normal" folders,
' if a progress bar and confirmation dialog(s) are required:
' just use a folder path for the "myZipFile" argument.
'
' Arguments:
' myZipFile    [string]  the fully qualified path of the ZIP file
' myTargetDir  [string]  the fully qualified path of the (existing) destination folder
'
' Based on an article by Gerald Gibson Jr.:
' http://www.codeproject.com/csharp/decompresswinshellapics.asp
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

Dim intOptions, objShell, objSource, objTarget

' Create the required Shell objects
Set objShell = CreateObject( "Shell.Application" )

' Create a reference to the files and folders in the ZIP file
Set objSource = objShell.NameSpace( myZipFile ).Items( )

' Create a reference to the target folder
Set objTarget = objShell.NameSpace( myTargetDir )

' These are the available CopyHere options, according to MSDN
' (http://msdn2.microsoft.com/en-us/library/ms723207.aspx).
' On my test systems, however, the options were completely ignored.
'      4: Do not display a progress dialog box.
'      8: Give the file a new name in a move, copy, or rename
'         operation if a file with the target name already exists.
'     16: Click "Yes to All" in any dialog box that is displayed.
'     64: Preserve undo information, if possible.
'    128: Perform the operation on files only if a wildcard file
'         name (*.*) is specified.
'    256: Display a progress dialog box but do not show the file
'         names.
'    512: Do not confirm the creation of a new directory if the
'         operation requires one to be created.
'   1024: Do not display a user interface if an error occurs.
'   4096: Only operate in the local directory.
'         Don't operate recursively into subdirectories.
'   8192: Do not copy connected files as a group.
'         Only copy the specified files.
intOptions = 256

' UnZIP the files
objTarget.CopyHere objSource, intOptions

' Release the objects
Set objSource = Nothing
Set objTarget = Nothing
Set objShell  = Nothing
End Sub

Requirements:
Windows version:Windows 2000, XP, Server 2003 & Vista
Network:any
Client software:N/A
Script Engine:any
Summarized:Should work in Windows 2000 and later.
<em>Will not work in Windows 95, 98, ME or NT.</em>
<img data-src="https://www.robvanderwoude.com/pictures/copyheredialog.gif" width="381" height="169" />




<h2><k>File Versions</k></h2>
<a href="#GetProductVersion">Shell.Application: ProductVersion</a>
<a href="#MSIProductVersion">WindowsInstaller.Installer: ProductVersion</a> (*.msi)
<a href="#GetFileVersion">Scripting.FileSystemObject: GetFileVersion</a>
<a href="#DateLastModified">Scripting.FileSystemObject: DateLastModified</a>
<a href="#CompareVersions">CompareVersions</a> compares two version strings digit by digit







Shell.Application: ProductVersion
Return a file's product version
VBScript Code:<a href="./files/filever.zip">Download</a> <a href="./files/filever.zip">&#x1f4be;</a>
<span>Function</span> GetProductVersion<span>&#40;</span> myFile <span>&#41;' Based on code by Maputi on StackOverflow.com:' http://stackoverflow.com/a/2990698Dim</span> arrTranslations<span>Dim</span> i<span>Dim</span> objFolder, objFolderItem, objShell<span>Dim</span> strFileName, strPropertyName, strParentFolder, strVersion<span>' Note that property names are language dependent, so you may have to add the lower case property name for your own languageSet</span> arrTranslations = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"System.Collections.ArrayList"</span> <span>&#41;</span>arrTranslations<span>.Add</span> <span>"product version"</span> <span>' English</span>arrTranslations<span>.Add</span> <span>"productversie"</span>   <span>' Dutch</span>strVersion = <span>"</span>strFileName       = objFSO<span>.GetFileName&#40;</span> myFile <span>&#41;</span>strParentFolder   = objFSO<span>.GetParentFolderName&#40;</span> myFile <span>&#41;Set</span> objShell      = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Shell.Application"</span> <span>&#41;Set</span> objFolder     = objShell<span>.Namespace&#40;</span> strParentFolder <span>&#41;Set</span> objFolderItem = objFolder<span>.ParseName&#40;</span> strFileName <span>&#41;For</span> i = <span>0</span> <span>To</span> <span>300</span>strPropertyName = objFolder<span>.GetDetailsOf&#40;</span> objFolder<span>.Items</span>, i <span>&#41;If</span> arrTranslations<span>.Contains&#40;</span> <a href="http://www.google.com/search?q=LCASE+site:msdn.microsoft.com"><span>LCase</span></a><span>&#40;</span> strPropertyName <span>&#41;</span> <span>&#41;</span> <span>Then' Product Version</span>strVersion = objFolder<span>.GetDetailsOf&#40;</span> objFolderItem, i <span>&#41;Exit</span> <span>ForEnd</span> <span>IfNextSet</span> objFolderItem   = <span>NothingSet</span> objFolder       = <span>NothingSet</span> objShell        = <span>NothingSet</span> arrTranslations = <span>Nothing' Replace commas by dots</span>strVersion = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strVersion, <span>","</span>, <span>"."</span> <span>&#41;' Remove spaces</span>strVersion = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strVersion, <span>" "</span>, <span>"</span>  <span>&#41;</span>GetProductVersion = strVersion<span>End</span> <span>Function</span>
Requirements:
Windows version:2000 and later with .NET Framework 2.0 or later
Network:any
Script Engine:any
Summarized:Works in Windows 2000 and later versions with .NET Framework 2.0 or later installed;
works with all scripting engines;
may require the addition of a translation for "Product Version" in languages other than English and Dutch.






WindowsInstaller.Installer: ProductVersion
Rerurn an MSI file's product version
VBScript Code: 
<span>Function</span> GetMSIProductVersion<span>&#40;</span> myFile <span>&#41;' Code by Arnout Grootveld' http://stackoverflow.com/a/328710Const</span> msiOpenDatabaseModeReadOnly = <span>0Dim</span> objMSI, objDB, objView, strVersionGetMSIProductVersion = <span>"Set</span> objMSI  = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WindowsInstaller.Installer"</span> <span>&#41;Set</span> objDB   = objMSI<span>.OpenDataBase&#40;</span> myFile, msiOpenDatabaseModeReadOnly <span>&#41;Set</span> objView = objDB<span>.OpenView&#40;</span> <span>"SELECT `Value` FROM `Property` WHERE `Property` = 'ProductVersion'"</span> <span>&#41;Call</span> objView<span>.Execute&#40;</span> <span>&#41;</span>strVersion = objView<span>.Fetch&#40;</span> <span>&#41;.StringData&#40;1&#41;' Replace commas by dots</span>strVersion = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strVersion, <span>","</span>, <span>"."</span> <span>&#41;' Remove spaces</span>strVersion = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> strVersion, <span>" "</span>, <span>"</span>  <span>&#41;</span>GetMSIProductVersion = strVersion<span>End</span> <span>Function</span>
Requirements:
Windows version:Windows XP or later
Network:any
Script Engine:any
Summarized:Works in Windows XP and later versions with all scripting engines.






Scripting.FileSystemObject: GetFileVersion
Rerurn a file's file version
VBScript Code: 
<span>Dim</span> objFSO, strFileNamestrFileName = <span>"C:\Windows\notepad.exe"Set</span> objFSO = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;</span>WScript<span>.Echo</span> objFSO<span>.GetFileVersion&#40;</span> strFileName <span>&#41;Set</span> objFSO = <span>Nothing</span>
Requirements:
Windows version:any
Network:any
Script Engine:any
Summarized:Works in all Windows versions with all scripting engines.






Scripting.FileSystemObject: DateLastModified
Rerurn a file's timestamp
VBScript Code: 
<span>Dim</span> objFSO, strFileNamestrFileName = <span>"C:\Windows\notepad.exe"Set</span> objFSO = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;</span>WScript<span>.Echo</span> objFSO<span>.GetFile&#40;</span> strFileName <span>&#41;.DateLastModifiedSet</span> objFSO = <span>Nothing</span>
Requirements:
Windows version:any
Network:any
Script Engine:any
Summarized:Works in all Windows versions with all scripting engines.






CompareVersions
Compare two version strings digit by digit
VBScript Code: 
<span>Function</span> CompareVersions<span>&#40;</span> myVer1, myVer2 <span>&#41;' Function : CompareVersions compares 2 version strings and returns'            an integer value telling you which version is higher.' Returns  : A positive value means myVer1 is higher than myVer2,'            a negative value means myVer1 is lower than myVer2,'            zero means the versions are equal.'            If the absolute value of the result equals 2, only the'            number of digits from the shortes of versions were compared;'            if the absolute value equals 1, the shortest of versions had a'            number of zeroes appended before the comparison was conclusive.' Examples : CompareVersions( "10.2.0", "10.1.1900" ) returns  2'            CompareVersions( "10.1.0.1900", "10.1" ) returns  1'            CompareVersions( "10.00.0.0.0", "10.0" ) returns  0'            CompareVersions( "10.0", "10.0.0.1850" ) returns -1'            CompareVersions( "9.9.99.9999", "10.1" ) returns -2' Version   : 1.00 (2017-02-17)' Author    : Rob van der Woude'             http://www.robvanderwoude.com/'Dim</span> arrVer1, arrVer2<span>Dim</span> i, intCompare, intMax, intMinintCompare = <span>0If</span> myVer1 <span>&lt;></span> myVer2 <span>Then</span>arrVer1 = <a href="http://www.google.com/search?q=SPLIT+site:msdn.microsoft.com"><span>Split</span></a><span>&#40;</span> myVer1, <span>"."</span> <span>&#41;</span>arrVer2 = <a href="http://www.google.com/search?q=SPLIT+site:msdn.microsoft.com"><span>Split</span></a><span>&#40;</span> myVer2, <span>"."</span> <span>&#41;If</span> <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer1 <span>&#41;</span> <span>></span> <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer2 <span>&#41;</span> <span>Then</span>intMax = <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer1 <span>&#41;</span>intMin = <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer2 <span>&#41;For</span> i = intMin <span>To</span> intMaxmyVer2 = myVer2 & <span>".0"Next</span>arrVer2 = <a href="http://www.google.com/search?q=SPLIT+site:msdn.microsoft.com"><span>Split</span></a><span>&#40;</span> myVer2, <span>"."</span> <span>&#41;ElseIf</span> <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer1 <span>&#41;</span> <span>&lt;</span> <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer2 <span>&#41;</span> <span>Then</span>intMax = <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer2 <span>&#41;</span>intMin = <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer1 <span>&#41;For</span> i = intMin <span>To</span> intMaxmyVer1 = myVer1 & <span>".0"Next</span>arrVer1 = <a href="http://www.google.com/search?q=SPLIT+site:msdn.microsoft.com"><span>Split</span></a><span>&#40;</span> myVer1, <span>"."</span> <span>&#41;Else</span>intMax = <a href="http://www.google.com/search?q=UBOUND+site:msdn.microsoft.com"><span>UBound</span></a><span>&#40;</span> arrVer1 <span>&#41;</span>intMin = intMax<span>End</span> <span>IfFor</span> i = <span>0</span> <span>To</span> intMin<span>If</span> <span>CInt&#40;</span> arrVer1<span>&#40;</span>i<span>&#41;</span> <span>&#41;</span> <span>></span> <span>CInt&#40;</span> arrVer2<span>&#40;</span>i<span>&#41;</span> <span>&#41;</span> <span>Then</span>intCompare = <span>2Exit</span> <span>ForElseIf</span> <span>CInt&#40;</span> arrVer1<span>&#40;</span>i<span>&#41;</span> <span>&#41;</span> <span>&lt;</span> <span>CInt&#40;</span> arrVer2<span>&#40;</span>i<span>&#41;</span> <span>&#41;</span> <span>Then</span>intCompare = <span>-2Exit</span> <span>ForEnd</span> <span>IfNextIf</span> intCompare = <span>0</span> <span>ThenFor</span> i = intMin <span>+</span> <span>1</span> <span>To</span> intMax<span>If</span> <span>CInt&#40;</span> arrVer1<span>&#40;</span>i<span>&#41;</span> <span>&#41;</span> <span>></span> <span>CInt&#40;</span> arrVer2<span>&#40;</span>i<span>&#41;</span> <span>&#41;</span> <span>Then</span>intCompare = <span>1Exit</span> <span>ForElseIf</span> <span>CInt&#40;</span> arrVer1<span>&#40;</span>i<span>&#41;</span> <span>&#41;</span> <span>&lt;</span> <span>CInt&#40;</span> arrVer2<span>&#40;</span>i<span>&#41;</span> <span>&#41;</span> <span>Then</span>intCompare = <span>-1Exit</span> <span>ForEnd</span> <span>IfNextEnd</span> <span>IfEnd</span> <span>If</span>CompareVersions = intCompare<span>End</span> <span>Function</span>
Requirements:
Windows version:any
Network:any
Script Engine:any
Summarized:Works in all Windows versions with all scripting engines.




<h2><k>Create Folders</k></h2>
<h2>&emsp;the way CMD.EXE's MD does</h2>
This script by Todd Reeves allows us to create folders several levels deep all in one go, like CMD.EXE's internal MD command does.






CreateDirs (Scripting.FileSystemObject)
<strong>VBScript Code:</strong>

Option Explicit

' UNC path
CreateDirs "\\MYSERVER\D$\Test01\Test02\Test03\Test04"
' Absolute path
CreateDirs "D:\Test11\Test12\Test13\Test14"
' Relative path
CreateDirs "Test21\Test22\Test23\Test24"


Sub CreateDirs( MyDirName )
' This subroutine creates multiple folders like CMD.EXE's internal MD command.
' By default VBScript can only create one level of folders at a time (blows
' up otherwise!).
'
' Argument:
' MyDirName   [string]   folder(s) to be created, single or
'                        multi level, absolute or relative,
'                        "d:\folder\subfolder" format or UNC
'
' Written by Todd Reeves
' Modified by Rob van der Woude
' http://www.robvanderwoude.com

Dim arrDirs, i, idxFirst, objFSO, strDir, strDirBuild

' Create a file system object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Convert relative to absolute path
strDir = objFSO.GetAbsolutePathName( MyDirName )

' Split a multi level path in its "components"
arrDirs = Split( strDir, "\" )

' Check if the absolute path is UNC or not
If Left( strDir, 2 ) = "\\" Then
    strDirBuild = "\\" & arrDirs(2) & "\" & arrDirs(3) & "\"
    idxFirst    = 4
Else
    strDirBuild = arrDirs(0) & "\"
    idxFirst    = 1
End If

' Check each (sub)folder and create it if it doesn't exist
For i = idxFirst to Ubound( arrDirs )
    strDirBuild = objFSO.BuildPath( strDirBuild, arrDirs(i) )
    If Not objFSO.FolderExists( strDirBuild ) Then 
        objFSO.CreateFolder strDirBuild
    End if
Next

' Release the file system object
Set objFSO= Nothing
End Sub
Requirements:
Windows version:any
Network:N/A
Client software:N/A
Script Engine:any
Summarized:Works in any Windows version, with any scripting engine.




<h2><k>Delete Folders</k></h2>
<h2>&emsp;including subfolders</h2>
This script deletes folders, empty or not, all in one go, like DOS' DELTREE command does.






DelTree
<strong>VBScript Code:</strong>

Option Explicit

Dim objFSO, objTempFolder, strTempFolder

Const TEMP_FOLDER = 2

Set objFSO        = CreateObject( "Scripting.FileSystemObject" )
Set objTempFolder = objFSO.GetSpecialFolder( TEMP_FOLDER )
strTempFolder     = objTempFolder.Path

DelTree strTempFolder, True


Sub DelTree( myFolder, blnKeepRoot )
' With this subroutine you can delete folders and their content,
' including subfolders.
' You can specify if you only want to empty the folder, and thus
' keep the folder itself, or to delete the folder itself as well.
' Root directories and some (not all) vital system folders are
' protected: if you try to delete them you'll get a message that
' deleting these folders is not allowed.
'
' Arguments:
' myFolder     [string]   the folder to be emptied or deleted
' blnKeepRoot  [boolean]  if True, the folder is emptied only,
'                         otherwise it will be deleted itself too
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
Dim arrSpecialFolders(3)
Dim objMyFSO, objMyFile, objMyFolder, objMyShell
Dim objPrgFolder, objPrgFolderItem, objSubFolder, wshMyShell
Dim strPath, strSpecialFolder

Const WINDOWS_FOLDER =  0
Const SYSTEM_FOLDER  =  1
Const PROGRAM_FILES  = 38

' Use custom error handling
On Error Resume Next

' List the paths of system folders that should NOT be deleted
Set wshMyShell       = CreateObject( "WScript.Shell" )
Set objMyFSO         = CreateObject( "Scripting.FileSystemObject" )
Set objMyShell       = CreateObject( "Shell.Application" )
Set objPrgFolder     = objMyShell.Namespace( PROGRAM_FILES )
Set objPrgFolderItem = objPrgFolder.Self

arrSpecialFolders(0) = wshMyShell.SpecialFolders( "MyDocuments" )
arrSpecialFolders(1) = objPrgFolderItem.Path
arrSpecialFolders(2) = objMyFSO.GetSpecialFolder( SYSTEM_FOLDER  ).Path
arrSpecialFolders(3) = objMyFSO.GetSpecialFolder( WINDOWS_FOLDER ).Path

Set objPrgFolderItem = Nothing
Set objPrgFolder     = Nothing
Set objMyShell       = Nothing
Set wshMyShell       = Nothing

' Check if a valid folder was specified
If Not objMyFSO.FolderExists( myFolder ) Then
    WScript.Echo "Error: path not found (" & myFolder & ")"
    WScript.Quit 1
End If
Set objMyFolder = objMyFSO.GetFolder( myFolder )

' Protect vital system folders and root directories from being deleted
For Each strSpecialFolder In arrSpecialFolders
    If UCase( strSpecialFolder ) = UCase( objMyFolder.Path ) Then
        WScript.Echo "Error: deleting " _
        & objMyFolder.Path & " is not allowed"
        WScript.Quit 1
    End If
Next

' Protect root directories from being deleted
If Len( objMyFolder.Path ) &lt; 4 Then
    WScript.Echo "Error: deleting root directories is not allowed"
    WScript.Quit 1
End If

' First delete the files in the directory specified
For Each objMyFile In objMyFolder.Files
    strPath = objMyFile.Path
    objMyFSO.DeleteFile strPath, True
    If Err Then
        WScript.Echo "Error # " & Err.Number & vbCrLf _
        & Err.Description         & vbCrLf _
        & "(" & strPath & ")"     & vbCrLf
    End If
Next

' Next recurse through the subfolders
For Each objSubFolder In objMyFolder.SubFolders
    DelTree objSubFolder, False
Next

' Finally, remove the "root" directory unless it should be preserved
If Not blnKeepRoot Then
    strPath = objMyFolder.Path
    objMyFSO.DeleteFolder strPath, True
    If Err Then
        WScript.Echo "Error # " & Err.Number & vbCrLf _
        & Err.Description         & vbCrLf _
        & "(" & strPath & ")"     & vbCrLf
    End If
End If

' Cleaning up the mess
On Error Goto 0
Set objMyFolder = Nothing
Set objMyFSO    = Nothing
End Sub
Requirements:
Windows version:any
Network:N/A
Client software:N/A
Script Engine:any
Summarized:Should work in any Windows version, with any scripting engine.




<h2 id="Intro">HTAs</h2>
<strong>HTA</strong>s (<strong>HT</strong>ML <strong>A</strong>pplications) are webpages (forms), with access to local resources.

Though the engine that executes HTAs (MSHTA.EXE) shares a lot of code with Internet Explorer, it doesn't have Internet Explorer's tight security restrictions.
In fact, if run with elevated privileges, HTAs have access to every resource that administrators have access to!

If you want to build a nice looking user interface for your VBScript scripts collection, try an HTA (or rewrite them in Visual Basic).
If you need to build a proof of concept for a new program, consider an HTA.



<img data-src="https://www.robvanderwoude.com/pictures/visual_studio_2010_express_installer_hta_640x480.jpg" width="640" height="480" />

Microsoft's Visual Studio 2010 Express Edition installer is an example of a great looking HTA.





<img data-src="https://www.robvanderwoude.com/pictures/htaedit640x480.jpg" width="640" height="480" />

HTAEdit (now seamlessly integrated in VBSEdit)





On this page, I intend to show some of the pitfalls I encountered in building HTAs, and some solutions or work-arounds.

My preferred tool for developing HTAs is <a href="http://www.vbsedit.com/">VBSEdit</a>.
It used to come with a separate program <a href="http://www.htaedit.com/">HTAEdit</a> in a single package, but recently these programs have been merged, and the new VBSEdit now handles HTAs too.

VBSEdit comes with a built-in debugger, but debugging an HTA is much harder then debugging VBScript code, so I usually write and test VBScript code in VBSEdit, and when ready, use it in an HTA's subroutines.

HTAs aren't restricted to HTML and VBScript, you can use JScript and JavaScript without the need to install anything, and PerlScript if you install Perl.

Note:When using multiple scripting languages in a single HTA, <strong>all</strong> <em>event handlers</em> (e.g. <code><strong>onclick</strong></code>) must <em>always</em> specify the language for the called commands, e.g.:

&lt;input type="button" value="Click Me" <strong>onclick</strong>="<span>vbscript:</span>MsgBox 'Click Me (VBScript)'" />
&lt;input type="button" value="No, Me" <strong>onclick</strong>="<span>javascript:</span>alert('No, Me (JavaScript)');" />






<h2 id="BuildIt">&emsp;Building Your HTA</h2>
Each HTA is actually an HTML page with one or more HTA specific code blocks.


Code <input type="button" id="buttonBW" value="B/W" title="Show this table in black and white" onclick="bw();" />DescriptionRemarks


&lt;!DOCTYPE HTML>Document Type DeclarationOptional but recommended for IE versions > 6
&lt;html lang="<em>en</em>">HTML begin<code>&lt;html></code> required, language (<a href="https://www.w3.org/International/questions/qa-html-language-declarations">lang</a> property) optional but recommended
&lt;head>HTML head beginRequired
&lt;title><em>My HTML application</em>&lt;/title>HTML/HTA title bar captionOptional but recommended, will also show up in Windows' task bar, can be read or set with <code>document.title</code>
&lt;HTA:APPLICATIONHTA definition block beginRequired; for a detailed list of all available properties see Microsoft's <a href="https://msdn.microsoft.com/en-us/library/ms536473.aspx">HTML Applications Reference</a>
 APPLICATIONNAME="<em>HTA Name</em>"HTA nameRequired; can be read by script with <code><em>HTAID</em>.ApplicationName</code>
 ID="<em>HTAID</em>"HTA unique IDRequired
 VERSION="<em>1.0</em>"HTA versionRequired; can be read by script with <code><em>HTAID</em>.Version</code>
 BORDER="none"
 SCROLL="auto"
 SINGLEINSTANCE="yes"Only one HTA with this HTA's ID can run at any timeIf omitted or "no", multiple instances of this HTA can run simultaneously
 WINDOWSTATE="maximize"Maximize the HTA window when openedOptional; not recommended if the HTA window must be resizable, as the window may resize spontaneously when dragged
 NAVIGABLE="yes"
/>End of HTA definition block
&lt;meta http-equiv="x-ua-compatible" content="ie=9" />Compatibility meta tagOptional; this will enable many CSS 3 and HTML 5 features, <a href="#Quirks">but you will need to adjust your event handlers</a>

&lt;style type="text/css">Stylesheet beginOptional; external stylesheets are allowed too
 &bull;
 &bull;
 &bull;CSS style definitions
&lt;/style>End of stylesheet
&lt;/head>End of HTML headRequired
&lt;script language="VBScript">WSH (VBScript) code beginUnlike JavaScript in web pages, which is located either inside the HTML head or inside the HTML body, the HTA's code (usually VBScript, but may also be JScript or PerlScript or any WSH supported scripting language) is positioned between the HTML head and body
Option Explicit
Dim <em>global_variables</em>Global variables declaration<em>Declare</em> global variables here, <em>set</em> them in <code>Window_OnLoad</code> (or elsewhere)

Sub window_onloadUse this code block to initialize objects and variables, parse the (optional) command line, etc.
 'This method will be called
 'when the application loads
End Sub

&bull;
&bull;
&bull;Place your other subroutines here

Sub window_onunloadUse this code block to clean up objects, close files, etc.
 'This method will be called
 'when the application exits
End Sub

&lt;/script>End of WSH (VBScript) code
&lt;script type="text/javascript">JavaScript code beginOptional; external javascripts are allowed too, inside the head or body;
unlike "true" web pages, in HTA's the JavaScript code may be located <em>between</em> the head and the body as well as <em>inside</em>.
 &bull;
 &bull;
 &bull;JavaScript code
&lt;/script>End of JavaScript code
&lt;body>HTML bodyUse the HTML body to build the HTA's user interface
 &bull;
 &bull;
 &bull;
&lt;/body>
&lt;/html>End of file







<h2 id="AddControls">&emsp;Adding Controls</h2>
In an HTA, you can add elements and controls just like you would in a web form.

You can reference an element directly by its ID, e.g. if you have a textbox with ID "MyTextBox" you can read its value with the following code:

strText = MyTextBox.value

Or:

strText = document.getElementById( "MyTextBox" ).value

The latter is <em>much</em> easier to debug in <a href="http://www.vbsedit.com/">VBSEdit</a>.





<h2 id="GlobalVariables">&emsp;Global Variables</h2>
Using local variables inside subroutines is a piece of cake.
Global variables in HTAs, on the other hand, require some extra attention.


Start the VBScript code block wit the declaration of <em>all</em> global variables (<code>Dim</code> statements) and <em>all</em> constants (<code>Const</code> statements).
I recommend using a variable naming convention that clearly shows whether a variable is global or local.
I use 3 letter prefixes for <em>all</em> variables in my VBScript scripts, e.g. <code>strVar</code> for strings, <code>objVar</code> for objects, <code>arrVar</code> for arrays...
In HTAs, however, I use those prefixes for <em>local</em> variables only, and use prefixes starting with <code>gv</code> for <em>global</em> variables, e.g. <code>gvsVar</code> for strings, <code>gvoVar</code> for objects, <code>gvaVar</code> for arrays...
This is not required, you are even free to use <em>no</em> prefixes at all, but these naming conventions <em>do</em> make debugging a lot easier.
Though not recommended, you <em>could</em> choose to <em>set</em> a global variable right after declaring it, e.g.
Dim gvoFSO
Set gvoFSO = CreateObject( "Scripting.FileSystemObject" )
The recommended way, however, is to <em>declare</em> the global variable at the top of the VBScript code block, and <em>set</em> it in the <code>window_onload</code> (or any other) subroutine.
Setting a global variable using a subroutine (or setting a Control property) should be done in the <code>window_onload</code> subroutine, which is executed <em>after</em> the entire HTA window is loaded.
MSHTA.EXE reads the entire VBScript code block linearly, from top to bottom, <em>loading</em> subroutines and <em>executing</em> non-subroutine code immediately.
Once the entire HTA is loaded, it executes the <code>window_onload</code> subroutine.
MSHTA.EXE cannot execute subroutines it hasn't read and loaded yet; likewise, it cannot set a property of a control, as these have not been created yet.



Summarizing:For easier maintenance, <em>declare</em> your global variables at the top of the VBScript code block, and <em>set</em> them in the <code>window_onload</code> subroutine (or in other subroutines).







<h2 id="DemoProject">&emsp;Demo Project: My First HTML Application</h2>
<img data-src="data:image/jpg;base64,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
AoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgBr9PxX+YoA8jv8A/kTpv+wFL/6b2rvfwf13OJfF/XYZYD/ikIf+
wHF/6b1oXwf13B/H/XY7HwF/yBof+ut1/wClc9cB2nYUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAU
AFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUANfp+K/zFAHkmof8AInTf9gKX/wBN7V3P4P67
nEvi/rsNsB/xR8P/AGAov/TetNfB/XcH8X9djr/AX/IGh/663X/pXPXAdp2FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAU
AFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFADX6fiv8AMUAeSah/yJ03
/YCk/wDTe1dz+D+u5xL4v67CaeP+KOh/7AUX/pvWhfB/Xcb+L+ux13gL/kDQ/wDXW6/9K564TsOwoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAK
ACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAa/T
8V/mKAPJdQ/5E2b/ALAUn/pvau5/D/Xc418X9dg08f8AFGw/9gKP/wBN60l8P9dwfxf12Os8Bf8AIGh/663X/pXPXEdh2FABQAUAFABQAUAFABQAUAFABQAUAFABQAUA
FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFA
BQAUAFABQAUAFADX6fiv8xQB5NqH/Imzf9gKT/03tXa/h+f6nIvi/rsGnj/ijYf+wFH/AOm9aF8P9dwfxf12Or8Bf8gaH/rrdf8ApXPXEdZ2FABQAUAFABQB5+1lPrOt
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
vGlmt5o0X7DejLPGyqMm3AGSQMkgDuQKAPQqYgoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACg
AoAKACgAoAa/T8V/mKAPLNQH/FFTf9gKT/03tXS9vn+pzrf5foLp4/4oqH/sBR/+m9aS/X9Rv9P0Ok8Bf8gaH/rrdf8ApXPXObnYUAFABQAUAFABQAUAFABQAUAFABQA
UAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUA
FABQAUAFABQAUAFABQAUANfp+K/zFAHl2oD/AIomb/sBSf8Apvauh/r+pgv0/QXTx/xRMP8A2Ao//TetJfr+o3+n6HReAv8AkDQ/9dbr/wBK56wNjsKACgAoAKACgAoA
KACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKA
CgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAGv0/Ff5igDzDUB/xRE3/YCk/9N7Vu/wBf1MV+n6FDT7xh4PhhwMf2FEM/9w9TXSqa5Ofr/wAE53NqfJ0/4B2HgL/kDQ/9
dbr/ANK56887jsKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKA
CgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAGv0/Ff5igDyO/u2/4Q+aHAx/YUoz/ANw9jXe6aUOf+tziU3z8nT/gFCw/5FWH/sBx
f+m5a3j/AAf6/mMH/F/r+U73wF/yBof+ut1/6Vz15J6h2FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAU
AFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFADX6fiv8xQB4vf/APIqTf8AYDl/9NzV6r/h
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
CgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAa/T8V/mKAPFb//AJFW
b/sBy/8ApuavWf8AC/r+Y8tfxf6/lFsP+RUh/wCwHF/6bloj/C/r+Yb/AIv9fynd+Av+QND/ANdbr/0rnryT0zsKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAo
AKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAK
ACgAoAKAGv0/Ff5igDxW/wD+RVm/7Acv/puavWf8L+v5jy1/F/r+ULD/AJFWH/sBxf8ApuWiP8L+v5hv+L/X8p3ngL/kDQ/9dbr/ANK568k9M7CgAoAKACgAoAKACgAo
AKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAK
ACgAoAKACgAoAKACgAoAKACgAoAKACgBr9PxX+YoA8Vv/wDkVZv+wHL/AOm5q9aX8L+v5jy1/F/r+ULD/kVYf+wHF/6bloj/AAv6/mG/4v8AX8p3ngL/AJA0P/XW6/8A
SuevJPTOwoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgA
oAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAa/T8V/mKAPFb//AJFWb/sBy/8ApuavWf8AB/r+Y8xfxf6/lCw/5FWH/sBxf+m5aI/wv6/m
B/xf6/lO88Bf8gaH/rrdf+lc9eSemdhQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFA
BQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQA1+n4r/MUAeK3/wDyKs3/AGA5f/Tc1es/4P8AX8x5i/i/1/KF
h/yKsP8A2A4v/TctEf4X9fzA/wCL/X8p3ngL/kDQ/wDXW6/9K568k9M7CgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACg
AoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgBr9PxX+YoA8Uvv+RVm/7Acv
/puavWf8H+v5jy1/F/r+USw/5FWH/sBxf+m5aI/wv6/mG/4v9fynfeAv+QND/wBdbr/0rnryT0zsKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAC
gAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAGv0
/Ff5igDxK+/5Faf/ALAcv/puavWl/B/r+Y8tfxf6/lEsD/xS0P8A2A4v/TctEf4X9fzDf8X+v5T0DwF/yBof+ut1/wClc9eSemdhQAUAFABQAUAFABQAUAFABQAUAFAB
QAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQA
UAFABQAUAFABQAUAFABQA1+n4r/MUAeIX3/Irzf9gOX/ANNzV60v4P8AX8x5cf4v9fyiWB/4peH/ALAcX/ptWiP8H+v5gf8AF/r+U9C8Bf8AIGh/663X/pXPXknqHYUA
FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFA
BQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUANfp+K/wAxQB4ffceGJ/8AsCS/+m5q9aX8H+v5jy1/F/r+UbYf8ixD/wBgSL/02rRH+D/X8wP+L/X8p6J4
C/5A0P8A11uv/SuevJPUOwoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAo
AKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAa/T8V/mKAPDr7/kWJv+wJL/6bWr1pfwf6/mPLj/F/r+UbYf8AIsw/9gSL
/wBNq0R/g/1/MD/i/wBfynovgL/kDQ/9dbr/ANK568k9Q7CgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoA
KACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgBr9PxX+YoA8Ovv+RYm/7Akv8A6bWr1pfw
f6/mPLj/ABf6/lG2P/Isw/8AYEi/9Nq0R/g/1/MD/i/1/Kei+Av+QND/ANdbr/0rnryT1DsKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAK
ACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAGv0/Ff5i
gDw6+/5Fib/sCS/+m1q9aX8H+v5jy4/xf6/lEsf+RYh/7AkX/ptWiP8AB/r+YH/F/r+U9E8Bf8gaH/rrdf8ApXPXknqHYUAFABQAUAFABQAUAFABQAUAFABQAUAFABQA
UAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUA
FABQAUAFABQAUANfp+K/zFAHh19/yLE3/YEl/wDTa1evL+D/AF/MeXH+L/X8olj/AMixD/2BIv8A02rSj/B/r+YH/F/r+U9E8Bf8gaH/AK63X/pXPXknqHYUAFABQAUA
FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFA
BQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUANfp+K/zFAHh99/yLE3/YEl/9NrV68v4P9fzHlr+L/X8olj/yLEP/AGBIv/TatKP8H+v5gf8AF/r+U9D8Bf8AIGh/
663X/pXPXknqHYUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUA
FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUANfp+K/wAxQB4fff8AIsTf9gSX/wBNzV68v4P9fzHlr+L/AF/KJY/8ixD/ANgSL/02
rSj/AAf6/mB/xf6/lPQ/AX/IGh/663X/AKVz15J6h2FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFA
BQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFADX6fiv8xQB4fff8ixN/2A5f8A03NXry/g/wBf
zHlr+L/X8o2w48MQ/wDYEi/9Nq0o/wAH+v5gf8X+v5T0TwF/yBof+ut1/wClc9eSeodhQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUA
FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQA1+n4r/MUAeH
33/IsTf9gOX/ANNzV68v4P8AX8x5a/i/1/KJY/8AIsQ/9gSL/wBNq0o/wf6/mB/xf6/lPQ/AX/IGh/663X/pXPXknqHYUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAU
AFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAF
ABQAUAFABQAUANfp+K/zFAHh99/yLE3/AGA5f/Tc1evL+D/X8x5a/i/1/KJY/wDIsQ/9gSL/ANNq0o/wf6/mB/xf6/lPQ/AX/IGh/wCut1/6Vz15J6h2FABQAUAFABQA
UAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUA
FABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFADX6fiv8xQB4fff8ixN/2A5f/Tc1evL+D/X8x5a/i/1/KJY/8ixD/wBgSL/02rSj/B/r+Yb/AIv9fynofgL/AJA0P/XW
6/8ASuevJPTOwoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAK
ACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAa/T8V/mKAPD77/AJFib/sBy/8ApuavXl/B/r+Y8tfxf6/lEsf+RYh/7AkX/ptWlH+D
/X8wP+L/AF/Keh+Av+QND/11uv8A0rnryT1DsKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoA
KACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAGv0/Ff5igDw++/5Fib/sBy/wDpuavXl/B/r+Y8tfxf
6/lCw/5FiH/sBxf+m5aUf4P9fzA/4v8AX8p6F4C/5A0P/XW6/wDSuevJPUOwoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAC
gAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAa/T8V/mKAPD77/kWJv+
wHL/AOm5q9eX8H+v5jy1/F/r+ULH/kV4f+wJF/6blpR/g/1/MN/xf6/lPQvAX/IGh/663X/pXPXknpnYUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQ
AUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAU
ANfp+K/zFAHh99/yLE3/AGA5f/Tc1evL+D/X8x5a/i/1/KFj/wAivD/2BIv/AE3LSj/C/r+Yb/i/1/KeheAv+QND/wBdbr/0rnryT0zsKACgAoAKACgAoAKACgAoAKAC
gAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgA
oAKACgAoAKACgAoAKACgAoAKAGv0/Ff5igDw++/5Fib/ALAcv/puavXl/B/r+Y8tfxf6/lFsP+RXh/7AcX/puWlH+D/X8w3/ABf6/lPQfAX/ACBof+ut1/6Vz15J6Z2F
ABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFAB
QAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFADX6fiv8AMUAeH33/ACLE3/YDl/8ATc1evL+D/X8x5a/i/wBfyi2HHheH/sBxf+m5aUf4X9fzDf8AF/r+
U9B8Bf8AIGh/663X/pXPXknpnYUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFA
BQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUAFABQAUANfp+K/wAxQB4fff8AIsTf9gOX/wBNzV68v4P9fzHlr+L/AF/KOsOP
C8P/AGA4v/TctKP8L+v5hv8Ai/1/Kej+DrWbTtKiguUaOQPOxUg5AkuJZEzjOCUdSQeVzhgGBA8k9M6fePf/AL5P+FABvHv/AN8n/CgA3j3/AO+T/hQAbx7/APfJ/wAK
ADePf/vk/wCFABvHv/3yf8KADePf/vk/4UAG8e//AHyf8KADePf/AL5P+FABvHv/AN8n/CgA3j3/AO+T/hQAbx7/APfJ/wAKADePf/vk/wCFABvHv/3yf8KADePf/vk/
4UAG8e//AHyf8KADePf/AL5P+FABvHv/AN8n/CgA3j3/AO+T/hQAbx7/APfJ/wAKADePf/vk/wCFABvHv/3yf8KADePf/vk/4UAG8e//AHyf8KADePf/AL5P+FABvHv/
AN8n/CgA3j3/AO+T/hQAbx7/APfJ/wAKADePf/vk/wCFABvHv/3yf8KADePf/vk/4UAG8e//AHyf8KADePf/AL5P+FABvHv/AN8n/CgA3j3/AO+T/hQAbx7/APfJ/wAK
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
cubnn/X3H//Z" />



For this demo, we will create an HTA that accepts a number as input, and then checks if it is a prime number.

Yes, if you are new to HTAs, the following code <em>might</em> look rather overwhelming.
Don't worry, I will explain most of it.
And you don't have to retype the code, it can be downloaded <a href="wshexamples.php?fc=M#MyFirstHTA">here</a>.



<span>&lt;!DOCTYPE HTML>&lt;<a href="http://december.com/html/4/element/html.html"><span>html</span></a>>&lt;<a href="http://december.com/html/4/element/head.html"><span>head</span></a>>&lt;<a href="http://december.com/html/4/element/title.html"><span>title</span></a>></span>My First HTML Application<span>&lt;<span>/</span><a href="http://december.com/html/4/element/title.html"><span>title</span></a>></span> <span>&lt;HTA:APPLICATION  APPLICATIONNAME<span>="My First HTML Application"</span>  <span>ID="MyFirstHTA"</span>  <span>VERSION="1.0"</span>  SCROLL<span>="no"/</span>></span> <span>&lt;<a href="http://december.com/html/4/element/style.html"><span>style</span></a> <span>type="text/css"</span>></span>body <span>&#123;background-color:</span> <span>#fdfeff;color:</span> <span>darkblue;font-family:</span> Calibri<span>;font-size:</span> <span>12pt;margin:</span> <span>4em</span> <span>3em;&#125;&lt;<span>/</span><a href="http://december.com/html/4/element/style.html"><span>style</span></a>>&lt;<span>/</span><a href="http://december.com/html/4/element/head.html"><span>head</span></a>></span> <span>&lt;<a href="http://december.com/html/4/element/script.html"><span>script</span></a> <span>language="VBScript"</span>>Option</span> <span>Explicit</span> <span>Sub</span> CheckIfPrime( )<span>Dim</span> i, intInputintInput = document.getElementById( <span>"InputNumber"</span> ).value<span>If</span> intInput &lt; 3 <span>Then</span>document.getElementById( <span>"OutputResult"</span> ).innerHTML = <span>"Yes, "</span> & intInput & <span>" is a prime number."ElseFor</span> i = 2 <span>To</span> intInput - 1<span>If</span> intInput <span>Mod</span> i = 0 <span>Then</span>document.getElementById( <span>"OutputResult"</span> ).innerHTML = <span>"No, "</span> & intInput & <span>" is not a prime number."Exit</span> <span>SubEnd</span> <span>IfNext</span>document.getElementById( <span>"OutputResult"</span> ).innerHTML = <span>"Yes, "</span> & intInput & <span>" is a prime number."End</span> <span>IfEnd</span> <span>Sub</span> <span>Sub</span> ValidateInput( )<span>Dim</span> objRE, strInputstrInput = document.getElementById( <span>"InputNumber"</span> ).value<span>Set</span> objRE = <span>New</span> RegExpobjRE.Global  = <span>True</span>objRE.Pattern = <span>"[^\d]+"If</span> objRE.Test( strInput ) <span>Then</span>strInput = objRE.Replace( strInput, <span>"</span> )document.getElementById( <span>"InputNumber"</span> ).value      = strInputdocument.getElementById( <span>"OutputResult"</span> ).innerHTML = <span>"Enter a number, and click the "Check" button to check if it is a prime number."End</span> <span>IfIf</span> strInput = <span>"</span> <span>Then</span>document.getElementById( <span>"OutputResult"</span> ).innerHTML = <span>"Enter a number, and click the "Check" button to check if it is a prime number."End</span> <span>IfSet</span> objRE = <span>NothingEnd</span> <span>Sub</span> <span>Sub</span> Window_OnLoadwindow.resizeTo 640, 480document.title = document.title & <span>",  Version "</span> & MyFirstHTA.Version<span>End</span> <span>Sub&lt;<span>/</span><a href="http://december.com/html/4/element/script.html"><span>script</span></a>></span> <span>&lt;<a href="http://december.com/html/4/element/body.html"><span>body</span></a>></span> <span>&lt;<a href="http://december.com/html/4/element/p.html"><span>p</span></a>>&lt;<a href="http://december.com/html/4/element/input.html"><span>input</span></a> <span>type="text"</span> <span>id="InputNumber"</span> <span>onchange="ValidateInput"</span> <span>onkeyup="ValidateInput"</span> <span>/</span>>&nbsp;&lt;<a href="http://december.com/html/4/element/input.html"><span>input</span></a> <span>type="button"</span> <span>value="Check"</span> <span>onclick="CheckIfPrime"</span> <span>/</span>>&lt;<span>/</span><a href="http://december.com/html/4/element/p.html"><span>p</span></a>></span> <span>&lt;<a href="http://december.com/html/4/element/p.html"><span>p</span></a>>&nbsp;&lt;<span>/</span><a href="http://december.com/html/4/element/p.html"><span>p</span></a>></span> <span>&lt;<a href="http://december.com/html/4/element/p.html"><span>p</span></a> <span>id="OutputResult"</span>></span>Enter a number, and click the "Check" button to find out if it is a prime number.<span>&lt;<span>/</span><a href="http://december.com/html/4/element/p.html"><span>p</span></a>></span> <span>&lt;<span>/</span><a href="http://december.com/html/4/element/body.html"><span>body</span></a>>&lt;<span>/</span><a href="http://december.com/html/4/element/html.html"><span>html</span></a>></span>


<h3>&emsp;Explanation:</h3>
As mentioned earlier, the HTA starts with an HTML like head.
Specifying a DocType (line 1) is optional, but it may help getting more predictable results when running the HTA in different Windows versions.
Unlike "true" web pages, you don't have to include a <code>&lt;title></code> tag here, you can set it later, on-the-fly, which is demonstrated in the <code>Window_OnLoad</code> subroutine, on line 61.

In the head we also find the mandatory <code>&lt;HTA:APPLICATION></code> tag (lines 6..10);
Copy and paste it from this page or from any other HTA and use Microsoft's <a href="https://msdn.microsoft.com/en-us/library/ms536473.aspx">HTML Applications Reference</a> to add or modify its properties.
<!-- it is automatically generated by <a href="http://www.htaedit.com/">HTAEdit</a> when opening a new project, and can then be edited manually or interactively.-->

Just for the sake of demonstration, I also included an optional stylesheet (lines 12..20).

The body (lines 65..75) contains 3 main elements:

A textbox (line 67, ID <code>InputNumber</code>) to enter the number in; note that HTML 5's <code>type="number"</code> is ignored in HTAs, that is why we call the <code>ValidateInput</code> subroutine using the <code>onchange</code> and <code>onkeyup</code> event handlers.
A button (line 69) that will call the <code>CheckIfPrime</code> subroutine when clicked.
A text paragraph (line 73, ID <code>OutputResult</code>) that can be modified on-the-fly.


Between the head and the body we have a (VBScript) code block (lines 23..63).
<code>Option Explicit</code> (line 24) is optional, but you really should include this, if only for debugging purposes.

Subroutine <code>CheckIfPrime( )</code> (lines 26..40) is the main program, checking the number and returning the result.
It reads the entered number using the code in line 28:

intInput = document.getElementById( "InputNumber" ).value

There is no need to check if the input actually <em>is</em> a positive integer, since validation is already handled by the <code>ValidateInput( )</code> helper subroutine.
After checking if the number is a prime number, the result has to be presented (lines 30, 34 & 38):

document.getElementById( "OutputResult" ).innerHTML = "Yes, " & intInput & " is a prime number."

This will replace the text in the ouput text paragraph (line 73, ID <code>OutputResult</code>).

Subroutine <code>ValidateInput( )</code> (lines 42..57) is a helper subroutine, filtering out everything from the input but numbers.
It is triggered when the content of the textbox (line 67, ID <code>InputNumber</code>) is changed (<code>onchange</code> event handler, i.e. on change of typed input, but also when new input is pasted from the clipboard) or when a key is pressed (<code>onkeyup</code> event handler).
The code in line 44 reads the input just like the <code>CheckIfPrime( )</code> does.
The subroutine then uses a <a href="vbstech_regexp.php">regular expression</a> to remove everything but numbers (line 49).
The code in line 50 writes the corrected input back into the textbox.
The code in lines 51 and 54 changes the output text from result to description.

Subroutine <code>Sub Window_OnLoad</code> (lines 59..62) is executed when the HTA is loaded.
In our demo it resizes the HTA's window (line 60) and sets the HTA's title (line 61).

Investigate the demo script, play with it, e.g. change the presentation of the results, or try making it accept hexadecimal numbers, or trigger <code>CheckIfPrime( )</code> when pressing the Enter <span>key . . .</span>
Whatever you like.




<h2 id="ScriptPath">&emsp;HTA's Path</h2>
Getting the full path to the HTA is easy:

strHTAPath = Self.location.pathname


Note:Keep in mind that, when running an HTA in <a href="http://www.vbsedit.com/">VBSEdit</a>, it runs a <em>copy</em> of the HTA in a <em>different location!</em>






<h2 id="CommandLine">&emsp;Command Line Arguments</h2>
Handling command line arguments in HTAs is not as sophisticated as it is in "pure" VBScript, but it is "doable".

You can read the command line as a property of the HTA, so you need to use the HTA's ID:

strCommandLine = <em>MY_HTA_ID</em>.CommandLine

where <code><em>MY_HTA_ID</em></code> is the HTA's ID as defined in the HTA's head.

The string returned as command line starts with the HTA's full path, followed by the command line arguments, if any.
The HTA's path <em>may</em> be in doublequotes.

To get the command line arguments only you could use the following code:


If Left( <em>MY_HTA_ID</em>.CommandLine, 1 ) = """" Then
strCommandLineArguments = Trim( Mid( <em>MY_HTA_ID</em>.CommandLine, Len( Self.location.pathname ) + 3 ) )
Else
strCommandLineArguments = Trim( Mid( <em>MY_HTA_ID</em>.CommandLine, Len( Self.location.pathname ) + 1 ) )
End If






<h2 id="Close">&emsp;Close the HTA</h2>
Closing the HTA is simple, use either:

Self.close

or:

window.close True

I could not find documentation on the optional <code>True</code> argument of <code>window.close</code>.
I have once been told it <em>forces</em> the window to close, and my extemely limited testing showed that:


it <em>sometimes</em> seems to do just that
most of the times it makes no difference
so far it never hurt


But, since <a href="http://www.vbsedit.com/">VBSEdit</a> only "recognizes" <code>Self.close</code> I would recommend using that.

In case you <a href="#Quirks">run the HTA in compatibility mode</a> you may sometimes <em>have</em> to use <code>window.close( )</code> (e.g. when using it in an event handler, <code>&lt;input type="button" value="Quit" onclick="window.close( )" /></code> otherwise you might get a "Self is not defined" error message)





<h2 id="Resize">&emsp;Resize the HTA</h2>
To resize the HTA window, use the following code (e.g. in the <code>Window_OnLoad</code> subroutine):

window.resizeTo <em>width</em>, <em>height</em>

e.g.:

window.resizeTo 640, 480

Instead of placing the VBScript code in <code>Window_OnLoad</code>, you may also place it in the HTA's <em>head</em> as <em>JavaScript</em>:

&lt;script type="text/javascript">window.resizeTo(640, 480);&lt;/script>

Important:Do <strong><em>not</em></strong> set the <code>WINDOWSTATE</code> in your HTA definition block when using code to resize the HTA's window.






<h2 id="WindowDimensions">&emsp;Get the HTA Window's Dimensions</h2>
The current <em>width</em> of the HTA can be obtained using the following VBScript code:

intWidth = document.body.offsetWidth

Likewise, the current <em>height</em> of the HTA can be obtained using:

intHeight = document.body.offsetHeight

Add a CSS style to allow measuring the window dimensions even if all content fits in the window:

body, html { width: 100%; height: 100%; }





<h2 id="Center">&emsp;Center the HTA on Screen</h2>
To center the HTA on screen, use the following VBScript code:


posX = CInt( ( window.screen.width  - document.body.offsetWidth  ) / 2 )
posY = CInt( ( window.screen.height - document.body.offsetHeight ) / 2 )
If posX &lt; 0 Then posX = 0
If posY &lt; 0 Then posY = 0
window.moveTo posX, posY


Add a CSS style to allow measuring the window dimensions even if all content fits in the window:

body, html { width: 100%; height: 100%; }





<h2 id="MinimizeMaximize">&emsp;Minimize or Maximize the HTA</h2>
To make the HTA <em>minimize</em> its own window, place the following code between the HTA's head and its VBScript section:


<span>&lt;!-- This "HHCtrlMinimizeWindowObject" works together with the JavaScript function "_jsMinWin()" and -->
&lt;!-- the hidden input "MinimizeWindow" to minimize the HTA window (use "MinimizeWindow.click" in VBScript) --></span>
&lt;object id="HHCtrlMinimizeWindowObject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
&lt;param name="command" value="minimize" />
&lt;/object>

&lt;script type="text/javascript">
function _jsMinWin( ) {
try {
HHCtrlMinimizeWindowObject.Click( );
}
catch ( err ) {
alert( err.message );
}
}
&lt;/script>


Place the following code in the HTA's body:


<span>&lt;!-- This hidden input works together with the JavaScript function "_jsMinWin()" and the object -->
&lt;!-- "HHCtrlMinimizeWindowObject" to minimize the HTA window (e.g. use "MinimizeWindow.click" in VBScript) --></span>
&lt;input type="hidden" name="MinimizeWindow" id="MinimizeWindow" onclick="javascript:_jsMinWin();" />


You can now have the HTA <em>minimize</em> itself using the VBScript code <code>MinimizeWindow.click</code> or <code>document.getElementById( "MinimizeWindow" ).click</code>



The code required to <em>maximize</em> the HTA again is very similar; place the following code between the HTA's head and its VBScript section:


<span>&lt;!-- This "HHCtrlMaximizeWindowObject" works together with the JavaScript function "_jsMaxWin()" and -->
&lt;!-- the hidden input "MaximizeWindow" to maximize the HTA window (use "MaximizeWindow.click" in VBScript) --></span>
&lt;object id="HHCtrlMaximizeWindowObject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
&lt;param name="command" value="maximize" />
&lt;/object>

&lt;script type="text/javascript">
function _jsMaxWin( ) {
try {
HHCtrlMaximizeWindowObject.Click( );
}
catch ( err ) {
alert( err.message );
}
};
&lt;/script>


Place the following code in the HTA's body:


<span>&lt;!-- This hidden input works together with the JavaScript function "_jsMaxWin()" and the object -->
&lt;!-- "HHCtrlMaximizeWindowObject" to maximize the HTA window (e.g. use "MaximizeWindow.click" in VBScript) --></span>
&lt;input type="hidden" name="MaximizeWindow" id="MaximizeWindow" onclick="javascript:_jsMaxWin();" />


You can now have the HTA <em>maximize</em> itself using the VBScript code <code>MaximizeWindow.click</code> or <code>document.getElementById( "MaximizeWindow" ).click</code>


Important:Do <strong><em>not</em></strong> set the <code>WINDOWSTATE</code> in your HTA definition block when using this code.
Minimizing or maximizing the HTA window using this code will fail if the HTA lost focus.
So to keep on the safe side, insert a line <code>window.focus</code> just before the <code>M**imizeWindow.click</code> code.






<h2 id="MultiThreading">&emsp;Improve Loading Speed With MultiThreading</h2>
When an HTA loads, it won't show its interface untill all work has been done, i.e. untill the code in the <code>Window_OnLoad</code> subroutine, and all other code called from there, has been executed.
From the outside, it may look like the HTA loads an empty window "frame" and then waits for several seconds before showing its inteface elements.
You can speed up the loading of the interface by <em>only</em> executing the code to build the interface in the <code>Window_OnLoad</code> subroutine, and then start a new thread to initialize the "background" code.

Starting a new thread is not that complicated:

window.setTimeout "<em>subroutine</em>", 1000, "VBScript"

This will start <code><em>subroutine</em></code> after a 1 second (1000 milliseconds) delay, allowing the HTA enough time to render its interface before continuing.

The first argument for <code>window.setTimeout</code>, the command or subroutine to be started, <em>may</em> have some arguments of its own, replacing the doublequotes on <code><em>subroutines</em></code>'s command line by singlequotes, e.g.:

window.setTimeout "MsgBox <span>'</span>This MsgBox was started in a separate thread<span>'</span>, vbOKOnly, <span>'</span>Test<span>'</span>", 1000, "VBScript"

As you can see from the example, finding typos may be a bit harder than usual.

The third argument for <code>window.setTimeout</code> will be <code>"VBScript"</code> in most cases.
However, it also opens up a way to start a JavaScript code block, by using <code>"JavaScript"</code>.





<h2 id="EmbedImages">&emsp;Embedding Images</h2>
As one might expect, it is possible to use images in HTAs with the <code>&lt;img src="..." /></code> tag.
Personally I prefer to distribute HTAs as a single file.
The good news: it is possible with <a href="http://www.websiteoptimization.com/speed/tweak/inline-images/">inline-images</a>.
The bad news: your HTA may become <em>huge!</em>

First compress your image as much as is acceptable (e.g. JPEG compression, decrease color depth, etc.).
To convert the image to a string that can be embedded in the HTA you can use base64 encoding.
Assuming you have the <a href="https://sourceforge.net/projects/base64/">b64 utility from SourceFourge.net</a>, use <code><a href="https://sourceforge.net/projects/base64/">b64</a> -e <em>image.gif image.b64</em></code> to encode the image, and embed the image like this (string marked red is the content of <em>image.b64</em>):

&lt;img src="data:image/gif;base64,<em>R0lGODlhIAAgAOYAAABbAIiwiER8RADMANbW1gCZAGaZZsXFxR3oHTrWOgCDAK60rgD0AA6dDmm+aRZmFlDBPubm5gDoACKN
Ir7mvlCeUACjAGb/ZqK0ojz4PAB1ACbUJgC1AESSRA7DDgDeAA+FD9jl2FbSVmmtab29vUS6PhqnGj62Poi2iACZAO7u7hPSE8zMzABmAN3d3VCsUHj4eH6/fqfMp1q+
WiL/In6ufh1xHXGccUzXTBqwAADuAAC9AAD/AADVAN7w3gtlC0mHSR3FHYjDiAqnAAWSBQB6AB6nHl62XpWmlQCLADfpN3WwdSJsIkSNRB/4H6fEp1DqUEH/QQicCDPM
M0mpSQDDAEmUSSKTIpWxlS1xLQBmAACwAMPqvlCkUFGyUZWwlQuiC3G/ahKlEg+MDz7JPhWvFafWp3u4ewtpCx+rH3a1dv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAUUAGsALAAAAAAgACAAAAf/gGuCg4SFhoeIiYqLjI2Oj5CRhFwQORSSiBQlQ0NhFjOYhBQnFqVn
B0YFXiqYPjMFYAUFSwcuDrIvrI+uBWIiaQ01tWtmBWQFuY0+RwUNODAmUljDgkkJCUnJictJRFMXUA1jXwcRhFRlURtJXbqFKmHdQRlRSkRXGCzmhEJENDQrFLQjpCLG
mCQenPxDQGTCAn2GQij4wIPHAAUVWBUEkaQKg4oWFTiEeGgCB5ADilRQA6LIjo8oi3R4uO/QiCQMcjKoUqSIBQk6c/LsQIKAu0MyNHzQwVRHj6VNmVrQ0KToUUQadkjY
yrWrhAIablhtZCXJh7No0xZocYNaIxRKYtOi7VGErdtGIVps6cG3L100SO46spFkgGHDVTT8COwCk4EWhwdwaPEACUlJTwBwqFJlSwsmNEMJAlBgh4XPoUWvAVKkAIAs
qVUHAABAQNGaqkMAADJWNaEIBIz6Hk68eKhAADs=</em>" title="Embedded icon" />

And this is what our example looks like:
<img data-src="data:image/gif;base64,R0lGODlhIAAgAOYAAABbAIiwiER8RADMANbW1gCZAGaZZsXFxR3oHTrWOgCDAK60rgD0AA6dDmm+aRZmFlDBPubm5gDoACKNIr7mvlCeUACjAGb/ZqK0ojz4PAB1ACbU
JgC1AESSRA7DDgDeAA+FD9jl2FbSVmmtab29vUS6PhqnGj62Poi2iACZAO7u7hPSE8zMzABmAN3d3VCsUHj4eH6/fqfMp1q+WiL/In6ufh1xHXGccUzXTBqwAADuAAC9
AAD/AADVAN7w3gtlC0mHSR3FHYjDiAqnAAWSBQB6AB6nHl62XpWmlQCLADfpN3WwdSJsIkSNRB/4H6fEp1DqUEH/QQicCDPMM0mpSQDDAEmUSSKTIpWxlS1xLQBmAACw
AMPqvlCkUFGyUZWwlQuiC3G/ahKlEg+MDz7JPhWvFafWp3u4ewtpCx+rH3a1dv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAACH5BAUUAGsALAAAAAAgACAAAAf/gGuCg4SFhoeIiYqLjI2Oj5CRhFwQORSSiBQlQ0NhFjOYhBQnFqVnB0YFXiqYPjMFYAUFSwcuDrIvrI+uBWIi
aQ01tWtmBWQFuY0+RwUNODAmUljDgkkJCUnJictJRFMXUA1jXwcRhFRlURtJXbqFKmHdQRlRSkRXGCzmhEJENDQrFLQjpCLGmCQenPxDQGTCAn2GQij4wIPHAAUVWBUE
kaQKg4oWFTiEeGgCB5ADilRQA6LIjo8oi3R4uO/QiCQMcjKoUqSIBQk6c/LsQIKAu0MyNHzQwVRHj6VNmVrQ0KToUUQadkjYyrWrhAIablhtZCXJh7No0xZocYNaIxRK
YtOi7VGErdtGIVps6cG3L100SO46spFkgGHDVTT8COwCk4EWhwdwaPEACUlJTwBwqFJlSwsmNEMJAlBgh4XPoUWvAVKkAIAsqVUHAABAQNGaqkMAADJWNaEIBIz6Hk68
eKhAADs=" title="Embedded icon" />

And if you aren't convinced yet, check the properties  of the <a href="#DemoProject">demo project screenshot</a> <span>above . . .</span>

Or check the <a href="sourcecode.php?src=atticnumerals_hta">source code</a> of my <a href="attics.php">Attic Numerals Converter</a>.





<h2 id="EmbedIcon">&emsp;Embed an Icon</h2>
Assume you have an icon <code>d:\iconsfolder\myicon.ico</code> that you want to use for your HTA <code>d:\scriptsfolder\myhta.hta</code>.
If you don't mind having the icon in a separate file, add the following code to the HTA's <code>HTA:APPLICATION</code> block:

ICON="D:\iconsfolder\myicon.ico"

and you're done.
Instead of an absolute path, you can use a relative path, and the easiest relative path is the HTA's parent folder.
Move the icon to the HTA's parent folder and add this code to the HTA's <code>HTA:APPLICATION</code> block:

ICON="myicon.ico"

If you prefer to distribute your HTA as a single self-contained file, it is possible to embed an icon (or, unfortunately, any type of binary payload, including malware), by prepending it to the HTA.
I found this trick by <a href="http://blog.sevagas.com/?Hacking-around-HTA-files">Emeric Nasi</a> to embed an icon in the HTA at <a href="https://blog.sevagas.com/">Sevagas.com</a>.
Add the following code to the HTA's <code>HTA:APPLICATION</code> block:

ICON="#"

Then embed the icon using the following command on a CMD prompt:

COPY /B d:\iconsfolder\myicon.ico + d:\scriptsfolder\myhta.hta d:\scriptsfolder\_myhta.hta

The new HTA <code>d:\scriptsfolder\_myhta.hta</code> will have the icon embedded.

If you want to edit the HTA later, use the original one or remove all binary code before the <code>&lt;html></code> opening tag, as most text editors will corrupt the embedded icon.
When you are finished editing the HTA, use the same command once more to embed an icon. 


Warning:Because of the ability to embed malware, you may seriously want to consider <em>not</em> using this technique!
Most AntiVirus software will be triggered by the prepended binary payload.






<h2 id="PID">&emsp;Get the HTA's Process ID</h2>
Insert the following function in you HTA's VBScript block, and call <code>MyPID( )</code> when you need the HTA's process ID:

Function MyPID( )
Dim colItems, intCount, intPID, objItem, objWMIService, strQuery
intCount =  0 ' Keeps track of the number of simultaneous instances of this HTA
intPID   = -1
' WMI query must be escaped, hence the replacement of single backslashes by double backslashes
strQuery = "Select * From Win32_Process Where CommandLine Like '%" & Replace( self.location.pathname, "\", "\\" ) & "%'"
Set objWMIService = GetObject( "winmgmts://./root/cimv2" )
Set colItems      = objWMIService.ExecQuery( strQuery )
For Each objItem in colItems
intCount = intCount + 1
intPID   = objItem.ProcessId
Next
Set colItems      = Nothing
Set objWMIService = Nothing
' Set result to -1 in case of zero or multiple simultaneous instances of this HTA
If intCount &lt;> 1 Then intPID = -1
MyPID = intPID
End Function

Note that this function will return -1 if multiple instances of the same HTA are running simultaneously.





<h2 id="Quirks">&emsp;HTA Quirks and Restrictions</h2>
By default, HTAs display webpages in Compatibility View, which displays standards-mode content in IE7 Standards mode and quirks mode content in IE5 (Quirks) mode. 
Rounded corners, rotated text, HTML 5's new input types, and other HTML 5 and CSS 3 features are ignored in this default mode.

The solution is to insert the following meta tag in the head of the HTA:

&lt;meta http-equiv="x-ua-compatible" content="ie=9" />

This will enable HTML 5 and CSS 3 support in your HTA (though <code>&lt;input type="number" /></code> still seems to be ignored).

You may change <code>content="ie=9"</code> to <code>content="ie=10"</code> if you want, higher is not recommended because it introduces new serious challenges and quirks.
Some errors that may occur, and that are easy to prevent:


<code>window_onload</code> is not exetuted: with <code>content="ie=11"</code> or <code>content="ie=edge"</code>, VBScript code no longer seems to be recognized; either revert to <code>content="ie=9"</code> or convert all code to JavaScript
<code>Object doesn't support this property or method</code> for <code><em>HTAID</em>.version</code>: revert to <code>content="ie=9"</code>
<code>'Window_OnLoad' is not defined</code>: rename your subroutines <code>Window_OnLoad</code> and <code>Window_OnUnload</code> to <code>window_onload</code> and <code>window_onunload</code> respectively (lower case)
<code>'Self' is not defined</code>: when called directly in event handlers (e.g. <code>onclick</code>) make sure to use <code>self</code> in lower case (e.g. <code>onclick="self.close( )"</code>)
Other <code>not defined</code> errors in subroutines called by event handlers: make sure the case of the subroutine's name matches, and that the language is defined, and add parentheses (e.g. <code>onclick="vbscript:MySubroutine( )"</code>)



Warning:Some versions of <a href="http://www.vbsedit.com/">VBSEdit</a> may sometimes revert your case changes while editing (e.g. <code>Self</code>), so stay alert!


Make sure you also use the proper document type declaration at the top of the HTA:

&lt;!DOCTYPE HTML>

<strong>Note, however, that in Windows 7 (and possibly in Windows 8 too) you now need to adjust <em>all</em> event handlers!</strong>

E.g. the "old" code:

&lt;input type="button" value="Check" <strong>onclick="CheckIfPrime"</strong> />

must be changed into the "new" code:

&lt;input type="button" value="Check" <strong>onclick="<span>vbscript:</span>CheckIfPrime<span>( )</span>"</strong> />

In Windows 10 this is not required (though it won't hurt), unless you use both VBScript and JavaScript.





<h2 id="VBSEditLimitations">&emsp;VBSEdit Limitations</h2>
Testing your HTAs <em>in</em> VBSEdit is great, much faster than having to switch from the editor to a command line or Windows Explorer and vice versa.
Keep in mind, though, that when you click the "Run" button (or hit F5), VBSEdit will open and run a <strong><em>copy</em></strong> of the HTA in a <strong><em>different location</em>!</strong>

Though the order of your HTA's subroutines is not critical to <em>run</em> it, VBSEdit's debugger treats them rather "linearly", e.g. if a global variable/object is <em>set</em> in line 100 in the <code>Window_OnLoad</code> subroutine, and referred to in another subroutine in line 50, VBSEdit's debugger will consider the variable/object not set.
So, for <em>debugging</em> purposes, you may want to change the order of the subroutines, as explained in the <a href="#Debugging">next</a> paragraph.

Compatibility mode is great if you want to use rounded corners, rotated text and many other CSS 3 features, but it may make debugging a challenge in VBSEdit.
Compare the error messages when clicking the "Test" button in the following demo HTA, for quirks mode and for compatibility mode.



<strong>Quirks Mode</strong> (disabled meta tag in line 4)

<span>&lt;!DOCTYPE HTML>&lt;<a href="http://december.com/html/4/element/html.html"><span>html</span></a> <span>lang="en"</span>>&lt;<a href="http://december.com/html/4/element/head.html"><span>head</span></a>>&lt;!--&lt;meta http-equiv="x-ua-compatible" content="ie=9" />-->&lt;<a href="http://december.com/html/4/element/title.html"><span>title</span></a>></span>My HTML application<span>&lt;<span>/</span><a href="http://december.com/html/4/element/title.html"><span>title</span></a>>&lt;HTA:APPLICATION  APPLICATIONNAME<span>="My HTML application"</span>  <span>ID="MyHTMLapplication"</span>  <span>VERSION="1.0"</span><span>/</span>>&lt;<span>/</span><a href="http://december.com/html/4/element/head.html"><span>head</span></a>>&lt;<a href="http://december.com/html/4/element/script.html"><span>script</span></a> <span>language="VBScript"</span>>Sub</span> TestDebugging( )document.getElementById( <span>"DoesNotExist"</span> ).value = <span>"Error"End</span> <span>Sub&lt;<span>/</span><a href="http://december.com/html/4/element/script.html"><span>script</span></a>></span> <span>&lt;<a href="http://december.com/html/4/element/body.html"><span>body</span></a>>&lt;<a href="http://december.com/html/4/element/input.html"><span>input</span></a> <span>type="button"</span> <span>value="Test"</span> <span>onclick="vbscript:TestDebugging( )"</span> <span>/</span>>&lt;<span>/</span><a href="http://december.com/html/4/element/body.html"><span>body</span></a>>&lt;<span>/</span><a href="http://december.com/html/4/element/html.html"><span>html</span></a>></span>


The following error message appears when the "Test" button is clicked:

<img data-src="https://www.robvanderwoude.com/pictures/htaedit_debug_error_message_quirksmode.jpg" />

The error message points out the exact line where the error occurred.



<strong>Compatibility Mode</strong> (enabled meta tag in line 4)

<span>&lt;!DOCTYPE HTML>&lt;<a href="http://december.com/html/4/element/html.html"><span>html</span></a> <span>lang="en"</span>>&lt;<a href="http://december.com/html/4/element/head.html"><span>head</span></a>>&lt;meta http-equiv="x-ua-compatible" content="ie=9" />&lt;<a href="http://december.com/html/4/element/title.html"><span>title</span></a>></span>My HTML application<span>&lt;<span>/</span><a href="http://december.com/html/4/element/title.html"><span>title</span></a>>&lt;HTA:APPLICATION  APPLICATIONNAME<span>="My HTML application"</span>  <span>ID="MyHTMLapplication"</span>  <span>VERSION="1.0"</span><span>/</span>>&lt;<span>/</span><a href="http://december.com/html/4/element/head.html"><span>head</span></a>>&lt;<a href="http://december.com/html/4/element/script.html"><span>script</span></a> <span>language="VBScript"</span>>Sub</span> TestDebugging( )document.getElementById( <span>"DoesNotExist"</span> ).value = <span>"Error"End</span> <span>Sub&lt;<span>/</span><a href="http://december.com/html/4/element/script.html"><span>script</span></a>></span> <span>&lt;<a href="http://december.com/html/4/element/body.html"><span>body</span></a>>&lt;<a href="http://december.com/html/4/element/input.html"><span>input</span></a> <span>type="button"</span> <span>value="Test"</span> <span>onclick="vbscript:TestDebugging( )"</span> <span>/</span>>&lt;<span>/</span><a href="http://december.com/html/4/element/body.html"><span>body</span></a>>&lt;<span>/</span><a href="http://december.com/html/4/element/html.html"><span>html</span></a>></span>


The following error message appears when the "Test" button is clicked:

<img data-src="https://www.robvanderwoude.com/pictures/htaedit_debug_error_message_compatibilitymode.jpg" />

Now the error message points to the line <em>calling</em> the subroutine that <em>contains</em> the error!
This gets even worse when nesting subroutines...

The work-around for this limitation is to temporarily disable compatibility mode until all VBScript code has been debugged.
Unfortunately, after enabling compatibility mode, you still have to debug all code once more, to test for compatibility issues...





<h2 id="Debugging">&emsp;Debugging</h2>
Editors like <a href="http://www.vbsedit.com/">VBSEdit</a> make debugging HTAs easier, but not quite as easy as "normal" VBScript code.

Some tips:


All advices for <a href="vbstech_debugging.php">debugging VBScript</a> are valid for debugging HTAs too.
When using global variables in HTAs, <em>declare</em> them at the top of the code block, <em>set</em> them in the <code>window_onload</code> subroutine, and clear objects in the <code>window_onunload</code> subroutine.
Place the <code>window_onload</code> subroutine just below the global declarations, the <code>window_onunload</code> subroutine at the end of the code block, and all other subroutines in between.
Why? Because VBSEdit's built-in debugger doesn't recognize objects in code lines after the one where they are cleared, i.e. <code>Set <em>object</em> = Nothing</code>.
Though multithreading is quite easy in HTAs, <em>debugging</em> a separate thread is impossible in VBSEdit's debugger.
So you'd better postpone using multithreading untill all debugging has been done.
Global variables will not be shown in VBSEdit's debugger window when hitting a breakpoint in a subroutine.
It may be useful to declare a <em>dummy</em> variable in the subroutine you are debugging, and then set its value to that of the global variable just before the breakpoint.






<h2 id="CleanUp">&emsp;Clean Up Your Code</h2>
More, even, then "normal" VBScript code, HTA code can have some stray code left after making changes: undeclared new variables, unused variables, or even entire unused subroutines.
This will increase maintenance complexity of your HTA.

Using an editor like <a href="http://www.vbsedit.com/">VBSEdit</a> you will get warnings when trying to use undeclared variables, including typos in variable names (assuming <code>Option Explicit</code> is your first line of code in the VBScript block, which is <em>highly</em> recommended).

Use my <a href="csharpexamples.php#CheckVarsVBS">CheckVarsVBS.exe</a> to check for unused variables and subroutines.





<h2 id="Links">&emsp;HTA Related Links</h2>
<a href="https://technet.microsoft.com/en-us/library/ee692768.aspx">Extreme Makeover: Wrap Your Scripts Up in a GUI Interface</a>
<a href="https://msdn.microsoft.com/en-us/library/ms536496.aspx">Introduction to HTML Applications (HTAs)</a>
<a href="https://msdn.microsoft.com/en-us/library/ms536473.aspx">HTML Applications Reference</a>
<a href="https://technet.microsoft.com/en-us/library/6ab32c28-8ecd-4722-a68b-ea4ea5c72089">Add a Gradient Background to Your HTAs</a>
<a href="http://blog.sevagas.com/?Hacking-around-HTA-files">Hacking around HTA files</a> by Emeric Nasi
My own <a href="htaexamples.php">HTA & WSC Examples</a>
Try Adersoft's <a href="http://www.vbsedit.com/">VBSEdit</a>, an VBScript and HTA editor with built-in debugger, IntelliSense<sup>&trade;</sup> like "intelligence", COM object browser, snippets library, configurable external tools and built-in packager (HTA "compiler").



<h2><k>Download Files</k></h2>
<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a>
VBScript Code:

HTTPDownload "http://www.robvanderwoude.com/files/wmigen.zip", "C:\"

Sub HTTPDownload( myURL, myPath )
' This Sub downloads the FILE specified in myURL to the path specified in myPath.
'
' myURL must always end with a file name
' myPath may be a directory or a file name; in either case the directory must exist
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
' Based on a script found on the Thai Visa forum
' http://www.thaivisa.com/forum/index.php?showtopic=21832

' Standard housekeeping
Dim i, objFile, objFSO, objHTTP, strFile, strMsg
Const ForReading = 1, ForWriting = 2, ForAppending = 8

' Create a File System Object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Check if the specified target file or folder exists,
' and build the fully qualified path of the target file
If objFSO.FolderExists( myPath ) Then
    strFile = objFSO.BuildPath( myPath, Mid( myURL, InStrRev( myURL, "/" ) + 1 ) )
ElseIf objFSO.FolderExists( Left( myPath, InStrRev( myPath, "\" ) - 1 ) ) Then
    strFile = myPath
Else
    WScript.Echo "ERROR: Target folder not found."
    Exit Sub
End If

' Create or open the target file
Set objFile = objFSO.OpenTextFile( strFile, ForWriting, True )

' Create an HTTP object
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )

' Download the specified URL
objHTTP.Open "GET", myURL, False
objHTTP.Send

' Write the downloaded byte stream to the target file
For i = 1 To LenB( objHTTP.ResponseBody )
    objFile.Write Chr( AscB( MidB( objHTTP.ResponseBody, i, 1 ) ) )
Next

' Close the target file
objFile.Close( )
End Sub
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
<a href="http://www.xstandard.com/en/documentation/xhttp/">X-HTTP</a>
VBScript Code:

Download "http://www.robvanderwoude.com/files/hardwinv.zip", "C:\hardwinv.zip"


Sub Download( myFileURL, myDestFile )
' This function uses X-standards.com's X-HTTP component to download a file
'
' Arguments:
' myFileURL  [string] the URL of the file to be downloaded
' myDestFile [string] the fully qualified path of the downloaded "target" file
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
' The X-HTTP component is available at:
' http://www.xstandard.com/page.asp?p=C8AACBA3-702F-4BF0-894A-B6679AA949E6
' For more information on available functionality read:
' http://www.xstandard.com/printer-friendly.asp?id=32ADACB9-6093-452A-9464-9269867AB16E
Dim objHTTP
Set objHTTP = CreateObject("XStandard.HTTP")
objHTTP.Get myFileURL
objHTTP.SaveResponseToFile myDestFile
Set objHTTP = Nothing
End Sub
Requirements:
Windows version:any
Network:any
Client software:<a href="http://www.xstandard.com/en/documentation/xhttp/">X-HTTP</a> component
Script Engine:any
Summarized:Works in any Windows version with the <a href="http://www.xstandard.com/en/documentation/xhttp/">X-HTTP</a> component installed.





Note:For large files, WinHTTP may prove far too slow.
Better use <a href="https://gist.github.com/2053179">this MSXML2.XMLHTTP/ADODB based code</a> by <a href="https://github.com/udawtr">Wataru Uda</a> instead.


<h2><k>FTP</k></h2>
<a href="#ChilkatFTP">ChilkatFTP</a>
<!--
<a href="#SapienFTP">Primalscript.FTPTransfer (Sapien FTP component)</a>
-->







<a href="http://www.chilkatsoft.com/refdoc/xChilkatFtpRef.html">ChilkatFTP</a>
VBScript Code:

Option Explicit

' Upload the file "test.txt" from the current (local) directory to
' "ftp.myServer.myTld/www/testdir/test.txt"; create the directory
' "testdir" if it doesn't exist; login as "myid" with password "secret".
WScript.Echo FTPUpload( "test.txt", "/www/testdir", _
         "ftp.myServer.myTld", _
         "myid", "secret", True )


Function FTPUpload( locFile, targetDir, host, user, password, blnMkDir )
' This function uses the free ChilkatFTP ActiveX component
' to upload a single file.
' The remote directory can be specified, but the remote
' file name will be the same as the local file name.
' The function is based on Chilkat's own sample for the ChilkatFTP2 component
' (which is not free): http://www.example-code.com/vbscript/ftpPutFile.asp
'
' Arguments:
' locFile    [string]   the (path and) file name of the file to be uploaded
' targetDir  [string]   the (relative) path of the remote target directory;
'                       if empty, the current remote directory will be used
' host       [string]   the remote host name (e.g. "ftp.mydomain.org")
' user       [string]   the login name for the remote host
' password   [string]   the password for the login account
' blnMkDir   [boolean]  if True, the remote directory will be created if it
'                       doesn't exist, otherwise the function will fail if
'                       the remote directory doesn't exist
'
' The ChilkatFTP ActiveX component can be downloaded from:
' http://www.chilkatsoft.com/download/FtpActiveX.msi
' Documentation can be found at:
' http://www.chilkatsoft.com/refdoc/xChilkatFtpRef.html
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim objFSO, objFTP, ok, strRemFile

' Extract the local file name and extension only from its path
Set objFSO = CreateObject( "Scripting.FileSystemObject" )
With objFSO
    strRemFile = .BuildPath( targetDir, .GetFileName( locFile ) )
End With
Set objFSO = Nothing

' Create a ChilkatFTP object
Set objFTP = CreateObject( "ChilkatFTP.ChilkatFTP.1" )

' pass the connection properties to the object
objFTP.Username = user
objFTP.Password = password
objFTP.Hostname = host

' Connect, abort and return error message on failure
ok = objFTP.Connect( )
If ( ok &lt;> 1 ) Then
    FTPUpload = objFTP.LastErrorText
    Set objFTP = Nothing
    Exit Function
End If

If targetDir &lt;> "" Then
    ' If specified, create target directory
    If blnMkDir = True Then
        objFTP.CreateRemoteDir targetDir
    End If
    ' Change directory remotely, abort and return error message on failure
    ok = objFTP.ChangeRemoteDir( targetDir )
    If ( ok &lt;> 1 ) Then
        FTPUpload = objFTP.LastErrorText
        objFTP.Disconnect()
        Set objFTP = Nothing
        Exit Function
    End If
End If

' Upload the file, abort and return error message on failure
ok = objFTP.PutFile( locFile, strRemFile )
If ( ok &lt;> 1 ) Then
    FTPUpload = objFTP.LastErrorText
End If

' Disconnect,and release the object
objFTP.Disconnect( )
Set objFTP = Nothing

' Return result
FTPUpload = "Upload succeeded"
End Function
Requirements:
Windows version:any
Network:any
Client software:<a href="http://www.chilkatsoft.com/refdoc/xChilkatFtpRef.html">ChilkatFTP ActiveX component</a>
Script Engine:any
Summarized:Works in any Windowsversion, requires <a href="http://www.chilkatsoft.com/refdoc/xChilkatFtpRef.html">ChilkatFTP ActiveX component</a>.




<h2><k>Send e-Mail</k></h2>
<a href="http://msdn.microsoft.com/en-us/library/aa505938.aspx">CDOSYS</a>
VBScript Code:

WScript.Echo EMail( "John Doe &lt;john@home.now>", _
     "Jane Doe &lt;jane@work.now>", _
     "Hi", _
     "Miss you!" & vbCrLf & "Love, John", _
     "", _
     "", _
     "smtp.home.now", _
     25 )

Function EMail( myFrom, myTo, mySubject, myTextBody, myHTMLBody, myAttachment, mySMTPServer, mySMTPPort )
' This function sends an e-mail message using CDOSYS
'
' Arguments:
' myFrom       = Sender's e-mail address ("John Doe &lt;jdoe@mydomain.org>" or "jdoe@mydomain.org")
' myTo         = Receiver's e-mail address ("John Doe &lt;jdoe@mydomain.org>" or "jdoe@mydomain.org")
' mySubject    = Message subject (optional)
' myTextBody   = Actual message (text only, optional)
' myHTMLBody   = Actual message (HTML, optional)
' myAttachment = Attachment as fully qualified file name, either string or array of strings (optional)
' mySMTPServer = SMTP server (IP address or host name)
' mySMTPPort   = SMTP server port (optional, default 25)
'
' Returns:
' status message
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim i, objEmail

' Use custom error handling
On Error Resume Next

' Create an e-mail message object
Set objEmail = CreateObject( "CDO.Message" )

' Fill in the field values
With objEmail
    .From     = myFrom
    .To       = myTo
    ' Other options you might want to add:
    ' .Cc     = ...
    ' .Bcc    = ...
    .Subject  = mySubject
    .TextBody = myTextBody
    .HTMLBody = myHTMLBody
    If IsArray( myAttachment ) Then
        For i = 0 To UBound( myAttachment )
 .AddAttachment Replace( myAttachment( i ), "\", "\\" ),"",""
        Next
    ElseIf myAttachment &lt;> "" Then
        .AddAttachment Replace( myAttachment, "\", "\\" ),"",""
    End If
    If mySMTPPort = "" Then
        mySMTPPort = 25
    End If
    With .Configuration.Fields
        .Item( "http://schemas.microsoft.com/cdo/configuration/sendusing"      ) = 2
        .Item( "http://schemas.microsoft.com/cdo/configuration/smtpserver"     ) = mySMTPServer
        .Item( "http://schemas.microsoft.com/cdo/configuration/smtpserverport" ) = mySMTPPort
        .Update
    End With
    ' Send the message
    .Send
End With
' Return status message
If Err Then
    EMail = "ERROR " & Err.Number & ": " & Err.Description
    Err.Clear
Else
    EMail = "Message sent ok"
End If

' Release the e-mail message object
Set objEmail = Nothing
' Restore default error handling
On Error Goto 0
End Function
Requirements:
Windows version:2000, XP, Server 2003, or Vista
Network:any
Client software:N/A
Script Engine:any
Summarized:Works in Windows 2000 or later.
<em>Won't work in Windows 95, 98, ME, or NT 4.</em>
Related links:<a href="http://www.w3schools.com/asp/asp_send_email.asp">Sending e-mail with CDOSYS</a>
<a href="email.php">E-mails generated by batch files</a>
<a href="http://www.westphil.nl/systemadministration/vbscript/index.php?name=mailread">Automate reading Outlook mail</a>




<h2><k>Retrieve your WAN IP address</k></h2>
<a href="#WinHTTP">WinHTTP</a>
<a href="#XMLHTTP">XMLHTTP</a>
<a href="#IE">Internet Explorer</a>
<a href="#Sample">Sample usage</a>








<a href="http://msdn.microsoft.com/en-us/library/aa382925(VS.85).aspx">WinHttp.WinHttpRequest.5.1</a>
VBScript Code:

Function MyIP_WinHTTP( )
' Name:       MyIP_WinHTTP
' Function:   Display your WAN IP address using WinHTTP
' Usage:      ret = MyIP_WinHTTP( )
' Returns:    WAN (or global) IP address
'
' This script uses WhatIsMyIP.com's automation page
' http://automation.whatismyip.com/n09230945.asp
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim lngStatus, objHTTP, objMatch, objRE, strText, strURL
' Return value in case the IP address could not be retrieved
MyIP_WinHTTP = "0.0.0.0"
' Retrieve the URL's text
strURL = "http://automation.whatismyip.com/n09230945.asp"
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", strURL
objHTTP.Send
' Check if the result was valid, and if so return the result
If objHTTP.Status = 200 Then MyIP_WinHTTP = objHTTP.ResponseText
Set objHTTP = Nothing
End Function
Requirements:
Windows version:Windows 2000 SP3 or later
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
<a href="http://msdn.microsoft.com/en-us/library/ms537505(VS.85).aspx">Microsoft.XMLHTTP</a>
VBScript Code:

Function MyIP_XMLHTTP( )
' Name:       MyIP_XMLHTTP
' Function:   Display your WAN IP address using XMLHTTP
' Usage:      ret = MyIP_XMLHTTP( )
' Returns:    WAN (or global) IP address
'
' This script uses WhatIsMyIP.com's automation page
' http://automation.whatismyip.com/n09230945.asp
'
' Original script written in JScript by Isaac Zelf
' "Translated" to VBScript by Rob van der Woude
' http://www.robvanderwoude.com
Dim objRequest, strURL
' Return value in case the IP address could not be retrieved
MyIP_XMLHTTP = "0.0.0.0"
' Retrieve the URL's text
strURL = "http://automation.whatismyip.com/n09230945.asp"
Set objRequest = CreateObject( "Microsoft.XMLHTTP" )
objRequest.open "GET", strURL, False
objRequest.send vbNull
If objRequest.status = 200 Then MyIP_XMLHTTP = objRequest.responseText
Set objRequest = Nothing
End Function
Requirements:
Windows version:any
Network:any
Client software:Internet Explorer 5 or later
Script Engine:any
Summarized:Works in any Windows version with Internet Explorer 5 or later.
<a href="http://msdn.microsoft.com/en-us/library/aa752084(VS.85).aspx">InternetExplorer.Application</a>
VBScript Code:

Function MyIP_IE( )
' Name:       MyIP_IE
' Function:   Display your WAN IP address using Internet Explorer
' Usage:      ret = MyIP_IE( )
' Returns:    WAN (or global) IP address
'
' This script uses WhatIsMyIP.com's automation page
' http://automation.whatismyip.com/n09230945.asp
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim blnTimedOut, i, objIE, objMatch, objRE, strText, strURL
' Return value if IP address couldn't be retrieved
MyIP_IE = "0.0.0.0"
' Open the appropriate URL in Internet Explorer
strURL = "http://automation.whatismyip.com/n09230945.asp"
Set objIE = CreateObject( "InternetExplorer.Application" )
objIE.Visible = False
objIE.Navigate2 strURL
' Wait till IE is ready
i = 0
blnTimedOut = False
Do While objIE.Busy
    WScript.Sleep 100
    i = i + 1
    ' Time out after 10 seconds
    If i > 100 Then
        blnTimedOut = True
        Exit Do
    End If
Loop
' Retrieve the URL's text
If Not blnTimedOut Then MyIP_IE = objIE.Document.Body.InnerText
' Close the Internet Explorer session
objIE.Quit
Set objIE = Nothing
End Function
Requirements:
Windows version:Windows 98 or later
Network:any
Client software:Internet Explorer
Script Engine:any
Summarized:Works in Windows 98 and later with Internet Explorer.
Sample usage
VBScript Code:

Option Explicit

Dim dtmStart, lngSeconds

WScript.Echo "Comparing 3 ways to retrieve your WAN IP address:" & vbCrLf

dtmStart = Now
WScript.Echo "InternetExplorer.Application    " _
       & MyIP_IE( )      & "    (" _
       & DateDiff( "s", dtmStart, Now ) & " seconds)"

dtmStart = Now
WScript.Echo "Microsoft.XMLHTTP               " _
       & MyIP_XMLHTTP( ) & "    (" _
       & DateDiff( "s", dtmStart, Now ) & " seconds)"

dtmStart = Now
WScript.Echo "WinHttp.WinHttpRequest.5.1      " _
       & MyIP_WinHTTP( ) & "    (" _
       & DateDiff( "s", dtmStart, Now ) & " seconds)"
Sample output:

Comparing 3 ways to retrieve your WAN IP address:

InternetExplorer.Application    124.244.199.182    (2 seconds)
Microsoft.XMLHTTP               124.244.199.182    (1 seconds)
WinHttp.WinHttpRequest.5.1      124.244.199.182    (0 seconds)






<h2><k>Retrieve Geographical Information</k></h2>
GeoIP COM
(<a href="http://web.archive.org/web/20120519041648/http://www.maxmind.com/app/com">GeoIP database & COM wrapper</a>
& <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>)
VBScript Code:
Function GeoIP( myHost )
' This function returns an array with the IP address, host name, city name,
' country name and country code for a specified IP address or host name.
'
' Argument:
' [string] IP address or host name
'
' Returns:
' [array of string] host name, IP address, city, country, country code
'
' Required software:
' MaxMind's GeoIP* database:   http://www.maxmind.com/app/installation?city=1
' MaxMind's GeoIP COM wrapper: https://github.com/maxmind/geoip-api-mscom
' System Scripting Runtime:    http://www.netal.com/ssr.htm
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

Dim objGeoIP, objDNS, objRE, strDNS, strHost, strIP

Set objDNS   = CreateObject( "SScripting.IPNetwork" )
Set objGeoIP = CreateObject( "GeoIPCOMEx.GeoIPEx" )
Set objRE    = New RegExp

' Resolve the specified host name or IP address
strDNS = objDNS.DNSLookup( myHost )

' Check if the argument is a host name or an IP address
objRE.Pattern = "&circ;[1-9][0-9]{0,2}(\.[0-9]{1,2}){3}$"
If objRE.Test( myHost ) Then
    strIP   = myHost
    strHost = strDNS
Else
    strIP   = strDNS
    strHost = myHost
End If

With objGeoIP
    ' Modify the path if you installed the GeoIP* database elsewhere
    .set_db_path "C:\Program Files\GeoIP\"
    .find_by_addr strIP
    GeoIP = Array( strHost, strIP, .city, .country_name, .country_code )
End With

Set objDNS   = Nothing
Set objGeoIP = Nothing
Set objRE    = Nothing
End Function
Requirements:
Windows version:any
Network:any
Client software:MaxMind's <a href="http://www.maxmind.com/app/installation?city=1">GeoIP* database</a> and <a href="https://github.com/maxmind/geoip-api-mscom">GeoIP COM wrapper</a>, and Franz Krainer's <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>.
Script Engine:any
Summarized:Works in any Windows version.
Requires MaxMind's <a href="http://www.maxmind.com/app/installation?city=1">GeoIP* database</a> and <a href="https://github.com/maxmind/geoip-api-mscom">GeoIP COM wrapper</a>, and Franz Krainer's <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>.
Sample Script
VBScript Code:
Option Explicit

WScript.Echo Join( GeoIP( "www.amazon.com" ), ", " )
WScript.Echo Join( GeoIP( "208.67.219.101" ), ", " )
Sample output:
www.amazon.com, 207.171.166.252, Seattle, United States, US
www.opendns.com, 208.67.219.101, San Francisco, United States, US




<h2><k>Use Google Calculator for unit conversion</k></h2>
Note:Unlike <a href="http://msdn.microsoft.com/en-us/library/aa382925(VS.85).aspx">WinHTTP</a>, <a href="http://www.xstandard.com/en/documentation/xhttp/">X-HTTP</a> and <a href="http://msdn.microsoft.com/en-us/library/ms537505(VS.85).aspx">XMLHTTP</a>, the <a href="http://msdn.microsoft.com/en-us/library/aa752084(VS.85).aspx">InternetExplorer</a> object retrieves the "interpreted" page instead of the page source code.
This makes it the best, if not the only way to retrieve Google Calculator output, which is a 100% JavaScript generated page.







<a href="http://msdn.microsoft.com/en-us/library/aa752084(VS.85).aspx">InternetExplorer.Application</a>
VBScript Code:

Function GoogleUnitConversion( myQuery )
' Name:       GoogleUnitConversion
' Function:   Convert units using Google Calculator and Internet Explorer
' Usage:      WScript.Echo GoogleUnitConversion( "10+cm+in+inches" )
' Returns:    10 centimeters = 3.93700787 inches
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim blnTimedOut, i, j, objIE, objMatches, objRE, strAllText, strMatch, strPattern, strURL
' Open the appropriate URL in Internet Explorer
strURL = "//www.google.com/search?q=" & myQuery & "&pws=0&hl=en&num=1"
strPattern = "\)\s*" & Left( myQuery, InStr( myQuery, "+" ) -1 ) &  "\s*[&circ;=]+\s*=\s*[\d\., ]+(\s+[a-z]+)*\s*" _
           & Right( myQuery, Len( myQuery ) - InStrRev( myQuery, "+" ) )
Set objIE = CreateObject( "InternetExplorer.Application" )
objIE.Visible = False
objIE.Navigate2 strURL
' Wait till IE is ready
i = 0
blnTimedOut = False
Do While objIE.Busy
    WScript.Sleep 100
    i = i + 1
    ' Time out after 10 seconds
    If i > 100 Then
        blnTimedOut = True
        Exit Do
    End If
Loop
' Retrieve the URL's text
If Not blnTimedOut Then strAllText = objIE.Document.Body.InnerText
' Close the Internet Explorer session
objIE.Quit
Set objIE = Nothing
' Use a regular expression to extract the result from the web page
Set objRE = New RegExp
objRE.Global = True
objRE.IgnoreCase = True
objRE.Pattern = strPattern
Set objMatches = objRE.Execute( strAllText )
j = objMatches.Count - 1
If j &lt; 0 Then
    strMatch = ""
Else
    strMatch = Trim( Mid( objMatches.Item(j).Value, 2 ) )
End If
Set objMatches = Nothing
Set objRE = Nothing
GoogleUnitConversion = strMatch
End Function
Requirements:
Windows version:Windows 98 or later
Network:any
Client software:Internet Explorer
Script Engine:any
Summarized:Works in Windows 98 and later with Internet Explorer.
Sample usage
VBScript Code:

' Command line arguments assumed in this example: 10 cm in inches
WScript.Echo GoogleUnitConversion( MakeQuery( WScript.Arguments.UnNamed ) )

Function MakeQuery( ByRef objArgs )
Dim i, strQuery
If objArgs.Count &lt;> 4 Then Syntax
If Not IsNumeric( objArgs(0) ) Then WScript.Quit 1
If UCase( objArgs(2) ) &lt;> "IN" Then WScript.Quit 1
For i = 0 To objArgs.Count - 1
    strQuery = strQuery & "+" & objArgs(i)
Next
MakeQuery = Mid( strQuery, 2 )
End Function
Sample output:
10 centimeters = 3.93700787 inches




<h2><k>Read the Latest Version Number from a Web Page</k></h2>
<a href="#WinHTTP">Get the latest Foxit Reader version with WinHTTP</a>
<a href="#VBSEdit">Get the latest VBSEdit version with WinHTTP</a>
<a href="#RevoUninstaller">Get the latest Revo Uninstaller version with WinHTTP</a>







<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> (<a href="http://www.foxitsoftware.com/pdf/reader_2/down_reader.htm">Foxit Reader</a>)
VBScript Code:

WScript.Echo "Latest version of Foxit Reader: " & GetFoxitReaderVersion( )


Function GetFoxitReaderVersion( )
' This function returns the current Foxit Reader version
' as string by reading Foxit's version history page.
' If an error occurs, the returned version will be "0".
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim objHTTP, objMatch, objRE, strHTML, strUserAgent, strVersion
' Initial return string, in case an error occurs
GetFoxitReaderVersion = "0"
' Use WinHTTP to read the text from Foxit's download page
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
'objHTTP.Open "GET", "http://www.foxitsoftware.com/pdf/reader_2/down_reader.htm", False
objHTTP.Open "GET", "http://www.foxitsoftware.com/Secure_PDF_Reader/version_history.php", False
strUserAgent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.3) Gecko/2008092417 Firefox/3.0.3"
objHTTP.SetRequestHeader "UserAgent", strUserAgent
objHTTP.Send
If objHTTP.Status = 200 Then
    ' If the page was returned, use a regular expression
    ' to extract Foxit Reader's latest version number
    strHTML = objHTTP.ResponseText
    Set objRE = New RegExp
    objRE.Pattern = "&lt;h[&circ;>]+>Version History&lt;/h\d+>[\n\r\s]+&lt;h[&circ;>]+>What's New in Foxit Reader (\d+\.\d+\.\d+)&lt;/h\d+>"
    objRE.IgnoreCase = False
    objRE.Global = False
    Set objMatch = objRE.Execute( strHTML )
    If objMatch.Count > 0 Then
        strVersion = objMatch.Item(0).Submatches.Item(0)
    End If
    Set objMatch = Nothing
    Set objRE = Nothing
End If
Set objHTTP = Nothing
' Return the result
GetFoxitReaderVersion = strVersion
End Function
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> (<a href="http://www.vbsedit.com/">VBSEdit</a>)
VBScript Code:

WScript.Echo "Latest version of VBSEdit: " & GetVBSEditVersion( )


Function GetVBSEditVersion( )
' This function returns the latest VBSEdit version
' as string by reading Adersoft's download page.
' If an error occurs, the returned version will be "0".
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim objHTTP, objMatch, objRE, strHTML, strUserAgent, strVersion
' Initial return string, in case an error occurs
strVersion = "0"
' Use WinHTTP to read the text from Adersoft's download page
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", "http://www.vbsedit.com/", False
strUserAgent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.3) Gecko/2008092417 Firefox/3.0.3"
objHTTP.SetRequestHeader "UserAgent", strUserAgent
objHTTP.Send
If objHTTP.Status = 200 Then
    ' If the page was returned, use a regular expression
    ' to extract Foxit Reader's current version number
    strHTML = objHTTP.ResponseText
    Set objRE = New RegExp
    objRE.Pattern = "Version ([0-9]+(\.[0-9]+))"
    objRE.IgnoreCase = False
    objRE.Global = True
    Set objMatch = objRE.Execute( strHTML )
    If objMatch.Count > 0 Then
        strVersion = objMatch.Item(0).Submatches.Item(0)
    End If
    Set objMatch = Nothing
    Set objRE = Nothing
End If
Set objHTTP = Nothing
' Return the result
GetVBSEditVersion = strVersion
End Function
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> (<a href="http://www.revouninstaller.com/">Revo Uninstaller</a>)
VBScript Code:

WScript.Echo "Latest version of Revo Uninstaller Freeware : " & GetRevoVersion( "Free" )
WScript.Echo "Latest version of Revo Uninstaller Pro      : " & GetRevoVersion( "Pro"  )


Function GetRevoVersion( myType )
' This function returns the latest Revo Uninstaller (Free/Pro)
' version as string by reading Revo's version history pages.
' If an error occurs, the returned version will be "0".
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim objHTTP, objMatch, objRE, strHTML, strUserAgent, strVersion
' Initial return string, in case an error occurs
strVersion = "0"
' Use WinHTTP to read the text from Revo's download page
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
If UCase( myType ) = "PRO" Then
    objHTTP.Open "GET", "http://www.revouninstaller.com/revo_uninstaller_pro_full_version_history.html", False
Else
    objHTTP.Open "GET", "http://www.revouninstaller.com/revo_uninstaller_full_version_history.html", False
End If
strUserAgent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.3) Gecko/2008092417 Firefox/3.0.3"
objHTTP.SetRequestHeader "UserAgent", strUserAgent
objHTTP.Send
If objHTTP.Status = 200 Then
    ' If the page was returned, use a regular expression
    ' to extract Foxit Reader's current version number
    strHTML = objHTTP.ResponseText
    Set objRE = New RegExp
    If UCase( myType ) = "PRO" Then
        objRE.Pattern = "Revo Uninstaller Pro version (\d+\.\d+(\.\d+)?)"
    Else
        objRE.Pattern = "Revo Uninstaller Freeware version (\d+\.\d+(\.\d+)?)"
    End If
    objRE.IgnoreCase = False
    objRE.Global = False
    Set objMatch = objRE.Execute( strHTML )
    If objMatch.Count > 0 Then
        strVersion = objMatch.Item(0).Submatches.Item(0)
    End If
    Set objMatch = Nothing
    Set objRE = Nothing
End If
Set objHTTP = Nothing
' Return the result
GetRevoVersion = strVersion
End Function
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.




Query <a href="http://www.freedb.org">freedb.org</a>




FREEDBControl.uFREEDB
VBScript Code:

Option Explicit

If WScript.Arguments.Count > 0 Then Syntax

Dim arrCDROMs, i, j, k, objFreeDB, strMsg
i = 0

Const CDDB_MODE_TEST   = 0
Const CDDB_MODE_SUBMIT = 1

' Create a uFREEDB object
Set objFreeDB = CreateObject( "FREEDBControl.uFREEDB" )

With objFreeDB
' Mandatory properties, freedb.freedb.org does not seem to accept the defaults
.AppName      = "QueryCD"
.AppVersion   = "1.01"
.EmailAddress = "test@scripting.eu"
.CDDBServer   = "freedb.freedb.org"
.CDDBMode     = CDDB_MODE_TEST  ' Use CDDB_MODE_SUBMIT only if you need to
  ' submit new or modified CD data to freedb.org

' Get an array with all CDROM drive letters
arrCDROMs = Split( .GetCdRoms, "|" )

' Loop through the array of CDROM drives
For j = 0 To UBound( arrCDROMs )
    ' Media Info "" means there is no CD in drive
    If .GetMediaInfo( arrCDROMs(j) ) &lt;> "" Then
        ' Count the number of CDs found
        i = i + 1
        ' Query the freedb.org database for the CD, based on its TOC
        .LookupMediaByToc .GetMediaTOC( arrCDROMs(j) )
        ' Return Album properties
        strMsg = "The CD in drive " & UCase( arrCDROMs(j) ) _
    & ": is """ & .GetAlbumName & """ by " _
    & .GetArtistName & " (" & .GetAlbumYear & ", " _
    & .GetAlbumGenre & ", " _
    & .SecondsToTimeString( .GetAlbumLength ) & ")" & vbCrLf & vbCrLf
        ' Loop through the list of tracks
        For k = 1 To .GetAlbumTracks
 ' Append track properties
 strMsg = strMsg & "Track " & Right( " " & k, 2 ) & ":  " _
        & .GetTrackName( CInt(k) ) _
        & " (" & .SecondsToTimeString( .GetTrackTime( CInt(k) ) ) & ")" _
        & vbCrLf
        Next
    End If
Next
If i = 0 Then
    strMsg = "No CD found."
End If
End With

' Display the result
WScript.Echo strMsg

' Release the object
Set objFreeDB = Nothing


Sub Syntax
strMsg = "QueryCD.vbs,  Version 1.01" & vbCrLf _
       & "Display album and track properties for all CDs in all CDROM drives" _
       & vbCrLf & vbCrLf _
       & "Usage:  QUERYCD.VBS" & vbCrLf & vbCrLf _
       & "Note:   This script requires ufreedb.ocx" & vbCrLf _
       & "        by Jon F. Zahornacky and Peter Schmiedseder" & vbCrLf _
       & "        http://www.robvanderwoude.com/vbstech_multimedia_freedb.html" _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" & vbCrLf _
       & "http://www.robvanderwoude.com" & vbCrLf
WScript.Echo strMsg
WScript.Quit 1
End Sub

Sample output:

The CD in drive F: is "Colors of a New Dawn" by Gandalf (2004, New Age, 55:29)

Track  1:  Rhythm of the Tides (6:18)
Track  2:  Bridge of Confidence (5:30)
Track  3:  In the Presence of Angels (4:55)
Track  4:  Iris (8:59)
Track  5:  From Distant Shores (6:19)
Track  6:  In the Presence of Angels (reprise) (1:34)
Track  7:  Hearts in Celestial Unison (5:03)
Track  8:  Flowers Along the Way (3:01)
Track  9:  Colors of a New Dawn (6:32)
Track 10:  Brighter than a Star (7:12)
Requirements:
Windows version:any
Network:any
Client software:<a href="./downloads/uFREEDB-1.6.2.zip">uFREEDB.ocx</a>
Script Engine:all
Summarized:Works in all Windows versions, requires
<a href="./downloads/uFREEDB-1.6.2.zip">uFREEDB.ocx</a>.




<h2><k>Query WhoIs Database</k></h2>
<a href="#InternetExplorer">InternetExplorer.Application (Function)</a>
<a href="vbstech_internet_whois_class.php#WhoisClass">InternetExplorer.Application (Class)</a>
<a href="vbstech_internet_whois_comp.php#WhoisWSC">InternetExplorer.Application</a> (<abbr title="Windows Script Component">WSC</abbr>)








InternetExplorer.Application (Function)
VBScript Code:

Option Explicit

WScript.Echo NetSolWhoIs( "google.com", 10 )


Function NetSolWhoIs( myDomain, myTimeOut )
' This function uses Network Solutions, Inc.'s WhoIs page to
' retrieve information for .com, .org, and .net (and other)
' domains.
' Note that this function will break as soon as Network
' Solution alters the layout of the WhoIs results page.
'
' Arguments:
' myDomain   [string]   domain name to be queried,
'                       e.g. "google.com"
' myTimeOut  [integer]  time-out in seconds
'
' Returns:
' Formatted WhoIs information (multi-line string)
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

Dim arrLine, arrText, blnTimedOut, i, objIE

' Open the appropriate NetSol WhoIs URL in Internet Explorer
Set objIE = CreateObject( "InternetExplorer.Application" )
objIE.Visible = False
objIE.Navigate2 "https://www.networksolutions.com/whois/" _
   & "registry-data.jsp?domain=" & Trim( myDomain )

' Wait till IE is ready
i = 0
blnTimedOut = False
Do While objIE.Busy
    WScript.Sleep 100
    i = i + 1
    ' Time out after the specified number of seconds
    If i > CInt( myTimeOut * 10 ) Then
        blnTimedOut = True
        Exit Do
    End If
Loop

' Retrieve the URL's text and save it in an array
If Not blnTimedOut Then
    arrText = Split( objIE.Document.Body.InnerText, vbLf )
End If

' Close the Internet Explorer session
objIE.Quit
Set objIE = Nothing

' Check if a time-out occurred, and return the result
If blnTimedOut Then
    NetSolWhoIs = "-- timed out --"
Else
    ' Filter out the lines starting with 3 spaces
    For i = 0 To UBound( arrText )
        If Left( arrText(i), 3 ) = "   " Then
 arrLine = Split( arrText(i), ":" )
 ' Add the line to the function's return value
 NetSolWhoIs = NetSolWhoIs _
             & Left( Trim( arrLine(0) ) _
             & String( 20, " " ), 20 ) _
             & arrLine(1)
 If UBound( arrLine ) = 2 Then
     NetSolWhoIs = NetSolWhoIs _
                 & ":" & arrLine(2)
 End If
 NetSolWhoIs = NetSolWhoIs & vbCrLf
        End If
    Next
End If
End Function
Sample Output:

Domain Name          GOOGLE.COM
Registrar            MARKMONITOR, INC.
Whois Server         whois.markmonitor.com
Referral URL         http://www.markmonitor.com
Name Server          NS1.GOOGLE.COM
Name Server          NS2.GOOGLE.COM
Name Server          NS3.GOOGLE.COM
Name Server          NS4.GOOGLE.COM
Status               clientDeleteProhibited
Status               clientTransferProhibited
Status               clientUpdateProhibited
Updated Date         10-apr-2006
Creation Date        15-sep-1997
Expiration Date      14-sep-2011
Requirements:
Windows version:any
Network:any (Internet connection)
Client software:Internet Explorer 4 or later
Script Engine:WSH
Summarized:Works in all Windows versions with Internet Explorer 4 or later, and an Internet connection.
<em>Needs to be modified (replace WScript.Sleep) to work in HTAs.</em>




<h2><k>Query Yahoo for Currency Exchange Rates</k></h2>
<a href="#WinHTTP">WinHTTP</a> (Function)
<a href="vbstech_internet_yahoofx_class.php#WinHTTP">WinHTTP</a> (Class)
<!--
<a href="vbstech_internet_yahoofx_comp.php#WinHTTP">WinHTTP</a> (<abbr TITLE="Windows Script Component">WSC</abbr>)
-->





<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> (Function)
VBScript Code:

Option Explicit

Dim dblAmount, strFromCurr, strToCurr

dblAmount   = 1987.23
strFromCurr = "USD"
strToCurr   = "EUR"

WScript.Echo YahooFX( dblAmount, strFromCurr, strToCurr )

dblAmount   = 2001.17
strFromCurr = "USD"
strToCurr   = "DKK"

WScript.Echo YahooFX( dblAmount, strFromCurr, strToCurr )


Function YahooFX( myAmount, myFromCur, myToCur )
Dim dblConvert, dblExch

If IsNumeric( myAmount ) Then
    ' Amount should be greater than zero
    If myAmount &lt;= 0 Then
        YahooFX = "Error: " & myAmount & " is not a valid amount"
        Exit Function
    End If
Else
    ' Amount should at least be a number
    YahooFX = "Error: " & myAmount & " is not a valid amount"
    Exit Function
End If

' Retrieve the exchange rate for these currencies
dblConvert  = YahooTrade( myFromCur, myToCur )
If dblConvert = 0 Then
    YahooFX = "Error retrieving exchange rate"
Else
    ' Format the screen output
    dblExch = FormatNumber( dblConvert * myAmount, 2, True, False, False )
    YahooFX = myFromCur & " " & myAmount & " = " & myToCur & " " & dblExch
End If
End Function


Function YahooTrade( myFromCurr, myToCurr )
' This function retrieves the exchange rate
' for any two currencies from finance.yahoo.com
'
' Arguments:
' myFromCurr [string]  ISO 4217 3 letter code for the currency to convert from
' myToCurr   [string]  ISO 4217 3 letter code for the currency to convert to
'
' Look up currency codes at http://www.oanda.com/site/help/iso_code.shtml
'
' Returns:
' Conversion rate as number
'
' Disclaimer:
' This script uses http://finance.yahoo.com to retrieve exchange rates.
' This script will break when Yahoo changes its web page layout or content.
' The author of this script cannot be held responsible for any damage, direct
' nor consequential, caused by the use of or inability to use this script.
' Do not make any financial decisions based on the output of this script.
' Always use a "second source" before making any decision.
' Use this script entirely at your own risk.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim colMatches, intLastSubMatch, objHTTP, objRE, strConversion
Dim strDecimal, strMyAmount, strResponse, strURL, strUserAgent

' Get the locally used decimal delimiter
strDecimal  = Replace( FormatNumber( 0, 1, True ), "0", "" )

' Retrieve Yahoo's web page containing the our currencies' exchange rate
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
strURL = "//finance.yahoo.com/q?s=" & myFromCurr & myToCurr & "=X"
objHTTP.Open "GET", strURL, False
strUserAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows 98)"
objHTTP.SetRequestHeader "UserAgent", strUserAgent
objHTTP.Send
strResponse = objHTTP.ResponseText
Set objHTTP = Nothing

' Extract and return the exchange rate from
' the web page; in case of error return 0
Set objRE        = New RegExp
objRE.Global     = False
objRE.IgnoreCase = True
objRE.Pattern    = ">Last Trade:(&lt;[&circ;>]+>)+([.0-9]+)&lt;[&circ;>]+>"
Set colMatches   = objRE.Execute( strResponse )
If colMatches.Count = 1 Then
    intLastSubMatch = colMatches.Item(0).Submatches.Count - 1
    strConversion   = colMatches.Item(0).Submatches( intLastSubMatch )
    If IsNumeric( strConversion ) Then
        ' Convert the match from string to number,
        ' using the local decimal delimiter
        strConversion = CDbl( Replace( strConversion, ".", strDecimal ) )
        YahooTrade = strConversion
    Else
        YahooTrade = 0
    End If
Else
    YahooTrade = 0
End If
Set colMatches = Nothing
Set objRE      = Nothing
End Function
Sample Output:

USD 1987,23 = EUR 1462,40
USD 2001,17 = DKK 10961,01
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.




<h2><k>True Random Numbers</k></h2>
<a href="#RndInt">RndInt</a> (Function using <a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
<a href="#RndIntArr">RndIntArr</a> (Function using <a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
<a href="vbstech_internet_random_class.php#Random">Random</a> (Class using <a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
<a href="vbstech_internet_random_comp.php#RandomWSC">Random.wsc</a> (Windows Script Component using <a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
    







RndInt (<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
VBScript Code:

Function RndInt( myMin, myMax )
' Retrieves a single TRUE random integer from http://www.random.org/
'
' Arguments:
' myMin  [int]  lowest possible value for the random integer
' myMax  [int]  highest possible value for the random integer
'
' Returns:
' [int]  random integer within the specified range
'        OR a [string] error message
'
' Note:
' Read http://www.random.org/quota/ if you intend to use this script often
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim intStatus, objHTTP, strAgent, strResult, strURL

If Not IsNumeric( myMin ) Then
    RndInt = "Error (" & myMin & " is not a number)"
    Exit Function
End If

If Not IsNumeric( myMax ) Then
    RndInt = "Error (" & myMax & " is not a number)"
    Exit Function
End If

If Not CInt( myMin ) = myMin Then
    RndInt = "Error (" & myMin & " is not an integer)"
    Exit Function
End If

If Not CInt( myMax ) = myMax Then
    RndInt = "Error (" & myMax & " is not an integer)"
    Exit Function
End If

strURL   = "http://www.random.org/integers/?num=1" _
         & "&min=" & myMin _
         & "&max=" & myMax _
         & "&col=1&base=10&format=plain&rnd=new"
strAgent = "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"

Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", strURL, False
objHTTP.SetRequestHeader "User-Agent", strAgent

On Error Resume Next
objHTTP.Send
intStatus = objHTTP.Status
strResult = Trim( Replace( objHTTP.ResponseText, vbLf, " " ) )
On Error Goto 0

If intStatus = 200 Then
    RndInt = strResult
Else
    RndInt = "Error (Status " & intStatus & ")"
End If

Set objHTTP = Nothing
End Function
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
RndIntArr (<a href="http://msdn.microsoft.com/en-us/library/aa382925.aspx">WinHTTP</a> & <a href="http://www.random.org/">Random.org</a>)
VBScript Code:

Function RndIntArr( myMin, myMax, myLength )
' Retrieves TRUE random integers from http://www.random.org/
'
' Arguments:
' myMin     [int]  lowest possible value for the random integer
' myMax     [int]  highest possible value for the random integer
' myLength  [int]  the number of random integers that should be retrieved
'
' Returns:
' [array of int]   array with the requested number of random integers within
'                  the specified range OR an [array of string] error message
'
' Note:
' Read http://www.random.org/quota/ if you intend to use this script often
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim arrResult, i, intStatus, objHTTP, strAgent, strResult, strURL

If Not IsNumeric( myMin ) Then
    RndInt = "Error (" & myMin & " is not a number)"
    Exit Function
End If

If Not IsNumeric( myMax ) Then
    RndInt = "Error (" & myMax & " is not a number)"
    Exit Function
End If

If Not IsNumeric( myLength ) Then
    RndInt = "Error (" & myLength & " is not a number)"
    Exit Function
End If

If Not CInt( myMin ) = myMin Then
    RndInt = "Error (" & myMin & " is not an integer)"
    Exit Function
End If

If Not CInt( myMax ) = myMax Then
    RndInt = "Error (" & myMax & " is not an integer)"
    Exit Function
End If

If Not Abs( CInt( myLength ) ) = myLength Then
    RndInt = "Error (" & myLength & " is not an integer)"
    Exit Function
End If

If myLength &lt; 1 Then
    RndInt = "Error (" & myLength & " is not a valid number of requests)"
    Exit Function
End If

strURL   = "http://www.random.org/integers/" _
         & "?num=" & myLength _
         & "&min=" & myMin _
         & "&max=" & myMax _
         & "&col=1&base=10&format=plain&rnd=new"
strAgent = "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"

Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", strURL, False
objHTTP.SetRequestHeader "User-Agent", strAgent

On Error Resume Next
objHTTP.Send
intStatus = objHTTP.Status
strResult = Trim( Replace( objHTTP.ResponseText, vbLf, " " ) )
arrResult = Split( strResult )
ReDim Preserve arrResult( myLength - 1 )
On Error Goto 0

If intStatus = 200 Then
    RndIntArr = arrResult
Else
    RndIntArr = Array( "Error (Status " & intStatus & ")" )
End If

Set objHTTP = Nothing
End Function
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
Sample Script
VBScript Code:

Option Explicit

Dim arrTest

' Cast 1 die with the RndInt function,
' which returns a single random integer
WScript.Echo RndInt( 1, 6 )

' Cast 2 dice with the RndIntArr function, which
' returns multiple random integers in an array
arrTest = RndIntArr( 1, 6, 2 )
WScript.Echo arrTest(0) & vbCrLf & arrTest(1)
Sample output:
3
2
1




<h2><k>Check Websites</k></h2>
<a href="#WinHTTP">WinHTTP</a>
<a href="#X-HTTP">X-HTTP</a>








WinHTTP
VBScript Code:

Dim strWebsite

strWebsite = "www.robvanderwoude.com"

If PingSite( strWebsite ) Then
WScript.Echo "Web site " & strWebsite & " is up and running!"
Else
WScript.Echo "Web site " & strWebsite & " is down!!!"
End If


Function PingSite( myWebsite )
' This function checks if a website is running by sending an HTTP request.
' If the website is up, the function returns True, otherwise it returns False.
' Argument: myWebsite [string] in "www.domain.tld" format, without the
' "http://" prefix.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim intStatus, objHTTP

Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )

objHTTP.Open "GET", "http://" & myWebsite & "/", False
objHTTP.SetRequestHeader "User-Agent", "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"

On Error Resume Next

objHTTP.Send
intStatus = objHTTP.Status

On Error Goto 0

If intStatus = 200 Then
    PingSite = True
Else
    PingSite = False
End If

Set objHTTP = Nothing
End Function
Requirements:
Windows version:2000 SP3, XP, Server 2003, or Vista
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
<a href="http://www.xstandard.com/en/documentation/xhttp/">X-HTTP</a>
VBScript Code:

Dim strWebsite

strWebsite = "www.robvanderwoude.com"

If IsWebsiteUp( strWebsite ) Then
WScript.Echo "Web site " & strWebsite & " is up and running!"
Else
WScript.Echo "Web site " & strWebsite & " is down!!!"
End If


Function IsWebsiteUp( myWebsite )
' This function checks if a website is running by sending an HTTP request.
' If the website is up, the function returns True, otherwise it returns False.
' Argument: myWebsite [string] in "www.domain.tld" format, without the
' "http://" prefix.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
' The X-HTTP component is available at:
' http://www.xstandard.com/page.asp?p=C8AACBA3-702F-4BF0-894A-B6679AA949E6
' For more information on available functionality read:
' http://www.xstandard.com/printer-friendly.asp?id=32ADACB9-6093-452A-9464-9269867AB16E
Dim objHTTP

Set objHTTP = CreateObject( "XStandard.HTTP" )

objHTTP.AddRequestHeader "User-Agent", _
              "Mozilla/4.0 (compatible; MyApp 1.0; Windows NT 5.1)"
objHTTP.Get "http://" & myWebsite

If objHTTP.ResponseCode = 200 Then
    IsWebsiteUp = True
Else
    IsWebsiteUp = False
End If

Set objHTTP = Nothing
End Function
Requirements:
Windows version:any
Network:any
Client software:<a href="http://www.xstandard.com/en/documentation/xhttp/">X-HTTP</a> component
Script Engine:any
Summarized:Works in any Windows version with the <a href="http://www.xstandard.com/en/documentation/xhttp/">X-HTTP</a> component installed.




<h2><k>Check if a computer is a laptop</k></h2>
WMI (Win32_Battery)
VBScript Code:

If IsLaptop( "." ) Then
WScript.Echo "Laptop"
Else
WScript.Echo "Desktop or server"
End If


Function IsLaptop( myComputer )
' This Function checks if a computer has a battery pack.
' One can assume that a computer with a battery pack is a laptop.
'
' Argument:
' myComputer   [string] name of the computer to check,
'                       or "." for the local computer
' Return value:
' True if a battery is detected, otherwise False
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
On Error Resume Next
Set objWMIService = GetObject( "winmgmts://" & myComputer & "/root/cimv2" )
Set colItems = objWMIService.ExecQuery( "Select * from Win32_Battery" )
IsLaptop = False
For Each objItem in colItems
    IsLaptop = True
Next
If Err Then Err.Clear
On Error Goto 0
End Function

Requirements:
Windows version:2000, XP, Server 2003, or Vista (or NT 4 with <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a>)
Network:Stand-alone, workgroup, NT domain, or AD
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> for Windows NT 4
Script Engine:any
Summarized:Can work in Windows NT 4 or later, but <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> is required for Windows NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<em>Doesn't work in Windows 95, 98 or ME.</em>




<h2><k>Generate MSInfo Reports</k></h2>
Msinfo32.MSInfo.1
VBScript Code:

Option Explicit

' Create a full MSInfo report of the local
' computer, and save it as C:\msinforeport.txt
MSInfo ".", "C:\msinforeport.txt", True


Sub MSInfo( myComputer, myReportFile, blnFullReport )
' This subroutine generates an MSInfo report for the specified
' computer, saving it under the specified file name.
'
' Arguments:
' myComputer     [string]   the computer to be queried, or a dot
'                           or empty string for the local computer
' myReportFile   [string]   the file name of the report to be generated
' blnFullReport  [boolean]  if True, a full report will be generated,
'                           otherwise only an OS summary is generated
'
' Returns:
' A full MSInfo report file for the specified computer
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

Dim objMSInfo, strCategory, varPctDone, wshShell

If myComputer = "" Or myComputer = "." Then
    ' Get the computer name of the local computer
    Set wshShell = CreateObject( "WScript.Shell" )
    myComputer   = wshShell.ExpandEnvironmentStrings( "%ComputerName%" )
    Set wshShell = Nothing
End If

If blnFullReport = True Then
    strCategory = ""
Else
    strCategory = 0
End If

' Query the computer and generate the report
Set objMSInfo = CreateObject( "Msinfo32.MSInfo.1" )
objMSInfo.UpdateDCOProgress( varPctDone )
objMSInfo.SaveFile myReportFile, myComputer, strCategory
Set objMSInfo = Nothing
End Sub

Requirements:
Windows version:not sure, tested in Windows XP SP2
Network:any
Client software:N/A
Script Engine:any
Summarized:Should work in Windows 2000 or later.
<em>Uncertain if it will work in Windows 95, 98, ME or NT 4.</em>




<h2><k>Basic Hardware Inventory</k></h2>
<h2>&emsp;Version 9.02</h2>
<a href="#Description">Program description</a>

<a href="#Issues">Known issues</a>

<a href="#Changes">Change log</a>

<a href="#Download">Download</a>

<a href="donate.php">Donate</a>








Use this HTA to get a basic hardware inventory of any WMI enabled computer on the network.

<img data-src="https://www.robvanderwoude.com/pictures/hardware902main.jpg" />

This HTA does not demand elevated privileges, though they are still recommended.

<img data-src="https://www.robvanderwoude.com/pictures/hardware_privileges.jpg" />

Unless you started the HTA with the optional <code>/NOADMIN</code> command line switch, the HTA will prompt you when running without elevated privileges.
Clicking ""Yes"" will restart the HTA with elevated privileges.

Interactive use:

Open the Basic Hardware Inventory tool by double clicking the file hardware.hta.

Fill in the name or IP address of a remote computer in the "Computer" field at the top of the screen.
Or you can use the "Paste" button at the left of this field to paste the computer name from the clipboard.
Or just leave the "Computer" field empty to use the default: the local computer.

If you only want a limited inventory, deselect the components you want to skip by deselecting the appropriate checkboxes at the left.
Or use the "Basic" button at the top (or its <code>Alt+B/Alt+F</code> keyboard shortcuts), to toggle between a basic (CPUs, memory and harddisks) and full inventory.

Click the "Go" button next to the "Computer" field (or use its <code>Alt+G</code> keyboard shortcut) to start the inventory.
This may take a couple of seconds or sometimes even minutes.

When the results are displayed, you can use the "Copy" button at the bottom to copy them to the clipboard, or the "Save" button to save them to a (tab delimited) text file, or the "Print" button (or using its <code>Alt+P</code> keyboard shortcut) to open a print preview of the results.
As of version 6.00, "fast printing" is available: just press Ctrl+P on the keyboard and select a printer.
"Save" by default writes the results to a file named "Hardware.<em>computername</em>.<em>20240616024405</em>.txt" in the HTA's parent folder.
To use a different path, use command line switch <code>/SAVE</code> (view the <a href="hardwarehelp.php">Help screen</a> for details).
Exported results are in tab delimited format.

By clicking the "Settings" button (or using its <code>Alt+S</code> keyboard shortcut), the HTA's Settings screen will be opened.
Here you can set your preferred window size, whether you want to use DxDiag and/or DMIDecode, if available, to get more details, and you can play with the HTA's themes and custom color settings.
When saved, the settings are stored in a plain ASCII text file named "Hardware.cfg", located in the HTA's parent folder. 
This configuration file may be edited with a text editor (e.g. Notepad), and should contain a single line with command line switches.
View the <a href="hardwarehelp.php">Help screen</a> to list all available options.

<img id="SettingsScreenshot" src="pictures/hardware902settings.jpg" />

Return to the main screen by clicking the "Cancel" button or pressing the "Esc" key.

Back in the main screen, use any of the "Details" buttons to display more details for the selected hardware category.
If the <code>/DXDIAG</code> command line switch was used (for the local computer only), besides WMI data, DxDiag data will be displayed too for CPU, memory, harddisks, CDROMs, video, sound, ports and BIOS.

Hover your mouse pointer over any field or button to display a short help text in a tooltip; after the inventory, the tooltip will show the new value of the field.

Click the "Reset" button at the top (or use its <code>Alt+R</code> keyboard shortcut) to clear the results before starting a new inventory.

For help on command line options, press F1 or click the "Help" button at the bottom.

<a href="hardwarehelp.php"><img data-src="https://www.robvanderwoude.com/pictures/hardware902help.jpg" /></a>

To view the credits, click the "Credits" button at the bottom (or use its <code>Alt+C</code> keyboard shortcut) of the Main screen.

<a href="hardwarecredits.php"><img data-src="https://www.robvanderwoude.com/pictures/hardware902credits.jpg" /></a>
Command line:

Open the <a href="hardwarehelp.php">HTA's Help screen</a> for details on the HTA's command line options and keyboard shortcuts.




<h2 id="Issues">&emsp;Known Issues</h2>
<strong>Harddisk/CDROM interface:</strong>
SATA type disks may be listed as either SATA or ATA; as of version 7.00 this HTA uses the <code>BusType</code> property of the <code>MSFT_PhysicalDisk</code> class in WMI's <code>root/Microsoft/Windows/Storage</code> namespace to check the interface type; though <em>much</em> more reliable than <code>Win32_DiskDrive</code>'s <code>InterfaceType</code> in WMI's <code>root/CIMV2</code> namespace, it may still make mistakes.
SATA type disks may be listed incorrectly as SCSI when the disk is connected to a RAID enabled controller.
<strong>Floppy drive interface:</strong>
I have not yet found a way to link a specific floppy disk drive to a specific interface.
The HTA will count the number of floppy drives found, and the number of USB floppy drives. If these numbers are equal, it's easy: all floppy disk drives use a USB interface.
Likewise, if there are no USB floppy drives at all, it's easy again: all floppy drives must be using the internal floppy drive controller.
In case it's <em>not</em> easy, i.e. if none of the previously mentioned situations occur, the interface type will be marked "Unknown" for all floppy disk drives.
<strong>Floppy drive capacity:</strong>
To determine the floppy disk drives' capacities, the HTA uses their <a href="https://docs.microsoft.com/en-us/previous-versions/windows/hardware/drivers/ff562216(v=vs.85)">MediaType</a> property in the <a href="https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-logicaldisk">Win32_LogicalDisk</a> class.
This property value is known to be unreliable for "special" floppy disk formats, or if no disk is inserted.
<strong>Video resolution:</strong>
In case of multiple monitors with different screen resolutions, connected to a single video adapter, and configured as extended desktop, only one of the screen resolutions will be listed.
Rumour has it there are other (combinations of) conditions causing incorrect results too.
The solution (inspired by Gary Johnson) is to use DirectX instead of WMI.
Unfortunately, this is not only slow, but it is limited to the <em>local</em> computer only.
If the specified computer name does not match the local computer name, the <code>/DXDIAG</code> command line switch and all its dependent switches will be ignored.
<strong>Video RAM:</strong>
The amount of video RAM returned by WMI is limited to 4GB -1.
Besides, the amount returned by WMI as well as by DxDiag is usually incorrect for <em>integrated</em> controllers.
As a work-around, the HTA will try and read the amount of video RAM from the registry, which is the most reliable. This may require elevated privileges though.
<strong>Chrome for default browser:</strong>
If Google Chrome is the default browser, and its first window is opened with elevated privileges, no new Chrome tabs or windows can be opened without elevated privileges.
If, on the other hand, Chrome's first window was opened without elevated privileges, new tabs and windows can be opened with or without elevation.
To prevent problems in case this HTA is the first to open a Chrome window (through the Details buttons), as of Hardware.hta version 9.00, just before restarting the HTA with elevated privileges, a non-elevated minimized Chrome window is started if Chrome is the default browser and no Chrome window is opened yet.
<strong>WMI:</strong>
This HTA uses WMI to get information on all hardware installed.
WMI gets its hardware information from the hardware drivers.
Sometimes these drivers may provide incorrect information (e.g. SCSI instead of SATA for drives connected to a RAID enabled controller).
This is not a bug in Basic Hardware Inventory; <em>any</em> WMI based inventory will display the same incorrect results.
If WinSAT scores remain empty or zero in Windows 8.1 and later: open an elevated CMD prompt and run the command <code>winsat.exe formal</code> once (and again after major hardware changes) to build the WinSAT scores database for your computer.
Elevated privileges are required to access WMI's <code>root/WMI</code> namespace.
If you run this HTA without elevated privileges, you may miss some details, i.e. keyboard, mouse and monitors.
In WinPE or safe mode, not as much information is available as in a "full" Windows environment.
If the HTA cannot get specific hardware information (e.g. CDROM drives, monitors, sound and video cards) using WMI in WinPE or safe mode, it will try to get that information from the registry instead.
However, I did not (yet?) find a way to get as many details from the registry as WMI provides.




<h2 id="Changes">&emsp;Change History</h2>
VersionRelease Date(yyyy-mm-dd)Changes
9.022023-04-09
The Settings and Help screens now show the correct default theme <span>(Black-and-White)</span>

9.012023-03-30
Default theme now <em>really</em> changed to Black-and-White
Fixed some "non-fatal" coding inconsistencies (replaced <code><em>objDictionary( "key" )</em></code> by <code><em>objDictionary.Item( "key" )</em></code> for consistency's sake)

9.002023-03-28
Keyboard and mouse now each have their own row in the main screen
Keyboard and mouse info that cannot be read reliably without elevated privileges will be hidden from view when running without elevation
Routines to retrieve network adapter, harddisk and sound device information were rewritten
Default theme changed to Black-and-White
Improved error handling for remote access problems
Removed custom window size function (<code>/SIZE</code> switch)
The HTA now starts maximized
Removed Maximize and Minimize keyboard shortcuts
Fixed an issue with zoom factor other than 100% and overlapping memory output fields
As a workaround for the Google Chrome issue (see known issues) an unelevated minimized Chrome session is started just before the HTA restarts itself with elevated privileges <strong>if</strong> Chrome is the default browser and <strong>if</strong> Chrome is <strong>not</strong> running yet
An informational message will popup if action is required to enable WinSAT scores (see known issues)
WMI-related code optimized for better performance
As of this version Windows 7 and earlier versions are no longer supported; use version 8.04 (included in download) on these older systems

8.042023-02-06
Fixed: routine for 4GB or more video memory would not work if multiple video controllers were installed
Fixed: as WMI does not return the correct amount of video RAM for <em>internal</em> video controllers, the HTA will now <em>always</em> try and read the correct amount from the registry for <em>every</em> video controller installed

8.032023-01-27
Fixed: virtual video device (e.g. Citrix) would result in empty field above first video device
Fixed: routine for 4GB or more video memory would not work on remote computers
Fixed: "Details" button for CD-ROM devices would only be enabled if at least 2 CD-ROM drives were available

8.022023-01-03
Fixed: very long property names would be truncated in details windows

8.012023-01-03
Fixed: several error messages caused by disabled "<code>On Error Resume Next</code>" lines that should have remained enabled

8.002022-06-25
The HTA no longer uses Internet Explorer
More debugging messages when <code>/DEBUG</code> switch is used
Timestamp format changed in debug output (now contains delimiters)
Fixed: sound button remained disabled when running in WinPE mode

7.11.12022-02-04
Fixed: an error would occur when no floppy drive was connected.

7.112022-02-04
Floppy drives have been added as a category in the main window.

7.102021-11-15
Use of Internet Explorer is forced regardless of <code>/NOIE</code> setting when running without elevated privileges.

7.092021-11-14
Minor change: when you right-click a field, its content is selected.
This makes copying individual fields' content easier.
The code to accomplish this is an <code>oncontextmenu="this.select()"</code> event handler for each HTML text input.

7.082021-05-10
Bugfix: the HTA minimizes at startup, and restores the window when the interface is completely loaded, or you would be staring at a blank window for several seconds.
However, restoring the windows would fail if the window lost focus.
The bugfix in version 7.06 did not always solve this issue.
It has now been fixed by adding a line <code>window.focus</code> just before the code to restore the window.

7.072021-03-10
Fixed the garbled &copy; character in the title bar
Added a warning note in the help screen on using <code>/NOIE</code> switch by non-admin users
Added some code to ease the process of creating screenshots for this web page

7.062021-02-23
Added some JavaScript code to fix a bug where the window would remain invisible on some systems at startup

7.052021-02-18
DWORD and QWORD values from the registry are now shown both in hexadecimal <em>and</em> decimal in details windows

7.042021-02-17
Added a work-around for video RAM exceeding 4 GB (WMI uses <code>UInt32</code> for <code>Win32_VideoController</code>'s <code>AdapterRAM</code> property, which is limited to <strong>0xFFFFFFFF</strong>, i.e. <strong>4 GB</strong>)
Fixed a bug in displaying registry data in details windows

7.032020-07-19
New memory speed field in GUI
New memory speed column in exported results
Fixed a bug where WinSat score fields in exported results remained empty

7.022020-07-15
New memory form factor field in GUI
New memory form factor column in exported results

7.012020-04-10
Performance improvement by replacing the external PowerShell script by "native" VBScript code.
New setting (command line switch <code>/VIRTUAL</code>) to include virtual disk drives in the inventory.
Added an extra test if the HTA is prepared for icon embedding to the batch file.

7.002020-04-07
New zoom option (command line switch <code>/ZOOM:<em>percentage</em></code>) to scale the HTA's content.
Harddisk interfaces are now queried by on-the-fly PowerShell code, making the results more reliable, though still not 100% error-free.
The number of harddisks, CDROM drive, network and video cards and monitors displayed are no longer limited by a fixed number table rows, instead table rows will be added on-the-fly when needed.
Because there is no limit for these devices, the saved tab-delimited export files no longer have a fixed number of columns for each device type, i.e. the number of columns will depend on the specific hardware.
New dark theme (black background), but no more background gradients
The download ZIP file also contains an icon and a batch file to embed the icon in the HTA (can only be used once, and HTA can no longer be edited).

6.162017-10-11
A lot of new code has been added to allow running this HTA in WinPE (10) and safe mode.
Note that not "all" information will be available in these "limited" environments, e.g. monitors and video memory may be missing, in case of multiple video cards only one may be listed, the same for audio.
Besides, in WinPE no Internet Explorer is available, nor DxDiag or DMIDecode, so you cannot investigate hardware details beyond the main window.
The HTA's ID has been changed from "HardwInv" to "Hardware"; a minor detail indeed, but it allows you to run this new version beside an old version of the HTA.

6.152017-04-14
Bugfix: fixed "variable is undefined" errors.

6.142017-04-13
Implemented a solution contributed by Russell J. Wiley to always open Internet Explorere windows (debug and print dialogs and detailed WMI query results) in the foreground.
Modified the Win32_CDROM WMI query to exclude CDROM drives with the word "virtual" in their names, to prevent virtual CDROM drives from being listed.

6.132016-08-17
Corrected a broken link in the Help text

6.12N/AOops, skipped
6.112016-02-13
Another bug in the window sizing (the program would sometimes ignore screen size settings in the configuration file), also reported by Steve Robertson, has been fixed.
And yet another bug in the window sizing (the window size would go haywire when dragging or resizing the window), again reported by Steve Robertson, has been fixed.
Elevated privileges are no longer mandatory, though still recommended to get "all" details; if you start the HTA without elevated privileges, it will prompt you to restart with elevated privileges.
Because elevated privileges are no longer mandatory, an optional command line switch <code>/NOADMIN</code> was added to allow skipping the test for elevated privileges.
Keyboard and mouse detection routines were improved to get at least <em>some</em> results without elevated privileges.
More keyboard shortcuts have been implemented; see the <a href="hardwarehelp.php#Keyboard">HTA's Help screen</a> for details.
The new "Edit" button in the Settings screen opens the configuration file in Notepad; when closing it, any changes are immediately applied.
Debug mode was implemented: some intermediate setting can be displayed in a separate Internet Explorer window.
Optionally, the Debug window's content can be saved to a log file when the HTA is closed.

6.102016-02-06
A bug in the window sizing (the program would look for a setting "maximize" but ignore a "numerical" setting equal to the screen size), reported by Steve Robertson, has been fixed.
A bug in the monitors detection (no monitors found in Windows 8.* and 10), also reported by Steve Robertson, has been fixed.
The monitors detection has been completely rewritten to fix this bug.
Previous versions of this HTA used the raw <a href="https://en.wikipedia.org/wiki/Extended_Display_Identification_Data">EDID</a> data (large array of byte numbers), retrieved from the registry, to find the model, serial number and manufacturer; the new version uses WMI instead, and reads the model and manufacturer as plain string values from the registry.
Due to the "almost-entirely-WMI" monitor detection, detection will most likely fail in Windows XP or older; if you still use Windows XP, consider <strong>not</strong> updating this HTA.
The details window for monitors has a new added paragraph with relevant registry values.
A new optional setting and its command line swich <code>/CHAIN</code> allow character arrays in details windows to be displayed as interpreted text too, e.g.
<code>PropertyValue (array) : 83,121,110,99,77,97,115,116,101,114,0,0,0
PropertyValue (string): SyncMaster</code>
Some BIOS property values have been replaced by SMBIOS BIOS properties in the main window, as these SMBIOS values seem more accurate.
When you hover the mouse pointer over a field, the value is shown in a tooltip, so you no longer need to click a field and scroll to the right to read the entire value.
Keyboard shortcuts have been implemented for several buttons; see the <a href="hardwarehelp.php#Keyboard">HTA's Help screen</a> for details.

6.092016-01-19
In the Settings screen, a new "Delete XML" button allows you to quickly delete DxDiag's existing XML file just once, even when the HTA is set to keep the existing XML file.
Theme settings were added: you can now completely customize the HTA's colors.
New optional command line switches were added to allow setting the theme on the command line too.

6.082015-10-29
A specific error message is displayed if the HTA runs with 32-bit MSHTA.EXE on 64-bit Windows.
WinSAT Scores fields are no longer displayed in Windows XP or older.
Credits for DMIDecode for Windows were added.

6.072015-10-22
A bug in the NIC Speed detection has been fixed.
The WMI query for physical network adapters has been simplified.

6.062015-10-19A bug which made the HTA trip on empty PATH entries has been fixed.
6.052015-05-06A bug which prevented remote inventories has been fixed.
6.042015-04-26Two annoying inconsistencies, both reported by Steve Robertson, were fixed: 
    
If no network connection is available, the HTA will no longer suggest to manually check for updates.
I changed the default file extension for tab delimited output from ".csv" to ".txt".

6.032015-04-20
A bug reported by Steve Robertson was fixed (error in the default path for the configuration file).
An issue is fixed to allow stand-alone use (if no network connection was available, the check for updates would crash).

6.022015-03-26
A new optional switch <code>/DMIDECODE</code> uses <a href="http://www.nongnu.org/dmidecode/">DMIDecode</a> to add DMI/SMBIOS data to several Details pages.
The <code>/SAVE</code> switch no longer asks for a file name if no file name was specified, but uses <code>Hardware.<em>computername</em>.<em>20240616024405</em>.csv</code> in the HTA's parent folder.
The <code>/SAVE</code> switch now also accepts file names as <code><em>parentfolderpath</em>\*</code>, in which case <code>Hardware.<em>computername</em>.<em>20240616024405</em>.csv</code> will be used in the specified folder <code><em>parentfolderpath</em></code>.
Several quirks and bugs reported by Steve Robertson were fixed.

6.012014-01-16
Added the BIOS serial number to the printout and export to CSV.

6.002014-01-15A reshuffle of the user interface, plus some code optimization: 

All permanent settings are displayed in their own window when the "Settings" button is clicked.
All permanent settings can be changed interactively.
The configuration file can also be edited "manually" in Notepad.
The settings can be restored to "factory defaults" by clicking the "Reset" button.
The Settings, Help and Credits screens are all opened in the main program window, thus minimizing the chance of stray Internet Explorer leftover sessions after closing the HTA.
Pressing the Escape key returns you to the main program window.
In the Help and Credits screens, pressing the Backspace key will do the same.
CSS code has been added to allow fast printing without the use of an Internet Explorer object (press <code>Ctrl+P</code> to print).
Some switches can no longer be used in the configuration file, but are now commandline-only; see the program's Help screen for details.
Fixed print preview issue.
The HTA checks if it is running with elevated privileges, and displays an error message if not.

5.512013-11-19
Added Windows System Assessment Tool's (WinSAT) scores.
Improved update check, it now starts in a separate thread to speed up initial window loading.
Less dependency on separate Internet Explorer objects.
Fixed more incorrect HTML and CSS to anticipate future Internet Explorer versions.

5.502012-12-20
Added an HTML document type and fixed some incorrect CSS to make the HTA display correctly in Windows 8.

5.492012-01-13
Fixed another bug with the Hardware.cfg configuration file: a 0 byte file (or no read access to the file) would still sometimes generate an error message (bug reported by Steve Robertson).
As of now, if a 0 byte configuration file is saved, it will be deleted immediately.

5.482012-01-09
Fixed another bug with <code>/Print</code> and IE9: the print window must be visible for a couple of seconds to allow IE to send the data to the printer.

5.472012-01-09
Fixed a bug with the Hardware.cfg configuration file: a 0 byte file would crash the HTA (bug reported by Steve Robertson).
Fixed a bug with Print and IE9: IE9 suddenly refused to show a print preview if the IE object was invisible.

5.462012-01-05
Added a "Print" button and <code>/PRINT</code> command line switch.
When the "Inventory" button is clicked, all <em>deselected</em> components (rows) will be hidden from view.

5.452011-10-13
Added physical monitor dimensions (requires Windows Vista or later).
Added the <code>/CM</code> command line switch to display physical monitor dimensions as <code><em>width</em> x <em>height</em> cm</code> instead of diagonal in inches.

5.442011-09-25
If the <code>/DXDIAG</code> command line switch is used on the local computer, DxDiag data will now be displayed, besides WMI data, in most Details windows.

5.432011-09-18
Fixed errors occurring when switching between Help and Credits.
Fixed missing and incorrect Help and Credits window titles.
Fixed Help and Credits windows' focus.
Prevented multiple instances of the Help and Credits windows to be opened.

5.422011-09-17
Added support for USB harddisks (command line switch <code>/USBSTOR</code>).
Added command line switches <code>/DXDIAG, /KeepXML</code> and <code>/XML</code>.
These switches allow you to use <code>DxDiag.exe</code> to query DirectX data instead of WMI for video memory and screen resolution.
The details window for the video controllers will contain DirectX as well as WMI data if <code>/DXDIAG</code> is used.
The DirectX query may take a minute or more, unless the <code>/KeepXML</code> switch is used (then it takes that long only the first time the HTA is run).
Added a "Save" button and <code>/SAVE</code> command line switch to save the results in tab delimited format to a file. 
Moved the help text to an Internet Explorer window, as the amount of text now exceeds the limit for <code>MsgBox</code> dialogs.
Added some extra error handling and error messages, to allow debugging. 
Rearranged some of the buttons.

5.412011-07-29
USB field now distinguishes between USB 2.0 (or older) and 3.0.
System Slots field now distinguishes between PCI and PCI Express.
Improved SATA detection (though still far from perfect). 
Added Details button for monitors (won't show any useful information in Windows 2000).
Inventory now uses a PING before trying to connect to the specified computer, thus significantly decreasing the delay in case the computer is not online or does not exist.
Details windows now show namespaces as well as class names. 
Details windows now show number of instances found for each class. 
Details windows now correctly display properties of type Array. 
Fixed some bugs in the interface (focus).

5.402011-07-10
The HTA is <em>much</em> faster.
With the new "Basic" button you can easily toggle between a basic (CPUs, memory and harddisks) and full inventory. 
Clicking the new "Help" button opens the Command Line Help window, just like pressing F1 does.
The credits were moved to a separate screen.
Clicking the new "Credits" button opens the Credits window.
The delay times between inventories of components have been removed again.
The optimized code doesn't leave the HTA unresponsive for a long time, so the delays became obsolete.
The <code>/NODELAYS</code> command line switch has been removed too.
Only one single delay remains, between pressing the "Go" button and actually starting the inventory; the delay allows the HTA to immediately disable its checkboxes and buttons.

5.302011-07-05
A check for the Internet Explorer has been added, so the HTA now correctly displays multiple harddisks, CDROMs, network or video adapters in IE7 too. 
The delay times between inventories of components have been corrected (these delays allow the HTA to update its GUI with intermediate results).
The new command line switch <code>/NODELAYS</code> will skip those delays (at the risk that impatient users may invalidate the results by clicking because the HTA does not seem to respond).
The two rightmost columns became wider, so the minimum required screen width is now 1024 pixels.

5.212011-06-25
Two minor bugs in the interface were fixed.

5.202011-06-19
Added command line switches <code>/BASIC</code> (select CPU, memory and HDD only), <code>/COMPUTER:<em>name</em></code> (specify computer to be queried, starts inventory immediately), and <code>/COPY</code> (copy the results to the clipboard and terminate the program). 
The command <code>HARDWARE.HTA /COMPUTER:MYPC /COPY /NOUPDCHK</code> will copy the inventory results of computer MYPC to the clipboard. 
The command <code>HARDWARE.HTA /COMPUTER: /BASIC /COPY /NOUPDCHK</code> will copy the <em>very</em> basic inventory results of the <em>local computer</em> to the clipboard.

5.102011-06-16
Now differentiates between IDE and SATA interfaces for harddisks and CDROM drives.

5.002011-06-15
Rewrote the code for multiple instances of components (HDD, CDROM, and video and network adapters). 
Added on screen help (press F1). 
Added several command line switches (pressing F1 will list them all). 
Now displays intermediate results while the inventory is running. 
Can now handle up to 8 harddisks, and up to 4 CDROMs, video cards and/or network adapters.

4.212011-01-12
Fixed a problem with Win32_NetworkAdapter's "PhysicalAdapter" property (which isn't supported in Windows XP).

4.202010-09-26
Improved filtering in case of multiple monitors.
Improved filtering of network adapters (now displays active physical ethernet adapters only).

4.102007-02-15
Added monitors to the inventory.

4.002006-11-11
Added sound cards to the inventory, plus support for multiple video and network adapters.
Removed commas from CSV file to enable more reliable import in spreadsheets.

3.022006-01-15No change log was kept before this version.

<strong>Checksums:</strong>File name:MD5:SHA1:
 hardwinv.zipf2a78ac02e8562c93e5fe41d8dd16652f935f05eb4fb40b738c0d6612e14d2acbcdefed0

Use this HTA to get a basic software inventory of any WMI enabled computer on the network.

<strong>Note:</strong> The software listed is limited to software installed with the Windows Installer.

<img data-src="https://www.robvanderwoude.com/pictures/software302_800x840.jpg" width="800" height="840" />

Usage:

Open the Basic Software Inventory tool by doubleclicking the file software.hta.

Fill in the name or IP address of a remote computer in the "Computer" field at the top of the screen.
Or you can use the "Paste" button at the right of this field to paste the computer name from the clipboard.
Or just leave the "Computer" field empty and use the default: the local computer.

If you only want a limited inventory, use the filter fields.
Filling in "Microsoft" in the "Vendor" field will limit the installed software list to Microsoft software only, filling in "Office" in the "Name" field will limit the list to software packages that have the word "Office" in their name.
The "Name" and "Vendor" filters are case insensitive.
The "Installed Date" field requires a date in YYYYMMDD format, between 19800101 and today, and will limit the output to software installed on that date <em>or later</em>.
The filtering uses an "AND" function, i.e. all filters settings must apply for a software package to match.
Leave a filter field empty if you don't want to filter for its property.

Click the "Go" button to start the inventory.
This may take a couple of seconds or sometimes even minutes.


The "Reset" button clears all fields, so the software will be ready for the next try.

If you want to save the results displayed, you can use the "Copy" button to copy the results to the clipboard in tab delimited format.

Open Notepad or any plain text editor, paste the contents from the clipboard and save the file as a *.csv file.
Open this CSV file in your spreadsheet program or append it (without header) to an existing CSV file for future reference.

Hover your mouse pointer over any field or button to display a short help text in a tooltip.




<h2>&emsp;Change History</h2>
VersionRelease Date(yyyy-mm-dd)Changes
3.022013-12-17Improved update check.
Uses MSIEXEC.EXE's icon instead of the bland MSHTA.EXE icon.
3.012013-03-22Fixed a bug in the install date filter.
3.002013-03-21Software is now listed in sorted order.
Several subroutines were split up and reordered to make the GUI more responsive.
HTML and CSS were modified to make the HTA work with Internet Explorer 10.
2.102007-01-17Added automatic update check.
Added filtering for Vendor Name and Installed Date.
2.002006-01-09No change log was kept before this version.




<!-- Dummy FORM tag, otherwise Netscape won't accept INPUT tags -->
<form name="Download" method="get" action="./files/software.zip">

Download version 3.02 of the Basic Software Inventory:<input type="Submit" value=" Download " />

</form>
<!-- End of dummy form -->





<strong>Checksums:</strong>File name:MD5:SHA1:
 software.zip253f5c9bee38cdb467c0e0a2e4a689bdc4bb2ae292e4d3b415b17e629ac7197c8e8aa0dd





<!-- Dummy FORM tag, otherwise Netscape won't accept INPUT tags -->
<form name="Donate" method="get" action="donate.php">

Make a donation:<input type="Submit" value="    Donate    " />

</form>
<!-- End of dummy form -->








Scripting titlescovering HTAs:         

Scripting titlescovering WMI:         

FREEDBControl.uFREEDB
VBScript Code:

Option Explicit

If WScript.Arguments.Count > 0 Then Syntax

Dim arrCDROMs, i, j, k, objFreeDB, strMsg
i = 0

Const CDDB_MODE_TEST   = 0
Const CDDB_MODE_SUBMIT = 1

' Create a uFREEDB object
Set objFreeDB = CreateObject( "FREEDBControl.uFREEDB" )

With objFreeDB
' Mandatory properties, freedb.freedb.org does not seem to accept the defaults
.AppName      = "QueryCD"
.AppVersion   = "1.01"
.EmailAddress = "test@scripting.eu"
.CDDBServer   = "freedb.freedb.org"
.CDDBMode     = CDDB_MODE_TEST  ' Use CDDB_MODE_SUBMIT only if you need to
  ' submit new or modified CD data to freedb.org

' Get an array with all CDROM drive letters
arrCDROMs = Split( .GetCdRoms, "|" )

' Loop through the array of CDROM drives
For j = 0 To UBound( arrCDROMs )
    ' Media Info "" means there is no CD in drive
    If .GetMediaInfo( arrCDROMs(j) ) &lt;> "" Then
        ' Count the number of CDs found
        i = i + 1
        ' Query the freedb.org database for the CD, based on its TOC
        .LookupMediaByToc .GetMediaTOC( arrCDROMs(j) )
        ' Return Album properties
        strMsg = "The CD in drive " & UCase( arrCDROMs(j) ) _
    & ": is """ & .GetAlbumName & """ by " _
    & .GetArtistName & " (" & .GetAlbumYear & ", " _
    & .GetAlbumGenre & ", " _
    & .SecondsToTimeString( .GetAlbumLength ) & ")" & vbCrLf & vbCrLf
        ' Loop through the list of tracks
        For k = 1 To .GetAlbumTracks
 ' Append track properties
 strMsg = strMsg & "Track " & Right( " " & k, 2 ) & ":  " _
        & .GetTrackName( CInt(k) ) _
        & " (" & .SecondsToTimeString( .GetTrackTime( CInt(k) ) ) & ")" _
        & vbCrLf
        Next
    End If
Next
If i = 0 Then
    strMsg = "No CD found."
End If
End With

' Display the result
WScript.Echo strMsg

' Release the object
Set objFreeDB = Nothing


Sub Syntax
strMsg = "QueryCD.vbs,  Version 1.01" & vbCrLf _
       & "Display album and track properties for all CDs in all CDROM drives" _
       & vbCrLf & vbCrLf _
       & "Usage:  QUERYCD.VBS" & vbCrLf & vbCrLf _
       & "Note:   This script requires ufreedb.ocx" & vbCrLf _
       & "        by Jon F. Zahornacky and Peter Schmiedseder" & vbCrLf _
       & "        http://www.robvanderwoude.com/vbstech_multimedia_freedb.html" _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" & vbCrLf _
       & "http://www.robvanderwoude.com" & vbCrLf
WScript.Echo strMsg
WScript.Quit 1
End Sub

Sample output:

The CD in drive F: is "Colors of a New Dawn" by Gandalf (2004, New Age, 55:29)

Track  1:  Rhythm of the Tides (6:18)
Track  2:  Bridge of Confidence (5:30)
Track  3:  In the Presence of Angels (4:55)
Track  4:  Iris (8:59)
Track  5:  From Distant Shores (6:19)
Track  6:  In the Presence of Angels (reprise) (1:34)
Track  7:  Hearts in Celestial Unison (5:03)
Track  8:  Flowers Along the Way (3:01)
Track  9:  Colors of a New Dawn (6:32)
Track 10:  Brighter than a Star (7:12)
Requirements:
Windows version:any
Network:any
Client software:<a href="./downloads/uFREEDB-1.6.2.zip">uFREEDB.ocx</a>
Script Engine:all
Summarized:Works in all Windows versions, requires
<a href="./downloads/uFREEDB-1.6.2.zip">uFREEDB.ocx</a>.


<h2><k>Resolve Host Names</k></h2>
<a href="http://www.java.com/">JavaWebstart</a>
VBScript Code:

Set objJava = CreateObject( "JavaWebStart.isInstalled" )
strIP = objJava.dnsResolve( "www.google.com" )
WScript.Echo "IP address of www.google.com: " & strIP
Set objJava = Nothing
Requirements:
Windows version:any
Network:TCP/IP
Client software:<a href="http://www.java.com/">Java runtime</a>
Script Engine:any
Summarized:Works in any Windows version with <a href="http://www.java.com/">Java runtime</a> installed.
<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
VBScript Code:

Set objIP = CreateObject( "SScripting.IPNetwork" )
strIP = objIP.DNSLookup( "www.google.com" )
WScript.Echo "IP address of www.google.com: " & strIP
Set objIP = Nothing
Requirements:
Windows version:any
Network:TCP/IP
Client software:<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
Script Engine:any
Summarized:Works in any Windows version with <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a> is installed, with any script engine.




<h2><k>Retrieve Your Computer's IP Address(es)</k></h2>
<a href="http://msdn.microsoft.com/en-us/library/aa394217(VS.85).aspx">Win32_NetworkAdapterConfiguration</a>
VBScript Code:

strQuery = "SELECT * FROM Win32_NetworkAdapterConfiguration WHERE MACAddress > ''"

Set objWMIService = GetObject( "winmgmts://./root/CIMV2" )
Set colItems      = objWMIService.ExecQuery( strQuery, "WQL", 48 )

For Each objItem In colItems
If IsArray( objItem.IPAddress ) Then
    If UBound( objItem.IPAddress ) = 0 Then
        strIP = "IP Address: " & objItem.IPAddress(0)
    Else
        strIP = "IP Addresses: " & Join( objItem.IPAddress, "," )
    End If
End If
Next

WScript.Echo strIP
Requirements:
Windows version:Windows 2000, XP, Server 2003, or Vista
Network:TCP/IP
Client software:N/A
Script Engine:any
Summarized:Works in Windows 2000, XP, Server 2003 and Vista.
<em>Doesn't work in Windows 95, 98, ME or NT 4.</em>




<h2><k>Ping Computers</k></h2>
<a href="http://msdn.microsoft.com/en-us/library/aa394350.aspx">Win32_PingStatus</a>
VBScript Code:

WScript.Echo "www.robvanderwoude.com on-line: " & Ping( "www.robvanderwoude.com" )

Function Ping( myHostName )
' This function returns True if the specified host could be pinged.
' myHostName can be a computer name or IP address.
' The Win32_PingStatus class used in this function requires Windows XP or later.
' This function is based on the TestPing function in a sample script by Don Jones
' http://www.scriptinganswers.com/vault/computer%20management/default.asp#activedirectoryquickworkstationinventorytxt

' Standard housekeeping
Dim colPingResults, objPingResult, strQuery

' Define the WMI query
strQuery = "SELECT * FROM Win32_PingStatus WHERE Address = '" & myHostName & "'"

' Run the WMI query
Set colPingResults = GetObject("winmgmts://./root/cimv2").ExecQuery( strQuery )

' Translate the query results to either True or False
For Each objPingResult In colPingResults
    If Not IsObject( objPingResult ) Then
        Ping = False
    ElseIf objPingResult.StatusCode = 0 Then
        Ping = True
    Else
        Ping = False
    End If
Next

Set colPingResults = Nothing
End Function
Requirements:
Windows version:XP, Server 2003, or Vista
Network:TCP/IP
Client software:N/A
Script Engine:any
Summarized:Works in Windows XP or later.
<em>Doesn't work in Windows 95, 98, ME, NT 4 or 2000.</em>
<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
VBScript Code:

WScript.Echo "www.robvanderwoude.com on-line: " & PingSSR( "www.robvanderwoude.com" )

Function PingSSR( myHostName )
' This function returns True if the specified host could be pinged.
' myHostName can be a computer name or IP address.
' This function requires the System Scripting Runtime by Franz Krainer
' http://www.netal.com/ssr.htm

' Standard housekeeping
Dim objIP

Set objIP = CreateObject( "SScripting.IPNetwork" )

If objIP.Ping( myHostName ) = 0 Then
    PingSSR = True
Else
    PingSSR = False
End If

Set objIP = Nothing
End Function
Requirements:
Windows version:Windows 98, ME, NT 4, 2000, XP, Server 2003 or Vista
Network:TCP/IP
Client software:<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
Script Engine:any
Summarized:Works in Windows 98 and later with <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a> is installed, with any script engine.




<h2><k>Retrieving Names</k></h2>
In this section I'll show you how to retrieve user names, computer names and domain names (user domains, computer domains, ...) and related properties using various techniques.

I'll also try to list all requirements for each technique: OS version, Active Directory/NT domain/workgroup, stand-alone VBScript vs. HTA, and WMI or client software.

So, depending on your environment, you may need to combine several techniques to cover all OS versions and all possible configurations.

To test if any of these techniques work in your environment, I also created a <a href="./files/vbsnames_vbs.txt">script demonstrating each of these techniques</a> (download the <a href="./files/vbsnames.zip">ZIPped source</a> here).




<a href="vbstech_network_names_user.php">User Name</a>

<a href="vbstech_network_names_user.php#EnvVar">Environment Variable</a>
<a href="vbstech_network_names_user.php#WshNetwork">WshNetwork</a>
<a href="vbstech_network_names_user.php#ADSI_NT">ADSI (WinNTSystemInfo)</a>
<a href="vbstech_network_names_user.php#ADSI_AD">ADSI (ADSystemInfo)</a>
<a href="vbstech_network_names_user.php#WMI">WMI (Win32_ComputerSystem)</a>
<a href="vbstech_network_names_user.php#SSR">System Scripting Runtime</a>

<a href="vbstech_network_names_computer.php">Computer Name</a>

<a href="vbstech_network_names_computer.php#EnvVar">Environment Variable</a>
<a href="vbstech_network_names_computer.php#WshNetwork">WshNetwork</a>
<a href="vbstech_network_names_computer.php#ShGina">SHGINA.DLL (Shell.LocalMachine)</a>
<a href="vbstech_network_names_computer.php#ADSI_NT">ADSI (WinNTSystemInfo)</a>
<a href="vbstech_network_names_computer.php#ADSI_AD">ADSI (ADSystemInfo)</a>
<a href="vbstech_network_names_computer.php#WMI">WMI (Win32_ComputerSystem)</a>
<a href="vbstech_network_names_computer.php#SSR">System Scripting Runtime</a>

<a href="vbstech_network_names_hostname.php">Host Names</a>

<a href="vbstech_network_names_hostname.php#WSHShell">Registry (WSH Shell)</a>
<a href="vbstech_network_names_hostname.php#StdRegProv">Registry (WMI StdRegProv)</a>
<a href="vbstech_network_names_hostname.php#SSR">System Scripting Runtime</a>

<a href="vbstech_network_names_domain.php">Computer Domain or Workgroup Name</a>

<a href="vbstech_network_names_domain.php#WMI_Win32_ComputerSystem">WMI (Win32_ComputerSystem)</a>
<a href="vbstech_network_names_domain.php#WMI_Win32_NTDomain">WMI (Win32_NTDomain)</a>
<a href="vbstech_network_names_domain.php#SSR">System Scripting Runtime</a>

<a href="vbstech_network_names_domain.php">User Domain Name</a>

<a href="vbstech_network_names_domain.php#EnvVar">Environment Variable</a>
<a href="vbstech_network_names_domain.php#WshNetwork">WshNetwork</a>
<a href="vbstech_network_names_domain.php#ADSI_NT">ADSI (WinNTSystemInfo)</a>
<a href="vbstech_network_names_domain.php#ADSI_AD">ADSI (ADSystemInfo)</a>



<h2><k>Retrieving the User Name</k></h2>
In this section I'll show you how to retrieve the user name using various scripting techniques.






Environment Variable
VBScript Code:

Set wshShell = CreateObject( "WScript.Shell" )
strUserName = wshShell.ExpandEnvironmentStrings( "%USERNAME%" )
WScript.Echo "User Name: " & strUserName
Requirements:
Windows version:NT 4, 2000, XP, Server 2003, or Vista
Network:Stand-alone, workgroup, NT domain, or AD
Client software:N/A
Script Engine:WSH
Summarized:Works in Windows NT 4 or later, *.vbs with CSCRIPT.EXE or WSCRIPT.EXE only.
<em>Doesn't work in Windows 95, 98 or ME, nor in Internet Explorer (HTAs).</em>
WshNetwork
VBScript Code:

Set wshNetwork = CreateObject( "WScript.Network" )
strUserName = wshNetwork.UserName
WScript.Echo "User Name: " & strUserName
Requirements:
Windows version:Windows 98, ME, NT 4, 2000, XP, Server 2003, Vista
Network:Stand-alone, workgroup, NT domain, or AD
Client software:Windows Script 5.6 for Windows 98, ME, and NT 4 (no longer available for download?)
Script Engine:WSH
Summarized:Works in Windows 98 or later, *.vbs with CSCRIPT.EXE or WSCRIPT.EXE only.
<em>Doesn't work in Windows 95, nor in Internet Explorer (HTAs).</em>
ADSI (WinNTSystemInfo)
VBScript Code:

Set objSysInfo = CreateObject( "WinNTSystemInfo" )
strUserName = objSysInfo.UserName
WScript.Echo "User Name: " & strUserName
Requirements:
Windows version:2000, XP, Server 2003, or Vista (95, 98, ME, NT 4 with <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a>)
Network:Stand-alone, workgroup, NT domain, or AD
Client software:<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> for Windows 95, 98, ME or NT 4
Script Engine:any
Summarized:Can work in any Windows version, but <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> is required for Windows 95, 98, ME or NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
ADSI (ADSystemInfo)
VBScript Code:

Set objSysInfo = CreateObject( "ADSystemInfo" )
strUserName = objSysInfo.UserName
WScript.Echo "User Name: " & strUserName
Requirements:
Windows version:2000, XP, Server 2003, or Vista (95, 98, ME, NT 4 with <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a>)
Network:Only AD domain members
Client software:<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> for Windows 95, 98, ME or NT 4
Script Engine:any
Summarized:For AD domain members only.
Can work in any Windows version, but <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> is required for Windows 95, 98, ME or NT 4 SP4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<em>Doesn't work on stand-alones, workgroup members or members of NT domains.</em>
WMI (Win32_ComputerSystem)
VBScript Code:

Set objWMIService = GetObject( "winmgmts:\\.\root\cimv2" )
Set colItems = objWMIService.ExecQuery( "Select * from Win32_ComputerSystem" )
For Each objItem in colItems
strUserName = objItem.UserName
WScript.Echo "User Name: " & strUserName
Next
Requirements:
Windows version:ME, 2000, XP, Server 2003, or Vista (95, 98, NT 4 with
<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a>)
Network:Stand-alone, workgroup, NT domain, or AD
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI
CORE 1.5</a> for Windows 95, 98 or NT 4
Script Engine:any
Summarized:Can work on any Windows computer, but <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> is required for Windows 95, 98 or NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
VBScript Code:

Set objSys = CreateObject( "SScripting.System" )
strUserName = objSys.UserName
WScript.Echo "User Name: " & strUserName
Requirements:
Windows version:any
Network:TCP/IP
Client software:<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
Script Engine:any
Summarized:Works in any Windows version with <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a> is installed, with any script engine.




<h2><k>Retrieving the Computer Name</k></h2>
In this section I'll show you how to retrieve a computer name using various scripting techniques.






Environment Variable
VBScript Code:

Set wshShell = CreateObject( "WScript.Shell" )
strComputerName = wshShell.ExpandEnvironmentStrings( "%COMPUTERNAME%" )
WScript.Echo "Computer Name: " & strComputerName
Requirements:
Windows version:NT 4, 2000, XP, Server 2003, or Vista
Network:Stand-alone, workgroup, NT domain, or AD
Client software:N/A
Script Engine:WSH
Summarized:Works in Windows NT 4 or later, *.vbs with CSCRIPT.EXE or WSCRIPT.EXE only.
<em>Doesn't work in Windows 95, 98 or ME, nor in Internet Explorer (HTAs).</em>
WshNetwork
VBScript Code:

Set wshNetwork = CreateObject( "WScript.Network" )
strComputerName = wshNetwork.ComputerName
WScript.Echo "Computer Name: " & strComputerName
Requirements:
Windows version:Windows 98, ME, NT 4, 2000, XP, Server 2003, Vista
Network:Stand-alone, workgroup, NT domain, or AD
Client software:Windows Script 5.6 for Windows 98, ME, and NT 4 (no longer available for download?)
Script Engine:WSH
Summarized:Works in Windows 98 or later, *.vbs with CSCRIPT.EXE or WSCRIPT.EXE only.
<em>Doesn't work in Windows 95, nor in Internet Explorer (HTAs).</em>
SHGINA.DLL (Shell.LocalMachine)
VBScript Code:

Set objPC = CreateObject( "Shell.LocalMachine" )
strComputerName = objPC.MachineName
WScript.Echo "Computer Name: " & strComputerName

Requirements:
Windows version:XP (not sure about other Windows versions)
Network:Stand-alone, workgroup, NT domain, or AD
Client software:N/A
Script Engine:any
Summarized:Works in Windows XP, <em>may or may not</em> work in Windows NT 4, 2000, Server 2003 and Vista.
<em>Doesn't work in Windows 95, 98 or ME.</em>
ADSI (WinNTSystemInfo)
VBScript Code:

Set objSysInfo = CreateObject( "WinNTSystemInfo" )
strComputerName = objSysInfo.ComputerName
WScript.Echo "Computer Name: " & strComputerName
Requirements:
Windows version:2000, XP, Server 2003, or Vista (95, 98, ME, NT 4 with
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active
Directory client extension</a>)
Network:Stand-alone, workgroup, NT domain, or AD
Client software:<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active
Directory client extension</a> for Windows 95, 98, ME or NT 4
Script Engine:any
Summarized:Can work in any Windows version, but <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> is required for Windows 95, 98, ME or NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
ADSI (ADSystemInfo)
VBScript Code:

Set objSysInfo = CreateObject( "ADSystemInfo" )
strComputerName = objSysInfo.ComputerName
WScript.Echo "Computer Name: " & strComputerName
Requirements:
Windows version:2000, XP, Server 2003, or Vista (95, 98, ME, NT 4 with <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a>)
Network:Only AD domain members
Client software:<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> for Windows 95, 98, ME or NT 4
Script Engine:any
Summarized:For AD domain members only.
Can work in any Windows version, but <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> is required for Windows 95, 98, ME or NT 4 SP4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<em>Doesn't work on stand-alones, workgroup members or members of NT domains.</em>
WMI (Win32_ComputerSystem)
VBScript Code:

Set objWMIService = GetObject( "winmgmts:\\.\root\cimv2" )
Set colItems = objWMIService.ExecQuery( "Select * from Win32_ComputerSystem" )
For Each objItem in colItems
strComputerName = objItem.Name
WScript.Echo "Computer Name: " & strComputerName
Next
Requirements:
Windows version:ME, 2000, XP, Server 2003, or Vista (95, 98, NT 4 with <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a>)
Network:Stand-alone, workgroup, NT domain, or AD
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> for Windows 95, 98 or NT 4
Script Engine:any
Summarized:Can work on any Windows computer, but <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> is required for Windows 95, 98 or NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
VBScript Code:

Set objLM = CreateObject( "SScripting.LMNetwork" )
strComputerName = objLM.ComputerName
WScript.Echo "Computer Name: " & ComputerName
Requirements:
Windows version:any
Network:NETBIOS
Client software:<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
Script Engine:any
Summarized:Works in any Windows version with <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a> is installed, with any script engine, except maybe Novell networks.




<h2><k>Retrieving the Host Name</k></h2>
Registry (WSH Shell)
VBScript Code:

Set wshShell = CreateObject( "WScript.Shell" )
strRegValue = "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Hostname"
strHostName = wshShell.RegRead( strRegValue )
WScript.Echo "Host Name: " & strHostName
Requirements:
Windows version:NT 4, 2000, XP, Server 2003, or Vista
Network:TCP/IP
Client software:Windows Script 5.6 for Windows NT 4 (no longer available for download?)
Script Engine:WSH
Summarized:Works in Windows NT 4 or later, requires a TCP/IP network, works with CSCRIPT.EXE or WSCRIPT.EXE only.
Will require Windows Script 5.6 for Windows NT 4 to make it work in NT 4 (no longer available for download?).
Registry (WMI StdRegProv)
VBScript Code:

Const HKEY_LOCAL_MACHINE = &H80000002
strRegKey = "SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
Set objReg = GetObject( "winmgmts:{impersonationLevel=impersonate}!//./root/default:StdRegProv" )
objReg.GetStringValue HKEY_LOCAL_MACHINE, strRegKey, "Hostname", strHostname
WScript.Echo "Host Name: " & strHostName
Requirements:
Windows version:ME, 2000, XP, Server 2003, or Vista (95, 98, NT 4 with <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a>)
Network:TCP/IP
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> for Windows 95, 98 or NT 4
Script Engine:any
Summarized:Can work on any Windows computer, but
<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> is required for Windows 95, 98 or NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
VBScript Code:

Set objIP = CreateObject( "SScripting.IPNetwork" )
strHostName = objIP.Hostname
WScript.Echo "Host Name: " & strHostName
Requirements:
Windows version:any
Network:TCP/IP
Client software:<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
Script Engine:any
Summarized:Works in any Windows version with <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a> is installed, with any script engine.




<h2><k>Retrieving the User Domain,Computer Domain or Work group Name</k></h2>
In this section I'll show you how to retrieve the (user or computer) domain or workgroup name using various scripting techniques.




Environment Variable
VBScript Code:

Set wshShell = CreateObject( "WScript.Shell" )
strUserDomain = wshShell.ExpandEnvironmentStrings( "%USERDOMAIN%" )
WScript.Echo "User Domain: " & strUserDomain
Requirements:
Windows version:NT 4, 2000, XP, Server 2003, Vista or Server 2008
Network:Stand-alone, workgroup, NT domain, or AD
Client software:N/A
Script Engine:WSH
Summarized:Works in Windows NT 4 or later, *.vbs with CSCRIPT.EXE or WSCRIPT.EXE only.
<em>Doesn't work in Windows 95, 98 or ME, nor in Internet Explorer (HTAs).</em>
WshNetwork
VBScript Code:

Set wshNetwork = CreateObject( "WScript.Network" )
strUserDomain = wshNetwork.UserDomain
WScript.Echo "User Domain: " & strUserDomain
Requirements:
Windows version:Windows 98, ME, NT 4, 2000, XP, Server 2003, Vista, Server 2008
Network:Stand-alone, workgroup, NT domain, or AD
Client software:Windows Script 5.6 for Windows 98, ME, and NT 4 (no longer available for download?)
Script Engine:WSH
Summarized:Works in Windows 98 or later, *.vbs with CSCRIPT.EXE or WSCRIPT.EXE only.
<em>Doesn't work in Windows 95, nor in Internet Explorer (HTAs).</em>
ADSI (WinNTSystemInfo)
VBScript Code:

Set objSysInfo = CreateObject( "WinNTSystemInfo" )
strUserDomain = objSysInfo.DomainName
WScript.Echo "User Domain: " & strUserDomain
Requirements:
Windows version:2000, XP, Server 2003, Vista or Server 2008 (95, 98, ME, NT 4 with <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a>)
Network:Stand-alone, workgroup, NT domain, or AD
Client software:<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> for Windows 95, 98, ME or NT 4
Script Engine:any
Summarized:Can work in any Windows version, but <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> is required for Windows 95, 98, ME or NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
ADSI (ADSystemInfo)
VBScript Code:

Set objSysInfo = CreateObject( "ADSystemInfo" )
strUserDomain = objSysInfo.DomainName
WScript.Echo "User Domain: " & strUserDomain
Requirements:
Windows version:2000, XP, Server 2003, Vista or Server 2008 (95, 98, ME, NT 4 with <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a>)
Network:Only AD domain members
Client software:<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> for Windows 95, 98, ME or NT 4
Script Engine:any
Summarized:For AD domain members only.
Can work in any Windows version, but <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> is required for Windows 95, 98, ME or NT 4 SP4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<em>Doesn't work on standalones, workgroup members or members of NT domains.</em>
WMI (Win32_ComputerSystem)
VBScript Code:

Set objWMISvc = GetObject( "winmgmts:\\.\root\cimv2" )
Set colItems  = objWMISvc.ExecQuery( "Select * from Win32_ComputerSystem" )
For Each objItem in colItems
strComputerDomain = objItem.Domain
If objItem.PartOfDomain Then
    WScript.Echo "Computer Domain: " & strComputerDomain
Else
    WScript.Echo "Workgroup: " & strComputerDomain
End If
Next
Requirements:
Windows version:XP, Server 2003, Vista or Server 2008
Network:Stand-alone, workgroup, NT domain, or AD
Client software:N/A
Script Engine:any
Summarized:Works in Windows XP and later.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
WMI (Win32_NTDomain)
VBScript Code:

Set objWMIService = GetObject( "winmgmts:\\.\root\cimv2" )
Set colItems = objWMIService.ExecQuery( "Select * from Win32_NTDomain" )
For Each objItem in colItems
strComputerDomain = objItem.DomainName
WScript.Echo "Computer Domain: " & strComputerDomain
Next
Requirements:
Windows version:XP, Server 2003, Vista or Server 2008
Network:NT domain, or AD
Client software:N/A
Script Engine:any
Summarized:Will work only on AD or NT domain members running Windows XP or later.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<em>Doesn't work in Windows 95, 98, ME, NT 4, or 2000.
Doesn't work on standalones or workgroup members.</em>
<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
VBScript Code:

Set objIP = CreateObject( "SScripting.IPNetwork" )
strComputerDomain = objIP.Domain
WScript.Echo "Computer Domain: " & strComputerDomain
Requirements:
Windows version:any
Network:TCP/IP
Client software:<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
Script Engine:any
Summarized:Works in any Windows version with <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a> is installed, with any script engine.




<h2><k>Retrieving the User Domain,Computer Domain or Work group Name</k></h2>
In this section I'll show you how to retrieve the (user or computer) domain or workgroup name using various scripting techniques.






Environment Variable
VBScript Code:

Set wshShell = CreateObject( "WScript.Shell" )
strUserDomain = wshShell.ExpandEnvironmentStrings( "%USERDOMAIN%" )
WScript.Echo "User Domain: " & strUserDomain
Requirements:
Windows version:NT 4, 2000, XP, Server 2003, Vista or Server 2008
Network:Stand-alone, workgroup, NT domain, or AD
Client software:N/A
Script Engine:WSH
Summarized:Works in Windows NT 4 or later, *.vbs with CSCRIPT.EXE or WSCRIPT.EXE only.
<em>Doesn't work in Windows 95, 98 or ME, nor in Internet Explorer (HTAs).</em>
WshNetwork
VBScript Code:

Set wshNetwork = CreateObject( "WScript.Network" )
strUserDomain = wshNetwork.UserDomain
WScript.Echo "User Domain: " & strUserDomain
Requirements:
Windows version:Windows 98, ME, NT 4, 2000, XP, Server 2003, Vista, Server 2008
Network:Stand-alone, workgroup, NT domain, or AD
Client software:Windows Script 5.6 for Windows 98, ME, and NT 4 (no longer available for download?)
Script Engine:WSH
Summarized:Works in Windows 98 or later, *.vbs with CSCRIPT.EXE or WSCRIPT.EXE only.
<em>Doesn't work in Windows 95, nor in Internet Explorer (HTAs).</em>
ADSI (WinNTSystemInfo)
VBScript Code:

Set objSysInfo = CreateObject( "WinNTSystemInfo" )
strUserDomain = objSysInfo.DomainName
WScript.Echo "User Domain: " & strUserDomain
Requirements:
Windows version:2000, XP, Server 2003, Vista or Server 2008 (95, 98, ME, NT 4 with <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a>)
Network:Stand-alone, workgroup, NT domain, or AD
Client software:<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> for Windows 95, 98, ME or NT 4
Script Engine:any
Summarized:Can work in any Windows version, but <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> is required for Windows 95, 98, ME or NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
ADSI (ADSystemInfo)
VBScript Code:

Set objSysInfo = CreateObject( "ADSystemInfo" )
strUserDomain = objSysInfo.DomainName
WScript.Echo "User Domain: " & strUserDomain
Requirements:
Windows version:2000, XP, Server 2003, Vista or Server 2008 (95, 98, ME, NT 4 with <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a>)
Network:Only AD domain members
Client software:<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> for Windows 95, 98, ME or NT 4
Script Engine:any
Summarized:For AD domain members only.
Can work in any Windows version, but <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;288358">Active Directory client extension</a> is required for Windows 95, 98, ME or NT 4 SP4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<em>Doesn't work on standalones, workgroup members or members of NT domains.</em>
WMI (Win32_ComputerSystem)
VBScript Code:

Set objWMISvc = GetObject( "winmgmts:\\.\root\cimv2" )
Set colItems  = objWMISvc.ExecQuery( "Select * from Win32_ComputerSystem" )
For Each objItem in colItems
strComputerDomain = objItem.Domain
If objItem.PartOfDomain Then
    WScript.Echo "Computer Domain: " & strComputerDomain
Else
    WScript.Echo "Workgroup: " & strComputerDomain
End If
Next
Requirements:
Windows version:XP, Server 2003, Vista or Server 2008
Network:Stand-alone, workgroup, NT domain, or AD
Client software:N/A
Script Engine:any
Summarized:Works in Windows XP and later.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
WMI (Win32_NTDomain)
VBScript Code:

Set objWMIService = GetObject( "winmgmts:\\.\root\cimv2" )
Set colItems = objWMIService.ExecQuery( "Select * from Win32_NTDomain" )
For Each objItem in colItems
strComputerDomain = objItem.DomainName
WScript.Echo "Computer Domain: " & strComputerDomain
Next
Requirements:
Windows version:XP, Server 2003, Vista or Server 2008
Network:NT domain, or AD
Client software:N/A
Script Engine:any
Summarized:Will work only on AD or NT domain members running Windows XP or later.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.
<em>Doesn't work in Windows 95, 98, ME, NT 4, or 2000.
Doesn't work on standalones or workgroup members.</em>
<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
VBScript Code:

Set objIP = CreateObject( "SScripting.IPNetwork" )
strComputerDomain = objIP.Domain
WScript.Echo "Computer Domain: " & strComputerDomain
Requirements:
Windows version:any
Network:TCP/IP
Client software:<a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a>
Script Engine:any
Summarized:Works in any Windows version with <a href="http://www.netal.com/ssr.htm">System Scripting Runtime</a> is installed, with any script engine.




<h2><k>Login Scripts</k></h2>
Login scripts can be used for many purposes:


<a href="#ConnectDrives">Connect</a> & <a href="#DisconnectDrives">disconnect</a> <a href="#Drives">network drives</a>
<a href="#ConnectPrinters">Connect</a> & <a href="#DisconnectPrinters">disconnect</a> <a href="#Printers">network printers</a>, and <a href="#DefaultPrinter">set the default printer</a>
<a href="#LogAccess">Log access to computers</a>
<a href="#LogStatus">Log the status of computers</a>
<a href="#UpdateSettings">Update user or computer settings</a>
And I'm sure there's more...
Make sure you read these <a href="#BestPractices">tips and best practices to prevent common mistakes</a>


You are completely free to choose any scripting language for your login script... you may even use an executable as your login "script".
Keep in mind, however, that login scripts tend to be long-lived: they may survive multiple OS and hardware updates in your domain.
Batch commands are often broken in OS updates.
This makes batch files less suitable candidates for login script.
Besides, because of being long-lived, several "generations" of administrators may have to edit and maintain the login script's code, so both the scripting language and the script itself need to be well documented -- another reason <em>not</em> to choose for batch files as login scripts.

Many companies <em>do</em> use a batch file as their login script, but in most cases this batch file serves only as a "wrapper" to start he "real" login script, e.g. <code>@KIX32.EXE login.kix</code> or <code>@CSCRIPT.EXE //NoLogo login.vbs</code> or <code>@REGINA.EXE login.rex</code> or <code>@PERL.EXE login.pl</code>.

PowerShell may be a viable option to use for login scripts, but remember it isn't installed by default on Windows XP and older versions, and even <em>if</em> installed, its settings for running scripts needs to be properly configured (not the default settings).
Besides, some major "breaking" changes were introduced in PowerShell 6 (e.g. <code>Get-WmiObject</code> was replaced by <code>Get-CimInstance</code>), so you may need to check the PowerShell version on the computer running the script, and supply code for PowerShell 2..5 as well as for 6..7.

On this page, the main focus will be on login script snippets in <a href="kixtartstart.php">KiXtart</a> (version 4.60) and <a href="wshstart.php">VBScript</a> (<abbr title="WSH = Windows Script Host">WSH</abbr> version 5.6 or 5.7), with only a limited number of (NT) batch and PowerShell snippets.
I will also assume that all workstations run Windows 2000 or a more recent Windows version.

<!--script type="text/javascript">displaybuttons( );</script-->

For your convenience, you can hide or reveal the code snippets for any of these languages by using the buttons below.


<input type="button" id="HideBatch" onclick="hide('Batch')" value="Hide NT batch code" />
<input type="button" id="UnhideBatch" onclick="unhide('Batch')" value="Display NT batch code" />
<input type="button" id="HideKiXtart" onclick="hide('KiXtart')" value="Hide KiXtart code" />
<input type="button" id="UnhideKiXtart" onclick="unhide('KiXtart')" value="Display KiXtart code" />
<input type="button" id="HidePowerShell" onclick="hide('PowerShell')" value="Hide PowerShell code" />
<input type="button" id="UnhidePowerShell" onclick="unhide('PowerShell')" value="Display PowerShell code" />
<input type="button" id="HideVBScript" onclick="hide('VBScript')" value="Hide VBScript code" />
<input type="button" id="UnhideVBScript" onclick="unhide('VBScript')" value="Display VBScript code" />




Note:Many of the snippets <em>can</em> be used on older Windows versions too, but keep in mind that:
a.many variables won't have a value till <em>after</em> the logon process is finished; some will never have a value at all
b.WMI may not be installed by default in these Windows versions
c.an <a href="http://msdn.microsoft.com/en-us/library/x66z77t4(VS.85).aspx">older version</a> of Windows Script Host may be installed by default
d.NT batch files will <em>not</em> run correctly on Windows 9*/ME; if you <em>do</em> use an NT batch file as login script, use a .CMD extension instead of .BAT
e.A PowerShell script requires PowerShell to be installed, execution of PowerShell scripts to be allowed by the <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.2">execution policy</a>, and the script's code to be compatible with the PowerShell version installed.


<h2 id="Drives">&emsp;1. Network Drives</h2>
<h3 id="ConnectDrives">Connect network drives</h3>
<h4>Batch: connect network drives</h4>
NET USE G: \\CompanyServer\Dept /PERSISTENT:No
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/errorlevel.html"><span>ERRORLEVEL</span></a> 1 <span>(</span>
<a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a> Error mapping drive G:
<span>)</span>

NET USE H: \\CompanyServer\<span>%UserName%</span> /PERSISTENT:No
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/errorlevel.html"><span>ERRORLEVEL</span></a> 1 <span>(</span>
<a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a> Error mapping drive H:
<span>)</span>



<h4>KiXtart: connect network drives</h4>
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> G<span>:</span> <span>"\\CompanyServer\Dept"</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <span>@ERROR</span> <span>&lt;></span> <span>0</span>
<span>"Error @ERROR mapping drive G:@CRLF"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> H<span>:</span> <span>"\\CompanyServer\@HOMESHR"</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <span>@ERROR</span> <span>&lt;></span> <span>0</span>
<span>"Error @ERROR mapping drive H:@CRLF"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>



<h4>PowerShell: connect network drives</h4>
try <span>&#123;</span>
New<span>-</span>SmbMapping <span>-</span>LocalPath <span>'G:'</span> <span>-</span>RemotePath <span>'\\CompanyServer\Dept'</span>
<span>&#125;</span>
catch <span>&#123;</span>
<span>Write-Host</span> <span>'Error mapping drive G:'</span>
<span>Write-Host</span> <a href="about:blank"><span>$_</span></a>
<span>&#125;</span>

try <span>&#123;</span>
New<span>-</span>SmbMapping <span>-</span>LocalPath <span>'H:'</span> <span>-</span>RemotePath <span>"\\CompanyServer\$Env:UserName"</span>
<span>&#125;</span>
catch <span>&#123;</span>
<span>Write-Host</span> <span>'Error mapping drive H:'</span>
<span>Write-Host</span> <a href="about:blank"><span>$_</span></a>
<span>&#125;</span>



<h4>VBScript: connect network drives</h4>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
<span>On</span> <span>Error</span> <span>Resume</span> <span>Next</span>

<span>With</span> wshNetwork
<span>.MapNetworkDrive</span> <span>"G:"</span>, <span>"\\CompanyServer\Dept"</span>
<span>If</span> Err <span>Then</span>
WScript<span>.Echo</span> <span>"Error "</span> & Err & <span>" mapping drive G:"</span>
WScript<span>.Echo</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
<span>End</span> <span>If</span>

<span>.MapNetworkDrive</span> <span>"H:"</span>, <span>"\\CompanyServer\"</span> & <span>.UserName</span>
<span>If</span> Err <span>Then</span>
WScript<span>.Echo</span> <span>"Error "</span> & Err & <span>" mapping drive H:"</span>
WScript<span>.Echo</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
<span>End</span> <span>If</span>
<span>End</span> <span>With</span>

<span>On</span> <span>Error</span> <span>Goto</span> <span>0</span>
<span>Set</span> wshNetwork = <span>Nothing</span>


Instead of "annoying" the user with the details of mapping drives, consider logging error messages and the results to a log file on the local computer.
In case of errors, set a variable named <code>Error</code> and, at the end of the login script, display a message telling the user to contact the helpdesk.


<h4>KiXtart: connect drives with logging</h4>
<span>; It doesn't hurt to make sure the C:\temp folder exists</span>
<a href="http://www.kixtart.org/manual/Commands/md.htm"><span>MD</span></a> <span>"C:\temp"</span>

<span>; Redirect messages to a log file, display</span>
<span>; a message dialog if redirection fails</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"C:\temp\login.log"</span>, <span>1</span> <span>&#41;</span> <span>&lt;></span> <span>0</span>
$Msg = <span>"Error logging the results.@CRLF"</span>
$Msg = $Msg <span>+</span> <span>"Please notify the helpdesk.@CRLF"</span>
$Msg = $Msg <span>+</span> <span>"For now, results will be displayed on screen."</span>
$RC  = <a href="http://www.kixtart.org/manual/Functions/messagebox.htm"><span>MessageBox</span></a><span>&#40;</span> $Msg, <span>"Log File Error"</span>, <span>64</span>, <span>300</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

$Error = <span>0</span>

<span>; Map drive G: to the department share</span>
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> G<span>:</span> <span>"\\CompanyServer\Dept"</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <span>@ERROR</span> <span>&lt;></span> <span>0</span>
<span>"Error @ERROR while trying to map drive G:@CRLF"</span>
$Error = $Error <span>+</span> <span>1</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<span>; Map drive H: to the user's home share</span>
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> H<span>:</span> <span>"\\CompanyServer\@HOMESHR"</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <span>@ERROR</span> <span>&lt;></span> <span>0</span>
<span>"Error @ERROR while trying to map drive H: to the homedir@CRLF"</span>
$Error = $Error <span>+</span> <span>1</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<span>; List all mappings</span>
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> List

<span>; End redirection</span>
$RC = <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"</span> <span>&#41;</span>

<span>; Warn the user if (an) error(s) occurred</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> $Error <span>></span> <span>0</span>
$Msg = <span>"$Error error(s) occurred during login.@CRLF"</span>
$Msg = $Msg <span>+</span> <span>"The errors are logged to be "</span>
$Msg = $Msg <span>+</span> <span>"reviewed by the helpdesk staff.@CRLF"</span>
$Msg = $Msg <span>+</span> <span>"Please notify the helpdesk.@CRLF"</span>
$RC  = <a href="http://www.kixtart.org/manual/Functions/messagebox.htm"><span>MessageBox</span></a><span>&#40;</span> $Msg, <span>"Login Error"</span>, <span>64</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>



<h4>PowerShell: connect drives with logging</h4>
<span># It doesn't hurt to make sure the C:\temp folder exists</span>
<span>if</span> <span>&#40;</span> <span>!&#40;</span> <span>Test-Path</span> <span>-Path</span> <span>'C:\Temp'</span> <span>-PathType</span> <span>'Container'</span> <span>&#41;</span> <span>&#41;</span> <span>&#123;</span>
<span>New-Item</span> <span>-Path</span> <span>'C:\'</span> <span>-Name</span> <span>'Temp'</span> <span>-ItemType</span> <span>'directory'</span>
<span>&#125;</span>

<span># Delete an existing log file if necessary</span>
<span>if</span> <span>&#40;</span> <span>Test-Path</span> <span>-Path</span> <span>'C:\Temp\login.log'</span> <span>-PathType</span> <span>'Any'</span> <span>&#41;</span> <span>&#123;</span>
<span>Remove-Item</span> <span>-LiteralPath</span> <span>'C:\Temp\login.log'</span> <span>-Force</span>
<span>&#125;</span>

<span># Start with a clean slate</span>
<a href="about:blank"><span>$Error</span></a>.<span>Clear&#40;</span> <span>&#41;</span>

<span># Map drive G: to the department share</span>
try <span>&#123;</span>
New<span>-</span>SmbMapping <span>-</span>LocalPath <span>'G:'</span> <span>-</span>RemotePath <span>'\\CompanyServer\Dept'</span>
<span>&#125;</span>
catch <span>&#123;</span>
<span>"Error mapping drive G:<span>`n</span>$_"</span> <span>|</span> <span>Out<span>-File</span></span> <span>-FilePath</span> <span>'C:\Temp\login.log'</span> <span>-Append</span>
<span>&#125;</span>

<span># Map drive H: to the user's home share</span>
try <span>&#123;</span>
New<span>-</span>SmbMapping <span>-</span>LocalPath <span>'H:'</span> <span>-</span>RemotePath <span>"\\CompanyServer\$Env:UserName"</span>
<span>&#125;</span>
catch <span>&#123;</span>
<span>"Error mapping drive H:<span>`n</span>$_"</span> <span>|</span> <span>Out<span>-File</span></span> <span>-FilePath</span> <span>'C:\Temp\login.log'</span> <span>-Append</span>
<span>&#125;</span>

<span># List all mappings</span>
Get<span>-</span>SmbMapping <span>|</span> <span>Out<span>-File</span></span> <span>-FilePath</span> <span>'C:\Temp\login.log'</span> <span>-Append</span>

<span># Warn the user if (an) error(s) occurred</span>
<span>if</span> <span>&#40;</span> <a href="about:blank"><span>$Error</span></a> <span>&#41;</span> <span>&#123;</span>
<span>$Msg</span>  = <span>"Errors occurred during login.<span>`n</span>"</span>
<span>$Msg</span> <span>+=</span> <span>"The errors are logged to be reviewed by the helpdesk staff.<span>`n</span>"</span>
<span>$Msg</span> <span>+=</span> <span>"Please notify the helpdesk."</span>
<span>&#91;</span>void<span>&#93;</span> <span>&#91;</span>System.Windows.MessageBox<span>&#93;</span>::Show<span>&#40;</span> <span>$Msg,</span> <span>"Login Error",</span> <span>"OK",</span> <span>"Warning"</span> <span>&#41;</span>
<a href="about:blank"><span>$Host</span></a>.SetShouldExit<span>&#40;</span> <span>-1</span> <span>&#41;</span>
<span>&#125;</span>



<h4>VBScript: connect drives with logging</h4>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
<span>Set</span> objFSO     = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;</span>

<span>' It doesn't hurt to make sure the C:\temp folder exists</span>
<span>If</span> <span>Not</span> objFSO<span>.FolderExists&#40;</span> <span>"C:\temp"</span> <span>&#41;</span> <span>Then</span>
<span>Set</span> objTempFolder = objFSO<span>.CreateFolder&#40;</span> <span>"C:\temp"</span> <span>&#41;</span>
<span>Set</span> objTempFolder = <span>Nothing</span>
<span>End</span> <span>If</span>

<span>On</span> <span>Error</span> <span>Resume</span> <span>Next</span>

<span>' Open a log file, display a message dialog in case of error</span>
<span>Set</span> objLogFile = objFSO<span>.CreateTextFile&#40;</span> <span>"C:\temp\login.log"</span>, <span>True</span>, <span>False</span> <span>&#41;</span>
<span>If</span> Err <span>Then</span>
strMsg = <span>"Error logging the results."</span>  & vbCrLf _
   & <span>"Please notify the helpdesk."</span> & vbCrLf _
   & <span>"For now, results will be displayed on screen."</span>
MsgBox strMsg, <span>"Log File Error"</span>, <span>64</span>
<span>End</span> <span>If</span>

intError = <span>0</span>

<span>With</span> wshNetwork
<span>' Map drive G: to the department share</span>
<span>.MapNetworkDrive</span> <span>"G:"</span>, <span>"\\CompanyServer\Dept"</span>
<span>If</span> Err <span>Then</span>
objLogFile<span>.WriteLine</span> <span>"Error "</span> & Err & <span>" mapping drive G:"</span>
objLogFile<span>.WriteLine</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
intError = intError <span>+</span> <span>1</span>
<span>End</span> <span>If</span>

<span>' Map drive H: to the user's home share</span>
<span>.MapNetworkDrive</span> <span>"H:"</span>, <span>"\\CompanyServer\"</span> & <span>.UserName</span>
<span>If</span> Err <span>Then</span>
objLogFile<span>.WriteLine</span> <span>"Error "</span> & Err & <span>" mapping drive H:"</span>
objLogFile<span>.WriteLine</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
intError = intError <span>+</span> <span>1</span>
<span>End</span> <span>If</span>
<span>End</span> <span>With</span>

<span>On</span> <span>Error</span> <span>Goto</span> <span>0</span>

<span>' List all drive mappings</span>
<span>With</span> wshNetwork<span>.EnumNetworkDrives</span>
<span>For</span> i = <span>0</span> <span>To</span> <span>.Count</span> <span>-</span> <span>2</span> <span>Step</span> <span>2</span>
objLogFile<span>.WriteLine</span> <span>.Item&#40;</span>i<span>&#41;</span> & <span>" "</span> & <span>.Item&#40;</span>i<span>+1&#41;</span>
<span>Next</span>
<span>End</span> <span>With</span>

<span>' Close the log file</span>
objLogFile<span>.Close</span>
<span>Set</span> objLogFile = <span>Nothing</span>

<span>' Warn the user if (an) error(s) occurred</span>
<span>If</span> intError <span>></span> <span>0</span> <span>Then</span>
strMsg = intError & <span>" error(s) occurred during login."</span> & vbCrLf _
   & <span>"The errors are logged to be reviewed "</span> _
   & <span>"by the helpdesk staff."</span> & vbCrLf _
   & <span>"Please notify the helpdesk."</span>
MsgBox strMsg, <span>"Login Error"</span>, <span>64</span>
<span>End</span> <span>If</span>

<span>Set</span> objFSO     = <span>Nothing</span>
<span>Set</span> wshNetwork = <span>Nothing</span>


Often network drives are mapped based on group membership (or, for <abbr title="AD = Active Directory">AD</abbr> domains, on <abbr title="OU = Organizational Unit">OU</abbr>):


<h4>Batch: connect drives based on group membership</h4>
NET GROUP Marketing /DOMAIN <span>|</span> FINDSTR /R /I /B /C:"<span>%UserName%</span>$" <span>></span><a href="http://www.ss64.com/nt/nul.html"><span>NUL</span></a>
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/not.html"><span>NOT</span></a> <a href="http://www.ss64.com/nt/errorlevel.html"><span>ERRORLEVEL</span></a> 1 <span>(</span>
NET USE G: \\Server\Marketing /PERSISTENT:No
<span>)</span>

Note:Though this will usually work, it may fail if ampersands, carets, percent or dollar signs are used in group or user names.
<em>Not recommended!</em>




<h4>KiXtart: connect drives based on group membership</h4>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/ingroup.htm"><span>InGroup</span></a><span>&#40;</span> <span>"Marketing"</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> M<span>:</span> <span>"\\CompanyServer\Marketing"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>



<h4>PowerShell: connect drives based on group membership</h4>
<span># Local group</span>
<span># Source: https://morgantechspace.com/2017/10/check-if-user-is-member-of-local-group-powershell.html</span>
<span>$groupObj</span> = <span>&#91;</span>ADSI<span>&#93;"WinNT://./Administrators,group"</span>
<span>$membersObj</span> = <span>@&#40;</span> <span>$groupObj</span>.psbase.Invoke<span>&#40;</span> <span>"Members"</span> <span>&#41;</span> <span>&#41;</span>
<span>$members</span> = <span>&#40;</span> <span>$membersObj</span> <span>|</span> <span>ForEach-Object</span> <span>&#123;</span> <a href="about:blank"><span>$_</span></a>.GetType<span>&#40;</span> <span>&#41;</span>.InvokeMember<span>&#40;</span> <span>'Name',</span> <span>'GetProperty',</span> <span>$null,</span> <a href="about:blank"><span>$_</span></a><span>,</span> <span>$null</span> <span>&#41;</span> <span>&#125;</span> <span>&#41;</span>
<span>If</span> <span>&#40;</span> <span>$members</span> <span>-contains</span> <span>$Env</span>:UserName <span>&#41;</span> <span>&#123;</span>
New<span>-</span>SmbMapping <span>-</span>LocalPath <span>'T:'</span> <span>-</span>RemotePath <span>"\\CompanyServer\AdminTools"</span>
<span>&#125;</span>

<span># AD group, use "Import-Module ActiveDirectory" once</span>
<span># Source: https://morgantechspace.com/2015/07/powershell-check-if-ad-user-is-member-of-group.html</span>
<span>$members</span> = Get<span>-</span>ADGroupMember <span>-</span>Identity <span>'Marketing'</span> <span>-</span>Recursive <span>|</span> <span>Select</span> <span>-ExpandProperty</span> Name
<span>If</span> <span>&#40;</span> <span>$members</span> <span>-contains</span> <span>$Env</span>:UserName <span>&#41;</span> <span>&#123;</span>
New<span>-</span>SmbMapping <span>-</span>LocalPath <span>'M:'</span> <span>-</span>RemotePath <span>"\\CompanyServer\Marketing"</span>
<span>&#125;</span>



<h4>VBScript: connect drives based on group membership</h4>
In VBScript this is a little more complicated, though hard-coding the domain name would simplify things:
strGroup  = <span>"Marketing"</span>
blnMember = <span>False</span>

<span>Set</span> objSysInfo = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WinNTSystemInfo"</span> <span>&#41;</span>
strUserName = objSysInfo<span>.UserName</span>
strDomain   = objSysInfo<span>.DomainName</span>
<span>Set</span> objSysInfo = <span>Nothing</span>

<span>Set</span> objUser   = GetObject<span>&#40;</span> <span>"WinNT://"</span> & strDomain & <span>"/"</span> & strUserName <span>&#41;</span>
<span>Set</span> colGroups = objUser<span>.Groups</span>

<span>For</span> <span>Each</span> objGroup <span>in</span> colGroups
<span>If</span> <a href="http://www.google.com/search?q=LCASE+site:msdn.microsoft.com"><span>LCase</span></a><span>&#40;</span> objGroup<span>.Name</span> <span>&#41;</span> = <a href="http://www.google.com/search?q=LCASE+site:msdn.microsoft.com"><span>LCase</span></a><span>&#40;</span> strGroup <span>&#41;</span> <span>Then</span>
blnMember = <span>True</span>
<span>End</span> <span>If</span>
<span>Next</span>

<span>Set</span> colGroups = <span>Nothing</span>
<span>set</span> objUser   = <span>Nothing</span>

<span>If</span> blnMember <span>Then</span>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
<span>On</span> <span>Error</span> <span>Resume</span> <span>Next</span>
<span>With</span> wshNetwork
<span>.MapNetworkDrive</span> <span>"G:"</span>, <span>"\\CompanyServer\Dept"</span>
<span>If</span> Err <span>Then</span>
WScript<span>.Echo</span> <span>"Error "</span> & Err & <span>" mapping drive G:"</span>
WScript<span>.Echo</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
<span>End</span> <span>If</span>

<span>.MapNetworkDrive</span> <span>"H:"</span>, <span>"\\CompanyServer\"</span> & <span>.UserName</span>
<span>If</span> Err <span>Then</span>
WScript<span>.Echo</span> <span>"Error "</span> & Err & <span>" mapping drive H:"</span>
WScript<span>.Echo</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
<span>End</span> <span>If</span>
<span>End</span> <span>With</span>
<span>On</span> <span>Error</span> <span>Goto</span> <span>0</span>
<span>Set</span> wshNetwork = <span>Nothing</span>
<span>End</span> <span>If</span>
The code shown is for NT as well as AD groups, and even for local groups on computers in a workgroup.
For AD domains, use <a href="adsistart.php">ADSI</a>.


<h3 id="DisconnectDrives">Disconnect network drives</h3>
If users are allowed to map their own drives, you may want to consider disconnecting drives before mapping them:


<h4>Batch: reconnect drives</h4>
NET USE G: /DELETE /Y
NET USE G: \\CompanyServer\Dept /PERSISTENT:No



<h4>KiXtart: reconnect drives</h4>
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> G<span>:</span> <span>/</span>DELETE
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> G<span>:</span> <span>"\\CompanyServer\Dept"</span>



<h4>PowerShell: reconnect drives</h4>
Remove<span>-</span>SmbMapping <span>-</span>LocalPath <span>'G:'</span> <span>-Force</span>
New<span>-</span>SmbMapping <span>-</span>LocalPath <span>'G:'</span> <span>-</span>RemotePath <span>"\\CompanyServer\Dept"</span>



<h4>VBScript: reconnect drives</h4>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
wshNetwork<span>.RemoveNetworkDrive</span> <span>"G:"</span>, <span>True</span>
wshNetwork<span>.MapNetworkDrive</span>    <span>"G:"</span>, <span>"\\CompanyServer\Dept"</span>
<span>Set</span> wshNetwork = <span>Nothing</span>


<h2 id="Printers">&emsp;2. Network Printers</h2>
<h3 id="ConnectPrinters">Connect network printers</h3>
<h4>Batch: connect DOS style network printers</h4>
NET USE <a href="http://www.ss64.com/nt/lpt1.html"><span>LPT1</span></a> \\Server\HPLJ4 /PERSISTENT:No
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/errorlevel.html"><span>ERRORLEVEL</span></a> 1 <span>(</span>
<a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a> Error connecting printer HP LaserJet 4
<span>)</span>



<h4>KiXtart: connect network printers</h4>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> Not <a href="http://www.kixtart.org/manual/Functions/addprinterconnection.htm"><span>AddPrinterConnection</span></a><span>&#40;</span> <span>"\\CompanyServer\LaserJet Marketing"</span> <span>&#41;</span> = <span>0</span>
<span>"Error @ERROR while trying to connect to LaserJet Marketing@CRLF"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<h4>KiXtart: connect DOS style network printers</h4>
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> LPT1<span>:</span> <span>"\\Server\HPLJ4"</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <span>@ERROR</span> <span>&lt;></span> <span>0</span>
<span>"Error @ERROR while trying to connect to HPLJ4@CRLF"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>



<h4>PowerShell: connect network printers</h4>
Add<span>-</span>Printer <span>-</span>ConnectionName <span>"\\CompanyServer\LaserJet Marketing"</span>

<h4>PowerShell: connect DOS style network printers</h4>
Add<span>-</span>Printer <span>-</span>ConnectionName <span>"\\CompanyServer\LaserJet Marketing"</span> <span>-</span>PortName <span>"LPT1:"</span>



<h4>VBScript: connect network printers</h4>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
<span>On</span> <span>Error</span> <span>Resume</span> <span>Next</span>
wshnetwork<span>.AddWindowsPrinterConnection</span> <span>"\\CompanyServer\LaserJet Marketing"</span>
<span>If</span> Err <span>Then</span>
WScript<span>.Echo</span> <span>"Error "</span> & Err<span>.Number</span> & <span>" while trying to connect to LaserJet Marketing"</span>
WScript<span>.Echo</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
<span>End</span> <span>If</span>
<span>On</span> <span>Error</span> <span>Goto</span> <span>0</span>
<span>Set</span> wshNetwork = <span>Nothing</span>

<h4>VBScript: connect DOS style network printers</h4>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
<span>On</span> <span>Error</span> <span>Resume</span> <span>Next</span>
wshNetwork<span>.AddPrinterConnection</span> <span>"LPT1"</span>, <span>"\\Server\HPLJ4"</span>, <span>False</span>
<span>If</span> Err <span>Then</span>
WScript<span>.Echo</span> <span>"Error "</span> & Err<span>.Number</span> & <span>" while trying to connect to HPLJ4"</span>
WScript<span>.Echo</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
<span>End</span> <span>If</span>
<span>On</span> <span>Error</span> <span>Goto</span> <span>0</span>
<span>Set</span> wshNetwork = <span>Nothing</span>


Like network drives, printer connections will usually depend on OU or group membership.
The same techniques discussed for network drives apply for network printers too.

<h3 id="DisconnectPrinters">Disconnect network printers</h3>
Disconnecting network printers is much like disconnecting network drives:


<h4>Batch: disconnect DOS style printers</h4>
NET USE <a href="http://www.ss64.com/nt/lpt1.html"><span>LPT1</span></a> /DELETE /Y
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/errorlevel.html"><span>ERRORLEVEL</span></a> 1 <span>(</span>
<a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a> Error disconnecting printer port <a href="http://www.ss64.com/nt/lpt1.html"><span>LPT1</span></a>
<span>)</span>



<h4>KiXtart: disconnect printers</h4>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> Not <a href="http://www.kixtart.org/manual/Functions/delprinterconnection.htm"><span>DelPrinterConnection</span></a><span>&#40;</span> <span>"\\CompanyServer\LaserJet Marketing"</span> <span>&#41;</span> = <span>0</span>
<span>"Error @ERROR while trying to drop LaserJet Marketing@CRLF"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<h4>KiXtart: disconnect DOS style printers</h4>
<a href="http://www.kixtart.org/manual/Commands/use.htm"><span>USE</span></a> LPT1<span>:</span> <span>/</span>DELETE
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <span>@ERROR</span> <span>&lt;></span> <span>0</span>
<span>"Error @ERROR while trying to drop LPT1@CRLF"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>



In PowerShell, removing printers should be straightforward, but tests on my own computer revealed that the commands for removal are not always reliable.
You may want to check afterwards if the printer is really removed.

<h4>PowerShell: disconnect network printers</h4>
<span>$oldErrorActionPreference</span> = <a href="about:blank"><span>$ErrorActionPreference</span></a>
<a href="about:blank"><span>$ErrorActionPreference</span></a> = <span>'SilentlyContinue'</span>
Get<span>-</span>Printer <span>-Name</span> <span>'LaserJet Marketing'</span> <span>|</span> Remove<span>-</span>Printer
<span># Check if removal succeeded</span>
<span>if</span> <span>&#40;</span> Get<span>-</span>Printer <span>-Name</span> <span>'LaserJet marketing'</span> <span>&#41;</span> <span>&#123;</span>
<span>Write-Host</span> <span>"Failed to remove 'LaserJet Marketing' printer"</span>
<span>&#125;</span>
<a href="about:blank"><span>$ErrorActionPreference</span></a> = $oldErrorActionPreference

<h4>PowerShell: disconnect DOS style printers</h4>
<span>$oldErrorActionPreference</span> = <a href="about:blank"><span>$ErrorActionPreference</span></a>
<a href="about:blank"><span>$ErrorActionPreference</span></a> = <span>'SilentlyContinue'</span>
<span># Remove the printer first, then remove the printerport</span>
Get<span>-</span>Printer <span>-Name</span> <span>'LaserJet Marketing'</span> <span>|</span> Remove<span>-</span>Printer
Get<span>-</span>PrinterPort <span>-Name</span> <span>'LPT1:'</span> <span>|</span> Remove<span>-</span>PrinterPort
<a href="about:blank"><span>$ErrorActionPreference</span></a> = $oldErrorActionPreference



<h4>VBScript: disconnect all printer types</h4>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
<span>On</span> <span>Error</span> <span>Resume</span> <span>Next</span>
wshnetwork<span>.RemovePrinterConnection</span> <span>"\\CompanyServer\LaserJet Marketing"</span>, <span>True</span>, <span>False</span>
<span>If</span> Err <span>Then</span>
WScript<span>.Echo</span> <span>"Error "</span> & Err<span>.Number</span> & <span>" while trying to drop LaserJet Marketing"</span>
WScript<span>.Echo</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
<span>End</span> <span>If</span>
<span>On</span> <span>Error</span> <span>Goto</span> <span>0</span>
<span>Set</span> wshNetwork = <span>Nothing</span>


<h3 id="DefaultPrinter">Set the default printer</h3>
Another useful function is <code>SetDefaultPrinter( )</code> which, you may have guessed, sets the current user's default printer.
It is available in KiXtart, VBScript and in the Win32_Printer class in WMI.

In NT batch you can use <a href="wmic.php">WMIC</a> to set the default printer.
This requires Windows XP Professional or later.
On older systems it could also be done by manipulating the registry, but that is not recommended.
You may also consider using <code><a href="http://technet.microsoft.com/en-us/library/cc725868(WS.10).aspx">prnmngr.vbs</a> -t</code> to set the default printer in a batch file.
<code>prnmngr.vbs</code> is located in Windows' System32 directory.


<h4>Batch: set default printer</h4>
WMIC Path Win32_Printer Where Name='HP LaserJet 4' <a href="http://www.ss64.com/nt/call.html"><span>Call</span></a> SetDefaultPrinter
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/errorlevel.html"><span>ERRORLEVEL</span></a> 1 <span>(</span>
<a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a> Failed to make 'HP LaserJet 4' the default printer
<span>)</span>



<h4>KiXtart: set default printer</h4>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/setdefaultprinter.htm"><span>SetDefaultPrinter</span></a> <span>&#40;</span> <span>"\\Server\HP LaserJet 4"</span> <span>&#41;</span> <span>&lt;></span> <span>0</span>
Error <span>@ERROR</span> <a href="http://www.kixtart.org/manual/Commands/while.htm"><span>while</span></a> trying to <a href="http://www.kixtart.org/manual/Commands/set.htm"><span>set</span></a> the default printer to HP LaserJet <span>4</span>@CRLF<span>"
EndIf</span>



<h4>PowerShell: set default printer</h4>
<a href="about:blank"><span>$Error</span></a>.<span>Clear&#40;</span> <span>&#41;</span>
<span>$OldProgressPreference</span> = <span>$ProgressPreference</span>
<span>$ProgressPreference</span> = <span>"SilentlyContinue"</span>
<span># Cmdlet for WMI queries changed in PowerShell version 6</span>
<span># Use 'ShareName' instead of 'Name' for network printers</span>
<span>if</span> <span>&#40;</span> <span>$PSVersionTable</span>.PSVersion.Major <span>-lt</span> <span>6</span> <span>&#41;</span> <span>&#123;</span>
<span>Get-WmiObject</span> <span>-Class</span> Win32_Printer <span>-Filter</span> <span>"Name='HP LaserJet 4'"</span> <span>|</span> <span>Invoke-WmiMethod</span> <span>-Name</span> SetDefaultPrinter
<span>&#125;</span> <span>else</span> <span>&#123;</span>
<span>Get-CimInstance</span> <span>-</span>ClassName Win32_Printer <span>-Filter</span> <span>"Name='HP LaserJet 4'"</span> <span>|</span> <span>Invoke-CimMethod</span> <span>-Name</span> <span>'SetDefaultPrinter'</span>
<span>&#125;</span>
<span>$ProgressPreference</span> = <span>$OldProgressPreference</span>
<span>if</span> <span>&#40;</span> <a href="about:blank"><span>$Error</span></a> <span>&#41;</span> <span>&#123;</span>
<span>Write-Host</span> <span>"Failed to make 'HP LaserJet 4' the default printer"</span>
<span>Write-Host</span> <span>"Error: $_"</span>
<span>&#125;</span>



<h4>VBScript: set default printer</h4>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
<span>On</span> <span>Error</span> <span>Resume</span> <span>Next</span>
wshNetwork<span>.SetDefaultPrinter</span> <span>"\\Server\HP LaserJet 4"</span>
<span>If</span> Err <span>Then</span>
WScript<span>.Echo</span> <span>"Error "</span> & Err<span>.Number</span> & <span>" while trying to make HP LaserJet 4 the default printer"</span>
WScript<span>.Echo</span> <span>"("</span> & Err<span>.Description</span> & <span>")"</span>
<span>End</span> <span>If</span>
<span>On</span> <span>Error</span> <span>Goto</span> <span>0</span>
<span>Set</span> wshNetwork = <span>Nothing</span>


<h2 id="LogAccess">&emsp;3. Log Computer Access</h2>
Though auditing is the preferred way to log access to computers, it does have one disadvantage: you can check on the computer who accessed it and when, but not the other way around.

So what do we do if we want to know which computers were accessed by a particular user?
To efficiently search this information, we need to store it in a central location, we don't want to access each computer's security event log separately.
And <em>how</em> are we going to <em>collect</em> this information?
Since the login script is forced to run each time a user logs in, it is perfectly suited to log each (interactive) access to any computer in the domain.
There are several options:


a single log file containing all login information of all users on all computers for every date
a log file per user
a log file per computer (less practical)
a log file per date
any combination of the options 2..4


Depending on the number of users (and logins) I would recommend using a log file per date, or per user per date.
The log files need to be stored in directories per date, on a server where all Authenticated Users have Write permissions.
The directory per date can be created by a scheduled task on the server, but it may be easier and safer to let login script check if it exists and create it if not.

So let's have a look at some code to create a log file per user per day.

In the following code, a log file with the user name is created/used, and the computer name, current date and current time are logged.
If you want to use a single "common" log file for all users per day, make sure you also log the current user name.


<h4>Batch: log computer access</h4>


<span>:: Get current date in YYYYMMDD format if possible (XP Professional or later)</span>
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> /F "skip=1 tokens=1-3" <span>%%A</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(</span>'WMIC Path Win32_LocalTime Get Day<span>^,</span>Month<span>^,</span>Year /Format:Table'<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <span>(</span>
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> /A Today = 10000 * <span>%%C</span> + 100 * <span>%%B</span> + <span>%%A</span>
<span>)</span>
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/errorlevel.html"><span>ERRORLEVEL</span></a> 1 <a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> Today=
<span>:: In case WMIC did not get the "sorted" date we'll have to get an "unsorted" date in regional date format</span>
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> "<span>%Today%</span>"==" <span>(</span>
<span>REM Strip the leading day of the week from the date</span>
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> <span>%%A</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(%Date%)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> Today=<span>%%A</span>
<span>REM Remove the date delimiters</span>
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> Today=<span>%Today:/=%</span>
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> Today=<span>%Today:-=%</span>
<span>)</span>
<span>
:: Create a directory for today if it does not exist</span>
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/not.html"><span>NOT</span></a> <a href="http://www.ss64.com/nt/exist.html"><span>EXIST</span></a> \\Server\Logs\<span>%Today%</span> <a href="http://www.ss64.com/nt/md.html"><span>MD</span></a> \\Server\Logs\<span>%Today%</span>
<span>:: Log the computer name and the date and time in a file with the user's name</span>
<span>>></span> \\Server\Logs\<span>%Today%</span>\<span>%UserName%</span>.log <a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a> <span>%ComputerName%</span>,<span>%Date%</span>,<span>%Time%</span>


Note:In a mixed environment (i.e. several Windows versions, including older ones), to make absolutely sure the directories created will be "sortable", either force the date format using a group policy, or use one of the <a href="datetimentexamples.php#SortDate">SortDate</a> scripts to get today's date in YYYYMMDD format.




<h4>KiXtart: log computer access</h4>

<span>; Get the current date in YYYYMMDD format</span>
$Today = <span>"@YEAR"</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MONTHNO"</span>, <span>2</span> <span>&#41;</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MDAYNO"</span>, <span>2</span> <span>&#41;</span>
<span>; Create the directory if it doesn't exist</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/exist.htm"><span>Exist</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\*.*"</span> <span>&#41;</span> = <span>0</span>
<a href="http://www.kixtart.org/manual/Commands/md.htm"><span>MD</span></a> <span>"\\Server\Logs\$Today"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>
<span>; Log current computer access</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\@USERID.log"</span> <span>&#41;</span> = <span>0</span>
<span>"@WKSTA,@DATE,@TIME@CRLF"</span>
$RC = <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>



<h4>PowerShell: log computer access</h4>

<span># Get today's date in YYYYMMDD format and time in HHmmss format</span>
<span>$Today</span> = <span>Get-Date</span> <span>-Format</span> <span>'yyyyMMdd'</span>
<span>$Now</span>   = <span>Get-Date</span> <span>-Format</span> <span>'HHmmss'</span>
<span># Create the directory if it doesn't exist</span>
<span>if</span> <span>&#40;</span> <span>!&#40;</span> <span>Test-Path</span> <span>"\\Server\Logs\$Today"</span> <span>-PathType</span> Container <span>&#41;</span> <span>&#41;</span> <span>&#123;</span>
<span>New-Item</span> <span>-Path</span> <span>"\\Server\Logs"</span> <span>-Name</span> <span>$Today</span> <span>-ItemType</span> <span>"directory"</span>
<span>&#125;</span>
<span># Log current computer access</span>
<span>"$Env:ComputerName,$Today,$Now\n"</span> <span>|</span> <span>Out<span>-File</span></span> <span>-FilePath</span> <span>"\\Server\Logs\$Today\$Env:UserName.log"</span> <span>-Encoding</span> ASCII



<h4>VBScript: log computer access</h4>

<span>Const</span> ForAppending  = <span>8</span>
<span>Const</span> TristateFalse = <span>0</span>
<span>' Get today's date in YYYYMMDD format and time in HHmmss format</span>
strToday = <span>CStr&#40;</span> <span>10000</span> <span>*</span> <a href="http://www.google.com/search?q=YEAR+site:msdn.microsoft.com"><span>Year</span></a><span>&#40;</span> Now <span>&#41;</span> <span>+</span> <span>100</span> <span>*</span> <a href="http://www.google.com/search?q=MONTH+site:msdn.microsoft.com"><span>Month</span></a><span>&#40;</span> Now <span>&#41;</span> <span>+</span> <a href="http://www.google.com/search?q=DAY+site:msdn.microsoft.com"><span>Day</span></a><span>&#40;</span> Now <span>&#41;</span> <span>&#41;</span>
lngNow   = <span>1000000</span> <span>+</span> <span>10000</span> <span>*</span> <a href="http://www.google.com/search?q=HOUR+site:msdn.microsoft.com"><span>Hour</span></a><span>&#40;</span> Now <span>&#41;</span> <span>+</span> <span>100</span> <span>*</span> <a href="http://www.google.com/search?q=MINUTE+site:msdn.microsoft.com"><span>Minute</span></a><span>&#40;</span> Now <span>&#41;</span> <span>+</span> <a href="http://www.google.com/search?q=SECOND+site:msdn.microsoft.com"><span>Second</span></a><span>&#40;</span> Now <span>&#41;</span>
strNow   = <a href="http://www.google.com/search?q=RIGHT+site:msdn.microsoft.com"><span>Right</span></a><span>&#40;</span> <span>CStr&#40;</span> lngNow <span>&#41;</span>, <span>6</span> <span>&#41;</span>
<span>' Get the current user and computer names</span>
<span>Set</span> wshNetwork = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Network"</span> <span>&#41;</span>
strUser     = wshNetwork<span>.UserName</span>
strComputer = wshNetwork<span>.ComputerName</span>
<span>Set</span> wshNetwork = <span>Nothing</span>
<span>' Create the directory if it doesn't exist</span>
<span>Set</span> objFSO = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;</span>
<span>With</span> objFSO
strFolder = <span>.BuildPath&#40;</span> <span>"\\Server\Logs"</span>, strToday <span>&#41;</span>
<span>If</span> <span>Not</span> <span>.FolderExists&#40;</span> strFolder <span>&#41;</span> <span>Then</span>
<span>.CreateFolder</span> strFolder
<span>End</span> <span>If</span>
strLog = <span>.BuildPath&#40;</span> strFolder, strUser &amp; <span>".log"</span> <span>&#41;</span>
<span>Set</span> objLog = <span>.OpenTextFile&#40;</span> strLog, ForAppending, <span>True</span>, TristateFalse <span>&#41;</span>
objLog<span>.WriteLine</span> strComputer & <span>","</span> & strToday & <span>","</span> & strNow
objLog<span>.Close</span>
<span>Set</span> objLog = <span>Nothing</span>
<span>End</span> <span>With</span>
<span>Set</span> objFSO = <span>Nothing</span>


<h2 id="LogStatus">&emsp;4. Log Computer Status</h2>
Besides the computer name, user name and time of login, you can choose from a long list of properties to add to the login log.
How about logging the IP and MAC addresses?

<h3 id="LogAddresses">Log IP and MAC addresses</h3>
<h4>Batch: log IP and MAC address (single adapter)</h4>

<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> /F "tokens=1,2 delims=:" <span>%%A</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(</span>'IPCONFIG /ALL <span>^|</span> FIND "Address"'<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <span>(</span>
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> /F "tokens=1,2" <span>%%C</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(</span>"<span>%%</span>~A"<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <span>(</span>
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> <span>%%E</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(%%</span>~B<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> <span>%%C%%D</span>=<span>%%E</span>
<span>)</span>
<span>)</span>
<span>>></span> \\Server\Logs\<span>%Today%</span>\<span>%UserName%</span>.log <a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a>.<span>%IPAddress%</span>,<span>%PhysicalAddress:-=%</span>


Notes:(1)Though this code snippet will usually work, it depends too much on the Windows language <em>and</em> version to be reliable.
Use only in an environment with identical Windows installations.
(2)The variable <code>Today</code> should be set before running the code displayed above.
(3)Instead of writing these properties to a separate line, it is recommended to combine all properties that need to be logged into a single line.


<h4>Batch: log IP and MAC addresses (single adapter, XP Pro SP2 or later)</h4>

<a href="http://www.ss64.com/nt/setlocal.html"><span>SETLOCAL</span></a> ENABLEDELAYEDEXPANSION
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> WMIPath=Path Win32_NetworkAdapter
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> WMIQuery=WHERE "AdapterType LIKE 'Ethernet<span>%%</span>' AND MACAddress <span>></span> '' AND <a href="http://www.ss64.com/nt/not.html"><span>NOT</span></a> PNPDeviceID LIKE 'ROOT\\<span>%%</span>'"
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> /F "tokens=*" <span>%%A</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(</span>'WMIC <span>%WMIPath%</span> <span>%WMIQuery%</span> Get MACAddress /Format:List <span>^|</span> FIND "="'<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> <span>%%A</span>
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> WMIPath=Path Win32_NetworkAdapterConfiguration
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> WMIQuery=WHERE "MACAddress='<span>%%MACAddress%%</span>'"
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> /F "tokens=*" <span>%%A</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(</span>'WMIC <span>%WMIPath%</span> <span>%WMIQuery%</span> Get IPAddress /Format:List <span>^|</span> FIND "="'<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <span>(</span>
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> /F "tokens=2 delims==" <span>%%B</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(</span>"<span>%%</span>~A"<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <span>(</span>
<a href="http://www.ss64.com/nt/if.html"><span>IF</span></a> <a href="http://www.ss64.com/nt/not.html"><span>NOT</span></a> "<span>%%</span>~B"==" <span>(</span>
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> /F "tokens=1 delims={}" <span>%%C</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(</span>"<span>%%</span>~B"<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <span>(</span>
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> IPAddress=<span>!IPAddress!</span>,<span>%%</span>~C
<span>)</span>
<span>)</span>
<span>)</span>
<span>)</span>
<span>>></span> \\Server\Logs\<span>%Today%</span>\<span>%UserName%</span>.log <a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a>.<span>%IPAddress:~1%</span>,<span>%MACAddress::=%</span>
<a href="http://www.ss64.com/nt/endlocal.html"><span>ENDLOCAL</span></a>


Notes:(1)This code snippet requires Windows XP Professional SP2 or later.
(2)The variable <code>Today</code> should be set before running the code displayed above.
(3)Instead of writing these properties to a separate line, it is recommended to combine all properties that need to be logged into a single line.




<h4>KiXtart: log IP and MAC addresses</h4>

<span>; Get the current date in YYYYMMDD format</span>
$Today = <span>"@YEAR"</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MONTHNO"</span>, <span>2</span> <span>&#41;</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MDAYNO"</span>, <span>2</span> <span>&#41;</span>
<span>; Create the directory if it doesn't exist</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/exist.htm"><span>Exist</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\*.*"</span> <span>&#41;</span> = <span>0</span>
<a href="http://www.kixtart.org/manual/Commands/md.htm"><span>MD</span></a> <span>"\\Server\Logs\$Today"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<span>; Read the first IP address</span>
$IP = <a href="http://www.kixtart.org/manual/Functions/join.htm"><span>Join</span></a><span>&#40;</span> <a href="http://www.kixtart.org/manual/Functions/split.htm"><span>Split</span></a><span>&#40;</span> @IPAddress0, <span>" "</span> <span>&#41;</span>, <span>"</span> <span>&#41;</span>
<span>; Check if there are more, and join them all using semicolons</span>
<a href="http://www.kixtart.org/manual/Commands/for.htm"><span>For</span></a> $i = <span>1</span> To <span>3</span>
$RC = <a href="http://www.kixtart.org/manual/Functions/execute.htm"><span>Execute</span></a><span>&#40;</span> <span>"If @@IPAddress$i > '' $$IP = $$IP + Chr(59) + Join( Split( @@IPAddress$i, ' ' ), '' )"</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/next.htm"><span>Next</span></a>
<span>; Log the results</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\@USERID.log"</span> <span>&#41;</span> = <span>0</span>
<span>"$IP,@ADDRESS@CRLF"</span>
$RC = <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>


Notes:(1)Instead of writing these properties to a separate line, it is recommended to combine all properties that need to be logged into a single line.




<h4>PowerShell: log IP and MAC addresses</h4>

<span>$MACAddress</span> = <span>&#40;</span> Get<span>-</span>NetAdapter <span>|</span> <span>Where-Object</span> <span>-Property</span> Status <span>-eq</span> Up <span>|</span> <span>Select-Object</span> <span>-First</span> <span>1</span> <span>&#41;</span>.MacAddress
<span>$IPAddress</span>  = <span>&#40;</span> Get<span>-</span>NetIPAddress <span>-</span>AddressFamily IPv4 <span>-</span>InterfaceAlias Ethernet <span>|</span> <span>Select-Object</span> <span>-First</span> <span>1</span> <span>&#41;</span>.IPAddress
<span>$Today</span>      = <span>Get-Date</span> <span>-Format</span> <span>'yyyyMMdd'</span>
<span># Append IP and MAC adresses to log file</span>
<span>"$IPAddress,$MACAddress\n"</span> <span>|</span> <span>Out<span>-File</span></span> <span>-FilePath</span> <span>"\\Server\Logs\$Today\$Env:UserName.log"</span> <span>-Encoding</span> ASCII <span>-Append</span>



<h4>VBScript: log IP and MAC addresses</h4>

<span>' Query all network adapters that have a MAC address</span>
strQuery = <span>"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE MACAddress &gt; ''"</span>
<span>Set</span> objWMIService = GetObject<span>&#40;</span> <span>"winmgmts://./root/CIMV2"</span> <span>&#41;</span>
<span>Set</span> colItems      = objWMIService<span>.ExecQuery&#40;</span> strQuery, <span>"WQL"</span>, <span>48</span> <span>&#41;</span>
<span>For</span> <span>Each</span> objItem <span>In</span> colItems
<span>If</span> <a href="http://www.google.com/search?q=ISARRAY+site:msdn.microsoft.com"><span>IsArray</span></a><span>&#40;</span> objItem<span>.IPAddress</span> <span>&#41;</span> <span>Then</span>
strIP  = strIP  & <span>";"</span> & <a href="http://www.google.com/search?q=JOIN+site:msdn.microsoft.com"><span>Join</span></a><span>&#40;</span> objItem<span>.IPAddress</span>, <span>";"</span> <span>&#41;</span>
strMAC = strMAC & <span>";"</span> & <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com"><span>Replace</span></a><span>&#40;</span> objItem<span>.MACAddress</span>, <span>":"</span>, <span>"</span> <span>&#41;</span>
<span>End</span> <span>If</span>
<span>Next</span>
<span>Set</span> colItems      = <span>Nothing</span>
<span>Set</span> objWMIService = <span>Nothing</span>
<span>' Log the result</span>
<span>Set</span> objFSO = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;</span>
<span>Set</span> objLog = objFSO<span>.OpenTextFile&#40;</span> strLog, ForAppending, <span>True</span>, TristateFalse <span>&#41;</span>
objLog<span>.WriteLine</span> Mid<span>&#40;</span> strIP, <span>2</span> <span>&#41;</span> & <span>","</span> & Mid<span>&#40;</span> strMAC, <span>2</span> <span>&#41;</span>
objLog<span>.Close</span>
<span>Set</span> objLog = <span>Nothing</span>
<span>Set</span> objFSO = <span>Nothing</span>


Notes:(1)The variable <code>strLog</code> and the constant <code>ForAppending</code> need to be set before running the code snippet displayed above.
(2)Instead of writing these properties to a separate line, it is recommended to combine all properties that need to be logged into a single line.



<h3 id="LogAV">Log AntiVirus status</h3>
Now let's get some more advanced status readings.
How about, for example, the status of the AntiVirus software installed?


<h4>Batch: log AntiVirus status (Windows XP SP2/SP3 only)</h4>

<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> NameSpace=/Namespace:\\root\SecurityCenter
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> AVPath=Path AntiVirusProduct
<a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> AVProperties=displayName<span>^^</span>,onAccessScanningEnabled<span>^^</span>,productUptoDate<span>^^</span>,versionNumber
<a href="http://www.ss64.com/nt/for.html"><span>FOR</span></a> /F "tokens=*" <span>%%A</span> <a href="http://www.ss64.com/nt/in.html"><span>IN</span></a> <span>(</span>'WMIC <span>%NameSpace%</span> <span>%AVPath%</span> Get <span>%AVProperties%</span> /Format:List <span>^|</span> FIND "="'<span>)</span> <a href="http://www.ss64.com/nt/do.html"><span>DO</span></a> <span>(></span><a href="http://www.ss64.com/nt/nul.html"><span>NUL</span></a> <a href="http://www.ss64.com/nt/set.html"><span>SET</span></a> <span>%%A)</span>
<span>>></span> \\Server\Logs\<span>%Today%</span>\<span>%UserName%</span>.log <a href="http://www.ss64.com/nt/echo.html"><span>ECHO</span></a>.<span>%displayName%</span>,<span>%versionNumber%</span>,<span>%onAccessScanningEnabled%</span>,<span>%productUptoDate%</span>


Notes:(1)The first 3 lines, setting environment variables, are used to limit the length of the WMIC command line.
You are free to integrate them directly into the WMIC command.
If you do, replace each set of double carets by a single caret.
(2)The variable <code>Today</code> should be set before running the code displayed above.
(3)Instead of writing the AntiVirus status to a separate line, it is recommended to combine all properties that need to be logged into a single line.
(4)This WMIC command requires Windows XP Professional SP2 or SP3.
It will <em>not</em> work in Windows Vista and later.


<h4>Batch: log AntiVirus status (Windows 7 and later)</h4>

WMIC.EXE /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayName,timestamp /Format:Table <span>>></span> \\Server\Logs\<span>%Today%</span>\<span>%UserName%</span>.log



<h4>KiXtart: log AntiVirus status (Windows XP SP2/SP3 only)</h4>

<span>; Get the current date in YYYYMMDD format</span>
$Today = <span>"@YEAR"</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MONTHNO"</span>, <span>2</span> <span>&#41;</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MDAYNO"</span>, <span>2</span> <span>&#41;</span>
<span>; Create the directory if it doesn't exist</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/exist.htm"><span>Exist</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\*.*"</span> <span>&#41;</span> = <span>0</span>
<a href="http://www.kixtart.org/manual/Commands/md.htm"><span>MD</span></a> <span>"\\Server\Logs\$Today"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<span>; Read the AV software status</span>
$objWMISvc = <a href="http://www.kixtart.org/manual/Functions/getobject.htm"><span>GetObject</span></a><span>&#40;</span> <span>"winmgmts:{impersonationLevel=impersonate}!//./root/SecurityCenter"</span> <span>&#41;</span>
$colItems  = $objWMISvc.<span>ExecQuery&#40;</span> <span>"SELECT * FROM AntiVirusProduct"</span>, <span>"WQL"</span>, <span>48</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/for.htm"><span>For</span></a> <a href="http://www.kixtart.org/manual/Commands/each.htm"><span>Each</span></a> $objItem In $colItems
$Msg = $objItem.<span>displayName</span> <span>+</span> <span>","</span> <span>+</span> $objItem.<span>versionNumber</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> $objItem.<span>onAccessScanningEnabled</span> = <span>0</span>
$Msg = $Msg <span>+</span> <span>",FALSE,"</span>
<a href="http://www.kixtart.org/manual/Commands/else.htm"><span>Else</span></a>
$Msg = $Msg <span>+</span> <span>",TRUE,"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> $objItem.<span>productUptoDate</span> = <span>0</span>
$Msg = $Msg <span>+</span> <span>"FALSE@CRLF"</span>
<a href="http://www.kixtart.org/manual/Commands/else.htm"><span>Else</span></a>
$Msg = $Msg <span>+</span> <span>"TRUE@CRLF"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>
<a href="http://www.kixtart.org/manual/Commands/next.htm"><span>Next</span></a>
<span>; Log the result</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\@USERID.log"</span> <span>&#41;</span> = <span>0</span>
$Msg
$RC = <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>


Notes:(1)Instead of writing the AntiVirus status to a separate line, it is recommended to combine all properties that need to be logged into a single line.
(2)This WMIC command requires Windows XP Professional SP2 or SP3.
It will <em>not</em> work in Windows Vista and later.


<h4>KiXtart: log AntiVirus status (Windows 7 and later)</h4>

<span>; Get the current date in YYYYMMDD format</span>
$Today = <span>"@YEAR"</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MONTHNO"</span>, <span>2</span> <span>&#41;</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MDAYNO"</span>, <span>2</span> <span>&#41;</span>
<span>; Create the directory if it doesn't exist</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/exist.htm"><span>Exist</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\*.*"</span> <span>&#41;</span> = <span>0</span>
<a href="http://www.kixtart.org/manual/Commands/md.htm"><span>MD</span></a> <span>"\\Server\Logs\$Today"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<span>; Read the AV software status</span>
$objWMISvc = <a href="http://www.kixtart.org/manual/Functions/getobject.htm"><span>GetObject</span></a><span>&#40;</span> <span>"winmgmts:{impersonationLevel=impersonate}!//./root/SecurityCenter2"</span> <span>&#41;</span>
$colItems  = $objWMISvc.<span>ExecQuery&#40;</span> <span>"SELECT * FROM AntiVirusProduct"</span>, <span>"WQL"</span>, <span>48</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/for.htm"><span>For</span></a> <a href="http://www.kixtart.org/manual/Commands/each.htm"><span>Each</span></a> $objItem In $colItems
$Msg = $objItem.<span>displayName</span> <span>+</span> <span>","</span> <span>+</span> $objItem.<span>timestamp</span>
<a href="http://www.kixtart.org/manual/Commands/next.htm"><span>Next</span></a>
<span>; Log the result</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\@USERID.log"</span> <span>&#41;</span> = <span>0</span>
$Msg
$RC = <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>



<h4>PowerShell: log AntiVirus status (Windows 7 and later)</h4>

<span>$Today</span> = <span>Get-Date</span> <span>-Format</span> <span>'yyyyMMdd'</span>
<span># Append AV program name(s) and timestamp(s) to log file</span>
<span>$AV1</span> = <span>&#40;</span> <span>Get-WmiObject</span> <span>-Class</span> AntiVirusProduct <span>-Namespace</span> <span>'root\SecurityCenter2'</span> <span>&#41;</span>
<span>$AV2</span> = <span>&#40;</span> <span>$AV1</span> <span>|</span> <span>Format-Table</span> <span>-Property</span> displayName<span>,</span>timestamp <span>&#41;</span>
<span>$AV2</span> <span>|</span> <span>Out<span>-File</span></span> <span>-FilePath</span> <span>"\\Server\Logs\$Today\$Env:UserName.log"</span> <span>-Encoding</span> ASCII <span>-Append</span>
<span># The 3 lines above may be joined into a single line</span>



<h4>VBScript: log AntiVirus status (Windows XP SP2/SP3 only)</h4>

<span>' Query the AV status</span>
<span>Set</span> objWMISvc = GetObject<span>&#40;</span> <span>"winmgmts:{impersonationLevel=impersonate}!//./root/SecurityCenter"</span> <span>&#41;</span>
<span>Set</span> colItems  = objWMISvc<span>.ExecQuery&#40;</span> <span>"SELECT * FROM AntiVirusProduct"</span> <span>&#41;</span>
<span>For</span> <span>Each</span> objItem <span>in</span> colItems
<span>With</span> objItem
strMsg = <span>.displayName</span> & <span>","</span> & <span>.versionNumber</span>
<span>If</span> <span>.onAccessScanningEnabled</span> <span>Then</span>
strMsg = strMsg & <span>",TRUE,"</span>
<span>Else</span>
strMsg = strMsg & <span>",FALSE,"</span>
<span>End</span> <span>If</span>
<span>If</span> <span>.productUptoDate</span> <span>Then</span>
strMsg = strMsg & <span>"TRUE"</span>
<span>Else</span>
strMsg = strMsg & <span>"FALSE"</span>
<span>End</span> <span>If</span>
<span>End</span> <span>With</span>
<span>Next</span>
<span>Set</span> colItems  = <span>Nothing</span>
<span>Set</span> objWMISvc = <span>Nothing</span>
<span>' Log the result; variable 'strLog' and constant 'ForAppending' need to be set before</span>
<span>Set</span> objFSO = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;</span>
<span>Set</span> objLog = objFSO<span>.OpenTextFile&#40;</span> strLog, ForAppending, <span>True</span>, TristateFalse <span>&#41;</span>
objLog<span>.WriteLine</span> strMsg
objLog<span>.Close</span>
<span>Set</span> objLog = <span>Nothing</span>
<span>Set</span> objFSO = <span>Nothing</span>


Notes:(1)The variables <code>objFSO</code> and <code>strLog</code> and the constant <code>ForAppending</code> need to be set before running the code snippet displayed above.
(2)Instead of writing the AntiVirus status to a separate line, it is recommended to combine all properties that need to be logged into a single line.
(3)This WMIC command requires Windows XP Professional SP2 or SP3.
It will <em>not</em> work in Windows Vista and later.


<h4>VBScript: log AntiVirus status (Windows 7 and later)</h4>

<span>' Query the AV status</span>
<span>Set</span> objWMISvc = GetObject<span>&#40;</span> <span>"winmgmts:{impersonationLevel=impersonate}!//./root/SecurityCenter2"</span> <span>&#41;</span>
<span>Set</span> colItems  = objWMISvc<span>.ExecQuery&#40;</span> <span>"SELECT * FROM AntiVirusProduct"</span> <span>&#41;</span>
<span>For</span> <span>Each</span> objItem <span>in</span> colItems
strMsg = strMsg & objItem<span>.displayName</span> & <span>","</span> & objItem<span>.versionNumber</span> & vbCrLf
<span>Next</span>
<span>Set</span> colItems  = <span>Nothing</span>
<span>Set</span> objWMISvc = <span>Nothing</span>
<span>' Log the result; variable 'strLog' and constant 'ForAppending' need to be set before</span>
<span>Set</span> objFSO = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"Scripting.FileSystemObject"</span> <span>&#41;</span>
<span>Set</span> objLog = objFSO<span>.OpenTextFile&#40;</span> strLog, ForAppending, <span>True</span>, TristateFalse <span>&#41;</span>
objLog<span>.WriteLine</span> strMsg
objLog<span>.Close</span>
<span>Set</span> objLog = <span>Nothing</span>
<span>Set</span> objFSO = <span>Nothing</span>


<h4 id="MoreProperties">More Properties to Log</h4>

Besides the status of the AntiVirus software, there are more properties that can be useful to log, like the computer's last reboot, hardware properties like CPU type or amount of physical memory, local printers...

Well, you get the idea.

Browse the script samples on this site, or other sites, for more details.


Warning:Useful as this may be, you need to limit the number of logged properties, or the login process may take way too much time.
Hardware properties could be logged in separate files <em>per computer</em> and limited to one log per week, for example.


<h2 id="UpdateSettings">&emsp;5. Update user or computer settings</h2>
Of course, when you can use login scripts to check settings, why not use it to correct or modify settings?

Many settings can be managed using group policies, but sometimes it may be easier to use an addition to the login script.

Make sure these modifications:


are required on this particular computer (avoid running them more than once, don't run on a server)
don't take too much time
can be accomplished with the user's credentials
don't require a reboot


<h2 id="BestPractices">&emsp;6. Tips and best practices to prevent common mistakes</h2>
<em>The</em> most common mistake I've seen in login scripts is bloating: too many small additions that add up to a script that takes a quarter of an hour or even more to run.

How many hours of lost productivity every day are acceptable?

Some basic guidelines:


<em>always remember:</em> login scripts run with the user's credentials, and the user's profile!
don't use login scripts for jobs that can be done by Scheduled Tasks (you may want to check if the task <em>is</em> scheduled on this particular computer, though)
skip parts of the login script if possible: test if a condition is met, if so skip to the next section, if not connect, check, modify or log...
group as many actions as possible, so you don't need to check for group or OU membership or other conditions over and over again
if a lot of checking and logging is done, consider grouping these actions in a "once per day" section at the end of the script
avoid using login scripts as a poor man's software distribution mechanism (though it is perfectly acceptable to <em>configure</em> user settings, or to perform emergency security updates)
consider using a group policy to logoff all users during non-office hours, to make sure the login script runs at least once every working day
check if the login script is running on a desktop computer or a Citrix or Terminal Server (use dedicated login scripts for Terminal Server/Citrix)
on a <em>server</em> the login script should not be allowed to do anything, especially not map network drives or printers!
if the user is a (domain) administrator, the login script should not do anything, except maybe log the status (<em>administrators shouldn't have a login script in the first place</em>)





<h4>KiXtart: abort if user is Administrator</h4>

<span>; Get the current date in YYYYMMDD format</span>

$Today = <span>"@YEAR"</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MONTHNO"</span>, <span>2</span> <span>&#41;</span> <span>+</span> <a href="http://www.kixtart.org/manual/Functions/right.htm"><span>Right</span></a><span>&#40;</span> <span>"0@MDAYNO"</span>, <span>2</span> <span>&#41;</span>

<span>; Create the directory if it doesn't exist</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/exist.htm"><span>Exist</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\*.*"</span> <span>&#41;</span> = <span>0</span>
<a href="http://www.kixtart.org/manual/Commands/md.htm"><span>MD</span></a> <span>"\\Server\Logs\$Today"</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<span>; Log current computer access</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"\\Server\Logs\$Today\@USERID.log"</span> <span>&#41;</span> = <span>0</span>
<span>"@WKSTA,@USERID,@DATE,@TIME,@PRIV@CRLF"</span>
$RC = <a href="http://www.kixtart.org/manual/Functions/redirectoutput.htm"><span>RedirectOutput</span></a><span>&#40;</span> <span>"</span> <span>&#41;</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>

<span>; Administrators should quit now</span>
<a href="http://www.kixtart.org/manual/Commands/if.htm"><span>If</span></a> <span>@PRIV</span> = <span>"ADMIN"</span>
<a href="http://www.kixtart.org/manual/Commands/quit.htm"><span>Quit</span></a> <span>1</span>
<a href="http://www.kixtart.org/manual/Commands/endif.htm"><span>EndIf</span></a>



<h4>PowerShell: abort if user is Administrator</h4>

<span># 'S-1-5-32-544' is the SID of the local 'Administrators' group.</span>
<span># The groups 'Domain Admins' and 'Enterprise Admins' are members of the local</span>
<span># 'Administrators' group if the computer is connected to an AD domain.</span>
<span>if</span> <span>&#40;</span> <span>&#91;</span>Security.Principal.WindowsIdentity<span>&#93;</span>::GetCurrent<span>&#40;</span> <span>&#41;</span>.Groups <span>-contains</span> <span>'S-1-5-32-544'</span> <span>&#41;</span> <span>&#123;</span>
<span>Write-Error</span> <span>"This login script must NOT be executed by members of the Administrators group."</span> <span>-ErrorAction</span> Stop
<span>&#125;</span>



<h4>PowerShell: abort on Terminal Server</h4>

<span># S-1-5-13     = Terminal Server Users</span>
<span># S-1-5-14     = Remote Interactive Logon</span>
<span># S-1-5-32-555 = Remote Desktop Users</span>
<span># See https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/81d92bba-d22b-4a8c-908a-554ab29148ab for a list of well-known SIDs</span>
<span>if</span> <span>&#40;</span> <span>&#91;bool&#93;&#91;</span>Security.Principal.WindowsIdentity<span>&#93;</span>::GetCurrent<span>&#40;</span> <span>&#41;</span>.Groups <span>-match</span> <span>'S-1-5-13'</span> <span>-or</span> <span>'S-1-5-14'</span> <span>-or</span> <span>'1-5-32-555'</span> <span>&#41;</span> <span>&#123;</span>
<span>Write-Error</span> <span>"This login script must NOT be executed by Terminal Server or Remote Desktop users."</span> <span>-ErrorAction</span> Stop
<span>&#125;</span>



<h2 id="Related">&emsp;Related Stuff:</h2>
<a href="http://www.rlmueller.net/LogonScriptFAQ.htm">Logon Script FAQ</a>
The <a href="vbstech.php#Network">Network</a> section of my <a href="vbstech.php">VBScript Scripting Techniques</a> pages, especially the part on <a href="vbstech_network_names.php">retrieving names</a>
<a href="adshelp.php">Directory Service command line tools</a>
<a href="https://docs.microsoft.com/en-us/powershell/scripting/samples/working-with-printers?view=powershell-7.2">PowerShell: Working with Printers in Windows</a>
<a href="https://docs.microsoft.com/en-us/powershell/scripting/learn/deep-dives/everything-about-exceptions?view=powershell-7.2">PowerShell: Everything you wanted to know about exceptions</a>


<h2><k>Retrieve your WAN IP address</k></h2>
<a href="#WinHTTP">WinHTTP</a>
<a href="#XMLHTTP">XMLHTTP</a>
<a href="#IE">Internet Explorer</a>
<a href="#Sample">Sample usage</a>








<a href="http://msdn.microsoft.com/en-us/library/aa382925(VS.85).aspx">WinHttp.WinHttpRequest.5.1</a>
VBScript Code:

Function MyIP_WinHTTP( )
' Name:       MyIP_WinHTTP
' Function:   Display your WAN IP address using WinHTTP
' Usage:      ret = MyIP_WinHTTP( )
' Returns:    WAN (or global) IP address
'
' This script uses WhatIsMyIP.com's automation page
' http://automation.whatismyip.com/n09230945.asp
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim lngStatus, objHTTP, objMatch, objRE, strText, strURL
' Return value in case the IP address could not be retrieved
MyIP_WinHTTP = "0.0.0.0"
' Retrieve the URL's text
strURL = "http://automation.whatismyip.com/n09230945.asp"
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
objHTTP.Open "GET", strURL
objHTTP.Send
' Check if the result was valid, and if so return the result
If objHTTP.Status = 200 Then MyIP_WinHTTP = objHTTP.ResponseText
Set objHTTP = Nothing
End Function
Requirements:
Windows version:Windows 2000 SP3 or later
Network:any
Client software:Internet Explorer 5.01
Script Engine:any
Summarized:Works in Windows 2000 SP3 or later.
Should work in Windows 95, 98, ME, or NT 4 with Internet Explorer 5.01 or later.
<a href="http://msdn.microsoft.com/en-us/library/ms537505(VS.85).aspx">Microsoft.XMLHTTP</a>
VBScript Code:

Function MyIP_XMLHTTP( )
' Name:       MyIP_XMLHTTP
' Function:   Display your WAN IP address using XMLHTTP
' Usage:      ret = MyIP_XMLHTTP( )
' Returns:    WAN (or global) IP address
'
' This script uses WhatIsMyIP.com's automation page
' http://automation.whatismyip.com/n09230945.asp
'
' Original script written in JScript by Isaac Zelf
' "Translated" to VBScript by Rob van der Woude
' http://www.robvanderwoude.com
Dim objRequest, strURL
' Return value in case the IP address could not be retrieved
MyIP_XMLHTTP = "0.0.0.0"
' Retrieve the URL's text
strURL = "http://automation.whatismyip.com/n09230945.asp"
Set objRequest = CreateObject( "Microsoft.XMLHTTP" )
objRequest.open "GET", strURL, False
objRequest.send vbNull
If objRequest.status = 200 Then MyIP_XMLHTTP = objRequest.responseText
Set objRequest = Nothing
End Function
Requirements:
Windows version:any
Network:any
Client software:Internet Explorer 5 or later
Script Engine:any
Summarized:Works in any Windows version with Internet Explorer 5 or later.
<a href="http://msdn.microsoft.com/en-us/library/aa752084(VS.85).aspx">InternetExplorer.Application</a>
VBScript Code:

Function MyIP_IE( )
' Name:       MyIP_IE
' Function:   Display your WAN IP address using Internet Explorer
' Usage:      ret = MyIP_IE( )
' Returns:    WAN (or global) IP address
'
' This script uses WhatIsMyIP.com's automation page
' http://automation.whatismyip.com/n09230945.asp
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
Dim blnTimedOut, i, objIE, objMatch, objRE, strText, strURL
' Return value if IP address couldn't be retrieved
MyIP_IE = "0.0.0.0"
' Open the appropriate URL in Internet Explorer
strURL = "http://automation.whatismyip.com/n09230945.asp"
Set objIE = CreateObject( "InternetExplorer.Application" )
objIE.Visible = False
objIE.Navigate2 strURL
' Wait till IE is ready
i = 0
blnTimedOut = False
Do While objIE.Busy
    WScript.Sleep 100
    i = i + 1
    ' Time out after 10 seconds
    If i > 100 Then
        blnTimedOut = True
        Exit Do
    End If
Loop
' Retrieve the URL's text
If Not blnTimedOut Then MyIP_IE = objIE.Document.Body.InnerText
' Close the Internet Explorer session
objIE.Quit
Set objIE = Nothing
End Function
Requirements:
Windows version:Windows 98 or later
Network:any
Client software:Internet Explorer
Script Engine:any
Summarized:Works in Windows 98 and later with Internet Explorer.
Sample usage
VBScript Code:

Option Explicit

Dim dtmStart, lngSeconds

WScript.Echo "Comparing 3 ways to retrieve your WAN IP address:" & vbCrLf

dtmStart = Now
WScript.Echo "InternetExplorer.Application    " _
       & MyIP_IE( )      & "    (" _
       & DateDiff( "s", dtmStart, Now ) & " seconds)"

dtmStart = Now
WScript.Echo "Microsoft.XMLHTTP               " _
       & MyIP_XMLHTTP( ) & "    (" _
       & DateDiff( "s", dtmStart, Now ) & " seconds)"

dtmStart = Now
WScript.Echo "WinHttp.WinHttpRequest.5.1      " _
       & MyIP_WinHTTP( ) & "    (" _
       & DateDiff( "s", dtmStart, Now ) & " seconds)"
Sample output:

Comparing 3 ways to retrieve your WAN IP address:

InternetExplorer.Application    124.244.199.182    (2 seconds)
Microsoft.XMLHTTP               124.244.199.182    (1 seconds)
WinHttp.WinHttpRequest.5.1      124.244.199.182    (0 seconds)






<h2><k>Retrieve Your Computer's MAC Address(es)</k></h2>
<a href="http://msdn.microsoft.com/en-us/library/aa394216(VS.85).aspx">Win32_NetworkAdapter</a>
VBScript Code:

intCount = 0
strMAC   = "
' We're interested in MAC addresses of physical adapters only
strQuery = "SELECT * FROM Win32_NetworkAdapter WHERE NetConnectionID > ''"

Set objWMIService = GetObject( "winmgmts://./root/CIMV2" )
Set colItems      = objWMIService.ExecQuery( strQuery, "WQL", 48 )

For Each objItem In colItems
If InStr( strMAC, objItem.MACAddress ) = 0 Then
    strMAC   = strMAC & "," & objItem.MACAddress
    intCount = intCount + 1
End If
Next

' Remove leading comma
If intCount > 0 Then strMAC = Mid( strMAC, 2 )

Select Case intCount
Case 0
    WScript.Echo "No MAC Addresses were found"
Case 1
    WScript.Echo "MAC Address: " & strMAC
Case Else
    WScript.Echo "MAC Addresses: " & strMAC
End Select
Requirements:
Windows version:Windows NT 4 SP4, 2000, XP, Server 2003, or Vista
Network:TCP/IP
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> for Windows NT 4
Script Engine:any
Summarized:Works in Windows NT 4 SP4 (with <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a>), Windows 2000 or later.
<em>Doesn't work in Windows 95, 98 or ME.</em>




<h2><k>Wake-up On Lan (WOL)</k></h2>
<span title="Unfortunately, UltraWOL is no longer available">UltraWOL</span> by UltraJones Software
VBScript Code:

Dim objWOL

Set objWOL = CreateObject( "UltraWOL.ctlUltraWOL" )

objWOL.BroadcastAddr = "192.168.0.255"
' The MAC address of the computer to be woken
objWOL.MACAddr = "AA-BB-CC-DD-EE-FF"
' The local computer's IP address
objWOL.LocalIP = "192.168.0.4"
objWOL.WakeUp
Requirements:
Windows version:any
Network:TCP/IP
Client software:<span title="Unfortunately, UltraWOL is no longer available for download">UltraWOL</span> by UltraJones Software
Script Engine:any
Summarized:Should work in any Windows version, as long as <span title="Unfortunately, UltraWOL is no longer available">UltraWOL</span> is installed on the "calling" machine.
Requires WOL to be enabled on the "called" machine.




<h2>&emsp;Related Stuff:</h2>
<a href="http://www.depicus.com/wake-on-lan/wake-on-lan-cmd.aspx">WolCmd</a>
Wake On Lan command line tool
<a href="http://www.gammadyne.com/cmdline.htm#wol">Wol</a>
Wake On Lan command line tool
<a href="http://simply-ware.com/WolHelp.htm">Wol</a>
Wake On Lan GUI <em>and</em> command line tool
<a href="http://www.profshutdown.com/wakeonlan_troubleshoot.aspx">Wake-on-LAN Packet sniffer</a>
Test and troubleshoot Wake On Lan
<a href="http://www.profshutdown.com/features.aspx">Prof Shutdown</a>
Enterprise shutdown and wake-up management software


<h2><k>Editors, IDEs & Object Browsers</k></h2>
<img data-src="https://www.robvanderwoude.com/pictures/vbseditobjectbrowser.gif" width="248" height="348" />
Though simple text editors have served me well both in building my web pages and writing my batch files, I have completely switched to dedicated editors/IDEs for writing VBScript and PowerShell scripts.
Syntax highlighting <em>does</em> help eliminate a lot of debugging time, but what I like even <em>better</em> is "<span title="A form of automated autocompletion popularized by MS Visual Studio IDE">IntelliSense</span>" <sup>&trade;</sup> and built-in debuggers and object browsers!

The picture at the right shows <a href="http://www.adersoft.com/">VBSEdit</a>'s Object Browser window after "<span title="In object technology, to create an object of a specific class.">instantiating</span>" an Internet Explorer object with this one-liner:

Set objIE = CreateObject( "InternetExplorer.Application" )

It looks a lot like the Object Browser from <a href="http://www.microsoft.com/visualstudio/express">Visual Studio (Express)</a>.

Object browsers don't <em>replace</em> the objects' documentation, but they make finding the right <em>keywords</em> a lot easier, and they can serve as a reminder for the exact syntax.

VBSEdit also comes with its own built-in debugger.

You'll find functionality like that in other editors/IDEs too.

PowerShell scripters should certainly try <a href="http://www.idera.com/productssolutions/freetools/powershellplus">PowerShell Plus</a> or <a href="http://shelltools.wik.is/PowerShell_Analyzer">PowerShell Analyzer</a>.

But of course, instead of using a single integrated environment, you can choose to use separate a <a href="scripteditors.php">editor</a>, <a href="codegen.php">debugger</a> and <a href="codegen.php">object browser</a>.

Just for fun, copy and paste the following code into your editor with integrated object browser (or IDE), and look what happens to the object browser window:

<h2><k>Automate Outlook</k></h2>
<a href="vbstech_automation_outlook.php#CleanupSent">Clean up the Sent folder</a>: delete messages older than a set number of days in the Sent folder




Clean up Outlook's Sent folder
<strong>VBScript Code:</strong>

' Delete messages over 14 days old from Outlook's "Sent Items" folder
' Note: You may want to insert a 60 seconds delay and then add shortcuts
'       to this script and to Outlook in your Startup folder
' Script by Rob van der Woude
' http://www.robvanderwoude.com

Option Explicit

Dim intMax, intOld
Dim objFolder, objItem, objNamespace, objOutlook

Const SENT =  5 ' Sent Items folder

intMax = 14 ' Messages older than this will be deleted (#days)
intOld =  0 ' Counter for the number of deleted messages

Set objOutlook = CreateObject( "Outlook.Application" )
Set objNamespace = objOutlook.GetNamespace( "MAPI" )

' Open default account (will fail if Outlook is closed)
' and delete Sent messages over 2 weeks old
objNamespace.Logon "Default Outlook Profile", , False, False    
Set objFolder = objNamespace.GetDefaultFolder( SENT )
For Each objItem In objFolder.Items
' Check the age of the message against the maximum allowed age
If DateDiff( "d", objItem.CreationTime, Now ) > intMax Then
    intOld = intOld + 1
    objItem.Delete
End If
Next
WScript.Echo "Deleted " & intOld & " messages over " & intMax & " days old"

Set objFolder    = Nothing
Set objNamespace = Nothing
Set objOutlook   = Nothing
<strong>Requirements:</strong>
Windows version:any
Network:any
Client software:Outlook
Script Engine:any
Summarized:Works in any Windows version, as long as Outlook (<em>not</em> Outlook Express) is installed.




<h2><k>Automate MS Word</k></h2>
<a href="vbstech_automation_word.php#SaveAsHTML">SaveAs</a>: convert MS Word documents to HTML
<a href="vbstech_automation_word.php#SaveAsPDF">SaveAs</a>: convert MS Word documents to PDF
<a href="vbstech_automation_word.php#SaveAsRTF">SaveAs</a>: convert MS Word documents to RTF
<a href="vbstech_automation_word.php#SaveAsXPS">SaveAs</a>: convert MS Word documents to XPS
<a href="vbstech_automation_word_wordperfect_capslock.php">CapsLock</a>: use MS Word or WordPerfect to check the CapsLock status






SaveAs
Use MS Word to convert Word documents to HTML
VBScript Code:

Option Explicit

Doc2HTML "C:\Documents and Settings\MyUserID\My Documents\resume.doc"

Sub Doc2HTML( myFile )
' This subroutine opens a Word document,
' then saves it as HTML, and closes Word.
' If the HTML file exists, it is overwritten.
' If Word was already active, the subroutine
' will leave the other document(s) alone and
' close only its "own" document.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
' Standard housekeeping
Dim objDoc, objFile, objFSO, objWord, strFile, strHTML

Const wdFormatDocument                    =  0
Const wdFormatDocument97                  =  0
Const wdFormatDocumentDefault             = 16
Const wdFormatDOSText                     =  4
Const wdFormatDOSTextLineBreaks           =  5
Const wdFormatEncodedText                 =  7
Const wdFormatFilteredHTML                = 10
Const wdFormatFlatXML                     = 19
Const wdFormatFlatXMLMacroEnabled         = 20
Const wdFormatFlatXMLTemplate             = 21
Const wdFormatFlatXMLTemplateMacroEnabled = 22
Const wdFormatHTML                        =  8
Const wdFormatPDF                         = 17
Const wdFormatRTF                         =  6
Const wdFormatTemplate                    =  1
Const wdFormatTemplate97                  =  1
Const wdFormatText                        =  2
Const wdFormatTextLineBreaks              =  3
Const wdFormatUnicodeText                 =  7
Const wdFormatWebArchive                  =  9
Const wdFormatXML                         = 11
Const wdFormatXMLDocument                 = 12
Const wdFormatXMLDocumentMacroEnabled     = 13
Const wdFormatXMLTemplate                 = 14
Const wdFormatXMLTemplateMacroEnabled     = 15
Const wdFormatXPS                         = 18
Const wdFormatOfficeDocumentTemplate      = 23 <sup>(<a href="#Note1">1</a>)</sup>
Const wdFormatMediaWiki                   = 24<sup>(<a href="#Note1">1</a>) (<a href="#Note2">2</a>)</sup>

' Create a File System object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Create a Word object
Set objWord = CreateObject( "Word.Application" )

With objWord
    ' True: make Word visible; False: invisible
    .Visible = True

    ' Check if the Word document exists
    If objFSO.FileExists( myFile ) Then
        Set objFile = objFSO.GetFile( myFile )
        strFile = objFile.Path
    Else
        WScript.Echo "FILE OPEN ERROR: The file does not exist" & vbCrLf
        ' Close Word
        .Quit
        Exit Sub
    End If
    ' Build the fully qualified HTML file name
    strHTML = objFSO.BuildPath( objFile.ParentFolder, _
   objFSO.GetBaseName( objFile ) & ".html" )

    ' Open the Word document
    .Documents.Open strFile

    ' Make the opened file the active document
    Set objDoc = .ActiveDocument

    ' Save as HTML
    objDoc.SaveAs strHTML, wdFormatFilteredHTML

    ' Close the active document
    objDoc.Close

    ' Close Word
    .Quit
End With
End Sub

Requirements:
Windows version:any
Network:any
Client software:MS Word
Script Engine:any
Summarized:Works in any Windows version, as long as MS Word is installed.
SaveAs
Use MS Word to convert Word documents to PDF
VBScript Code:

Option Explicit

Doc2PDF "C:\Documents and Settings\MyUserID\My Documents\resume.doc"

Sub Doc2PDF( myFile )
' This subroutine opens a Word document, then saves it as PDF, and closes Word.
' If the PDF file exists, it is overwritten.
' If Word was already active, the subroutine will leave the other document(s)
' alone and close only its "own" document.
'
' Requirements:
' This script requires the "Microsoft Save as PDF or XPS Add-in for 2007
' Microsoft Office programs", available at:
' http://www.microsoft.com/downloads/details.aspx?
'        familyid=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim objDoc, objFile, objFSO, objWord, strFile, strPDF

Const wdFormatDocument                    =  0
Const wdFormatDocument97                  =  0
Const wdFormatDocumentDefault             = 16
Const wdFormatDOSText                     =  4
Const wdFormatDOSTextLineBreaks           =  5
Const wdFormatEncodedText                 =  7
Const wdFormatFilteredHTML                = 10
Const wdFormatFlatXML                     = 19
Const wdFormatFlatXMLMacroEnabled         = 20
Const wdFormatFlatXMLTemplate             = 21
Const wdFormatFlatXMLTemplateMacroEnabled = 22
Const wdFormatHTML                        =  8
Const wdFormatPDF                         = 17
Const wdFormatRTF                         =  6
Const wdFormatTemplate                    =  1
Const wdFormatTemplate97                  =  1
Const wdFormatText                        =  2
Const wdFormatTextLineBreaks              =  3
Const wdFormatUnicodeText                 =  7
Const wdFormatWebArchive                  =  9
Const wdFormatXML                         = 11
Const wdFormatXMLDocument                 = 12
Const wdFormatXMLDocumentMacroEnabled     = 13
Const wdFormatXMLTemplate                 = 14
Const wdFormatXMLTemplateMacroEnabled     = 15
Const wdFormatXPS                         = 18
Const wdFormatOfficeDocumentTemplate      = 23 <sup>(<a href="#Note1">1</a>)</sup>
Const wdFormatMediaWiki                   = 24 <sup>(<a href="#Note1">1</a>) (<a href="#Note2">2</a>)</sup>

' Create a File System object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Create a Word object
Set objWord = CreateObject( "Word.Application" )

With objWord
    ' True: make Word visible; False: invisible
    .Visible = True

    ' Check if the Word document exists
    If objFSO.FileExists( myFile ) Then
        Set objFile = objFSO.GetFile( myFile )
        strFile = objFile.Path
    Else
        WScript.Echo "FILE OPEN ERROR: The file does not exist" & vbCrLf
        ' Close Word
        .Quit
        Exit Sub
    End If

    ' Build the fully qualified HTML file name
    strPDF = objFSO.BuildPath( objFile.ParentFolder, _
  objFSO.GetBaseName( objFile ) & ".pdf" )

    ' Open the Word document
    .Documents.Open strFile

    ' Make the opened file the active document
    Set objDoc = .ActiveDocument

    ' Save as HTML
    objDoc.SaveAs strPDF, wdFormatPDF

    ' Close the active document
    objDoc.Close

    ' Close Word
    .Quit
End With
End Sub

Requirements:
Windows version:any
Network:any
Client software:MS Word 2007 and the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en">Microsoft Save as PDF or XPS Add-in for 2007 Microsoft Office programs</a>
Script Engine:any
Summarized:Works in any Windows version, as long as MS Word 2007 and the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en">Microsoft Save as PDF or XPS Add-in for 2007 Microsoft Office programs</a> are installed.
SaveAs
Use MS Word to convert Word documents to RTF
VBScript Code:

Option Explicit

Doc2RTF "C:\Documents and Settings\MyUserID\My Documents\resume.doc"

Sub Doc2RTF( myFile )
' This subroutine opens a Word document, then saves it as RTF, and closes Word.
' If the RTF file exists, it is overwritten.
' If Word was already active, the subroutine will leave the other document(s)
' alone and close only its "own" document.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim objDoc, objFile, objFSO, objWord, strFile, strRTF

Const wdFormatDocument                    =  0
Const wdFormatDocument97                  =  0
Const wdFormatDocumentDefault             = 16
Const wdFormatDOSText                     =  4
Const wdFormatDOSTextLineBreaks           =  5
Const wdFormatEncodedText                 =  7
Const wdFormatFilteredHTML                = 10
Const wdFormatFlatXML                     = 19
Const wdFormatFlatXMLMacroEnabled         = 20
Const wdFormatFlatXMLTemplate             = 21
Const wdFormatFlatXMLTemplateMacroEnabled = 22
Const wdFormatHTML                        =  8
Const wdFormatPDF                         = 17
Const wdFormatRTF                         =  6
Const wdFormatTemplate                    =  1
Const wdFormatTemplate97                  =  1
Const wdFormatText                        =  2
Const wdFormatTextLineBreaks              =  3
Const wdFormatUnicodeText                 =  7
Const wdFormatWebArchive                  =  9
Const wdFormatXML                         = 11
Const wdFormatXMLDocument                 = 12
Const wdFormatXMLDocumentMacroEnabled     = 13
Const wdFormatXMLTemplate                 = 14
Const wdFormatXMLTemplateMacroEnabled     = 15
Const wdFormatXPS                         = 18
Const wdFormatOfficeDocumentTemplate      = 23 <sup>(<a href="#Note1">1</a>)</sup>
Const wdFormatMediaWiki                   = 24 <sup>(<a href="#Note1">1</a>) (<a href="#Note2">2</a>)</sup>

' Create a File System object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Create a Word object
Set objWord = CreateObject( "Word.Application" )

With objWord
    ' True: make Word visible; False: invisible
    .Visible = True

    ' Check if the Word document exists
    If objFSO.FileExists( myFile ) Then
        Set objFile = objFSO.GetFile( myFile )
        strFile = objFile.Path
    Else
        WScript.Echo "FILE OPEN ERROR: The file does not exist" & vbCrLf
        ' Close Word
        .Quit
        Exit Sub
    End If

    ' Build the fully qualified HTML file name
    strRTF = objFSO.BuildPath( objFile.ParentFolder, _
  objFSO.GetBaseName( objFile ) & ".rtf" )

    ' Open the Word document
    .Documents.Open strFile

    ' Make the opened file the active document
    Set objDoc = .ActiveDocument

    ' Save as HTML
    objDoc.SaveAs strRTF, wdFormatRTF

    ' Close the active document
    objDoc.Close

    ' Close Word
    .Quit
End With
End Sub

Requirements:
Windows version:any
Network:any
Client software:MS Word
Script Engine:any
Summarized:Works in any Windows version, as long as MS Word is installed.
SaveAs
Use MS Word to convert Word documents to XPS (<a href="http://www.microsoft.com/whdc/xps/default.mspx">XML PaperSpecification</a>)
VBScript Code:

Option Explicit

Doc2XPS "C:\Documents and Settings\MyUserID\My Documents\resume.doc"

Sub Doc2XPS( myFile )
' This subroutine opens a Word document, then saves it as XPS, and closes Word.
' If the XPS file exists, it is overwritten.
' If Word was already active, the subroutine will leave the other document(s)
' alone and close only its "own" document.
'
' Requirements:
' This script requires the "Microsoft Save as PDF or XPS Add-in for 2007
' Microsoft Office programs", available at:
' http://www.microsoft.com/downloads/details.aspx?
'        familyid=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim objDoc, objFile, objFSO, objWord, strFile, strXPS

Const wdFormatDocument                    =  0
Const wdFormatDocument97                  =  0
Const wdFormatDocumentDefault             = 16
Const wdFormatDOSText                     =  4
Const wdFormatDOSTextLineBreaks           =  5
Const wdFormatEncodedText                 =  7
Const wdFormatFilteredHTML                = 10
Const wdFormatFlatXML                     = 19
Const wdFormatFlatXMLMacroEnabled         = 20
Const wdFormatFlatXMLTemplate             = 21
Const wdFormatFlatXMLTemplateMacroEnabled = 22
Const wdFormatHTML                        =  8
Const wdFormatPDF                         = 17
Const wdFormatRTF                         =  6
Const wdFormatTemplate                    =  1
Const wdFormatTemplate97                  =  1
Const wdFormatText                        =  2
Const wdFormatTextLineBreaks              =  3
Const wdFormatUnicodeText                 =  7
Const wdFormatWebArchive                  =  9
Const wdFormatXML                         = 11
Const wdFormatXMLDocument                 = 12
Const wdFormatXMLDocumentMacroEnabled     = 13
Const wdFormatXMLTemplate                 = 14
Const wdFormatXMLTemplateMacroEnabled     = 15
Const wdFormatXPS                         = 18
Const wdFormatOfficeDocumentTemplate      = 23 <sup>(<a href="#Note1">1</a>)</sup>
Const wdFormatMediaWiki                   = 24 <sup>(<a href="#Note1">1</a>) (<a href="#Note2">2</a>)</sup>

' Create a File System object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Create a Word object
Set objWord = CreateObject( "Word.Application" )

With objWord
    ' True: make Word visible; False: invisible
    .Visible = True

    ' Check if the Word document exists
    If objFSO.FileExists( myFile ) Then
        Set objFile = objFSO.GetFile( myFile )
        strFile = objFile.Path
    Else
        WScript.Echo "FILE OPEN ERROR: The file does not exist" & vbCrLf
        ' Close Word
        .Quit
        Exit Sub
    End If

    ' Build the fully qualified XPS file name
    strXPS = objFSO.BuildPath( objFile.ParentFolder, _
   objFSO.GetBaseName( objFile ) & ".xps" )

    ' Open the Word document
    .Documents.Open strFile

    ' Make the opened file the active document
    Set objDoc = .ActiveDocument

    ' Save in XML Paper Specification (XPS) format
    objDoc.SaveAs strXPS, wdFormatXPS

    ' Close the active document
    objDoc.Close

    ' Close Word
    .Quit
End With
End Sub

Requirements:
Windows version:any
Network:any
Client software:MS Word 2007 and the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en">Microsoft Save as PDF or XPS Add-in for 2007 Microsoft Office programs</a>
Script Engine:any
Summarized:Works in any Windows version, as long as MS Word 2007 and the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en">Microsoft Save as PDF or XPS Add-in for 2007 Microsoft Office programs</a> are installed.




This demo script can be <a href="./files/officeautomation.zip">downloaded here</a>.
The downloadable version also contains other file filter constants.


Notes1:Constants found with "brute force" approach by Scott Ness
2:Requires <a href="http://www.microsoft.com/download/en/details.aspx?id=12298">Microsoft Office Word Add-in For MediaWiki</a>




<h2><k>Use Microsoft Word or Corel WordPerfect to check the Caps Lock status</k></h2>
CapsLock
Use MS Word or Corel WordPerfect to check the CapsLock status
VBScript Code:

Option Explicit

Dim arrCaps, strMsg, strProc
Dim blnExitWord, blnExitWP
Dim colItems, objItem, objWMIService

strMsg = "

' Check for command line arguments (none required)
If WScript.Arguments.Count > 0 Then
Syntax
End If

' Check if MSWord and/or WordPerfect are already active by
' searching for processes named WINWORD.EXE or WPWIN**.EXE
blnExitWP   = True
blnExitWord = True
Set objWMIService = GetObject( "winmgmts://./root/cimv2" )
Set colItems = objWMIService.ExecQuery( "SELECT * FROM Win32_Process" )
For Each objItem In colItems
strProc = UCase( objItem.Name )
If Len( strProc ) > 11 Then Exit For
If Left( strProc, 5 ) = "WPWIN" And Right( strProc, 4 ) = ".EXE" Then
    blnExitWP = False
End If
If strProc = "WINWORD.EXE" Then
    blnExitWord = False
End If
Next
Set objWMIService = Nothing

' Start with WordPerfect only if it is
' active already, otherwise try MSWord first
If blnExitWord = False And blnExitWP = True Then
arrCaps = CapsLockWP( )
If arrCaps(1) Then
    arrCaps = CapsLockWord( )
    If arrCaps(1) Then
        WScript.Echo strMsg & "Unable to read CapsLock status"
        WScript.Quit
    End If
End If
Else
arrCaps = CapsLockWord( )
If arrCaps(1) Then
    arrCaps = CapsLockWP( )
    If arrCaps(1) Then
        WScript.Echo strMsg & "Unable to read CapsLock status"
        WScript.Quit
    End If
End If
End If

If arrCaps(0) Then
WScript.Echo strMsg & "CapsLock is ON"
Else
WScript.Echo strMsg & "CapsLock is OFF"
End If


Function CapsLockWord( )
Dim objWord, blnCapsLock, blnError
On Error Resume Next
Set objWord = CreateObject( "Word.Application" )
If Err Then
    blnCapsLock = False
    blnError    = True
Else
    blnCapsLock = CBool( objWord.CapsLock )
    blnError    = False
    If blnExitWord Then
        objWord.Quit
    End If
End If
On Error Goto 0
CapsLockWord = Array( blnCapsLock, blnError )
End Function


Function CapsLockWP( )
Dim objWP, blnCapsLock, blnError
On Error Resume Next
Set objWP = CreateObject( "WordPerfect.PerfectScript" )
If Err Then
    blnCapsLock = False
    blnError    = True
Else
    blnCapsLock = CBool( objWP.envKeyCapsLock )
    blnError    = False
    If blnExitWP Then
        objWP.ExitWordPerfect
    End If
End If
On Error Goto 0
CapsLockWP = Array( blnCapsLock, blnError )
End Function


Sub Syntax( )
strMsg = "CapsLock.vbs,  Version 1.01" _
       & vbCrLf _
       & "Display CapsLock status using MS Word or WordPerfect" _
       & vbCrLf & vbCrLf _
       & "Usage:  CAPSLOCK.VBS" _
       & vbCrLf & vbCrLf _
       & "Note:   This script will first check if WordPerfect is active." _
       & vbCrLf _
       & "        If so, it will use WordPerfect to read the CapsLock status." _
       & vbCrLf _
       & "        Otherwise it will try using MS Word, and if it fails try" _
       & vbCrLf _
       & "        again using WordPerfect." _
       & vbCrLf _
       & "        It won't close MS Word nor WordPerfect if they were active" _
       & vbCrLf _
       & "        at the time the script was started." _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" & vbCrLf _
       & "http://www.robvanderwoude.com" _
       & vbCrLf & vbCrLf & vbCrLf & vbCrLf & vbCrLf
End Sub
Requirements:
Windows version:any
Network:any
Client software:Microsoft Word (tested in Microsoft Office 2007 only) or Corel WordPerfect (tested in Corel WordPerfect Office 12 only)
Script Engine:any
Summarized:Works in any Windows version, as long as either Microsoft Word (2007) or Corel WordPerfect (12) is installed.




This demo script can be <a href="./files/capslock.zip">downloaded here</a>.



<h2><k>Automate WordPerfect</k></h2>
<a href="vbstech_automation_wordperfect.php#PublishPDF">PublishPDF</a>: convert WP documents to PDF
<a href="vbstech_automation_wordperfect.php#SaveAs">SaveAs</a>: convert WP documents to HTML
<a href="vbstech_automation_wordperfect.php#Type">Type</a>: type and format text
<a href="vbstech_automation_word_wordperfect_capslock.php">CapsLock</a>: use MS Word or WordPerfect to check the CapsLock status




Corel WordPerfect Office Suites come with their own macro scripting language.

However, it is possible to use VBScript to automate WordPerfect through OLE.

The following code demonstrates some of WordPerfect's OLE automation capabilities.






PublishPDF
Use Corel WordPerfect to convert WP documents to PDF
VBScript Code:

Option Explicit

Dim blnExitWP, colItems, strMsg, strPDFDoc, strWPDoc
Dim objFSO, objItem, objWMIService, objWP

strMsg = ""

' Open a FileSystem Object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Parse the command line arguments
With WScript.Arguments
If .Named.Count > 0 Then Syntax
Select Case .Unnamed.Count
    Case 1
        strWPDoc  = .Unnamed(0)
        ' No PDF file name specified, so we'll take the location and
        ' file name of the WordPerfect document and append a PDF extension
        strPDFDoc = objFSO.BuildPath( objFSO.GetParentFolderName( strWPDoc ), _
     objFSO.GetBaseName( strWPDoc ) & ".pdf" )
    Case 2
        strWPDoc  = .Unnamed(0)
        strPDFDoc = .Unnamed(1)
    Case Else
        Syntax
End Select
End With

' Check if the WordPerfect file exists
If Not objFSO.FileExists( strWPDoc ) Then
strMsg = "ERROR:  File """ & strWPDoc & """ not found" & vbCrLf & vbCrLf
Syntax
End If

' Check if WordPerfect is already active by
' searching for a process named WPWIN**.EXE
blnExitWP = True
Set objWMIService = GetObject( "winmgmts://./root/cimv2" )
Set colItems = objWMIService.ExecQuery( "SELECT * FROM Win32_Process" )
For Each objItem In colItems
If Left( UCase( objItem.Name ), 5 ) = "WPWIN" And _
   Right( UCase( objItem.Name ), 4 ) = ".EXE" And _
   Len( objItem.Name ) &lt; 12 Then blnExitWP = False
Next
Set objWMIService = Nothing

' Create a new WP OLE Automation object
Set objWP = CreateObject( "WordPerfect.PerfectScript" )

With objWP
' Open the specified document
.FileOpen( strWPDoc )

' Publish to PDF
.PdfDlg( strPDFDoc )

' Close the document
.Close

' Close WordPerfect unless it was already active
If blnExitWP Then .ExitWordPerfect
End With

' Release the objects
Set objFSO = Nothing
Set objWP  = Nothing


Sub Syntax( )
strMsg = strMsg & vbCrLf _
       & WScript.ScriptName & ",  Version 1.00" & vbCrLf _
       & "Convert a WordPerfect document to Adobe PDF" & vbCrLf & vbCrLf _
       & "Usage:  " & UCase( WScript.ScriptName ) _
       & "  wpdoc_filename  [ pdf_filename ]" & vbCrLf & vbCrLf _
       & "Where:  ""wpdoc_filename""  is the WP file to be converted" _
       & vbCrLf _
       & "        ""pdf_filename""    is the name for the PDF file" _
       & vbCrLf _
       & "                          " _
       & "(default is name of WP file with .PDF extension)" _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" & vbCrLf _
       & "http://www.robvanderwoude.com"
WScript.Echo strMsg
WScript.Quit(1)
End Sub

Requirements:
Windows version:any
Network:any
Client software:Corel WordPerfect
Script Engine:any
Summarized:Works in any Windows version, as long as Corel WordPerfect is installed.
         Requires a WordPerfect version that has "Publish To", "PDF" menu entries (tested in Corel WordPerfect 12).
SaveAs
Use Corel WordPerfect to convert WP documents to HTML
VBScript Code:

WP2HTML "C:\Documents and Settings\MyUserID\My Documents\resume.wpd"

Sub WP2HTML( myFile )
' This subroutine opens a WordPerfect document,
' then saves it as HTML, and closes WordPerfect.
' If the HTML file exists, the subroutine will
' prompt for overwrite.
' If WordPerfect was already active, the subroutine
' will prompt the user to save the changes in other
' documents.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim objFSO, objWP, objWPFile, strHTMLFile, strWPFile

Const WordPerfect_6_7_8_FileOpen_Format = 4
Const HTML_FileSave_ExportType          = 226
Const No_FileSave_Overwrite             = 0
Const Prompt_FileSave_Overwrite         = 2
Const Yes_FileSave_Overwrite            = 1

' Create a File System object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )
' Create a WordPerfect OLE Automation object
Set objWP = CreateObject( "WordPerfect.PerfectScript" )
With objWP
    ' Check if the WordPerfect file exists
    If objFSO.FileExists( myFile ) Then
        Set objWPFile = objFSO.GetFile( myFile )
    Else
        WScript.Echo "FILE OPEN ERROR: The file does not exist" & vbCrLf
        ' Close WordPerfect
        .ExitWordPerfect
        Exit Sub
    End If
    strWPFile   = objWPFile.Path
    strHTMLFile = objFSO.BuildPath( objWPFile.ParentFolder, _
       objFSO.GetBaseName( objWPFile ) & ".html" )

    ' Maximize the window
    .AppMaximize
    ' Open the document
    On Error Resume Next
    .FileOpen strWPFile, WordPerfect_6_7_8_FileOpen_Format
    If Err Then
        WScript.Echo "FILE OPEN ERROR: " & Err.Number & vbCrLf _
        & Err.Description & vbCrLf
        Err.Clear
        ' Close WordPerfect
        .ExitWordPerfect
        Exit Sub
    End If
    ' Save the document as HTML file
    .FileSave strHTMLFile, HTML_FileSave_ExportType, Prompt_FileSave_Overwrite
    If Err Then
        WScript.Echo "FILE SAVE AS ERROR: " & Err.Number & vbCrLf _
        & Err.Description & vbCrLf
        Err.Clear
    End If
    ' Close WordPerfect
    .ExitWordPerfect
    If Err Then
        WScript.Echo "PROGRAM CLOSE ERROR: " & Err.Number & vbCrLf _
        & Err.Description & vbCrLf
        Err.Clear
    End If
    On Error Goto 0
End With

' Release the object
Set objWP = Nothing
End Sub

Requirements:
Windows version:any
Network:any
Client software:Corel WordPerfect
Script Engine:any
Summarized:Works in any Windows version, as long as Corel WordPerfect is installed.
Type
Write and format text
VBScript Code:

' This script opens WordPerfect, creates a new document,
' types some text and changes text attributes on selections.
'
' Tested with Corel WordPerfect 12 only.
'
' Based on the article "The Cutting Edge: Using OLE
' Automation to Control WordPerfect" by Gordon McComb
' <a href="http://gmccomb.com/vault/edge/ole.html">gmccomb.com/vault/edge/ole.html</a>
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

Option Explicit

Dim objWP

' Create a new WP OLE Automation object
Set objWP = CreateObject( "WordPerfect.PerfectScript" )

With objWP
' Maximize the window
.AppMaximize

' Open a new document; otherwise the
' currently active document is used!
.FileNew

' Set the new default font and size
.Font = "Times New Roman"
.FontSize = 200 ' 200 = 12pt

' Type some text, and center the line
.Center
.Type "This is normal text, 12pt Times New Roman, centered" & vbLf & vbLf

' Repeat, but select and format the text
.Center
.Type "This is Bold, Extra Large text, centered" & vbLf
.MoveUp
.SelectLineEnd
.MoveLeft
.FontExtraLargeToggle
.BoldKey
.SelectOff
.MoveRight
.Type vbLf

' Repeat, this time without centering
.Type "This is normal text, left aligned, 18pt Arial" & vbLf
.MoveUp
.SelectLineEnd
.MoveLeft
.FontSize = 300 ' 300 = 18pt
.Font = "Arial"
.SelectOff
.MoveRight
.Type vbLf

' Once more
.Type "This is 8pt Comic Sans MS, italics" & vbLf
.MoveUp
.SelectLineEnd
.MoveLeft
.Font = "Comic Sans MS"
.FontSize = 133 ' 133 = 8pt
.FontItalicToggle
.SelectOff
.MoveRight

' And again
.Type vbLf & "Normal text, underlined" & vbLf
.MoveUp
.SelectLineEnd
.MoveLeft
.FontUnderlineToggle
.SelectOff
.MoveRight
.Type vbLf

' Open the File Save As dialog and quit
.FileSaveAsDlg
.Quit
End With

' Release the object
Set objWP = Nothing

WScript.Echo "Done."

Requirements:
Windows version:any
Network:any
Client software:Corel WordPerfect
Script Engine:any (except of course the <code>WScript.Echo</code> command at the end)
Summarized:Works in any Windows version, as long as Corel WordPerfect is installed.




Note the use of <code>vbLf</code> instead of <code>vbCrLf</code> when typing text in WordPerfect.
<code>vbCrLf</code> would result in a space before each linefeed.

These typing demo scripts can be <a href="./files/officeautomation.zip">downloaded here</a>.
The downloadable versions also contain other file filter constants.



<h2><k>Use Microsoft Word or Corel WordPerfect to check the Caps Lock status</k></h2>
CapsLock
Use MS Word or Corel WordPerfect to check the CapsLock status
VBScript Code:

Option Explicit

Dim arrCaps, strMsg, strProc
Dim blnExitWord, blnExitWP
Dim colItems, objItem, objWMIService

strMsg = "

' Check for command line arguments (none required)
If WScript.Arguments.Count > 0 Then
Syntax
End If

' Check if MSWord and/or WordPerfect are already active by
' searching for processes named WINWORD.EXE or WPWIN**.EXE
blnExitWP   = True
blnExitWord = True
Set objWMIService = GetObject( "winmgmts://./root/cimv2" )
Set colItems = objWMIService.ExecQuery( "SELECT * FROM Win32_Process" )
For Each objItem In colItems
strProc = UCase( objItem.Name )
If Len( strProc ) > 11 Then Exit For
If Left( strProc, 5 ) = "WPWIN" And Right( strProc, 4 ) = ".EXE" Then
    blnExitWP = False
End If
If strProc = "WINWORD.EXE" Then
    blnExitWord = False
End If
Next
Set objWMIService = Nothing

' Start with WordPerfect only if it is
' active already, otherwise try MSWord first
If blnExitWord = False And blnExitWP = True Then
arrCaps = CapsLockWP( )
If arrCaps(1) Then
    arrCaps = CapsLockWord( )
    If arrCaps(1) Then
        WScript.Echo strMsg & "Unable to read CapsLock status"
        WScript.Quit
    End If
End If
Else
arrCaps = CapsLockWord( )
If arrCaps(1) Then
    arrCaps = CapsLockWP( )
    If arrCaps(1) Then
        WScript.Echo strMsg & "Unable to read CapsLock status"
        WScript.Quit
    End If
End If
End If

If arrCaps(0) Then
WScript.Echo strMsg & "CapsLock is ON"
Else
WScript.Echo strMsg & "CapsLock is OFF"
End If


Function CapsLockWord( )
Dim objWord, blnCapsLock, blnError
On Error Resume Next
Set objWord = CreateObject( "Word.Application" )
If Err Then
    blnCapsLock = False
    blnError    = True
Else
    blnCapsLock = CBool( objWord.CapsLock )
    blnError    = False
    If blnExitWord Then
        objWord.Quit
    End If
End If
On Error Goto 0
CapsLockWord = Array( blnCapsLock, blnError )
End Function


Function CapsLockWP( )
Dim objWP, blnCapsLock, blnError
On Error Resume Next
Set objWP = CreateObject( "WordPerfect.PerfectScript" )
If Err Then
    blnCapsLock = False
    blnError    = True
Else
    blnCapsLock = CBool( objWP.envKeyCapsLock )
    blnError    = False
    If blnExitWP Then
        objWP.ExitWordPerfect
    End If
End If
On Error Goto 0
CapsLockWP = Array( blnCapsLock, blnError )
End Function


Sub Syntax( )
strMsg = "CapsLock.vbs,  Version 1.01" _
       & vbCrLf _
       & "Display CapsLock status using MS Word or WordPerfect" _
       & vbCrLf & vbCrLf _
       & "Usage:  CAPSLOCK.VBS" _
       & vbCrLf & vbCrLf _
       & "Note:   This script will first check if WordPerfect is active." _
       & vbCrLf _
       & "        If so, it will use WordPerfect to read the CapsLock status." _
       & vbCrLf _
       & "        Otherwise it will try using MS Word, and if it fails try" _
       & vbCrLf _
       & "        again using WordPerfect." _
       & vbCrLf _
       & "        It won't close MS Word nor WordPerfect if they were active" _
       & vbCrLf _
       & "        at the time the script was started." _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" & vbCrLf _
       & "http://www.robvanderwoude.com" _
       & vbCrLf & vbCrLf & vbCrLf & vbCrLf & vbCrLf
End Sub
Requirements:
Windows version:any
Network:any
Client software:Microsoft Word (tested in Microsoft Office 2007 only) or Corel WordPerfect (tested in Corel WordPerfect Office 12 only)
Script Engine:any
Summarized:Works in any Windows version, as long as either Microsoft Word (2007) or Corel WordPerfect (12) is installed.




This demo script can be <a href="./files/capslock.zip">downloaded here</a>.



<h2>Automate Quattro Pro</h2>
<a href="vbstech_automation_quattropro.php#QPro2Xls">QPro2Xls</a>: convert Corel Quattro Pro spreadsheets to Excel







QPro2Xls
Use Quattro Pro to convert Quattro Pro spreadsheets to Excel
VBScript Code:

Option Explicit

Dim objFSO, objQPro
Dim strExcel, strQPro

With WScript.Arguments
If .Named.Exists("?")  Then Syntax ""
If .Named.Count    > 0 Then Syntax "Syntax error: invalid switches"
If .Unnamed.Count &lt;> 1 Then Syntax "Syntax error: invalid number of arguments"
strQPro = .Unnamed(0)
End With

strExcel = Replace( strQPro, ".qpw", ".xls" )

Set objFSO = CreateObject( "Scripting.FileSystemObject" )
With objFSO
If Not .FileExists( strQPro ) Then Syntax "Error: file not found"
If .FileExists( strExcel ) Then .DeleteFile strExcel, True
End With
Set objFSO = Nothing

Set objQPro = CreateObject( "QuattroPro.PerfectScript" )
If Err Then Syntax "Error: cannot open Quattro Pro"
With objQPro
On Error Resume Next
.FileOpen strQpro
If Err Then
    Syntax "Error: cannot open file"
Else
    .FileSaveAsExcel strExcel
    .FileClose
    If Err Then Syntax "Error: cannot save file"
End If
.Quit
On Error Goto 0
End With
Set objQPro = Nothing


Sub Syntax( myMsg )
Dim strMsg
If IsObject( objQPro ) Then objQPro.Quit
Set objFSO  = Nothing
Set objQPro = Nothing
If myMsg &lt;> "" Then strMsg = vbCrLf & myMsg & vbCrLf
strMsg = strMsg & vbCrLf _
       & "QPro2Xls.vbs,  Version 1.00" _
       & vbCrLf _
       & "Convert a Quattro Pro spreadsheet to Excel" _
       & vbCrLf & vbCrLf _
       & "Usage:  [ CSCRIPT ]  QPRO2XLS.VBS  qpro_file" _
       & vbCrLf & vbCrLf _
       & "Where:  ""qpro_file""  is the file name of the Quattro" _
       & vbCrLf _
       & "                     Pro spreadsheet to be converted" _
       & vbCrLf & vbCrLf _
       & "Notes:  Quattro Pro must be installed to use this script." _
       & vbCrLf _
       & "        The Excel ""target"" file will have the same name" _
       & vbCrLf _
       & "        and will be located in the same directory as the" _
       & vbCrLf _
       & "        Quattro Pro ""source"" file." _
       & vbCrLf _
       & "        If the Excel ""target"" file exists, it will be" _
       & vbCrLf _
       & "        overwritten without confirmation." _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" _
       & vbCrLf _
       & "http://www.robvanderwoude.com"
WScript.Echo strMsg
WScript.Quit 1
End Sub
Requirements:
Windows version:any
Network:any
Client software:Corel Quattro Pro
Script Engine:any (except of course the <code>WScript.Echo</code> command at the end)
Summarized:Works in any Windows version, as long as Corel Quattro Pro is installed.




<h2><k>Automate SnagIt screen captures</k></h2>
Automate SnagIt</a> screen captures
VBScript Code:

Option Explicit

Dim objSnagit, strMsg, wshShell

' Check command line arguments (none required)
If WScript.Arguments.Count > 0 Then Syntax

' Capture input type
Const siiDesktop        =  0
Const siiWindow         =  1
Const siiRegion         =  4
Const siiGraphicFile    =  6
Const siiClipboard      =  7
Const siiDOSScreen      =  8
Const siiMenu           =  9
Const siiObject         = 10
Const siiProgramFile    = 11
Const siiFreehand       = 12
Const siiEllipse        = 13
Const siiRoundedRect    = 14
Const siiTriangle       = 15
Const siiPolygon        = 16
Const siiWallpaper      = 17
Const siiCustomScroll   = 18
Const siiTWAIN          = 19
Const siiDirectX        = 20
Const siiExtendedWindow = 23

' Window selection method
Const swsmInteractive   =  0
Const swsmActive        =  1
Const swsmHandle        =  2
Const swsmPoint         =  3

' Capture output type
Const sioPrinter        =  1
Const sioFile           =  2
Const sioClipboard      =  4
Const sioMail           =  8
Const sioFTP            = 32

' Output image type
Const siftBMP           =  0
Const siftPCX           =  1
Const siftTIFF          =  2
Const siftJPEG          =  3
Const siftGIF           =  4
Const siftPNG           =  5
Const siftTGA           =  6

' Output color depth
Const sicdAuto          =  0
Const sicd1Bit          =  1
Const sicd2Bit          =  2
Const sicd3Bit          =  3
Const sicd4Bit          =  4
Const sicd5Bit          =  5
Const sicd6Bit          =  6
Const sicd7Bit          =  7
Const sicd8Bit          =  8
Const sicd16Bit         = 16
Const sicd24Bit         = 24
Const sicd32Bit         = 32

' Output file naming method
Const sofnmPrompt       =  0
Const sofnmFixed        =  1
Const sofnmAuto         =  2


' Create the required objects
Set objSnagit = CreateObject( "SNAGIT.ImageCapture.1" )
Set wshShell  = CreateObject( "WScript.Shell" )

' Set input options
objSnagit.Input         = siiDesktop
objSnagit.IncludeCursor = True

' Set output options
objSnagit.Output                           = sioFile
objSnagit.OutputImageFile.FileType         = siftPNG
objSnagit.OutputImageFile.ColorDepth       = sicd32Bit
objSnagit.OutputImageFile.FileNamingMethod = sofnmFixed
objSnagit.OutputImageFile.Filename         = "snagtest"
objSnagit.OutputImageFile.Directory        = "C:\"

' Capture
objSnagit.Capture

' Launch the captured image in the default viewer
wshShell.Run "C:\snagtest.png", 0, False

' Release the objects
Set objSnagit = Nothing
Set wshShell  = Nothing


Sub Syntax
strMsg = vbCrLf _
       & WScript.ScriptName & ",  Version 1.01" _
       & vbCrLf _
       & "Automate a SnagIt full screen capture" _
       & vbCrLf & vbCrLf _
       & "Usage:  " & UCase( WScript.ScriptName ) _
       & vbCrLf & vbCrLf _
       & "Notes:  [1] The resulting screenshot is saved as C:\snagtest.png." _
       & vbCrLf _
       & "            An existing file will be overwritten." _
       & vbCrLf _
       & "        [2] This script requires SnagIt to be installed on the local computer." _
       & vbCrLf _
       & "            SnagIt is commercial screen capture software by TechSmith." _
       & vbCrLf _
       & "            A 30-day trial version is available for download:" _
       & vbCrLf _
       & "            http://www.techsmith.com/screen-capture.asp" _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" _
       & vbCrLf _
       & "http://www.robvanderwoude.com"
WScript.Echo strMsg
WScript.Quit 1
End Sub
Requirements:
Windows version:any
Network:any
Client software:SnagIt</a> (tested with versions 7.2.5 and 8.2.3)
Script Engine:any
Summarized:Works in any Windows version, as long as SnagIt</a> is installed.




This demo script can be <a href="./files/officeautomation.zip">downloaded here</a>.



<h2><k>Print Files</k></h2>
Shell.Application
VBScript Code:

' Check the command line arguments
If WScript.Arguments.Unnamed.Count &lt;> 1 Then Syntax
If WScript.Arguments.Named.Count    > 0 Then Syntax

' Check if a valid file was specified
Set objFSO = CreateObject( "Scripting.FileSystemObject" )
strFile = WScript.Arguments(0)
If Not objFSO.FileExists( strFile ) Then Syntax
strFolder = objFSO.GetParentFolderName( strFile )
Set objFSO = Nothing

' Open the Shell Folders object
Set objShell  = CreateObject( "Shell.Application" )

' Create an object for the specified file's parent folder
Set objFolder = objShell.Namespace( strFolder )

' Create a collection for the folder's contents
Set colFiles  = objFolder.Items

' Loop through the collection to find the file specified
If colFiles.Count > 0 Then
For Each objFile In colFiles
    If LCase( objFile.Path ) = LCase( strFile ) Then
        ' Print the file with its associated print command
        objFile.InvokeVerbEx( "Print" )
    End If
Next
End If


Sub Syntax
Dim strMsg
strMsg = "Print.vbs,  Version 1.00" _
       & vbCrLf _
       & "Print a file - ANY file - on the default printer" _
       & vbCrLf & vbCrLf _
       & "Usage:  " & UCase( WScript.ScriptName ) & "  filename"  _
       & vbCrLf & vbCrLf _
       & "Where:  "filename"  specifies the file to be printed (no wildcards)" _
       & vbCrLf & vbCrLf _
       & "Notes:  This script will only work if a print command for the"   _
       & vbCrLf _
       & "        file's associated file type is defined in the registry." _
       & vbCrLf _
       & "        When the associated program is used to open and print"   _
       & vbCrLf _
       & "        the file, the program will not be closed automatically."          _
       & vbCrLf _
       & "        This script may conflict with my DefOpen.bat script."    _
       & vbCrLf & vbCrLf _
       & "Written by Rob van der Woude" _
       & vbCrLf _
       & "http://www.robvanderwoude.com"
WScript.Echo strMsg
WScript.Quit 1
End Sub
Requirements:
Windows version:any
Network:N/A
Client software:Internet Explorer 4 for Windows 95/98/NT 4
Script Engine:any
Summarized:Should work in Windows 98 SE or later, or with Internet Explore 4 or later.




<h2 id="KillProcess">Kill a Process</h2>
<h2>&emsp;Kill a Process By Name</h2>
<a href="http://msdn.microsoft.com/en-us/library/aa394372.aspx">Win32_Process</a>
VBScript Code:

KillProc "outlook.exe"

Sub KillProc( myProcess )
'Authors: Denis St-Pierre and Rob van der Woude
'Purpose: Kills a process and waits until it is truly dead

Dim blnRunning, colProcesses, objProcess
blnRunning = False

Set colProcesses = GetObject( _
        "winmgmts:{impersonationLevel=impersonate}" _
        ).ExecQuery( "Select * From Win32_Process" )
For Each objProcess in colProcesses
    If LCase( myProcess ) = LCase( objProcess.Name ) Then
        ' Confirm that the process was actually running
        blnRunning = True
        ' Get exact case for the actual process name
        myProcess  = objProcess.Name
        ' Kill all instances of the process
        objProcess.Terminate()
    End If
Next

If blnRunning Then
    ' Wait and make sure the process is terminated.
    ' Routine written by Denis St-Pierre.
    Do Until Not blnRunning
        Set colProcesses = GetObject( _
                "winmgmts:{impersonationLevel=impersonate}" _
                ).ExecQuery( "Select * From Win32_Process Where Name = '" _
              & myProcess & "'" )
        WScript.Sleep 100 'Wait for 100 MilliSeconds
        If colProcesses.Count = 0 Then 'If no more processes are running, exit loop
 blnRunning = False
        End If
    Loop
    ' Display a message
    WScript.Echo myProcess & " was terminated"
Else
    WScript.Echo "Process """ & myProcess & """ not found"
End If
End Sub
Requirements:
Windows version:NT 4, 2000, XP, Server 2003, or Vista
Network:any
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI
CORE 1.5</a> for Windows NT 4
Script Engine:WSH (replace the WScript.Echo and WScript.Sleep lines to make this work in HTAs)
Summarized:Works in Windows NT 4 or later, requires <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> for Windows NT 4.
<em>Won't work in Windows 95, 98 or ME.</em>
<h2>&emsp;Kill a Process By Window Title</h2>
<a href="vbsaddons.php#JSSys3">JSSys3</a>
VBScript Code:

' Close a window based on its window title
' Demo of CloseProgram() method in JSWare's JSSys3.dll
' http://www.jsware.net/jsware/scripts.php5#jssys

Option Explicit

Dim arrProcesses, arrWindowTitles
Dim i, intProcesses
Dim objJSSys
Dim strProcList

Set objJSSys = CreateObject( "JSSys3.ops" )
' Close Notepad, ask for confirmation if there are unsaved changes
objJSSys.CloseProgram "Untitled - Notepad", 1
Set objJSSys = Nothing
Requirements:
Windows version:NT 4, 2000, XP, Server 2003, or Vista
Network:any
Client software:<a href="vbsaddons.php#JSSys3">JSSys3</a>, <a href="https://www.microsoft.com/en-us/download/details.aspx?id=24417">VB6 Runtimes</a>
Script Engine:any
Summarized:Works in Windows NT 4 or later, requires
<a href="vbsaddons.php#JSSys3">JSSys3</a> and <a href="https://www.microsoft.com/en-us/download/details.aspx?id=24417">VB6 Runtimes</a>.




<h2><k>Get the Current Script's Process ID</k></h2>
WMI: Win32_Process
VBScript Code:<a href="./files/getmypid.zip">Download</a> <a href="./files/getmypid.zip">&#x1f4be;</a>
<span>Option</span> Explicit<span>Dim</span> intPID<span>Dim</span> colItems, objItem, objWMIService, wshShell<span>Dim</span> strCommand, strTitle <span>If</span> WScript<span>.Arguments.Count</span> <span>></span> <span>0</span> <span>Then</span> Syntax <span>On</span> <span>Error</span> <span>Resume</span> <span>Next</span> strTitle   = <a href="http://www.google.com/search?q=RND+site:msdn.microsoft.com"><span>Rnd</span></a><span>&#40;</span> <a href="http://www.google.com/search?q=SECOND+site:msdn.microsoft.com"><span>Second</span></a><span>&#40;</span> Now <span>&#41;</span> <span>&#41;</span> & <span>" "</span> & <a href="http://www.google.com/search?q=FORMATDATETIME+site:msdn.microsoft.com"><span>FormatDateTime</span></a><span>&#40;</span> Now, vbShortTime <span>&#41;</span>strCommand = <span>"cmd.exe /k title "</span> & strTitle <span>' Spawn a child processSet</span> wshShell = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span>CreateObject</span></a><span>&#40;</span> <span>"WScript.Shell"</span> <span>&#41;</span>wshShell<span>.Run</span> strCommand, <span>7</span>, <span>FalseIf</span> Err <span>Then</span> WScript<span>.Quit</span> <span>-1Set</span> wshShell = <span>Nothing</span> <span>Set</span> objWMIService = GetObject<span>&#40;</span> <span>"winmgmts://./root/cimv2"</span> <span>&#41;</span> <span>' Get the newly spawned process' parent process IDSet</span> colItems = objWMIService<span>.ExecQuery&#40;</span> <span>"SELECT * FROM Win32_Process WHERE CommandLine LIKE '%cmd.exe% /k title "</span> & strTitle & <span>"'"</span> <span>&#41;If</span> Err <span>Then</span> WScript<span>.Quit</span> <span>-1For</span> <span>Each</span> objItem <span>In</span> colItemsintPID = objItem<span>.ParentProcessIdIf</span> Err <span>Then</span> WScript<span>.Quit</span> <span>-1' Terminate the spawned process</span>objItem<span>.TerminateIf</span> Err <span>Then</span> WScript<span>.Quit</span> <span>-1Next</span> <span>' The parent of that parent process is the current script engineSet</span> colItems = objWMIService<span>.ExecQuery&#40;</span> <span>"SELECT * FROM Win32_Process WHERE ProcessId="</span> & intPID <span>&#41;If</span> Err <span>Then</span> WScript<span>.Quit</span> <span>-1For</span> <span>Each</span> objItem <span>In</span> colItemsintPID = objItem<span>.ParentProcessIdIf</span> Err <span>Then</span> WScript<span>.Quit</span> <span>-1Next</span> <span>Set</span> colItems      = <span>NothingSet</span> objWMIService = <span>Nothing</span> <span>On</span> <span>Error</span> <span>Goto</span> <span>0</span> WScript<span>.Echo</span> intPIDWScript<span>.Quit</span> intPID  <span>Sub</span> Syntax<span>Dim</span> strMsgstrMsg = <span>"GetMyPID.vbs,  Version 1.00"</span> _       & vbCrLf _       & <span>"Return this script's process ID, both on screen and as "errorlevel"</span> _       & vbCrLf & vbCrLf _       & <span>"Usage:  CSCRIPT.EXE //NoLogo GetMyPID.vbs"</span> _       & vbCrLf & vbCrLf _       & <span>"Note:   The script's return code ("errolevel") equals the PID, or"</span> _       & vbCrLf _       & <span>"        will be -1 in case of errors."</span> _       & vbCrLf & vbCrLf _       & <span>"Written by Rob van der Woude"</span> _       & vbCrLf _       & <span>"http://www.robvanderwoude.com"</span>WScript<span>.Echo</span> strMsgWScript<span>.Quit</span> <span>-1End</span> <span>Sub</span>
Requirements:
Windows version:XP Pro or later
Network:any
Script Engine:any
Summarized:Works in Windows XP pro or later versions with all scripting engines.






<h2 id="Restart">Restart a Service</h2>
<a href="http://msdn.microsoft.com/en-us/library/aa394418.aspx">Win32_Service</a>
VBScript Code:

RestartService "Messenger", 0

Sub RestartService( myService, blnQuiet )
' This subroutine restarts a service
' Arguments:
' myService     use the service's DisplayName
' blnQuiet      if False, the state of the service is displayed
'               every second during the restart procedure
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim colServices, colServicesTest, objService
Dim objServiceTest, objWMIService, strQuery, strTest

' Create a WMI object
Set objWMIService = GetObject( "winmgmts:\\.\root\CIMV2" )

' Query the services for "our" service
strQuery = "SELECT * FROM Win32_Service WHERE DisplayName='" & myService & "'"
Set colServices = objWMIService.ExecQuery( strQuery, "WQL", 48 )

' Loop through the "collection" of returned services
For Each objService In colServices
    ' See if we need to tell the user we're going to stop the service
    If Not blnQuiet Then
        WScript.Echo "Stopping " & myService
    End If

    ' Stop the service
    objService.StopService

    ' Wait until the service is stopped
    Do Until strTest = "Stopped"
        ' Create a new object for our service; this work-around is required
        ' since otherwise the service's state information isn't properly updated
        Set colServicesTest = objWMIService.ExecQuery( strQuery, "WQL", 48 )

        ' Loop through the "collection" of returned services
        For Each objServiceTest In colServicesTest
 ' Check the service's state
 strTest = objServiceTest.State
 ' See if we need to show the progress
 If Not blnQuiet Then
     WScript.Echo "State: " & strTest
 End If
 ' Wait 1 second
 WScript.Sleep 1000
        Next

        ' Clear the temporary object
        Set colServicesTest = Nothing
    Loop

    ' See if we need to tell the user we're going to (re)start the service
    If Not blnQuiet Then
        WScript.Echo "Starting " & myService
    End If

    ' Start the service
    objService.StartService

    ' Wait until the service is running again
    Do Until strTest = "Running"
        ' Create a new object for our service; this work-around is required
        ' since otherwise the service's state information isn't properly updated
        Set colServicesTest = objWMIService.ExecQuery( strQuery, "WQL", 48 )

        ' Loop through the "collection" of returned services
        For Each objServiceTest In colServicesTest
 ' Check the service's state
 strTest = objServiceTest.State
 ' See if we need to show the progress
 If Not blnQuiet Then
     WScript.Echo "State: " & strTest
 End If
 ' Wait 1 second
 WScript.Sleep 1000
        Next

        ' Clear the temporary object
        Set colServicesTest = Nothing
    Loop
Next
End Sub
Requirements:
Windows version:NT 4, 2000, XP, Server 2003, or Vista
Network:any
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> for Windows NT 4
Script Engine:WSH (replace the WScript.Echo and WScript.Sleep lines to make this work in HTAs)
Summarized:Works in Windows NT 4 or later, requires <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> for Windows NT 4.
<em>Won't work in Windows 95, 98 or ME.</em>




<h2><k>Registry</k></h2>
WSH Shell
VBScript Code:

' Create a WSH Shell object:
Set wshShell = CreateObject( "WScript.Shell" )
'
' Create a new key:
wshShell.RegWrite "HKCU\TestKey\", ""

' Create a new DWORD value:
wshShell.RegWrite "HKCU\TestKey\DWordTestValue", 1, "REG_DWORD"

' Create a new subkey and a string value in that new subkey:
wshShell.RegWrite "HKCU\TestKey\SubKey\StringTestValue", "Test", "REG_SZ"

' Read the values we just created:
WScript.Echo "HKCU\TestKey\DWordTestValue = " _
       & wshShell.RegRead( "HKCU\TestKey\DWordTestValue" )
WScript.Echo "HKCU\TestKey\SubKey\StringTestValue = """ _
       & wshShell.RegRead( "HKCU\TestKey\SubKey\StringTestValue" ) & """"

' Delete the subkey and key and the values they contain:
wshShell.RegDelete "HKCU\TestKey\SubKey\"
wshShell.RegDelete "HKCU\TestKey\"

' Note: Since the WSH Shell has no Enumeration functionality, you cannot
'       use the WSH Shell object to delete an entire "tree" unless you
'       know the exact name of every subkey.
'       If you don't, use the WMI StdRegProv instead.

' Release the object
Set wshShell = Nothing
Requirements:
Windows version:any
Network:any
Client software:N/A
Script Engine:WSH
Summarized:Works in any Windows version.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, <em>not in HTAs.</em>




<h2><k>Registry</k></h2>
<a href="http://msdn.microsoft.com/en-us/library/aa393664.aspx">WMI StdRegProv</a>
VBScript Code:
Because of its length, only the code for the function itself is shown on this  page.
The <a href="./files/wmi_reg_vbs.txt">demo script</a> that shows how to use this function is available as a separate <a href="./files/wmi_reg.zip">download</a>.

Function ReadRegValue( myComputer, myRegPath, myRegValue )
' This function reads a value from the registry of any WMI
' enabled computer.
'
' Arguments:
' myComputer        a computer name or IP address,
'                   or a dot for the local computer
' myRegPath         a full registry key path, e.g.
'                   HKEY_CLASSES_ROOT\.jpg or
'                   HKLM\SOFTWARE\Microsoft\DirectX
' myRegValue        the value name to be queried, e.g.
'                   InstalledVersion or "" for default
'                   values
'
' The function returns an array with the following elements:
' ReadRegValue(0)   the computer name (the first argument)
' ReadRegValue(1)   the hive number (see const declarations)
' ReadRegValue(2)   the key path without the hive
' ReadRegValue(3)   the value name (the third argument)
' ReadRegValue(4)   the error number: 0 means no error
' ReadRegValue(5)   the data type of the result
' ReadRegValue(6)   the actual data, or the first element of an
'                   array of data for REG_BINARY or REG_MULTI_SZ
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com


' Standard housekeeping
Const HKEY_CLASSES_ROOT              = &H80000000
Const HKEY_CURRENT_USER              = &H80000001
Const HKEY_LOCAL_MACHINE             = &H80000002
Const HKEY_USERS                     = &H80000003
Const HKEY_CURRENT_CONFIG            = &H80000005
Const HKEY_DYN_DATA                  = &H80000006 ' Windows 95/98 only

Const REG_SZ                         =  1
Const REG_EXPAND_SZ                  =  2
Const REG_BINARY                     =  3
Const REG_DWORD                      =  4
Const REG_DWORD_BIG_ENDIAN           =  5
Const REG_LINK                       =  6
Const REG_MULTI_SZ                   =  7
Const REG_RESOURCE_LIST              =  8
Const REG_FULL_RESOURCE_DESCRIPTOR   =  9
Const REG_RESOURCE_REQUIREMENTS_LIST = 10
Const REG_QWORD                      = 11

Dim arrRegPath, arrResult(), arrValueNames, arrValueTypes
Dim i, objReg, strHive, valRegError, valRegType, valRegVal

' Assume no error, for now
valRegError = 0

' Split the registry path in a hive part
' and the rest, and check if that succeeded
arrRegPath = Split( myRegPath, "\", 2 )
If IsArray( arrRegPath ) Then
    If UBound( arrRegPath ) &lt;> 1 Then valRegError = 5
Else
    valRegError = 5
End If

' Convert the hive string to a hive number
Select Case UCase( arrRegPath( 0 ) )
    Case "HKCR", "HKEY_CLASSES_ROOT"
        strHive = HKEY_CLASSES_ROOT
    Case "HKCU", "HKEY_CURRENT_USER"
        strHive = HKEY_CURRENT_USER
    Case "HKLM", "HKEY_LOCAL_MACHINE"
        strHive = HKEY_LOCAL_MACHINE
    Case "HKU",  "HKEY_USERS"
        strHive = HKEY_USERS
    Case "HKCC", "HKEY_CURRENT_CONFIG"
        strHive = HKEY_CURRENT_CONFIG
    Case "HKDD", "HKEY_DYN_DATA"
        strHive = HKEY_DYN_DATA
    Case Else
        valRegError = 5
End Select

' Abort if any error occurred, and return an error code
If valRegError > 0 Then
    ReadRegValue = Array( myComputer, myRegPath, _
               myRegPath, myRegValue, _
               valRegError, "-", "-" )
    Exit Function
End If

' Initiate custom error handling
On Error Resume Next

' Create a WMI registry object
Set objReg = GetObject( "winmgmts:{impersonationLevel=impersonate}!//" _
           & myComputer & "/root/default:StdRegProv" )

' Abort on failure to create the object
If Err Then
    valRegError = Err.Number
    Err.Clear
    On Error Goto 0
    ReadRegValue = Array( myComputer, myRegPath, _
               myRegPath, myRegValue, _
               valRegError, "-", "-" )
    Exit Function
End If

' Get a list of all values in the registry path;
' we need to do this in order to find out the
' exact data type for the requested value
objReg.EnumValues strHive, arrRegPath( 1 ), arrValueNames, arrValueTypes

' If no values were found, we'll need to retrieve a default value
If Not IsArray( arrValueNames ) Then
    arrValueNames = Array( "" )
    arrValueTypes = Array( REG_SZ )
End If

If Err Then
    ' Abort on failure, returning an error code
    valRegError = Err.Number
    Err.Clear
    On Error Goto 0
    ReadRegValue = Array( myComputer, myRegPath, _
               myRegPath, myRegValue, _
               valRegError, "-", "-" )
    Exit Function
Else
    ' Loop through all values in the list . . .
    For i = 0 To UBound( arrValueNames )
        ' . . . and find the one requested
        If UCase( arrValueNames( i ) ) = UCase( myRegValue ) Then
 ' Read the requested value's data type
 valRegType = arrValueTypes( i )
 ' Based on the data type, use the appropriate query to retrieve the data
 Select Case valRegType
     Case REG_SZ
         objReg.GetStringValue strHive, arrRegPath( 1 ), _
         myRegValue, valRegVal
         If Err Then valRegError = Err.Number
     Case REG_EXPAND_SZ
         objReg.GetExpandedStringValue strHive, arrRegPath( 1 ), _
      myRegValue, valRegVal
         If Err Then valRegError = Err.Number
     Case REG_BINARY ' returns an array of bytes
         objReg.GetBinaryValue strHive, arrRegPath( 1 ), _
         myRegValue, valRegVal
         If Err Then valRegError = Err.Number
     Case REG_DWORD
         objReg.GetDWORDValue strHive, arrRegPath( 1 ), _
        myRegValue, valRegVal
         If Err Then valRegError = Err.Number
     Case REG_MULTI_SZ ' returns an array of strings
         objReg.GetMultiStringValue strHive, arrRegPath( 1 ), _
   myRegValue, valRegVal
         If Err Then valRegError = Err.Number
     Case REG_QWORD
         objReg.GetQWORDValue strHive, arrRegPath( 1 ), _
        myRegValue, valRegVal
         If Err Then valRegError = Err.Number
     Case Else
         valRegError = 5
 End Select
        End If
    Next
End If

' Check if an error occurred
If valRegError > 0 Then
    valRegType = ""
    valRegVal  = ""
    Err.Clear
    On Error Goto 0
End If

' Return the data in an array
If valRegType = REG_BINARY Or valRegType = REG_MULTI_SZ Then
    ' First, deal with registry data which is
    ' returned as array instead of single value
    ReDim Preserve arrResult( 6 + UBound( valRegVal ) )
    arrResult( 0 ) = myComputer
    arrResult( 1 ) = strHive
    arrResult( 2 ) = arrRegPath( 1 )
    arrResult( 3 ) = myRegValue
    arrResult( 4 ) = valRegError
    arrResult( 5 ) = valRegType
    For i = 0 To UBound( valRegVal )
        arrResult( 6 + i ) = valRegVal( i )
    Next
    ReadRegValue = arrResult
Else
    ReadRegValue = Array( myComputer, strHive, arrRegPath( 1 ), _
               myRegValue, valRegError, valRegType, valRegVal )
End If

' Finished
Set objReg = Nothing
On Error Goto 0
End Function
Requirements:
Windows version:ME, 2000, XP, Server 2003, or Vista (95, 98, NT 4 with <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a>)
Network:any
Client software:<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> for Windows 95, 98 or NT 4
Script Engine:any
Summarized:Can work on any Windows computer, but <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=afe41f46-e213-4cbf-9c5b-fbf236e0e875&DisplayLang=en">WMI CORE 1.5</a> is required for Windows 95, 98 or NT 4.
Can be used in *.vbs with CSCRIPT.EXE or WSCRIPT.EXE, as well as in HTAs.




<h2><k>Regular Expressions in VBScript</k></h2>
Nowadays, <a href="regexp.php">regular expressions</a> are a powerful part of most programming and scripting languages.
They allow us to search strings or blocks of text using <em>patterns</em> instead of just fixed "filter strings".

<h2 id="RegExp">&emsp;The RegExp object</h2>
In VBScript, Regular Expressions use the <code>RegExp</code> object, which was introduced in Windows Script Host version 5:

Set objRE = New RegExp

Three <em>properties</em> are available for the <code>RegExp</code> object:


Globalif TRUE, find <em>all</em> matches, if FALSE find only the <em>first</em> match
IgnoreCaseif TRUE perform a case-<em>in</em>sensitive search, if FALSE perform a case-sensitive search
Patternthe RegExp <a href="#Patterns">pattern</a> to search for


Three <em>methods</em> are available for the <code>RegExp</code> object:


Test( <em>teststring</em> )returns TRUE if a match is found in <em>teststring</em>
Execute( <em>teststring</em> )returns an object with the following properties:

Countthe number of matches found in <em>teststring</em> (maximum is 1 if <code>.Global = False</code>)
Itemthe matches themselves as objects, each with the following properties:

FirstIndexthe location of the matching substring in <em>teststring</em>
Lengththe length of the matching substring
SubMatchesif parentheses were used in the pattern: the matching pieces of the pattern between sets of parentheses as objects, each with the following properties:

Countthe number of submatches found in the match
Itemthe string value of the submatch

Valuethe string value of the match


Replace( <em>teststring</em>, <em>replacement</em> )returns the original <em>teststring</em> with the first (<code>.Global = False</code>) or all (<code>.Global = True</code>) match(es) replaced by a new <em>replacement</em> string


<h2 id="Patterns">&emsp;Patterns</h2>
In general, patterns for WSH's RegExp object are like regex patterns in any scripting language.
Special characters and <em>backreferences</em> may differ from other languages, though.

Use the MSDN <a href="http://msdn.microsoft.com/en-us/library/f97kw5ka.aspx">list of special characters for WSH's RegExp object</a>.

<h2 id="Examples">&emsp;Some Examples</h2>
<h3>&emsp;Test if a string is a valid e-mail address:</h3>
In this example, all we want to know is whether a string is a valid e-mail address or not.
So we can use the RegExp object's <code>Test</code> method.

strEmail = "rob.van.der.woude@nodomainofmine.co.uk"

Set objRE = New RegExp

With objRE
.Pattern    = "&circ;([\w-]+\.)*[\w-]+@([\w-]+\.)+[a-z]{2,4}$"
.IgnoreCase = True
.Global     = False
End With

' Test method returns TRUE if a match is found
If objRE.Test( strEmail ) Then
WScript.Echo strEmail & " is a valid e-mail address"
Else
WScript.Echo strEmail & " is NOT a valid e-mail address"
End If

Set objRE = Nothing

<h3>&emsp;Extract the domain name from an e-mail address:</h3>
Now that we know that we have a valid e-mail address, let's extract the domain name.
We will now use the RegExp object's <code>Execute</code> method, because we want the matching string itself.

strEmail = "rob.van.der.woude@nodomainofmine.co.uk"

Set objRE = New RegExp

With objRE
.Pattern    = "&circ;([\w-]+\.)*[\w-]+@(([\w-]+\.)+[a-z]{2,4})$"
.IgnoreCase = True
.Global     = False
End With

Set objMatch = objRE.Execute( strEmail )

' We should get only 1 match since the Global property is FALSE
If objMatch.Count = 1 Then
' Item(0) is the (first and only) matching e-mail address,
' Submatches(1) is the substring between the second set of
' parentheses (all indexes are zero based)
WScript.Echo "The domain name for " & strEmail _
           & " is " & objMatch.Item(0).Submatches(1) & "."
Else
WScript.Echo "No domain name was found for " & strEmail & "."
End If

Set objMatch = Nothing
Set objRE    = Nothing

<h3>&emsp;Change the domain name in an e-mail address</h3>
<h3>&emsp;(but not the top level domain):</h3>
Let's combine what we got so far, and add some code to change the domain name from "nodomainofmine.co.uk" to "myowndomain.co.uk".
This time we'll use the <code>Replace</code> method.

strEmail = "rob.van.der.woude@nodomainofmine.co.uk"

Set objRE = New RegExp

With objRE
.Pattern    = "&circ;([\w-]+\.)*[\w-]+@([\w-]+\.)+[a-z]{2,4}$"
.IgnoreCase = True
.Global     = False
End With

' Test method returns TRUE if a match is found
If objRE.Test( strEmail ) Then
WScript.Echo " & strEmail & " is a valid e-mail address."
Else
WScript.Echo " & strEmail & " is NOT a valid e-mail address."
Set objRE = Nothing
WScript.Quit 1
End If

objRE.Pattern = "&circ;([\w-]+\.)*[\w-]+@([\w-]+)(\.[\w-]+)*\.[a-z]{2,4}$"

Set objMatch = objRE.Execute( strEmail )

' We should get only 1 match since the Global property is FALSE
If objMatch.Count = 1 Then
' Item(0) is the (first and only) matching e-mail address,
' Submatches(1) is the substring between the second set of
' parentheses (all indexes are zero based)
strDomain = objMatch.Item(0).Submatches(1)
WScript.Echo "The string to be replaced is " & strDomain & "."
Else
WScript.Echo "No domain name was found for " & strEmail & "."
Set objRE = Nothing
WScript.Quit 1
End If

Set objMatch = Nothing

objRE.Pattern = "@" & strDomain
strNewDomain  = "myowndomain"

strNewMail = objRE.Replace( strEmail, "@" & strNewDomain )

WScript.Echo "The new e-mail address is " & strNewMail & "."

Set objRE = Nothing



Yes, I know, in real life we wouldn't replace the name like this, it would have been much easier <em>and</em> safer to use

strNewMail = Replace( strEmail, "@" & strDomain, "@" & strNewDomain )

instead.

<h2 id="MoreSamples">&emsp;More Samples</h2>
<a href="vbstech_data_string.php#Val">Denis St-Pierre's <code>Val( )</code> function</a>
<a href="regexpexamples.php">Regular Expressions Examples</a>


<h2><k>Shortcuts</k></h2>
GetShortcut
VBScript Code:

' Author: Denis St-Pierre
' *Retrieves* Shortcut info without using WMI 
' The *Undocumented* Trick: use the ".CreateShortcut" method without the 
' ".Save" method; works like a GetShortcut when the shortcut already exists!

strTargetPath="C:\Documents and Settings\All Users\Desktop\My Shortcut.lnk"

Set wshShell    = CreateObject("WScript.Shell")
' CreateShortcut works like a GetShortcut when the shortcut already exists!
Set objShortcut = wshShell.CreateShortcut(strTargetPath)

' For URL shortcuts, only ".FullName" and ".TargetPath" are valid
WScript.Echo "Full Name         : " & objShortcut.FullName
WScript.Echo "Arguments         : " & objShortcut.Arguments
WScript.Echo "Working Directory : " & objShortcut.WorkingDirectory
WScript.Echo "Target Path       : " & objShortcut.TargetPath
WScript.Echo "Icon Location     : " & objShortcut.IconLocation
WScript.Echo "Hotkey            : " & objShortcut.Hotkey
WScript.Echo "Window Style      : " & objShortcut.WindowStyle
WScript.Echo "Description       : " & objShortcut.Description

Set objShortcut = Nothing
Set wshShell    = Nothing
Requirements:
Windows version:any
Network:any
Client software:N/A
Script Engine:any
Summarized:Should work in any Windows version, with any script engine.




<h2><k>Delays</k></h2>
I often need delays in my scripts, e.g. to wait for an object or a connection to get ready.

The easiest way to implement a 1 second delay, of course, is WSH's <code>WScript.Sleep 1000</code> (delay in milliseconds).

Dim objIE
' Create an IE object
Set objIE = CreateObject( "InternetExplorer.Application" )
objIE.Navigate "about:blank"
' Wait till IE is ready
Do While objIE.Busy
<span>WScript.Sleep 1000</span>
Loop

That's fine for scripts running in CSCRIPT.EXE or WSCRIPT.EXE, but in <abbr title="HTml Application">HTA</abbr>s or <abbr title="Windows Script Component">WSC</abbr>s there is no WScript object, and thus no <code>WScript.Sleep</code>, so we need an alternative.

A quick-and-<em>really</em>-dirty way is just remove the <code>WScript.Sleep</code> line:

Dim objIE
' Create an IE object
Set objIE = CreateObject( "InternetExplorer.Application" )
objIE.Navigate "about:blank"
' Wait till IE is ready
<span>Do While objIE.Busy
Loop</span>

This will work, but the script will loop hundreds of times per second, and you'll see your <abbr title="Central Processing Unit or, in this case, processor">CPU</abbr> usage remain at 100% until the script exits the loop.
That may sometimes be acceptable, e.g. in a login script when no time critical processes are running, but you wouldn't want to run a script like that while burning a CD or watching a HD video on YouTube, would you?

You can use the <a href="http://msdn.microsoft.com/en-us/library/ms536753.aspx">setTimeout</a> and <a href="http://msdn.microsoft.com/en-us/library/ms536357.aspx">clearTimeout</a> methods in <abbr title="HTml Application">HTA</abbr>s, well explained in this <a href="http://blogs.technet.com/b/heyscriptingguy/archive/2006/03/30/how-can-i-temporarily-pause-a-script-in-an-hta.aspx">Scripting Guys article</a>.
However, that will start a command in a separate process, while the script itself continues and won't wait for the command to finish (more or less like the <a href="ntstart.php">START</a> command in batch files, with an added time delay).
This may work in some cases, but it isn't always practical, as you will need to split the code at the delay (try to use it within a loop and it's really going to look messy).

While on the subject of batch commands: you can "embed" a batch command in your VBScript code to get a delay in Windows 7 and later versions:

' Get a 10 seconds delay
Delay 10

Sub Delay( seconds )
Dim wshShell, strCmd
Set wshShell = CreateObject( "WScript.Shell" )
strCmd = wshShell.ExpandEnvironmentStrings( "%COMSPEC% /C (TIMEOUT.EXE /T " & seconds & " /NOBREAK)" )
wshShell.Run strCmd, 0, 1
Set wshShell = Nothing
End Sub

Using <a href="wait.php#TIMEOUT">TIMEOUT</a> is a lot more reliable than the old <a href="wait.php#PING">PING</a> trick &mdash; which <em>does</em> work in older Windows versions, though, as long as it supports TCP/IP:

' Get a 10 seconds delay
Delay 10

Sub Delay( seconds )
Dim wshShell, strCmd
Set wshShell = CreateObject( "WScript.Shell" )
strCmd = wshShell.ExpandEnvironmentStrings( "%COMSPEC% /C (PING.EXE -n " & ( seconds + 1 ) & " localhost >NUL 2>&1)" )
wshShell.Run strCmd, 0, 1
Set wshShell = Nothing
End Sub

This will work in <abbr title="HTml Application">HTA</abbr>s and <abbr title="Windows Script Component">WSC</abbr>s, as well as in WSCRIPT.EXE/CSCRIPT.EXE (though in the latter, <code>WScript.Sleep</code> is a much better choice, of course).

See my <a href="wait.php">Wait</a> page for a detailed explanation of time delays with the <code>PING</code> command.

<h2><k>Browse Folder Dialog</k></h2>
Shell.Application
VBScript Code:

Option Explicit

WScript.Echo BrowseFolder( "C:\Program Files", True )
WScript.Echo BrowseFolder( "My Computer", False )
WScript.Echo BrowseFolder( "", False )


Function BrowseFolder( myStartLocation, blnSimpleDialog )
' This function generates a Browse Folder dialog
' and returns the selected folder as a string.
'
' Arguments:
' myStartLocation   [string]  start folder for dialog, or "My Computer", or
'                             empty string to open in "Desktop\My Documents"
' blnSimpleDialog   [boolean] if False, an additional text field will be
'                             displayed where the folder can be selected
'                             by typing the fully qualified path
'
' Returns:          [string]  the fully qualified path to the selected folder
'
' Based on the Hey Scripting Guys article
' "How Can I Show Users a Dialog Box That Only Lets Them Select Folders?"
' http://www.microsoft.com/technet/scriptcenter/resources/qanda/jun05/hey0617.mspx
'
' Function written by Rob van der Woude
' http://www.robvanderwoude.com
Const MY_COMPUTER   = &H11&
Const WINDOW_HANDLE = 0 ' Must ALWAYS be 0

Dim numOptions, objFolder, objFolderItem
Dim objPath, objShell, strPath, strPrompt

' Set the options for the dialog window
strPrompt = "Select a folder:"
If blnSimpleDialog = True Then
    numOptions = 0      ' Simple dialog
Else
    numOptions = &H10&  ' Additional text field to type folder path
End If

' Create a Windows Shell object
Set objShell = CreateObject( "Shell.Application" )

' If specified, convert "My Computer" to a valid
' path for the Windows Shell's BrowseFolder method
If UCase( myStartLocation ) = "MY COMPUTER" Then
    Set objFolder = objShell.Namespace( MY_COMPUTER )
    Set objFolderItem = objFolder.Self
    strPath = objFolderItem.Path
Else
    strPath = myStartLocation
End If

Set objFolder = objShell.BrowseForFolder( WINDOW_HANDLE, strPrompt, _
         numOptions, strPath )

' Quit if no folder was selected
If objFolder Is Nothing Then
    BrowseFolder = ""
    Exit Function
End If

' Retrieve the path of the selected folder
Set objFolderItem = objFolder.Self
objPath = objFolderItem.Path

' Return the path of the selected folder
BrowseFolder = objPath
End Function
Requirements:
Windows version:any (Windows 95 and NT 4 require Internet Explorer 4)
Network:N/A
Client software:Internet Explorer 4 or later for Windows 95 and NT 4
Script Engine:any
Summarized:Works in any Windows version, provided Internet Explorer 4 or later is installed.
<img data-src="https://www.robvanderwoude.com/pictures/browsefolder_shellapplication.gif" width="326" height="322" />




<h2><k>Change Default Printer Dialog</k></h2>
This dialog can be used to change printer settings too.
All changes made in this dialog are permanent, i.e. they will be the new default settings.






MSComDlg.CommonDialog.1
VBScript Code:

Option Explicit

Dim strKey, wshShell

' Create WScript.Shell object to read the registry
Set wshShell = CreateObject( "WScript.Shell" )

' Read the current default printer from registry
strKey = "HKEY_CURRENT_USER\Software\Microsoft" _
   & "\Windows NT\CurrentVersion\Windows\Device"
WScript.Echo "Current Default printer : " _
       & Trim( Split( wshShell.RegRead( strKey ), "," )(0) )

' Call the Print Dialog to change the default printer
WScript.Echo "Choose a new default printer..."
ChangePrinterSettings

' Read the new default printer from registry
WScript.Echo "New Default printer     : " _
       & Trim( Split( wshShell.RegRead( strKey ), "," )(0) )

' Release the Shell object
Set wshShell = Nothing


Sub ChangePrinterSettings( )
' Interactively change your printer settings, including the default
' printer. Click the "Print" button to confirm the new printer settings.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

Dim objPrnDlg, strPrompt, strTitle

Const vbOK     = 1
Const vbCancel = 2
Const vbAbort  = 3
Const vbRetry  = 4
Const vbIgnore = 5
Const vbYes    = 6
Const vbNo     = 7
     
' Explain there will be no OK button, the Print button must be
' clicked instead.
strPrompt = "In the next dialog, choose which printer will " _
          & "be the new Default Printer and press the " _
          & """Print"" button to confirm." & vbCrLf & vbCrLf _
          & "Note that any changes you make in the printer " _
          & "settings will be permanent, i.e. they will be " _
          & "the new default settings."
strTitle  = "Choose New Default Printer and/or Printer Settings"
If MsgBox( strPrompt, vbOKCancel, strTitle ) = vbOK Then
    ' Create a dialog object
    Set objPrnDlg = CreateObject( "MSComDlg.CommonDialog.1" )
    ' Make selections permanent
    objPrnDlg.PrinterDefault = True
    ' Open the Print dialog
    objPrnDlg.ShowPrinter
    ' Release the object
    Set objPrnDlg = Nothing
End If
End Sub
Requirements:
Windows version:any (except for the registry keys holding the default printer) as long as ComDlg32.ocx is installed and registered
Network:N/A
Client software:Requires ComDlg32.ocx, which is included with Visual Basic 5 and later and MS-Office 2000 and XP.
You can download <a href="https://support.microsoft.com/en-us/kb/896559">ComDlg32.ocx version 6</a> or <a href="http://support.microsoft.com/kb/167121">version 5</a> from Microsoft.com.
Script Engine:any
Summarized:The subroutine should work in any Windows version as long as ComDlg32.ocx is installed and registered.
<em>The registry keys for the default printer, used here for demonstration purposes only, are valid for Windows NT 4 and later only.</em>
<img data-src="https://www.robvanderwoude.com/pictures/changedefaultprinter_mscomdlgcommondialog1.gif" width="584" height="133" />
<img data-src="https://www.robvanderwoude.com/pictures/changedefaultprinter_mscomdlgcommondialog2.gif" width="464" height="423" />




<h2><k>Change Password Dialog</k></h2>
InternetExplorer.Application
VBScript Code:

Function IEChangePwd( myUserName )
' This function uses Internet Explorer to create a login dialog.
' It won't close until all fields have valid values and the OK
' button is clicked.
'
' Version:             2.11
' Last modified:       2013-11-07
'
' Arguments:  [string] user name
' Returns:    [array]  the old (0) and new (1) passwords
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
' Error handling code written by Denis St-Pierre
Dim arrPwd, blnValid, objIE
blnValid = False
' Create an IE object
Set objIE = CreateObject( "InternetExplorer.Application" )
' specify some of the IE window's settings
objIE.Navigate "about:blank"
objIE.Document.title = "Change password" & String( 80, "." )
objIE.ToolBar        = False
objIE.Resizable      = False
objIE.StatusBar      = False
objIE.Width          = 400
objIE.Height         = 240
' Center the dialog window on the screen
With objIE.Document.parentWindow.screen
    objIE.Left = (.availWidth  - objIE.Width ) \ 2
    objIE.Top  = (.availHeight - objIE.Height) \ 2
End With
' Wait till IE is ready
Do While objIE.Busy
    WScript.Sleep 200
Loop
' Insert the HTML code to prompt for user input
objIE.Document.body.innerHTML = "&lt;div align=""center"">&lt;table cellspacing=""5"">" _
& "&lt;tr nowrap>&lt;th colspan=""2"">Change password for " _
& myUserName & ":&lt;/th>&lt;/tr>&lt;tr nowrap>&lt;td>Old password:" _
& "&lt;/td>&lt;td>&lt;input type=""password"" size=""20"" id=" _
& """OldPassword"">&lt;/td>&lt;/tr>&lt;tr nowrap>&lt;td>New password:" _
& "&lt;/td>&lt;td>&lt;input type=""password"" size=""20"" id=" _
& """NewPassword"">&lt;/td>&lt;/tr>&lt;tr nowrap>&lt;td>Confirm " _
& "password:&lt;/td>&lt;td>&lt;input type=""password"" size=""20"" " _
& "id=""ConfirmPassword"">&lt;/td>&lt;/tr>&lt;/table>" _
& "&lt;p>&lt;input type=""hidden"" id=""OK"" name=""OK"" " _
& "value=""0"">&lt;input type=""submit"" value="" OK "" " _
& "onclick=""VBScript:OK.value=1"">&lt;/p>&lt;/div>"
' Hide the scrollbars
objIE.Document.body.style.overflow = "auto"
' Make the window visible
objIE.Visible = True
' Set focus on password input field
objIE.Document.all.OldPassword.focus

' Wait for valid input (2 non-empty equal passwords)
Do Until blnValid = True
    ' Wait till the OK button has been clicked
    On Error Resume Next
    Do While objIE.Document.all.OK.value = 0
        WScript.Sleep 200
        ' Error handling code by Denis St-Pierre
        If Err Then
 IEChangePwd = Array( "", "" )
 objIE.Quit
 Set objIE = Nothing
 Exit Function
        End If
    Loop
    On Error Goto 0
    ' Read the user input from the dialog window
    arrPwd = Array( objIE.Document.all.OldPassword.value, _
         objIE.Document.all.NewPassword.value, _
         objIE.Document.all.ConfirmPassword.value )
    ' Check if the new password and confirmed password match
    If arrPwd(1) = arrPwd(2) Then
        ' Check if the new password isn't empty
        If Trim( arrPwd(1) ) = "" Then
 MsgBox "The new password cannot be empty", _
        vbOKOnly + vbInformation + vbApplicationModal, _
        "Type new password"
 objIE.Document.all.NewPassword.value     = ""
 objIE.Document.all.ConfirmPassword.value = ""
 objIE.Document.all.OK.value              = 0
         objIE.Document.all.NewPassword.focus
        Else
 blnValid = True
        End If
    Else
        MsgBox "The new and confirmed passwords do not match.", _
    vbOKOnly + vbInformation + vbApplicationModal, _
    "Retype new password"
        objIE.Document.all.NewPassword.value     = ""
        objIE.Document.all.ConfirmPassword.value = ""
        objIE.Document.all.OK.value              = 0
     objIE.Document.all.NewPassword.focus
    End If
Loop
' Close and release the object
objIE.Quit
Set objIE = Nothing
' Return the passwords in an array
IEChangePwd = Array( arrPwd(0), arrPwd(1) )
End Function
<strong>Sample VBScript Code:</strong>

strUserName  = "JohnDoe"
arrPasswords = IEChangePwd( strUserName )
WScript.Echo "Change password for  : " & strUserName     & vbCrLf _
       & "The old password was : " & arrPasswords(0) & vbCrLf _
       & "The new password is  : " & arrPasswords(1)
Sample output:

Change password for  : JohnDoe
The old password was : oldpassword
The new password is  : NewPassword2





<img data-src="https://www.robvanderwoude.com/pictures/ie_changepassword_dialog.gif" width="400" height="240" />
Requirements:
Windows version:any
Network:any
Client software:Internet Explorer 4 or later
Script Engine:WSH (CSCRIPT and WSCRIPT)
(to use in HTAs, remove both <code>WScript.Sleep</code> lines)
Summarized:Works in all Windows versions with Internet Explorer 4 or later, remove both <code>WScript.Sleep</code> lines to use in HTAs.




<h2><k>Select Folder Dialog</k></h2>
Shell.Application
VBScript Code:

Option Explicit

Dim strPath

strPath = SelectFolder( "" )
If strPath = vbNull Then
WScript.Echo "Cancelled"
Else
WScript.Echo "Selected Folder: """ & strPath & """"
End If


Function SelectFolder( myStartFolder )
' This function opens a "Select Folder" dialog and will
' return the fully qualified path of the selected folder
'
' Argument:
'     myStartFolder    [string]    the root folder where you can start browsing;
' if an empty string is used, browsing starts
' on the local computer
'
' Returns:
' A string containing the fully qualified path of the selected folder
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim objFolder, objItem, objShell

' Custom error handling
On Error Resume Next
SelectFolder = vbNull

' Create a dialog object
Set objShell  = CreateObject( "Shell.Application" )
Set objFolder = objShell.BrowseForFolder( 0, "Select Folder", 0, myStartFolder )

' Return the path of the selected folder
If IsObject( objfolder ) Then SelectFolder = objFolder.Self.Path

' Standard housekeeping
Set objFolder = Nothing
Set objshell  = Nothing
On Error Goto 0
End Function
<strong>Requirements:</strong>
Windows version:any
Network:N/A
Client software:N/A
Script Engine:WSH
Summarized:Works in any Windows version.
<img data-src="https://www.robvanderwoude.com/pictures/selectfolderdialog365x424.gif" width="365" height="424" />




<h2><k>File Open Dialog</k></h2>
UserAccounts.CommonDialog
VBScript Code:

WScript.Echo "Selected file: " & GetFileName( "C:\", "" )
WScript.Echo "Selected file: " & GetFileName( "", "Text files|*.txt" )
WScript.Echo "Selected file: " & GetFileName( "", "MS Office documents|*.doc;*.xls;*.pps" )
WScript.Echo "Selected file: " & GetFileName( "C:\WINDOWS", "Bitmaps|*.bmp" )

Function GetFileName( myDir, myFilter )
' This function opens a File Open Dialog and returns the
' fully qualified path of the selected file as a string.
'
' Arguments:
'     myDir       is the initial directory; if no directory is
'                 specified "My Documents" is used;
'                 NOTE: this default requires the WScript.Shell
'                 object, and works only in WSH, not in HTAs!
'     myFilter    is the file type filter; format "File type description|*.ext"
' ALL arguments MUST get A value (use "" for defaults), OR otherwise you must
' use "On Error Resume Next" to prevent error messages.
'
' Dependencies:
' Requires NUSRMGRLib (nusrmgr.cpl), available in Windows XP and later.
' To use the default "My Documents" WScript.Shell is used, which isn't
' available in HTAs.
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com

' Standard housekeeping
Dim objDialog

' Create a dialog object
Set objDialog = CreateObject( "UserAccounts.CommonDialog" )

' Check arguments and use defaults when necessary
If myDir = "" Then
    ' Default initial folder is "My Documents"
    objDialog.InitialDir = CreateObject( "WScript.Shell" ).SpecialFolders( "MyDocuments" )
Else
    ' Use the specified initial folder
    objDialog.InitialDir = myDir
End If
If myFilter = "" Then
    ' Default file filter is "All files"
    objDialog.Filter = "All files|*.*"
Else
    ' Use the specified file filter
    objDialog.Filter = myFilter
End If

' Open the dialog and return the selected file name
If objDialog.ShowOpen Then
    GetFileName = objDialog.FileName
Else
    GetFileName = ""
End If
End Function
<strong>Requirements:</strong>
Windows version:Windows XP
Network:N/A
Client software:N/A
Script Engine:any (WSH if using default for directory)
Additional options:<code>
objDialog.Filter = "MS Office files|*.doc;*.xls;*.pps|Text files|*.txt|All files|*.*"
objDialog.FilterIndex = 1 'MS Office files
objDialog.FilterIndex = 2 'Text files
objDialog.FilterIndex = 3 'All files

objDialog.Flags = 1 'Check "Open file as read-only" checkbox in dialog
objDialog.Flags = 0 'Restore default read-write mode</code>
Summarized:Works in Windows XP only.
If used in HTAs, the initial directory <em>must</em> be specified.
<em>Doesn't work in any other Windows version.</em>
<img data-src="https://www.robvanderwoude.com/pictures/fileopen_useraccountscommondialog.gif" width="563" height="416" />
SAFRCFileDlg.FileOpen
VBScript Code:

Set objDialog = CreateObject( "SAFRCFileDlg.FileOpen" )

' Note: The dialog will be opened without any file name or
'       type filter, and in the "current" directory, e.g. as
'       remembered from the last "SAFRCFileDlg.FileOpen" or
'       "SAFRCFileDlg.FileSave" dialog!
If objDialog.OpenFileOpenDlg Then
WScript.Echo "objDialog.FileName = " & objDialog.FileName
End If
Requirements:
Windows version:Windows XP, Server 2003
Network:N/A
Client software:N/A
Script Engine:any
Summarized:Works in all Windows XP versions and in Server 2003.
<em>Doesn't work in Windows 95, 98, ME, NT 4, 2000 or 7, not sure about Vista.</em>
<img data-src="https://www.robvanderwoude.com/pictures/fileopen_safrcfiledlg.gif" width="563" height="416" />
InternetExplorer.Application
VBScript Code:

Option Explicit

WScript.Echo "Selected file: " & ChooseFile( )


Function ChooseFile( )
' Select File dialog based on a script by Mayayana
' Known issues:
' * Tree view always opens Desktop folder
' * In Win7/IE8 only the file NAME is returned correctly, the path returned will always be C:\fakepath\
' * If a shortcut to a file is selected, the name of that FILE will be returned, not the shortcut's
On Error Resume Next
Dim objIE, strSelected
ChooseFile = ""
Set objIE = CreateObject( "InternetExplorer.Application" )
objIE.visible = False
objIE.Navigate( "about:blank" )
Do Until objIE.ReadyState = 4
Loop
objIE.Document.Write "&lt;HTML>&lt;BODY>&lt;INPUT ID=""FileSelect"" NAME=""FileSelect"" TYPE=""file"">&lt;BODY>&lt;/HTML>"
With objIE.Document.all.FileSelect
    .focus
    .click
    strSelected = .value
End With
objIE.Quit
Set objIE = Nothing
ChooseFile = strSelected
End Function
Requirements:
Windows version:any
Network:N/A
Client software:Internet Explorer
Script Engine:any
Summarized:Works in all Windows versions.
<img data-src="https://www.robvanderwoude.com/pictures/selfileie960x600.gif" width="960" height="600" />
WScript.Shell.Exec MSHTA
VBScript Code:

    Option Explicit
    
    Dim strFile
    
    strFile = SelectFile( )
    
    If strFile = "" Then 
        WScript.Echo "No file selected."
    Else
        WScript.Echo """" & strFile & """"
    End If
    
    
    Function SelectFile( )
        ' File Browser via HTA
        ' Author:   Rudi Degrande, modifications by Denis St-Pierre and Rob van der Woude
        ' Features: Works in Windows Vista and up (Should also work in XP).
        '           Fairly fast.
        '           All native code/controls (No 3rd party DLL/ XP DLL).
        ' Caveats:  Cannot define default starting folder.
        '           Uses last folder used with MSHTA.EXE stored in Binary in [HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32].
        '           Dialog title says "Choose file to upload".
        ' Source:   https://social.technet.microsoft.com/Forums/scriptcenter/en-US/a3b358e8-15ae-4ba3-bca5-ec349df65ef6/windows7-vbscript-open-file-dialog-box-fakepath?forum=ITCG
    
        Dim objExec, strMSHTA, wshShell
    
        SelectFile = ""
    
        ' For use in HTAs as well as "plain" VBScript:
        strMSHTA = "mshta.exe ""about:" & "&lt;" & "input type=file id=FILE>" _
      & "&lt;" & "script>FILE.click();new ActiveXObject('Scripting.FileSystemObject')" _
         & ".GetStandardStream(1).WriteLine(FILE.value);close();resizeTo(0,0);" & "&lt;" & "/script>"""
        ' For use in "plain" VBScript only:
        ' strMSHTA = "mshta.exe ""about:&lt;input type=file id=FILE>" _
'          & "&lt;script>FILE.click();new ActiveXObject('Scripting.FileSystemObject')" _
'          & ".GetStandardStream(1).WriteLine(FILE.value);close();resizeTo(0,0);&lt;/script>"""
    
        Set wshShell = CreateObject( "WScript.Shell" )
        Set objExec = wshShell.Exec( strMSHTA )
    
        SelectFile = objExec.StdOut.ReadLine( )
    
        Set objExec = Nothing
        Set wshShell = Nothing
    End Function
Requirements:
Windows version:Windows XP and later versions
Network:N/A
Client software:MSHTA.EXE (native in Windows)
Script Engine:any
Summarized:Works in Windows XP, Vista, Windows 7, Windows 8, Windows 8.1.
<img data-src="https://www.robvanderwoude.com/pictures/fileselectmshta960x600.jpg" width="960" height="600" />




<h2><k>File Save Dialog</k></h2>
SAFRCFileDlg.FileSave
VBScript Code:

Set objDialog = CreateObject( "SAFRCFileDlg.FileSave" )

' Note: If no path is specified, the "current" directory will
'       be the one remembered from the last "SAFRCFileDlg.FileOpen"
'       or "SAFRCFileDlg.FileSave" dialog!
objDialog.FileName = "test_save.vbs"
' Note: The FileType property is cosmetic only, it doesn't
'       automatically append the right file extension!
'       So make sure you type the extension yourself!
objDialog.FileType = "VBScript Script"
If objDialog.OpenFileSaveDlg Then
WScript.Echo "objDialog.FileName = " & objDialog.FileName
End If
Requirements:
Windows version:Windows XP
Network:N/A
Client software:N/A
Script Engine:any
Summarized:Works in Windows XP only (all versions).
<em>Doesn't work in Windows 95, 98, ME, NT 4, 2000, Server 2003 and 7, not sure about Vista and Server 2008.</em>
<img data-src="https://www.robvanderwoude.com/pictures/saveas_safrcfiledlgfilesave.gif" width="536" height="419" />




<h2><k>Login Dialog</k></h2>
InternetExplorer.Application
VBScript Code:<a href="./files/iedialog.zip">Download</a>

Option Explicit Dim
 arrLogin, strNamestrName = NullIf
 WScript.Arguments.Unnamed.Count = 1
 Then
 strName = WScript.Arguments.Unnamed&#40;0&#41;
arrLogin = IELogin&#40;
 strName &#41;
WScript.Echo
 arrLogin&#40;0&#41;
 & vbTab & arrLogin&#40;1&#41;
  Function
 IELogin&#40;
 myName &#41;' This function uses Internet Explorer to create a login dialog.'' Script Name:          IELogin.vbs' Version:              4.00' Last modified:        2016-12-22'' Arguments:  [string]  optional user name (use " or Null to leave user name field blank)' Returns:    [array]   the user name (0) and password (1) typed in the dialog screen'' The output of IELogin.vbs is meant to be used in a batch file, using the following' batch code or something similar (note: the white space following delims= is a tab):'' REM * * * start of batch code * * *'' FOR /F "tokens=1,2 delims=" %%A IN ('CSCRIPT //NoLogo IELogin.vbs') DO ('     SET Name=%%~A'     SET Password=%%~B' )' ECHO The password of %Name% is %Password%'' REM * * * end of batch code * * *'' Written by Rob van der Woude' http://www.robvanderwoude.com' Error handling code written by Denis St-Pierre
 Dim
 intScreenHeight, intScreenWidthDim
 colItems, objIE, objItem, objWMIService, wshShellDim
 strHTML, strDialogTitle, strName 'On Error Resume Next
 strName = <a href="http://www.google.com/search?q=TRIM+site:msdn.microsoft.com">Trim
</a>&#40;
 " "
 & myName &#41;
 ' Create an IE objectSet
 objIE = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com">CreateObject
</a>&#40;
 "InternetExplorer.Application"
 &#41;' specify some of the IE window's settings
objIE.Navigate
 "about:blank"
strDialogTitle       = "Login"
 & String&#40;
 80
, <a href="http://www.google.com/search?q=CHR+site:msdn.microsoft.com">Chr
</a>&#40;
 8
 &#41;
 &#41;
objIE.Document.Title
 = strDialogTitleobjIE.ToolBar
        = False
objIE.Resizable
      = False
objIE.StatusBar
      = False
objIE.Width
          = 320
objIE.Height
         = 180' Wait till IE is readyDo
 While
 objIE.Busy
WScript.Sleep
 200Loop' Center the dialog window on the screenSet
 objWMIService = GetObject&#40;
 "winmgmts://./root/CIMV2"
 &#41;Set
 colItems = objWMIService.ExecQuery&#40;
 "SELECT * FROM Win32_DesktopMonitor"
 &#41;For
 Each
 objItem in
 colItemsintScreenHeight = objItem.ScreenHeight
intScreenWidth  = objItem.ScreenWidthNext
objIE.Left
 = &#40;
 intScreenWidth  -
 objIE.Width
  &#41;
 \ 2
objIE.Top
  = &#40;
 intScreenHeight -
 objIE.Height
 &#41;
 \ 2' Insert the HTML code to prompt for user input
strHTML = "&lt;div style="font-family: sans-serif; text-align: center; margin-left: auto; margin-right: auto;">\n"
 _        & "&lt;table>\n"
 _        & "&lt;tr>\n"
 _        & "\t&lt;td colspan="3">&nbsp;&lt;/td>\n"
 _        & "&lt;tr>\n"
 _        & "\t&lt;td>Name:&lt;/td>\n"
 _        & "\t&lt;td>&nbsp;&lt;/td>\n"
 _        & "\t&lt;td>&lt;input type="text" size="20" autocomplete="off" id="LoginName" value="
 & strName _        & " onkeyup="javascript:if(event.keyCode==13){document.getElementById('Password').focus();}" />&lt;/td>\n"
 _        & "&lt;/tr>\n"
 _        & "&lt;tr>\n"
 _        & "\t&lt;td>Password:&lt;/td>\n"
 _        & "\t&lt;td>&nbsp;&lt;/td>\n"
 _        & "\t&lt;td>&lt;input type="password" size="21" id="Password" "
 _        & "onkeyup="javascript:if(event.keyCode==13){document.getElementById('OK').value=1;}" />&lt;/td>\n"
 _        & "&lt;/tr>\n"
 _        & "&lt;/table>\n"
 _        & "&lt;p>&lt;input type="hidden" id="OK" name="OK" value="0" />"
 _        & "&lt;input type="button" value=" OK " onclick="VBScript:OK.Value=1">&lt;/p>\n"
 _        & "&lt;/div>"
objIE.Document.Body.InnerHTML
 = <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com">Replace
</a>&#40;
 <a href="http://www.google.com/search?q=REPLACE+site:msdn.microsoft.com">Replace
</a>&#40;
 strHTML, "\t"
, vbTab &#41;
, "\n"
, vbCrLf &#41;' Hide the scrollbars
objIE.Document.Body.Style.overflow
 = "auto"' Make the window visible
objIE.Visible
 = True' Set focus on the appropriate input fieldIf
 strName = "
 Then
objIE.Document.All.LoginName.FocusElse
objIE.Document.All.Password.FocusEnd
 If
 ' Wait till the OK button has been clickedDo
 While
 objIE.Document.All.OK.Value
 = 0
 WScript.Sleep
 200' Error handling, by Denis St-PierreIf
 Err Then' User clicked red X (or alt-F4) to close IE window
IELogin = <a href="http://www.google.com/search?q=ARRAY+site:msdn.microsoft.com">Array
</a>&#40;
 ", " &#41;
objIE.QuitSet
 objIE = NothingExit
 FunctionEnd
 ifLoop
 ' Make the dialog activeSet
 wshShell = <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com">CreateObject
</a>&#40;
 "WScript.Shell"
 &#41;
wshShell.AppActivate
 strDialogTitleSet
 wshShell = Nothing
 ' Read the user input from the dialog window
IELogin = <a href="http://www.google.com/search?q=ARRAY+site:msdn.microsoft.com">Array
</a>&#40;
 objIE.Document.All.LoginName.Value
, objIE.Document.All.Password.Value
 &#41;' Close and release the object
objIE.QuitSet
 objIE = Nothing
 On Error Goto 0
End Function
 
<img data-src="https://www.robvanderwoude.com/pictures/ie_login_dialog.jpg" width="320" height="180" />
Requirements:
Windows version:Windows XP Professional or later (will work in earlier Windows versions too, but the dialog will not be centered on screen)
Network:any
Client software:Internet Explorer 4 or later
Script Engine:WSH (CSCRIPT and WSCRIPT, remove both <code>WScript.Sleep</code> lines to use in HTAs)
Summarized:Works in all Windows versions with Internet Explorer 4 or later, however, centering the dialog on screen requires Windows XP Professional or later; remove both <code>WScript.Sleep</code> lines to use in HTAs.


<h2><k>Prompt for Passwords</k></h2>
ScriptPW.Password
VBScript Code:

strPw = Password( "Please enter your password:" )
WScript.Echo "Your password is: " & strPw

Function Password( myPrompt )
' This function hides a password while it is being typed.
' myPrompt is the text prompting the user to type a password.
' The function clears the prompt and returns the typed password.
' This code is based on Microsoft TechNet ScriptCenter "Mask Command Line Passwords"
' http://www.microsoft.com/technet/scriptcenter/scripts/default.mspx?mfr=true

' Standard housekeeping
Dim objPassword

' Use ScriptPW.dll by creating an object
Set objPassword = CreateObject( "ScriptPW.Password" )

' Display the prompt text
WScript.StdOut.Write myPrompt

' Return the typed password
Password = objPassword.GetPassword()

' Clear prompt
WScript.StdOut.Write String( Len( myPrompt ), Chr( 8 ) ) _
        & Space( Len( myPrompt ) ) _
        & String( Len( myPrompt ), Chr( 8 ) )
End Function
Requirements:
Windows version:XP, Server 2003, or Vista
Network:N/A
Client software:<a href="http://support.microsoft.com/?scid=ph;en-us;548">.NET Framework</a> for Windows 98, ME, NT 4 & 2000
Script Engine:WSH, CSCRIPT.EXE only
Summarized:Works in Windows XP or later, only in CSCRIPT.EXE (uses StdOut).
Should also work in older Windows versions with <a href="http://support.microsoft.com/?scid=ph;en-us;548">.NET Framework</a> installed (look for scriptpw.dll), only in CSCRIPT.EXE.
<em>Doesn't work in Windows 95, nor in Windows 7.</em>
InternetExplorer.Application
VBScript Code:
Option Explicit

Dim strPw

strPw = GetPassword( "Please enter your password:" )
WScript.Echo "Your password is: " & strPw

Function GetPassword( myPrompt )
' This function uses Internet Explorer to
' create a dialog and prompt for a password.
'
' Version:             2.15
' Last modified:       2015-10-19
'
' Argument:   [string] prompt text, e.g. "Please enter password:"
' Returns:    [string] the password typed in the dialog screen
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
' Error handling code written by Denis St-Pierre
Dim blnFavoritesBar, blnLinksExplorer, objIE, strHTML, strRegValFB, strRegValLE, wshShell

blnFavoritesBar  = False
strRegValFB = "HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\MINIE\LinksBandEnabled"
blnLinksExplorer = False
strRegValLE = "HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\LinksExplorer\Docked"

Set wshShell = CreateObject( "WScript.Shell" )

On Error Resume Next
' Temporarily hide IE's Favorites Bar if it is visible
If wshShell.RegRead( strRegValFB ) = 1 Then
blnFavoritesBar = True
wshShell.RegWrite strRegValFB, 0, "REG_DWORD"
End If
' Temporarily hide IE's Links Explorer if it is visible
If wshShell.RegRead( strRegValLE ) = 1 Then
blnLinksExplorer = True
wshShell.RegWrite strRegValLE, 0, "REG_DWORD"
End If
On Error Goto 0

' Create an IE object
Set objIE = CreateObject( "InternetExplorer.Application" )
' specify some of the IE window's settings
objIE.Navigate "about:blank"
' Add string of "invisible" characters (500 tabs) to clear the title bar
objIE.Document.title = "Password " & String( 500, 7 )
objIE.AddressBar     = False
objIE.Resizable      = False
objIE.StatusBar      = False
objIE.ToolBar        = False
objIE.Width          = 320
objIE.Height         = 180
' Center the dialog window on the screen
With objIE.Document.parentWindow.screen
objIE.Left = (.availWidth  - objIE.Width ) \ 2
objIE.Top  = (.availheight - objIE.Height) \ 2
End With
' Wait till IE is ready
Do While objIE.Busy
WScript.Sleep 200
Loop
' Insert the HTML code to prompt for a password
strHTML = "&lt;div style="text-align: center;">" _
    & "&lt;p>" & myPrompt & "&lt;/p>" _
    & "&lt;p>&lt;input type="password" size="20" id="Password" onkeyup=" _
    & "if(event.keyCode==13){document.all.OKButton.click();}" />&lt;/p>" _
    & "&lt;p>&lt;input type="hidden" id="OK" name="OK" value="0" />" _
    & "&lt;input type="submit" value=" OK " id="OKButton" " _
    & "onclick="document.all.OK.value=1" />&lt;/p>" _
    & "&lt;/div>"
objIE.Document.body.innerHTML = strHTML
' Hide the scrollbars
objIE.Document.body.style.overflow = "auto"
' Make the window visible
objIE.Visible = True
' Set focus on password input field
objIE.Document.all.Password.focus

' Wait till the OK button has been clicked
On Error Resume Next
Do While objIE.Document.all.OK.value = 0 
WScript.Sleep 200
' Error handling code by Denis St-Pierre
If Err Then' User clicked red X (or Alt+F4) to close IE window
GetPassword = "
objIE.Quit
Set objIE = Nothing
' Restore IE's Favorites Bar if applicable
If blnFavoritesBar Then wshShell.RegWrite strRegValFB, 1, "REG_DWORD"
' Restore IE's Links Explorer if applicable
If blnLinksExplorer Then wshShell.RegWrite strRegValLE, 1, "REG_DWORD"
' Use "WScript.Quit 1" instead of "Exit Function" if you want
' to abort with return code 1 in case red X or Alt+F4 were used
Exit Function
End if
Loop
On Error Goto 0

' Read the password from the dialog window
GetPassword = objIE.Document.all.Password.value

' Terminate the IE object
objIE.Quit
Set objIE = Nothing

On Error Resume Next
' Restore IE's Favorites Bar if applicable
If blnFavoritesBar Then wshShell.RegWrite strRegValFB, 1, "REG_DWORD"
' Restore IE's Links Explorer if applicable
If blnLinksExplorer Then wshShell.RegWrite strRegValLE, 1, "REG_DWORD"
On Error Goto 0

Set wshShell = Nothing
End Function

<img data-src="https://www.robvanderwoude.com/pictures/iepassworddialog320x180.png" width="320" height="180" />
Requirements:
Windows version:any
Network:any
Client software:Internet Explorer 4 or later
Script Engine:WSH (CSCRIPT and WSCRIPT)
(to use in HTAs, remove both <code>WScript.Sleep</code> lines)
Summarized:Works in all Windows versions with Internet Explorer 4 or later, remove both <code>WScript.Sleep</code> lines to use in HTAs.




<h2><k>Progress Messages</k></h2>
<h3>&emsp;by Denis St-Pierre</h3>
WSH (MsgBox)
VBScript Code:

Function ProgressMsg( strMessage, strWindowTitle )
' Written by Denis St-Pierre
' Displays a progress message box that the originating script can kill in both 2k and XP
' If StrMessage is blank, take down previous progress message box
' Using 4096 in Msgbox below makes the progress message float on top of things
' CAVEAT: You must have   Dim ObjProgressMsg   at the top of your script for this to work as described
Set wshShell = CreateObject( "WScript.Shell" )
strTEMP = wshShell.ExpandEnvironmentStrings( "%TEMP%" )
If strMessage = " Then
    ' Disable Error Checking in case objProgressMsg doesn't exists yet
    On Error Resume Next
    ' Kill ProgressMsg
    objProgressMsg.Terminate( )
    ' Re-enable Error Checking
    On Error Goto 0
    Exit Function
End If
Set objFSO = CreateObject("Scripting.FileSystemObject")
strTempVBS = strTEMP + "\" & "Message.vbs"     'Control File for reboot

' Create Message.vbs, True=overwrite
Set objTempMessage = objFSO.CreateTextFile( strTempVBS, True )
objTempMessage.WriteLine( "MsgBox" & strMessage & ", 4096, " & strWindowTitle & " )
objTempMessage.Close

' Disable Error Checking in case objProgressMsg doesn't exists yet
On Error Resume Next
' Kills the Previous ProgressMsg
objProgressMsg.Terminate( )
' Re-enable Error Checking
On Error Goto 0

' Trigger objProgressMsg and keep an object on it
Set objProgressMsg = WshShell.Exec( "%windir%\system32\wscript.exe " & strTempVBS )

Set wshShell = Nothing
Set objFSO   = Nothing
End Function
Requirements:
Windows version:any
Network:N/A
Client software:N/A
Script Engine:any
Summarized:Works in any Windows version.
Usage Sample:

' Makes the object a Public object (Critical!)
Dim objProgressMsg

' *** Usage example
strWindowTitle = "AppName_1_0"
ProgressMsg "Installing, Please wait.", strWindowTitle
' Do work here that will take a long time
WScript.Sleep 3000

ProgressMsg "I'm installing app #2, Please wait.", strWindowTitle
WScript.Sleep 3000

' Removes previous ProgressMsg
ProgressMsg ", strWindowTitle
WScript.Sleep 3000

' Doing it this way leaves the msgbox
ProgressMsg "Done", strWindowTitle
WScript.Quit
' *** End Usage example




<h2><k>Prompt for User Input</k></h2>
WSH (StdIn or InputBox)
VBScript Code:

strInput = UserInput( "Enter some input:" )
WScript.Echo "You entered: " & strInput

Function UserInput( myPrompt )
' This function prompts the user for some input.
' When the script runs in CSCRIPT.EXE, StdIn is used,
' otherwise the VBScript InputBox( ) function is used.
' myPrompt is the the text used to prompt the user for input.
' The function returns the input typed either on StdIn or in InputBox( ).
' Written by Rob van der Woude
' http://www.robvanderwoude.com
' Check if the script runs in CSCRIPT.EXE
If UCase( Right( WScript.FullName, 12 ) ) = "\CSCRIPT.EXE" Then
    ' If so, use StdIn and StdOut
    WScript.StdOut.Write myPrompt & " "
    UserInput = WScript.StdIn.ReadLine
Else
    ' If not, use InputBox( )
    UserInput = InputBox( myPrompt )
End If
End Function
Requirements:
Windows version:All
Network:N/A
Client software:Windows Script 5.6 for Windows 98, ME, and NT 4 (no longer available for download?)
Script Engine:WSH
Summarized:Works in any Windows version, provided
Windows Script 5.6 for Windows 98, ME, and NT 4 is installed for Windows 98, ME, and NT 4 (no longer available for download?).
InternetExplorer.Application
VBScript Code:

Function GetUserInput( myPrompt )
' This function uses Internet Explorer to
' create a dialog and prompt for user input.
'
' Version:             2.11
' Last modified:       2013-11-07
'
' Argument:   [string] prompt text, e.g. "Please enter your name:"
' Returns:    [string] the user input typed in the dialog screen
'
' Written by Rob van der Woude
' http://www.robvanderwoude.com
' Error handling code written by Denis St-Pierre
Dim objIE

' Create an IE object
Set objIE = CreateObject( "InternetExplorer.Application" )

' Specify some of the IE window's settings
objIE.Navigate "about:blank"
objIE.Document.title = "Input required " & String( 100, "." )
objIE.ToolBar        = False
objIE.Resizable      = False
objIE.StatusBar      = False
objIE.Width          = 320
objIE.Height         = 180

' Center the dialog window on the screen
With objIE.Document.parentWindow.screen
    objIE.Left = (.availWidth  - objIE.Width ) \ 2
    objIE.Top  = (.availHeight - objIE.Height) \ 2
End With

' Wait till IE is ready
Do While objIE.Busy
    WScript.Sleep 200
Loop
' Insert the HTML code to prompt for user input
objIE.Document.body.innerHTML = "&lt;div align=""center"">&lt;p>" & myPrompt _
& "&lt;/p>" & vbCrLf _
& "&lt;p>&lt;input type=""text"" size=""20"" " _
& "id=""UserInput"">&lt;/p>" & vbCrLf _
& "&lt;p>&lt;input type=""hidden"" id=""OK"" " _
& "name=""OK"" value=""0"">" _
& "&lt;input type=""submit"" value="" OK "" " _
& "OnClick=""VBScript:OK.value=1"">&lt;/p>&lt;/div>"
' Hide the scrollbars
objIE.Document.body.style.overflow = "auto"
' Make the window visible
objIE.Visible = True
' Set focus on input field
objIE.Document.all.UserInput.focus

' Wait till the OK button has been clicked
On Error Resume Next
Do While objIE.Document.all.OK.value = 0 
    WScript.Sleep 200
    ' Error handling code by Denis St-Pierre
    If Err Then ' user clicked red X (or alt-F4) to close IE window
        IELogin = Array( "", "" )
        objIE.Quit
        Set objIE = Nothing
        Exit Function
    End if
Loop
On Error Goto 0


' Read the user input from the dialog window
GetUserInput = objIE.Document.all.UserInput.value

' Close and release the object
objIE.Quit
Set objIE = Nothing
End Function
<strong>Sample VBScript Code:</strong>

strUserInput = GetUserInput( "Please enter your name:" )
WScript.Echo "Your name is: " & strUserInput
<img data-src="https://www.robvanderwoude.com/pictures/ie_input_dialog.gif" width="320" height="180" />
Requirements:
Windows version:any
Network:any
Client software:Internet Explorer 4 or later
Script Engine:WSH (CSCRIPT and WSCRIPT)
(to use in HTAs, remove both <code>WScript.Sleep</code> lines)
Summarized:Works in all Windows versions with Internet Explorer 4 or later, remove both <code>WScript.Sleep</code> lines to use in HTAs.




<h2><k>Buttons Dialog</k></h2>
InternetExplorer.Application
VBScript Code:

Function IEButtons( )
' This function uses Internet Explorer to create a dialog.
Dim objIE, sTitle, iErrorNum

' Create an IE object
Set objIE = CreateObject( "InternetExplorer.Application" )
' specify some of the IE window's settings
objIE.Navigate "about:blank"
sTitle="Make your choice " & String( 80, "." ) 'Note: the String( 80,".") is to push "Internet Explorer" string off the window
objIE.Document.title = sTitle
objIE.MenuBar        = False
objIE.ToolBar        = False
objIE.AddressBar     = false
objIE.Resizable      = False
objIE.StatusBar      = False
objIE.Width          = 250
objIE.Height         = 280
' Center the dialog window on the screen
With objIE.Document.parentWindow.screen
    objIE.Left = (.availWidth  - objIE.Width ) \ 2
    objIE.Top  = (.availHeight - objIE.Height) \ 2
End With
' Wait till IE is ready
Do While objIE.Busy
    WScript.Sleep 200
Loop


' Insert the HTML code to prompt for user input
objIE.Document.body.innerHTML = "&lt;div align=""center"">" & vbcrlf _
& "&lt;p>&lt;input type=""hidden"" id=""OK"" name=""OK"" value=""0"">" _
& "&lt;input type=""submit"" value=""  Limited User   "" onClick=""VBScript:OK.value=1"">&lt;/p>" _
& "&lt;input type=""submit"" value=""  Standard User "" onClick=""VBScript:OK.value=2"">&lt;/p>" _
& "&lt;input type=""submit"" value=""   Power User   "" onClick=""VBScript:OK.value=4"">&lt;/p>" _
& "&lt;input type=""submit"" value=""   Admin User   "" onClick=""VBScript:OK.value=8"">&lt;/p>" _
& "&lt;p>&lt;input type=""hidden"" id=""Cancel"" name=""Cancel"" value=""0"">" _
& "&lt;input type=""submit"" id=""CancelButton"" value=""       Cancel       "" onClick=""VBScript:Cancel.value=-1"">&lt;/p>&lt;/div>"

' Hide the scrollbars
objIE.Document.body.style.overflow = "auto"
' Make the window visible
objIE.Visible = True
' Set focus on Cancel button
objIE.Document.all.CancelButton.focus


'CAVEAT: If user click red X to close IE window instead of click cancel, an error will occur.
'        Error trapping Is Not doable For some reason
On Error Resume Next
Do While objIE.Document.all.OK.value = 0 and objIE.Document.all.Cancel.value = 0
    WScript.Sleep 200
    iErrorNum=Err.Number
    If iErrorNum &lt;> 0 Then    'user clicked red X (or alt-F4) to close IE window
        IEButtons = 0
        objIE.Quit
        Set objIE = Nothing
        Exit Function
    End if
Loop
On Error Goto 0

objIE.Visible = False

' Read the user input from the dialog window
IEButtons = objIE.Document.all.OK.value
' Close and release the object
objIE.Quit
Set objIE = Nothing
End Function

<strong>Sample VBScript Code:</strong>
' Save this code as IEButtonsDemo.vbs
WScript.Echo IEButtons( )
<strong>Sample Batch Code:</strong>
FOR /F %%A IN ('CSCRIPT //NoLogo IEButtonsDemo.vbs') DO SET ButtonChoice=%%~A
<img data-src="https://www.robvanderwoude.com/pictures/iebuttons.gif" width="250" height="280" />
Requirements:
Windows version:any
Network:any
Client software:Internet Explorer 4 or later
Script Engine:WSH (CSCRIPT and WSCRIPT)
(to use in HTAs, remove both <code>WScript.Sleep</code> lines)
Summarized:Works in all Windows versions with Internet Explorer 4 or later, remove both <code>WScript.Sleep</code> lines to use in HTAs.



<script src='https://williamkpchan.github.io/LibDocs/readbook.js'></script>
<script>
var lazyLoadInstance = new LazyLoad({
 elements_selector: ".lazy"
});
</script>
</pre></body></html>
