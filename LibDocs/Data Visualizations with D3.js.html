

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<base target=_blank>
<style>
body { margin: 10%; font-size: 24px; background-color: #000000; color: #109030;}
a { text-decoration: none; color: #28B8B8;}
a:visited { color: #389898;}
A:hover { color: yellow;}
A:focus { color: red;}
code { color: pink; background-color: #001500}
pre { color: gray; background-color: #001010}
#toc {font-size: 20px; margin-left:20%;}
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>

</head>
</body>
<center>
<strong>Data Visualizations with D3.js?</strong></center><br>
<div id="toc"></div>


<h2>Introduction</h2>

<p><span>This article is a continuation of my previous article, </span><a href="https://www.analyticsvidhya.com/blog/2017/07/beginner-guide-build-data-visualisations-web-d3-js/" target="_blank" rel="noopener"><span>Beginner‚Äôs guide to build data visualizations on the web with D3.js</span></a><span> . Which I would recommend you to read before going further for a better understanding üôÇ </span></p>

<p><b>Note: </b><span>The code in this article uses </span><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/API-Reference.md" target="_blank" rel="noopener"><span>D3 v3</span></a><span>.<br />
</span></p>
<p>&nbsp;</p>
<h2></h2>
<h2>Table of Contents</h2>
<ol>
<li><span>Refreshing previous concepts of D3.js</span></li><li><span>Building basic charts and code reusability</span><br>
<li><span>A glance at advanced concepts: Scales, Axes and Reading data from external sources</span></li>

<ol>
<li><span>Line Chart</span></li>
<li><span>Area Chart</span></li>
<li><span>Chart as a modular structure</span></li>
<li><span>Case Study<br />
</span></li>
</ol>
</li>
<li><span>Visualizing Game of Thrones Social Network  &#8211; Force Directed Graph in action!</span></li>
<li><span>Case Studies &#8211; Some interesting charts built using D3.js</span></li>
<li><span>Introduction to Dimple.js &#8211; D3 made easy!</span></li>
</ol>
<p>&nbsp;</p>
<h2></h2>
<h2>1. Refreshing previous concepts of D3.js</h2>
<p><span>Let‚Äôs quickly refresh some of the important concepts we have learned in the previous article!</span></p>
<h4>Selections</h4>
<p><span>In order to perform an operation on an element in the DOM(our HTML page), we would first need to ‚Äúselect‚Äù it. We do that using </span><b>d3.select(..) </b><span>method. If you want to select the &lt;body&gt; tag, you would do :</span></p>
<pre><span>d3.select(‚Äúbody‚Äù); </span></pre>
<p>&nbsp;</p>
<h4>Adding Elements</h4>
<p><span>In case you want to add an element to your DOM, you use </span><b>.append(..) </b><span>method. For example, to add a &lt;svg&gt; element to your body, you would do :</span></p>
<pre><span>var svg = d3.select(‚Äúbody‚Äù).append(‚Äúsvg‚Äù);</span></pre>
<p><span>Notice that here we use another important D3 concept, </span><b>method chaining</b><span>. Here, we reuse the output of the d3.select(‚Äúbody‚Äù) and apply the .append() method to add a &lt;svg&gt; element to it.</span></p>
<p>&nbsp;</p>
<h4>Setting attributes</h4>
<p><span>D3 gives you a clean way to add/remove attributes for a selected DOM element. For example, you‚Äôd like to set the width and height of your &lt;svg&gt; : </span></p>
<pre><span>svg.attr({‚Äúwidth‚Äù:500, ‚Äúheight‚Äù:500});</span></pre>
<p>&nbsp;</p><p><span>In D3, if you want to add some data to DOM elements, you would create what is called a ‚ÄúEnter, <br>
<h4>Appending data to DOM</h4>
Update, Exit‚Äù cycle. For example, You want to create a set of rectangles each having a height as given in an array you‚Äôd do : </span></p>
<pre><span>//data values </span>
<span>var data_values = [10,20,30,40,50,5,2,12,70,26];</span>
<span>//create rectangles </span>
<span>var bars = svg.selectAll("rect")</span>
<span>‚ÄÉ.data(data_values)</span>
<span>‚ÄÉ.enter()</span>
<span>‚ÄÉ.append("rect")</span>
<span>‚ÄÉ.attr("width","25px")</span>
<span>‚ÄÉ.attr("height", function(d){ return d; });</span></pre>
<p><span>Now, having refreshed some of the important concepts, let‚Äôs learn some new topics.</span></p>
<p>&nbsp;</p>
<h2></h2>
<h2>2. A glance at advanced concepts: Scales, Axes and Reading data from external sources</h2>
<p><span>These are some of the most useful features that come out of the box with D3. We will cover them one by one:</span></p>
<h3>2.1 Scales</h3>
<p><span>As data enthusiasts, you had probably come across cases where you have data in different scales. For any meaningful inference, it had to be ‚Äúscaled‚Äù to a common range. For example, when you normalize for values between 0 and 1. </span><span>Here if you want to rescale a data set, you‚Äôd need to create a </span><b>linear scale</b><span> with fixed </span><b>domain </b><span>and </span><b>range </b><span>values. Then call the scale with the required value:</span></p>
<pre><span>// Create a linear scale </span>
<span>var normalize = d3.scale.linear().domain([0,50]).range([0,1]);</span></pre>
<p><span>Here </span><b>domain(..) </b><span>is used to set the max and min values of the input data and </span><b>range(..)</b><span> is used to set the max and min values of the output needed. A domain of [0,50] and a range of [0,1] means we have created a linear scale that‚Äôd </span><b>map any value in [0,50] to a value in [0,1]</b><span>. Let‚Äôs check how well our scale works : </span></p>
<p><img class="wp-image-38319 size-full aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28191951/Screen-Shot-2017-08-20-at-00.22.42.png" alt="" width="761" height="278" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28191951/Screen-Shot-2017-08-20-at-00.22.42.png 761w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28191951/Screen-Shot-2017-08-20-at-00.22.42-300x110.png 300w" sizes="(max-width: 761px) 100vw, 761px" /></p>
<p><span>It looks the scale is working quite well! D3 supports plenty of scales to cover almost all of your data needs. Read </span><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/API-Reference.md#d3scale-scales"><span>more here</span></a><span>.</span></p>
<p>&nbsp;</p>
<h3>2.2 Axes</h3>
<p><span>Axes are a very important part of a visualization. They add a great deal of useful information like the magnitude of data, measurement unit and the direction of magnitude etc. We will create an axis with the <strong>domain </strong>of data<strong> [0,50]</strong> and the<strong> range</strong> of our scale will be in<strong> [10,400]</strong> which represent the pixels. Let&#8217;s look at the code to fit into our &lt;svg&gt; :</span></p>
<pre><span>//create an svg element</span>
<span>var svgElement = d3.select("body")</span>
<span>.append("svg")</span>
<span>.attr({"width" : 500, "height" : 500});</span>
<span>//create a linear scale to map data to pixels, domain is [0,50] and range is [10,400]</span>
<span>var xScale = d3.scale.linear().domain([0,50]).range([10,400]);</span>
<span>//create a axis based on the scale</span>
<span>var xAxis = d3.svg.axis().scale(xScale)</span>
<span>.ticks(5)</span> <span>//limit number of ticks to 5</span>
<span>.orient("bottom");</span> <span>//horizontal axis with labels to  the bottom </span>
<span>//create a new group to hold the axis</span>
<span>var x = svgElement.append("g")</span>
<span>.call(xAxis);</span></pre>
<p><img class="size-full wp-image-38324 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28192544/Screen-Shot-2017-08-20-at-10.02.48.png" alt="" width="480" height="156" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28192544/Screen-Shot-2017-08-20-at-10.02.48.png 480w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28192544/Screen-Shot-2017-08-20-at-10.02.48-300x98.png 300w" sizes="(max-width: 480px) 100vw, 480px" /><span>Let‚Äôs beautify the axis a little by adding the following code to the CSS :</span></p>
<pre><span>path{</span>
<span>stroke: steelblue;</span>
<span>fill: none;</span>
<span>stroke-width: 2;</span>
<span>}</span></pre>
<p><img class="size-full wp-image-38325 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28192752/Screen-Shot-2017-08-20-at-10.05.19.png" alt="" width="781" height="128" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28192752/Screen-Shot-2017-08-20-at-10.05.19.png 781w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28192752/Screen-Shot-2017-08-20-at-10.05.19-300x49.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28192752/Screen-Shot-2017-08-20-at-10.05.19-768x126.png 768w" sizes="(max-width: 781px) 100vw, 781px" /><span>That looks quite better! I personally feel CSS is like &#8220;parameter tuning&#8221; of visualization with D3.</span></p>
<p><b>What happened here?</b></p>
<pre><span>var xAxis = d3.svg.axis().scale(xScale)</span>
<span>.ticks(5)</span> <span>//limit number of ticks to 5</span>
<span>.orient("bottom");</span> <span>//horizontal axis with labels to the bottom</span></pre>
<p><span>We created an axis using </span><b>d3.svg.axis() </b><span>method. The </span><b>scale()</b><span> method then sets the scale to our newly created scale. </span><b>ticks() </b><span> sets the number of ticks our axis will have, the default is 10.  The above axis without <strong>ticks(5)</strong> would look like :</span></p>
<p><img class="size-full wp-image-38394 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/31072809/Screen-Shot-2017-08-31-at-07.35.55.png" alt="" width="772" height="203" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/31072809/Screen-Shot-2017-08-31-at-07.35.55.png 772w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/31072809/Screen-Shot-2017-08-31-at-07.35.55-300x79.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/31072809/Screen-Shot-2017-08-31-at-07.35.55-768x202.png 768w" sizes="(max-width: 772px) 100vw, 772px" /></p>
<pre><span>var x = svgElement.append("g")</span>
<span>.call(xAxis);</span></pre>
<p><span>An axis a combination of many SVG elements that for its scale, ticks, labels etc. So it is better to group them using &lt;g&gt; in the SVG. That‚Äôs we appended a group and called </span><b>xAxis()</b><span> function to plot the axis. You can </span><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/SVG-Axes.md" target="_blank" rel="noopener"><span>read more about axes in D3 here</span></a><span>. </span><span>Now that we know how to plot axes, let‚Äôs learn how to load external data into D3!</span></p>
<p>&nbsp;</p>
<h3>2.3 Loading data from external sources</h3>
<p><span>As data scientists , we deal with a variety of data formats like JSON, CSV, TSV, XML,HTML etc. D3 supports all of these formats and much more by default. For example, loading data from a tsv is as simple as calling a function :</span></p>
<pre><span>d3.tsv("http://simplysanad.com/d3js/data.tsv", function(error, data){</span>
<span>if(error)</span>
<span>// If error, print the error message in the console</span>
<span>console.log(error);</span>
<span>else </span>
<span>// Print the data as a table in the console</span>
<span>console.table(data);</span>
<span>});</span></pre>
<p><img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28193301/Screen-Shot-2017-08-20-at-12.19.27.png"></p>
<p><span>Things to note:</span></p>
<ul>
<li><b>d3.tsv(..) <span> &#8211; Loads a tab separated value file from the given URL.</span></b></li>
</ul>
<ul>
<li>console.table(data) <span>&#8211; Nicely prints the data as a table.</span></li>
</ul>
<p><span>Now that we have learned how to create the building blocks of a visualization, let‚Äôs create some charts using D3.</span></p>
<p>&nbsp;</p>
<h2></h2>
<h2>3. Building basic charts and code reusability</h2>
<p><span>All of the concepts that we have learned till now are used as modules for creating a visualization in D3. We will create two charts of our own, a line chart and an area chart.</span></p>
<p>&nbsp;</p>
<h3>3.1 Line Chart</h3>
<p><img class="size-full wp-image-38330 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28193807/Screen-Shot-2017-08-20-at-12.29.03.png" alt="" width="699" height="489" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28193807/Screen-Shot-2017-08-20-at-12.29.03.png 699w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28193807/Screen-Shot-2017-08-20-at-12.29.03-300x210.png 300w" sizes="(max-width: 699px) 100vw, 699px" /></p>
<p><span>Line charts are one of the most widely used chart types when it comes to showing time series based data to depict trends over time. Let‚Äôs create the above line chart!</span></p>
<p>&nbsp;</p>
<h4>About Dataset</h4>
<p><span>We will be using a sample data set in the form of tab-separated-values. You can find it </span><a href="http://simplysanad.com/d3js/data.tsv" target="_blank" rel="noopener"><span>here</span></a><span>. </span><span>There are three columns in our data set &#8211; index , date and close. While </span><b>index</b><span> is the index of the entry, </span><b>date</b><span> denotes the recorded date of stock and </span><b>close</b><span> is the </span><b>closing price </b><span>of the stock at the given date.</span></p>
<p><img class="size-full wp-image-38331 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194011/Screen-Shot-2017-08-20-at-12.19.271.png" alt="" width="956" height="394" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194011/Screen-Shot-2017-08-20-at-12.19.271.png 956w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194011/Screen-Shot-2017-08-20-at-12.19.271-300x124.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194011/Screen-Shot-2017-08-20-at-12.19.271-768x317.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194011/Screen-Shot-2017-08-20-at-12.19.271-850x350.png 850w" sizes="(max-width: 956px) 100vw, 956px" /></p>
<p>&nbsp;</p>
<h4>Data preprocessing &#8211; Handling date and type conversions</h4>
<p><span>Notice that both the date and price is in string format. Before we can use them to make plots, we need to convert them into usable formats. Make the following changes to your earlier code of loading external data:</span></p>
<pre><span>//Create a date parser</span>
<span>var ParseDate = d3.time.format("%d-%b-%y").parse;</span>
<span>
//Read TSV file</span>
<span>d3.tsv("data.tsv", function(error, data){</span>
<span>//Parse Data into useable format</span>
<span>data.forEach(function(d){</span>
<span>d.date = ParseDate(d.date);</span>
<span>d.close = +d.close;</span>
<span>//the + sign converts numeric string to number</span>
<span>});</span>

<span>//Print the data as a table in the console</span>
<span>console.table(data);</span>
<span>});</span></pre>
<p><span>Let‚Äôs view our data once again : </span></p>
<p><img class="size-full wp-image-38332 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194130/Screen-Shot-2017-08-09-at-17.22.10.png" alt="" width="858" height="681" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194130/Screen-Shot-2017-08-09-at-17.22.10.png 858w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194130/Screen-Shot-2017-08-09-at-17.22.10-300x238.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194130/Screen-Shot-2017-08-09-at-17.22.10-768x610.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194130/Screen-Shot-2017-08-09-at-17.22.10-850x675.png 850w" sizes="(max-width: 858px) 100vw, 858px" /></p>
<p><span>Looks like we have successfully formatted our data. Let‚Äôs take a closer look at the code:</span></p>
<ul>
<li><span>We first create a date parser object using D3‚Äôs </span><b>time.format.parse()</b><span> function. Notice that we have given the format of the date as ‚Äú%d-%b-%y‚Äù. You can read more about various </span><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/Time-Formatting.md" target="_blank" rel="noopener"><span>formats here</span></a><span>. This part tells our D3 parser how to correctly extract date info from the given string and D3 does all the work of converting the dates for you üôÇ</span></li>
<li><span>We then iterate through every data value using D3‚Äôs </span><b>forEach() </b><span>function. This function executes any code inside it for every element of the given array.</span></li>
<li><span>To format date we use our previously defined </span><b>ParseDate() </b><span>function.</span></li>
<li><span>Notice the ‚Äò+‚Äô sign in the next line, the ‚Äò+‚Äô sign converts numerical strings to the numeric type.</span></li>
</ul>
<p><span>Now that our data is properly preprocessed, we are ready to convert the data into visuals.</span></p>
<p>&nbsp;</p>
<h4>Plotting line</h4>
<p><span>When we plot a line in an SVG, we give coordinates of the path to follow but that‚Äôs a tedious process. Enter D3, here we just need to provide data values and the scale they should follow and D3 does all the heavy lifting of calculating coordinates for us! The following code will create a reusable line generator for our data :</span></p>
<pre><span>//Create a line generator</span>
<span>var valueline = d3.svg.line()</span>
<span>.x(function(d){</span>
<span>return xScale(d.date);</span>
<span>})</span>
<span>.y(function(d){</span>
<span>return yScale(d.close);</span>
<span>});</span></pre>
<p>&nbsp;</p>
<h4>Bringing it all together</h4>
<p><span>Now that we have all the pieces together, let‚Äôs build the final chart! The following code should make the above chart:</span></p>
<pre><span>&lt;!DOCTYPE html&gt;</span>
<span>&lt;html&gt;</span>
<span>&lt;head&gt;</span>
<span>&lt;title&gt;D3 Line Chart&lt;/title&gt;
</span><span>&lt;style type="text/css"&gt;</span>
<span>body{ font: Arial 18px; text-align: center; }
</span><span>
path{</span>
<span>stroke: steelblue;</span>
<span>fill: none;</span>
<span>stroke-width: 2;</span>
<span>}</span>

<span>.axis path, .axis line{
</span><span>fill: none;</span>
<span>stroke: grey;</span>
<span>stroke-width: 1;</span>
<span>shape-rendering: crispEdges;</span>
<span>}</span>
<span>&lt;/style&gt;</span>
<span>&lt;link rel="stylesheet" type="text/css" href="main.css"&gt;</span>
<span>&lt;/head&gt;</span>
<span>&lt;body&gt;</span>
<span>&lt;h3&gt;Basic Line Chart&lt;/h3&gt;</span>
<span>&lt;script type="text/javascript" src="https://d3js.org/d3.v3.js"&gt;&lt;/script&gt;
</span><span>&lt;script type="text/javascript"&gt;</span>
<span>//Set margins and sizes</span>
<span>var margin = {</span>
<span>top: 20,</span>
<span>bottom: 50,</span>
<span>right: 30,</span>
<span>left: 50</span>
<span>};</span>

<span>var width = 700 - margin.left - margin.right;</span>
<span>var height = 500 - margin.top - margin.bottom;
</span><span>//Create date parser</span>
<span>var ParseDate = d3.time.format("%d-%b-%y").parse;</span>
<span>//Create x and y scale to scale inputs</span>
<span>var xScale = d3.time.scale().range([0, width]);</span>
<span>var yScale = d3.scale.linear().range([height, 0]);</span>
<span>
//Create x and y axes</span>
<span>var xAxis = d3.svg.axis().scale(xScale)</span>
<span>.orient("bottom")</span>
<span>.ticks(5);</span>
<span>var yAxis = d3.svg.axis().scale(yScale)</span>
<span>.orient("left")</span>
<span>.ticks(5);</span>

<span>//Create a line generator</span>
<span>var valueline = d3.svg.line()</span>
<span>.x(function(d){</span>
<span>return xScale(d.date);</span>
<span>})</span>

<span>.y(function(d){</span>
<span>return yScale(d.close);</span>
<span>});</span></pre>
<pre><span>//Create an SVG element and append it to the DOM</span>
<span>var svgElement = d3.select("body").append("svg")</span>
<span>.attr({"width": width+margin.left+margin.right, "height": height+margin.top+margin.bottom})</span>
<span>.append("g")</span>
<span>.attr("transform","translate("+margin.left+","+margin.top+")");</span></pre>
<pre><span>//Read TSV file</span>
<span>d3.tsv("http://simplysanad.com/d3js/data.tsv", function(data){</span>
<span>//Parse Data into useable format</span>
<span>data.forEach(function(d){</span>
<span>d.date = ParseDate(d.date);</span>
<span>d.close = +d.close;</span>
<span>//the + sign converts string automagically to number</span>
<span>});</span>

<span>//Set the domains of our scales</span>
<span>xScale.domain(d3.extent(data, function(d){ return d.date; }));</span>
<span>yScale.domain([0, d3.max(data, function(d){ return d.close; })]);</span>

<span>//append the svg path</span>
<span>var path = svgElement.append("path")</span>
<span>.attr("d", valueline(data));</span>
<span>
//Add X Axis</span>
<span>var x = svgElement.append("g")</span>
<span>.attr("transform", "translate(0,"+height+")")</span>
<span>.call(xAxis);</span>

<span>//Add Y Axis</span>
<span>var y = svgElement.append("g")</span>
<span>.call(yAxis);</span>
<span>
//Add label to y axis</span>
<span>y.append("text")</span>
<span>.attr("fill", "#000")</span>
<span>.attr("transform", "rotate(-90)")</span>
<span>.attr("y", 6)</span>
<span>.attr("dy", "0.71em")</span>
<span>.attr("text-anchor", "end")</span>
<span>.text("Price ($)");</span>
<span>});</span>
<span>&lt;/script&gt;</span>
<span>&lt;/body&gt;</span>
<span>&lt;/html&gt;</span></pre>
<p><img class="size-full wp-image-38330 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28193807/Screen-Shot-2017-08-20-at-12.29.03.png" alt="" width="699" height="489" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28193807/Screen-Shot-2017-08-20-at-12.29.03.png 699w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28193807/Screen-Shot-2017-08-20-at-12.29.03-300x210.png 300w" sizes="(max-width: 699px) 100vw, 699px" /></p>
<p>&nbsp;</p>
<h3>3.2 Area Chart</h3>
<p><img class="size-full wp-image-38333 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194401/Screen-Shot-2017-08-20-at-23.50.39.png" alt="" width="960" height="502" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194401/Screen-Shot-2017-08-20-at-23.50.39.png 960w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194401/Screen-Shot-2017-08-20-at-23.50.39-300x157.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194401/Screen-Shot-2017-08-20-at-23.50.39-768x402.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28194401/Screen-Shot-2017-08-20-at-23.50.39-850x444.png 850w" sizes="(max-width: 960px) 100vw, 960px" /></p>
<p><span>One of the magical things about D3 is if you design your code smartly, a lot of it can be reused in other visualizations. An area chart can be thought as a modified version of the line chart, here we shade the region of the chart that comes under the line. </span></p>
<p>The interesting thing here is,<span> you can create the above chart by </span><b>changing 4-5 lines in the previous chart‚Äôs code</b><span>! </span><span>The final code for area chart would be : </span></p>
<pre><span>&lt;!DOCTYPE html&gt;</span>
<span>&lt;html&gt;</span>
<span>&lt;head&gt;</span>
<span>&lt;script type="text/javascript" src="https://d3js.org/d3.v3.js"&gt;&lt;/script&gt;</span>
<span>&lt;style&gt;</span>
<span>body{ font: Arial 12px; text-align: center;}</span>
<span>.axis path, .axis line{</span>
<span>fill: none;</span>
<span>stroke: black;</span>
<span>stroke-width: 1;</span>
<span>shape-rendering: crispEdges;</span>
<span>}</span>
<span>&lt;/style&gt;</span>
<span>&lt;link rel="stylesheet" type="text/css" href="main.css"&gt;</span>
<span>&lt;/head&gt;</span>
<span>&lt;body&gt;</span>
<span>&lt;h3&gt;Area Chart&lt;/h3&gt;</span>
<span>&lt;script type="text/javascript"&gt;</span>
<span>//Set margins and sizes</span>
<span>var margin = {</span>
<span>top: 20,</span>
<span>bottom: 50,</span>
<span>right: 30,</span>
<span>left: 50</span>
<span>};</span>

<span>var width = 960 - margin.left - margin.right;</span>
<span>var height = 500 - margin.top - margin.bottom;</span>
<span>//Create date parser</span>
<span>var ParseDate = d3.time.format("%d-%b-%y").parse;</span>
<span>//Create x and y scale to scale inputs</span>
<span>var xScale = d3.time.scale().range([0, width]);</span>
<span>var yScale = d3.scale.linear().range([height, 0]);</span>
<span>
//Create x and y axes</span>
<span>var xAxis = d3.svg.axis().scale(xScale)</span>
<span>.orient("bottom")</span>
<span>.ticks(5);</span>

<span>var yAxis = d3.svg.axis().scale(yScale)</span>
<span>.orient("left");</span>

<b>//Create a area generator</b>
<b>var area = d3.svg.area(</b>
<b>.x(function(d){</b>
<b>return xScale(d.date);</b>
<b>})</b>
<b>.y1(function(d){</b>
<b>return yScale(d.close);</b>
<b>});</b>

<span>//Create an SVG element and append it to the DOM</span>
<span>var svgElement = d3.select("body")</span>
<span>.append("svg").attr({"width": width+margin.left+margin.right, "height": height+margin.top+margin.bottom})</span>
<span>.append("g")</span>
<span>.attr("transform","translate("+margin.left+","+margin.top+")");</span>

<span>//Read TSV file</span>
<span>d3.tsv("http://simplysanad.com/d3js/data.tsv", function(data){</span>
<span>//Parse Data into useable format</span>
<span>data.forEach(function(d){</span>
<span>d.date = ParseDate(d.date);</span>
<span>d.close = +d.close;</span>
<span>//the + sign converts string automagically to number</span>
<span>});</span>

<span>//Set the domains of our scales</span>
<span>xScale.domain(d3.extent(data, function(d){ return d.date; }));</span>
<span>yScale.domain([0, d3.max(data, function(d){ return d.close; })]);</span>
<b>area.y0(yScale(0));</b>
<span>//append the svg path</span>
<span>var path = svgElement.append("path")</span>
<span>.attr("d", area(data))</span>
<span>.attr("fill", "steelblue");</span>
<span>//Add X Axis</span>
<span>var x = svgElement.append("g")</span>
<span>.attr("transform", "translate(0,"+height+")")</span>
<span>.attr("class", "x axis")</span>
<span>.call(xAxis);</span>

<span>//Add Y Axis</span>
<span>var y = svgElement.append("g")</span>
<span>.call(yAxis)</span>
<span>.attr("class", "y axis");</span>

//Add label to Y axis
<span>y.append("text")</span>
<span>.attr("fill", "#000")</span>
<span>.attr("transform", "rotate(-90)")</span>
<span>.attr("y", 6)</span>
<span>.attr("dy", "0.71em")</span>
<span>.attr("text-anchor", "end")</span>
<span>.text("Price ($)");</span>
<span>});</span>
<span>&lt;/script&gt;</span>
<span>&lt;/body&gt;</span>
<span>&lt;/html&gt;</span></pre>
<p><span>Notice that we have only made the following changes : </span></p>
<ul>
<li><span>Replaced line generation code with area generation code, because we need D3 to calculate area and coordinates for it based on our data set.</span></li>
</ul>
<p><span>Now that we have successfully built some visualizations let‚Äôs look at some case studies with D3.</span></p>
<p>&nbsp;</p>
<h3>3.3 Chart as a modular structure</h3>
<p><span>You have already built a bunch of charts using D3, did you notice any pattern or structure in them? After working with D3 for a while, I have noticed a general structure that I follow in my code to create charts. The following structure is how I logically layout my code :</span></p>
<ol>
<li><strong><span style="text-decoration: underline;">Basic HTML and CSS</span>  </strong></li>
<li><strong><span style="text-decoration: underline;">Setting the stage </span></strong>
<ol>
<li><span>Setting the margins, sizes, and variables that would be needed later on </span></li>
<li><span>Building scales, axes, and color scales</span></li>
<li><span>Creating data preprocessing structures like data parser, percentage formatter</span></li>
</ol>
</li>
<li><strong><span style="text-decoration: underline;">Visualization specific setup</span></strong><span> &#8211; Sometimes we need to write chart specific code, Eg: line generator in line chart and area generator in area chart</span></li>
<li><strong><span style="text-decoration: underline;">Create the SVG</span></strong><span> &#8211; The most important step, the base SVG element, and all its properties should be prepared in this step</span></li>
<li><strong><span style="text-decoration: underline;">Loading external data</span></strong> &#8211;
<ol>
<li><span>Code for loading data based on format, source</span></li>
<li><span>Applying pre-processing, cleaning if required on the data using the structures set up in step 1.c</span></li>
<li><span>Verify loaded data and its format once before going to the next step</span></li>
</ol>
</li>
<li><strong><span style="text-decoration: underline;">Bringing it all together</span></strong><span> &#8211; Now that everything is set up and ready to be attached to the chart. One by one all the axes, bars, paths etc. should be drawn on the SVG in this step</span></li>
<li><strong><span style="text-decoration: underline;">Adding Extras</span></strong><span> &#8211; After all who doesn‚Äôt like extras? Animations, Labels, etc. are to be put in at this step</span></li>
</ol>
<p><span>Note that sometimes you won‚Äôt be able to follow the order because of other factors and that is alright. This is not a rigid rule but just a way to divide and conquer the process of building a chart in D3 so that it can be easily understood and reused whenever possible. Confused much? Let‚Äôs understand it with a practice problem!</span></p>
<p>&nbsp;</p>
<h3>3.4 Case Study</h3>
<p><img class="size-full wp-image-38335 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28195713/Screen-Shot-2017-08-26-at-22.41.14.png" alt="" width="806" height="406" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28195713/Screen-Shot-2017-08-26-at-22.41.14.png 806w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28195713/Screen-Shot-2017-08-26-at-22.41.14-300x151.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28195713/Screen-Shot-2017-08-26-at-22.41.14-768x387.png 768w" sizes="(max-width: 806px) 100vw, 806px" /></p>
<p><span>This section is very important because here, it‚Äôs your turn to build! You will be building the following beautiful bar chart. After the basic chart is built a huge task awaits you, give your best. </span><span>This chart is built on a data set of character frequency. The dataset can be found </span><a href="http://simplysanad.com/d3js/words.tsv" target="_blank" rel="noopener"><span>here</span></a><span>. Let‚Äôs follow the general structure that we just learned and try to build this chart!</span></p>
<p>&nbsp;</p>
<h4>Step 1. Basic HTML and CSS</h4>
<pre><span>&lt;!DOCTYPE html&gt;</span>
<span>&lt;html&gt;</span>
<span>&lt;head&gt;</span>
<span>  &lt;script src="d3.min.js"&gt;&lt;/script&gt; </span>
<span>  &lt;style type="text/css"&gt;</span>
<span>    .axis path,</span>
<span>    .axis line {</span>
<span>      fill: none;</span>
<span>      stroke: #000;</span>
<span>      shape-rendering: crispEdges;</span>
<span>    }</span>
<span>    .x.axis path{</span>
<span>      display: none;</span>   
    }
    body{
<span>    font: 10px arial;</span>
<span>     text-align: center;</span>
<span>    }</span>
<span>  &lt;/style&gt;</span>
<span>  &lt;link rel="stylesheet" type="text/css" href="main.css"&gt;</span>
<span>&lt;/head&gt;</span>
<span>&lt;body&gt;</span>
<span>  &lt;h1&gt;Animated Barchart&lt;/h1&gt;</span>
<span>  &lt;script type="text/javascript"&gt;</span></pre>
<p>&nbsp;</p>
<h4>Step 2. Setting the stage</h4>
<pre><span>    //Set up margin and percentage formatter</span>
<span>    var margin = {top:20, right: 30, bottom: 30, left:40};</span>
<span>    var width = 800-margin.left-margin.right;</span>
<span>    var height = 400-margin.top-margin.bottom;</span>
<span>   </span>
<span>    //Creating a percentage formatter </span>
<span>    var formatPercent = d3.format("%.0");</span>
<span>    </span>
<b>    </b><span> //Create x and y scale</span>
<span>    var yScale = d3.scale.linear().range([height,0]);</span>
<span>    var xScale = d3.scale.ordinal().rangeRoundBands([0,width],0.1,0.2);</span>
 
<span>    //Create category 10 scale for color</span>
<span>    var c10 = d3.scale.category10(); </span></pre>
<p><span>In the above code, we started out by setting up basic margins and width, height values. Then we created a percentage formatter using D3‚Äôs format(..) so that we can convert our y axis labels to %. Then we defined scales for x and y axis and defined the range for the same. Lastly, since we would be needing color for our bars, we will use one of D3‚Äôs color bands, </span><b>category10</b><span>. The category10 contains the following 10 colors : </span></p>
<p><img class="size-full wp-image-38338 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200211/Screen-Shot-2017-08-26-at-23.01.551.png" alt="" width="210" height="282" /></p>
<p><span>D3 has more color scales. </span><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/Ordinal-Scales.md#categorical-colors" target="_blank" rel="noopener"><span>Read more here</span></a><span>.</span></p>
<p>&nbsp;</p>
<h4>Step 3. Visualization specific code</h4>
<p><span>For the above simple bar chart, we don‚Äôt need any visualization specific code.</span></p>
<p>&nbsp;</p>
<h4>Step 4. Create the SVG</h4>
<p><span>Now that we have set the stage, it is time to create the SVG along with the above settings:</span></p>
<pre><span>    //Create SVG Element</span>
<span>    var svg = d3.select("body")</span>
<span>          .append("svg")  .attr({"width":width+margin.left+margin.right,"height":height+margin.top+margin.bottom})</span>
<span>          .append("g")</span>
<span>          .attr("transform","translate("+margin.left+","+margin.right+")");</span></pre>
<p>&nbsp;</p>
<h4>Step 5. Loading external data</h4>
<p><span>Since we have a URL to load data from and it is in tsv format, we can just make a single function call to load data:</span></p>
<pre><span>    d3.tsv("http://simplysanad.com/d3js/words.tsv", function(data){});</span></pre>
<p><span>Remember some preprocessing of data? Now that we get our data, we need to set the </span><b>domain</b><span> of our x and y scales which we couldn‚Äôt set earlier because we didn‚Äôt have the data:</span></p>
<pre><span> //Set domain of x and y scales based on loaded data</span>
<span>      yScale.domain([0,d3.max(data, function(d){ return d.frequency; })]);</span>
<span>      xScale.domain(data.map(function(d){ return d.letter; }));</span></pre>
<p>&nbsp;</p>
<h4>Step 6. Bringing it all together</h4>
<p><span>We have our data nicely formatted and ready, we also have our axes, colors ready. Let‚Äôs bring it all together and attach them to our chart. Notice the new code added in external data loading function : </span></p>
<pre><span>      //Load data from external tsv file</span>
<span>      d3.tsv("http://simplysanad.com/d3js/words.tsv", function(data){</span>
<span>      //Set domain of x and y scales based on loaded data</span>
<span>      yScale.domain([0,d3.max(data, function(d){ return d.frequency; })]);</span>
<span>      xScale.domain(data.map(function(d){ return d.letter; }));</span>
<span>      //Create X and Y Axis based on scales and data</span>
<span>      var xAxis = d3.svg.axis()</span>
<span>                .scale(xScale)</span>
<span>                .orient("bottom");</span>
<span>      var yAxis = d3.svg.axis()</span>
<span>                .scale(yScale)</span>
<span>                .orient("left")</span>
<span>                .tickFormat(formatPercent);
</span><span>      //Add bars</span>
<span>      var bars = svg.selectAll("rect")</span>
<span>                    .data(data)</span>
<span>                    .enter()</span>
<span>                    .append("rect")</span>
<span>                    .attr("class","bar")</span>
<span>                    .attr("width", xScale.rangeBand())</span>
<span>                    .attr("fill","steelblue")</span>
<span>                    .attr("fill", function(d,i){</span>
<span>                      return c10(Math.random()*10*i);</span>
<span>                    })</span>
<span>                    .attr("y", function(d){</span>
<span>                      return yScale(d.frequency);</span>
<span>                    })</span>
<span>                    .attr("x", function(d){</span>
<span>                      return xScale(d.letter);</span>
<span>                    })              </span></pre>
<pre><span>                   .attr("height", function(d){</span>
<span>                      return height-yScale(d.frequency);</span>
<span>                   });</span>

<span>     //Add X Axis</span>
<span>     svg.append("g")</span>
<span>     .attr("transform","translate(0,"+height+")")</span>
<span>     .call(xAxis)</span>
<span>     .attr("class","x axis");</span>
<span>      //Add Y Axis</span>
<span>      svg.append("g")</span>
<span>        .attr("class", "y axis")</span>
<span>        .call(yAxis);</span>
<span>    });</span>
<span>  &lt;/script&gt;</span>
<span>&lt;/body&gt;</span>
<span>&lt;/html&gt;</span></pre>
<p><span>Now that you have the basic chart drawn, it is time for you to jump into action and do something creative!</span></p>
<p>&nbsp;</p>
<h3>Task &#8211; Add Step 7. Extras to the bar chart</h3>
<p><span>This is the step where you come in. After all, who doesn‚Äôt like something extra? Visualization is no different! Since we already have a basic bar chart, I challenge you to go ahead and add animation/interactivity to this chart. The following is a list of common effects that you can easily add to your chart using D3: </span></p>
<h4>Tooltips</h4>
<p>&nbsp;</p>
<p><img class="size-full wp-image-38337 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200103/bar_tooltip.gif" alt="" width="778" height="362" /></p>
<p>&nbsp;</p>
<h4>Interactivity</h4><p><img class="size-full wp-image-38339 aligncenter" src="https://s3-ap-south-1.amazonaws.com/<br>
<p>&nbsp;</p>
av-blog-media/wp-content/uploads/2017/08/28200320/bar_interactive.gif" alt="" width="978" height="488" /></p>
<p>&nbsp;</p>
<h4>Animation</h4>
<p><img class="size-full wp-image-38340 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200436/bar_animated.gif" alt="" width="824" height="408" /></p>
<p><span>The above is just a minor set of options. You‚Äôll find enough resources in the endnotes to refer. You can post about your approach/discuss your doubts with the community here :</span></p>
<p><a href="https://discuss.analyticsvidhya.com/" target="_blank" rel="noopener"><span>https://discuss.analyticsvidhya.com/</span></a></p>
<p><span>Go ahead, surprise me with your creativity!</span></p>
<p>&nbsp;</p>
<h2></h2>
<h2>4. Visualizing the Game of Thrones Social Network: Force Directed Graph in action!</h2>
<p><img class="alignnone size-full wp-image-38341" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581.png" alt="" width="969" height="715" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581.png 969w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581-300x221.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581-768x567.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581-850x627.png 850w" sizes="(max-width: 969px) 100vw, 969px" /></p>
<p><span>Now that you have pretty much learnt all the basics of D3 and made plenty of charts on your own, it is time to move to the next level and do something that is niche to D3, you‚Äôll be building one of the case study &#8211; Force Directed Graph to visualize a very popular TV Series, Game of Thrones.</span></p>
<p>&nbsp;</p>
<h4>A little context about Game of Thrones</h4>
<p><span>The TV sensation</span> <a href="https://en.wikipedia.org/wiki/Game_of_Thrones" target="_blank" rel="noopener"><span>Game of Thrones</span></a> <span>is based on George R. R. Martin&#8217;s epic fantasy novel series, &#8220;A Song of Ice and Fire.&#8221; The series is famous for its sweeping plotlines, its cast of hundreds of characters, and its complex web of character dynamics. In addition, &#8220;Game of Thrones&#8221; is an ensemble piece, featuring many prominent characters with intertwined relationships.</span></p>
<p><img class="size-full wp-image-38342 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200838/Game-Of-Thrones-Desktop-Wallpaper-Pc-Wide-Best-HD-Wallpapers-TV-Show-....jpg" alt="" width="1920" height="1080" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200838/Game-Of-Thrones-Desktop-Wallpaper-Pc-Wide-Best-HD-Wallpapers-TV-Show-....jpg 1920w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200838/Game-Of-Thrones-Desktop-Wallpaper-Pc-Wide-Best-HD-Wallpapers-TV-Show-...-300x169.jpg 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200838/Game-Of-Thrones-Desktop-Wallpaper-Pc-Wide-Best-HD-Wallpapers-TV-Show-...-768x432.jpg 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200838/Game-Of-Thrones-Desktop-Wallpaper-Pc-Wide-Best-HD-Wallpapers-TV-Show-...-850x478.jpg 850w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200838/Game-Of-Thrones-Desktop-Wallpaper-Pc-Wide-Best-HD-Wallpapers-TV-Show-...-257x144.jpg 257w" sizes="(max-width: 1920px) 100vw, 1920px" /></p>
<p><span>Here, interaction among characters and the strength of their relationship is important. Also, there are some characters who are much more influential than others and steer the course of the story.</span></p>
<p>&nbsp;</p>
<h4>About the dataset</h4>
<p><span>The dataset for this visualization is based on </span><a href="https://www.macalester.edu/~abeverid/index.html" target="_blank" rel="noopener"><span>Andrew Beveridge‚Äôs</span></a><span> data set of ‚ÄúA Storm of Swords‚Äù, the third book in the series. In Andrew‚Äôs words,</span></p>
<p><i><span>‚Äú</span></i><i><span>We represented each character in the book as a vertex. We then added a link between two characters whenever their names appeared within 15 words of one another. So a link between characters means that they interacted, spoke of one another, or that another character spoke of them together. Characters that interacted frequently are connected multiple times.</span></i><i><span>‚Äù</span></i></p>
<p><img class="size-full wp-image-38343 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201102/Screen-Shot-2017-08-27-at-11.27.07.png" alt="" width="228" height="187" /></p>
<p><span>Using the above data set, I calculated the influence of character based on the ‚Äúthe number of times her/his interaction has appeared in the book‚Äù. For example, if Sansa has 6 records where she is the source and 4 records where she is the target of an interaction, her influence will be 6+4=10.</span></p>
<p><span>I then formatted the data so that D3 can easily use it. The result was a simple </span><a href="http://simplysanad.com/d3js/got_social_graph.json" target="_blank" rel="noopener"><span>JSON file here</span></a><span>.</span></p>
<p>&nbsp;</p>
<h4>Data format for force directed graph</h4>
<p><span>The force directed graph can be divided into two major components &#8211; nodes and links. The nodes represent entities whose relationship is to be plotted and similarly links are those relationships. These are analogous to vertex and edge in a graph.</span></p>
<p><img class="size-full wp-image-38344 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201318/nodes_links.png" alt="" width="522" height="208" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201318/nodes_links.png 522w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201318/nodes_links-300x120.png 300w" sizes="(max-width: 522px) 100vw, 522px" /></p>
<p>&nbsp;</p>
<p><span>D3 expects two arrays for force layout. The first one should be an array of nodes and the second one an array of links. The links refer to the index of the node and should have two attributes ‚Äúsource‚Äù and ‚Äútarget‚Äù. This is exactly how I have laid out our JSON. </span></p>
<p><span>Now that we are versed with the basics, let‚Äôs build our Social Network Graph by following the earlier steps : </span></p>
<p><b>Step 1. Basic HTML and CSS </b></p>
<pre><span>&lt;!DOCTYPE html&gt;</span>
<span>&lt;html&gt;</span>
<span>&lt;head&gt;</span>
<span>&lt;script type="text/javascript" src="d3.min.js"&gt;&lt;/script&gt;</span>
<span>&lt;style&gt;</span>
<span>body{ font: Arial 12px; text-align: center;}</span>
<span>.link {</span>
<span>  stroke: #ccc;</span>
<span>}</span>
<span>.node text {</span>
<span>  pointer-events: none;</span>
<span>  font: sans-serif;</span>
<span>}</span>
<span>&lt;/style&gt;</span>
<span>&lt;link rel="stylesheet" type="text/css" href="main.css"&gt;</span>
<span>&lt;/head&gt;</span>
<span>&lt;body&gt;</span>
<span>&lt;h3&gt;Game of Thrones-Social Network Analysis&lt;/h3&gt;</span>
<span>&lt;script type="text/javascript"&gt;</span></pre>
<p><b>Step 2. Setting the stage</b></p>
<pre><span>//Set margins and sizes</span>
<span>var margin = {</span>
<span>top: 20,</span>
<span>bottom: 50,</span>
<span>right: 30,</span>
<span>left: 50</span>
<span>};</span>

<span>var width = 960 - margin.left - margin.right;</span>
<span>var height = 700 - margin.top - margin.bottom;</span>

<span>//Load Color Scale</span>
<span>var c10 = d3.scale.category10();</span></pre>
<p><b>Step 3. No visualization specific code</b></p>
<p><b>Step 4. Create the SVG</b></p>
<pre><span>//Create an SVG element and append it to the DOM</span>
<span>var svgElement = d3.select("body")</span>
<span>.append("svg").attr({"width": width+margin.left+margin.right, "height": height+margin.top+margin.bottom})</span>
<span>.append("g")</span>
<span>.attr("transform","translate("+margin.left+","+margin.top+")");</span></pre>
<p><b>Step 5. Load external data</b></p>
<pre><span>//Load External Data</span>
<span>d3.json("http://simplysanad.com/d3js/got_social_graph.json", function(dataset){</span>
<span>//Extract data from dataset</span>
<span>var nodes = dataset.nodes,</span>
<span>links = dataset.links;</span></pre>
<p><b>Step 6. Bringing it all together &#8211; force layout, nodes, links</b></p>
<pre><span>//Create Force Layout</span>
<span>var force = d3.layout.force()</span>
<span>.size([width, height])</span>
<span>.nodes(nodes)</span>
<span>.links(links)</span>
<span>.gravity(0.05)</span>
<span>.charge(-200)</span>
<span>.linkDistance(200);</span>
<span>//Add links to SVG</span>
<span>var link = svgElement.selectAll(".link")</span>
<span>.data(links)</span>
<span>.enter()</span>
<span>.append("line")</span>
<span>.attr("stroke-width", function(d){ return d.weight/10; })</span>
<span>.attr("class", "link");</span>
<span>//Add nodes to SVG</span>
<span>var node = svgElement.selectAll(".node")</span>
<span>.data(nodes)</span>
<span>.enter()</span>
<span>.append("g")</span>
<span>.attr("class", "node")</span>
<span>.call(force.drag);</span></pre>
<p><b>Step 7. Adding extras &#8211; Labels, Starting the simulation</b></p>
<pre><span>//Add labels to each node</span>
<span>var label = node.append("text")</span>
<span>.attr("dx", 12)</span>
<span>.attr("dy", "0.35em")</span>
<span>.attr("font-size", function(d){ return d.influence*1.5&gt;9? d.influence*1.5: 9; })</span>
<span>.text(function(d){ return d.character; });</span>
<span>//Add circles to each node</span>
<span>var circle = node.append("circle")</span>
<span>.attr("r", function(d){ return d.influence/2&gt;5 ? d.influence/2 : 5; })</span>
<span>.attr("fill", function(d){ return c10(d.zone*10); });</span>
<span>//This function will be executed once force layout is done with its calculations</span>
<span>force.on("tick", function(){</span>
<span>//Set X and Y of node</span>
<span>node.attr("r", function(d){ return d.influence; })</span>
<span>.attr("cx", function(d){ return d.x; })</span>
<span>.attr("cy", function(d){ return d.y; });</span>
<span>//Set X, Y of link</span>
<span>link.attr("x1", function(d){ return d.source.x; })</span>
<span>link.attr("y1", function(d){ return d.source.y; })</span>
<span>link.attr("x2", function(d){ return d.target.x; })</span>
<span>link.attr("y2", function(d){ return d.target.y; });</span>
<span>//Shift node a little</span>
<span>node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });</span>
<span>});</span>

<span>//Start the force layout calculation</span>
<span>force.start();</span>
<span>});</span>
<span>&lt;/script&gt;</span>
<span>&lt;/body&gt;</span>
<span>&lt;/html&gt;</span></pre>
<p><b>What‚Äôs happening here?</b></p>
<p><span>First we perform steps 1 to 4 of building a D3 chart as discussed earlier. Then we create a force layout here  : </span></p>
<pre><span>//Create Force Layout</span>
<span>var force = d3.layout.force()</span>
<span>.size([width, height])</span>
<span>.nodes(nodes)</span>
<span>.links(links)</span>
<span>.gravity(0.05)</span>
<span>.charge(-200)</span>
<span>.linkDistance(200);</span></pre>
<ul>
<li><b>d3.layout.force() &#8211; <span>initializes a new force layout</span></b></li>
</ul>
<ul>
<li><strong>.size()</strong> &#8211; <span>set the size of the layout</span></li>
</ul>
<ul>
<li><strong>.nodes(nodes)</strong> &#8211; <span>pass in the nodes array</span></li>
</ul>
<ul>
<li><strong>.links(links)</strong> &#8211; <span>pass the links array</span></li>
</ul>
<ul>
<li><strong>.gravity()</strong> &#8211; <span>sets a pseudo-gravity force that attracts our nodes to the center of the area</span></li>
</ul>
<ul>
<li><strong>.charge()</strong> &#8211; <span>sets a charge force between nodes. If positive will be an attractive force, repulsive for negative values.</span></li>
</ul>
<ul>
<li><strong>.linkDistance()</strong> &#8211; <span>set the minimum distance in pixels that each node should have. In other words, the minimum length of a link.</span></li>
</ul>
<p><span>When the above code is executed, it asks D3 to make the necessary calculations like the position of each node, the distance between them, calculating coordinates of links joining them etc. All of this happens in the background and D3 takes care of it all. While the above calculations are being done, we need to keep updating the position of the nodes and links. We attach a listener to our force layout : </span></p>
<pre><span>//This function will be executed for every tick of force layout </span>
<span>force.on("tick", function(){</span>
<span>//Set X and Y of node</span>
<span>node.attr("r", function(d){ return d.influence; })</span>
<span>.attr("cx", function(d){ return d.x; })</span>
<span>.attr("cy", function(d){ return d.y; });</span>
<span>//Set X, Y of link</span>
<span>link.attr("x1", function(d){ return d.source.x; })</span>
<span>link.attr("y1", function(d){ return d.source.y; })</span>
<span>link.attr("x2", function(d){ return d.target.x; })</span>
<span>link.attr("y2", function(d){ return d.target.y; });</span>
<span>//Shift node a little</span>
<span>node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });</span>
<span>});</span></pre>
<p><span>The above code basically tells D3 for every ‚Äútick‚Äù (single step of the simulation), redraw(updated) all the nodes and their links. Now when everything is done, we start the simulation : </span></p>
<pre><span>//Start the force layout simulation</span>
<span>force.start();</span></pre>
<p><span>If you want to dig deeper into force layouts, you can read its </span><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/Force-Layout.md" target="_blank" rel="noopener"><span>documentation here</span></a><span>. </span><span>With this, you have your very own GoT Social Graph!</span></p>
<p><img class="size-full wp-image-38341 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581.png" alt="" width="969" height="715" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581.png 969w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581-300x221.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581-768x567.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28200617/Screen-Shot-2017-08-26-at-16.32.581-850x627.png 850w" sizes="(<p style="text-align: center;"><a href="https://bl.ocks.org/<br>max-width: 969px) 100vw, 969px" /></p>
mohdsanadzakirizvi/6fc325042ce110e1afc1a7124d087130" target="_blank" rel="noopener">Live Demo</a></p>
<p><b>Few things to note about the visualization:</b></p>
<ul>
<li><span>The nodes represent the characters and the links their interactions.</span></li>
<li><span>The size of node and name represents the influence of character. Tyrion, way to go!</span></li>
<li><span>The thickness of link denotes the weight of the relationship between the characters. See the thick link between Jaime &amp; Brienne, Jon &amp; Sam, Bran &amp; Hodor, Daenerys &amp; Sir Jorah? üòÄ and how can you forget Jon and Ygritte! üòõ</span></li>
<li><span>The node is color coded based on an influential character‚Äôs current geo-location and supporting characters around it. There you go Jon, Daenerys, Tyrion, Robb, Bran, Arya, Stannis üôÇ</span></li>
</ul>
<p>&nbsp;</p>
<h2></h2>
<h2>5. Case Studies &#8211; Different Charts using D3.js</h2>
<p><span>D3 has been used on a versatile set of visualization problems. Let‚Äôs look into some of the interesting ones.</span></p>
<h3>Bubble Chart &#8211; Visualizing 3 Dimensional data</h3>
<p><img class="size-full wp-image-38345 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201521/Screen-Shot-2017-08-21-at-00.07.37.png" alt="" width="973" height="684" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201521/Screen-Shot-2017-08-21-at-00.07.37.png 973w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201521/Screen-Shot-2017-08-21-at-00.07.37-300x211.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201521/Screen-Shot-2017-08-21-at-00.07.37-768x540.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28201521/Screen-Shot-2017-08-21-at-00.07.37-850x598.png 850w" sizes="(max-width: 973px) 100vw, 973px" /></p>
<p style="text-align: center;"><a href="http://bl.ocks.org/mmattozzi/7018021" target="_blank" rel="noopener">Source Link</a></p>
<p><span>What would you do if you want to show 3-dimensional data in 2 dimensions? You‚Äôd use a bubble chart! The area of the circle and the x and y coordinates are used to encode all the 3 dimensions.</span></p>
<p>&nbsp;</p>
<h3>Concept Map &#8211; Relationship between concepts</h3>
<p><img class="size-full wp-image-38399 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/31083535/concept_map.gif" alt="" width="640" height="555" /></p>
<p style="text-align: center;"><a href="http://www.findtheconversation.com/concept-map/" target="_blank" rel="noopener">Source Link</a></p>
<p>A concept map typically represents ideas and information as boxes or circles, which it connects with labeled arrows in a downward-branching hierarchical structure. The relationship between concepts can be articulated in linking phrases such as causes, requires, or contributes to. In this example, D3 is used to show an improvised concept map to better convey the story. Notice how the branches get highlighted when you select a topic. This is a good example of interactivity D3 enables in your visualizations.</p>
<p>&nbsp;</p>
<h3>Map Chart &#8211; Visualizing Demographical Data</h3>
<p><img class="size-full wp-image-38350 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202335/Screen-Shot-2017-08-21-at-00.22.49.png" alt="" width="963" height="500" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202335/Screen-Shot-2017-08-21-at-00.22.49.png 963w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202335/Screen-Shot-2017-08-21-at-00.22.49-300x156.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202335/Screen-Shot-2017-08-21-at-00.22.49-768x399.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202335/Screen-Shot-2017-08-21-at-00.22.49-850x441.png 850w" sizes="(max-width: 963px) 100vw, 963px" /></p>
<p style="text-align: center;"><a href="http://bl.ocks.org/michellechandra/0b2ce4923dc9b5809922" target="_blank" rel="noopener">Source Link</a></p>
<p><span>D3 provides amazing in built support to create interactive, map based visualizations that can be used to show demographically distributed data.</span></p>
<p>&nbsp;</p>
<h3>Sankey Diagrams</h3>
<p><img class="size-full wp-image-38351 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202530/Screen-Shot-2017-08-21-at-00.28.58.png" alt="" width="998" height="523" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202530/Screen-Shot-2017-08-21-at-00.28.58.png 998w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202530/Screen-Shot-2017-08-21-at-00.28.58-300x157.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202530/Screen-Shot-2017-08-21-at-00.28.58-768x402.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202530/Screen-Shot-2017-08-21-at-00.28.58-850x445.png 850w" sizes="(max-width: 998px) 100vw, 998px" /></p>
<p style="text-align: center;"><a href="https://bost.ocks.org/mike/sankey/" target="_blank" rel="noopener">Source Link </a></p>
<p><a href="https://en.wikipedia.org/wiki/Sankey_diagram" target="_blank" rel="noopener"><span>Sankey diagrams</span></a><span> visualize the magnitude of flow between nodes in a network. This intricate diagram shows a possible scenario for UK energy production and consumption in 2050: energy </span><b>supplies</b><span> are on the left, and </span><b>demands</b><span> are on the right. Intermediate nodes group related forms of production and show how energy is converted and transmitted before it is consumed (or lost!). The thickness of each link encodes the amount of flow from source to target.</span></p>
<p>&nbsp;</p>
<h3>Parallel Coordinates</h3>"1076" height="730" srcset="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/<br>
<p><img class="size-full wp-image-38352 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202810/Screen-Shot-2017-08-21-at-00.37.02.png" alt="" width=08/28202810/Screen-Shot-2017-08-21-at-00.37.02.png 1076w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202810/Screen-Shot-2017-08-21-at-00.37.02-300x204.png 300w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202810/Screen-Shot-2017-08-21-at-00.37.02-768x521.png 768w, https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202810/Screen-Shot-2017-08-21-at-00.37.02-850x577.png 850w" sizes="(max-width: 1076px) 100vw, 1076px" /></p>
<p style="text-align: center;"><a href="http://mbostock.github.io/d3/talk/20111116/iris-parallel.html" target="_blank" rel="noopener">Source Link </a></p>
<p><span>Parallel coordinates is a visualization technique used to plot individual data elements across many dimensions. Each of the dimensions corresponds to a vertical axis and each data element is displayed as a series of connected points along the dimensions/axes. In the above example, the very famous </span><b>iris dataset </b><span>is plotted.</span></p>
<p>&nbsp;</p>
<h2></h2>
<h2>6. A Brief Introduction to dimple.js &#8211; D3 made easy!</h2>
<p><span>D3 code can be quite verbose. That begs the question, is there a simpler way of creating basic charts using D3 but with fewer lines of code? That‚Äôs exactly what </span><a href="http://dimplejs.org/"><span>dimple.js </span></a><span>lets you do. </span></p>
<p><span>It is a library that is directly built on top of D3 and provides an easy interface to build visualizations. It can be loosely compared to the relationship between keras and tensorflow in python. Let‚Äôs build a basic visualization using dimple :</span></p>
<p><img class="size-full wp-image-38353 aligncenter" src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/08/28202959/dimple_example.gif" alt="" width="622" height="402" /></p>
<pre><span>&lt;html&gt;</span>
<span>&lt;div id="chartContainer"&gt;</span>
<span>  &lt;script src="https://d3js.org/d3.v4.min.js"&gt;&lt;/script&gt;</span>
<span>  &lt;script src="http://dimplejs.org/dist/dimple.v2.3.0.min.js"&gt;&lt;/script&gt;</span>
<span>  &lt;script type="text/javascript"&gt;</span>
<span>    //Create the SVG</span>
<span>    var svg = dimple.newSvg("#chartContainer", 590, 400);</span>

<span>    //Load external data</span>
<span>    d3.tsv("http://dimplejs.org/data/example_data.tsv", function (data) {</span>
<span>      //Create a chart object using svg and data</span>
<span>      var myChart = new dimple.chart(svg, data);</span>
<span>      //Set the size of the plot within SVG</span>
<span>      myChart.setBounds(60, 30, 510, 330</span>
<span>      //Add an axis of categorical values</span>
<span>      myChart.addCategoryAxis("x", ["Price Tier", "Channel"]);</span>
<span>      //Add an axis of continuous values</span>
<span>      myChart.addMeasureAxis("y", "Unit Sales");</span>
<span>      //Make a barchart</span>
<span>      myChart.addSeries("Channel", dimple.plot.bar);</span>
<span>      //Add legends</span>
<span>      myChart.addLegend(65, 10, 510, 20, "right");</span>
<span>      //Draw the chart</span>
<span>      myChart.draw();</span>
<span>    });</span>
<span>  &lt;/script&gt;</span>
<span>&lt;/div&gt;</span>
<span>&lt;/html&gt;
</span>
</pre><ul><br>
<p><strong>What happened here?</strong></p>

<li><b>dimple.newSvg()<span> &#8211; create a SVG element</span></b></li>
<li><b>new dimple.chart(svg, data)</b><span> &#8211; create a new dimple chart</span></li>
<li><b>.setBounds() </b><span>&#8211; set boundaries of the chart within the svg</span></li>
<li><b>.addCategoryAxis()</b><span> &#8211; add an axis that will have categorical values</span></li>
<li><b>.addMeasureAxis()</b><span> &#8211; add an axis that will have continuous values</span></li>
<li><b>.addSeries(, dimple.plot.bar)</b><span> &#8211; make a barplot</span></li>
<li><b>.addLegends()</b><span> &#8211; add legends to the chart</span></li>
</ul>
<p><b>Note:</b><span> that with only a few lines of code, you were able to create a beautiful visualization. Also, dimple took care of basic interaction and animation. </span><span>If you want to explore dimple more, check out these other </span><a href="http://dimplejs.org/examples_index.html" target="_blank" rel="noopener"><span>examples created using dimple.js</span></a><span>.</span></p>
<p>&nbsp;</p>
<h2></h2>
<h2>End Notes</h2>
<p><span>In this article, we refreshed some of D3‚Äôs basics and further learned a lot of techniques and new functionalities. We also learned how to preprocess data and successfully build a line chart and modified it into an area chart. </span></p>
<p><span>We used a practice problem to create a colorful bar chart. We also saw some of the most useful and amazing visualizations created using D3.js. We ended up analyzing Game of Thrones data using one of the case studies &#8211; Force Directed Graph and with this, </span></p>
<p><span>I hope, this article has given you the necessary impetus on your D3 journey! </span></p>
<p><span>All of the code used in this article is </span><a href="https://github.com/mohdsanadzakirizvi/d3js" target="_blank" rel="noopener"><span>available at GitHub</span></a><span>.</span></p>
<p><span>Here are some useful links for D3.js :</span></p>
<ul>
<li><span>D3.js, Data Visualization Meetup &#8211; </span><a href="https://vimeo.com/29458354" target="_blank" rel="noopener"><span>https://vimeo.com/29458354</span></a></li>
<li><span>D3.js Tips and Tricks Book- </span><a href="https://leanpub.com/D3-Tips-and-Tricks/read" target="_blank" rel="noopener"><span>https://leanpub.com/D3-Tips-and-Tricks/read</span></a></li>
<li><span>Mike Bostock‚Äôs Blog &#8211; </span><a href="https://bost.ocks.org/mike/" target="_blank" rel="noopener"><span>https://bost.ocks.org/mike/</span></a></li>
<li><span>This site is like GitHub for D3 projects &#8211; </span><a href="https://bl.ocks.org/" target="_blank" rel="noopener"><span>https://bl.ocks.org/</span></a></li>
</ul>
<p>&nbsp;</p>
<script>
  $(function() {
    var toc = $('#toc');
    function makeLi(text, href) {
      return $('<a href="' + href + '">' + text + '</a><br>');
    }
    $(":header").each(function(i) {
      var chapter = $(this), chapterNumber = i + 1;
      toc.append(
        makeLi(chapter.text(), '#chapter-' + chapterNumber)
      );
      chapter.attr('id', 'chapter-' + chapterNumber);
    });
  });

$(document).ready(function(){
    $(":header").click(function(){
    parent.history.back();
    return false;
    });
});
</script>


</body>
</html>
