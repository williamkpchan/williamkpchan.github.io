<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<style>

a:hover,a:active{color:red}
table.w3-table-all{margin:20px 0}
.top {
 position:relative;
 background-color:black;
 height:68px;
 padding-top:20px;
 line-height:50px;
 overflow:hidden;
 z-index:2;
}
body {
 background-color: #000000;
 color: MediumSeaGreen;
 margin-left: 14%;
 margin-right: 14%;
 font-size: 24px;
}
a { text-decoration: none;
	color: #58D858;}
a:visited { color: #88C898;}
A:hover {	color: yellow;}
A:focus {	color: red;}
code { color: gray; background-color: #002010}
pre { color: lightblue; background-color: #001010; font-size: 20px;}
h1, h2, h3, h4, h5, .goldword {
	color: gold;
}
table{
	width: 100%;
	font-size: 20px;
	border-collapse: collapse;
	border: 1px solid gray;
}
th{
	border: 1px solid gray;
	font-weight:bold;
	color: lightgreen;
}
td{
	padding:10px;
	border: 1px dotted dimgray;
}
tr>th:first-child{
	width:40%;
}
tr>td:first-child{
	color: lime;

}
img{
	margin-top:1%;
	margin-bottom:2%;
}
.topic{
    color: lime;
}
.goldsha {
    color: white;
    border: 1px solid gold;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px gold inset;
}
.redsha {
    color: gold;
    border: 1px solid red;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px red inset;
}
.whitesha {
    color: red;
    border: 1px solid white;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -3px -2px 3px white inset;
}
.orangesha {
    color: yellow;
    border: 1px solid orange;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px orange inset;
}
.yellowsha {
    color: lime;
    border: 1px solid yellow;
    padding: 2px;
    border-radius: 3px;
	box-shadow: 3px 3px 3px silver;
	display: inline-block;
}
.greensha {
    color: lightblue;
    border: 1px solid green;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px green inset;
}
.left {
    position: absolute;
    left: 100px;
    color: GoldenRod;
    border: 1px solid GoldenRod;
    padding: 2px;
    font-size: 60%;
}
.bord {
    color: redpink;
    border: 1px solid GoldenRod;
    padding: 1px;
    font-size: 90%;
}
.yellowbord {
    color: lime;
    border: 1px solid yellow;
    padding: 2px;
    border-radius: 3px;
	box-shadow: 3px 3px 3px silver;
}
.bluebord {
    color: white;
    border: 1px solid lightblue;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px silver inset;
}
.highlight { 
    color: white;
    background-color: #002030
  }
hr {width: 50%;}
li{
	list-style-type: decimal;
}
#toc, #tang, #san, #pill {
	margin-left: 15%;
	margin-right: 15%;
	color: gold;
	padding: 1%;
	text-align: left;
	box-shadow: 5px 5px 15px silver;
	border-radius: 5px;
	border: 1px solid DarkSlateGray;
    font-size: 90%;
}
.mywords{
    color: Crimson;
}
.orangeword{
    color: orange;
}
.remarks {
	font-size: 22px;
	color: MediumSeaGreen;
}
</STYLE>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script>
$(document).ready(function(){
    $('h1, h2, h3, h4, h5, .goldword, .topic').click(function(){
    parent.history.back();
    return false;
    });
});
</script>


</head><body>

<center><h3>R Mathematics</h3></center>
<br>


<a href="#Basics">1 Basics</a><br><br>
<a href="#Linear_Algebra">2 Linear Algebra</a><br>
<a href="#Vectors">2.1 Vectors</a><br>
<a href="#The_inner_product">2.1.1 The inner product</a><br>
<a href="#The_outer_product">2.1.2 The outer product</a><br>
<a href="#Matrix_Algebra">2.2 Matrix Algebra</a><br>
<a href="#Some_special_matrix">2.3 Some special matrix</a><br>
<a href="#Matrix_calculations">2.4 Matrix calculations</a><br>
<a href="#Matrix_transposition">2.5 Matrix transposition</a><br>
<a href="#The_trace_and_determinant_of_a_matrix">2.6 The trace and determinant of a matrix</a><br>
<a href="#Matrix_inversion">2.7 Matrix inversion</a><br>
<a href="#Solving_a_linear_equation">2.8 Solving a linear equation</a><br>
<a href="#Eigenvalue.2C_eigenvector_and_eigenspace">2.9 Eigenvalue, eigenvector and eigenspace</a><br>
<a href="#Misc">2.10 Misc</a><br><br>
<a href="#Analysis">3 Analysis</a><br>
<a href="#Logarithm_and_Exponents">3.1 Logarithm and Exponents</a><br>
<a href="#Polynomial_equations">3.2 Polynomial equations</a><br>
<a href="#Derivatives">3.3 Derivatives</a><br>
<a href="#Symbolic_calculations">3.3.1 Symbolic calculations</a><br>
<a href="#Numerical_approximation">3.3.2 Numerical approximation</a><br>
<a href="#Integration">3.4 Integration</a><br><br>
<a href="#Probability">4 Probability</a><br><br>
<a href="#Arithmetics">5 Arithmetics</a><br>
<a href="#The_factorial_function">5.1 The factorial function</a><br>
<a href="#The_modulo_function_and_euclidian_division">5.2 The modulo function and euclidian division</a><br><br>
<a href="#Geometry">6 Geometry</a><br><br>
<a href="#Symbolic_calculus">7 Symbolic calculus</a><br><br>
<a href="#See_also">8 See also</a><br><br>
<a href="#References">9 References</a><br><br>
<p></p>
<h2><span id="Basics">Basics</span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
?Arithmetic
?Special
</pre></div>
<h2><span id="Linear_Algebra">Linear Algebra</span></h2>
<h3><span id="Vectors">Vectors</span></h3>
<h4><span id="The_inner_product">The inner product</span></h4>
<p>The inner product is also called the <i>dot product</i> or the <i>scalar product</i>. It is the sum of the item-by-item product.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; u &lt;- rep(3,3)
<br>
&gt; v &lt;- 1:3
<br>
&gt; u%*%v <span class="c1"># the inner product
     [,1]
[1,]   18
</pre></div>
<h4><span id="The_outer_product">The outer product</span></h4>
<p>The outer product is also called the <i>cross product</i> or the <i>vector product</i>. It is a matrix resulting from the product of the elements of the two vectors.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; v &lt;- rep(3,3)
<br>
&gt; u &lt;- 1:3
<br>
&gt; u%o%v <span class="c1"># The outer product
     [,1] [,2] [,3]
[1,]    3    3    3
[2,]    6    6    6
[3,]    9    9    9
</pre></div>
<h3><span id="Matrix_Algebra">Matrix Algebra</span></h3>
<p>If you want to create a new matrix, one way is to use the <tt>matrix()</tt> function. You have to enter a vector of data, the number of rows and/or columns and finally you can specify if you want R to read your vector by row or by column (the default option) with <tt>byrow</tt>. You can also combine vectors using <tt>cbind()</tt> or <tt>rbind()</tt>. The dimension of a matrix can be obtained using the <tt>dim()</tt> function or alternatively <tt>nrow()</tt> and <tt>ncol()</tt>.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; matrix(data = <span class="kc">NA, nrow = 5, ncol = 5, byrow = <span class="bp">T)
<br>
&gt; matrix(data = 1:15, nrow = 5, ncol = 5, byrow = <span class="bp">T)
<br>
&gt; v1 &lt;- 1:5
<br>
&gt; v2 &lt;- 5:1
<br>
&gt; cbind(v1,v2)
<br>
&gt; rbind(v1,v2)
<br>
&gt; dim(X)
<br>
&gt; nrow(X)
<br>
&gt; ncol(X)
</pre></div>
<h3><span id="Some_special_matrix">Some special matrix</span></h3>
<p>The identity matrix has ones on the diagonal and zeros outside the diagonal.</p>
<ul>
<li><tt>eye()</tt> (<b>matlab</b>)</li>
<li><tt>diag(1,nrow=10,ncol=10)</tt></li>
<li><tt>diag(rep(1,10))</tt></li>
</ul>
<p>J matrix is full of ones</p>
<ul>
<li><tt>ones()</tt> (<b>matlab</b>)</li>
</ul>
<p>A matrix full of zeros</p>
<ul>
<li><tt>zeros()</tt> (<b>matlab</b>)</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; <span class="kn">library(matlab)
<br>
&gt; eye(3)
     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1
<br>
&gt; ones(3)
     [,1] [,2] [,3]
[1,]    1    1    1
[2,]    1    1    1
[3,]    1    1    1
<br>
&gt; zeros(3) 
     [,1] [,2] [,3]
[1,]    0    0    0
[2,]    0    0    0
[3,]    0    0    0
</pre></div>
<p>Diagonal matrix</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; diag(3)

     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1
</pre></div>
<p>Upper triangular</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; round(upper.tri(matrix(1, n, n))) 

<span class="kr">for n=3
     [,1] [,2] [,3]
[1,]    0    1    1
[2,]    0    0    1
[3,]    0    0    0

If you also need the diagonal of one<span class="s">'<span class="err">s 

<br>
&gt; round(upper.tri(matrix(1, 3, 3), diag = <span class="kc">TRUE))

      [,1] [,2] [,3]
[1,]    1    1    1
[2,]    0    1    1
[3,]    0    0    1
</pre></div>
<p>Lower triangular</p>
<p>Same as upper triangular but using lower.tri instead</p>
<p><br /></p>
<ul>
<li>create an Hilbert matrix using <tt>hilbert()</tt> (fUtilities).</li>
</ul>
<h3><span id="Matrix_calculations">Matrix calculations</span></h3>
<ul>
<li>compute a <a href="https://en.wikipedia.org/wiki/Matrix_multiplication" class="extiw" title="w:Matrix multiplication">matrix multiplication</a> <tt>X%*%Y</tt>.</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; b &lt;- matrix(nrow = 2, ncol = 2, c(1, 2, 3, 4))
<br>
&gt; a &lt;- matrix(nrow = 2, ncol = 2, c(1, 0, 0, -1))
<br>
&gt; a
     [,1] [,2]
[1,]    1    0
[2,]    0   -1
<br>
&gt; b
     [,1] [,2]
[1,]    1    3
[2,]    2    4
<br>
&gt; a%*%b
     [,1] [,2]
[1,]    1    3
[2,]   -2   -4
<br>
&gt; b%*%a
     [,1] [,2]
[1,]    1   -3
[2,]    2   -4
</pre></div>
<ul>
<li>compute the <a class="external text" href="http://en.wikipedia.org/wiki/Kronecker_product">Kronecker</a> product using <tt>%x%</tt> or <tt>kron()</tt> (<b>fUtilities</b>).</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; M &lt;- matrix(rep(2,4),nrow = 2) 
<br>
&gt; M
     [,1] [,2]
[1,]    2    2
[2,]    2    2
<br>
&gt; I &lt;- eye(2) 
<br>
&gt; I
     [,1] [,2]
[1,]    1    0
[2,]    0    1
<br>
&gt; I %x% M 
     [,1] [,2] [,3] [,4]
[1,]    2    2    0    0
[2,]    2    2    0    0
[3,]    0    0    2    2
[4,]    0    0    2    2
<br>
&gt; <span class="kn">library(fUtilities)
<br>
&gt; kron(I,M)
     [,1] [,2] [,3] [,4]
[1,]    2    2    0    0
[2,]    2    2    0    0
[3,]    0    0    2    2
[4,]    0    0    2    2
</pre></div>
<h3><span id="Matrix_transposition">Matrix transposition</span></h3>
<ul>
<li>Transpose the matrix</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; t(M)
     [,1] [,2] [,3]
[1,]    1    0    1
[2,]    0    1    2
[3,]    0    0    1
</pre></div>
<h3><span id="The_trace_and_determinant_of_a_matrix">The trace and determinant of a matrix</span></h3>
<ul>
<li>compute the trace of a matrix using <tt>tr()</tt> (fUtilities)</li>
<li>returns the rank of a matrix using <tt>rk()</tt> (<b>fBasics:</b>)</li>
</ul>
<h3><span id="Matrix_inversion">Matrix inversion</span></h3>
<ul>
<li>Invert a matrix using <tt>solve()</tt> or <tt>inv()</tt> (<b>fUtilities</b>). We can also compute the generalized inverse using <tt>ginv()</tt> in the <b>MASS</b> package.</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; M &lt;- cbind(c(1,0,1),c(0,1,2),c(0,0,1))
<br>
&gt; solve(M)
     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]   -1   -2    1
<br>
&gt; solve(M)%*%M
     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1
</pre></div>
<h3><span id="Solving_a_linear_equation">Solving a linear equation</span></h3>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; m=matrix(nrow=2,ncol=2,c(1,-.8,1,.2))
<br>
&gt; m
     [,1] [,2]
[1,]  1.0  1.0
[2,] -0.8  0.2
<br>
&gt; 
<br>
&gt; l=matrix(c(1.0+25.0/18,25.0/18.0))
<br>
&gt; l
         [,1]
[1,] 2.388889
[2,] 1.388889
<br>
&gt; 
<br>
&gt; k=solve(m,l)
<br>
&gt; k
           [,1]
[1,] -0.9111111
[2,]  3.3000000
<br>
&gt; 
<br>
&gt; m%*%k          <span class="c1">#checking the answer
         [,1]
[1,] 2.388889
[2,] 1.388889
&gt;
</pre></div>
<p><br /></p>
<h3><span id="Eigenvalue,_eigenvector_and_eigenspace"><span id="Eigenvalue.2C_eigenvector_and_eigenspace">Eigenvalue, eigenvector and eigenspace</span></h3>
<ul>
<li>Eigenvalues and eigenvectors</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; eigen(M)
$values
[1] 1 1 1

$vectors
     [,1]          [,2]          [,3]
[1,]    0  2.220446e-16  0.000000e+00
[2,]    0  0.000000e+00  1.110223e-16
[3,]    1 -1.000000e+00 -1.000000e+00
</pre></div>
<h3><span id="Misc">Misc</span></h3>
<ul>
<li>compute the norm of a matrix using <tt>norm()</tt> (fUtilities).</li>
<li>check if a matrix is positive definite <tt>isPositiveDefinite()</tt> (fUtilities).</li>
<li>make a matrix positive definite <tt>makePositiveDefinite()</tt> (fUtilities).</li>
</ul>
<ul>
<li>computes row statistics and column statistics (fUtilities).</li>
<li>extract the upper and the lower part of a matrix <tt>triang()</tt> and <tt>Triang()</tt> (fUtilities).</li>
<li>See also the <b>matrix</b>, <b>matlab</b>, <b>matrixcalc</b>, <b>matrixStats</b> packages.</li>
</ul>
<h2><span id="Analysis">Analysis</span></h2>
<h3><span id="Logarithm_and_Exponents">Logarithm and Exponents</span></h3>
<p>We have the power function <tt>10^3</tt> or <tt>10**3</tt> , the logarithm and the exponential <tt>log(2.71)</tt>, <tt>log10(10)</tt>,<tt>exp(1)</tt>.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; 10^3 <span class="c1"># exponent
[1] 1000
<br>
&gt; 10**3 <span class="c1"># exponent
[1] 1000
<br>
&gt; exp(1) <span class="c1"># exponential
[1] 2.718282
<br>
&gt; log(2.71) <span class="c1"># natural logarithm
[1] 0.9969486
<br>
&gt; log10(1000) <span class="c1"># base 10 logarithm
[1] 3
<br>
&gt; log(1000,base = 10) <span class="c1"># base 10 logarithm
[1] 3
</pre></div>
<p><br /></p>
<h3><span id="Polynomial_equations">Polynomial equations</span></h3>
<p>To solve <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" >
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <msup>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msup>
        <mo>+</mo>
        <mi>b</mi>
        <msup>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>&#x2212;<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msup>
        <mo>+</mo>
        <mo>&#x22EF;<!-- ⋯ --></mo>
        <mo>+</mo>
        <mi>n</mi>
        <mo>=</mo>
        <mn>0</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle ax^{k}+bx^{k-1}+\cdots +n=0}</annotation>
  </semantics>
</math><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/05fd85cdb8dbf2c836fef37c2bb94b7e2cba232b" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.505ex; width:26.209ex; height:2.843ex;" alt="{\displaystyle ax^{k}+bx^{k-1}+\cdots +n=0}" />, where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" >
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>a</mi>
        <mo>,</mo>
        <mi>b</mi>
        <mo>,</mo>
        <mo>&#x2026;<!-- … --></mo>
        <mo>,</mo>
        <mi>n</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a,b,\dots ,n}</annotation>
  </semantics>
</math><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d86e78af685fad9dec76559501033892ccf8f656" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:9.907ex; height:2.509ex;" alt="{\displaystyle a,b,\dots ,n}" /> are given numbers, use the command</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; polyroot(c(n,<span class="kc">...,b,a))
</pre></div>
<p>So, for example, to calculate the roots of the equation <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" >
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mn>2</mn>
        <msup>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
        <mo>&#x2212;<!-- − --></mo>
        <mn>5</mn>
        <mi>x</mi>
        <mo>&#x2212;<!-- − --></mo>
        <mn>3</mn>
        <mo>=</mo>
        <mn>0</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle 2x^{2}-5x-3=0}</annotation>
  </semantics>
</math><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0ec87b10a0c3a5fdd5fb856c27cc46e9aeb1eac1" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:17.244ex; height:2.676ex;" alt="{\displaystyle 2x^{2}-5x-3=0}" /> one would do as follows:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; polyroot(c(-3,-5,2))
 [1] -0.5+0i  3.0-0i
</pre></div>
<p>and the solution can be read to be <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" >
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>=</mo>
        <mo>&#x2212;<!-- − --></mo>
        <mn>0.5</mn>
        <mo>&#x2227;<!-- ∧ --></mo>
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo>=</mo>
        <mn>3</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle x_{1}=-0.5\land x_{2}=3}</annotation>
  </semantics>
</math><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b92e3f1deee61265a6711a2d7a81bade8b19ec03" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:19.609ex; height:2.509ex;" alt="{\displaystyle x_{1}=-0.5\land x_{2}=3}" />.</p>
<p>See also <b>polynom</b> and <b>multipol</b> packages</p>
<h3><span id="Derivatives">Derivatives</span></h3>
<h4><span id="Symbolic_calculations">Symbolic calculations</span></h4>
<p>R can give the derivative of an <i>expression</i>. You need to convert your function as an expression using the <tt>expression()</tt> function. Otherwise you get an error message.</p>
<p>Here are some examples&#160;:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; D(expression(x^n),<span class="s">"x")
x^(n - 1) * n
<br>
&gt; D(expression(exp(a*x)),<span class="s">"x")
exp(a * x) * a
<br>
&gt; D(expression(1/x),<span class="s">"x")
-(1/x^2)
<br>
&gt; D(expression(x^3),<span class="s">"x")
3 * x^2
<br>
&gt; D(expression(pnorm(x)),<span class="s">"x")
dnorm(x)
<br>
&gt; D(expression(dnorm(x)),<span class="s">"x")
-(x * dnorm(x))
</pre></div>
<h4><span id="Numerical_approximation">Numerical approximation</span></h4>
<ul>
<li><b>numDeriv</b> package</li>
</ul>
<h3><span id="Integration">Integration</span></h3>
<p>R can perform one dimensional integration. For example we can integrate over the density of the normal distribution between <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" >
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo>&#x2212;<!-- − --></mo>
        <mi mathvariant="normal">&#x221E;<!-- ∞ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle -\infty }</annotation>
  </semantics>
</math><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ca2608c4b5fd3bffc73585f8c67e379b4e99b6f1" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:4.153ex; height:1.676ex;" alt="-\infty " /> and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" >
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo>+</mo>
        <mi mathvariant="normal">&#x221E;<!-- ∞ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle +\infty }</annotation>
  </semantics>
</math><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bddbb0e4420a7e744cf71bd71216e11b0bf88831" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.505ex; width:4.153ex; height:2.176ex;" alt="+\infty " /></p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; integrate(dnorm,-<span class="kc">Inf,<span class="kc">Inf)
1 with absolute error &lt; 9.4e-05
<br>
&gt; integrate(dnorm,-1.96,1.96)
0.9500042 with absolute error &lt; 1.0e-11
<br>
&gt; integrate(dnorm,-1.64,1.64)
0.8989948 with absolute error &lt; 6.8e-14
<span class="c1"># we can also store the result in an object
<br>
&gt; ci90 &lt;- integrate(dnorm,-1.64,1.64)
<br>
&gt; ci90$value
[1] 0.8989948
<br>
&gt; integrate(dnorm,-1.64,1.64)$value
[1] 0.8989948
</pre></div>
<p>see the adapt package for multivariate integration.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; <span class="kn">library(adapt)
<br>
&gt; ?adapt
<br>
&gt; ir2pi &lt;- 1/sqrt(2*<span class="kc">pi)
<br>
&gt; fred &lt;- <span class="kr">function(z) { ir2pi^length(z) * exp(-0.5 * sum(z * z))}
<br>
&gt; 
<br>
&gt; adapt(2, lo = c(-5,-5), up = c(5,5), functn = fred)
       value       relerr       minpts       lenwrk        ifail 
    1.039222 0.0007911264          231           73            0 
<br>
&gt; adapt(2, lo = c(-5,-5), up = c(5,5), functn = fred, eps = 1e-4)
       value       relerr       minpts       lenwrk        ifail 
    1.000237 1.653498e-05          655          143            0 
<br>
&gt; adapt(2, lo = c(-5,-5), up = c(5,5), functn = fred, eps = 1e-6)
      value      relerr      minpts      lenwrk       ifail 
   1.000039 3.22439e-07        1719         283           0
</pre></div>
<ul>
<li>See also <tt>integrate.gh()</tt> in the <b>ecoreg</b> package.</li>
</ul>
<h2><span id="Probability">Probability</span></h2>
<ul>
<li>The number of combination of length k within n numbers&#160;: <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" >
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>C</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle C_{n}^{k}}</annotation>
  </semantics>
</math><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9b088b67f00e4739e57c658ac7dd5913898013ac" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:2.904ex; height:2.843ex;" alt="{\displaystyle C_{n}^{k}}" /></li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; choose(100, 5)
[1] 75287520
</pre></div>
<ul>
<li>Union and intersection</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; union(1:10, 5:7)
[1]  1  2  3  4  5  6  7  8  9 10
<br>
&gt; intersect(1:10, 5:7)
[1] 5 6 7
</pre></div>
<h2><span id="Arithmetics">Arithmetics</span></h2>
<h3><span id="The_factorial_function">The factorial function</span></h3>
<p><tt>factorial</tt> returns the factorial of an integer. This can also be computed using the <tt>prod()</tt> (product) applied to the vector of integers between 1 and the number of interest.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; factorial(3)
[1] 6
<br>
&gt; prod(1:3)
[1] 6
</pre></div>
<p>Note that by convention <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" >
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mn>0</mn>
        <mo>!</mo>
        <mo>=</mo>
        <mn>1</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle 0!=1}</annotation>
  </semantics>
</math><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/22956a0fa255c6c9562eab440f8c23c2954a6cf4" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:6.112ex; height:2.343ex;" alt="0!=1" />. <tt>factorial()</tt> returns 1 in 0. This is not the case with the <tt>prod()</tt> functions.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; factorial(0)
[1] 1
<br>
&gt; prod(0)
[1] 0
</pre></div>
<p>Factorial numbers can be very large and cannot be computed for high values.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; factorial(170)
[1] 7.257416e+306
<br>
&gt; factorial(171)
[1] <span class="kc">Inf
Message d<span class="s">'avis :
<span class="s">In factorial(171) : value out of range in 'gammafn<span class="s">'
</pre></div>
<h3><span id="The_modulo_function_and_euclidian_division">The modulo function and euclidian division</span></h3>
<ul>
<li>Modulo and integer division (i.e. euclidean division)</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; 5%%2
[1] 1
&gt;5%/%2
[1] 2
</pre></div>
<p>Note: R is affected by <a rel="nofollow" class="external text" href="http://stackoverflow.com/questions/9508518/why-are-these-numbers-not-equal">the problem</a> with non integer numbers and euclidian divisions.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre>
<br>
&gt; .5%/%.1 <span class="c1"># we get 4 instead of 5
[1] 4
<br>
&gt; .5%%.1 <span class="c1"># we get .1 instead of 0
[1] 0.1
</pre></div>
<h2><span id="Geometry">Geometry</span></h2>
<ul>
<li><tt>pi</tt> the constant</li>
<li><tt>cos()</tt>, <tt>sin()</tt>, <tt>tan()</tt> the trigonometric functions.</li>
</ul>
<h2><span id="Symbolic_calculus">Symbolic calculus</span></h2>
<p><b>rSymPy</b> (<a rel="nofollow" class="external text" href="http://code.google.com/p/rsympy/">rsympy</a>) provides <b>sympy</b> (<a rel="nofollow" class="external text" href="http://code.google.com/p/sympy/">link</a>) functions in R.</p>
<p>If you want to do more symbolic calculus, see Maxima<sup id="cite_ref-1" class="reference"><a href="#cite_note-1">[1]</a></sup>, SAGE<sup id="cite_ref-2" class="reference"><a href="#cite_note-2">[2]</a></sup>, Mathematica<sup id="cite_ref-3" class="reference"><a href="#cite_note-3">[3]</a></sup></p>
<h2><span id="See_also">See also</span></h2>
<p>The following command gives help on special mathematical functions related to the beta and gamma functions.</p>
<pre>
?Special
</pre>
<h2><span id="References">References</span></h2>
Maxima is open source <a target="_blank" href="http://maxima.sourceforge.net/">http://maxima.sourceforge.net/</a><br>
SAGE is an open source package which includes R and Maxima&#160;: <a target="_blank" href="http://www.sagemath.org/">http://www.sagemath.org/</a><br>
Mathematica is not open source <a target="_blank" href="http://www.wolfram.com/products/mathematica/index.html">http://www.wolfram.com/products/mathematica/index.html</a>
<br>
<br><br><br><br><br>
