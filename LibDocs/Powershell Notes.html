<base target="_blank">
<head>
<title>Powershell Notes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width"/>
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script>
$(document).ready(function(){
    $('h1, h2, h3, h4, h5, .goldword, strong,  div.title').click(function(){
    parent.history.back();
    return false;
    });
    $('h2').click(function() { scrollTo(0,document.body.scrollHeight);});
});
</script>
<style>
body{width:80%;margin-left: 10%; font-size:24px;}
strong, h1, h2 {color: gold;}
img {max-width:100%; display: inline-block; margin-left: auto; margin-right: auto;border-radius: 5px;padding-top:10px;}
pre { text-align: left; width:70%;}

</style>
</head>
<body onkeypress="chkKey()">
<a href="#mustWatch" class="red goldbs" target="_self">Must Watch!</a>
<div class="imagearea"> </div>
<br>
<center>
<div id="toc"></div>

<br>
<br>
<span class="redbut whitebs silver">keys: b backward, f foreward, t TOC, T top, e bottom, m must watch, r random</span>
<br><br>
<div id="mustWatch">
</div>
</center>
<br>
<br>
<br>
<br>
<br>
<br>

<script>
var toc = $('#toc');
var patt1 = /(<h2>).*(<\/h2>)/i;
var patt2 = /(<h2[^>]*>|<\/h2>)/g;

function makeTOC(theStr, index) {
	var topic = theStr.match(patt1)[0];
	topic = topic.replace(patt2, "");
	toc.append((index +1) + ' <span class="gray" onclick="jumpto(' + index + ')">' + topic +'</span><br>');
}

function jumpto(index) {
	topicpointer = index;
	showImg();
}
function chkKey() {
var testkey = getChar(event);
if(testkey == "b"){ backward();}
if(testkey == 'e'){window.scrollTo(0,document.body.scrollHeight);}
if(testkey == "f"){ foreward();}
if(testkey == "l"){divtoc = document.getElementById("toc");$('body,html').animate({scrollTop:(divtoc.clientHeight + divtoc.offsetTop-600)}, 1); }
if(testkey == "m"){ location = '#mustWatch';}
if(testkey == "p"){ pause();}
if(testkey == "c"){ continU();}
if(testkey == "r"){ randomFlip();}
if(testkey == "s"){ showMov();}
if(testkey == 't'){window.location = '#toc';}
if(testkey == 'T'){window.scrollTo(0,0);}
}
function getChar(event){if (event.which!=0 && event.charCode!=0) {return String.fromCharCode(event.which)}
 else {return null}}

var ImgList = [
'<h2>Windows PowerShell Scripting Tutorial</h2><div class="toc"> <a href="#pstopic-1" target="_self">start learning</a><br> <a href="#pstopic-2" target="_self">Preparing to Run PowerShell Scripts</a><br> <a href="#pstopic-3" target="_self">PowerShell Cmdlets</a><br> <a href="#pstopic-4" target="_self"> -- About Cmdlets</a><br> <a href="#pstopic-5" target="_self"> -- Cmdlet Format</a><br> <a href="#pstopic-6" target="_self"> -- Available Cmdlets</a><br> <a href="#pstopic-7" target="_self"> -- Parameters</a><br> <a href="#pstopic-8" target="_self"> -- Aliases </a><br> <a href="#pstopic-9" target="_self"> -- Comments</a><br> <a href="#pstopic-10" target="_self"> -- Pipes</a><br> <a href="#pstopic-11" target="_self"> -- Summary</a><br></div><br><h3 id="pstopic-1">start learning</h3><br>Handpicked related content:<a href="https://www.netwrix.com/powershell_tutorial_pdf.html?itm_source=blog&amp;itm_medium=context&amp;itm_campaign=powershell&amp;itm_content=none&amp;cID=70170000000kgEZ">Free Download: PowerShell Scripting Tutorial for Beginners</a><br>So let‚Äôs start learning PowerShell.<br>PowerShell offers both a command-line option and an integrated scripting environment (ISE):<br>To launch the PowerShell command line, type <em>powershell.exe</em>  in the Windows Start menu. <br>You‚Äôll see a screen like the following:<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS1.png"><br><br>To launch the PowerShell ISE, type <em>powershell_ise.exe</em>  in the Start menu. <br>Using the PowerShell ISE is the preferred way to work with the scripting language, because it provides syntax highlighting, auto-filling of commands and other automation features that simplify script development and testing.<br><a href="https://blog.netwrix.com/wp-content/uploads/2018/02/PS2.png"><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS2.png"><br></a><br><h3 id="pstopic-2">Preparing to Run PowerShell Scripts</h3><br>PowerShell scripts are stored in.ps1 files. <br>By design, you cannot run a script by simply double-clicking a file; this helps avoid accidental harm to your systems. <br>Instead, to execute a script, right-click it and click ‚ÄúRun with PowerShell‚Äù:<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS3.png"><br><br>In addition, there is policy that restricts script execution. <br>You can check this policy by running the Get-ExecutionPolicy command in PowerShell:<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS4.png"><br><br>You will get one of the following values:<br>Restricted‚Äî No scripts are allowed. <br>This is the default setting, so you will see it the first time you run the command.<br>AllSigned‚Äî You can run scripts signed by a trusted developer. <br>With this setting in place, before executing, a script will ask you to confirm that you want to run it.<br>RemoteSigned‚Äî You can run your own scripts or scripts signed by a trusted developer.<br>Unrestricted‚Äî You can run any script you want.<br>To start working with PowerShell, you‚Äôll need to change the policy setting from Restricted to RemoteSigned using the Set-ExecutionPolicy RemoteSigned command:<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS5.png"><br><br><h3 id="pstopic-3">PowerShell Cmdlets</h3><br><h4 id="pstopic-4"> -- About Cmdlets</h4><br>A cmdlet is a PowerShell command with a predefined function, similar to an operator in a programming language. <br>Here are some key things to know about cmdlets:<br>There are system, user and custom cmdlets.<br>Cmdlets output results as an object or as an array of objects.<br>Cmdlets can get data for analysis or transfer data to another cmdlet using pipes (I‚Äôll discuss pipes more in a moment).<br>Cmdlets are case-insensitive. <br>For example, it doesn‚Äôt matter whether you type ‚ÄúGet-ADUser‚Äù, ‚Äúget-aduser‚Äù or ‚ÄúgEt-AdUsEr‚Äù.<br>If you want to use several cmdlets in one string, you must separate them with a semicolon (;).<br><h4 id="pstopic-5"> -- Cmdlet Format</h4><br>A cmdlet always consists of a verb (or a word that functions as a verb) and a noun, separated with a hyphen (the ‚Äúverb-noun‚Äù rule). <br>For example, some of the verbs include:<br>Get ‚Äî To get something<br>Set ‚Äî To define something<br>Start ‚Äî To run something<br>Stop ‚Äî To stop something that is running<br>Out ‚Äî To output something<br>New ‚Äî To create something (‚Äúnew‚Äù is not a verb, of course, but it functions as one)<br>For practice, try executing the following cmdlets:<br>Get-Process ‚Äî Shows the processes currently running on your computer:<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS6.png"><br><br>Get-Service ‚Äî Shows the list of services with their status<br>Get-Content ‚Äî Shows the content of the file you specify (for example, Get-Content C:\Windows\System32\drivers\etc\hosts)<br><h4 id="pstopic-6"> -- Available Cmdlets</h4><br>Good news ‚Äî you don‚Äôt need to memorize all cmdlets. <br>You can list all cmdlets by executing the Get-Help -Category cmdlet, which will return the following:<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS7.png"><br><br>You can also create your own custom cmdlets.<br><h4 id="pstopic-7"> -- Parameters</h4><br>Each cmdlet has several parameters that customize what it does. <br>The PowerShell ISE will automatically suggest all valid parameters and their types after you type a cmdlet and a hyphen (-):<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS8.png"><br><br>For example, the following cmdlet shows all services whose names start with ‚ÄúW‚Äù: Get-Service -Name W*<br>If you forget a cmdlet‚Äôs parameters, just use a script like the following, which will display the parameters for the Get-Process cmdlet:<br>Get-Process | Get-Member<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS9.png"><br><br>If you still don‚Äôt find the cmdlet you need, you can make sure the help is current and then get examples for a cmdlet (such as Get-Process) using a script like this:<br>Update-Help #to update the help data<br>Get-Help Get-Process -Examples<br><br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS10.png"><br><br><h4 id="pstopic-8"> -- Aliases </h4><br>You can also use aliases, which are shortened cmdlet names. <br>For instance, instead of ‚ÄúGet-Help‚Äù you can use just ‚ÄúHelp‚Äù. <br>Try running the following two commands and see whether you get the same result:<br>Start-Process notepad<br>start notepad<br>Similarly, to stop this process, you can use either of the following commands:<br>Stop-Process -Name notepad<br>spps -Name notepad<br>To see all aliases, execute the Get-Alias cmdlet.<br><h4 id="pstopic-9"> -- Comments</h4><br>Leaving comments in a script will help you ‚Äî and your colleagues ‚Äî better understand what the script does. <br>A string comment is a single line that starts with a number sign (#), and block comments start and end with number signs and angle brackets and spread across multiple lines.<br><img src="https://blog.netwrix.com/wp-content/uploads/2018/02/PS11.png"><br><br><h4 id="pstopic-10"> -- Pipes</h4><br>A pipe passes data from one cmdlet to another. <br>I used a pipe earlier to get all properties of an object.<br>For example, if you execute the following script, you‚Äôll get all services sorted by their status:<br>Get-Service | Sort-Object -property Status<br><br>You can also use a pipe to output text to a file using a script like the following:<br>"Hello, World!" | Out-File C:\ps\test.txt<br><br>You can use multiple pipes. <br>For instance, the following script lists all services, with the first pipe excluding stopped services and the second pipe limiting the list to display names only:<br>Get-Service | WHERE {$_.status -eq "Running"} | SELECT displayname<br># ‚Äú$_.‚Äù defines current element in the pipe<br><br><h4 id="pstopic-11"> -- Summary</h4><br>Let‚Äôs quickly summarize the key points of this Windows PowerShell tutorial. <br>Now you know how to run PowerShell, how to change execution policy, what a cmdlet is, how to pass data using pipe and how to get object properties. <br>Keep in mind that if you forget something, you can always use the Get-Help cmdlet.<br>I hope you found this PowerShell for beginners useful!<br>In the next parts of this free PowerShell tutorial, I‚Äôll cover <a href="https://blog.netwrix.com/2018/10/04/powershell-variables-and-arrays/">variables, arrays</a> and cycles, which are used in PowerShell scripting to simplify the administration of Windows Servers.<br>In the meantime, you might want to check out the following PowerShell scripts used by IT professionals to address specific cases:<br><ol><a href="https://www.netwrix.com/how_to_get_ad_user_group_membership.html?itm_source=blog&amp;itm_medium=context&amp;itm_campaign=powershell&amp;itm_content=none&amp;cID=70170000000kgEZ">How to get AD user group membership reports</a><br><a href="https://www.netwrix.com/how_to_get_disabled_users.html?itm_source=blog&amp;itm_medium=context&amp;itm_campaign=powershell&amp;itm_content=none&amp;cID=70170000000kgEZ">How to find disabled or inactive users in Active Directory</a><br><a href="https://www.netwrix.com/how_to_find_inactive_computers_active_directory_powershell.html?itm_source=blog&amp;itm_medium=context&amp;itm_campaign=powershell&amp;itm_content=none&amp;cID=70170000000kgEZ">How to find inactive computers in Active Directory</a><br><a href="https://www.netwrix.com/how_to_find_expired_accounts.html?itm_source=blog&amp;itm_medium=context&amp;itm_campaign=powershell&amp;itm_content=none&amp;cID=70170000000kgEZ">How to get a list of expired user accounts in AD</a><br><a href="https://www.netwrix.com/how_to_find_locked_accounts_powershell.html?itm_source=blog&amp;itm_medium=context&amp;itm_campaign=powershell&amp;itm_content=none&amp;cID=70170000000kgEZ">How to find locked out user accounts in Active Directory</a><br><a href="https://www.netwrix.com/how_to_list_all_user_accounts_on_a_windows_system.html?itm_source=blog&amp;itm_medium=context&amp;itm_campaign=powershell&amp;itm_content=none&amp;cID=70170000000kgEZ">How to list all user accounts on a Windows system</a><br><a href="https://blog.netwrix.com/2015/04/06/monitoring-event-logs-with-powershell/">Monitoring event logs with PowerShell </a><br><a href="https://blog.netwrix.com/2015/04/15/local-administrator-group-changes-get-notified-with-powershell/">How to set up notification of local administrator group changes with PowerShell</a><br><a href="https://blog.netwrix.com/2015/06/18/how-to-get-notified-of-expired-password-in-active-directory-with-powershell/">How to get notified of an expired password in Active Directory with PowerShell</a><br><a href="https://blog.netwrix.com/2015/07/16/easy-event-log-querying-with-powershell/">Event log querying with PowerShell</a><br><a href="https://blog.netwrix.com/2015/11/06/windows-event-log-forwarding-with-powershell/">Windows event log forwarding in Windows Server 2008</a><br><a href="https://blog.netwrix.com/2016/04/18/keyboard-shortcuts-for-system-administrators/">Keyboard shortcuts for system administrators </a><br><a href="https://blog.netwrix.com/2017/04/18/powershell-script-discover-new-users-in-active-directory/">How to discover new users in Active Directory using PowerShell</a><br><a href="https://blog.netwrix.com/2017/05/25/office-365-configuring-user-passwords-to-never-expire/">Office 365: Configuring user passwords to never expire</a><br><a href="https://blog.netwrix.com/2017/07/20/how-to-find-inactive-computers-in-active-directory-using-powershell/">How to find inactive computers in Active Directory using PowerShell</a><br><a href="https://blog.netwrix.com/2018/03/29/windows-powershell-vs-command-prompt-cmd-whats-the-difference-and-which-to-choose/">Windows PowerShell vs command prompt (cmd)</a><br><a href="https://blog.netwrix.com/2018/04/18/how-to-manage-file-system-acls-with-powershell-scripts/">How to manage file system ACLs with PowerShell</a><br><a href="https://blog.netwrix.com/2018/05/17/powershell-file-management/">PowerShell File Management</a><br><a href="https://blog.netwrix.com/2018/06/07/how-to-create-new-active-directory-users-with-powershell/">How to create new Active Directory users with PowerShell</a><br><a href="https://blog.netwrix.com/2018/06/19/how-to-add-and-remove-ad-groups-and-objects-in-groups-with-powershell/">How to add and remove AD groups and objects in groups with PowerShell</a><br><a href="https://blog.netwrix.com/2018/06/26/managing-ous-and-moving-their-objects-with-powershell/">Managing OUs and moving their objects with PowerShell</a><br><a href="https://blog.netwrix.com/2018/07/03/how-to-automate-powershell-scripts-with-task-scheduler/">How to automate PowerShell scripts with Task Scheduler</a><br><a href="https://blog.netwrix.com/2018/07/10/how-to-create-delete-rename-disable-and-join-computers-in-ad-using-powershell/">How to create, delete, rename, disable and join computers in AD ssing PowerShell</a><br></ol>And if you are just getting started with PowerShell, I recommend the following resources:<br><a href="https://blog.netwrix.com/2018/10/22/introduction-to-powershell/">Introduction to PowerShell</a><br><a href="https://docs.microsoft.com/en-us/powershell/">PowerShell documentation</a><br><a href="https://blogs.technet.microsoft.com/heyscriptingguy/">‚ÄùHey, Scripting Guy!‚Äù blog</a><br>',
'<h2>Select a Theme and Build a User Profile</h2><br>The first thing I suggest doing is setting up the color theme for productive coding. <br>The default theme is "Dark Console, Light Editor" which is pleasant enough for starting off, but I prefer the "Dark Console, Dark Editor" theme to give code greater contrast and also emulate the natural PowerShell CLI. <br>To make this change, navigate to <strong>Tools</strong> &gt; <strong>Options</strong> &gt; <strong>Colors and Fonts</strong> &gt; <strong>Manage Themes</strong>. <br>This is also where you can tweak other colors if desired, but the font coloring is pretty decent out of the box.<br><img src="https://i0.wp.com/wahlnetwork.com/wp-content/uploads/2015/08/powershell-options-color-dark.jpg"><br>While you\'re here, you can also toggle over to the General Settings tab to adjust the AutoSave interval. <br>It\'s set to 2 minutes by default, which I find to be enough to keep me honest, but you can adjust it up or down to suit your taste.<br>If you want to get fancier, I\'ve actually taken a shine to the <a href="http://eclipsecolorthemes.org/?view=theme&amp;id=1">Oblivion theme</a> on the <a href="http://eclipsecolorthemes.org/">Eclipse Color Themes</a> website. <br>While not usable in its native form, the XML file can be converted to a PowerShell ISE theme using a <a href="https://github.com/akawhoami/psisetheme">converter</a> provided by akawhoami on GitHub.<br><a href="https://i2.wp.com/wahlnetwork.com/wp-content/uploads/2015/08/ect-to-ise-converter.jpg"><img src="https://i2.wp.com/wahlnetwork.com/wp-content/uploads/2015/08/ect-to-ise-converter.jpg"></a><br>To load an XML color theme, head back over to the PowerShell ISE <strong>Theme Manager</strong> from my earlier example and choose to import a theme file. <br>Oddly enough, there\'s no simple "import my theme" cmdlet. <br>You can set the colors once per workstation, bake in the specific color options in your profile, or use someone\'s <a href="https://lifeinpowershell.blogspot.com/2014/03/introducing-new-ise-color-theme-cmdlets.html">third party scripts</a>. <br>I don\'t mind doing it manually, or perhaps a reader will show me a better way. <br>üôÇ<br><h3>Presenting Code</h3><br>If you\'re going to present code on a projector screen, I\'d go back to a light background with dark text. <br>Because most projector screens are a white screen, it\'s not possible to make the background color truly dark &#8211; the projector simply projects "nothing" for black and you end up getting a funky washed out look.<br><h3>Build a User Profile</h3><br>A profile is a script that is called when PowerShell or PowerShell ISE opens. <br>Profile information can live in two locations:<br><br>Current User: %USERPROFILE%\Documents\WindowsPowerShell\<br>All Users: %WINDIR%\System32\WindowsPowerShell\v1.0\<br><br>Additionally, there are three types of profile files:<br><br>ISE and Console: profile.ps1<br>ISE only: Microsoft.PowerShellISE_profile.ps1<br>Console only: Microsoft.PowerShell_profile.ps1<br><br>Seems a tad overkill. <br>I personally select the current user path and drop in a profile.ps1, then just check for the $psISE variable to determine if the host is running the ISE. <br>Here\'s the path where it sits:<br><br>C:\Users\Chris.GLACIER\Documents\WindowsPowerShell\profile.ps1<br><br>My profile file is short and sweet, including a fun little message to myself for when I launch the ISE:<br><br>Set-ExecutionPolicy Bypass<br>Set-Location C:\Dropbox\Code<br>if ($psISE)<br>{<br>Start-Steroids<br>Clear-Host<br>Write-Host \'BEAST MODE (‚ïØ¬∞‚ñ°¬∞)‚ïØÔ∏µ ‚îª‚îÅ‚îª\'<br>}<br><br>This is a very simple profile. <br>Here\'s what it does:<br><br>Make sure the execution policy is effectively disabled (requires <em>Running as Administrator</em>)<br>Set the console location to my Dropbox\Code folder, because that\'s where I work on PowerShell code in most cases.<br>Test to see if the $psISE variable exists, meaning that I\'m launching the ISE. <br>If it does, I start ISESteroids and pump myself up with a little table throwing action.<br>If I\'m in the console, the logic test fails and nothing else happens.<br><br>Here\'s what a fresh ISE session looks like when loaded up:<br><img src="https://i1.wp.com/wahlnetwork.com/wp-content/uploads/2015/08/launch-ise.jpg"><br>The PowerShell console is simpler.<br><img src="https://i0.wp.com/wahlnetwork.com/wp-content/uploads/2015/08/launch-console.jpg"><br><h3>Run as Administrator</h3><br>I run both the ISE and Console as Administrator by changing the shortcut. <br>This avoids issues with the execution policy and gives me unfettered authority over the scripting editor. <br>Nothing more annoying than running into errors due to permissions on my own computer. <br>üôÇ<br>To do so, find the shortcut for PowerShell or PowerShell ISE, open the <strong>Properties</strong> &gt; <strong>Shortcut</strong> &gt; <strong>Advanced</strong> &gt; and check the <strong>Run as administrator</strong> box.<br><img src="https://i1.wp.com/wahlnetwork.com/wp-content/uploads/2015/08/run-as-admin-ise.jpg"><br><h3>Thoughts</h3><br>At this point I have what I consider to be a usable copy of PowerShell ISE at my disposal. <br>While it may look like a lot has happened, it isn\'t that much and only happens on a new system. <br>I have a master copy of the profile, colors, and portable modules that I clone to my workstations via Dropbox. <br>I\'m also a huge fan of <a href="http://www.powertheshell.com/isesteroids/">ISESteroids</a>, which I plan to go over in greater depth in the future.<br>',
]
var topicpointer = ImgList.length, timer = 15000
function shuffle(array) {
 var i = ImgList.length, j = 0, temp;
 while (i--) { j = Math.floor(Math.random() * (i+1))
  temp = ImgList[i];  ImgList[i] = ImgList[j];  ImgList[j] = temp;
 } 
 return ImgList;
}
ImgList = shuffle(Array.from(Array(ImgList.length).keys()))
ImgList.forEach(makeTOC);
function changeImg() {
 if (topicpointer >= ImgList.length - 1) { topicpointer = 0;}
 else if (topicpointer < 0) { topicpointer = ImgList.length - 1;} 
 else { topicpointer = topicpointer + 1;}
 showImg()
}
function backward() { topicpointer = topicpointer - 2; changeImg();}
function foreward() { changeImg();}
function pause() { clearInterval(myVar);}
function continU() { myVar = setInterval(changeImg, timer); foreward()}
function showImg() { var thePointerImg = document.querySelector(".imagearea");
 thePointerImg.innerHTML = ImgList[topicpointer];
 console.log(thePointerImg.innerHTML); scroll(0,0);
}
function showMov() { var imgAdr = ImgList[topicpointer];
 var start = imgAdr.indexOf("=\"")+1;
 var end = imgAdr.indexOf('"></a>', start+1);
 var list = imgAdr.substring(start+1, end);
 console.log(list); window.open(list);
}
function randomFlip() { topicpointer = Math.floor(Math.random() * ImgList.length); changeImg();}
changeImg();
</script>
</body></html>
