<html>
<head>
<title>Connecting to MySQL with PHP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width"/>
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script type='text/javascript' src='../mainscript.js'></script>
<script>
$(document).ready(function(){
    $('h1, h2, h3, h4, h5, .goldword, strong,  div.title').click(function(){
    parent.history.back();
    return false;
    });
});
</script>
<style>
body{width:80%;margin-left: 10%; font-size:22px;}
strong, h1, h2 {color: gold;}
img {max-width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%; border-radius:3px;}
</style>
</head>
<body onkeypress="chkKey()">
<center><h3>Connecting to MySQL with PHP</h3>
<div id="toc"></div></center>
<br>
<br>
<br>
<pre>
<h1>PHP | MySQL ( Creating Database )</h1>
<strong>How to connect PHP with MySQL Database?</strong>
PHP 5 and later can work with a MySQL database using:
<li>MySQLi extension.</li>
<li>PDO (PHP Data Objects).</li>
<strong>Difference Between MySQLi and PDO</strong>
<li>PDO works on 12 different database systems, whereas MySQLi works only with MySQL databases.</li>
<li>Both PDO and MySQLi are object-oriented, but MySQLi also offers a procedural API.</li>
<li>If at some point of development phase, the user or the development team wants to change the database then it is easy to that in PDO than MySQLi as PDO supports 12 different database systems.He would have to only change the connection string and a few queries. 
With MySQLi,he will need to rewrite the entire code including the queries.</li>
</ul>
<strong>There are three ways of working with MySQl and PHP</strong>
<li>MySQLi (object-oriented)</li>
<li>MySQLi (procedural)</li>
<li>PDO</li>
<strong>Connecting to MySQL database using PHP</strong>
There are 3 ways in which we can connect to MySQl from PHP as listed above and described below:
<li>
<strong>Using MySQLi object-oriented procedure</strong>: We can use the MySQLi object-oriented procedure to establish a connection to MySQL database from a PHP script.
<strong>Syntax</strong>:
&lt;?php
$servername = &quot;localhost&quot;;
$username = &quot;username&quot;;
$password = &quot;password&quot;;
<strong>// Creating connection</strong>
$conn = new mysqli($servername, $username, $password);
<strong>// Checking connection</strong>
if ($conn-&gt;connect_error) {
    die("Connection failed: " . $conn-&gt;connect_error);
} 
echo "Connected successfully";
?&gt;
<strong>Output:</strong>
<img src="https://media.geeksforgeeks.org/wp-content/uploads/Screen-Shot-2017-11-20-at-2.23.19-PM.png" alt="" width="274" height="32" class="aligncenter size-full wp-image-264885" />
<strong>Explanation</strong>: We can create an instance of the <strong>mysqli</strong> class providing all the necessary details required to establish the connection such as host, username, password etc. 
If the instance is created successfully then the connection is successful otherwise there is some error in establishing connection.
</li>
<li>
<strong>Using MySQLi procedural procedure</strong> : There is also a procedural approach of MySQLi to establish a connection to MySQL database from a PHP script as described below.
<strong>Syntax:</strong>
&lt;?php
$servername = &quot;localhost&quot;;
$username = &quot;username&quot;;
$password = &quot;password&quot;;
<strong>// Creating connection</strong>
$conn = mysqli_connect($servername, $username, $password);
<strong>// Checking connection</strong>
if (!$conn) {
    die("Connection failed: " . 
mysqli_connect_error());
}
echo "Connected successfully";
?&gt;
<strong>Output:</strong>
<img src="https://media.geeksforgeeks.org/wp-content/uploads/Screen-Shot-2017-11-20-at-2.23.19-PM.png" alt="" width="274" height="32" class="aligncenter size-full wp-image-264885" />
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <!-- post_bottom_responsive -->
          <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-9465609616171866"
          data-ad-slot="8385097921"
          data-ad-format="auto"></ins>
          <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
          
            
<strong>Explanation</strong>: In MySQLi procedural approach instead of creating an instance we can use the mysqli_connect() function available in PHP to establish a connection. 
This function takes the information as arguments such as host, username , password , database name etc. 
This function returns MySQL link identifier on successful connecction or FALSE when failed to establish a connection.
</li>
<li><strong class="redbut white">Using PDO procedure</strong>: PDO stands for PHP Data Objects. 
That is, in this method we connect to the database using data objects in PHP as described below:
<strong>Syntax:</strong>
<span class="pink">&lt;?php
$servername = &quot;localhost&quot;;
$username = &quot;username&quot;;
$password = &quot;password&quot;;
try {
    $conn = new PDO(&quot;mysql:host=$servername;dbname=myDB&quot;, $username, $password);
    <strong>// setting the PDO error mode to exception</strong>
    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    echo "Connected successfully"; 
    }
catch(PDOException $e)
    {
    echo "Connection failed: " . $e-&gt;getMessage();
    }
?&gt;</span>
<strong>Output:</strong>
<img src="https://media.geeksforgeeks.org/wp-content/uploads/Screen-Shot-2017-11-20-at-2.23.19-PM.png" alt="" width="274" height="32" class="aligncenter size-full wp-image-264885" />
<strong>Explanation:</strong>The exception class in PDO is used to handle any problems that may occur in our database queries. 
If an exception is thrown within the try{ } block, the script stops executing and flows directly to the first catch(){ } block.
</li>
<strong>Closing A Connection</strong>
When we establish a connection to MySQL database from a PHP script , we should also disconnect or close the connection when our work is finished. 
Here we have described the syntax of closing the connection to a MySQL database in all 3 methods described above. 
We have assumed that the reference to the connection is stored in $conn variable.
<li><strong>Using MySQLi object oriented procedure</strong>
<strong>Syntax</strong>
$conn-&gt;close();
</li>
<li><strong>Using MySQLi procedural procedure</strong>
<strong>Syntax</strong>
mysqli_close($conn);
</li>
<li><strong>Using PDO procedure</strong>
<strong>Syntax</strong>
$conn = null;
</li>
The basic steps to create MySQL database using PHP are:
<li>Establish a connection to MySQL server from your PHP script as described in <a href="https://www.geeksforgeeks.org/php-mysql-database-introduction/">this</a> article.</li>
<li>If the connection is successful, write a SQL query to create a database and store it in a string variable.</li>
<li>Execute the query.</li>
We have already learnt about establish a connection and creating variables in PHP. 
We can execute the query from our PHP script in 3 different ways as described below:
<ol>
<li><strong>Using MySQLi Object-oriented procedure</strong>: If the MySQL connection is established using Object-oriented procedure then we can use the query() function of mysqli class to execute our query as described in the below syntax.
<strong>Syntax</strong>:
&lt;?php
$servername = &quot;localhost&quot;;
$username = &quot;username&quot;;
$password = &quot;password&quot;;
<strong>// Creating a connection</strong>
$conn = new mysqli($servername, $username, $password);
// Check connection
if ($conn-&gt;connect_error) {
    die("Connection failed: " . $conn-&gt;connect_error);
} 
<strong>// Creating a database named newDB</strong>
$sql = "CREATE DATABASE newDB";
if ($conn-&gt;query($sql) === TRUE) {
    echo "Database created successfully with the name newDB";
} else {
    echo "Error creating database: " . $conn-&gt;error;
}
// closing connection
$conn-&gt;close();
?&gt;

<strong>Note:</strong>Specify the three arguments servername, username and password to the mysqli object whenever creating a database.
<strong>Output</strong>:
<img src="https://media.geeksforgeeks.org/wp-content/uploads/Screen-Shot-2017-11-20-at-2.47.55-PM.png" alt="" width="365" height="51" class="size-full wp-image-264894" />
</li>
<li><strong>Using MySQLi Procedural procedure</strong>:  If the MySQL connection is established using procedural procedure then we can use the mysqli_query() function of PHP to execute our query as described in the below syntax.
<strong>Syntax</strong>:
&lt;?php
$servername = &quot;localhost&quot;;
$username = &quot;username&quot;;
$password = &quot;password&quot;;
<strong>// Creating connection</strong>
$conn = mysqli_connect($servername, $username, $password);
<strong>// Checking connection</strong>
if (!$conn) {
    die("Connection failed: " . 
mysqli_connect_error());
}
<strong>// Creating a database named newDB</strong>
$sql = "CREATE DATABASE newDB";
if (mysqli_query($conn, $sql)) {
    echo "Database created successfully with the name newDB";
} else {
    echo "Error creating database: " . 
mysqli_error($conn);
}
// closing connection
mysqli_close($conn);
?&gt;

<strong>Output</strong>:
<img src="https://media.geeksforgeeks.org/wp-content/uploads/Screen-Shot-2017-11-20-at-2.47.55-PM.png" alt="" width="365" height="51" class="size-full wp-image-264894" />
</li>
<li><strong>Using PDO procedure</strong>:  If the MySQL connection is established using PDO procedure then we can execute our query as described in the below syntax.
<strong>Syntax</strong>:
&lt;?php
$servername = &quot;localhost&quot;;
$username = &quot;username&quot;;
$password = &quot;password&quot;;
try {
    $conn = new PDO(&quot;mysql:host=$servername;dbname=newDB&quot;, $username, $password);
    <strong>// setting the PDO error mode to exception</strong>
    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $sql = "CREATE DATABASE newDB";
    <strong>// using exec() because no results are returned</strong>
    $conn-&gt;exec($sql);
    echo "Database created successfully with the name newDB";
    }
catch(PDOException $e)
    {
    echo $sql . "&lt;br>" . $e-&gt;getMessage();
    }
$conn = null;
?&gt;

<strong>Note:</strong>The exception class in PDO is used to handle any problems that may occur in our database queries. 
If an exception is thrown within the try{ } block, the script stops executing and flows directly to the first catch(){ } block.
<strong>Output</strong>:
<img src="https://media.geeksforgeeks.org/wp-content/uploads/Screen-Shot-2017-11-20-at-2.47.55-PM.png" alt="" width="365" height="51" class="size-full wp-image-264894" />
<h1></h1>
<h1>Connecting to MySQL with PHP</h1>
https://www.taniarascia.com/create-a-simple-database-app-connecting-to-mysql-with-php/
CRUD application, which stands for <strong>C</strong>reate, <strong>R</strong>ead, <strong>U</strong>pdate, <strong>D</strong>elete.
A quick example of a CRUD application would be a database of employees for a company. 
From the control panel, an admin would be about to add a new employee (<code>create</code>), view a list of employees (<code>read</code>), change an employee's salary (<code>update</code>) or remove a fired employee from the system (<code>delete</code>). 
<h3>Goals</h3>
Connect to a MySQL database with PHP using the <a href="http://php.net/manual/en/book.pdo.php">PDO (PHP Data Objects)</a> method.
Create an installer script that creates a new database and a new table with structure.
Add entries to a database using an HTML form and <a href="http://php.net/manual/en/mysqli.quickstart.prepared-statements.php">prepared statements</a>.
Filter database entries and print them to the HTML document in a table.
All the code throughout this article can be found on GitHub.
<a href="https://github.com/taniarascia/pdo/tree/feba19a43e63c617c95a1f6e68825f6e3086336c">View on GitHub</a>
<a href="https://www.taniarascia.com/create-a-simple-crud-database-app-php-update-delete/">Part 2: Update and Delete</a>
<h2>Step 1: Building the front end</h2>
We don't have a database set up or anything, but we're just going to set up the HTML front end in order to be prepared to start interacting with that data.
<h3>Index page and template partials</h3>
Our main/home page will be located at <strong>index.php</strong>, so create that file in your <strong>public/</strong> directory.
public/index.php
<code>&lt;!DOCTYPE html>
&lt;html lang="en">
  &lt;head>
    &lt;meta charset="utf-8" />
    &lt;meta http-equiv="x-ua-compatible" content="ie=edge" />
    &lt;meta name="viewport" content="width=device-width, initial-scale=1" />
    &lt;title>Simple Database App&lt;/title>
    &lt;link rel="stylesheet" href="css/style.css" />
  &lt;/head>
  &lt;body>
    &lt;h1>Simple Database App&lt;/h1>
    &lt;ul>
      &lt;li>
        &lt;a href="create.php">&lt;strong>Create&lt;/strong>&lt;/a> - add a user
      &lt;/li>
      &lt;li>
        &lt;a href="read.php">&lt;strong>Read&lt;/strong>&lt;/a> - find a user
      &lt;/li>
    &lt;/ul>
  &lt;/body>
&lt;/html></code>
Right now, all we have is a basic HTML skeleton that will link to our <strong>create</strong> and <strong>read</strong> pages. 
Here's what it looks like:
<img src="https://www.taniarascia.com/static/68483eeb77aaa43304e2dabe91d3a88c/4d3f1/Screen-Shot-2017-05-14-at-1.29.55-PM.png">
Create a <strong>templates/</strong> directory in public, and make a <strong>header.php</strong> and <strong>footer.php</strong>. 
You'll take everything from the <code>&lt;h1&gt;</code> tag and up and put it in the header.
public/templates/header.php
<code>&lt;!DOCTYPE html>
&lt;html lang="en">
  &lt;head>
    &lt;meta charset="utf-8" />
    &lt;meta http-equiv="x-ua-compatible" content="ie=edge" />
    &lt;meta name="viewport" content="width=device-width, initial-scale=1" />
    &lt;title>Simple Database App&lt;/title>
    &lt;link rel="stylesheet" href="css/style.css" />
  &lt;/head>
  &lt;body>
    &lt;h1>Simple Database App&lt;/h1>
  &lt;/body>
&lt;/html></code>
And here's the footer.
public/templates/footer.php
<code>&lt;/body>
&lt;/html></code>
All that remains in <strong>index.php</strong> at this point are the links to our two other pages.
public/index.php
<code>&lt;ul>
  &lt;li>
    &lt;a href="create.php">&lt;strong>Create&lt;/strong>&lt;/a> - add a user
  &lt;/li>
  &lt;li>
    &lt;a href="read.php">&lt;strong>Read&lt;/strong>&lt;/a> - find a user
  &lt;/li>
&lt;/ul></code>
We want to include the header and footer code in all our front end pages, so we'll be using a <a href="http://php.net/manual/en/function.include.php">PHP include function</a> to pull that code in.
public/index.php
<code>&lt;?php include "templates/header.php"; ?>
&lt;ul>
  &lt;li>
    &lt;a href="create.php">&lt;strong>Create&lt;/strong>&lt;/a> - add a user
  &lt;/li>
  &lt;li>
    &lt;a href="read.php">&lt;strong>Read&lt;/strong>&lt;/a> - find a user
  &lt;/li>
&lt;/ul>
&lt;?php include "templates/footer.php"; ?></code>
Now the front end of our index file looks the same as before, but we have the reusable layout code that we can use in our other pages.
<h3>Add a new user page</h3>
Now we're going to make a file called <strong>create.php</strong> back in our <strong>public/</strong> directory. 
This will be the page we use to add a new user to the database. 
We'll start the file with our header and footer loaded in.
public/create.php
<code>&lt;?php include "templates/header.php"; ?>
    &lt;?php include "templates/footer.php"; ?></code>
I'm going to create a simple form here that gathers the first name, last name, email address, age, and location of a new user.
public/create.php
<code>&lt;?php include "templates/header.php"; ?>
&lt;h2>Add a user&lt;/h2>
    &lt;form method="post">
    	&lt;label for="firstname">First Name&lt;/label>
    	&lt;input type="text" name="firstname" id="firstname">
    	&lt;label for="lastname">Last Name&lt;/label>
    	&lt;input type="text" name="lastname" id="lastname">
    	&lt;label for="email">Email Address&lt;/label>
    	&lt;input type="text" name="email" id="email">
    	&lt;label for="age">Age&lt;/label>
    	&lt;input type="text" name="age" id="age">
    	&lt;label for="location">Location&lt;/label>
    	&lt;input type="text" name="location" id="location">
    	&lt;input type="submit" name="submit" value="Submit">
    &lt;/form>
    &lt;a href="index.php">Back to home&lt;/a>
    &lt;?php include "templates/footer.php"; ?></code>
create a <strong>css/</strong> folder and make <strong>style.css</strong>. 
CSS and style is not a focus of this article, but I'm going to add a line of CSS code to make the forms easier to read.
public/css/style.css
<code class="language-css">label {
  display: block;
  margin: 5px 0;
}</code>
<img src="https://www.taniarascia.com/static/0f3d3b2806a3529fe3ecc5660c2b265a/4d3f1/Screen-Shot-2017-05-14-at-2.06.34-PM.png">
We have not specified a form action, so pressing the <code>submit</code> button will perform the action on the same page. 
Since we haven't written any PHP code to process the form yet, it won't do anything.
<h3>Query users page</h3>
Finally, we're going to create our <strong>read.php</strong> file, which will query the list of users by a parameter (in this case, location) and print out the results.
Again, we'll start with the header and footer code.
public/read.php
<code>&lt;?php include "templates/header.php"; ?>
    &lt;?php include "templates/footer.php"; ?></code>
Then we'll add a small form for searching for users by location.
public/read.php
<code>&lt;?php include "templates/header.php"; ?>
    &lt;h2>Find user based on location&lt;/h2>
    &lt;form method="post">
    	&lt;label for="location">Location&lt;/label>
    	&lt;input type="text" id="location" name="location">
    	&lt;input type="submit" name="submit" value="View Results">
    &lt;/form>
    &lt;a href="index.php">Back to home&lt;/a>
    &lt;?php include "templates/footer.php"; ?></code>
<img src="https://www.taniarascia.com/static/dba8eb7def7e9a61f83f61e40de64563/4d3f1/Screen-Shot-2017-05-14-at-2.13.47-PM.png">
Now you have all the front end code set up and we can start. 
Here's everything you should have so far.
<code>public/
|-- css/
|   |-- style.css
|-- templates/
|   |-- header.php
|   |-- footer.php
|-- index.php
|-- create.php
|-- read.php</code>
<h2>Step 2: Initializing the database</h2>
Now that we have a front end, we're going to create the database. 
We could do this through the GUI of SequelPro or whatever database manager we're using, but I want to show you how to do it with actual SQL statements and PHP in an installer script.
<blockquote>
SQL (Structured Query Language) is a language used to communicate with a database.
</blockquote>
First, let's get into the database. 
Here's the login page for the front end of our database.
<img src="https://www.taniarascia.com/static/6500435f8cf515d2160f8886809b4b49/4d3f1/Screen-Shot-2017-05-14-at-2.26.30-PM.png">
Your host will be <code>localhost</code> or <code>127.0.0.1</code>, which translate to the same thing for our purposes. 
Username and password will both be <code>root</code>. 
Entering that information in, you should be able to enter localhost.
<img src="https://www.taniarascia.com/static/8c9c6ade91c2f81a9fb8a0eeb90c64f9/4d3f1/Screen-Shot-2017-05-14-at-2.31.30-PM.png">
Create a directory called <strong>data/</strong> and create a file called <strong>init.sql</strong>. 
This will be our database initializing code.
data/init.sql
<code>CREATE DATABASE test;
  use test;
  CREATE TABLE users (
    id INT(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    firstname VARCHAR(30) NOT NULL,
    lastname VARCHAR(30) NOT NULL,
    email VARCHAR(50) NOT NULL,
    age INT(3),
    location VARCHAR(50),
    date TIMESTAMP
  );</code>
SQL is a relatively straightforward code, so even if you've never seen it before, it should be easy to understand. 
Here's what the above means in plain English:
We're going to create a database called <code>test</code>. 
Then we're going to make sure we're using <code>test</code> for the rest of our code. 
In the <code>test</code> database, we'll create a table called <code>users</code> with 7 fields inside - <strong>id</strong>, <strong>firstname</strong>, <strong>lastname</strong>, <strong>email</strong>, <strong>age</strong>, <strong>location</strong>, and <strong>date</strong>. 
Next to each field is more information, options, and settings for each.
<code>INT()</code> - this is an <strong>Integer</strong>. 
We specified <code>INT(11)</code>, which means up to 11 characters
<code>AUTO_INCREMENT</code> - this is a number that will automatically increase with each entry.
<code>VARCHAR()</code> - meaning <strong>Variable Character</strong>, this is a string that can contain letters and numbers. 
The number inside is the max amount of characters allowed.
<code>TIMESTAMP</code> - this will add the current time in <code>YYYY-MM-DD HH:MI:SS</code> format by default.
<h3>Testing the SQL query</h3>
If you really want to see what this code will do before we create the installer, you can paste it into the <strong>Query</strong> section of your database program and <strong>Run Selection</strong>.
<img src="https://www.taniarascia.com/static/6369482bd0f62483c7b5f4686843fa2d/4d3f1/Screen-Shot-2017-05-14-at-2.46.52-PM.png">
If you did that, you'll see I now have a <code>test</code> database, a <code>users</code> table, and all the database structure.
<img src="https://www.taniarascia.com/static/0134c3bf43b754059fd358a0499b0062/4d3f1/Screen-Shot-2017-05-14-at-2.49.31-PM.png">
So we know our SQL works properly and has no errors. 
If you did that, delete the database because we're going to start over and do it through the script.
<h3>Using PDO to connect to a database</h3>
We're going to use <a href="http://php.net/manual/en/book.pdo.php">PDO (PHP Data Objects)</a> to connect to the database. 
The other major option is <a href="http://php.net/manual/en/book.mysqli.php">MySQLi</a>. 
The critical difference between the two is that you can use PDO to connect to any number of databases, and <code>mysqli</code> code will only work with MySQL. 
Although we're using a MySQL database, PDO is more extendable in the future, and generally the preferred choice for new projects. 
So let's create that connection.
Create a file called <strong>install.php</strong> in the root of your directory.
We'll create a new <code>PDO()</code> object and place it into a variable named <code>$connection</code>.
install.php
<code>$connection = new PDO();</code>
The PDO object will ask for four parameters:
<a href="http://php.net/manual/en/ref.pdo-mysql.connection.php">DSN (data source name)</a>, which includes type of database, host name, database name (optional)
Username to connect to host
Password to connect to host
Additional options
install.php
<code>$connection = new PDO(data source name, username, password, options);</code>
Here's how that ends up looking after we fill in all the parameters.
install.php
<code>new PDO("mysql:host=localhost", "root", "root",
  array(
      PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION
  );
);</code>
Now we're going to organize it a bit more by putting all our database information into variables.
install.php
<code>$connection = new PDO("mysql:host=$host", $username, $password, $options);</code>
We'll create a <strong>config.php</strong> file that contains all the variables we can refer from.
config.php
<code>&lt;?php
/**
  * Configuration for database connection
  *
  */
$host       = "localhost";
$username   = "root";
$password   = "root";
$dbname     = "test"; // will use later
$dsn        = "mysql:host=$host;dbname=$dbname"; // will use later
$options    = array(
                PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION
              );</code>
Here's what we have in our installer so far. 
We're pulling in the database variables via <strong>config.php</strong> using <code>require</code>, which is similar to an <code>include</code>, except we're explicitly stating that the file is necessary for the script to run.
install.php
<code>require "config.php";
$connection = new PDO("mysql:host=$host", $username, $password, $options);</code>
Now it's time to put that SQL code we created earlier to use. 
We'll be placing the contents of the <strong>data/init.sql</strong> file into a variable using the <code>file_get_contents()</code> function, and executing it with the <code>exec()</code> function.
<code>$sql = file_get_contents("data/init.sql");
$connection->exec($sql);</code>
At this point, we're going to want to use <a href="http://php.net/manual/en/language.exceptions.php">Exceptions</a> to attempt to run the script and catch errors. 
We'll do this by putting all our code in a <code>try/catch</code> block, which looks like this:
<code>try {
// code to execute
} catch() {
// exception
}</code>
Let's put our database code in the <code>try</code> block, and show our <code>PDOException</code> error message if something goes wrong trying to set up the database. 
Here's the final code for the installer.
install.php
<code>&lt;?php
/**
  * Open a connection via PDO to create a
  * new database and table with structure.
  *
  */
require "config.php";
try {
  $connection = new PDO("mysql:host=$host", $username, $password, $options);
  $sql = file_get_contents("data/init.sql");
  $connection->exec($sql);
  echo "Database and table users created successfully.";
} catch(PDOException $error) {
  echo $sql . "&lt;br>" . $error->getMessage();
}</code>
To run the install, just navigate to your <strong>install.php</strong> file on the front end.
<img src="https://www.taniarascia.com/static/0e2303f1d3097bb1d059c46ffba34584/4d3f1/Screen-Shot-2017-05-15-at-7.35.49-PM.png">
If you didn't delete your database from our test before, you might get this error, in which case you'll need to delete the database for the installer to run.
<img src="https://www.taniarascia.com/static/31afa564b9062c54f2b0f3687340f2d9/4d3f1/Screen-Shot-2017-05-15-at-7.37.43-PM.png">
Congratulations, you just made an installer script to set up a new database and table with structure!
<h2>Step 3: Adding a new user</h2>
Now, we're finally going to write some code to make those forms do something.
In PHP, when you submit a form, all the inputs are placed into a <code>$_POST</code> array. 
So my <code>&lt;input type=&quot;text&quot; name=&quot;firstname&quot;&gt;</code> will translate to <code>$_POST[&#39;firstname&#39;]</code> for us to work with.
We're going to go back to the <code>public/create.php</code> file. 
Right now, it's just a form with a header and footer being pulled in. 
The new code we write will be added to the top of the file.
First, we're going to tell this code only to run if the form has been submitted.
<code>if (isset($_POST['submit'])) {}</code>
Just like with the installer, we're going to <code>require</code> our configuration file, and use a <code>try/catch</code> Exception to connect to the database.
If you'll notice, in the <strong>install.php</strong> script I was only connecting to <code>mysql:host=$host</code> in the first parameter (DSN). 
I didn't specify a database name, because we were creating the database in the file. 
Now that the database (named <code>test</code>) is created, I'm adding that to the first parameter. 
<code>$dsn</code> is set to <code>mysql:host=$host;dbname=$dbname</code>.
<code>if (isset($_POST['submit'])) {
  require "../config.php";
  try {
    $connection = new PDO($dsn, $username, $password, $options);
    // insert new user code will go here
  } catch(PDOException $error) {
    echo $sql . "&lt;br>" . $error->getMessage();
  }
}</code>
Let's create an array with all our submitted form values.
<code>$new_user = array(
  "firstname" => $_POST['firstname'],
  "lastname"  => $_POST['lastname'],
  "email"     => $_POST['email'],
  "age"       => $_POST['age'],
  "location"  => $_POST['location']
);</code>
<blockquote>
We can use regular <code>$_POST</code> variables without further sanitization here because we're submitting to the database with <a href="http://php.net/manual/en/mysqli.quickstart.prepared-statements.php">prepared statements</a>.
</blockquote>
Now, the SQL code we're going to want to execute will look like this: <code>INSERT INTO tablename (n) values (:n)</code>. 
In our specific case, it will be the below code.
<code>INSERT INTO users (firstname, lastname, email, age, location) values (:firstname, :lastname, :email, :age, :location)</code>
We could write out that code by hand and add each value every time we add one, but then we're updating things in three places and it becomes a pain. 
I learned a handy snippet of code from <a href="https://github.com/JeffreyWay">JeffreyWay</a> of <a href="https://laracasts.com/">Laracasts</a> to simplify that process.
We're going to use <code>sprintf</code>, which allows us to do the following: <code>INSERT INTO x (y) values (:z)</code>.
<code>$sql = sprintf(
    "INSERT INTO %s (%s) values (%s)",
    "users",
    implode(", ", array_keys($new_user)),
    ":" . implode(", :", array_keys($new_user))
);</code>
That code will print out the exact same thing, without having to write it multiple times. 
Now we'll just prepare and execute the code.
<code>$statement = $connection->prepare($sql);
$statement->execute($new_user);</code>
Here is the full code inside our <code>try</code> block.
<code>$connection = new PDO($dsn, $username, $password, $options);
$new_user = array(
  "firstname" => $_POST['firstname'],
  "lastname"  => $_POST['lastname'],
  "email"     => $_POST['email'],
  "age"       => $_POST['age'],
  "location"  => $_POST['location']
);
$sql = sprintf(
    "INSERT INTO %s (%s) values (%s)",
    "users",
    implode(", ", array_keys($new_user)),
    ":" . implode(", :", array_keys($new_user))
);
$statement = $connection->prepare($sql);
$statement->execute($new_user);</code>
Now the form is all ready to send. 
I'm going to fill out my information and submit it.
<img src="https://www.taniarascia.com/static/7862404fda8d9308a664d73c53ff671e/4d3f1/Screen-Shot-2017-05-15-at-9.28.57-PM.png">
Going into my MySQL, if all went well, I can now view my entry in the database!
<img src="https://www.taniarascia.com/static/c59c3fa35cf5250d7d7f6c14329460c6/4d3f1/Screen-Shot-2017-05-15-at-9.30.14-PM.png">
Excellent! There's just one more thing I want to do. 
Right now, after submitting the form, there's nothing letting me know that the user was submitted successfully.
<h3>Escaping HTML</h3>
Since in this case we're going to print out a <code>$_POST</code> variable to the HTML, we need to properly <a href="http://php.net/manual/en/function.htmlspecialchars.php">convert the HTML characters</a>, which will aid in preventing XSS attacks.
Let's create a new file called <strong>common.php</strong> in the root of your project. 
Inspiration for this function and filename came from <a href="https://ilovephp.jondh.me.uk/en/tutorial/make-your-own-blog">Jon's PHP blog tutorial</a>. 
This is a file that can be used to store functions for later use. 
I'm only going to use it for one function today - an HTML escaping function.
common.php
<code>&lt;?php
/**
  * Escapes HTML for output
  *
  */
function escape($html) {
  return htmlspecialchars($html, ENT_QUOTES | ENT_SUBSTITUTE, "UTF-8");
}</code>
With this function, we can wrap any variable in the <code>escape()</code> function, and the HTML entities will be protected.
Back in <strong>public/create.php</strong>, add a <code>require &quot;common.php&quot;;</code>. 
Now I'm just going to add this <code>if</code> statement below my header and above the "Add a user" title. 
It will check to see if a <code>$_POST</code> was submitted, and if a <code>$statement</code> was successful. 
If so, it will print a success message that includes the first name of the successfully added user.
<code>&lt;?php if (isset($_POST['submit']) &amp;&amp; $statement) { ?>
  &lt;?php echo escape($_POST['firstname']); ?> successfully added.
&lt;?php } ?></code>
<img src="https://www.taniarascia.com/static/7c6e83de0dc28b23a2b03f4c88ce743a/4d3f1/Screen-Shot-2017-05-15-at-9.49.39-PM.png">
And that's everything! Here's the final code to add a new user.
public/create.php
<code>&lt;?php
/**
  * Use an HTML form to create a new entry in the
  * users table.
  *
  */
if (isset($_POST['submit'])) {
  require "../config.php";
  require "../common.php";
  try {
    $connection = new PDO($dsn, $username, $password, $options);
    $new_user = array(
      "firstname" => $_POST['firstname'],
      "lastname"  => $_POST['lastname'],
      "email"     => $_POST['email'],
      "age"       => $_POST['age'],
      "location"  => $_POST['location']
    );
    $sql = sprintf(
"INSERT INTO %s (%s) values (%s)",
"users",
implode(", ", array_keys($new_user)),
":" . implode(", :", array_keys($new_user))
    );
    $statement = $connection->prepare($sql);
    $statement->execute($new_user);
  } catch(PDOException $error) {
    echo $sql . "&lt;br>" . $error->getMessage();
  }
}
?>
&lt;?php require "templates/header.php"; ?>
&lt;?php if (isset($_POST['submit']) &amp;&amp; $statement) { ?>
  > &lt;?php echo $_POST['firstname']; ?> successfully added.
&lt;?php } ?>
&lt;h2>Add a user&lt;/h2>
&lt;form method="post">
  &lt;label for="firstname">First Name&lt;/label>
  &lt;input type="text" name="firstname" id="firstname">
  &lt;label for="lastname">Last Name&lt;/label>
  &lt;input type="text" name="lastname" id="lastname">
  &lt;label for="email">Email Address&lt;/label>
  &lt;input type="text" name="email" id="email">
  &lt;label for="age">Age&lt;/label>
  &lt;input type="text" name="age" id="age">
  &lt;label for="location">Location&lt;/label>
  &lt;input type="text" name="location" id="location">
  &lt;input type="submit" name="submit" value="Submit">
&lt;/form>
&lt;a href="index.php">Back to home&lt;/a>
&lt;?php require "templates/footer.php"; ?></code>
<h2>Step 4: Viewing and filtering users</h2>
Here's the last step - the "read" of our CRUD app. 
We already created the front end in <strong>public/read.php</strong>.
Really quickly, let's add a small amount of CSS to our <strong>public/css/style.css</strong> file to make the tables legible once we create them.
public/css/style.css
<code class="language-css">table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 5px;
  border-bottom: 1px solid #aaa;
}</code>
Now we're going to use the same <code>require</code>s from our new user page, as well as the <code>try/catch</code> block for connecting to the database.
public/read.php
<code>if (isset($_POST['submit'])) {
  try {
    require "../config.php";
    require "../common.php";
    $connection = new PDO($dsn, $username, $password, $options);
        // fetch data code will go here
  } catch(PDOException $error) {
    echo $sql . "&lt;br>" . $error->getMessage();
  }
}
?></code>
Now we'll write a <code>SELECT</code> SQL query. 
We're going to select all (<code>*</code>) from the users table, and filter by location.
<code>$sql = "SELECT *
  FROM users
  WHERE location = :location";</code>
Then we'll put our <code>$_POST</code> into a varable.
<code>$location = $_POST['location'];</code>
Prepare, bind, and execute the statement.
<code>$statement = $connection->prepare($sql);
$statement->bindParam(':location', $location, PDO::PARAM_STR);
$statement->execute();</code>
Finally, we'll fetch the result.
<code>$result = $statement->fetchAll();</code>
Here's the full <code>try</code> connection code.
<code>$connection = new PDO($dsn, $username, $password, $options);
$sql = "SELECT *
FROM users
WHERE location = :location";
$location = $_POST['location'];
$statement = $connection->prepare($sql);
$statement->bindParam(':location', $location, PDO::PARAM_STR);
$statement->execute();
$result = $statement->fetchAll();</code>
Great, now we have the whole process to retrieve the filtered data. 
All that's left is to print out the result.
Outside of the <code>try/catch</code> connection block and below the header, I'm going to insert the code for the table.
We'll check - if this is a POST request, and if the result of our query has more than 0 rows, open the table, loop through all the results, and close the table. 
If there are no results, display a message.
<code>if (isset($_POST['submit'])) {
    	if ($result &amp;&amp; $statement->rowCount() > 0) {
    		// open table
    		foreach ($result as $row) {
    			// table contents
    		}
    		// close table
    	} else 	{
    		// no results
    	}
    }</code>
Here is the final code.
public/read.php
<code>&lt;?php
/**
  * Function to query information based on
  * a parameter: in this case, location.
  *
  */
if (isset($_POST['submit'])) {
  try {
    require "../config.php";
    require "../common.php";
    $connection = new PDO($dsn, $username, $password, $options);
    $sql = "SELECT *
    FROM users
    WHERE location = :location";
    $location = $_POST['location'];
    $statement = $connection->prepare($sql);
    $statement->bindParam(':location', $location, PDO::PARAM_STR);
    $statement->execute();
    $result = $statement->fetchAll();
  } catch(PDOException $error) {
    echo $sql . "&lt;br>" . $error->getMessage();
  }
}
?>
&lt;?php require "templates/header.php"; ?>
&lt;?php
if (isset($_POST['submit'])) {
  if ($result &amp;&amp; $statement->rowCount() > 0) { ?>
    &lt;h2>Results&lt;/h2>
    &lt;table>
      &lt;thead>
&lt;tr>
  &lt;th>#&lt;/th>
  &lt;th>First Name&lt;/th>
  &lt;th>Last Name&lt;/th>
  &lt;th>Email Address&lt;/th>
  &lt;th>Age&lt;/th>
  &lt;th>Location&lt;/th>
  &lt;th>Date&lt;/th>
&lt;/tr>
      &lt;/thead>
      &lt;tbody>
  &lt;?php foreach ($result as $row) { ?>
      &lt;tr>
&lt;td>&lt;?php echo escape($row["id"]); ?>&lt;/td>
&lt;td>&lt;?php echo escape($row["firstname"]); ?>&lt;/td>
&lt;td>&lt;?php echo escape($row["lastname"]); ?>&lt;/td>
&lt;td>&lt;?php echo escape($row["email"]); ?>&lt;/td>
&lt;td>&lt;?php echo escape($row["age"]); ?>&lt;/td>
&lt;td>&lt;?php echo escape($row["location"]); ?>&lt;/td>
&lt;td>&lt;?php echo escape($row["date"]); ?> &lt;/td>
      &lt;/tr>
    &lt;?php } ?>
      &lt;/tbody>
  &lt;/table>
  &lt;?php } else { ?>
    > No results found for &lt;?php echo escape($_POST['location']); ?>.
  &lt;?php }
} ?>
&lt;h2>Find user based on location&lt;/h2>
&lt;form method="post">
  &lt;label for="location">Location&lt;/label>
  &lt;input type="text" id="location" name="location">
  &lt;input type="submit" name="submit" value="View Results">
&lt;/form>
&lt;a href="index.php">Back to home&lt;/a>
&lt;?php require "templates/footer.php"; ?></code>
After adding a few entries, I can play around with it. 
I input the city.
<img src="https://www.taniarascia.com/static/1e346e4a235dd43c5d4fce48415ceeb2/4d3f1/Screen-Shot-2017-05-15-at-10.42.42-PM.png">
And view the results.
<img src="https://www.taniarascia.com/static/4283ead60724e7e550e2813831a04120/4d3f1/Screen-Shot-2017-05-15-at-10.42.45-PM.png">
Congratulations, you now have the very beginnings of a simple PHP database app without frameworks.
<h2>Conclusion</h2>
Now that you've learned how to create and read entries, check out part two!
<a href="https://www.taniarascia.com/create-a-simple-crud-database-app-php-update-delete/">Onto Part 2: Update and Delete</a>
We went over a lot of valuable lessons in this tutorial, including but not limited to: connecting to a MySQL database with PDO, creating an installer script, inserting users into a database, selecting and printing out users from a database, and escaping printed HTML.
If this were a real world app, of course there would be more considerations to make. 
The backend would have to be password protected, which means you would make a login page and administrative users who are the only ones who have access to the app.
You would also add JavaScript validation to the front end of the site to ensure all required fields were being filled in, and using the correct type of characters for the input. 
(Although JavaScript validation is important, the most important part is that the back end that is receiving your data is protected).
Again, all the code from this article is available <a href="https://github.com/taniarascia/pdo/tree/feba19a43e63c617c95a1f6e68825f6e3086336c">on GitHub</a> if you got lost anywhere along the way. 
If you have suggestions on how to make the tutorial more clear or more secure, please don't hesitate to share! However, take into account this is meant to be a first look at the underlying code of database management, and not a full-fledged app.
<a href="https://github.com/taniarascia/pdo/tree/feba19a43e63c617c95a1f6e68825f6e3086336c">View on GitHub</a>
<h1>part two</h1>
We will learn how to modify existing entries (<code>update</code>) and permanently remove existing entires (<code>delete</code>).
If you haven't read part one but you're interested in learning how to manipulate data with PHP and MySQL, I highly recommend you check it out! Onto the tutorial.
<h3>Prerequisites</h3>
Everything you need to know to use and understand this tutorial is in <a href="/create-a-simple-database-app-connecting-to-mysql-with-php/">Create a Simple CRUD Database App: Connecting to MySQL with PHP (Part 1: Create, Read)</a>. 
To reiterate, you must have:
A basic knowledge of HTML
A basic knowledge of PHP syntax and code structure
A local PHP and MySQL environment (MAMP, XAMPP, Vagrant, or other)
A database management program (Sequel Pro for Mac, SQLYog for Windows)
<a href="https://github.com/taniarascia/pdo/tree/feba19a43e63c617c95a1f6e68825f6e3086336c">The codebase</a> of the PDO App we created. 
(This link leads to the last commit prior to this article being written)
<h3>Goals</h3>
Create a page that lists all users with an edit button next to their name
Dynamically create a unique page for editing any user's data
Create a page that list all users with a delete button next to their name
<h2>Step 1: Set up the environment</h2>
If you're following along directly from part one, you will have all the code you need to start ready and functioning. 
If you did the tutorial a while ago and need to get everything set up again, it's all available and up to date in this <a href="https://github.com/taniarascia/pdo">GitHub repository</a>. 
You can either download all the code as a zip and place it in your server root, or clone the repo if you know how to use Git.
Everything we will be editing is in the <strong>public/</strong> folder, as all our initial setup is out of the way. 
Go ahead and get everything set up and working from the place we left off, and then we can continue.
One note, I'll be using the URL <strong><a href="http://db.server">http:/db.dev</a></strong> URL I used the first time around, as <code>.dev</code> domains are no longer available locally in Chrome. 
Everything else will be the same.
<h2>Step 2: Create an editable list of all users</h2>
We left off in part one with <strong>create.php</strong> and <strong>read.php</strong>. 
Now we're going to create <strong>update.php</strong>.
In <strong>index.php</strong>, add a link to <strong>update.php</strong>.
public/index.php
<code>&lt;?php include "templates/header.php"; ?>
&lt;ul>
    &lt;li>&lt;a href="create.php">&lt;strong>Create&lt;/strong>&lt;/a> - add a user&lt;/li>
    &lt;li>&lt;a href="read.php">&lt;strong>Read&lt;/strong>&lt;/a> - find a user&lt;/li>
    &lt;li>&lt;a href="update.php">&lt;strong>Update&lt;/strong>&lt;/a> - edit a user&lt;/li>
&lt;/ul>
&lt;?php include "templates/footer.php"; ?></code>
<img src="https://www.taniarascia.com/static/c944e5297f41c284f1056fb2ff411bfa/4d3f1/Screen-Shot-2018-04-21-at-9.26.37-PM.png">
    
Now that the main view of our app links to the <strong>update.php</strong>, let's create the file.
The purpose of this file is to list <em>all</em> users in the database, and show an "Edit" link next to each user, which we'll be able to click on and edit each user individually. 
We will use most of the same code from <strong>read.php</strong>, except more simplified.
We will use a simple <code>SELECT</code> statement to get all users.
<code>$sql = "SELECT * FROM users";</code>
This is the simplest possible SQL command we can execute with PDO - simply select all users, prepare the statement, and store the result in <code>$result</code>.
<code>$sql = "SELECT * FROM users";
$statement = $connection->prepare($sql);
$statement->execute();
$result = $statement->fetchAll();</code>
Using that, we can built out our <code>try/catch</code> block at the top of <strong>update.php</strong>.
public/update.php
<code>&lt;?php
/**
  * List all users with a link to edit
  */
try {
  require "../config.php";
  require "../common.php";
  $connection = new PDO($dsn, $username, $password, $options);
  $sql = "SELECT * FROM users";
  $statement = $connection->prepare($sql);
  $statement->execute();
  $result = $statement->fetchAll();
} catch(PDOException $error) {
  echo $sql . 
"&lt;br>" . $error->getMessage();
}
?></code>
Right below this code, we'll print the HTML table with the data from our <code>SELECT</code> statement.
public/update.php
<code>&lt;?php require "templates/header.php"; ?>
&lt;h2>Update users&lt;/h2>
&lt;table>
  &lt;thead>
    &lt;tr>
      &lt;th>#&lt;/th>
      &lt;th>First Name&lt;/th>
      &lt;th>Last Name&lt;/th>
      &lt;th>Email Address&lt;/th>
      &lt;th>Age&lt;/th>
      &lt;th>Location&lt;/th>
      &lt;th>Date&lt;/th>
    &lt;/tr>
  &lt;/thead>
  &lt;tbody>
  &lt;?php foreach ($result as $row) : ?>
    &lt;tr>
      &lt;td>&lt;?php echo escape($row["id"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["firstname"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["lastname"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["email"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["age"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["location"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["date"]); ?> &lt;/td>
  &lt;/tr>
  &lt;?php endforeach; ?>
  &lt;/tbody>
&lt;/table>
&lt;a href="index.php">Back to home&lt;/a></code>
Before anything will show up here, we'll have to go back to <strong>create.php</strong> and add a few users, which I just did for this example.
Here is what we have now in <strong>update.php</strong>:
<img src="https://www.taniarascia.com/static/8150aa4aea404e907b667fe155845daa/4d3f1/Screen-Shot-2018-04-21-at-9.27.20-PM.png">
    
<h3>Using HTTP query strings</h3>
Up until now, this is all the same stuff we covered in <strong>read.php</strong>. 
The interesting part that we'll add now is how we'll get to a page where we can edit each individual user.
Below Date in the <code>thead</code>, let's add a <code>th</code> for Edit.
<div data-language="html"><code>&lt;th>Edit&lt;/th></code>
Now in the <code>tbody</code>, we'll add a link that corresponds to this header for each user. 
In just a moment, we'll create a new file called <strong>update-single.php</strong>, which will be an edit page for each user. 
But how will <strong>update-single.php</strong> know if we're editing Richard or Gilfoyle?
We're going to tell <strong>update-single.php</strong> via a parameter in the URL which user to edit. 
Since we know <code>id</code> of each user is unique, and we can't guarantee other data such as first name and age will be unique, we can safely use <code>id</code> to identify each user.
Let's create a link that goes to <strong>update-single.php</strong>, and tack a question mark after the file name, which begins an <a href="https://en.wikipedia.org/wiki/Query_string">HTTP query string</a>. 
After this question mark, we can insert as many key/value pairs as we want in the URL.
If we want to access Dinesh, the user with an <code>id</code> of <code>3</code>, our url will be <strong>update-single.php?id=3</strong>. 
We will get those values dynamically the same way we do to just print them out normally, except we'll embed it in the URL, like so.
<code>&lt;td>&lt;a href="update-single.php?id=&lt;?php echo escape($row["id"]); ?>">Edit&lt;/a>&lt;/td></code>
Here is the final code for <strong>update.php</strong>.
public/update.php
<code>&lt;?php
/**
  * List all users with a link to edit
  */
try {
  require "../config.php";
  require "../common.php";
  $connection = new PDO($dsn, $username, $password, $options);
  $sql = "SELECT * FROM users";
  $statement = $connection->prepare($sql);
  $statement->execute();
  $result = $statement->fetchAll();
} catch(PDOException $error) {
  echo $sql . 
"&lt;br>" . $error->getMessage();
}
?>
&lt;?php require "templates/header.php"; ?>
&lt;h2>Update users&lt;/h2>
&lt;table>
  &lt;thead>
    &lt;tr>
      &lt;th>#&lt;/th>
      &lt;th>First Name&lt;/th>
      &lt;th>Last Name&lt;/th>
      &lt;th>Email Address&lt;/th>
      &lt;th>Age&lt;/th>
      &lt;th>Location&lt;/th>
      &lt;th>Date&lt;/th>
      &lt;th>Edit&lt;/th>
    &lt;/tr>
  &lt;/thead>
    &lt;tbody>
    &lt;?php foreach ($result as $row) : ?>
      &lt;tr>
        &lt;td>&lt;?php echo escape($row["id"]); ?>&lt;/td>
        &lt;td>&lt;?php echo escape($row["firstname"]); ?>&lt;/td>
        &lt;td>&lt;?php echo escape($row["lastname"]); ?>&lt;/td>
        &lt;td>&lt;?php echo escape($row["email"]); ?>&lt;/td>
        &lt;td>&lt;?php echo escape($row["age"]); ?>&lt;/td>
        &lt;td>&lt;?php echo escape($row["location"]); ?>&lt;/td>
        &lt;td>&lt;?php echo escape($row["date"]); ?> &lt;/td>
        &lt;td>&lt;a href="update-single.php?id=&lt;?php echo escape($row["id"]); ?>">Edit&lt;/a>&lt;/td>
      &lt;/tr>
    &lt;?php endforeach; ?>
    &lt;/tbody>
&lt;/table>
&lt;a href="index.php">Back to home&lt;/a>
&lt;?php require "templates/footer.php"; ?></code>
<img src="https://www.taniarascia.com/static/ce454825848c10bf63944e7b6cf53499/4d3f1/Screen-Shot-2018-04-21-at-9.31.39-PM.png">
    
Now we have a list of all users with links to edit them. 
If you hover over each edit button, you'll see the <code>id</code> in the URL change to correspond to each user. 
However, the links don't go anywhere yet, so that's what we'll work on next.
<h2>Step 3: Modify an existing user</h2>
Editing an existing database entry is the trickiest of all four aspects of CRUD, and it's particularly difficult to find a modern, cohesive tutorial of any sort on how to do this with HTML and PHP, especially using the modern PDO method, so here we go!
First, we'll want to display the data we're going to edit, then we'll need to add functions to modify it.
In <strong>update.php</strong>, we created edit links that detect the <code>id</code> of the users and create a unique URL for each user. 
In <strong>update-single.php</strong>, we have to figure out which <code>id</code> is being loaded in, because <em>all</em> the edit pages will load and be routed through this single page.
Just as we've used the superglobal <code>$_POST</code> to detect what data has been posted through an HTML form, we'll use <code>$_GET</code> to retrieve information from the URL. 
It's important to note that sensitive data such as passwords should never be passed through the <code>$_GET</code> variable; however, for our simple purposes today, it will do just fine.
Let's create <strong>update-single.php</strong>, load in the required files, and make an <code>if/else</code> statement. 
We'll check if <code>id</code> is found in the URL, otherwise we'll just show a brief error message and close the script.
public/update-single.php
<code>&lt;?php
/**
  * Use an HTML form to edit an entry in the
  * users table.
  *
  */
require "../config.php";
require "../common.php";
if (isset($_GET['id'])) {
  echo $_GET['id']; // for testing purposes
} else {
    echo "Something went wrong!";
    exit;
}
?></code>
Now if I click on Dinesh...
<img src="https://www.taniarascia.com/static/15508af55eb701476599b0ff34250b9c/4d3f1/Screen-Shot-2018-04-22-at-9.38.49-PM.png">
    
The page will print out <code>3</code>, as seen in the URL. 
Great! Now that we know that's working, we can use it to pull the data specifically for user id <code>3</code>.
We're still working with <code>SELECT</code> statements here, so we're doing exactly what we did previously with the <code>location</code> variable in <strong>read.php</strong>. 
We'll assign <code>$_GET[&#39;id&#39;]</code> to a variable, bind it to the name of <code>id</code>, and look for the id with the <code>WHERE</code> clause.
public/update-single.php
<code>if (isset($_GET['id'])) {
  try {
    $connection = new PDO($dsn, $username, $password, $options);
    $id = $_GET['id'];
    $sql = "SELECT * FROM users WHERE id = :id";
    $statement = $connection->prepare($sql);
    $statement->bindValue(':id', $id);
    $statement->execute();
    $user = $statement->fetch(PDO::FETCH_ASSOC);
  } catch(PDOException $error) {
      echo $sql . 
"&lt;br>" . $error->getMessage();
  }
} else {
  echo "Something went wrong!";
  exit;
}</code>
Now we want to display the data, but it's going to be a little different than the previous times we printed out data, because we want to be able to update this data as well. 
How will we update it? With forms and inputs, just like we <code>INSERT</code> and <code>SELECT</code> data.
Below the database code, we'll begin our view for <strong>update-single.php</strong>. 
Now, since I know the data consists of first name, last name, and so on, I can just manually type it all out as we did before, but there's a more efficient way to get all that data. 
Let's dynamically print out each data column and value as a key/value pair in PHP.
We'll start by writing a <code>foreach</code> loop, but instead of returning the entire associative array in the variable, we'll separate the keys and values into their own variables. 
We'll get the value from the <code>fetch(PDO::FETCH_ASSOC)</code> above.
We're going to put the entire loop inside a form with a submit button.
public/update-single.php
<code>&lt;?php require "templates/header.php"; ?>
&lt;h2>Edit a user&lt;/h2>
&lt;form method="post">
  &lt;?php foreach ($user as $key => $value) : ?>
    // print data here
  &lt;?php endforeach; ?>
  &lt;input type="submit" name="submit" value="Submit">
&lt;/form>
&lt;a href="index.php">Back to home&lt;/a>
&lt;?php require "templates/footer.php"; ?></code>
Inside the <code>foreach</code>, we're making a form which will consist of labels and inputs. 
Each label will be a column name from the database.
<code>&lt;label for="&lt;?php echo $key; ?>">
  &lt;?php echo ucfirst($key); ?>
&lt;/label></code>
Each value will be the value of an input. 
We'll be using the key as the <code>name</code> and <code>id</code> of the input, and the value as the <code>value</code>. 
I'm also adding a <a href="http://php.net/manual/en/language.operators.comparison.php">ternary</a> (quick conditional statement) to make the input "readonly" if the key name is <code>id</code>, as it should not be editable.
<code>&lt;input
  type="text"
  name="&lt;?php echo $key; ?>"
  id="&lt;?php echo $key; ?>"
  value="&lt;?php echo escape($value); ?>">
  &lt;?php echo ($key === 'id' ? 'readonly' : null); ?>></code>
Now the entire form looks like this.
public/update-single.php
<code>&lt;form method="post">
    &lt;?php foreach ($user as $key => $value) : ?>
      &lt;label for="&lt;?php echo $key; ?>">&lt;?php echo ucfirst($key); ?>&lt;/label>
      &lt;input type="text" name="&lt;?php echo $key; ?>" id="&lt;?php echo $key; ?>" value="&lt;?php echo escape($value); ?>" &lt;?php echo ($key === 'id' ? 'readonly' : null); ?>>
    &lt;?php endforeach; ?>
    &lt;input type="submit" name="submit" value="Submit">
&lt;/form></code>
Okay, that was quite a bit of work, but now look what we have!
<img src="https://www.taniarascia.com/static/ea33807f79fea60ee5f81d4c0d8d45bc/4d3f1/Screen-Shot-2018-04-22-at-7.36.11-PM.png">
    
The single edit page now has editable fields for each value. 
However, our code at this point is only to display the data - we need to add another section to process the code after the submit button has been pressed.
At the top of <strong>update-single.php</strong>, right below the two required files, check if the form has been submitted, and begin the <code>try/catch</code> block.
<code>if (isset($_POST['submit'])) {
  try {
    $connection = new PDO($dsn, $username, $password, $options);
    // run update query
  } catch(PDOException $error) {
    echo $sql . 
"&lt;br>" . $error->getMessage();
  }
}</code>
We want to use the <code>UPDATE</code> clause to <code>SET</code> each value to the new value. 
The literal code for our case looks like this:
<div data-language="sql"><code>   UPDATE users
     SET id = :id,
         firstname = :firstname,
         lastname = :lastname,
         email = :email,
         age = :age,
         location = :location,
         date = :date
   WHERE id = :id</code>
That's all we need to update the values now! I'm just going to quickly add in some code to display that everything has been updated on the front end.
<code>&lt;?php if (isset($_POST['submit']) &amp;&amp; $statement) : ?>
  &lt;?php echo escape($_POST['firstname']); ?> successfully updated.
&lt;?php endif; ?></code>
Here is the entirety of the file we just created.
public/update-single.php
<code>&lt;?php
/**
  * Use an HTML form to edit an entry in the
  * users table.
  *
  */
require "../config.php";
require "../common.php";
if (isset($_POST['submit'])) {
  try {
    $connection = new PDO($dsn, $username, $password, $options);
    $user =[
      "id"        => $_POST['id'],
      "firstname" => $_POST['firstname'],
      "lastname"  => $_POST['lastname'],
      "email"     => $_POST['email'],
      "age"       => $_POST['age'],
      "location"  => $_POST['location'],
      "date"      => $_POST['date']
    ];
    $sql = "UPDATE users
            SET id = :id,
              firstname = :firstname,
              lastname = :lastname,
              email = :email,
              age = :age,
              location = :location,
              date = :date
            WHERE id = :id";
  $statement = $connection->prepare($sql);
  $statement->execute($user);
  } catch(PDOException $error) {
      echo $sql . 
"&lt;br>" . $error->getMessage();
  }
}
if (isset($_GET['id'])) {
  try {
    $connection = new PDO($dsn, $username, $password, $options);
    $id = $_GET['id'];
    $sql = "SELECT * FROM users WHERE id = :id";
    $statement = $connection->prepare($sql);
    $statement->bindValue(':id', $id);
    $statement->execute();
    $user = $statement->fetch(PDO::FETCH_ASSOC);
  } catch(PDOException $error) {
      echo $sql . 
"&lt;br>" . $error->getMessage();
  }
} else {
    echo "Something went wrong!";
    exit;
}
?>
&lt;?php require "templates/header.php"; ?>
&lt;?php if (isset($_POST['submit']) &amp;&amp; $statement) : ?>
  &lt;?php echo escape($_POST['firstname']); ?> successfully updated.
&lt;?php endif; ?>
&lt;h2>Edit a user&lt;/h2>
&lt;form method="post">
    &lt;?php foreach ($user as $key => $value) : ?>
      &lt;label for="&lt;?php echo $key; ?>">&lt;?php echo ucfirst($key); ?>&lt;/label>
      &lt;input type="text" name="&lt;?php echo $key; ?>" id="&lt;?php echo $key; ?>" value="&lt;?php echo escape($value); ?>" &lt;?php echo ($key === 'id' ? 'readonly' : null); ?>>
    &lt;?php endforeach; ?>
    &lt;input type="submit" name="submit" value="Submit">
&lt;/form>
&lt;a href="index.php">Back to home&lt;/a>
&lt;?php require "templates/footer.php"; ?></code>
As a test, I updated the age value to make sure it worked.
<img src="https://www.taniarascia.com/static/dcea543ad333276591b0c332095ed23a/4d3f1/Screen-Shot-2018-04-22-at-7.36.27-PM.png">
    
Now that we've completed the update process, it's time to move on to deleting, which is much simpler.
<h2>Step 4: Deleting entries from a database</h2>
Back in <strong>index.php</strong>, let's add an entry for <code>delete</code>. 
We could put this in the update file, but for the sake of continuity and finishing the acronym, let's just make it into a new file.
public/index.php
<div data-language="html"><code>&lt;ul>
  &lt;li>
    &lt;a href="create.php">&lt;strong>Create&lt;/strong>&lt;/a> - add a user
  &lt;/li>
  &lt;li>
    &lt;a href="read.php">&lt;strong>Read&lt;/strong>&lt;/a> - find a user
  &lt;/li>
  &lt;li>
    &lt;a href="update.php">&lt;strong>Update&lt;/strong>&lt;/a> - edit a user
  &lt;/li>
  &lt;li>
    &lt;a href="delete.php">&lt;strong>Delete&lt;/strong>&lt;/a> - delete a user
  &lt;/li>
&lt;/ul></code>
There's nothing new to learn with the <code>DELETE</code> statement. 
Let's copy the code from <strong>update.php</strong> over, but change "edit" to "delete". 
We'll have the delete link to to the same URL with a query string added, instead of a single page for deletion.
<code>&lt;td>&lt;a href="delete.php?id=&lt;?php echo escape($row["id"]); ?>">Delete&lt;/a>&lt;/td></code>
The <code>DELETE</code> statement is just like <code>SELECT</code>, and we'll check for the <code>$_GET</code> superglobal again. 
If the proper <code>id</code> is loaded into the URL, PHP will delete that user.
public/delete.php
<code>&lt;?php
/**
  * Delete a user
  */
require "../config.php";
require "../common.php";
if (isset($_GET["id"])) {
  try {
    $connection = new PDO($dsn, $username, $password, $options);
    $id = $_GET["id"];
    $sql = "DELETE FROM users WHERE id = :id";
    $statement = $connection->prepare($sql);
    $statement->bindValue(':id', $id);
    $statement->execute();
    $success = "User successfully deleted";
  } catch(PDOException $error) {
    echo $sql . 
"&lt;br>" . $error->getMessage();
  }
}
try {
  $connection = new PDO($dsn, $username, $password, $options);
  $sql = "SELECT * FROM users";
  $statement = $connection->prepare($sql);
  $statement->execute();
  $result = $statement->fetchAll();
} catch(PDOException $error) {
  echo $sql . 
"&lt;br>" . $error->getMessage();
}
?>
&lt;?php require "templates/header.php"; ?>
&lt;h2>Delete users&lt;/h2>
&lt;?php if ($success) echo $success; ?>
&lt;table>
  &lt;thead>
    &lt;tr>
      &lt;th>#&lt;/th>
      &lt;th>First Name&lt;/th>
      &lt;th>Last Name&lt;/th>
      &lt;th>Email Address&lt;/th>
      &lt;th>Age&lt;/th>
      &lt;th>Location&lt;/th>
      &lt;th>Date&lt;/th>
      &lt;th>Delete&lt;/th>
    &lt;/tr>
  &lt;/thead>
  &lt;tbody>
  &lt;?php foreach ($result as $row) : ?>
    &lt;tr>
      &lt;td>&lt;?php echo escape($row["id"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["firstname"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["lastname"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["email"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["age"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["location"]); ?>&lt;/td>
      &lt;td>&lt;?php echo escape($row["date"]); ?> &lt;/td>
      &lt;td>&lt;a href="delete.php?id=&lt;?php echo escape($row["id"]); ?>">Delete&lt;/a>&lt;/td>
    &lt;/tr>
  &lt;?php endforeach; ?>
  &lt;/tbody>
&lt;/table>
&lt;a href="index.php">Back to home&lt;/a>
&lt;?php require "templates/footer.php"; ?></code>
Here's the page after I deleted two users.
<img src="https://www.taniarascia.com/static/2e45ab233f18d144c0e83b50d80b1f22/4d3f1/Screen-Shot-2018-04-22-at-10.58.42-PM.png">
    
Often, in a real app, data won't be permanently deleted from the database. 
The users might have a boolean table that defines them as "active" or "inactive" users instead of actually deleting the data. 
Nonetheless, <code>DELETE</code> is important to know, and it can be used along with <code>SELECT</code> to delete than insert new data as opposed to updating it with <code>UPDATE</code>.
<h2>Adding CSRF Protection</h2>
As a final step, we want to take security into consideration. 
We will generate a CSRF token and add it to the user's session.
CSRF stands for <a href="https://www.incapsula.com/web-application-security/csrf-cross-site-request-forgery.html">Cross-Site Request Forgery</a>, and is a way an attacker can trick a browser into executing a malicious action.
In order to prevent this, we will test the CSRF token in the session against a value in a hidden input. 
If they match, the code will execute. 
If not, the code will exit.
To add this in, we'll go back to <strong>common.php</strong>, generate the CSRF and assign it to <code>$_SESSION[&#39;csrf&#39;]</code>.
common.php
<code>session_start();
if (empty($_SESSION['csrf'])) {
  if (function_exists('random_bytes')) {
    $_SESSION['csrf'] = bin2hex(random_bytes(32));
  } else if (function_exists('mcrypt_create_iv')) {
    $_SESSION['csrf'] = bin2hex(mcrypt_create_iv(32, MCRYPT_DEV_URANDOM));
  } else {
    $_SESSION['csrf'] = bin2hex(openssl_random_pseudo_bytes(32));
  }
}</code>
Now at the top of all our <strong>public/</strong> files, we'll add the following code in:
<code>require "../config.php";
require "../common.php";
if (isset($_POST['submit'])) {
  if (!hash_equals($_SESSION['csrf'], $_POST['csrf'])) die();</code>
Finally, we'll add the value into the input on each form.
<code>&lt;input name="csrf" type="hidden" value="&lt;?php echo escape($_SESSION['csrf']); ?>"></code>
Contribution by <a href="https://github.com/taniarascia/pdo/pull/5">djhayman</a>.
<h2>Conclusion</h2>
That was a lot of information. 
If you got lost somewhere along the way, I don't blame you! There's a reason few tutorials venture into this territory. 
Fortunately, all the code is up on GitHub. 
All you have to do is clone or download the entire repository into the root of your server, run the install script, and you're good to go with all the CRUD operations!
<a href="https://github.com/taniarascia/pdo">View on GitHub</a>
<br>
<br>
<br>
<br>
<script>
	var toc = $('#toc');
	$('h1,h2').each(function(i) {
		var topic = $(this), topicNumber = i + 1;
		toc.append('<a href="#topic-'+topicNumber+'" target="_self">'+topic.text()+'</a><br>');
		topic.attr('id', 'topic-' + topicNumber);
	});
</script>
