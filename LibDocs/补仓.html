<base target="_blank"><html><head><title>补仓表</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="https://williamkpchan.github.io/lazyload.min.js"></script>
<script type='text/javascript' src='https://williamkpchan.github.io/mainscript.js'></script>
<script src="https://williamkpchan.github.io/commonfunctions.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<style>
body{width:80%;margin-left: 10%; font-size:22px; color:gray;}
</style>
<body>
<h1>计算补仓</h1>
<br>
<label for="curQty">现有数量：</label>
  <input type="number" id="curQty" onchange="calculateTotal()">
<label for="costPrice">成本价：</label>
  <input type="number" id="costPrice" onchange="calculateTotal()">
<label for="costAmt">成本金额：</label>
  <span id="costAmt"></span>
<br>
  <label for="supQty">补仓数量：</label>
  <input type="number" id="supQty" onchange="calculateBCTotal()">
  <label for="supCostPrice">补仓价：</label>
  <input type="number" id="supCostPrice" onchange="calculateBCTotal()">
  <label for="supCostAmt">补仓金额：</label>
  <span id="supCostAmt"></span>

<br>
<br>
  <label for="totCostAmt">总金额：</label>
  <span id="totCostAmt"></span>
&emsp;&emsp;
  <label for="totQty">总数量：</label>
  <span id="totQty"></span>
&emsp;&emsp;
  <label for="totCostPrice">平均价：</label>
  <span id="totCostPrice"></span>
<br>

<script>
var costAmt, supCostAmt, totCostPrice, totQty
function calculateTotal(){
  if( !isNaN($("#costPrice").val()) && !isNaN($("#curQty").val()) ){
    costAmt = $("#costPrice").val() * $("#curQty").val()
    $("#costAmt").html(costAmt)
    calculateFinalQty()
  }
}
function calculateBCTotal(){
  if( !isNaN($("#supCostPrice").val()) && !isNaN($("#supQty").val()) ){
    supCostAmt = $("#supCostPrice").val() * $("#supQty").val()
    $("#supCostAmt").html(supCostAmt)
    calculateFinalQty()
  }
}

function calculateFinalQty(){
  if( !isNaN($("#curQty").val()) && !isNaN($("#supQty").val()) ){
    totQty = parseInt($("#curQty").val()) + parseInt($("#supQty").val())
    $("#totQty").html(totQty)
    calculateFinalPrice()
  }
}

function calculateFinalPrice(){
    totCostAmt = costAmt + supCostAmt
    $("#totCostAmt").html(totCostAmt)

    totCostPrice = (totCostAmt / totQty).toFixed(4);
    $("#totCostPrice").html(totCostPrice)

}

</script>
</body>
</html>