<html>
<head>
<title>..</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script type='text/javascript' src='../mainscript.js'></script>

<script>
$(document).ready(function(){
    $('h1, h2, h3, h4, h5, .goldword, strong,  div.title').click(function(){
    parent.history.back();
    return false;
    });
});

function chkKey() {
var testkey = getChar(event);
if(testkey == 'e'){window.scrollTo(0,document.body.scrollHeight);}
if(testkey == "l"){divtoc = document.getElementById("toc");$('body,html').animate({scrollTop:(divtoc.clientHeight + divtoc.offsetTop-600)}, 1); }
if(testkey == 't'){window.location = '#toc';}
if(testkey == 'T'){window.scrollTo(0,0);}
}
function getChar(event){if (event.which!=0 && event.charCode!=0) {return String.fromCharCode(event.which)}
 else {return null}}

</script>
<style>
body{width:80%;margin-left: 10%; font-size:24px;}
strong, h1, h2 {color: gold;}
img {max-width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%; border-radius:3px;}
</style>
</head>
<body onkeypress="chkKey()">
<center>
<h1></h1>
<div id="toc"></div></center>
<pre>
<br>
<br>
<br>

<h2>在线学习智能高精度红外体温测量方案</h2>
前言碎语
在举国之力抗疫斗争下，一切都正在往好的方向发展，相信再坚持坚持咱们就全面胜利啦！了解大家宅家躺睡做贡献却依然忍不住想做点什么的心情，机智云资深开发者小冯老师为大家奉上最新开发教程，在一罩难求、一计难寻的防疫刚需面前，机智如你不防跟着小冯老师一起动手做一款智能高精度红外体温计吧！手机看体温，后台有数据，全家防护扛扛滴！

<b>01 项目概述</b>
本教程开发基于机智云AIoT自助开发平台、机智云Gokit3开发板、机智云DEMO APP，采用高精度红外传感器MLX90614ESF测量传感器（常见集成模块GY-906，精度可达0.02℃），实现高精度智能红外体温测量，实时上传体温数据、APP/云端监测体温曲线，提升自我检测/应急处理能力及效率。

本教程软硬件开源，提供开发文档及视频教学、社区技术支持在线协助学习开发，详细资料及开发程序请至机智云开发者社区club.gizwits.com下载：
http://club.gizwits.com/thread-165632-1-1.html

<b>02 准备工具</b>


<img src="https://mmbiz.qpic.cn/mmbiz_jpg/bsDFa2lr6JtffAffZueaehce0XKPbGNwqQfyh77xwuqpqiax13V2tLnb28NDHedZYuArVNTn4Pzuxl16VW73XeA/640">

1、Gokit3开发板 1 块
了解开发板：
http://docs.gizwits.com/zh-cn/deviceDev/Gokit3/Gokit3开发套件简介.html
免费申请：http://www2.gizwits.com/zh-cn/gokit/
在线购买：送你一张¥20优惠券（截止3月31日），复制下方淘口令打开淘宝APP，联系客服领取优惠劵，把Gokit3带回家实现红外体温测量₴9IWU1UZjHoY₴2、红外体温传感器本教程采用高精度红外传感器MLX90614ESF测量传感器，常见集成模块GY-906，精度可达0.02℃。
（由于近期红外体温传感器已成为爆款一器难求，大家可以先用Gokit3开发板上自带的温度传感器跟着教程模拟开发，等行情好转了再买一个回来替换，开发原理是一样的。）

3、USB转TTL模块（下载器）4、注册开发者账号 www.gizwits.com注册5分钟了解机智云：http://docs.gizwits.com/zh-cn/quickstart/README.html03&nbsp;主要步骤
云端部署：
进入机智云开发者中心https://dev.gizwits.com/zh-cn/developer/product/创建一个新的产品，按照下图创建一个新的产品。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0uc3JDMNuHA7GTQ4KFSvcU2uiaCl2WBXYtuWFNusV0qHbupTInsBgUyg/640">
创建好产品之后，点击导航栏数据点，新增一个数据点，由于传感器的范围是-70-380℃，所以为了使用用范围广，创建如下图所示的温度数据点。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0zlia3pRKibC5cYlBTSiaeVGeQtFJVDvy7EREPvNw8Q9iaiaBPASAAmwZyRQ/640">
如果要手机APP显示中文测量温度，那么添加之后点击数据点后面的修改，将显示名称改成测量温度即可。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0He82eVSQXkqn7rXy6DLg1V75qafWBjRsxLGd4YAbC8P3H9tibGpkCzw/640">
利用机智云自动代码功能，生成SOC代码，点击基本信息复制里面的Product Secret备用。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0vaSjMDVLibiapnbrXzRldEB5bznV3JdJgMWy8YFGV5CE5uEFRG7kRAWA/640">
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;点击MCU开发，将复制的Product Secret粘贴进去，然后生成代码，将生成的代码下载到电脑备用。
尽量避免中文路径的出现。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF07Y3hjsNWWedzFPXiaVAkfPO6eoTG0SRjeLxcFrsRFiaOW3K9RvFwiaHkA/640">
将代码解压到非中文路径备用
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0VF6P0yWxoQqBW8F1No5XRyCibUQicHdHNYqTOw8aqZNViaC1SD8XH68CQ/640">
开发环境部署：在此处，我们需要用到2个软件，一个用来给esp8266烧录程序，一个用来开发编译程序。

2个软件打包云盘。
将下载的2个软件分别解压（链接：https://pan.baidu.com/s/1Day4WA5HJNV9LlUqs4LFyQ 提取码：2x6a ），将解压过后开发软件里面的文件复制到英文路径下面。
一定要是英文路径，否则不能编译或者编译出错。
固件下载软件随便解压到就行。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0tg6rzdgpO0lq0auZav2QIOicHtmreSAo7sWPjNLzuW14tGMALhQTOAQ/640">

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0kvYb59OKaic6icYLoC2eJEeAicjnRWrNTe4Qzv0Soic81BaUdgCnTzppSA/640">
程序实现：1、项目导入。
打开开发环境，在左侧右键单击，导入项目（import）
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0PEOoXGpR4VzWXKdfDWfzuIicVzYEh4xxnoTFic6DqozwbMviaLMP4tmpA/640">
选择Makefile项目，然后next
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF08XiapcBfG0CGHjDVh2uBGR5HCJTuSZiaUyia1YjicPUrjoHgsPvR3Bs9qw/640">
选择项目所在的路径，一定不要选错了，选错编译出错，根目录如图所示，编译器选择cygwin GCC
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF09DicicYhiavSkuTqm6icfEiaiar274wVWUQbGc61dJUEA1ibP7Z9ICPCcVEQg/640">
正确导入项目如下图所示。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0LyPFaRohPEjUOgs9ZbHyUczBibygxbSyOsnwj78np1b0sZCM9Z3Bliag/640">
打开根目录下面的Makefile文件
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0VjlHOGXuwBDrs9HYXyTxUPWoF97ecEvaWcFzcr3hGz6ULAhiab6vgCA/640">
修改23、24、27行内容，这几个内容还是编译相关的，可以查阅乐鑫相关的手册，有对应的介绍，此处不在说明，照着修改就行了，修改了之后要记得保存，所有文件修改过后都需要保存再编译，否则修改内容不生效。
到此就完成了项目的导入以及初步编译部署。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0qmy4kYM1uh3rBiayibEz7cD0nkxibUJvbIEA55m4shztKxp2kV96zMCqw/640">

2、代码修改。
由于是基于gokit3，自动代码生成的按键就是和开发板对应的，因此我们只需要添加传感器数据的采集，关于代码介绍，我只介绍核心部分，为了方便理解协议，此处我将不采用SDK的IIC驱动，也不单独创建新的.c,h文件。
直接将代码写到gizwits_product里面。
数据手册自行下载附件查看。
我将会加在文章末尾作为附件。
需要修改的文件如下图3个。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF05GjjzV59CjjsGuicAbTTZkNCzgsDWDgj7fj6a5225QK6VuZPC6NVjjw/640">
根据手册和gokit3原理图。
我选用串口0作为IIC的通讯口，为啥要用串口0 ，因为串口0没有被板子其他传感器给占用。
开发板和传感器接线如下（TXD RXD在gokit arduino引脚上标注的TXD RXD）。
GPIO1(TxD)----SCLGPIO3(RxD)----SDA5V------------VCCGND----------GND关于代码介绍，可以看程序代码里面的注释说明。
gizwits_product.h新增以下代码。

<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0hvxlKibqMJ9atAej5fzJMElrepboNkmdKagdQUNJOaB0Hmno3EuEMfQ/640">
gizwits_product.c末尾新增如下函数
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0FTcFYjACJTWEIkXmxrwibhZTymT9t7DARxFKjL3yVQRBCP2HTjl7e7w/640">
gizwits_product.c的userHandle新增如下代码
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0HfqsC8JrOdLibzeNlcU7v5IibxG6LTAsYwsk7sRKxzPyiaeG7SQ76VkZA/640">
user_main.c的user_init函数新增初始化代码
<img src="https://mmbiz.qpic.cn/mmbiz_jpg/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0qQNdqZEc88DZVm8b8DnXtRvZnGwPD0Zz9Dz76OJ4qwIHyErV970DyQ/640">
修改完代码之后编译代码
<img src="https://mmbiz.qpic.cn/mmbiz_jpg/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0YtDCY38Xh0tbcX1K8icoruXjPbUVFj9mDlGPicIrgLArVI17Ub7NCbKA/640">
正确无误编译信息如下
<img src="https://mmbiz.qpic.cn/mmbiz_jpg/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0rVzuP5bIXrLA6vw4fpqvcMzzzTzLHWOZh215NlPy3bf53tu6NC9E3w/640">
代码烧录：打开下载软件，选择ESP8266
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0IsugWibaaHJzT8PAhxxqOr7iaj7cVvDOm17Zw5icb7J0Fq0n3Y0cV8omw/640">
按照图片选择固件进行烧录
<img src="https://mmbiz.qpic.cn/mmbiz_png/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0dPtn6GjBLogHicriazticibFOYewcN6dUjiczBrKmnQ50BHLADgkrQcYzTQ/640">
成功烧录之后手机APP配网绑定设备即可实时查看采集温度。
开发板key2长按为一键配置，短按为热点配置。

<img src="https://mmbiz.qpic.cn/mmbiz_jpg/bsDFa2lr6JuPfuEdAESEEOW9v3o4EsF0JibR2ReWTjRzeszVUB0WN2kgrEwrxnnOM9cKApycZM6MjiaazHib8xIcg/640">
本教程软硬件开源，提供开发文档及视频教学、社区技术支持在线协助学习开发，详细资料及开发程序请至机智云开发者社区club.gizwits.com下载：http://club.gizwits.com/thread-165632-1-1.html
<img src="https://mmbiz.qpic.cn/mmbiz_jpg/tPW1vJFec43kjdV3J2nAVbicZpvbibVIekXwibzM5ehicTiaJnQLsG7GTVJT59EnIq8w19FHfqibgZCaIM0Xu9w1vPAQ/640">
相关推荐：<a href="https://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486301&amp;idx=2&amp;sn=b30859b979e41697a982b2d48dc269a7&amp;chksm=ebccb802dcbb31143501f27e42744ab7fd49ff7bc2998f48590dfa102319ca8261ebbd77e469&amp;token=844379266&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">入门教程1：</a><a href="https://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486301&amp;idx=2&amp;sn=b30859b979e41697a982b2d48dc269a7&amp;chksm=ebccb802dcbb31143501f27e42744ab7fd49ff7bc2998f48590dfa102319ca8261ebbd77e469&amp;token=844379266&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">如何在机智云上创建自己的第一个设备</a><a href="https://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486302&amp;idx=1&amp;sn=ebbb61cdd17b3597a43b6737cda74e26&amp;chksm=ebccb801dcbb3117260b4ec759df153c8c48b28515e5284ec3ea5b8d13615a9343b78fc465b5&amp;token=844379266&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">入门教程2：</a><a href="https://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486302&amp;idx=1&amp;sn=ebbb61cdd17b3597a43b6737cda74e26&amp;chksm=ebccb801dcbb3117260b4ec759df153c8c48b28515e5284ec3ea5b8d13615a9343b78fc465b5&amp;token=844379266&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">机智云自动生成代码工程及原理介绍</a><a href="https://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486318&amp;idx=1&amp;sn=ec40d75ba14479441e2fcf4e6cd6a587&amp;chksm=ebccb831dcbb31272df8229d93857a03c438e772bfe1790068483dd4f2de3808d52db0f4a83f&amp;token=54294463&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">入门教程3：</a><a href="https://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486318&amp;idx=1&amp;sn=ec40d75ba14479441e2fcf4e6cd6a587&amp;chksm=ebccb831dcbb31272df8229d93857a03c438e772bfe1790068483dd4f2de3808d52db0f4a83f&amp;token=54294463&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">如何给ESP8266烧录Gagent固件，快速接入机智云实现透传功能</a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486351&amp;idx=1&amp;sn=9cf7aa3c9ce6d60dc045634052a5a7b5&amp;chksm=ebccb8d0dcbb31c66ec3c4ca78e45706bb36abac3b580fc5911a11fd3eaa940ca63863b68a8b&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="cursor: pointer;max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">入门教程4：教你STM32F407标准库移植机智云代码（控制LED灯）</a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486331&amp;idx=1&amp;sn=e1faac363b58dd12466e4bae7357fbb3&amp;chksm=ebccb824dcbb3132c514320d83dac80964f53a81ed46c0384eb6d3173aac9841464c0585db34&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">入门教程5：STM32F407如何通过机智云获取NTP网络时间</a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486352&amp;idx=1&amp;sn=176761c6a04a41399cd3131a3e9fba78&amp;chksm=ebccb8cfdcbb31d9e6973e164b12424a275a4cfc50b7ca72f844bb4355d21ea7b13839b557cf&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">入门教程6：基于机智云APP实现多路设备控制（STM32F4）</a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486176&amp;idx=1&amp;sn=9faf962f3ebaeed5a6d645d6e88e4501&amp;chksm=ebccb9bfdcbb30a9e53d0b8f033c40faba7a6952cccc538fec8978a4a3f7d2552a6fae6dc22f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">应用技巧：ESP8266 SOC模式的机智云OTA流程</a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI4NzQxNzkwNA==&amp;mid=2247486252&amp;idx=1&amp;sn=f9d398871ebf9e8cd2f347392fd18739&amp;chksm=ebccb873dcbb31658ca2d126902e91c9dfebd524cbc5630b5f96b087f92e7627705817512ef8&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" style="cursor: pointer;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">机智云轻网关方案，让智能设备套件开发更便捷、成本更低</a>技术交流：机智云开发者：www.gizwits.com机智云开发者社区：club.gizwits.comQQ技术交流群：378683984官方淘宝店：http://shop159680395.taobao.com/index.htm客服电话/微信：18002215823
<br>
<br>
<br>
<br>

<script>
	var toc = $('#toc');
	$('h2').each(function(i) {
		var topic = $(this), topicNumber = i + 1;
		toc.append(topicNumber +' <a href="#topic-'+topicNumber+'" target="_self">'+topic.html()+'</a><br>');
		topic.attr('id', 'topic-' + topicNumber);
	});
</script>



