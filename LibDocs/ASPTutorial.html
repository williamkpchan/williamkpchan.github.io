<base target="_blank"><html><head><title>ASPTutorial</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script src="https://williamkpchan.github.io/lazyload.min.js"></script>
<script type='text/javascript' src='https://williamkpchan.github.io/mainscript.js'></script>
<script src="https://williamkpchan.github.io/commonfunctions.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>

<script>
  var showTopicNumber = true;
  var topicEnd = "<br>";
  var bookid = "ASPTutorial"
  var markerName = "h2"
</script>
<style>
body{width:80%;margin-left: 10%; font-size:22px;}
h1, h2 {color: gold;}
strong {color: orange;}
pre{width:100%;}
#toc{color:cyan; font-size:20px;}
img {max-width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%; border-radius:3px; background-color:#044;}
</style></head><body onkeypress="chkKey()"><center>
<h1>ASPTutorial</h1>
<a href="#mustWatch" class="red goldbs" target="_self">Must Watch!</a>
<br><br>
<div id="toc"></div></center>
<br><br>
<div id="mustWatch"><center><span class="red">MustWatch</span></center><br>
</div>
<pre>
<br>
<br>
<h2><span class="orange"> ASP.NET Web Pages  - Tutorial</span></h2>
<h2>Easy Learning with "Run Example"</h2>
Our "Run Example" tool displays the ASP.NET code and the HTML output simultaneously.

Click on the "Run Example" button to see how it works:


<h3>Web Pages Example</h3>
&lt;html>

&lt;body>

     &lt;h1>Hello Web Pages&lt;/h1>

     &lt;p>The time is @DateTime.Now&lt;/p>

&lt;/body>

&lt;/html>
<a href="showfile_c.asp?filename=try_webpages_cs_001">Run Example </a>


<h2>ASP.NET Web Pages</h2>
Web Pages is one of many programming models for creating ASP.NET web sites and web applications.

Web Pages provides an easy way to combine HTML, CSS, and server code: 


Easy to learn, understand, and use Uses an SPA application model (Single Page Application) Similar to PHP and Classic ASP VB (Visual Basic) or C# (C sharp) scripting languages 

In addition, Web Pages applications are easily extendable with programmable helpers for databases, videos, graphics, social networking and more.




<h2>Web Pages Tutorial</h2>
If you are new to ASP.NET, Web Pages is a perfect place to start. 

In this Web Pages tutorial you will learn how to combine HTML, CSS, JavaScript and server code, using server code written in VB or C# .

You will also learn how to extend your web pages with programmable Web Helpers. 




<h2>Web Pages Examples</h2>
Learn by examples!

Because ASP.NET code is executed on the server, you cannot view the code in your browser. You will only see the output as plain HTML. 

At W3Schools every example displays the hidden ASP.NET code. This makes it easier for you to understand how it works.


 <a href="webpages_examples.asp">Web Pages Examples</a>



<h2>Web Pages References</h2>
At the end of this tutorial you will find a complete set of ASP.NET references with objects, components, properties and methods.


 <a href="webpages_classes.asp">Web Pages References</a>



<h2><span class="orange"> ASP.NET Web Pages - Adding Razor Code</span></h2>

<h2>Razor Markup</h2>
Razor is a simple <strong>markup syntax</strong> for embedding server code 
(C# or VB) into ASP.NET web pages.



<h3>Example</h3>
&lt;!DOCTYPE html>


&lt;html lang="en">

&lt;head>

     &lt;meta charset="utf-8" />

     &lt;title>Web Pages Demo&lt;/title>

&lt;/head>

&lt;body>

     &lt;h1>Hello Web Pages&lt;/h1> 

     &lt;p>The time is @DateTime.Now&lt;/p>

&lt;/body>

&lt;/html>

<a href="showfile_c.asp?filename=try_webpages_cs_001">
Run example </a>


The page above contains both ordinary HTML markup and Razor markup.



<h2>Razor Syntax for C#</h2>

C# code blocks are enclosed in @{ ... }
  Inline expressions (variables or functions) start with @
  Code statements end with semicolon
  Variables are declared with the var keyword, or the datatype (int, string, 
  etc.) 
  Strings are enclosed with quotation marks
  C# code is case sensitive
  C# files have the extension .cshtml

<h3>C# Example</h3>
&lt;!-- Single statement block -->
@{ var myMessage =    "Hello World"; }


&lt;!-- Inline expression or variable -->

&lt;p>The value of myMessage is: @myMessage&lt;/p> 


&lt;!--    Multi-statement block -->
@{

var greeting = "Welcome to our site!";

var weekDay = DateTime.Now.DayOfWeek;

var greetingMessage = greeting + " Today is: " + weekDay;

}
&lt;p>The greeting is: @greetingMessage&lt;/p>

<a href="showfile_c.asp?filename=try_razor_cs_001">    Run example </a>



<h2>Razor Syntax for VB</h2>

VB code blocks are enclosed in @Code ... End Code
  Inline expressions (variables or functions) start with @
  Variables are declared with the Dim keyword
  Strings are enclosed with quotation marks
  VB code is not case sensitive
  VB files have the extension .vbhtml

<h3>VB Example</h3>
&lt;!-- Single statement block  --> 
@Code dim myMessage = "Hello World" End Code

 

&lt;!-- Inline expression or variable --> 

&lt;p>The value of myMessage is: @myMessage&lt;/p> 

 

&lt;!-- Multi-statement block --> 
@Code

dim greeting = "Welcome to our site!" 

dim weekDay = DateTime.Now.DayOfWeek 

dim greetingMessage = greeting &amp; " Today is: " &amp; weekDay

End Code



&lt;p>The greeting is: @greetingMessage&lt;/p>
<a href="showfile_vb.asp?filename=try_razor_vb_001">Run example </a>


<h2>More About C# and Visual Basic</h2>
If you want to learn more about Razor, and the C# and Visual Basic 
programming languages:

Go to the <a href="razor_intro.asp">Razor section</a> of 
this tutorial. 



<h2><span class="orange"> ASP.NET Web Pages - Page Layout</span></h2>

consistent layout.


<h2>A Consistent Look</h2>
On the Internet you will discover many web sites with a consistent look and 
feel:


Every page have the same header
  Every page have the same footer
  Every page have the same style and layout

With Web Pages this can be done very efficiently. You can have reusable 
blocks of content (content blocks), like headers and footers, in separate files.

You can 
also define a consistent layout for all your pages, using a layout template 
(layout file).


<h2>Content Blocks</h2>
Many websites have content that is displayed on every 
page (like headers and footers).

With Web Pages you can use the <b>@RenderPage()</b> method to import content from separate 
files.

Content block (from another file) can be imported anywhere in a web page, and 
can contain text, markup, and code, just like any regular web page. 

Using common headers and footers as an example, this saves you a lot of work. You don't have to write the 
same content in every page, and when you change the header or footer files, the 
content is 
updated in all your pages.

This is how it looks in code:


<h3>Example</h3>
&lt;html>

&lt;body>
@RenderPage("header.cshtml")

&lt;h1>Hello Web Pages&lt;/h1> 

&lt;p>This is a paragraph&lt;/p>
@RenderPage("footer.cshtml")

&lt;/body>

&lt;/html>
<a href="showfile_c.asp?filename=try_webpages_cs_002">Run example </a>



<h2>Using a Layout Page</h2>
In the previous section, you saw that including the same content in many 
web pages is easy.

Another approach to creating a consistent look is to use a layout page. A layout page 
contains the structure, but not the content, of a web page. When a web page 
(content page) is linked to a layout page, it will be displayed 
according to the layout page (template).

The layout page is just like a normal web page, except from a call to the
<strong>@RenderBody()</strong> method where the content page will be 
included.

Each content page must start with a <strong>Layout directive</strong>.

This is how it looks in code:


<h3>Layout Page:</h3>
&lt;html>
&lt;body>
&lt;p>This is header text&lt;/p>
@RenderBody()

&lt;p>&amp;copy; 2014 W3Schools. All rights reserved.&lt;/p>
&lt;/body>
&lt;/html>


<h3>Any Web Page:</h3>
@{Layout="Layout.cshtml";}

&lt;h1>Welcome to W3Schools&lt;/h1>

&lt;p>
Lorem ipsum dolor sit amet, consectetur adipisicing elit,sed do eiusmod tempor 
incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis 
nostrud exercitation ullamco laborisnisi ut aliquip ex ea commodo consequat.
&lt;/p>

<a href="showfile_c.asp?filename=try_webpages_cs_011">Run example </a>


<h2>D.R.Y. - Don't Repeat Yourself</h2>
With two ASP.NET tools, Content Blocks and Layout Pages, you can give your 
web applications a consistent look.

These tools also save you a lot of work, since you don't have to repeat the 
same information on all pages. Centralizing markup, style, and code makes web 
applications much more manageable and easier to maintain.



<h2>Preventing Files from Being Browsed</h2>
With ASP.NET, files with a name that starts with an underscore cannot be 
browsed from the web.

If you want to prevent your content blocks or layout files from being viewed 
by your users, rename the files to:

_header.cshtml

_footer.cshtml

_Layout.cshtml



<h2>Hiding Sensitive Information</h2>
With ASP.NET, the common way to hide sensitive information (database passwords, 
email passwords, etc.) is to keep the information in a separate file named 
"_AppStart".

<h3>_AppStart.cshtml</h3>
@{
WebMail.SmtpServer = "mailserver.example.com";

WebMail.EnableSsl = true;
WebMail.UserName = "username@example.com";

WebMail.Password = "your-password";
WebMail.From = "your-name-here@example.com";

}




 id="mypagediv2" style="position:relative;text-align:center;">



<h2><span class="orange"> ASP.NET Web Pages - Folders</span></h2>


In this chapter you will learn:


About Logical and Physical folder structures
  About Virtual and Physical names
  About web URLs and Paths


<h2>Logical Folder Structure</h2>

Below is a typical folder structure for an ASP.NET web pages web site: 

<img alt="Folders" src="pic_folders.jpg" style="width:80%;border:1px solid lightgrey">
The "Account" folder contains logon and security files
The "App_Data" folder contains databases and data files
The "Images" folder contains images
  The "Scripts" folder contains browser scripts
The "Shared" folder contains common files (like layout and style files)


<h2>Physical Folder Structure</h2>

The physical  
structure for the "Images" folder at the website above might look like this on a computer:


C:\Johnny\Documents\MyWebSites\Demo\Images 



<h2>Virtual and Physical Names</h2>

From the example above:


The virtual name of a web picture might be "Images/pic31.jpg".


But the physical name is "C:\Johnny\Documents\MyWebSites\Demo\Images\pic31.jpg"



<h2>URLs and Paths</h2>
URLs are used to access files from the web:
<a href="https://www.w3schools.com/html/html5_intro.asp">https://www.w3schools.com/html/html5_intro.asp</a> 

The URL corresponds 
to a physical file on a server: C:\MyWebSites\w3schools\html\html5_intro.asp 


A virtual 
path is shorthand to represent physical paths. If you use virtual paths, you can move your 
pages to a different domain 
(or server) without having to update the paths. 

<table>
<tr><td>URL</td><td>https://www.w3schools.com/html/html5_intro.asp</td></tr>
<tr><td>Server name</td><td>w3schools</td></tr>
<tr><td>Virtual path</td><td>/html/html5_intro.asp</td></tr>
<tr><td>Physical path</td><td>C:\MyWebSites\w3schools\html\html5_intro.asp</td></tr>
</table>
The root on a disk drive is written like C:\, but the root on a web site is  / 
(forward slash).

The virtual path of a 
web folder is (almost) never the same as the physical folder.

In your code you will, reference both the physical path and the virtual path, depending on what 
you are coding. 

ASP.NET has 3 tools for working with folder paths: the ~ operator, the Server.MapPath method, 
and the Href method.


<h2>The ~ Operator</h2>
To specify the virtual root in programming code, use the ~ operator.

If you use the ~ operator, instead of a path, you can move your website to a different folder or 
location without changing any code:


var myImagesFolder = "~/images";

var myStyleSheet = "~/styles/StyleSheet.css";


<h2>The Server.MapPath Method</h2>
The Server.MapPath method converts a virtual path (/default.cshtml) to a physical path that the server can understand (C:\Johnny\MyWebSited\Demo\default.cshtml).

You will use this method when you need to open data files located on the server (data files can only be accessed with a full physical path):


var pathName = "~/dataFile.txt";
var fileName = Server.MapPath(pathName);You will learn more about reading from (and writing to) data files on the server in the next chapter of this tutorial.



<h2>The Href Method</h2>
The Href method converts a path used in the code to a path that the browser can understand (the browser cannot understand the ~ operator).

You use the Href method to create paths to resources like image files, and CSS files.

You will often use this method in HTML 
&lt;a>, &lt;img>, and &lt;link> elements:


@{var myStyleSheet = "~/Shared/Site.css";}

&lt;!-- This creates a link to the CSS file. -->
&lt;link rel="stylesheet" type="text/css" href="@Href(myStyleSheet)" 
/>

&lt;!-- Same as : -->
&lt;link rel="stylesheet" type="text/css" href="/Shared/Site.css" 
/>
The Href method is a method of the WebPage Object.


<h2><span class="orange"> ASP.NET Web Pages - Global Pages</span></h2>


<h2>Before Web Startup: _AppStart</h2>

Most server side code are written inside individual web pages. For example, if a web page contains an input form, the web page typically contains server code for reading the data.


However, by creating a page named _AppStart in the root of your site, you can have startup code executed before the site starts. If this page exists, ASP.NET runs it the first time any page in the site is requested.


Typical use for _AppStart is startup code and initialization of global values like counters and global names.


<strong>Note 1:</strong> _AppStart should have the same file extension as your web pages, like: _AppStart.cshtml.  


<strong>Note 2: </strong>_AppStart has an underscore prefix. Because of this, the files cannot be browsed directly.


<h2>Before Every Page: _PageStart</h2>

Just like _AppStart runs before your site starts, you can write code that runs before any page in each folder.


For each folder in your web, you can add a file named _PageStart.


Typical use for _PageStart is setting the layout page for all pages in a folder, or checking that a user is logged in before running a page.


<h2>How Does it Work?</h2>

The following diagram shows how it works:


<img alt="PageStart" height="316" src="pic_webpages_pagestart.jpg" width="630">


When a request comes in, ASP.NET checks whether _AppStart exists. 
If so, and this is the first request to the site, _AppStart runs.


Then ASP.NET checks whether _PageStart exists. If so, _PageStart runs, before the requested page.


If you include a call to RunPage() inside _PageStart you specify where you want the requested page to run. If not, the _PageStart runs before the requested page.


<h2><span class="orange"> ASP.NET Web Pages - HTML Forms</span></h2>

controls (text boxes, check boxes, radio buttons, and pull-down lists).


<h2>Creating an HTML Input Page</h2>

<h3>Razor Example</h3>
&lt;html>

&lt;body> 
@{

if (IsPost) { 

string companyname = Request["CompanyName"]; 

string contactname = Request["ContactName"]; 
&lt;p>You entered: &lt;br />

Company Name: @companyname &lt;br />

Contact Name: @contactname &lt;/p>

}

else

{
&lt;form method="post" action="">

    Company Name:&lt;br />

&lt;input type="text" name="CompanyName" value="" />&lt;br />

    Contact Name:&lt;br />

&lt;input type="text" name="ContactName" value="" />&lt;br />&lt;br />

    &lt;input type="submit" value="Submit" class="submit" />

&lt;/form>
}
} 

&lt;/body> 

&lt;/html>
<a href="showfile_c.asp?filename=try_webpages_cs_009">Run example </a>



<h2>Razor Example - Displaying Images</h2>
Suppose you have 3 images in your image folder, and you want to display images dynamically by the users choice.

This is easily done by a little Razor code. 

If you have an image called "Photo1.jpg" in your images folder on your web site, you can display the image using an HTML &lt;img> element like this:

&lt;img src="images/Photo1.jpg" alt="Sample" />
The example below shows how to display a selected picture which the user selects from a drop-down list:  


<h3>Razor Example</h3>


@{

var imagePath=""; 

if (Request["Choice"] != null)

   {imagePath="images/" + Request["Choice"];} 

} 
&lt;!DOCTYPE html> 

&lt;html> 

&lt;body> 

&lt;h1>Display Images&lt;/h1> 

&lt;form method="post" action=""> 

I want to see: 

&lt;select name="Choice"> 

     
&lt;option value="Photo1.jpg">Photo 1&lt;/option> 

     
&lt;option value="Photo2.jpg">Photo 2&lt;/option> 

     
&lt;option value="Photo3.jpg">Photo 3&lt;/option> 

&lt;/select> 

&lt;input type="submit" value="Submit" /> 

    @if (imagePath != "")

{
&lt;p>
&lt;img src="@imagePath" alt="Sample" />
&lt;/p>
}  

&lt;/form> 

&lt;/body> 

&lt;/html>

<a href="showfile_c.asp?filename=try_webpages_cs_010">Run example </a>


<h2>Example explained</h2>
The server creates a variable called <b>imagePath</b>.

The HTML page has a <b>drop-down list</b> (a &lt;select> element) named <b>Choice</b>. 
It lets the user select a friendly name (like <b>Photo 1</b>), and passes a file 
name (like <b>Photo1.jpg</b>) when the page is submitted to the web server.

The Razor code reads the value of Choice by <b>Request["Choice"]</b>. If it has a value the 
code constructs a path to the image images/Photo1.jpg, and stores it in the 
variable <b>imagePath</b>.

In the HTML page there is an &lt;img>
element to display the image. The src attribute is set to the value of the imagePath 
variable when the page displays.

The &lt;img> element is in an if block to 
prevent trying to display an image with no name (like the first time the page is 
displayed).



<h2><span class="orange"> ASP.NET Web Pages - Objects</span></h2>


<h2>The Page Object</h2>
You have already seen some Page Object methods in use:

    @RenderPage("header.cshtml")

@RenderBody()

In the previous chapter you saw two Page Object properties being used (IsPost, and 
Request):

    If (IsPost) {

if (Request["Choice"] != null) {


<h2>Some Page Object Methods</h2>
<table class="ws-table-all notranslate" style="width: 100%">
<tr><th style="width:20%">Method</th><th>Description</th></tr>
<tr><td>href</td><td>Builds a URL using the specified parameters</td></tr>
<tr><td>RenderBody()</td><td>Renders the portion of a content page that is not within a named section (In layout pages)</td></tr>
<tr><td>RenderPage(<em>page</em>)</td><td>Renders the content of one page within another page</td></tr>
<tr><td>RenderSection(<em>section</em>)</td><td>Renders the content of a named section (In layout pages)</td></tr>
<tr><td>Write(<em>object</em>)</td><td>Writes the object as an HTML-encoded string</td></tr>
<tr><td>WriteLiteral</td><td>Writes an object without HTML-encoding it first.</td></tr>
</table>


<h2>Some Page Object Properties</h2>
<table class="ws-table-all notranslate" style="width: 100%">
<tr><th style="width:20%">Property</th><th>Description</th></tr>
<tr><td>IsPost</td><td>Returns true if the HTTP data transfer method used by the client is a POST request</td></tr>
<tr><td>Layout</td><td>Gets or sets the path of a layout page</td></tr>
<tr><td>Page</td><td>Provides property-like access to data shared between pages and layout pages </td></tr>
<tr><td>Request</td><td>Gets the HttpRequest object for the current HTTP request</td></tr>
<tr><td>Server</td><td>Gets the HttpServerUtility object that provides web-page processing methods</td></tr>
</table>

<h2>The Page Property (of the Page Object)</h2>
The Page property of the Page Object, provides property-like access to data shared between pages and layout pages.

You can use (add) your own properties to the Page property:


Page.Title
  Page.Version
  Page.anythingyoulike



The pages property is very helpful. For instance, it makes it possible to set the page title in content files, and use it in the layout file:


<h3>Home.cshtml</h3>
    @{
Layout="~/Shared/Layout.cshtml";
Page.Title="Home Page"
}


    &lt;h1>Welcome to W3Schools&lt;/h1> 

&lt;h2>Web Site Main Ingredients&lt;/h2>

&lt;p>A Home Page (Default.cshtml)&lt;/p>
&lt;p>A Layout File (Layout.cshtml)&lt;/p>

    &lt;p>A Style Sheet (Site.css)&lt;/p>


<h3>Layout.cshtml</h3>
    &lt;!DOCTYPE html>
&lt;html>
&lt;head>
&lt;title>@Page.Title&lt;/title>
&lt;/head>
&lt;body>
@RenderBody()

    &lt;/body>

    &lt;/html>



 id="mypagediv2" style="position:relative;text-align:center;">



<h2><span class="orange"> ASP.NET Web Pages - Files</span></h2>


<h2>Working with Text Files</h2>
Sometimes you will want to access data stored in text files.

Text files used to store data is often called flat files.

Common flat file formats are .txt, .xml, and .csv (comma-delimited values). 

<strong>In this chapter you will learn:</strong>


How to read and display data from a text file


<h2>Add a Text File Manually</h2>
In the example to follow, you will need a text file to work with.

On your web site, if you don't have an App_Data folder, create one.

In the App_Data folder, create a new file named Persons.txt.

Add the following content to the file: 


<h3>Persons.txt</h3>
George,Lucas

Steven,Spielberg

Alfred,Hitchcock



<h2>Displaying Data from a Text File</h2>
The example below shows how to display data from a text file:  


<h3>Example</h3>

    @{
var dataFile = Server.MapPath("~/App_Data/Persons.txt");

    Array userData = File.ReadAllLines(dataFile);
}

&lt;!DOCTYPE 
    html>
&lt;html>
&lt;body>

&lt;h1>Reading Data from a File&lt;/h1>
@foreach (string dataLine in userData) 
{
  foreach 
    (string dataItem in dataLine.Split(',')) 
  {@dataItem &lt;text>&amp;nbsp;&lt;/text>}
  
    &lt;br />
}
&lt;/body>
&lt;/html>

<a href="showfile_c.asp?filename=try_webpages_cs_019">Run example </a>


<h2>Example explained</h2>
<strong>Server.MapPath</strong> finds the exact text file path.

<strong>File.ReadAllLines</strong> opens the text file and reads all lines from the file into an array.

For each <strong>dataItem</strong> in each <strong>dataline</strong> of the array the data is displayed.


<h2>Displaying Data from an Excel File</h2>
With Microsoft Excel, you can save a spreadsheet as a comma separated text file (.csv file). When you do so, each row in the spreadsheet is saved as a text line, and each data column is separated by a comma. 

You can use the example above to read an Excel .csv file (just change the file name to the name of the Excel file).



<h2><span class="orange"> ASP.NET Web Pages - Databases</span></h2>


<h2>What We Will Do</h2>
In this chapter we will:


Create a web page to list data from a database


<h2>Displaying Data from Database</h2>

With Web Pages, you can easily display data from a database.

You can connect to an existing database, or create a new database from scratch.

In this example we will connect to an existing SQL Server Compact database.


<h2>Adding a Customers Page</h2>
In the "DemoWebPages" folder, create a new CSHTML file named "Products.cshtml".


Replace the code in the file with the code from the example below:


<h3>Products.cshtml</h3>
@{

var db = Database.Open("SmallBakery"); 

var selectQueryString = "SELECT * FROM Product ORDER BY Name"; 

}

&lt;html> 

&lt;body> 

&lt;h1>Small Bakery Products&lt;/h1> 

&lt;table> 

&lt;tr>

&lt;th>Id&lt;/th> 

&lt;th>Product&lt;/th> 

&lt;th>Description&lt;/th> 

&lt;th>Price&lt;/th> 

&lt;/tr>
@foreach(var row in db.Query(selectQueryString))

{

&lt;tr> 

&lt;td>@row.Id&lt;/td> 

&lt;td>@row.Name&lt;/td> 

&lt;td>@row.Description&lt;/td> 

&lt;td align="right">@row.Price&lt;/td> 

&lt;/tr> 
}

&lt;/table> 

&lt;/body> 

    &lt;/html>
<a href="showfile_c.asp?filename=try_webpages_cs_003">Run example </a>


<h2>Example Explained</h2>

The Database.Open(<em>name</em>) method will connect to a database in two steps:

First, it searches the application's App_Data folder for a database that matches the <em>name</em> parameter without the file-name extension.

If no file is found, it looks for a "connection string" in the application's Web.config file.

(A connection string contains information about how to connect to a database. It can include a file path, or the name of an SQL database, with full user name and password)


This two-step search makes it possible to test the application with a local database, and run the application on a web host using a connection string. 



<h2>ASP.NET Database Object Reference</h2>


<table class="ws-table-all notranslate">
<tr><th style="width:50%">Method</th>
<th>Description</th></tr>
<tr><td>Database.Execute(<em>SQLstatement [</em>,
<em>parameters])</em>
</td><td>Executes <em> SQLstatement</em> (with optional parameters) such as INSERT, DELETE, or UPDATE and returns a count of affected records.</td></tr>
<tr><td>Database.GetLastInsertId()</td><td> Returns the identity column from the most recently inserted row.</td></tr>
<tr><td>Database.Open(<em>filename</em>) 

Database.Open(<em>connectionStringName</em>)</td><td>
Opens either the specified database file or the 
database specified using a named connection string 
from the <em>Web.config</em> file.</td></tr>
<tr><td>Database.OpenConnectionString(<em>connectionString</em>)</td><td>
Opens a database using the connection string. (This 
contrasts with Database.Open, which 
uses a connection string name.)</td></tr>
<tr><td>Database.Query(<em>SQLstatement[, 
parameters]</em>)</td><td>Queries the database 
using <em>SQLstatement</em> (optionally passing 
parameters) and returns the results as a collection.
</td></tr>
<tr><td>Database.QuerySingle(<em>SQLstatement</em>
<em>[, parameters]</em>)</td><td>Executes <em>
SQLstatement</em> (with optional parameters) and 
returns a single record.</td></tr>
<tr><td>Database.QueryValue(<em>SQLstatement</em>
<em>[, parameters]</em>)</td><td>Executes <em>
SQLstatement</em> (with optional parameters) and 
returns a single value.</td></tr>
</table>



<h2><span class="orange"> ASP.NET Web Pages - Helpers</span></h2>
programming tasks.


<h2>ASP.NET Helpers</h2>
ASP.NET helpers are components that can be accessed by single lines of 
Razor code.

You can build your own helpers using Razor syntax stored as .cshtml files, or 
use built-in ASP.NET helpers.

You will learn how to use Razor helpers in the next chapters of this 
tutorial.

Below is a short description of some useful Razor helpers:


<h2>The WebGrid Helper</h2>
The WebGrid helper simplifies the way to display data:


Automatically sets up an HTML table to display data
  Supports different options for formatting
  Supports paging (First, next, previous, last) through data
  Supports sorting by clicking on column headings


<h2>The Chart Helper</h2>
The "Chart Helper" can display chart images of different types with 
many formatting options and labels.


<img border="0" alt="chart" src="pic_chart06.jpg" width="249" height="179"><img border="0" alt="chart" src="pic_chart07.jpg" width="249" height="179">


The Chart helper can display data from arrays , from databases, or from files.



<h2>The WebMail Helper</h2>
The WebMail helper provides functions for sending email messages using SMTP 
(Simple Mail Transfer Protocol).


<h2>The WebImage Helper</h2>
The WebImage helper provides functionality to manage images in a web page.

Keywords: flip, rotate, resize, watermark.



<h2>Third Party Helpers</h2>
With Razor you can take advantage of built-in or third party helpers to 
simplify the use of email, databases, multimedia, and social networks as well as 
many other issues like navigation and web security.




<h2>Analytics (Google)</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th style="width:50%">Description</th></tr>
<tr><td>Analytics.GetGoogleHtml(<em>webPropertyId</em>)</td><td>
Renders the Google Analytics JavaScript code for the 
specified ID.</td></tr>
<tr><td>Analytics.GetStatCounterHtml(<em>project</em>,
<em>security</em>)</td><td>Renders the StatCounter 
Analytics JavaScript code for the specified project.</td></tr>
<tr><td>Analytics.GetYahooHtml(<em>account</em>)</td><td>
Renders the Yahoo Analytics JavaScript code for the 
specified account.</td></tr>
</table>

<h2>Bing</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Bing.SearchBox(<em>[boxWidth]</em>)</td><td>
Passes a search to Bing. To specify the site to 
search and a title for the search box, you can set 
the Bing.SiteUrl and Bing.SiteTitle properties. Normally you set 
these properties in the <em>_AppStart</em> page. 
</td></tr>
<tr><td>Bing.AdvancedSearchBox(<em>[, boxWidth] [, 
resultWidth] [, resultHeight] 

  [, themeColor] [, locale]</em>)</td><td>Displays 
Bing search results in the page with optional 
formatting. To specify the site to search and a 
title for the search box, you can set the Bing.SiteUrl and Bing.SiteTitle 
properties. Normally you set these properties in the
<em>_AppStart</em> page. 
</td></tr>
</table>

<h2>Crypto</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Crypto.Hash(<em>string [, algorithm]</em>)


Crypto.Hash(<em>bytes [, algorithm]</em>)</td><td>
Returns a hash for the specified data. The default 
algorithm is sha256.</td></tr>
</table>

<h2>Facebook</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Facebook.LikeButton(<em>href [, 
buttonLayout] [, showFaces] [, width] [, height] 

[, action] [, font] [, colorScheme] [, refLabel]</em>)</td><td>
Lets Facebook users make a connection to pages.</td></tr>
</table>

<h2>FileUpload</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>FileUpload.GetHtml(<em>[initialNumberOfFiles] 
[</em>, <em>allowMoreFilesToBeAdded] 

  [</em>, <em>includeFormTag] [, addText] [</em>,
<em>uploadText]</em>)</td><td>Renders UI for 
uploading files.</td></tr>
</table>

<h2>GamerCard</h2>
<table class="ws-table-all notranslate">
<tr><th width="50%">Helper</th>
<th>Description</th></tr>
<tr><td>GamerCard.GetHtml(<em>gamerTag</em>)</td><td>
Renders the specified Xbox gamer tag.</td></tr>
</table>

<h2>Gravatar Object Reference</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Gravatar.GetHtml(<em>email [, imageSize] 
[, defaultImage] [, rating] 

  [, imageExtension] [, attributes]</em>)</td><td>
Renders the Gravatar image for the specified email 
address.</td></tr>
</table>

<h2>Json</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Json.Encode(<em>object</em>)</td><td>
Converts a data object to a string in the JavaScript 
Object Notation (JSON) format. 
</td></tr>
<tr><td>Json.Decode(<em>string</em>)</td><td>
Converts a JSON-encoded input string to a data 
object that you can iterate over or insert into a 
database.</td></tr>
</table>

<h2>LinkShare</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>LinkShare.GetHtml(<em>pageTitle [, 
pageLinkBack] [, twitterUserName] 

  [, additionalTweetText] [, linkSites]</em>)</td><td>
Renders social networking links using the specified 
title and optional URL.</td></tr>
</table>

<h2>ModelState</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>ModelStateDictionary.AddError(<em>key</em>,
<em>errorMessage</em>)</td><td>Associates an error 
message with a form field. Use the ModelState 
helper to access this member. 
</td></tr>
<tr><td>ModelStateDictionary.AddFormError(<em>errorMessage</em>)</td><td>
Associates an error message with a form. Use the ModelState helper to access this 
member. 
</td></tr>
<tr><td>ModelStateDictionary.IsValid</td><td>
Returns true if there are no validation errors. Use 
the ModelState helper to access this 
member. 
</td></tr>
</table>

<h2>ObjectInfo</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>ObjectInfo.Print(<em>value [, depth] [, 
enumerationLength]</em>)</td><td>Renders the 
properties and values of an object and any child 
objects. 
</td></tr>
</table>

<h2>Recaptcha</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Recaptcha.GetHtml(<em>[, publicKey] [, 
theme] [, language] [, tabIndex]</em>)</td><td>
Renders the reCAPTCHA verification test.</td></tr>
<tr><td>ReCaptcha.PublicKey 

ReCaptcha.PrivateKey</td><td>Sets public and 
private keys for the reCAPTCHA service. Normally you 
set these properties in the <em>_AppStart</em> page.</td></tr>
<tr><td>ReCaptcha.Validate(<em>[, privateKey]</em>)</td><td>
Returns the result of the reCAPTCHA test.</td></tr>
<tr></tr>
</table>

<h2>ServerInfo</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>ServerInfo.GetHtml()</td><td>Renders 
status information about ASP.NET Web Pages.</td></tr>
</table>

<h2>Twitter</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Twitter.Profile(<em>twitterUserName</em>)</td><td>
Renders a Twitter stream for the specified user.</td></tr>
<tr><td>Twitter.Search(<em>searchQuery</em>)</td><td>
Renders a Twitter stream for the specified search 
text.</td></tr>
</table>

<h2>Video</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Video.Flash(<em>filename [, width, height]</em>)</td><td>
Renders a Flash video player for the specified file 
with optional width and height.</td></tr>
<tr><td>Video.MediaPlayer(<em>filename [, width, 
height]</em>)</td><td>Renders a Windows Media 
player for the specified file with optional width 
and height.</td></tr>
<tr><td>Video.Silverlight(<em>filename</em>, <em>
width</em>, <em>height</em>)</td><td>Renders a 
Silverlight player for the specified <em>.xap</em> 
file with required width and height.</td></tr>
</table>

<h2>WebCache</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>WebCache.Get(<em>key</em>)</td><td>
Returns the object specified by <em>key</em>, or 
null if the object is not found.</td></tr>
<tr><td>WebCache.Remove(<em>key</em>)</td><td>
Removes the object specified by <em>key</em> from 
the cache.</td></tr>
<tr><td>WebCache.Set(<em>key</em>, <em>value [, 
minutesToCache] [, slidingExpiration]</em>)</td><td>
Puts <em>value</em> into the cache under the name 
specified by <em>key</em>.</td></tr>
</table>

<h2>WebImage</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>WebImage(<em>path</em>)</td><td>Loads an 
image from the specified path.</td></tr>
<tr><td>WebImage.AddImagesWatermark(<em>image</em>)</td><td>
Adds the specified image as a watermark.</td></tr>
<tr><td>WebImage.AddTextWatermark(<em>text</em>)</td><td>
Adds the specified text to the image.</td></tr>
<tr><td>WebImage.FlipHorizontal() 

WebImage.FlipVertical()</td><td>Flips the image 
horizontally or vertically.</td></tr>
<tr><td>WebImage.GetImageFromRequest()</td><td>
Loads an image when an image is posted to a page 
during a file upload.</td></tr>
<tr><td>WebImage.Resize(<em>width</em>,<em> height</em>)</td><td>
Resizes the image.</td></tr>
<tr><td>WebImage.RotateLeft() 

WebImage.RotateRight()</td><td>Rotates the image to 
the left or the right.</td></tr>
<tr><td>WebImage.Save(<em>path [, imageFormat]</em>)</td><td>
Saves the image to the specified path.</td></tr>
</table>

<h2><span class="orange"> ASP.NET Web Pages - The WebGrid Helper</span></h2>

<h2>Doing the HTML Yourself</h2>
In a previous chapter, you displayed database data by using razor code,  
and doing the HTML markup yourself: 


<h3>Database Example</h3>
@{

var db = Database.Open("SmallBakery"); 

var selectQueryString = "SELECT * FROM Product ORDER BY Name"; 

}

&lt;html> 

&lt;body> 

&lt;h1>Small Bakery Products&lt;/h1> 

&lt;table> 

&lt;tr>

&lt;th>Id&lt;/th> 

&lt;th>Product&lt;/th> 

&lt;th>Description&lt;/th> 

&lt;th>Price&lt;/th> 

&lt;/tr>
@foreach(var row in db.Query(selectQueryString))

{

&lt;tr> 

&lt;td>@row.Id&lt;/td> 

&lt;td>@row.Name&lt;/td> 

&lt;td>@row.Description&lt;/td> 

&lt;td style="text-align:right">@row.Price&lt;/td> 

&lt;/tr> 
}

&lt;/table> 

&lt;/body> 

&lt;/html>
<a href="showfile_c.asp?filename=try_webpages_cs_003">Run example </a>



<h2>Using The WebGrid Helper</h2>
Using the WebGrid helper is an easier way to display data.

The WebGrid helper:


Automatically sets up an HTML table to display data
  Supports different options for formatting
  Supports paging through data
  Supports Sorting by clicking on column headings

<h3>WebGrid Example</h3>
@{ 

var db = Database.Open("SmallBakery") ; 

var selectQueryString = "SELECT * FROM Product ORDER BY Name"; 

var data = db.Query(selectQueryString); 

var grid = new WebGrid(data); 

}

&lt;html> 

&lt;head> 

&lt;title>Displaying Data Using the WebGrid Helper&lt;/title> 

&lt;/head> 

&lt;body> 

&lt;h1>Small Bakery Products&lt;/h1> 

&lt;div id="grid"> 
@grid.GetHtml()

&lt;/div> 

&lt;/body> 

&lt;/html>
<a href="showfile_c.asp?filename=try_webpages_cs_004">Run example </a>


<h2>WebGrid Object Reference</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>WebGrid(<em>data</em>)</td><td>Creates a 
new WebGrid object using data from a 
query.</td></tr>
<tr><td>WebGrid.GetHtml()</td><td>Renders markup 
to display data in an HTML table.</td></tr>
<tr><td>WebGrid.Pager()</td><td>Renders a pager 
for the WebGrid object.</td></tr>
</table>

<h2><span class="orange"> ASP.NET Web Pages - The Chart Helper</span></h2>

<h2>The Chart Helper</h2>
In the previous chapters, you learned how to use an ASP.NET "Helper".

You learned how to display data in a grid using the "WebGrid Helper". 

This chapter explains how to display data in graphical form, using the "Chart 
Helper".

The "Chart Helper" can create chart images of different types with many 
formatting options and labels. It can create standard charts like area charts, 
bar charts, column charts, line charts, and pie charts, along with more 
specialized charts like stock charts.


<img border="0" alt="chart" src="pic_chart06.jpg" width="249" height="179"><img border="0" alt="chart" src="pic_chart07.jpg" width="249" height="179">


The data you display in a chart can be from an array, from a database, or from data in a file.



<h2>Chart From an Array</h2>

The example below shows the code needed to display a chart from an array of values:


<h3>Example</h3>
@{ 

var myChart = new Chart(width: 600, height: 400) 

  
.AddTitle("Employees") 

  
.AddSeries(chartType: "column",

      xValue: new[] {  "Peter", "Andrew", "Julie", "Mary", "Dave" }, 

      yValues: new[] { "2", "6", "4", "5", "3" }) 

  
.Write();

}

<a href="showfile_c.asp?filename=try_webpages_cs_005">Run example </a>

- <b>new Chart</b> creates a new chart object and sets its width and height

- the <b>AddTitle</b> method 
specifies the chart title

- the <b>AddSeries</b> method adds data to the chart

- the <b>chartType</b> parameter defines the type of chart

- the <b>xValue</b> parameter defines x-axis names

- the <b>yValues</b> parameter defines the y-axis values

- the <b>Write()</b> method displays the chart 




<h2>Chart From Database Data</h2>
You can run a database query and then use data from the results to create a 
chart:


<h3>Example</h3>
@{ 

var db = Database.Open("SmallBakery"); 

var dbdata = db.Query("SELECT Name, Price FROM Product"); 

var myChart = new Chart(width: 600, height: 400) 

   .AddTitle("Product Sales") 

   .DataBindTable(dataSource: dbdata, xField: "Name")

   .Write();

}

<a href="showfile_c.asp?filename=try_webpages_cs_006">Run example </a>

- <b>var db = Database.Open</b> opens the database (and assigns the database 
object to the variable db)

- <b>var dbdata = db.Query</b> runs a database query and stores the result in 
dbdata

- <b>new Chart</b> creates a chart new object and sets its width and height

- the <b>AddTitle</b> method 
specifies the chart title

- the <b>DataBindTable</b> method binds the data source to the chart

- the <b>Write()</b> method displays the chart 


An alternative to using the DataBindTable method is to use AddSeries (See 
previous example). DataBindTable is easier to use, but AddSeries is more flexible because you 
can specify the chart and data more explicitly:


<h3>Example</h3>
@{ 

var db = Database.Open("SmallBakery"); 

var dbdata = db.Query("SELECT Name, Price FROM Product"); 

var myChart = new Chart(width: 600, height: 400) 

   .AddTitle("Product Sales") 

   .AddSeries(chartType:"Pie",

      xValue: dbdata, xField: "Name",

      yValues: dbdata, yFields: "Price")

   .Write();

}

<a href="showfile_c.asp?filename=try_webpages_cs_007">Run example </a>


<h2>Chart From XML Data</h2>
<font size="3">
The third option for charting is to use an XML file as the data for the 
chart:

</font>

<h3>Example</h3>

@using System.Data;


@{

var dataSet = new DataSet();

dataSet.ReadXmlSchema(Server.MapPath("data.xsd"));

dataSet.ReadXml(Server.MapPath("data.xml"));

var dataView = new DataView(dataSet.Tables[0]);

var myChart = new Chart(width: 600, height: 400)

  
.AddTitle("Sales Per Employee")

  
.AddSeries("Default", chartType: "Pie",

     
xValue: dataView, xField: "Name",

     
yValues: dataView, yFields: "Sales")

  
.Write();}

}

<a href="showfile_c.asp?filename=try_webpages_cs_008">Run example </a>


<h2>Chart Object Reference</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:50%">Helper</th>
<th>Description</th></tr>
<tr><td>Chart(<em>width</em>, <em>height [, 
template] [, templatePath]</em>)</td><td>
Initializes a chart.</td></tr>
<tr><td>Chart.AddLegend(<em>[title] [, name]</em>)</td><td>
Adds a legend to a chart.</td></tr>
<tr><td>Chart.AddSeries(<em>[name] [, chartType] 
[, chartArea] 

  [, axisLabel] [, legend] [, markerStep] [, xValue]


  [, xField] [, yValues] [, yFields] [, options])</em>
</td><td>
Adds a series of values to the chart.</td></tr>
</table>

<h2><span class="orange"> ASP.NET Web Pages - The WebMail Helper</span></h2>

With the WebMail object you can easily send emails from a web page.


<h2>The WebMail Helper</h2>
The WebMail Helper makes it easy to send an email from a web application 
using SMTP (Simple Mail transfer Protocol).



<h2>
Scenario: Email Support</h2>

To demonstrate the use of email, we will create an input page for support, let 
the user submit the page to another page, and send an email about the support 
problem.


<h2>
First: Edit Your AppStart Page </h2>

If you have built the Demo application in this tutorial, you already have a page 
called _AppStart.cshtml with the following content:


<h3>_AppStart.cshtml</h3>
@{
WebSecurity.InitializeDatabaseConnection("Users", "UserProfile", "UserId", 
"Email", true);
}




To initiate the WebMail helper, add the the following 
WebMail properties to your AppStart page:


<h3>_AppStart.cshtml</h3>
@{
WebSecurity.InitializeDatabaseConnection("Users", "UserProfile", "UserId", 
"Email", true);
WebMail.SmtpServer = "smtp.example.com";
WebMail.SmtpPort = 25;

WebMail.EnableSsl = false;
WebMail.UserName = "support@example.com";

WebMail.Password = "password-goes-here";
WebMail.From = "john@example.com";
}



Properties explained:

<strong>SmtpServer:</strong> The name the SMTP server that will be used to 
send the emails.

<strong>SmtpPort:</strong> The port the server will use to send SMTP 
transactions (emails).

<strong>EnableSsl:</strong> True, if the server should use SSL (Secure Socket 
Layer) encryption.

<strong>UserName:</strong> The name of the SMTP email account used to send 
the email.

<strong>Password:</strong> The password of the SMTP email account.

<strong>From:</strong> The email to appear in the from address (often the 
same as UserName).



<h2>
Second: Create an Email Input Page</h2>

Then create an input page, and name it Email_Input:

<h3>Email_Input.cshtml</h3>
&lt;!DOCTYPE html> 
&lt;html> 
&lt;body> 
&lt;h1>Request for 
Assistance&lt;/h1> 

&lt;form method="post" action="EmailSend.cshtml"> 

&lt;label>Username:&lt;/label>
&lt;input type="text" name="customerEmail" />

&lt;label>Details about the problem:&lt;/label> 
&lt;textarea name="customerRequest" 
cols="45" rows="4">&lt;/textarea> 
&lt;p>&lt;input type="submit" value="Submit" 
/>&lt;/p> 
&lt;/form> 

&lt;/body> 
&lt;/html>



The purpose of the input page is to collect information, then 
submit the data to a new page that can send the information as an email.


<h2>
Third: Create An Email Send Page</h2>

Then create the page that will be used to send the email, and name it Email_Send:


<h3>Email_Send.cshtml</h3>
@{ // Read input

var customerEmail = Request["customerEmail"];

var customerRequest = Request["customerRequest"];

try

{

// Send email 

WebMail.Send(to:"someone@example.com", subject: "Help request from - " + customerEmail, body: 
customerRequest ); 

}

catch (Exception ex )

{

&lt;text>@ex&lt;/text>


}
}





<h2>WebMail Object Reference - Properties</h2>

<table class="ws-table-all notranslate">
<tr><th style="width:25%">Properties</th>
<th>Description</th></tr>
<tr><td>SmtpServer</td><td>The name the SMTP server that will send the emails</td></tr>
<tr><td>SmtpPort</td><td>The port the server will use to send SMTP emails</td></tr>
<tr><td>EnableSsl</td><td>True, if the server should use SSL encryption</td></tr>
<tr><td>UserName</td><td>The name of the SMTP account used to send the email</td></tr>
<tr><td>Password</td><td>The password of the SMTP account</td></tr>
<tr><td>From</td><td>The email to appear in the from address</td></tr>
</table>

<h2>WebMail Object Reference - Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Method</th>
<th>Description</th></tr>
<tr><td>Send()</td><td>Sends an email message to an SMTP server for delivery</td></tr>
</table>
The Send() method has the following parameters:

<table class="ws-table-all notranslate">
<tr><th style="width:25%">Parameter</th>
    <th style="width:25%">Type</th><th>Description</th></tr>
<tr><td>to</td><td>String</td><td>The Email recipients (separated by semicolon)</td></tr>
<tr><td>subject</td><td>String</td><td>The subject line</td></tr>
<tr><td>body</td><td>String</td><td>The body of the message</td></tr>
</table>
And the following optional parameters:

<table class="ws-table-all notranslate">
<tr><th style="width:25%">Parameter</th>
    <th style="width:25%">Type</th><th>Description</th></tr>
<tr><td>from</td><td>String</td><td>The email of the sender </td></tr>
<tr><td>cc</td><td>String</td><td>The cc emails (separated by semicolon)</td></tr>
<tr><td>filesToAttach</td><td>Collection</td><td>Filenames</td></tr>
<tr><td>isBodyHtml</td><td>Boolean</td><td>True if the email body is in HTML</td></tr>
<tr><td>additionalHeaders</td><td>Collection</td><td>Additional headers</td></tr>
</table>

<h2>Technical Data</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Name</th>
<th>Value</th></tr>
<tr><td>Class</td><td>System.Web.Helpers.WebMail</td></tr>
<tr><td>Namespace</td><td>System.Web.Helpers</td></tr>
<tr><td>Assembly</td><td>System.Web.Helpers.dll</td></tr>
</table>

<h2>Initializing the WebMail Helper</h2>
To use the WebMail helper, you need access to an SMTP server. SMTP is the 
"output" part of email. If you use a web host, you probably already know the 
name of the SMTP server. If you work in a corporate network, your IT department 
can give you the name. If you are working at home, you 
might be able to use your ordinary email provider.

 In order to send an email you will need:


The name of the SMTP server 
  The port number (most often 25) 
  An email user name
  An email password

In the root of your web, create a page (or edit the page ) named <strong>_AppStart.cshtml</strong>. 

Put the following code inside the file:


<h3>_AppStart.cshtml</h3>
    @{
WebMail.SmtpServer = "smtp.example.com";
WebMail.SmtpPort = 25;

WebMail.EnableSsl = false;
WebMail.UserName = "support@example.com";

WebMail.Password = "password";
WebMail.From = "john@example.com"
}


The code above will run each time the web site (application) starts. It 
feeds your <strong>WebMail Object</strong> with initial values.

Please substitute:

<strong>smtp.example.com</strong> with the name the SMTP server that will be used to 
send the emails.

<strong>25</strong> with the port number the server will use to send SMTP 
transactions (emails).

<strong>false</strong> with true, if the server should use SSL (Secure Socket 
Layer) encryption.

<strong>support@example.com</strong> with the name of the SMTP email account used to send 
emails.

<strong>password</strong> with the password of the SMTP email account.

<strong>john@example </strong>with the email to appear in the from address.



  You don't <strong>have to</strong> initiate the WebMail object in your AppStart 
file, but you must set these properties before you call the <strong>WebMail.Send()</strong> 
method.



<h2><span class="orange"> ASP.NET Web Pages - WebSecurity Object</span></h2>
The <strong>WebSecurity Object</strong> provides security and authentication for 
ASP.NET Web Pages applications.

With the WebSecurity object you can create user accounts, login and logout users, 
reset or change passwords, and more.


<h2>WebSecurity Object Reference - Properties</h2>

<table class="ws-table-all notranslate">
<tr><th style="width:40%">Properties</th>
<th style="width:60%">Description</th></tr>
<tr><td><a href="prop_websecurity_currentuserid.asp">CurrentUserId</a></td><td>
    Gets the ID for the current user</td></tr>
<tr><td><a href="prop_websecurity_currentusername.asp">CurrentUserName</a></td><td>Gets the name of the current user</td></tr>
<tr><td><a href="prop_websecurity_hasuserid.asp">HasUserId</a></td><td>
Returns true if the current has a user ID</td></tr>
<tr><td><a href="prop_websecurity_isauthenticated.asp">IsAuthenticated</a></td><td>
Returns true if the current user is logged in</td></tr>
</table>

<h2>WebSecurity Object Reference - Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:40%">Method</th>
<th>Description</th></tr>
<tr><td><a href="met_websecurity_changepassword.asp">ChangePassword()</a></td><td>Changes the password for a user</td></tr>
<tr><td><a href="met_websecurity_confirmaccount.asp">ConfirmAccount()</a></td><td>Confirms an account using a confirmation token</td></tr>
<tr><td><a href="met_websecurity_createaccount.asp">CreateAccount()</a></td><td>Creates a new user account</td></tr>
<tr><td><a href="met_websecurity_createuserandaccount.asp">CreateUserAndAccount()</a></td><td>Creates a new user account</td></tr>
<tr><td><a href="met_websecurity_generatepasswordresettoken.asp">GeneratePasswordResetToken()</a></td><td>Generates a token that can be sent to as user by email</td></tr>
<tr><td><a href="met_websecurity_getcreatedate.asp">GetCreateDate()</a></td><td>Gets the time the specified membership was created</td></tr>
<tr><td><a href="met_websecurity_getpasswordchangedate.asp">GetPasswordChangeDate()</a></td><td>Gets the date and time when password was changed</td></tr>
<tr><td><a href="met_websecurity_getuserid.asp">GetUserId()</a></td><td>Gets a user ID from a user name</td></tr>
<tr><td><a href="met_websecurity_initializedatabaseconnection.asp">InitializeDatabaseConnection()</a></td><td>Initializes the WebSecurity system (database)</td></tr>
<tr><td><a href="met_websecurity_isconfirmed.asp">IsConfirmed()</a></td><td>Checks if a user is confirmed</td></tr>
<tr><td><a href="met_websecurity_iscurrentuser.asp">IsCurrentUser()</a></td><td>Checks if the current user matches a user name</td></tr>
<tr><td><a href="met_websecurity_login.asp">Login()</a></td><td>Logs the user in by setting a token in the cookie</td></tr>
<tr><td><a href="met_websecurity_logout.asp">Logout()</a></td><td>Logs the user out by removing the token cookie</td></tr>
<tr><td><a href="met_websecurity_requireauthenticateduser.asp">RequireAuthenticatedUser()</a></td><td>Exits the page if the user is not an authenticated user</td></tr>
<tr><td><a href="met_websecurity_requireroles.asp">RequireRoles()</a></td><td>Exits the page if the user is not a part of the specified roles</td></tr>
<tr><td><a href="met_websecurity_requireuser.asp">RequireUser()</a></td><td>Exits the page if the user is not the specified user</td></tr>
<tr><td><a href="met_websecurity_resetpassword.asp">ResetPassword()</a></td><td>Changes a user's password using a token</td></tr>
<tr><td><a href="met_websecurity_userexists.asp">UserExists()</a></td><td>Checks if a given user exists</td></tr>
</table>


<h2>Initializing the WebSecurity Database</h2>
You must create or initialize an WebSecurity database before you can use the WebSecurity 
object in your code.

In the root of your web, create a page (or edit the page ) named <strong>_AppStart.cshtml</strong>. 

Put the following code inside the file:


<h3>_AppStart.cshtml</h3>
@{
WebSecurity.InitializeDatabaseConnection("Users", "UserProfile", 
"UserId", "Email", true);
}


The code above will run each time the web site (application) starts. It 
initializes the WebSecurity database.

<strong>"Users"</strong> is the name of the WebSecurity database (Users.sdf).

<strong>"UserProfile"</strong> is the name of the database table that 
contains the user profile information.

<strong>"UserId"</strong> is the name of the column that 
contains the user IDs (primary key). 

<strong>"Email"</strong> is the name of the column that contains 
user names.

The last parameter <strong>true</strong> is a boolean value indicating that 
the user profile and 
membership tables should be created automatically if they don't exist, otherwise
<strong>false</strong>.



  Although <strong>true</strong> indicates automatic creation of the database <strong>tables, </strong>the 
database itself 
will not be created automatically. It must exist.




<h2>The WebSecurity Database</h2>
The <strong>UserProfile</strong> table contains one record for each user, 
with a user ID (primary key) and the user's name (email):

<table class="ws-table-all notranslate">
<tr><th>UserId</th><th>Email</th></tr>
<tr><td>1</td><td>john@johnson.net</td></tr>
<tr><td>2 </td><td>peter@peterson.com</td></tr>
<tr><td>3</td><td>lars@larson.eut</td></tr>
</table>
The <strong>Membership table</strong> will contain membership information 
about when the user was created and if (and when) the membership was confirmed.

Much like this (some columns are not shown):

<table class="ws-table-all notranslate">
<tr><th>User
Id</th><th>Create
Date</th><th>Confirmation
Token</th><th>Is
Confirmed</th><th>Last
Password
Failure</th><th>Password</th><th>Password
Change</th></tr>
<tr><td>1</td><td>12.04.2012 16:12:17</td><td>NULL</td><td>True</td><td>NULL</td><td>AFNQhWfy....</td><td>12.04.2012 16:12:17</td></tr>
</table>

<h2>Simple Membership Configuration</h2>
You might get errors using the WebSecurity object, if your site is not configured to use the ASP.NET 
Web Pages membership system <strong>SimpleMembership</strong>.

This can occur if a 
hosting provider's server is configured differently than your local server. To 
fix this, add the following element to the site's Web.config file:



&lt;appSettings> 
&lt;add key="enableSimpleMembership" value="true" /> 

&lt;/appSettings>




 id="mypagediv2" style="position:relative;text-align:center;">



<h2><span class="orange"> ASP.NET Web Pages - Publishing the Website</span></h2>
1.
Use the Latest Version of ASP.NET</h2>
Before you continue, make sure your hosting computer runs the latest version 
of ASP.NET (4.0 or 4.5).


<h2>
2.
Copy the Web Folders</h2>
Copy your website (all folders and content) from your development computer to 
an application folder on your remote hosting computer (server).


  If your application contains data, <strong>don't copy the data</strong> 
(see point 4 below).




<h2>
3.
    The DLL Files</h2>
Make sure the bin folder, on your remote hosting computer, contains the same dll files as on your development computer.

After copying the bin folder, it should contain files like this:

Microsoft.Web.Infrastructure.dll

    NuGet.Core.dll

    System.Web.Helpers.dll

    System.Web.Razor.dll

    System.Web.WebPages.Administration.dll

    System.Web.WebPages.Deployment.dll

    System.Web.WebPages.dll

    System.Web.WebPages.Razor.dll

    WebMatrix.Data.dll

    WebMatrix.WebData


<h2>4. Copy Your Data</h2>
If your application contains data or a database. For instance an SQL Server Compact database (a .sdf file in App_Data 
folder), consider the following:

Do you want to publish your test data to the 
remote server?

Most likely not.

    If you have test data on your development computer, it may overwrite production data on your remote hosting computer.

If you have to copy an SQL database (.sdf file), perhaps you should delete 
everything in the database, and then copy the empty .sdf file from your development 
computer to the server. 

<strong>THAT'S IT. GOOD LUCK !</strong>


<h2><span class="orange"> ASP.NET Web Pages - Examples in C# and VB</span></h2>

<table class="ws-table-all notranslate" width="100%">
<tr><th style="font-size:120%">Examples in C#</th>
<th style="font-size:120%">Examples in VB</th></tr>
<tr><td>

<b>Basic Web Pages</b>

<a href="showfile_c.asp?filename=try_webpages_cs_001">Display Date and Time</a>
<a href="showfile_c.asp?filename=try_webpages_cs_002">Reusable Header and Footer</a>
<a href="showfile_c.asp?filename=try_webpages_cs_009">Basic HTML Form</a>


<a href="webpages_intro.asp">Examples Explained</a>

</td>
<td>

<b>Basic Web Pages</b>
<a href="showfile_vb.asp?filename=try_webpages_vb_001">Display Date and Time</a>
<a href="showfile_vb.asp?filename=try_webpages_vb_002">Reusable Header and Footer</a>
<a href="showfile_vb.asp?filename=try_webpages_vb_009">Basic HTML Form</a>


<a href="webpages_intro.asp">Examples Explained</a>

</td>
</tr>
<tr><td>

<b>Basic C#</b>

<a href="showfile_c.asp?filename=try_razor_cs_005">For Loop</a>
<a href="showfile_c.asp?filename=try_razor_cs_006">For Each Loop</a>
<a href="showfile_c.asp?filename=try_razor_cs_007">While Loop</a>
<a href="showfile_c.asp?filename=try_razor_cs_008">Array</a>

<a href="showfile_c.asp?filename=try_razor_cs_010">If Condition</a>
<a href="showfile_c.asp?filename=try_razor_cs_011">If Else Condition</a>
<a href="showfile_c.asp?filename=try_razor_cs_012">Else If Condition</a>
<a href="showfile_c.asp?filename=try_razor_cs_013">Switch Condition</a>


<a href="razor_intro.asp">Examples Explained</a>

</td>
<td>

<b>Basic VB</b>

<a href="showfile_vb.asp?filename=try_razor_vb_005">For Loop</a>
<a href="showfile_vb.asp?filename=try_razor_vb_006">For Each Loop</a>
<a href="showfile_vb.asp?filename=try_razor_vb_007">While Loop</a>
<a href="showfile_vb.asp?filename=try_razor_vb_008">Array</a>

<a href="showfile_vb.asp?filename=try_razor_vb_010">If Condition</a>
<a href="showfile_vb.asp?filename=try_razor_vb_011">If Else Condition</a>
<a href="showfile_vb.asp?filename=try_razor_vb_012">Else If Condition</a>
<a href="showfile_vb.asp?filename=try_razor_vb_013">Select Condition</a>


<a href="razor_intro.asp">Examples Explained</a>

</td></tr>
<tr><td>

<b>Working with Databases</b>

<a href="showfile_c.asp?filename=try_webpages_cs_003">Display Database Data</a>
<a href="showfile_c.asp?filename=try_webpages_cs_004">Display Data with WebGrid</a>


<a href="webpages_database.asp">Examples Explained</a>

</td>
<td>

<b>Working with Databases</b>

<a href="showfile_vb.asp?filename=try_webpages_vb_003">Display Database Data</a>
<a href="showfile_vb.asp?filename=try_webpages_vb_004">Display Data with WebGrid</a>


<a href="webpages_database.asp">Examples Explained</a>

</td>
</tr>
<tr><td>

<b>Using the Chart Helper</b>

<a href="showfile_c.asp?filename=try_webpages_cs_005">Display a Bar Chart from an Array</a>
<a href="showfile_c.asp?filename=try_webpages_cs_006">Display a Bar Chart from a Database</a>
<a href="showfile_c.asp?filename=try_webpages_cs_007">Display a Pie Chart from a Database</a>
<a href="showfile_c.asp?filename=try_webpages_cs_008">Display a Pie Chart from an XML File</a>


<a href="webpages_chart.asp">Examples Explained</a>

</td>
<td>

<b>Using the Chart Helper</b>

<a href="showfile_vb.asp?filename=try_webpages_vb_005">Display a Bar Chart from an Array</a>
<a href="showfile_vb.asp?filename=try_webpages_vb_006">Display a Bar Chart from a Database</a>
<a href="showfile_vb.asp?filename=try_webpages_vb_007">Display a Pie Chart from a Database</a>
<a href="showfile_vb.asp?filename=try_webpages_vb_008">Display a Pie Chart from an XML File</a>


<a href="webpages_chart.asp">Examples Explained</a>

</td></tr>
</table>


 id="mypagediv2" style="position:relative;text-align:center;">



<h2><span class="orange"> ASP.NET Web Pages - Classes</span></h2>
<h2>ASP.NET Classes Reference</h2>

<table class="ws-table-all notranslate">
<tr><th style="width:50%">Method</th>
<th>Description</th></tr>
<tr><td>AsBool(), AsBool(true|false)</td><td>
Converts a string value to a Boolean value 
(true/false). Returns false or the specified value 
if the string does not represent true/false.
</td></tr>
<tr><td>AsDateTime(), AsDateTime(<em>value</em>)</td><td>
Converts a string value to date/time. Returns DateTime. MinValue or the specified value if 
the string does not represent a date/time.</td></tr>
<tr><td>AsDecimal(), AsDecimal(<em>value</em>)</td><td>
Converts a string value to a decimal value. Returns 
0.0 or the specified value if the string does not 
represent a decimal value.</td></tr>
<tr><td>AsFloat(), AsFloat(<em>value</em>)</td><td>
Converts a string value to a float. Returns 0.0 or 
the specified value if the string does not represent 
a decimal value.</td></tr>
<tr><td>AsInt(), AsInt(<em>value</em>)</td><td>
Converts a string value to an integer. Returns 0 or 
the specified value if the string does not represent 
an integer.</td></tr>
<tr><td>Href(<em>path</em> <em>[, param1 [, 
param2]]</em>)</td><td>Creates a browser-compatible 
URL from a local file path, with optional additional 
path parts.</td></tr>
<tr><td>Html.Raw(<em>value</em>)</td><td>Renders
<em>value</em> as HTML markup instead of rendering 
it as HTML-encoded output.</td></tr>
<tr><td>IsBool(), IsDateTime(), IsDecimal(), 
IsFloat(), IsInt()</td><td>Returns true if the 
value can be converted from a string to the 
specified type.</td></tr>
<tr><td>IsEmpty()</td><td>Returns true if the 
object or variable has no value.</td></tr>
<tr><td>IsPost</td><td>Returns true if the 
request is a POST. (Initial requests are usually a 
GET.)</td></tr>
<tr><td>Layout</td><td>Specifies the path of a 
layout page to apply to this page.</td></tr>
<tr><td>PageData[<em>key</em>], PageData[<em>index</em>], 
Page</td><td>Contains data shared between the page, 
layout pages, and partial pages in the current 
request. You can use the dynamic Page 
property to access the same data, as in the 
following example:</td></tr>
<tr><td>RenderBody()</td><td>(Layout pages) 
Renders the content of a content page that is not in 
any named sections.</td></tr>
<tr><td>RenderPage(<em>path</em>,<em> values</em>)


RenderPage(<em>path[, param1 [, param2]]</em>)</td><td>
Renders a content page using the specified path and 
optional extra data. You can get the values of the 
extra parameters from PageData by 
position (example 1) or key (example 2).</td></tr>
<tr><td>RenderSection(<em>sectionName [, required 
= </em>true|false<em>]</em>)</td><td>(Layout pages) 
Renders a content section that has a name. Set <em>
required</em> to false to make a section optional.</td></tr>
<tr><td>Request.Cookies[<em>key</em>]</td><td>
Gets or sets the value of an HTTP cookie.</td></tr>
<tr><td>Request.Files[<em>key</em>]</td><td>Gets 
the files that were uploaded in the current request.</td></tr>
<tr><td>Request.Form[<em>key</em>]</td><td>Gets 
data that was posted in a form (as strings). 
Request[<em>key</em>] checks both the Request.Form and the Request.QueryString collections.</td></tr>
<tr><td>Request.QueryString[<em>key</em>]</td><td>
Gets data that was specified in the URL query 
string. Request[<em>key</em>] checks 
both the Request.Form and the Request.QueryString collections. 
</td></tr>
<tr><td>Request.Unvalidated(<em>key</em>) 

Request.Unvalidated().QueryString|Form|Cookies|Headers[<em>key</em>]</td><td>
Selectively disables request validation for a 
form element, query-string value, cookie, or header 
value. Request validation is enabled by default and 
prevents users from posting markup or other 
potentially dangerous content.</td></tr>
<tr><td>Response.AddHeader(<em>name</em>, <em>
value</em>)</td><td>Adds an HTTP server header to 
the response. 
</td></tr>
<tr><td>Response.OutputCache(<em>seconds</em> <em>
[, sliding] [, varyByParams]</em>)</td><td>Caches 
the page output for a specified time. Optionally set
<em>sliding</em> to reset the timeout on each page 
access and <em>varyByParams</em> to cache different 
versions of the page for each different query string 
in the page request.</td></tr>
<tr><td>Response.Redirect(<em>path</em>)</td><td>
Redirects the browser request to a new location.</td></tr>
<tr><td>Response.SetStatus(<em>httpStatusCode</em>)</td><td>
Sets the HTTP status code sent to the browser.</td></tr>
<tr><td>Response.WriteBinary(<em>data</em> <em>[, 
mimetype]</em>)</td><td>Writes the contents of <em>
data</em> to the response with an optional MIME 
type.</td></tr>
<tr><td>Response.WriteFile(<em>file</em>)</td><td>
Writes the contents of a file to the response.</td></tr>
<tr><td>@section(<em>sectionName</em>) { <em>
content</em> }</td><td>(Layout pages) Defines a 
content section that has a name.</td></tr>
<tr><td>Server.HtmlDecode(<em>htmlText</em>)</td><td>
Decodes a string that is HTML encoded.</td></tr>
<tr><td>Server.HtmlEncode(<em>text</em>)</td><td>
Encodes a string for rendering in HTML markup.</td></tr>
<tr><td>Server.MapPath(<em>virtualPath</em>)</td><td>
Returns the server physical path for the specified 
virtual path.</td></tr>
<tr><td>Server.UrlDecode(<em>urlText</em>)</td><td>
Decodes text from a URL.</td></tr>
<tr><td>Server.UrlEncode(<em>text</em>)</td><td>
Encodes text to put in a URL.</td></tr>
<tr><td>Session[<em>key</em>]</td><td>Gets or 
sets a value that exists until the user closes the 
browser.</td></tr>
<tr><td>ToString()</td><td>Displays a string 
representation of the object's value.</td></tr>
<tr><td>UrlData[<em>index</em>]</td><td>Gets 
additional data from the URL (for example, <em>
/MyPage/ExtraData</em>).</td></tr>
</table>



 id="mypagediv2" style="position:relative;text-align:center;">



      
        <!-- MainLeaderboard-->
        
        
          <script type="text/javascript">googletag.cmd.push(function() { googletag.display('div-gpt-ad-1422003450156-2'); });</script>


      
<h2><span class="orange"> ASP.NET Razor - Markup</span></h2>


<h2>What is Razor?</h2>
Razor is a markup syntax that 
lets you embed server-based code (Visual Basic and C#) into web pages.

Server-based code can create dynamic web content on the fly, while a web page 
is written to the browser. When a web page is called, the server executes the 
server-based code inside the page before it returns the page to the browser. By 
running on the server, the code can perform complex tasks, like accessing 
databases. 

Razor is based 
on ASP.NET, and designed 
for creating web applications. It has the power of traditional ASP.NET markup, 
but it is easier to use, and easier to learn.




<h2>Razor Syntax</h2>
Razor uses a syntax very similar to PHP and Classic ASP.


Razor:


    &lt;ul>
@for (int i = 0; i &lt; 10; i++) {
&lt;li>@i&lt;/li>
}
&lt;/ul>
PHP:


    &lt;ul>
&lt;?php 
for ($i = 0; $i &lt; 10; $i++) {
echo("&lt;li>$i&lt;/li>");
}
    
?>
&lt;/ul>
Classic ASP:


&lt;ul>
&lt;%for i = 0 to 10%>
&lt;li>&lt;%=i%>&lt;/li>
&lt;%next%>

&lt;/ul> 

<h2>Razor Helpers</h2>
ASP.NET helpers are components that can be accessed by single lines of 
Razor code.

You can build your own helpers using Razor syntax, or 
use built-in ASP.NET helpers.

Below is a short description of some useful Razor helpers:


Web Grid
  Web Graphics
  Google Analytics
  Facebook Integration
  Twitter 
Integration
  Sending Email
  Validation


<h2>Razor Programming Languages</h2>
Razor supports both C# (C sharp) and VB (Visual Basic).


<h2><span class="orange"> ASP.NET Razor - C# and VB Code Syntax</span></h2>


<h2>Main Razor Syntax Rules for C#</h2>

Razor code blocks are enclosed in @{ ... }
  Inline expressions (variables and functions) start with @
  Code statements end with semicolon
  Variables are declared with the var keyword
  Strings are enclosed with quotation marks
  C# code is case sensitive
  C# files have the extension .cshtml

<h3>C# Example</h3>
&lt;!-- Single statement block -->
@{ var myMessage =    "Hello World"; }


&lt;!-- Inline expression or variable -->

&lt;p>The value of myMessage is: @myMessage&lt;/p> 


&lt;!--    Multi-statement block -->
@{

var greeting = "Welcome to our site!";

var weekDay = DateTime.Now.DayOfWeek;

var greetingMessage = greeting + " Here in Huston it is: " + weekDay;

}
&lt;p>The greeting is: @greetingMessage&lt;/p>

<a href="showfile_c.asp?filename=try_razor_cs_001">    Run example </a>


<h2>Main Razor Syntax Rules for VB</h2>

Razor code blocks are enclosed in @Code ... End Code
  Inline expressions (variables and functions) start with @
  Variables are declared with the Dim keyword
  Strings are enclosed with quotation marks
  VB code is not case sensitive
  VB files have the extension .vbhtml

<h3>Example</h3>
&lt;!-- Single statement block  --> 
@Code dim myMessage = "Hello World" End Code

 

&lt;!-- Inline expression or variable --> 

&lt;p>The value of myMessage is: @myMessage&lt;/p> 

 

&lt;!-- Multi-statement block --> 
@Code

dim greeting = "Welcome to our site!" 

dim weekDay = DateTime.Now.DayOfWeek 

dim greetingMessage = greeting &amp; " Here in Huston it is: " &amp; weekDay

End Code



&lt;p>The greeting is: @greetingMessage&lt;/p>
<a href="showfile_vb.asp?filename=try_razor_vb_001">Run example </a>



<h2>How Does it Work?</h2>
Razor is a simple programming syntax for embedding server code in web pages. 

Razor syntax is based on the ASP.NET framework, the part of the Microsoft.NET Framework that's specifically designed for creating web 
applications.  

The Razor syntax gives you all the power of ASP.NET, but is using a simplified 
syntax that's easier to learn if you're a beginner, and makes you more 
productive if you're an expert. 

Razor web pages can be described as HTML pages with two kinds of content: 
HTML content and Razor code. 

When the server reads the page, it runs the Razor code first, before it sends 
the HTML page to the browser. The code that is executed on the server can 
perform tasks that cannot be done in the browser, for example accessing a server 
database. Server code can create dynamic HTML content on the fly, before it is 
sent to the browser. Seen from the browser, the HTML generated by server code is 
no different than static HTML content.

ASP.NET web pages with Razor syntax have the special file extension cshtml 
(Razor using C#) or vbhtml (Razor using VB). 


<h2>Working With Objects</h2>
Server coding often involves objects.

The "DateTime" object is a typical 
built-in ASP.NET object, but objects can also be self-defined, a web page, a text box, a file, 
a database record, etc.

Objects may have methods they can perform. A 
database record might have a "Save" method, an image object might have a 
"Rotate" method, an email object might have a "Send" method, 
and so on.

Objects 
also have properties that describe their characteristics. A database record 
might have a FirstName and a LastName property (among others). 

The ASP.NET 
DateTime object has a Now property (written as DateTime.Now), and the Now property has a 
Day property (written as DateTime.Now.Day). The example below shows how to 
access some properties of the DateTime object:



<h3>Example</h3>
&lt;table border="1">
&lt;tr>
&lt;th 
width="100px">Name&lt;/th>
&lt;td width="100px">Value&lt;/td>

&lt;/tr>
&lt;tr>
&lt;td>Day&lt;/td>&lt;td>@DateTime.Now.Day&lt;/td>

&lt;/tr>
&lt;tr>
&lt;td>Hour&lt;/td>&lt;td>@DateTime.Now.Hour&lt;/td>

&lt;/tr>
&lt;tr>
&lt;td>Minute&lt;/td>&lt;td>@DateTime.Now.Minute&lt;/td>

&lt;/tr>
&lt;tr>
&lt;td>Second&lt;/td>&lt;td>@DateTime.Now.Second&lt;/td>

&lt;/tr>
&lt;/td>
&lt;/table>
<a href="showfile_c.asp?filename=try_razor_cs_002">    Run example </a>


<h2>If and Else Conditions</h2>
An important feature of dynamic web pages is that you can determine what to 
do based on conditions.

The common way to do this is with the if ... else statements:


<h3>Example</h3>
@{
var txt = "";
if(DateTime.Now.Hour > 12)
  
{txt = "Good Evening";}
else
  {txt = "Good Morning";}
}

&lt;html>
&lt;body>
&lt;p>The message is @txt&lt;/p>

&lt;/body>
&lt;/html>


<a href="showfile_c.asp?filename=try_razor_cs_003">    Run example </a>



<h2>Reading User Input</h2>
Another important feature of dynamic web pages is that you can read user 
input.

Input is read by the Request[] function, and posting (input) is tested by the 
IsPost condition:


<h3>Example</h3>
@{
var totalMessage = "";
if(IsPost)

   
{
    var num1 = Request["text1"];

   
var num2 = Request["text2"];
    var total = num1.AsInt() + num2.AsInt();
    totalMessage = 
"Total = " + total;
    }
}
&lt;html>
&lt;body 
style="background-color: beige; font-family: Verdana, Arial;">
&lt;form 
action="" method="post">
&lt;p>&lt;label for="text1">First Number:&lt;/label>&lt;br>

&lt;input type="text" name="text1" />&lt;/p>
&lt;p>&lt;label for="text2">Second 
Number:&lt;/label>&lt;br>
&lt;input type="text" name="text2" />&lt;/p>
&lt;p>&lt;input 
type="submit" value=" Add " />&lt;/p>
&lt;/form>
&lt;p>@totalMessage&lt;/p>

&lt;/body>
&lt;/html>
<a href="showfile_c.asp?filename=try_razor_cs_004">Run example </a>


<h2><span class="orange"> ASP.NET Razor - C# Variables</span></h2>


<h2>Variables</h2>
Variables are used to store data.

The name of a variable must begin with an alphabetic character and 
cannot contain whitespace or reserved characters. 

A variable can be of a 
specific type, indicating the kind of data it stores. String variables store 
string values ("Welcome to W3Schools"), integer variables store number values 
(103), date variables store date values, etc.

Variables are declared 
using the var keyword, or by using the type (if you want to declare the type), 
but ASP.NET can usually determine data types automatically.


<h3>Examples</h3>
    // 
    Using the var keyword:
var greeting = "Welcome to W3Schools";
var 
    counter = 103;
var today = DateTime.Today;

// Using data types:

    string greeting = "Welcome to W3Schools";
int counter = 103;
DateTime 
    today = DateTime.Today;



<h2>Data Types</h2>

Below is a list of  common data types:


<table class="ws-table-all notranslate" style="width: 100%">
<tr><th>Type</th>
<th>Description</th>
<th>Examples</th></tr>
<tr><td>int</td><td>Integer (whole numbers)</td><td>103, 12, 5168</td></tr>
<tr><td>float</td><td>Floating-point number</td><td>3.14, 3.4e38</td></tr>
<tr><td>decimal</td><td>Decimal number (higher precision)</td><td>1037.196543</td></tr>
<tr><td>bool</td><td>Boolean</td><td>true, false</td></tr>
<tr><td>string</td><td>String</td><td>"Hello W3Schools", "John"</td></tr>
</table>


<h2>Operators</h2>
An operator tells ASP.NET what kind of command to perform in an expression.

 The C# language supports many operators. Below is a list of common operators:


<table class="ws-table-all notranslate" style="width: 100%">
<tr><th>Operator</th>
<th>Description</th>
<th>Example</th></tr>
<tr><td>=</td><td>Assigns a value to a variable.</td><td>i=6</td></tr>
<tr><td>+
-
*
/

</td><td>Adds a value or variable.
Subtracts a value or variable.
Multiplies a 
value or variable.
Divides a value or variable.</td><td>i=5+5
i=5-5
i=5*5
i=5/5</td></tr>
<tr><td>+=
-=</td><td>Increments a variable.
Decrements a variable.</td><td>i += 1
i -= 1</td></tr>
<tr><td>==</td><td>Equality. Returns true if values are equal.</td><td>if (i==10)</td></tr>
<tr><td>!=</td><td>Inequality. Returns true if values are not equal.</td><td>if (i!=10) </td></tr>
<tr><td>&lt;
>
&lt;=
>=</td><td>Less than.
Greater than.
Less than or equal.
Greater than or equal.</td><td>if (i&lt;10)
if (i>10)
if (i&lt;=10)
if (i>=10)</td></tr>
<tr><td>+</td><td>Adding strings (concatenation).</td><td>"w3" + "schools"</td></tr>
<tr><td>.</td><td>Dot. Separate objects and methods.</td><td>DateTime.Hour</td></tr>
<tr><td>()</td><td>Parenthesis. Groups values.</td><td>(i+5)</td></tr>
<tr><td>()</td><td>Parenthesis. Passes parameters.</td><td>x=Add(i,5)</td></tr>
<tr><td>[]</td><td>Brackets. Accesses values in arrays or collections.</td><td>name[3]</td></tr>
<tr><td>!</td><td>Not. Reverses true or false.</td><td>if (!ready)</td></tr>
<tr><td>&amp;&amp;
||</td><td>Logical AND.
Logical OR.</td><td>if (ready &amp;&amp; clear)
if (ready || clear)</td></tr>
</table>

<h2>Converting Data Types</h2>

Converting from one data type to another is sometimes useful.

The most 
common example is to convert string input to another type, such as an integer or 
a date.

As a rule, user input comes as strings, even if the user entered a number. 
Therefore, numeric input values must be converted to numbers before they can be 
used in calculations.

Below is a list of common conversion methods:


<table class="ws-table-all notranslate" style="width: 100%">
<tr><th>Method</th>
<th>Description</th>
<th>Example</th></tr>
<tr><td>AsInt()
IsInt()</td><td>Converts a string to an integer.</td><td>if (myString.IsInt())
  {myInt=myString.AsInt();}</td></tr>
<tr><td>AsFloat()
IsFloat()</td><td>Converts a string to a floating-point number.</td><td>if (myString.IsFloat())
  {myFloat=myString.AsFloat();}</td></tr>
<tr><td>AsDecimal()
IsDecimal()</td><td>Converts a string to a decimal number.</td><td>if (myString.IsDecimal())
  {myDec=myString.AsDecimal();}</td></tr>
<tr><td>AsDateTime()
IsDateTime()</td><td>Converts a string to an ASP.NET DateTime type.</td><td>myString="10/10/2012";
myDate=myString.AsDateTime();</td></tr>
<tr><td>AsBool()
IsBool()</td><td>Converts a string to a Boolean.</td><td>myString="True";
myBool=myString.AsBool();</td></tr>
<tr><td>ToString()</td><td>Converts any data type to a string.</td><td>myInt=1234;
myString=myInt.ToString();</td></tr>
</table>

<h2><span class="orange"> ASP.NET Razor - C# Loops and Arrays</span></h2>


<h2>For Loops</h2>
If you need to run the same statements repeatedly, you can program a loop.

If you know how many times you want to loop, you can use a <strong>for loop</strong>. This 
kind of loop is especially useful for counting up or counting down:


<h3>Example</h3>
&lt;html>
&lt;body>
@for(var i = 10; i &lt; 21; i++)
    {&lt;p>Line @i&lt;/p>}
&lt;/body>
&lt;/html>

<a href="showfile_c.asp?filename=try_razor_cs_005">Run example </a>


<h2>For Each Loops</h2>

If you work with a collection or an array, you often use a <strong>for each loop</strong>.

A collection is a group of similar objects, and the for each loop lets 
you carry out a task on each item. The for each loop walks through a 
collection until it is finished.

The example below walks through the ASP.NET Request.ServerVariables 
collection.


<h3>Example</h3>
&lt;html>
&lt;body>
&lt;ul>
@foreach (var x in 
Request.ServerVariables)
    {&lt;li>@x&lt;/li>}
&lt;/ul>

&lt;/body>
&lt;/html>
<a href="showfile_c.asp?filename=try_razor_cs_006">Run example </a>



<h2>While Loops</h2>

The <strong>while loop</strong> is a general purpose loop. 

A while loop begins with the while keyword, followed by parentheses, where you 
specify how long the loop continues, then a block to repeat.

While loops typically add to, or subtract from, a 
variable used for counting.

In the example below, the += operator adds 1 to the variable i, each time the 
loop runs.


<h3>Example</h3>
&lt;html>
&lt;body>
@{
var i = 0;
while (i &lt; 5)
    
{
    i += 1;
    &lt;p>Line @i&lt;/p>
    
}
}
&lt;/body>
&lt;/html>
<a href="showfile_c.asp?filename=try_razor_cs_007">Run example </a>


<h2>Arrays</h2>

An array is useful when you want to store similar variables but don't want to 
create a separate variable for each of them:


<h3>Example</h3>
    @{
string[] members = {"Jani", "Hege", "Kai", 
    "Jim"};
int i = Array.IndexOf(members, "Kai")+1;
int len = 
    members.Length;
string x = members[2-1];
}
&lt;html>
&lt;body>
&lt;h3>Members&lt;/h3>
@foreach (var person in 
    members)
{
&lt;p>@person&lt;/p>
}
&lt;p>The number of names 
    in Members are @len&lt;/p>
&lt;p>The person at 
    position 2 is @x&lt;/p>
&lt;p>Kai is now in 
    position @i&lt;/p>
&lt;/body>
&lt;/html>
<a href="showfile_c.asp?filename=try_razor_cs_008">Run example </a>


<h2><span class="orange"> ASP.NET Razor - C# Logic Conditions</span></h2>


<h2>The If Condition</h2>
C# lets you execute code based on conditions.

To test a condition you use an <strong>if statement</strong>. The if 
statement returns true or false, based on your test:


The if statement starts a code block
  The condition is written inside parenthesis
  The code inside the braces is executed if the test is true

<h3>Example</h3>
    @{var 
    price=50;}
&lt;html>
&lt;body>
@if (price>30)
    {
    &lt;p>The price is too high.&lt;/p>
    
    }
&lt;/body>
&lt;/html>

<a href="showfile_c.asp?filename=try_razor_cs_010">Run example </a>


<h2>The Else Condition</h2>

An if statement can include an <strong>else condition</strong>.

The else condition defines the code to be executed if the condition is false.


<h3>Example</h3>
    @{var 
    price=20;}
&lt;html>
&lt;body>
@if (price>30)
  {

      &lt;p>The price is too high.&lt;/p>

      }
else
  {
  &lt;p>The price is OK.&lt;/p>
  } 
&lt;/body>
&lt;/html>
<a href="showfile_c.asp?filename=try_razor_cs_011">Run example </a>

<strong>Note:</strong> In the example above, if the first condition is true, it will be executed. 
The else condition covers "everything else".



<h2>The Else If Condition</h2>

Multiple conditions can be tested with an <strong>else if condition</strong>: 


<h3>Example</h3>
    @{var 
    price=25;}
&lt;html>
&lt;body>
@if (price>=30)

  {
  &lt;p>The price is 
    high.&lt;/p>

      
    }
else if (price>20 &amp;&amp; price&lt;30) 

      {
  &lt;p>The price is OK.&lt;/p>
  }

    else

      {
  &lt;p>The price is low.&lt;/p>
  }    
&lt;/body>
&lt;/html>
<a href="showfile_c.asp?filename=try_razor_cs_012">Run example </a>

In the example above, if the first condition is true, it will be executed.

If not, then if the next condition is true, this condition will be executed.

You can have any number of else if conditions.

If none of the if and else if conditions are true, the last else block 
(without a condition) covers "everything else".


<h2>Switch Conditions</h2>

A <strong>switch block</strong> can be used to test a number of individual conditions:


<h3>Example</h3>
    
    
    @{
var weekday=DateTime.Now.DayOfWeek;
var day=weekday.ToString();
var message="";
}
&lt;html>
&lt;body>

    @switch(day)
{
case "Monday":
    
    message="This is the first weekday.";
    break;
case 
    "Thursday":
    message="Only one day before weekend.";
    
    break;
case "Friday":
    message="Tomorrow is 
    weekend!";
    break;
default:
    
    message="Today is " + day;
    break;
}
&lt;p>@message&lt;/p>
&lt;/body>
&lt;/html>
<a href="showfile_c.asp?filename=try_razor_cs_013">Run example </a>


The test value (day) is in parentheses. Each individual test condition has a case 
value that ends with a colon, and any number of code lines ending with a break 
statement. If the test value matches the case value, the code lines are 
executed. 



A switch block can have a default case (default:) for  
"everything else" that runs if none of the cases are true.



<h2><span class="orange"> ASP.NET Razor - VB Variables</span></h2>


<h2>Variables</h2>
Variables are used to store data.

The name of a variable must begin with an alphabetic character and 
cannot contain whitespace or reserved characters. 

A variable can be of a 
specific type, indicating the kind of data it stores. String variables store 
string values ("Welcome to W3Schools"), integer variables store number values 
(103), date variables store date values, etc.

Variables are declared 
using the Dim keyword, or by using the type (if you want to declare the type), 
but ASP.NET can usually determine data types automatically.


<h3>Examples</h3>
    // 
    Using the Dim keyword:
Dim greeting = "Welcome to W3Schools"

    Dim counter = 103
Dim today = DateTime.Today

// Using data types:

    Dim greeting As String = "Welcome to W3Schools"
Dim counter As Integer = 
    103
Dim today As DateTime = DateTime.Today



<h2>Data Types</h2>

Below is a list of  common data types:


<table class="ws-table-all notranslate" style="width: 100%">
<tr><th>Type</th>
<th>Description</th>
<th>Examples</th></tr>
<tr><td>integer</td><td>Integer (whole numbers)</td><td>103, 12, 5168</td></tr>
<tr><td>double</td><td>64 bit floating-point number</td><td>3.14, 3.4e38</td></tr>
<tr><td>decimal</td><td>Decimal number (higher precision)</td><td>1037.196543</td></tr>
<tr><td>boolean</td><td>Boolean</td><td>true, false</td></tr>
<tr><td>string</td><td>String</td><td>"Hello W3Schools", "John"</td></tr>
</table>


<h2>Operators</h2>
An operator tells ASP.NET what kind of command to perform in an expression.

 The VB language supports many operators. Below is a list of common operators:


<table class="ws-table-all notranslate" style="width: 100%">
<tr><th>Operator</th>
<th>Description</th>
<th>Example</th></tr>
<tr><td>=</td><td>Assigns a value to a variable.</td><td>i=6</td></tr>
<tr><td>+
-
*
/

</td><td>Adds a value or variable.
Subtracts a value or variable.
Multiplies a 
value or variable.
Divides a value or variable.</td><td>i=5+5
i=5-5
i=5*5
i=5/5</td></tr>
<tr><td>+=
-=</td><td>Increments a variable.
Decrements a variable.</td><td>i += 1
i -= 1</td></tr>
<tr><td>=</td><td>Equality. Returns true if values are equal.</td><td>if i=10</td></tr>
<tr><td>&lt;></td><td>Inequality. Returns true if values are not equal.</td><td>if &lt;>10 </td></tr>
<tr><td>&lt;
>
&lt;=
>=</td><td>Less than.
Greater than.
Less than or equal.
Greater than or equal.</td><td>if i&lt;10
if i>10
if i&lt;=10
if i>=10</td></tr>
<tr><td>&amp;</td><td>Adding strings (concatenation).</td><td>"w3" &amp; "schools"</td></tr>
<tr><td>.</td><td>Dot. Separate objects and methods.</td><td>DateTime.Hour</td></tr>
<tr><td>()</td><td>Parenthesis. Groups values.</td><td>(i+5)</td></tr>
<tr><td>()</td><td>Parenthesis. Passes parameters.</td><td>x=Add(i,5)</td></tr>
<tr><td>()</td><td>Parenthesis. Accesses values in arrays or collections.</td><td>name(3)</td></tr>
<tr><td>Not</td><td>Not. Reverses true or false.</td><td>if Not ready</td></tr>
<tr><td>And
OR</td><td>Logical AND.
Logical OR.</td><td>if ready And clear
if ready Or clear</td></tr>
<tr><td>AndAlso
orElse</td><td>Extended Logical AND.
Extended Logical OR.</td><td>if ready AndAlso clear
if ready OrElse clear</td></tr>
</table>

<h2>Converting Data Types</h2>

Converting from one data type to another is sometimes useful.

The most 
common example is to convert string input to another type, such as an integer or 
a date.

As a rule, user input comes as strings, even if the user entered a number. 
Therefore, numeric input values must be converted to numbers before they can be 
used in calculations.

Below is a list of common conversion methods:


<table class="ws-table-all notranslate" style="width: 100%">
<tr><th>Method</th>
<th>Decryptions</th>
<th>Example</th></tr>
<tr><td>AsInt()
IsInt()</td><td>Converts a string to an integer.</td><td>if myString.IsInt() then
   myInt=myString.AsInt()
end if</td></tr>
<tr><td>AsFloat()
IsFloat()</td><td>Converts a string to a floating-point number.</td><td>if myString.IsFloat() then
   myFloat=myString.AsFloat()
end 
if</td></tr>
<tr><td>AsDecimal()
IsDecimal()</td><td>Converts a string to a decimal number.</td><td>if myString.IsDecimal() then
   myDec=myString.AsDecimal()

end if</td></tr>
<tr><td>AsDateTime()
IsDateTime()</td><td>Converts a string to an ASP.NET DateTime type.</td><td>myString="10/10/2012"
myDate=myString.AsDateTime()</td></tr>
<tr><td>AsBool()
IsBool()</td><td>Converts a string to a Boolean.</td><td>myString="True"
myBool=myString.AsBool()</td></tr>
<tr><td>ToString()</td><td>Converts any data type to a string.</td><td>myInt=1234
myString=myInt.ToString()</td></tr>
</table>

<h2><span class="orange"> ASP.NET Razor - VB Loops and Arrays</span></h2>


<h2>For Loops</h2>
If you need to run the same statements repeatedly, you can program a loop.

If you know how many times you want to loop, you can use a <strong>for loop</strong>. This 
kind of loop is especially useful for counting up or counting down:


<h3>Example</h3>
&lt;html>
&lt;body>
@For i=10 To 21
    
    @&lt;p>Line #@i&lt;/p>
Next i
&lt;/body>
&lt;/html>

<a href="showfile_vb.asp?filename=try_razor_vb_005">Run example </a>


<h2>For Each Loops</h2>

If you work with a collection or an array, you often use a <strong>for each loop</strong>.

A collection is a group of similar objects, and the for each loop lets 
you carry out a task on each item. The for each loop walks through a 
collection until it is finished.

The example below walks through the ASP.NET Request.ServerVariables 
collection.


<h3>Example</h3>
&lt;html>
&lt;body>
&lt;ul>
@For Each x 
    In Request.ServerVariables
    @&lt;li>@x&lt;/li>
Next x
&lt;/ul>

&lt;/body>
&lt;/html>
<a href="showfile_vb.asp?filename=try_razor_vb_006">Run example </a>



<h2>While Loops</h2>

The <strong>while loop</strong> is a general purpose loop. 

A while loop begins with the while keyword, followed by parentheses, where you 
specify how long the loop continues, then a block to repeat.

While loops typically add to, or subtract from, a 
variable used for counting.

In the example below, the += operator adds 1 to the variable i, each time the 
loop runs.


<h3>Example</h3>
&lt;html>
&lt;body>
@Code
Dim i=0
Do While 
    i&lt;5
    i += 1
    @&lt;p>Line #@i&lt;/p>
Loop

    End Code
&lt;/body>
&lt;/html>
<a href="showfile_vb.asp?filename=try_razor_vb_007">Run example </a>


<h2>Arrays</h2>

An array is useful when you want to store similar variables but don't want to 
create a separate variable for each of them:


<h3>Example</h3>
    @Code
Dim members As String()={"Jani","Hege","Kai","Jim"}
i=Array.IndexOf(members,"Kai")+1
len=members.Length
x=members(2-1)

    end Code
&lt;html>
&lt;body>
&lt;h3>Members&lt;/h3>
@For Each person In members
   @&lt;p>@person&lt;/p>

    Next person
&lt;p>The number of names 
    in Members are @len&lt;/p>
&lt;p>The person at 
    position 2 is @x&lt;/p>
&lt;p>Kai is now in 
    position @i&lt;/p>
&lt;/body>
&lt;/html>
<a href="showfile_vb.asp?filename=try_razor_vb_008">Run example </a>


<h2><span class="orange"> ASP.NET Razor - VB Logic Conditions</span></h2>


<h2>The If Condition</h2>
VB lets you execute code based on conditions.

To test a condition you use the <strong>if statement</strong>. The if 
statement returns true or false, based on your test:


The if statement starts a code block
  The condition is written between if and then
  The code between if ... then and end if is executed if the test is true

<h3>Example</h3>
    @Code
Dim 
    price=50
End Code
&lt;html>
&lt;body>
@If price>30 
    Then
    @&lt;p>The price is too high.&lt;/p>
End 
    If
&lt;/body>
&lt;/html>

<a href="showfile_vb.asp?filename=try_razor_vb_010">Run example </a>


<h2>The Else Condition</h2>

An if statement can include an <strong>else condition</strong>.

The else condition defines the code to be executed if the condition is false.


<h3>Example</h3>
    @Code
Dim 
    price=20
End Code
&lt;html>
&lt;body>
@if price>30 then
    @&lt;p>The price is too high.&lt;/p>

    Else
    @&lt;p>The price is OK.&lt;/p>
End If 
&lt;/body>
&lt;/html>
<a href="showfile_vb.asp?filename=try_razor_vb_011">Run example </a>

<strong>Note:</strong> In the example above, if the first condition is true, it will be executed. 
The else condition covers "everything else".



<h2>The ElseIf Condition</h2>

Multiple conditions can be tested with an <strong>else if condition</strong>: 


<h3>Example</h3>
    @Code
Dim 
    price=25
End Code
&lt;html>
&lt;body>
@If price>=30 Then
    @&lt;p>The price is 
    high.&lt;/p>
ElseIf price>20 And price&lt;30 then 

        @&lt;p>The price is OK.&lt;/p>
Else
    
    @&lt;p>The price is low.&lt;/p>
End If    
&lt;/body>
&lt;/html>
<a href="showfile_vb.asp?filename=try_razor_vb_012">Run example </a>

In the example above, if the first condition is true, it will be executed.

If not, then if the next condition is true, this condition will be executed.

You can have any number of else if conditions.

If none of the if or else if conditions are true, the last else block 
(without a condition) covers "everything else".


<h2>Select Conditions</h2>

A <strong>select block</strong> can be used to test a number of individual conditions:


<h3>Example</h3>
    
    
    @Code
Dim weekday=DateTime.Now.DayOfWeek
Dim day=weekday.ToString()
Dim message=""
End Code
&lt;html>
&lt;body>

    @Select Case day
Case "Monday"
    message="This is the first 
    weekday."
Case "Thursday"
    message="Only one day before weekend."

    Case "Friday"
    message="Tomorrow is weekend!"
Case Else
    
    message="Today is " &amp; day
End Select
&lt;p>@message&lt;/p>
&lt;/body>
&lt;/html>
<a href="showfile_vb.asp?filename=try_razor_vb_013">Run example </a>


"Select Case" is followed by the test value (day). Each individual test condition has a case 
value, and any number of code lines. If the test value matches the case value, the code lines 
are 
executed. 



A select block can have a default case (Case Else) for  
"everything else" that runs if none of the other cases are true.



<h2><span class="orange"> ASP Tutorial</span></h2>
ASP is an old (but still powerful) tool for making dynamic Web pages.

ASP is a technology (much like PHP) for executing scripts on a web server.

In this tutorial you will learn all you need to know about ASP.




<h2>Easy Learning with "Show Example"</h2>
This ASP tutorial contains hundreds of examples.

Our "Show Example" tool makes it easy to learn ASP, because it shows ASP  
code with parallel HTML output.

<h3>Example</h3>
&lt;!DOCTYPE html>
&lt;html>

&lt;body>
&lt;%

response.write("My first ASP script!")

%>

&lt;/body>

&lt;/html>

<a href="showasp.asp?filename=demo_intro">Show Example </a>

<b>Click on the "Show Example" button to see how it works!</b>


<h2>What is ASP?</h2>

ASP stands for <b>A</b>ctive <b>S</b>erver <b>P</b>ages 
ASP is a Microsoft Technology
ASP is a program that runs inside a web server


<h2>What is an ASP File?</h2>

An ASP file has the file extension ".asp"
 An ASP file is just the same as an HTML file 
An ASP file can contain server scripts in addition to HTML 
Server scripts in an ASP file are executed on the server 



<h2>What can ASP do for you?</h2>

Edit, change, add content, or customize any web page
  Respond to user queries or data submitted from HTML forms
  Access databases or other server data and return results to a browser
  Provide web security since ASP code cannot be viewed in a browser
  Offer simplicity and speed


<h2>How Does it Work?</h2>
When a browser requests a normal HTML file, the server just returns the file.

When a browser requests an ASP file, the server passes the request to the ASP engine 
which reads the ASP file and executes the server scripts in the file.

Finally the ASP file is returned to the browser as plain HTML.


<h2>ASP References</h2>
At W3Schools you will find complete ASP references about built-in objects and 
components, and their properties and methods.

<a href="asp_ref_response.asp">ASP References</a>


<h2>ASP Examples</h2>
Learn by 100 examples! Because ASP scripts are executed on the server, you
can not view ASP code in a browser, you will only see the output from ASP which
is plain HTML. At W3Schools every example displays the hidden ASP code. This
will make it easier for you to understand how it works.

 <a href="asp_examples.asp">ASP Examples!</a>



<h2><span class="orange"> ASP Syntax</span></h2>
This makes it easier for you to understand how 
ASP works.


<h2>ASP Uses VBScript</h2>
<strong>The default scripting language in ASP is VBScript.</strong>

A scripting language is a lightweight programming language.

VBScript is a light version of Microsoft's Visual Basic.


<h2>ASP Files</h2>
ASP files can be ordinary HTML files. In addition, ASP files can also contain server scripts.

Scripts surrounded by &lt;% and %> are executed on the server.


The <strong>Response.Write()</strong> method is used by ASP to write output to HTML.

The following example writes "Hello World" into HTML:


<h3>Example</h3>
    &lt;!DOCTYPE html>
&lt;html>

&lt;body>
&lt;%

    Response.Write("Hello World!")

%>

&lt;/body>

&lt;/html>

<a href="showasp.asp?filename=demo_text">Show Example </a>



  VBScript is case insensitive. Response.Write() can be written as response.write().




<h2>Using JavaScript in ASP</h2>
To set JavaScript as the scripting language for a web page you must insert a language specification at the top of the page:


<h3>Example</h3>

&lt;%@ language="javascript"%>

&lt;!DOCTYPE html>
&lt;html>

&lt;body>
&lt;%

Response.Write("Hello World!")

%>

&lt;/body>

&lt;/html>




  This tutorial uses the VBScript scripting language.




<h2>More Examples</h2>
There is an easy shortcut to Response.Write(). You can use an equal sign (=) 
instead. 

The following example also writes "Hello World" into HTML:


<h3>Example</h3>
&lt;!DOCTYPE html>
&lt;html>

&lt;body>
&lt;%

="Hello World!"

%>

&lt;/body>

&lt;/html>

<a href="showasp.asp?filename=demo_text_sh">Show Example </a>


HTML tags can be a part of the output:


<h3>Example</h3>

&lt;!DOCTYPE html>
&lt;html>

&lt;body>
&lt;%

 Response.Write("&lt;h2>You can use HTML tags to format the text!&lt;/h2>")
%>

&lt;/body>

&lt;/html>

<a href="showasp.asp?filename=demo_syntax_tags">Show Example </a>


HTML attributes can be a part of the output:


<h3>Example</h3>

&lt;!DOCTYPE html>
&lt;html>

&lt;body>
&lt;%

 Response.Write("&lt;p style='color:#0000ff'>This text is styled.&lt;/p>")
%>

&lt;/body>

&lt;/html>

<a href="showasp.asp?filename=demo_syntax_colors">Show Example </a>





<h2>VBScript Examples</h2>
This tutorial contains a lot of VBScript examples.

<a href="asp_examples.asp">VBScript Examples</a>


<h2>VBScript Reference</h2>
This tutorial has complete VBScript reference.

<a href="asp_ref_vbscript_functions.asp">VBScript Reference</a>





<h2><span class="orange"> ASP Variables</span></h2>

<h2>More Examples</h2>

<a href="showasp.asp?filename=demo_variable">Declare a variable</a>

This example demonstrates how to declare a variable, assign a value to it, and use the value in a text.


<a href="showasp.asp?filename=demo_array">Create an array</a>

Arrays are used to store a series of related data items. This example demonstrates how to 
create an array that stores names.


<a href="showasp.asp?filename=demo_fornext2">Loop through the HTML headings</a>

How to loop through the six headings in HTML.


<a href="showasp.asp?filename=demo_vbtime">Time-based greeting using VBScript</a>

This example will display a different message to the user depending on the time on the server.


<a href="showasp.asp?filename=demo_jstime">Time-based greeting using JavaScript</a>

This example is the same as the one above, but the syntax is different.


<a href="showasp.asp?filename=demo_vb_variable">Create and change a variable</a>

How to create a variable, assign a value to it, and then change the value of it.


<a href="showasp.asp?filename=demo_vb_variable2">Insert a variable value in a text</a>

How to insert a variable value in a text.


<h2>Do You Remember Algebra from School?</h2>
Do you remember algebra from school? x=5, y=6, z=x+y

Do you remember that a letter (like x) could be used to hold a value (like 5), and that you could use the information above to calculate the value of z to be 11?

These letters are called <b>variables</b>, and variables can be used to hold values (x=5) or expressions (z=x+y).


<h2>VBScript Variables</h2>
As with algebra, VBScript variables are used to hold values or expressions.

A variable can have a short name, like x, or a more descriptive name, like carname.

Rules for VBScript variable names:


Must begin with a letter 
  Cannot contain a period (.)
  Cannot exceed 255 characters

In VBScript, all variables are of type <i>variant</i>, that can store different types of data.



<h2>Declaring (Creating) VBScript Variables</h2>
Creating variables in VBScript is most often referred to as "declaring" variables.

You can declare VBScript variables with the Dim, Public or the Private statement. Like this:



Dim x

Dim carname
Now you have created two variables. The name of the variables are "x" and "carname".

You can also declare variables by using its name in a script. Like this:


carname="Volvo"
Now you have also created a variable. The name of the variable is "carname". However, this method is not a good practice, because you can misspell the variable name later
in your script, and that can cause strange results when your script is running.

 If you misspell for example the "carname" variable to "carnime", 
the script will automatically create a new variable called "carnime".  To prevent your script from doing this, you can use the Option Explicit statement.
This statement forces you to declare all your variables with the dim, public or 
private statement.

 Put the Option Explicit statement on the top of your script. Like this:



Option Explicit

Dim carname

carname=some value
<h2>Assigning Values to Variables</h2>
You assign a value to a variable like this:
 


carname="Volvo"

x=10
The variable name is on the left side of the expression and the value you want to
assign to the variable is on the right. Now the variable "carname" has
the value of "Volvo", and the variable "x" has the value of "10".
 

<h2>VBScript Array Variables</h2>
An array variable is used to store multiple values in a single variable.



In the following example, an array containing
3 elements is declared:



Dim names(2)
The number shown in the parentheses is 2. We start at zero so this array contains 3 elements. This is a fixed-size array.
You assign data to each of the elements of the array like this:



names(0)="Tove"

names(1)="Jani"

names(2)="Stale"


Similarly, the data can be retrieved from any element using the index of the particular array element you want.
Like this:


mother=names(0)
You can have up to 60 dimensions in an array. Multiple dimensions are declared by separating
the numbers in the parentheses with commas. Here we have a two-dimensional array consisting of 5 rows and 7 columns:



Dim table(4,6)
Assign data to a two-dimensional array:


<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

Dim x(2,2)

x(0,0)="Volvo"

x(0,1)="BMW"

x(0,2)="Ford"

x(1,0)="Apple"

x(1,1)="Orange"

x(1,2)="Banana"

x(2,0)="Coke"

x(2,1)="Pepsi"

x(2,2)="Sprite"

for i=0 to 2

   
    response.write("&lt;p>")

   
for j=0 to 2

       
    response.write(x(i,j) &amp; "&lt;br />")

   
next

   
    response.write("&lt;/p>")

next

%>


&lt;/body>

&lt;/html>
<a href="showasp.asp?filename=demo_vb_array_2">Show Example </a>


<h2>The Lifetime of Variables </h2>
A variable declared outside a procedure can be accessed and changed by any script in the ASP file. 

A variable declared inside a procedure is created and destroyed every time the procedure is executed. No scripts outside the procedure can access or change the variable. 

To declare variables accessible to more than one ASP file, declare them as session variables or application variables.


<h3>Session Variables</h3>
Session variables are used to store information about ONE single user, and are available to all pages in one application. Typically information stored in session variables are name, id, and preferences.


<h3>Application Variables </h3>
Application variables are also available to all pages in one application. Application variables are used to store information about ALL users in one specific application.


<h2><span class="orange"> ASP Procedures</span></h2>

<h2>Procedures </h2>
The ASP source code can contain procedures and functions: 


<h3>Example</h3>
    &lt;!DOCTYPE html>
&lt;html>

&lt;head>

&lt;%

sub vbproc(num1,num2)

response.write(num1*num2)

end sub

%>

&lt;/head>

&lt;body>


&lt;p>Result: &lt;%call vbproc(3,4)%>&lt;/p>


&lt;/body>

&lt;/html>

<a href="showasp.asp?filename=demo_vbproc">Show Example </a>


Insert the &lt;%@ language="<i>language</i>" %> line above the
&lt;html> tag to write the procedure/function in another scripting language: 


<h3>Example</h3>
&lt;%@ language="javascript" %>

&lt;!DOCTYPE html>
&lt;html>

&lt;head>

&lt;%

function jsproc(num1,num2)

{

Response.Write(num1*num2)

}

%>

&lt;/head>

&lt;body>


&lt;p>Result: &lt;%jsproc(3,4)%>&lt;/p>


&lt;/body>

&lt;/html>

<a href="showasp.asp?filename=demo_jsproc">Show Example </a>



<h2>Differences Between VBScript and JavaScript</h2>
When calling a VBScript or a JavaScript procedure from an ASP file written in VBScript, you can use the
"call" keyword followed by the procedure name. If a procedure requires
parameters, the parameter list must be enclosed in parentheses when using the
"call" keyword. If you omit the "call" keyword, the
parameter list must not be enclosed in parentheses. If the procedure has no
parameters, the parentheses are optional.

When calling a JavaScript or a VBScript procedure from an ASP file written in JavaScript,
always use parentheses after the procedure name.


<h2>VBScript Procedures</h2>
VBScript has two kinds procedures:


Sub procedure
  Function procedure


<h2>VBScript Sub Procedures</h2>
A Sub procedure:


is a series of statements, enclosed by the Sub and End Sub statements
  can perform actions, but <b> does not return</b> a value
  can take arguments


Sub mysub()

 
<i>some statements</i>

End Subor


Sub mysub(argument1,argument2)

  
 <i>some statements</i>

End Sub
<h3>Example</h3>
Sub mysub()

  response.write("I was written by a sub procedure")

End Sub

<a href="showasp.asp?filename=demo_vb_subex">Show Example </a>


<h2>VBScript Function Procedures</h2>
A Function procedure:


is a series of statements, enclosed by the Function and End Function statements
  can perform actions and <b>can return</b> a value
  can take arguments that are passed to it by a calling procedure
  without arguments, must include an empty set of parentheses ()
  returns a value by assigning a value to its name


Function myfunction()

 
 <i>some statements</i>

  
 myfunction=<i>some value</i>

End Functionor


Function myfunction(argument1,argument2)

  
 <i>some statements</i>

  
 myfunction=<i>some value</i>

End Function
<h3>Example</h3>
function myfunction()

   myfunction=Date()

end function
<a href="showasp.asp?filename=demo_vb_functionex">Show Example </a>


<h2>Calling a Procedure</h2>
This simple function procedures is called to calculate the sum of two arguments:


<h3>Example</h3>
Function myfunction(a,b)

myfunction=a+b

End Function



    response.write(myfunction(5,9))
<a href="showasp.asp?filename=demo_vb_proc_calc">Show Example </a>


The function "myfunction" will return the sum of argument "a" and argument 
"b". In this case 14.


When you call a procedure you can use the Call statement, like this:


Call MyProc(argument)
Or, you can omit the Call statement, like this:



MyProc argument
<h2>More Examples</h2>
<a href="showasp.asp?filename=demo_vbproc2">Call procedures using VBScript</a>

How to call both a JavaScript procedure and a VBScript procedure in an ASP file.


<h2><span class="orange"> VBScript Conditional Statements</span></h2>
Conditional statements are used to perform different actions for different decisions.

In VBScript we have four conditional statements:



<b>If statement</b> - executes a set of code when a condition is true
  
<b>If...Then...Else statement</b>  - select one of two sets of lines to execute
  
<b>If...Then...ElseIf statement</b>  - select one of many sets of lines to execute
  
<b>Select Case statement</b> - select one of many sets of lines to execute


<h2>If...Then...Else</h2>
Use the If...Then...Else statement if you want to


execute some code if a condition is true
  select one of two blocks of code to execute


If you want to execute only <b> one</b> statement when a condition is true, you can write the code on one line:


If i=10 Then response.write("Hello")
There is no ..Else.. in this syntax. You just tell the code to
perform <b>one action</b> if a condition is true (in this case If i=10).



If you want to execute <b> more than one</b> statement when a condition is true,
you must put each statement on separate lines, and end the statement with the
keyword "End If":




If i=10 Then

    response.write("Hello")

   i = i+1

End If
There is no ..Else.. in the example above either. You just tell the code to perform <b> multiple actions</b> if the condition is true.

If you want to execute a statement if a condition is true and execute another statement if the condition is not true, you must add the "Else"
keyword:



<h3>Example</h3>
i=hour(time)

If i &lt; 10 Then

    response.write("Good morning!")

Else

    response.write("Have a nice day!")

End If
<a href="showasp.asp?filename=demo_vb_ifthen">Show Example </a>



In the example above, the first block of code will be executed if the condition is true, and the other block
will be executed otherwise (if i is greater than 10).




<h2>If...Then...ElseIf</h2>
You can use the If...Then...ElseIf statement if you want to select one of many blocks of
code to execute:


<h3>Example</h3>
i=hour(time)

If i = 10 Then

    response.write("Just started...!")

ElseIf i = 11 Then

    response.write("Hungry!")

ElseIf i = 12 Then

    response.write("Ah, lunch-time!")

ElseIf i = 16 Then

    response.write("Time to go home!")

Else

    response.write("Unknown")

End If
<a href="showasp.asp?filename=demo_vb_elseif">Show Example </a>


<h2>Select Case</h2>
You can also use the "Select Case" statement if you want to select one of many blocks of
code to execute:


<h3>Example</h3>
d=weekday(date)
Select Case d

 
Case 1

   
    response.write("Sleepy Sunday")

 
Case 2

   
    response.write("Monday again!")

 
Case 3

   
    response.write("Just Tuesday!")

 
Case 4

   
    response.write("Wednesday!")

 
Case 5

   
    response.write("Thursday...")

 
Case 6

   
    response.write("Finally Friday!")

 
Case else

   
    response.write("Super Saturday!!!!")

End Select
<a href="showasp.asp?filename=demo_vb_selectcase">Show Example </a>


This is how it works: First we have a single expression (most often a
variable), that is evaluated once. The value of the expression is then compared with the
values for each Case in the structure. If there is a match, the block of code
associated with that Case is executed.


<h2><span class="orange"> VBScript Looping</span></h2>
Looping statements are used to run the same block of code a specified number of times.

In VBScript we have four looping statements:



<b>For...Next statement </b>- runs code a specified number of times

<b>For Each...Next statement </b>- runs code for each item in a collection or each element of an array

<b>Do...Loop statement </b>- loops while or until a condition is true

<b>While...Wend statement </b>- Do not use it - use the Do...Loop statement instead


<h2>For...Next Loop</h2>
Use the <b>For...Next</b> statement to run a block of code a specified number of times.



The <b>For</b> statement specifies the counter variable (<b>i</b>), and its start and end
values. The <b> Next</b> statement increases the counter variable (<b>i</b>) by one.


<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

For i = 0 To 5

  response.write("The number is " &amp; i &amp; "&lt;br />")

Next

%>


&lt;/body>

&lt;/html>
<a href="showasp.asp?filename=demo_vb_fornext">Show Example </a>


<h3>The Step Keyword</h3>
With the <b> Step</b> keyword, you can increase or decrease the counter variable by the value you specify.

In the example below, the counter variable (<b>i</b>) is INCREASED by two, each time the loop repeats.



For i=2 To 10 Step 2

  some code

Next

To decrease the counter variable, you must use a negative <b> Step</b> value. You must specify an end value that is less than the start value.

In the example below, the counter variable (<b>i</b>) is DECREASED by two, each time the loop repeats.



For i=10 To 2 Step -2

  some code

Next


<h3>Exit a For...Next</h3>
You can exit a For...Next statement with the Exit For keyword.



For i=1 To 10

  If i=5 Then Exit For

  some code

Next



<h2>For Each...Next Loop</h2>
A <b>For Each...Next</b> loop repeats a block of code for each item in a collection, or for each element of an array.


<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

Dim cars(2)

cars(0)="Volvo"

cars(1)="Saab"

cars(2)="BMW"


For Each x In cars

  response.write(x &amp; "&lt;br />")

Next

%>


&lt;/body>

&lt;/html>
<a href="showasp.asp?filename=demo_vb_foreach">Show Example </a>


<h2>Do...Loop</h2>

If you don't know how many repetitions you want, use a Do...Loop statement.


The Do...Loop statement repeats a block of code while a condition is
true, or until a condition becomes true.



<h3>Repeat Code While a Condition is True</h3>

You use the While keyword to check a condition in a Do...Loop statement.



Do While i>10

  some code

Loop

If <b> i</b> equals 9, the code inside the loop above will never be executed.


Do

  some code

Loop While i>10


The code inside this loop will be executed at least one time, even if <b> i</b> is less than 10.



<h3>Repeat Code Until a Condition Becomes True</h3>

You use the Until keyword to check a condition in a Do...Loop statement.



Do Until i=10

  some code

Loop


If <b> i</b> equals 10, the code inside the loop will never be executed.



Do

  some code

Loop Until i=10

The code inside this loop will be executed at least one time, even if <b> i</b> is equal to 10.


<h3>Exit a Do...Loop</h3>

You can exit a Do...Loop statement with the Exit Do keyword.



Do Until i=10

  i=i-1

  If i&lt;10 Then Exit Do

Loop


The code inside this loop will be executed as long as <b> i</b> is different
from 10, and as long as <b> i</b> is greater than 10.



<h2>More Examples</h2>

<a href="showasp.asp?filename=demo_vb_fornext2">Looping through headers</a>

How to loop through the six headings in html.



<a href="showasp.asp?filename=demo_vb_dowhile">Do...While loop</a>

How to make a simple <b>Do...While</b> loop.



<h2><span class="orange"> ASP Forms and User Input</span></h2>

<h2>More Examples</h2>
<a href="showasphtmfile.asp?filename=demo_reqquery">A form with method="get"</a>

How to interact with the user, with the Request.QueryString command.


<a href="showasp.asp?filename=demo_simpleform">A form with method="post"</a>

How to interact with the user, with the Request.Form command.


<a href="showasp.asp?filename=demo_radiob">A form with radio buttons</a>

How to interact with the user, through radio buttons, with the Request.Form command.


<h2>User Input </h2>
The Request object can be used to retrieve user information from forms.


User input can be retrieved with the Request.QueryString or Request.Form command. 


<h2>Request.QueryString</h2>
The Request.QueryString command is used to collect values in a form with method="get".

Information sent from a form with the GET method is visible to everyone (it will be displayed in the browser's address bar)
and has limits on the amount of information to send.


<h3>Example HTML form</h3>


&lt;form method="get" action="simpleform.asp">

First Name: &lt;input type="text" name="fname">&lt;br>

Last Name: &lt;input type="text" name="lname">&lt;br>&lt;br>

&lt;input type="submit" value="Submit">

&lt;/form>
If a user typed "Bill" and "Gates" in the HTML form above, the URL sent to the server would look like this:


https://www.w3schools.com/simpleform.asp?fname=Bill&amp;lname=Gates
Assume that "simpleform.asp" contains the following ASP script:



&lt;body>

Welcome

&lt;%

response.write(request.querystring("fname"))

response.write(" " &amp; request.querystring("lname"))

%>

&lt;/body>
The browser will display the following in the body of the document:


Welcome Bill Gates

<h2>Request.Form </h2>
The Request.Form
command is used to collect values in a form with method="post".

Information sent from a form with the POST method 
is invisible to others and has no limits on the amount of information to send.


<h3>Example HTML form</h3>


&lt;form method="post" action="simpleform.asp">

First Name: &lt;input type="text" name="fname">&lt;br>

Last Name: &lt;input type="text" name="lname">&lt;br>&lt;br>

&lt;input type="submit" value="Submit">

&lt;/form>
If a user typed "Bill" and "Gates" in the HTML form 
above, the URL sent to the server would look like this: 


https://www.w3schools.com/simpleform.asp
Assume that "simpleform.asp" contains the following ASP script:



&lt;body>

Welcome

&lt;%

response.write(request.form("fname"))

response.write(" " &amp; request.form("lname"))

%>

&lt;/body>
The browser will display the following in the body of the document:


Welcome Bill Gates
<h2>Form Validation</h2>
User input should be validated on the browser whenever possible (by client scripts).
Browser validation is faster and reduces the server load.

You should consider server validation if the user input will be
inserted into a database. A good way to validate a form on the server is to post
the form to itself, instead of jumping to a different page. The user will then
get the error messages on the same page as the form. This makes it easier to
discover the error.


<h2><span class="orange"> ASP Cookies</span></h2>

<h2>More Examples</h2>
<a href="showasp.asp?filename=demo_cookies">Welcome cookie</a>

How to create a Welcome cookie.


<h2>What is a Cookie? </h2>
A cookie is often used to identify a user. A cookie is a small file that the server
embeds on the user's computer. Each time the same computer requests a page with a browser, it will send the cookie
too. With ASP, you can both create and retrieve cookie values.


<h2>How to Create a Cookie?</h2>
The "Response.Cookies" command is used to create cookies.

<b>Note:</b> The Response.Cookies command must appear BEFORE the &lt;html> tag.

In the example below, we will create a cookie named "firstname" and assign the value "Alex" to it:



&lt;%

Response.Cookies("firstname")="Alex"

%>
It is also possible to assign properties to a cookie, like setting a date when the cookie should expire:



&lt;%

Response.Cookies("firstname")="Alex"

Response.Cookies("firstname").Expires=#May 10,2012#

%>
<h2>How to Retrieve a Cookie Value?</h2>
The "Request.Cookies" command is used to retrieve a cookie value.

In the example below, we retrieve the value of the cookie named "firstname" and display it on a page:



&lt;%

fname=Request.Cookies("firstname")

response.write("Firstname=" &amp; fname)

%>
<b>Output:</b> Firstname=Alex



<h2>A Cookie with Keys</h2>
If a cookie contains a collection of multiple values, we say that the cookie has Keys.

In the example below, we will create a cookie collection named "user".
The "user" cookie has Keys that contains information about a user:



&lt;%

Response.Cookies("user")("firstname")="John"

Response.Cookies("user")("lastname")="Smith"

Response.Cookies("user")("country")="Norway"

Response.Cookies("user")("age")="25"

%>
<h2>Read all Cookies</h2>
Look at the following code:



&lt;%

Response.Cookies("firstname")="Alex"

Response.Cookies("user")("firstname")="John"

Response.Cookies("user")("lastname")="Smith"

Response.Cookies("user")("country")="Norway"

Response.Cookies("user")("age")="25"

%>
Assume that your server has sent all the cookies above to a user.

Now we want to read all the cookies sent to a user. The example below shows 
how to do it (note that the code below checks if a cookie has Keys with the HasKeys property):



    &lt;!DOCTYPE html>
&lt;html>

&lt;body>


&lt;%

dim x,y

for each x in Request.Cookies

   
  response.write("&lt;p>")

   
  if Request.Cookies(x).HasKeys then

       
    for each y in Request.Cookies(x)

           
      response.write(x &amp; ":" &amp; y &amp; "=" &amp; Request.Cookies(x)(y))

           
      response.write("&lt;br>")

       
    next

   
  else

       
    Response.Write(x &amp; "=" &amp; Request.Cookies(x) &amp; "&lt;br>")

   
  end if

   
  response.write "&lt;/p>"

next

%>


&lt;/body>

&lt;/html>
<b>Output:</b>

firstname=Alex

user:firstname=John

user:lastname=Smith

user:country=Norway

user:age=25


<h2>What if a Browser Does NOT Support Cookies?</h2>
If your application deals with browsers that do not support cookies, you will
have to use other methods to pass information from one page to another in your application.
There are two ways of doing this:


<h3>1. Add parameters to a URL</h3>
You can add parameters to a URL:


&lt;a href="welcome.asp?fname=John&amp;lname=Smith">Go to Welcome Page&lt;/a>
And retrieve the values in the "welcome.asp" file like this:



&lt;%

fname=Request.querystring("fname")

lname=Request.querystring("lname")

response.write("&lt;p>Hello " &amp; fname &amp; " " &amp; lname &amp; "!&lt;/p>")

response.write("&lt;p>Welcome to my Web site!&lt;/p>")

%>
<h3>2. Use a form</h3>
You can use a form. The form passes the user input to "welcome.asp" when the user clicks on the Submit button:



&lt;form method="post" action="welcome.asp">

First Name:  &lt;input type="text" name="fname" value="">

Last Name: &lt;input type="text" name="lname" value="">

&lt;input type="submit" value="Submit">

&lt;/form>
Retrieve the values in the "welcome.asp" file like this:



&lt;%

fname=Request.form("fname")

lname=Request.form("lname")

response.write("&lt;p>Hello " &amp; fname &amp; " " &amp; lname &amp; "!&lt;/p>")

response.write("&lt;p>Welcome to my Web site!&lt;/p>")

%>
<h2><span class="orange"> ASP Session Object</span></h2>

<h2>The Session object </h2>
When you are working with an application on your computer, you open it, do some changes and then
you close it. This is much like a Session. The computer knows who you are. It
knows when you open the application and when you close it. However, on the internet there is one
problem: the web server does not know who you are and what you do, because the HTTP address doesn't maintain state. 


ASP solves this problem by creating a unique cookie for each user. The cookie
is sent to the user's computer and it contains information that identifies the user. This
interface is called the Session object. 


The Session object stores information about, or change settings for a user session.

Variables stored in a Session object hold information about one single user, and are available to all pages in one application. Common information
stored in session variables are name, id, and preferences. The server creates a new Session object for each new user, and destroys the Session object when the session expires. 


<h2>When does a Session Start?</h2>
A session starts when:


A new user requests an ASP file, and the Global.asa file includes a Session_OnStart procedure
  A value is stored in a Session variable
  A user requests an ASP file, and the Global.asa file uses the &lt;object> tag to instantiate an object with session scope


<h2>When does a Session End?</h2>
A session ends if a user has not requested or refreshed a page in the application for a specified period. By default, this is 20 minutes. 

If you want to set a timeout interval that is shorter or longer than the default, 
use the <b>Timeout</b> property.

The example below sets a timeout interval of 5 minutes:



&lt;%

Session.Timeout=5

%>
Use the <b>Abandon</b> method to end a session immediately:



&lt;%

Session.Abandon

%>
<b>Note:</b> The main problem with sessions is WHEN they should end. We do 
not know if the user's last request was the final one or not. So we do not know 
how long we should keep the session "alive". Waiting too long for an idle 
session uses up resources on the server, but if the session is deleted too soon 
the user has to start all over again because the server has deleted all the 
information. Finding the right timeout interval can be difficult!



  <b>Tip:</b> Only store SMALL amounts of data in session variables!




<h2>Store and Retrieve Session Variables </h2>
The most important thing about the Session object is that you can store variables in it.

The example below will set the Session variable <i>username</i> to "Donald Duck" and the Session variable <i>age</i> to "50":



&lt;%

Session("username")="Donald Duck"

Session("age")=50

%>
When the value is stored in a session variable it can be reached from ANY page in the ASP application:


Welcome &lt;%Response.Write(Session("username"))%>
The line above returns: "Welcome Donald Duck".

You can also store user preferences in the Session object, and then access
that preference to choose what page to return to the user.

The example below specifies a text-only version of the page if the user has a low screen resolution: 



&lt;%If Session("screenres")="low" Then%>

   
  This is the text version of the page

&lt;%Else%>

   
  This is the multimedia version of the page

&lt;%End If%>
<h2>Remove Session Variables </h2>
The Contents collection contains all session variables.

It is possible to remove a session variable with the Remove method.

The example below removes the session variable "sale" if the value of the session variable "age" is lower than 18: 



&lt;%

If Session.Contents("age")&lt;18 then

   
  Session.Contents.Remove("sale")

End If

%>
To remove all variables in a session, use the RemoveAll method: 



&lt;%

Session.Contents.RemoveAll()

%>
<h2>Loop Through the Contents Collection</h2>
The Contents collection contains all session variables. You can loop through the Contents collection, to see what's stored in it: 



&lt;%

Session("username")="Donald Duck"

Session("age")=50


dim i

For Each i in Session.Contents

   
  Response.Write(i &amp; "&lt;br>")

Next

%>
Result:



username

age
If you do not know the number of items in the Contents collection, you can use the Count property:



&lt;%

dim i

dim j

j=Session.Contents.Count

Response.Write("Session variables: " &amp; j)

For i=1 to j

   
  Response.Write(Session.Contents(i) &amp; "&lt;br>")

Next

%>
Result:



Session variables: 2

Donald Duck

50
<h2>Loop Through the StaticObjects Collection</h2>
You can loop through the StaticObjects collection, to see the values of all objects stored in the Session object:



&lt;%

dim i

For Each i in Session.StaticObjects

   
  Response.Write(i &amp; "&lt;br>")

Next

%>
<h2><span class="orange"> ASP Application Object</span></h2>

<h2>Application Object</h2>
An application on the Web may consist of several ASP files that work together to perform some purpose.
The Application object is used to tie these files together.

The Application object is used to store and access variables from any page, just like the Session object. The difference
is that ALL users share ONE Application object (with Sessions there is ONE Session object for EACH user).

The Application object holds information that will be used by many pages in the application (like database connection information).
The information can be accessed from any page. The information can also be changed in one place, and the changes will automatically be reflected
on all pages.


<h2>Store and Retrieve Application Variables</h2>
Application variables can be accessed and changed by any page in an application.

You can create Application variables in "Global.asa" like this:



&lt;script language="vbscript" runat="server">


Sub Application_OnStart

application("vartime")=""

application("users")=1

End Sub


&lt;/script>
In the example above we have created two Application variables: "vartime" and "users".

You can access the value of an Application variable like this:



There are

&lt;%

Response.Write(Application("users"))

%>

active connections.

<h2>Loop Through the Contents Collection</h2>
The Contents collection contains all application variables. You can loop through the Contents collection, to see what's stored in it:



&lt;%

dim i

For Each i in Application.Contents

   
  Response.Write(i &amp; "&lt;br>")

Next

%>
If you do not know the number of items in the Contents collection, you can use the Count property:



&lt;%

dim i

dim j

j=Application.Contents.Count

For i=1 to j

   
  Response.Write(Application.Contents(i) &amp; "&lt;br>")

Next

%>
<h2>Loop Through the StaticObjects Collection</h2>
You can loop through the StaticObjects collection, to see the values of all objects stored in the Application object:



&lt;%

dim i

For Each i in Application.StaticObjects

   
  Response.Write(i &amp; "&lt;br>")

Next

%>
<h2>Lock and Unlock</h2>
You can lock an application with the "Lock" method. When an
application is locked, the users cannot change the Application variables (other than the one currently accessing
it). You can unlock an application with the "Unlock" method. This method
removes the lock from the Application variable:



&lt;%

Application.Lock

  'do some application object operations

Application.Unlock

%>
<h2><span class="orange"> ASP Including Files</span></h2>
You can insert the content of one ASP file into another ASP file before the
server executes it, with the #include directive.

The #include directive is used to create functions, headers, footers, or 
elements that will be reused on multiple pages.


<h2>How to Use the #include Directive</h2>
Here is a file called "mypage.asp":



    &lt;!DOCTYPE html>
&lt;html>

&lt;body>
 
&lt;h3>Words of Wisdom:&lt;/h3>

&lt;p>&lt;!--#include file="wisdom.inc"-->&lt;/p>

&lt;h3>The time is:&lt;/h3>

&lt;p>&lt;!--#include file="time.inc"-->&lt;/p>

&lt;/body>

&lt;/html>
Here is the "wisdom.inc" file:



"One should never increase, beyond what is necessary,

the number of entities required to explain anything."
Here is the "time.inc" file:



&lt;%

Response.Write(Time)

%>
If you look at the source code in a browser, it will look something like this:



    &lt;!DOCTYPE html>
&lt;html>

&lt;body>

&lt;h3>Words of Wisdom:&lt;/h3>

&lt;p>"One should never increase, beyond what is necessary,

the number of entities required to explain anything."&lt;/p>

&lt;h3>The time is:&lt;/h3>

&lt;p>11:33:42 AM&lt;/p>

&lt;/body>

&lt;/html>

<h2>Syntax for Including Files</h2>
To include a file in an ASP page, place the #include directive inside comment tags:



&lt;!--#include virtual="somefilename"-->


or


&lt;!--#include file ="somefilename"-->
<h3>The Virtual Keyword</h3>
Use the virtual keyword to indicate a path beginning with a virtual directory.

If a file named "header.inc" resides in a virtual directory named /html, the following line would insert the contents of "header.inc":


&lt;!-- #include virtual ="/html/header.inc" -->
<h3>The File Keyword</h3>
Use the file keyword to indicate a relative path. A relative path begins with the directory that contains the including file.

If you have a file in the html directory, and the file "header.inc" resides in html\headers, the following line would insert "header.inc" in your file:


&lt;!-- #include file ="headers\header.inc" -->
Note that the path to the included file (headers\header.inc) is relative to the including file. 
If the file containing this #include statement is not in the html directory, the statement will not work.


<h2>Tips and Notes</h2>
In the sections above we have used the file extension ".inc" for included files. Notice that if a user tries to browse an INC file directly,
its content will be displayed. If your included file contains confidential information or information you do not want any users to see, it is better to use an 
ASP extension. The source code in an ASP file will not be visible after the interpretation. An included file can also include other files,
and one ASP file can include the same file more than once.

<b>Important:</b> Included files are processed and inserted before the scripts are executed. The following script will NOT work because ASP executes the 
#include directive before it assigns a value to the variable:



&lt;%

fname="header.inc"

%>

&lt;!--#include file="&lt;%fname%>"-->
You cannot open or close a script delimiter in an INC file. The following script will NOT work:



&lt;%

For i = 1 To n

   
  &lt;!--#include file="count.inc"-->

Next

%>
But this script will work:



&lt;% For i = 1 to n %>

 
&lt;!--#include file="count.inc" -->

&lt;% Next %>
<h2><span class="orange"> ASP The Global.asa file</span></h2>
The Global.asa file is an optional file that can contain declarations of objects, variables, and methods that
can be accessed by every page in an ASP application.

All valid browser scripts (JavaScript, VBScript, JScript, PerlScript, etc.) can be used within Global.asa.


The Global.asa file can contain only the following:


Application events
  Session events
  &lt;object> declarations
  TypeLibrary declarations
  the #include directive

<b>Note:</b> The Global.asa file must be stored in the root directory of the
ASP application, and each application can only have one Global.asa file.


<h2>Events in Global.asa</h2>
In  Global.asa you can tell the application and session objects what to do when the application/session starts and what to do when the
application/session ends. The code for this is placed in event handlers. The Global.asa file can contain four types of events:

<b>Application_OnStart</b> - Occurs when the FIRST user calls the first page in an ASP application. This event occurs after the
Web server is restarted or after the Global.asa file is edited. The "Session_OnStart" event occurs immediately after this event.
<b>Session_OnStart</b> - This event occurs EVERY time a NEW user requests his or her first page in the ASP application.

<b>Session_OnEnd</b> - This event occurs EVERY time a user ends a session. A user-session ends after a page has not been requested by the user for a 
specified time (by default this is 20 minutes).

<b>Application_OnEnd</b> - This event occurs after the LAST user has ended the session. Typically, this event occurs when a Web server stops.
This procedure is used to clean up settings after the Application stops, like delete records or write information to text files.

A Global.asa file could look something like this:



&lt;script language="vbscript" runat="server">


sub Application_OnStart

  '<i>some code</i>

end sub


sub Application_OnEnd

  '<i>some code</i>

end sub


sub Session_OnStart

  '<i>some code</i>

end sub


sub Session_OnEnd

  '<i>some code</i>

end sub


&lt;/script>
<b>Note:</b> Because we cannot use the ASP script delimiters (&lt;% and %>) to insert scripts in the Global.asa file, we put subroutines inside an HTML 
&lt;script> element.



<h2>&lt;object> Declarations</h2>
It is possible to create objects with session or application scope in Global.asa by using the &lt;object> tag.

<b>Note:</b> The &lt;object> tag should be outside the &lt;script> tag!


<h3>Syntax</h3>


&lt;object runat="server" scope="<i>scope</i>" id="<i>id</i>"
{progid="<i>progID</i>"|classid="<i>classID</i>"}>

....

&lt;/object>

<table class="ws-table-all notranslate">
<tr><th style="width:20%">Parameter</th><th>Description</th>
  </tr>
<tr><td>scope </td><td>Sets the scope of the object (either Session or Application)</td>
  </tr>
<tr><td>id </td><td>Specifies a unique id for the object</td>
  </tr>
<tr><td>ProgID </td><td>An id associated with a class id. The format for ProgID is [Vendor.]Component[.Version]
     Either ProgID or ClassID must be specified.

</td>
  </tr>
<tr><td>ClassID </td><td>Specifies a unique id for a COM class object. Either ProgID or ClassID must be specified.

</td>
  </tr>
</table>
<h3>Examples</h3>
The first example creates an object of session scope named "MyAd" by using the ProgID parameter:


&lt;object runat="server" scope="session" id="MyAd"
progid="MSWC.AdRotator">

&lt;/object>
The second example creates an object of application scope named "MyConnection" by using the ClassID parameter:



&lt;object runat="server" scope="application" id="MyConnection"

classid="Clsid:8AD3067A-B3FC-11CF-A560-00A0C9081C21">

&lt;/object>
The objects declared in the Global.asa file can be used by any script in the application:



GLOBAL.ASA:


&lt;object runat="server" scope="session" id="MyAd"
progid="MSWC.AdRotator">

&lt;/object>


You could reference the object "MyAd" from any page in the ASP application:


SOME .ASP FILE:


&lt;%=MyAd.GetAdvertisement("/banners/adrot.txt")%>
<h2>TypeLibrary Declarations</h2>
A TypeLibrary is a container for the contents of a DLL file corresponding to a COM object. By including a call to the TypeLibrary in the Global.asa file,
the constants of the COM object can be accessed, and errors can be better reported by the ASP code. If your Web application relies on COM objects that have
declared data types in type libraries, you can declare the type libraries in Global.asa.


<h3>Syntax</h3>


&lt;!--METADATA TYPE="TypeLib"

file="<i>filename</i>"
uuid="<i>id</i>"
version="<i>number</i>"
lcid="<i>localeid</i>"

-->
<table class="ws-table-all notranslate">
<tr><th style="width:20%">Parameter</th><th>Description</th>
  </tr>
<tr><td>file</td><td>Specifies an absolute path to a type library.
      Either the file parameter or the uuid parameter is required

</td>
  </tr>
<tr><td>uuid</td><td>Specifies a unique identifier for the type library.
      Either the file parameter or the uuid parameter is required

</td>
  </tr>
<tr><td>version</td><td>Optional. Used for selecting version. If the requested version is not found, then the most recent version is used</td>
  </tr>
<tr><td>lcid</td><td>Optional. The locale identifier to be used for the type library</td>
  </tr>
</table>
<h3>Error Values</h3>

The server can return one of the following error messages:


<table class="ws-table-all notranslate">
<tr><th style="width:20%">Error Code</th><th>Description</th>
  </tr>
<tr><td>ASP 0222</td><td> Invalid type library specification</td>
  </tr>
<tr><td>ASP 0223</td><td> Type library not found</td>
  </tr>
<tr><td>ASP 0224</td><td> Type library cannot be loaded</td>
  </tr>
<tr><td>ASP 0225</td><td> Type library cannot be wrapped</td>
  </tr>
</table>
<b>Note:</b> METADATA tags can appear anywhere in the Global.asa file (both inside and outside &lt;script> tags). However, it is recommended that
METADATA tags appear near the top of the Global.asa file.


<h2>Restrictions</h2>
Restrictions on what you can include in the Global.asa file:


 You cannot display text written in the Global.asa file. This file can't display information
  You can only use Server and Application objects in the Application_OnStart and Application_OnEnd
subroutines. In the Session_OnEnd subroutine, you can use Server, Application, and Session
    objects. In the Session_OnStart subroutine you can use any built-in object


<h2>How to use the Subroutines</h2>
Global.asa is often used to initialize variables. 

 The example below shows how to detect the exact time a visitor first arrives on a Web site. The time is stored in a Session variable named 
"started", and the value of the "started" variable can be accessed from any ASP page in the application:



&lt;script language="vbscript" runat="server">

sub Session_OnStart

Session("started")=now()

end sub

&lt;/script>
Global.asa can also be used to control page access.


The example below shows how to redirect every new visitor to another page, in this case to a
page called "newpage.asp":



&lt;script language="vbscript" runat="server">

sub Session_OnStart

Response.Redirect("newpage.asp")

end sub

&lt;/script>
And you can include functions in the Global.asa file.

In the example below the Application_OnStart subroutine occurs when the Web server starts. Then
the Application_OnStart subroutine calls another subroutine named "getcustomers".
The "getcustomers" subroutine opens a database and retrieves a record set from
the "customers" table. The record set is assigned to an array, where it
can be accessed from any ASP page without querying the database:



&lt;script language="vbscript" runat="server">


sub Application_OnStart

getcustomers

end sub


sub getcustomers

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"

set rs=conn.execute("select name from customers")

Application("customers")=rs.GetRows

rs.Close

conn.Close

end sub


&lt;/script>
<h2>Global.asa Example</h2>
In this example we will create a Global.asa file that counts the number of current visitors.


The Application_OnStart sets the Application variable "visitors" to 0 when the server starts
  The Session_OnStart subroutine adds one to the variable "visitors" every time a new visitor arrives
  The Session_OnEnd subroutine subtracts one from "visitors" each time this subroutine is triggered

The Global.asa file:



&lt;script language="vbscript" runat="server">


Sub Application_OnStart

Application("visitors")=0

End Sub


Sub Session_OnStart

Application.Lock

Application("visitors")=Application("visitors")+1

Application.UnLock

End Sub


Sub Session_OnEnd

Application.Lock

Application("visitors")=Application("visitors")-1

Application.UnLock

End Sub


&lt;/script>
To display the number of current visitors in an ASP file:



    &lt;!DOCTYPE html>
&lt;html>

&lt;head>

&lt;/head>

&lt;body>

&lt;p>There are &lt;%response.write(Application("visitors"))%>
online now!&lt;/p>

&lt;/body>

&lt;/html>
<h2><span class="orange"> ASP AJAX</span></h2>

<h2>What is AJAX?</h2>
AJAX = Asynchronous JavaScript and XML.

AJAX is a technique for creating fast and dynamic web pages.

AJAX allows web pages to be updated asynchronously by exchanging small 
amounts of data with the server behind the scenes. This means that it is 
possible to update parts of a web page, without reloading the whole page.

Classic web pages, (which do not use AJAX) must reload the entire page if the 
content should change.

Examples of applications using AJAX: Google Maps, Gmail, Youtube, and 
Facebook tabs.


<h2>How AJAX Works</h2>
<img class="w3-image" alt="AJAX" src="ajax.gif">


<h2>AJAX is Based on Internet Standards</h2>
AJAX is based on internet standards, and uses a combination of:


XMLHttpRequest object (to exchange data asynchronously with a server)
JavaScript/DOM (to display/interact with the information)
CSS (to style the data)
XML (often used as the format for transferring data)


  AJAX applications are browser- and platform-independent!




<h2>Google Suggest</h2>
AJAX was made popular in 2005 by Google, with Google Suggest.

<a href="https://www.google.com/">Google Suggest</a> 
is using AJAX to create a very dynamic web interface: 
When you start typing in Google's search box, a JavaScript sends the letters off 
to a server and the server returns a list of suggestions.


<h2>Start Using AJAX Today</h2>
In our ASP tutorial, we will demonstrate how AJAX can update parts of a web 
page, without reloading the whole page. The server script will be written in ASP.

If you want to learn more about AJAX, visit our <a href="/xml/ajax_intro.asp">AJAX tutorial</a>.



<h2>AJAX ASP Example</h2>
The following example will demonstrate how a web page can communicate with a 
web server while a user type characters in an input field:


<h3>Example</h3>

<b>Start typing a name in the input field below:</b>

<form>
First name: <input type="text" id="txt1" onkeyup="showHintASP(this.value)">
</form>
Suggestions: 
 





<h2>Example Explained</h2>
In the example above, when a user types a character in the input field, a function 
called "showHint()" is executed.

The function is triggered by the onkeyup event.

Here is the HTML code:


<h3>Example</h3>
    &lt;html>
&lt;head>
&lt;script>
function showHint(str) {
    
    if (str.length == 0) { 
        
    document.getElementById("txtHint").innerHTML = "";
        
    return;
    } else {
        var xmlhttp = new 
    XMLHttpRequest();
        xmlhttp.onreadystatechange = function() 
    {
            if (this.readyState == 4 &amp;&amp; 
    this.status == 200) {
                document.getElementById("txtHint").innerHTML = 
    this.responseText;
            
    }
        };
        xmlhttp.open("GET", "gethint.asp?q=" + str, true);
        xmlhttp.send();
    
    }
}
&lt;/script>
&lt;/head>
&lt;body>

&lt;p>&lt;b>Start typing a name in the 
    input field below:&lt;/b>&lt;/p>
&lt;form> 
First name: &lt;input type="text" 
    onkeyup="showHint(this.value)">
&lt;/form>
&lt;p>Suggestions: &lt;span id="txtHint">&lt;/span>&lt;/p>

    &lt;/body>
&lt;/html>
<a href="/xml/tryit.asp?filename=tryajax_suggest_asp">Try it Yourself </a>


Code explanation:

First, check if the input field is empty (str.length == 0). If it is, clear the 
content of the txtHint placeholder and exit the function.

However, if the input field is not empty, do the following:


Create an XMLHttpRequest object
  Create the function to be executed when the server response is ready
  Send the request off to an ASP file (gethint.asp) on the server
  Notice that q parameter is added gethint.asp?q="+str
  The str variable holds the content of the input field


<h2>The ASP File - "gethint.asp"</h2>
The ASP file checks an array of names, and returns the corresponding name(s) to the 
browser:


&lt;%

response.expires=-1

dim a(30)

'Fill up array with names

a(1)="Anna"

a(2)="Brittany"

a(3)="Cinderella"

a(4)="Diana"

a(5)="Eva"

a(6)="Fiona"

a(7)="Gunda"

a(8)="Hege"

a(9)="Inga"

a(10)="Johanna"

a(11)="Kitty"

a(12)="Linda"

a(13)="Nina"

a(14)="Ophelia"

a(15)="Petunia"

a(16)="Amanda"

a(17)="Raquel"

a(18)="Cindy"

a(19)="Doris"

a(20)="Eve"

a(21)="Evita"

a(22)="Sunniva"

a(23)="Tove"

a(24)="Unni"

a(25)="Violet"

a(26)="Liza"

a(27)="Elizabeth"

a(28)="Ellen"

a(29)="Wenche"

a(30)="Vicky"


'get the q parameter from URL

q=ucase(request.querystring("q"))


'lookup all hints from array if length of q>0

if len(q)>0 then

   
  hint=""

   
  for i=1 to 30

       
    if q=ucase(mid(a(i),1,len(q))) then

           
      if hint="" then

               
        hint=a(i)

           
      else

               
        hint=hint &amp; " , " &amp; a(i)

           
      end if

       
    end if

   
  next

end if


'Output "no suggestion" if no hint were found

'or output the correct values

if hint="" then

   
  response.write("no suggestion")

else

   
  response.write(hint)

end if

%>

AJAX can be used for interactive communication with a database.


<h2>AJAX Database Example</h2>
The following example will demonstrate how a web page can fetch 
information from a database with AJAX:

<h3>Example</h3>

<form action=""> 
<select name="customers" onchange="showCustomer(this.value)"><option value="">Select a customer:</option>
<option value="ALFKI">Alfreds Futterkiste</option>
<option value="NORTS ">North/South</option>
<option value="WOLZA">Wolski Zajazd</option></select>
</form>

Customer info will be listed here...


<a href="/xml/tryit.asp?filename=tryajax_database" class="w3-btn">Try it Yourself </a>




<h2>Example Explained - The HTML Page</h2>
When a user selects a customer in the dropdown list above, a function called "showCustomer()" is executed. The 
function is triggered by the "onchange" event:
 


    &lt;!DOCTYPE html>
&lt;html>

&lt;head>

&lt;script>

function showCustomer(str)

{

if (str=="")

  {

  document.getElementById("txtHint").innerHTML="";

  return;

  }

if (window.XMLHttpRequest)

  {// code for IE7+, Firefox, Chrome, Opera, Safari

  xmlhttp=new XMLHttpRequest();

  }

else

  {// code for IE6, IE5

  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

  }

xmlhttp.onreadystatechange=function()

  {

  if (this.readyState==4 &amp;&amp; this.status==200)

    {

    document.getElementById("txtHint").innerHTML=this.responseText;

    }

  }

xmlhttp.open("GET","getcustomer.asp?q="+str,true);

xmlhttp.send();

}

&lt;/script>

&lt;/head

&lt;body>


&lt;form> 

&lt;select name="customers" onchange="showCustomer(this.value)">

&lt;option value="">Select a customer:&lt;/option>

&lt;option value="ALFKI">Alfreds Futterkiste&lt;/option>

&lt;option value="NORTS ">North/South&lt;/option>

&lt;option value="WOLZA">Wolski Zajazd&lt;/option>

&lt;/select>

&lt;/form>

&lt;


&lt;div id="txtHint">Customer info will be listed here...&lt;/div>


&lt;/body>

&lt;/html>
Source code explanation:

If no customer is selected (str.length==0), the function clears the 
content of the txtHint placeholder and exits the function.


If a customer is selected, the showCustomer() function executes the following:


Create an XMLHttpRequest object
  Create the function to be executed when the server response is ready
  Send the request off to a file on the server
  Notice that a parameter (q) is added to the URL (with the content of the 
    dropdown list)


<h2>The ASP File</h2>

The page on the server called by the JavaScript above is an ASP file called "getcustomer.asp".

The source code in "getcustomer.asp" runs a query against a database, and returns the result in an HTML 
table:



&lt;%

response.expires=-1

sql="SELECT * FROM CUSTOMERS WHERE CUSTOMERID="

sql=sql &amp; "'" &amp; request.querystring("q") &amp; "'"


set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open(Server.Mappath("/<em>datafolder</em>/northwind.mdb"))

set rs=Server.CreateObject("ADODB.recordset")

rs.Open sql,conn


response.write("&lt;table>")

do until rs.EOF

   
  for each x in rs.Fields

       
    response.write("&lt;tr>&lt;td>&lt;b>" &amp; x.name &amp; "&lt;/b>&lt;/td>")

       
    response.write("&lt;td>" &amp; x.value &amp; "&lt;/td>&lt;/tr>")

   
  next

   
  rs.MoveNext

loop
response.write("&lt;/table>")

%>


      
        <!-- MainLeaderboard-->
        
        
          <script type="text/javascript">googletag.cmd.push(function() { googletag.display('div-gpt-ad-1422003450156-2'); });</script>


      
<h2><span class="orange"> ASP Sending e-mail with CDOSYS</span></h2>

<h2>Sending e-mail with CDOSYS</h2>
CDO (Collaboration Data Objects) is a Microsoft technology that is designed to simplify the creation of messaging applications.

CDOSYS is a built-in component in ASP. We will show you how to use this component to send e-mail with ASP.


<h2>How about CDONTs?</h2>
Microsoft has discontinued the use of CDONTs on Windows 2000, Windows XP and Windows 2003. If you have used CDONTs in your ASP applications, you should 
update the code and use the new CDO technology.


<h2>Examples using CDOSYS</h2>
Sending a text e-mail:



&lt;%

Set myMail = CreateObject("CDO.Message")

myMail.Subject = "Sending email with CDO"

myMail.From = "mymail@mydomain.com"

myMail.To = "someone@somedomain.com"

myMail.TextBody = "This is a message."

myMail.Send

set myMail = nothing

%>
Sending a text e-mail with Bcc and CC fields:



&lt;%

Set myMail = CreateObject("CDO.Message")

myMail.Subject = "Sending email with CDO"

myMail.From = "mymail@mydomain.com"

myMail.To = "someone@somedomain.com"

myMail.Bcc = "someoneelse@somedomain.com"

myMail.Cc = "someoneelse2@somedomain.com"

myMail.TextBody = "This is a message."

myMail.Send

set myMail = nothing

%>
Sending an HTML e-mail:



&lt;%

Set myMail = CreateObject("CDO.Message")

myMail.Subject = "Sending email with CDO"

myMail.From = "mymail@mydomain.com"

myMail.To = "someone@somedomain.com"

myMail.HTMLBody = "&lt;h1>This is a message.&lt;/h1>"

myMail.Send

set myMail = nothing

%>
Sending an HTML e-mail that sends a webpage from a website:



&lt;%

Set myMail = CreateObject("CDO.Message")

myMail.Subject = "Sending email with CDO"

myMail.From = "mymail@mydomain.com"

myMail.To ="someone@somedomain.com"

myMail.CreateMHTMLBody "https://www.w3schools.com/asp/"

myMail.Send

set myMail = nothing

%>

<!-- MidContent -->
<!-- Advertisement
 -->
        
  
    <script>
    googletag.cmd.push(function() { googletag.display('div-gpt-ad-1493883843099-0'); });
    </script>

  


Sending an HTML e-mail that sends a webpage from a file on your computer:



&lt;%

Set myMail = CreateObject("CDO.Message")

myMail.Subject = "Sending email with CDO"

myMail.From = "mymail@mydomain.com"

myMail.To = "someone@somedomain.com"

myMail.CreateMHTMLBody "file://c:/mydocuments/test.htm"

myMail.Send

set myMail = nothing

%>
Sending a text e-mail with an Attachment:



&lt;%

Set myMail = CreateObject("CDO.Message")

myMail.Subject = "Sending email with CDO"

myMail.From = "mymail@mydomain.com"

myMail.To = "someone@somedomain.com"

myMail.TextBody = "This is a message."

myMail.AddAttachment "c:\mydocuments\test.txt"

myMail.Send

set myMail = nothing

%>
Sending a text e-mail using a remote server:



&lt;%

Set myMail = CreateObject("CDO.Message")

myMail.Subject = "Sending email with CDO"

myMail.From = "mymail@mydomain.com"

myMail.To = "someone@somedomain.com"

myMail.TextBody = "This is a message."

myMail.Configuration.Fields.Item _

("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2

'Name or IP of remote SMTP server

myMail.Configuration.Fields.Item _

("http://schemas.microsoft.com/cdo/configuration/smtpserver") = "smtp.server.com"

'Server port

myMail.Configuration.Fields.Item _

("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25 

myMail.Configuration.Fields.Update

myMail.Send

set myMail = nothing

%>
<h2><span class="orange"> ASP and VBScript Examples</span></h2>
<b>ASP Output</b>


<a href="showasp.asp?filename=demo_syntax_text">Writing plain text</a>
<a href="showasp.asp?filename=demo_syntax_tags">Writing HTML Tags</a>
<a href="showasp.asp?filename=demo_syntax_colors">Writing HTML attributes</a>


<b>VbScript Variables</b>


<a href="showasp.asp?filename=demo_variable">Create a variable</a>
<a href="showasp.asp?filename=demo_vb_variable">Create a variable 
and change its value</a>
<a href="showasp.asp?filename=demo_vb_variable2">Insert a variable value in a text</a>
<a href="showasp.asp?filename=demo_array">Create an array</a>


<b>VBScript Looping</b>


<a href="showasp.asp?filename=demo_vb_fornext">For..Next loop</a>
<a href="showasp.asp?filename=demo_fornext2">Looping through HTML headers</a>
<a href="showasp.asp?filename=demo_vb_foreach">For..Each loop</a>
<a href="showasp.asp?filename=demo_vb_dowhile">Do...While loop</a>


<b>VBScript Date and Time Functions</b>


<a href="showasp.asp?filename=demo_asp_date">Date and time</a>
<a href="showasp.asp?filename=demo_asp_day">Get the name of a day</a>
<a href="showasp.asp?filename=demo_asp_monthname">Get the name of a month</a>
<a href="showasp.asp?filename=demo_asp_month">Get todays' day and month</a>
<a href="showasp.asp?filename=demo_asp_3000">Countdown to year 3000</a>
<a href="showasp.asp?filename=demo_asp_dateadd">Calculate the day which is n days from today</a>
<a href="showasp.asp?filename=demo_asp_formatdatetime">Format date and time</a>
<a href="showasp.asp?filename=demo_asp_isdate">Is this a date?</a>



<b>Some Other Built-in VBScript Functions</b>


<a href="showasp.asp?filename=demo_asp_ucase">Uppercase or lowercase a string</a>
<a href="showasp.asp?filename=demo_asp_trim">Trim a string</a>
<a href="showasp.asp?filename=demo_asp_strreverse">How to reverse a string?</a>
<a href="showasp.asp?filename=demo_asp_round">How to round a number?</a>
<a href="showasp.asp?filename=demo_asp_rnd">A random number</a>
<a href="showasp.asp?filename=demo_vb_random">Return a random number between 0-99</a>
<a href="showasp.asp?filename=demo_asp_right">Return a specified number of characters from left/right of a string</a>
<a href="showasp.asp?filename=demo_asp_replace">Replace some characters in a string</a>
<a href="showasp.asp?filename=demo_asp_mid">Return a specified number of characters from a string</a>



<b>Procedures</b>


<a href="showasp.asp?filename=demo_vb_subex">Sub procedure</a>
<a href="showasp.asp?filename=demo_vb_functionex">Function procedure</a>



<b>VBScript vs JavaScript</b>


<a href="showasp.asp?filename=demo_vbproc">Call a procedure using VBScript in ASP</a>
<a href="showasp.asp?filename=demo_jsproc">Call a procedure using JavaScript in ASP</a>
<a href="showasp.asp?filename=demo_vbproc2">Call a JavaScript procedure and a VBScript procedure using VBScript in ASP</a>
<a href="showasp.asp?filename=demo_vbtime">Time-based greeting using VBScript</a>
<a href="showasp.asp?filename=demo_jstime">Time-based greeting using JavaScript</a>




<b>VBScript Conditional Statements</b>


<a href="showasp.asp?filename=demo_vb_ifthen">If...Then..Else statement</a>
<a href="showasp.asp?filename=demo_vb_elseif">If...Then..ElseIf statement</a>
<a href="showasp.asp?filename=demo_vb_selectcase">Select Case statement</a>
<a href="showasp.asp?filename=demo_vb_randomlink">Random link</a>


<b>ASP Forms</b>


<a href="showasphtmfile.asp?filename=demo_reqquery">Interact with a user in a form that uses the "get" method</a>
<a href="showasp.asp?filename=demo_simpleform">Interact with a user in a form that uses the "post" method</a>
<a href="showasp.asp?filename=demo_radiob">Interact with a user in a  form with radio buttons</a>



<b>ASP Cookies</b>

<a href="showasp.asp?filename=demo_cookies">Create a welcome cookie</a>


<b>ASP Response Object</b>


<a href="showasp.asp?filename=demo_text">Write text using ASP</a>
<a href="showasp.asp?filename=demo_formatting">Format text with HTML tags</a>
<a href="showasp.asp?filename=demo_redirect">Redirect the user to another URL</a>
<a href="showasp.asp?filename=demo_randomlink">Random links</a>
<a href="showasp.asp?filename=demo_buffer">Controlling the buffer</a>
<a href="showasp.asp?filename=demo_bufferclear">Clear the buffer</a>
<a href="showasp.asp?filename=demo_end">End a script in the middle of processing</a>
<a href="showasp.asp?filename=demo_expires">Set how many minutes a page will be cached in a browser before it expires</a>
<a href="showasp.asp?filename=demo_expiresabs">Set a date/time when a page cached in a browser will expire</a>
<a href="showasp.asp?filename=demo_isclientconnected">Check if the user is still connected</a>
<a href="showasp.asp?filename=demo_contenttype">Set the type of content</a>
<a href="showasp.asp?filename=demo_charset">Set the name of character set</a>



<b>ASP Request Object</b>


<a href="showasphtmfile.asp?filename=demo_simplequerystring">Send extra information within a link</a>
<a href="showasphtmfile.asp?filename=demo_simplereqquery">A QueryString collection in its simplest use</a>
<a href="showasphtmfile.asp?filename=demo_reqquery">How to use information from forms</a>
<a href="showasp.asp?filename=demo_reqquery2">More information from a form</a>
<a href="showasp.asp?filename=demo_simpleform1">A form collection in its simplest use</a>
<a href="showasp.asp?filename=demo_simpleform">How to use information from forms</a>
<a href="showasp.asp?filename=demo_form2">More information from a form</a>
<a href="showasp.asp?filename=demo_radiob">A form with radio buttons</a>
<a href="showasp.asp?filename=demo_checkboxes">A form with checkboxes</a>
<a href="showasp.asp?filename=demo_server">How to find the visitors' browser type, IP address and more</a>
<a href="showasp.asp?filename=demo_servervariables">List all servervariables you can ask for</a>
<a href="showasp.asp?filename=demo_cookies">Welcome cookie</a>
<a href="showasp.asp?filename=demo_totalbytes">Total number of bytes the user sent</a>



<b>ASP Session Object</b>


<a href="showasp.asp?filename=demo_sessionid">Return session id number for a user</a>
<a href="showasp.asp?filename=demo_gettimeout">Get a session's timeout</a>



<b>ASP Server Object</b>


<a href="showasp.asp?filename=demo_lastmodified">When was a file last modified?</a>
<a href="showasp.asp?filename=demo_textstream">Open a textfile for reading</a>
<a href="showasp.asp?filename=demo_hitcounter">Home made hit counter</a>


<b>ASP FileSystem Object</b>


<a href="showfile.asp?filename=demo_fileexists">Does a specified file exist?</a>
<a href="showfile.asp?filename=demo_folderexists">Does a specified folder exist?</a>
<a href="showfile.asp?filename=demo_driveexists">Does a specified drive exist?</a>
<a href="showfile.asp?filename=demo_getdrivename">Get the name of a specified drive</a>
<a href="showfile.asp?filename=demo_getparentfoldername">Get the name of the parent folder of a specified path</a>
<a href="showfile.asp?filename=demo_getextensionname">Get the file extension</a>
<a href="showfile.asp?filename=demo_getbasename">Get the base name of a file or folder</a>



<b>ASP TextStream Object</b>


<a href="showasp.asp?filename=demo_readtextfile">Read textfile</a>
<a href="showasp.asp?filename=demo_readpartoftextfile">Read only a part of a textfile</a>
<a href="showasp.asp?filename=demo_readline">Read one line of a textfile</a>
<a href="showasp.asp?filename=demo_readlines">Read all lines from a textfile</a>
<a href="showasp.asp?filename=demo_skip">Skip a part of a textfile</a>
<a href="showasp.asp?filename=demo_skipline">Skip a line of a textfile</a>
<a href="showasp.asp?filename=demo_line">Return current line-number in a text file</a>
<a href="showasp.asp?filename=demo_column">Get column number of the current character in a text file</a>



<b>ASP Drive Object</b>


<a href="showfile.asp?filename=demo_availablespace">Get the available space of a specified drive</a>
<a href="showfile.asp?filename=demo_freespace">Get the free space of a specified drive</a>
<a href="showfile.asp?filename=demo_totalsize">Get the total size of a specified drive</a>
<a href="showfile.asp?filename=demo_driveletter">Get the drive letter of a specified drive</a>
<a href="showfile.asp?filename=demo_drivetype">Get the drive type of a specified drive</a>
<a href="showfile.asp?filename=demo_filesystem">Get the file system of a specified drive</a>
<a href="showfile.asp?filename=demo_isready">Is the drive ready?</a>
<a href="showfile.asp?filename=demo_path">Get the path of a specified drive</a>
<a href="showfile.asp?filename=demo_rootfolder">Get the root folder of a specified drive</a>
<a href="showfile.asp?filename=demo_serialnumber">Get the serial 
number of a specified drive</a>



<b>ASP File Object</b>


<a href="showasp.asp?filename=demo_datecreated">When was the file created?</a>
<a href="showasp.asp?filename=demo_datelastmodified">When was the file last modified?</a>
<a href="showasp.asp?filename=demo_datelastaccessed">When was the file last accessed?</a>
<a href="showasp.asp?filename=demo_attributes">Return the attributes of a specified file</a>


<b>ASP Dictionary Object</b>


<a href="showasp.asp?filename=demo_exists">Does a specified key exist?</a>
<a href="showasp.asp?filename=demo_items">Return an array of all items</a>
<a href="showasp.asp?filename=demo_keys">Return an array of all keys</a>
<a href="showasp.asp?filename=demo_item">Return the value of an item</a>
<a href="showasp.asp?filename=demo_key">Set a key</a>
<a href="showasp.asp?filename=demo_count">Return the number of key/item pairs</a>


<b>ASP AdRotator</b>

<a href="showaspfile.asp?filename=demo_adrotator">Display a different image each time a user visits a page</a>


<b>ASP Browser Capabilities</b>

<a href="showasp.asp?filename=demo_browsercap">Find the type, capabilities, and version of each browser that visits your site</a>


<b>ASP ContentRotator</b>

<a href="showaspfile.asp?filename=demo_contentrotator">Display a different content each time a user visits a page (ASP 3.0)</a>


<b>ASP Content Linking</b>

<a href="showaspfile.asp?filename=demo_contentlinking">Build a table of contents</a>
<a href="showaspfile.asp?filename=demo_contentlinking2">Navigate between pages in a text file</a>


<b>ADO Display</b>


<a href="showfile.asp?filename=demo_display1">Display records</a>
<a href="showfile.asp?filename=demo_display2">Display records in an HTML table</a>
<a href="showfile.asp?filename=demo_display3">Add headers to the HTML table</a>
<a href="showfile.asp?filename=demo_display4">Add colors to the HTML table</a>



<b>ADO Queries</b>


<a href="showfile.asp?filename=demo_query_1">Display records where "Companyname" starts with an A</a>
<a href="showfile.asp?filename=demo_query_2">Display records where "Companyname" is > E</a>
<a href="showfile.asp?filename=demo_query_3">Display only Spanish customers</a>
<a href="showfile.asp?filename=demo_query_4">Let the user choose filter</a>



<b>ADO Sort</b>


<a href="showfile.asp?filename=demo_sort_1">Sort the records on a specified fieldname ascending</a>
<a href="showfile.asp?filename=demo_sort_2">Sort the records on a specified fieldname descending</a>
<a href="showcode.asp?filename=demo_sort_3">Let the user choose what column to sort on</a>


<b>ADO Recordset Object</b>

<a href="showfile.asp?filename=demo_ado_getrows">GetRows</a>

<a href="showfile.asp?filename=demo_display5">GetString</a>


<h2><span class="orange"> VBScript Functions</span></h2>
<table style="border:0;width:100%"><tr><td style="width:33%">
    
<a href="#date">Date/Time functions</a>
      <a href="#conversion">Conversion functions</a>
      <a href="#format">Format functions</a>
    
</td>
    <td style="width:33%">
    
<a href="#math">Math functions</a>
      <a href="#array">Array functions</a>
    
</td>
    <td style="width:34%">
    
<a href="#string">String functions</a>
      <a href="#other">Other functions</a>
    
</td>
  </tr></table>
<h2><a id="date">Date/Time Functions</a></h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%;">Function</th><th>Description</th>
  </tr>
<tr><td><a href="func_cdate.asp">CDate</a></td><td>Converts a valid date and time expression to the variant of 
    subtype Date</td>
  </tr>
<tr><td><a href="func_date.asp">Date</a></td><td>Returns the current system date</td>
  </tr>
<tr><td><a href="func_dateadd.asp">DateAdd</a></td><td>Returns a date to which a specified time interval has been 
    added</td>
  </tr>
<tr><td><a href="func_datediff.asp">DateDiff</a></td><td>Returns the number of intervals between two dates</td>
  </tr>
<tr><td><a href="func_datepart.asp">DatePart</a></td><td>Returns the specified part of a given date</td>
  </tr>
<tr><td><a href="func_dateserial.asp">DateSerial</a></td><td>Returns the date for a specified year, 
    month, and day</td>
  </tr>
<tr><td><a href="func_datevalue.asp">DateValue</a></td><td>Returns a date</td>
  </tr>
<tr><td><a href="func_day.asp">Day</a></td><td>Returns a number  that represents the day 
    of the month (between 1 and 31, inclusive)</td>
  </tr>
<tr><td><a href="func_formatdatetime.asp">FormatDateTime</a></td><td>Returns an expression formatted as a date or time</td>
  </tr>
<tr><td><a href="func_hour.asp">Hour</a></td><td>Returns a number that 
    represents the hour of the day (between 0 and 23, inclusive)</td>
  </tr>
<tr><td><a href="func_isdate.asp">IsDate</a></td><td>Returns a Boolean value that indicates if the evaluated 
    expression can be converted to a date</td>
  </tr>
<tr><td><a href="func_minute.asp">Minute</a></td><td>Returns a number that 
    represents the minute of the hour (between 0 and 59, inclusive)</td>
  </tr>
<tr><td><a href="func_month.asp">Month</a></td><td>Returns a number  that 
    represents the month of the year (between 1 and 12, inclusive)</td>
  </tr>
<tr><td><a href="func_monthname.asp">MonthName</a></td><td>Returns the name of a specified month</td>
  </tr>
<tr><td><a href="func_now.asp">Now</a></td><td>Returns the current system date and time</td>
  </tr>
<tr><td><a href="func_second.asp">Second</a></td><td>Returns a number that 
    represents the second of the minute (between 0 and 59, inclusive)</td>
  </tr>
<tr><td><a href="func_time.asp">Time</a></td><td>Returns the current 
    system time</td>
  </tr>
<tr><td><a href="func_timer.asp">Timer</a></td><td>Returns the number of seconds since 12:00 
    AM</td>
  </tr>
<tr><td><a href="func_timeserial.asp">TimeSerial</a></td><td>Returns the time for a 
    specific hour, minute, and second</td>
  </tr>
<tr><td><a href="func_timevalue.asp">TimeValue</a></td><td>Returns a time</td>
  </tr>
<tr><td><a href="func_weekday.asp">Weekday</a></td><td>Returns a number that represents the day of the week 
    (between 1 and 7, inclusive)</td>
  </tr>
<tr><td><a href="func_weekdayname.asp">WeekdayName</a></td><td>Returns the weekday name of a specified day of the week</td>
  </tr>
<tr><td><a href="func_year.asp">Year</a></td><td>Returns a number that represents the year</td>
  </tr>
</table>


<h2><a id="conversion">Conversion Functions</a></h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Function</th><th>Description</th>
  </tr>
<tr><td><a href="func_asc.asp">Asc</a></td><td>Converts the first letter in a string to ANSI code</td>
  </tr>
<tr><td><a href="func_cbool.asp">CBool</a></td><td>Converts an expression to a variant of subtype Boolean</td>
  </tr>
<tr><td><a href="func_cbyte.asp">CByte</a></td><td>Converts an expression to a variant of subtype Byte</td>
  </tr>
<tr><td><a href="func_ccur.asp">CCur</a></td><td>Converts an expression to a variant of subtype Currency</td>
  </tr>
<tr><td><a href="func_cdate.asp">CDate</a></td><td>Converts a valid date and time expression to the variant of 
    subtype Date</td>
  </tr>
<tr><td><a href="func_cdbl.asp">CDbl</a></td><td>Converts an expression to a variant of subtype Double</td>
  </tr>
<tr><td><a href="func_chr.asp">Chr</a></td><td>Converts the specified ANSI code to a character</td>
  </tr>
<tr><td><a href="func_cint.asp">CInt</a></td><td>Converts an expression to a variant of subtype Integer</td>
  </tr>
<tr><td><a href="func_clng.asp">CLng</a></td><td>Converts an expression to a variant of subtype Long</td>
  </tr>
<tr><td><a href="func_csng.asp">CSng</a></td><td>Converts an expression to a variant of subtype Single</td>
  </tr>
<tr><td><a href="func_cstr.asp">CStr</a></td><td>Converts an expression to a variant of subtype String</td>
  </tr>
<tr><td><a href="func_hex.asp">Hex</a></td><td>Returns the hexadecimal value of a specified number</td>
  </tr>
<tr><td><a href="func_oct.asp">Oct</a></td><td>Returns the octal value of a specified number</td>
  </tr>
</table>
<h2><a id="format">Format Functions</a></h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Function</th><th>Description</th>
  </tr>
<tr><td><a href="func_formatcurrency.asp">FormatCurrency</a></td><td>Returns an expression formatted as a currency value</td>
  </tr>
<tr><td><a href="func_formatdatetime.asp">FormatDateTime</a></td><td>Returns an expression formatted as a date or time</td>
  </tr>
<tr><td><a href="func_formatnumber.asp">FormatNumber</a></td><td>Returns an expression formatted as a number</td>
  </tr>
<tr><td><a href="func_formatpercent.asp">FormatPercent</a></td><td>Returns an expression formatted as a percentage</td>
  </tr>
</table>
<h2><a id="math">Math Functions</a></h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Function</th><th>Description</th>
  </tr>
<tr><td><a href="func_abs.asp">Abs</a></td><td>Returns the absolute value of a specified number</td>
  </tr>
<tr><td><a href="func_atn.asp">Atn</a></td><td>Returns the arctangent of a specified number</td>
  </tr>
<tr><td><a href="func_cos.asp">Cos</a></td><td>Returns the cosine of a specified number (angle)</td>
  </tr>
<tr><td><a href="func_exp.asp">Exp</a></td><td>Returns <i>e</i> raised to 
    a power</td>
  </tr>
<tr><td><a href="func_hex.asp">Hex</a></td><td>Returns the hexadecimal value of a 
    specified number</td>
  </tr>
<tr><td><a href="func_int.asp">Int</a></td><td>Returns the integer part of a specified number</td>
  </tr>
<tr><td><a href="func_fix.asp">Fix</a></td><td>Returns the integer part of a specified number</td>
  </tr>
<tr><td><a href="func_log.asp">Log</a></td><td>Returns the natural logarithm of a specified number</td>
  </tr>
<tr><td><a href="func_oct.asp">Oct</a></td><td>Returns the octal value of a specified number</td>
  </tr>
<tr><td><a href="func_rnd.asp">Rnd</a></td><td>Returns a random number less than 1 but greater or equal to 
    0</td>
  </tr>
<tr><td><a href="func_sgn.asp">Sgn</a></td><td>Returns an integer that indicates the sign of a specified number</td>
  </tr>
<tr><td><a href="func_sin.asp">Sin</a></td><td>Returns the sine of a specified number (angle)</td>
  </tr>
<tr><td><a href="func_sqr.asp">Sqr</a></td><td>Returns the square root of a specified number</td>
  </tr>
<tr><td><a href="func_tan.asp">Tan</a></td><td>Returns the tangent of a specified number (angle)</td>
  </tr>
</table>
<h2><a id="array">Array Functions</a></h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Function</th><th>Description</th>
  </tr>
<tr><td><a href="func_array.asp">Array</a></td><td>Returns a variant containing an array</td>
  </tr>
<tr><td><a href="func_filter.asp">Filter</a></td><td>Returns a zero-based array that contains a subset 
    of a string array based on a filter criteria</td>
  </tr>
<tr><td><a href="func_isarray.asp">IsArray</a></td><td>Returns a Boolean value that indicates whether a 
    specified variable is an array</td>
  </tr>
<tr><td><a href="func_join.asp">Join</a></td><td>Returns a string that consists of a number of substrings 
    in an array</td>
  </tr>
<tr><td><a href="func_lbound.asp">LBound</a></td><td>Returns the smallest subscript for 
    the indicated dimension of an array</td>
  </tr>
<tr><td><a href="func_split.asp">Split</a></td><td>Returns a zero-based, one-dimensional array that contains a 
    specified number of substrings</td>
  </tr>
<tr><td><a href="func_ubound.asp">UBound</a></td><td>Returns the largest subscript for the 
    indicated dimension of an array</td>
  </tr>
</table>
<h2><a id="string">String Functions</a></h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Function</th><th>Description</th>
  </tr>
<tr><td><a href="func_instr.asp">InStr</a></td><td>Returns the position of the first occurrence of 
    one string within another. The search begins at the first character of the 
    string</td>
  </tr>
<tr><td><a href="func_instrrev.asp">InStrRev</a></td><td>Returns the position of the first occurrence of one string 
    within another. The search begins at the last character of the string</td>
  </tr>
<tr><td><a href="func_lcase.asp">LCase</a></td><td>Converts a specified string to lowercase</td>
  </tr>
<tr><td><a href="func_left.asp">Left</a></td><td>Returns a specified number of characters from 
    the left side of a string</td>
  </tr>
<tr><td><a href="func_len.asp">Len</a></td><td>Returns the number of characters in a string</td>
  </tr>
<tr><td><a href="func_ltrim.asp">LTrim</a></td><td>Removes spaces on the left side of a string</td>
  </tr>
<tr><td><a href="func_rtrim.asp">RTrim</a></td><td>Removes spaces on the right side of a string</td>
  </tr>
<tr><td><a href="func_trim.asp">Trim</a></td><td>Removes spaces on both the left and the right side of a 
    string</td>
  </tr>
<tr><td><a href="func_mid.asp">Mid</a></td><td>Returns a specified number of characters from a 
    string</td>
  </tr>
<tr><td><a href="func_replace.asp">Replace</a></td><td>Replaces a specified part of a string with another string a 
    specified number of times</td>
  </tr>
<tr><td><a href="func_right.asp">Right</a></td><td>Returns a specified number of characters from 
    the right side of a string</td>
  </tr>
<tr><td><a href="func_space.asp">Space</a></td><td>Returns a string that consists of a specified number of 
    spaces</td>
  </tr>
<tr><td><a href="func_strcomp.asp">StrComp</a></td><td>Compares two strings and returns a value that represents 
    the result of the comparison</td>
  </tr>
<tr><td><a href="func_string.asp">String</a></td><td>Returns a string that contains a repeating character of a 
    specified length</td>
  </tr>
<tr><td><a href="func_strreverse.asp">StrReverse</a></td><td>Reverses a string</td>
  </tr>
<tr><td><a href="func_ucase.asp">UCase</a></td><td>Converts a specified string to uppercase</td>
  </tr>
</table>
<h2><a id="other">Other Functions</a></h2>
<table class="ws-table-all notranslate">
<tr><th style="width:25%;">Function</th><th>Description</th>
  </tr>
<tr><td><a href="func_createobject.asp">CreateObject</a></td><td>Creates an object of a specified type</td>
  </tr>
<tr><td><a href="func_eval.asp">Eval</a></td><td>Evaluates an expression and returns the result</td>
  </tr>
<tr><td><a href="func_isempty.asp">IsEmpty</a></td><td>Returns a Boolean value that indicates whether a 
    specified variable has been initialized or not</td>
  </tr>
<tr><td><a href="func_isnull.asp">IsNull</a></td><td>Returns a Boolean value that indicates whether 
    a specified expression contains no valid data (Null)</td>
  </tr>
<tr><td><a href="func_isnumeric.asp">IsNumeric</a></td><td>Returns a Boolean value that indicates whether a specified 
    expression can be evaluated as a number</td>
  </tr>
<tr><td><a href="func_isobject.asp">IsObject</a></td><td>Returns a Boolean value that indicates whether the 
    specified expression is an automation object</td>
  </tr>
<tr><td><a href="func_rgb.asp">RGB</a></td><td>Returns a number that represents an RGB 
    color value</td>
  </tr>
<tr><td><a href="func_round.asp">Round</a></td><td>Rounds a number</td>
  </tr>
<tr><td><a href="func_scriptengine.asp">ScriptEngine</a></td><td>Returns the scripting 
    language in use</td>
  </tr>
<tr><td><a href="func_scriptengine.asp">ScriptEngineBuildVersion</a></td><td>Returns the build version number of the 
    scripting engine in use</td>
  </tr>
<tr><td><a href="func_scriptengine.asp">ScriptEngineMajorVersion</a></td><td>Returns the major version number of the 
    scripting engine in use</td>
  </tr>
<tr><td><a href="func_scriptengine.asp">ScriptEngineMinorVersion</a></td><td>Returns the minor version number of the 
    scripting engine in use</td>
  </tr>
<tr><td><a href="func_typename.asp">TypeName</a></td><td>Returns the subtype 
    of a specified variable</td>
  </tr>
<tr><td><a href="func_vartype.asp">VarType</a></td><td>Returns a value that indicates the subtype of a specified 
    variable</td>
  </tr>
</table>


 id="mypagediv2" style="position:relative;text-align:center;">



<h2><span class="orange"> VBScript Keywords</span></h2>
<table class="ws-table-all notranslate">
<tr><th>Keyword</th><th>Description</th>
  </tr>
<tr><td>Empty</td><td>
    Used to indicate an uninitialized variable value. A 
    variable value is uninitialized when it is first created and no value is 
    assigned to it, or when a variable value is explicitly set to empty.

    Example:

    Dim x   
    'the variable x is uninitialized!

    x="ff"   'the variable x is NOT uninitialized anymore

    x=Empty   'the variable x is uninitialized!

    <b>Note:</b> This is not the same as Null!!

</td>
  </tr>
<tr><td>IsEmpty</td><td>
Used to test if a variable is uninitialized.

    Example: If (IsEmpty(x)) 'is x uninitialized?

</td>
  </tr>
<tr><td>Nothing</td><td>Used to indicate an uninitialized object value, or to 
    disassociate an object variable from an object to release system resources.Example: 
    Set myObject=Nothing

</td>
  </tr>
<tr><td>Is Nothing</td><td>Used to test if a value is an initialized object.
    Example: If (myObject Is Nothing) 'is it unset?

    <b>Note:</b> If you compare a value to Nothing, you will not get the 
    right result! Example: If (myObject = Nothing) 'always false!

</td>
  </tr>
<tr><td>Null</td><td>Used to indicate that a variable contains no valid data.
    One way to think of Null is that someone has explicitly set the value to 
    "invalid", unlike Empty where the value is "not set".

    <b>Note:</b> This is not the same as Empty or Nothing!!

    Example: x=Null 'x contains no valid data

</td>
  </tr>
<tr><td>IsNull</td><td>Used to test if a value contains invalid data.
    Example: if (IsNull(x)) 'is x invalid?

</td>
  </tr>
<tr><td>True</td><td>Used to indicate a Boolean condition that is correct</td>
  </tr>
<tr><td>False</td><td>Used to indicate a Boolean condition that is not correct (False has a value of 0)</td>
  </tr>
</table>


 id="mypagediv2" style="position:relative;text-align:center;">



<h2><span class="orange"> ASP Response Object</span></h2>

<h2>More Examples</h2>

<a href="showasp.asp?filename=demo_text">Write text with ASP</a>

How to write text with ASP.



<a href="showasp.asp?filename=demo_formatting">Format text with HTML tags in ASP</a>

How to combine text and HTML tags with ASP.



<a href="showasp.asp?filename=demo_redirect">Redirect the user to a different URL</a>

How to redirect the user to a different URL.



<a href="showasp.asp?filename=demo_randomlink">Show a random link</a>

How to create a random link.


<a href="showasp.asp?filename=demo_buffer">Controlling the buffer</a>

How to control the buffer.



<a href="showasp.asp?filename=demo_bufferclear">Clear the buffer</a>

How to clear the buffer.



<a href="showasp.asp?filename=demo_end">End a script in the middle of processing and return the result</a>

How to end a script in the middle of processing.



<a href="showasp.asp?filename=demo_expires">Set how many minutes a page will be cached in a browser before it expires</a>

How to specify how many minutes a page will be cached
in a browser before it expires.



<a href="showasp.asp?filename=demo_expiresabs">Set a date/time when a page cached in a browser will expire</a>

How to specify a date/time a page cached in a browser
will expire.



<a href="showasp.asp?filename=demo_isclientconnected">Check if the user is still connected to the server</a>

How to check if a user is disconnected from the server.



<a href="showasp.asp?filename=demo_contenttype">Set the type of content</a>

How to specify the type of content.



<a href="showasp.asp?filename=demo_charset">Set the name of the character set</a>

How to specify the name of the character set.




<h2>Response Object</h2>
The ASP Response object is used to send output to the user from the server. Its
collections, properties, and methods are described below:


<h3>Collections</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Collection</th><th>Description</th>
  </tr>
<tr><td><a href="coll_cookies_response.asp">Cookies</a></td><td>Sets a cookie value. If the cookie does not exist, it will be created,
      and take the value that is specified</td>
  </tr>
</table>
<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_buffer.asp">Buffer</a></td><td>Specifies whether to buffer the page output or not</td>
  </tr>
<tr><td><a href="prop_cachecontrol.asp">CacheControl</a></td><td>Sets whether a proxy server can cache the output generated
      by ASP or not</td>
  </tr>
<tr><td><a href="prop_charset.asp">Charset</a></td><td>Appends the name of a character-set to the content-type
      header in the Response object</td>
  </tr>
<tr><td><a href="prop_contenttype.asp">ContentType</a></td><td>Sets the HTTP content type for the Response object</td>
  </tr>
<tr><td><a href="prop_expires.asp">Expires</a></td><td>Sets how long (in minutes) a page will be cached on a browser before it
      expires</td>
  </tr>
<tr><td><a href="prop_expiresabsolute.asp">ExpiresAbsolute</a></td><td>Sets a date and time when a page cached on a browser will
      expire</td>
  </tr>
<tr><td><a href="prop_isclientconnected.asp">IsClientConnected</a></td><td>Indicates if the client has disconnected from the server</td>
  </tr>
<tr><td><a href="prop_pics.asp">Pics</a></td><td>Appends a value to the PICS label response header</td>
  </tr>
<tr><td><a href="prop_status.asp">Status</a></td><td>Specifies the value of the status line returned by the
      server</td>
  </tr>
</table>
<h3>Methods</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_addheader.asp">AddHeader</a></td><td>Adds a new HTTP header and a value to the HTTP response</td>
  </tr>
<tr><td><a href="met_appendtolog.asp">AppendToLog</a></td><td>Adds a string to the end of the server log entry</td>
  </tr>
<tr><td><a href="met_binarywrite.asp">BinaryWrite</a></td><td>Writes data directly to the output without any character conversion</td>
  </tr>
<tr><td><a href="met_clear.asp">Clear</a></td><td>Clears any buffered HTML output</td>
  </tr>
<tr><td><a href="met_end.asp">End</a></td><td>Stops processing a script, and returns the current result</td>
  </tr>
<tr><td><a href="met_flush.asp">Flush</a></td><td>Sends buffered HTML output immediately</td>
  </tr>
<tr><td><a href="met_redirect.asp">Redirect</a></td><td>Redirects the user to a different URL</td>
  </tr>
<tr><td><a href="met_write_response.asp">Write</a></td><td>Writes a specified string to the output</td>
  </tr>
</table>

<h2><span class="orange"> ASP Request Object</span></h2>


<h2>QueryString Collection Examples</h2>


<a href="showasphtmfile.asp?filename=demo_simplequerystring">Send query information when a user clicks on a link</a>

How to send query information to a page within a link, and retrieve that information on the
destination page (which is, in this example, the same page).


<a href="showasphtmfile.asp?filename=demo_simplereqquery">A QueryString collection in its simplest use</a>

Use the QueryString collection to retrieve the values from a form (the form uses 
the get method - the information sent is visible to everybody).


<a href="showasphtmfile.asp?filename=demo_reqquery">How to use information from forms</a>

How to use the values retrieved from a form.


<a href="showasphtmfile.asp?filename=demo_reqquery2">More information from a form</a>

What the QueryString collection contains if several input
fields have equal names. It also shows how to use the Count keyword to count the 
"name" property.



<h2>Form Collection Examples</h2>


<a href="showasp.asp?filename=demo_simpleform1">A form collection in its simplest use</a>

How the Form collection retrieves the values from a form (the form uses the post
method - the information sent is invisible to others).


<a href="showasp.asp?filename=demo_simpleform">How to use information from forms</a>

How to use the values retrieved from a form.


<a href="showasp.asp?filename=demo_form2">More information from a form</a>

What the Form collection contains if several
input fields have equal names. It also shows how to use the Count keyword to 
count the "name" property.


<a href="showasp.asp?filename=demo_radiob">A form with radio buttons</a>

How to interact with the user through radio buttons.


<a href="showasp.asp?filename=demo_checkboxes">A form with checkboxes</a>

How to interact with the user through checkboxes.



<h2>Other Examples</h2>


<a href="showasp.asp?filename=demo_server">Get the server variables</a>

How to get the visitor's browser type, IP address, and more. 


<a href="showasp.asp?filename=demo_cookies">Create a welcome cookie</a>

How to create a Welcome Cookie.


<a href="showasp.asp?filename=demo_totalbytes">Find the total number of bytes the user sent</a>

How to find
the total number of bytes the user sent in the Request object.



<h2>Request Object</h2>
When a browser asks for a page from a server, it is called a request. The Request 
object is used to get information from a visitor.
Its collections, properties, and methods are described below:


<h3>Collections</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Collection</th><th>Description</th>
  </tr>
<tr><td>ClientCertificate</td><td>Contains all the field values stored in the client certificate</td>
  </tr>
<tr><td><a href="coll_cookies_request.asp">Cookies</a></td><td>Contains all the cookie values sent in a HTTP request</td>
  </tr>
<tr><td><a href="coll_form.asp">Form</a></td><td>Contains all the form (input) values from a form that uses the post
      method</td>
  </tr>
<tr><td><a href="coll_querystring.asp">QueryString</a></td><td>Contains all the variable values in a HTTP query string</td>
  </tr>
<tr><td><a href="coll_servervariables.asp">ServerVariables</a></td><td>Contains all the server variable values</td>
  </tr>
</table>
<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_totalbytes.asp">TotalBytes</a></td><td>Returns the total number of bytes the client sent in the
      body of the request</td>
  </tr>
</table>
<h3>Methods</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_binaryread.asp">BinaryRead</a></td><td>Retrieves the data sent to the server from the client as part of a
      post request and stores it in a safe array</td>
  </tr>
</table>

<h2><span class="orange"> ASP Application Object</span></h2>
is called an application.
The Application object is used to tie these files together.



<h2>Application Object</h2>

An application on the Web may consists of several ASP files that work together to perform some purpose.
The Application object is used to tie these files together.

The Application object is used to store and access variables from any page, just like the Session object. The difference
is that ALL users share ONE Application object (with Sessions there is ONE Session object for EACH user).

The Application object holds information that will be used by many pages in the application (like database connection information).
The information can be accessed from any page. The information can also be changed in one place, and the changes will automatically be reflected
on all pages.


The Application object's collections, methods, and events are described 
below:


<h3>Collections</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Collection</th><th>Description</th>
  </tr>
<tr><td><a href="coll_contents_app.asp">Contents</a></td><td>Contains all the items appended to the application
      through a script command</td>
  </tr>
<tr><td><a href="coll_staticobjects_app.asp">StaticObjects</a></td><td>Contains all the objects appended to the application with the HTML &lt;object> tag</td>
  </tr>
</table>
<h3>Methods</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_contents_remove_app.asp">Contents.Remove</a></td><td>Deletes an item from the Contents collection</td>
  </tr>
<tr><td><a href="met_contents_removeall_app.asp">Contents.RemoveAll()</a></td><td>Deletes all items from the Contents collection</td>
  </tr>
<tr><td><a href="met_lock_unlock.asp">Lock</a></td><td>Prevents other users from modifying the variables in the
      Application object</td>
  </tr>
<tr><td><a href="met_lock_unlock.asp">Unlock</a></td><td>Enables other users to modify the variables in the Application object
      (after it has been locked using the Lock method)</td>
  </tr>
</table>
<h3>Events</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Event</th><th>Description</th>
  </tr>
<tr><td><a href="ev_app_onend_onstart.asp">Application_OnEnd</a></td><td>Occurs when all user sessions are over, and the application ends</td>
  </tr>
<tr><td><a href="ev_app_onend_onstart.asp">Application_OnStart</a></td><td>Occurs before the first new session is created (when the Application object is first referenced)</td>
  </tr>
</table>

<h2><span class="orange"> ASP Session Object</span></h2>

<h2>More Examples</h2>
<a href="showasp.asp?filename=demo_lcid">Set and return the LCID</a>

Set or return an integer that specifies a location or region. Contents like date,
time, and currency will be displayed according to that location or region.

<a href="showasp.asp?filename=demo_sessionid">Return the SessionID</a>

Return
a unique id for each user. The id is generated by the server.

<a href="showasp.asp?filename=demo_gettimeout">A session's timeout</a>

Set and return the timeout (in minutes) of a session.


<h2>Session Object</h2>
When you are working with an application on your computer, you open it, do some changes and then
you close it. This is much like a Session. The computer knows who you are. It
knows when you open the application and when you close it. However, on the internet there is one
problem: the web server does not know who you are and what you do, because the HTTP address doesn't maintain state. 


ASP solves this problem by creating a unique cookie for each user. The cookie
is sent to the user's computer and it contains information that identifies the user. This
interface is called the Session object. 


The Session object stores information about, or change settings for a user session.

Variables stored in a Session object hold information about one single user, and are available to all pages in one application. Common information
stored in session variables are name, id, and preferences. The server creates a new Session object for each new user, and destroys the Session object when the session expires. 

The Session object's collections, properties, methods, and events are 
described below:


<h3>Collections</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:32%">Collection</th><th>Description</th>
  </tr>
<tr><td><a href="coll_contents_sess.asp">Contents</a></td><td>Contains all the items appended to the session through a script command</td>
  </tr>
<tr><td><a href="coll_staticobjects_sess.asp">StaticObjects</a></td><td>Contains all the objects appended to the session with the HTML
      &lt;object> tag</td>
  </tr>
</table>


<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:32%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_codepage.asp">CodePage</a></td><td>Specifies the character set that will be used when 
    displaying dynamic content</td>
  </tr>
<tr><td><a href="prop_lcid.asp">LCID</a></td><td>Sets or returns an integer that specifies a location or
      region. Contents like date, time, and currency will be displayed according
      to that location or region</td>
  </tr>
<tr><td><a href="prop_sessionid.asp">SessionID</a></td><td>Returns a unique id for each user. The unique id is
      generated by the server</td>
  </tr>
<tr><td><a href="prop_timeout.asp">Timeout</a></td><td>Sets or returns the timeout period (in minutes) for the
      Session object in this application</td>
  </tr>
</table>
<h3>Methods</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:32%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_abandon.asp">Abandon</a></td><td>Destroys a user session</td>
  </tr>
<tr><td><a href="met_contents_remove_sess.asp">Contents.Remove</a></td><td>Deletes an item from the Contents collection</td>
  </tr>
<tr><td><a href="met_contents_removeall_sess.asp">Contents.RemoveAll()</a></td><td>Deletes all items from the Contents collection</td>
  </tr>
</table>
<h3>Events</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:32%">Event</th><th>Description</th>
  </tr>
<tr><td><a href="ev_sess_onend_onstart.asp">Session_OnEnd</a></td><td>Occurs when a session ends</td>
  </tr>
<tr><td><a href="ev_sess_onend_onstart.asp">Session_OnStart</a></td><td>Occurs when a session starts </td>
  </tr>
</table>

      
        <!-- MainLeaderboard-->
        
        
          <script type="text/javascript">googletag.cmd.push(function() { googletag.display('div-gpt-ad-1422003450156-2'); });</script>


      
<h2><span class="orange"> ASP Server Object</span></h2>

<h2>More Examples</h2>
<a href="showasp.asp?filename=demo_lastmodified">When was a file last modified?</a>

Check when a file was last modified.


<a href="showasp.asp?filename=demo_textstream">Open a text file for reading</a>

Open "Textfile.txt" for reading.


<a href="showasp.asp?filename=demo_hitcounter">Homemade hit counter</a>


<h2>Server Object</h2>
The ASP Server object is used to access properties and methods on the server. Its properties and methods are described below:


<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_scripttimeout.asp">ScriptTimeout</a></td><td>Sets or returns the maximum number of seconds a script can run before it is
      terminated</td>
  </tr>
</table>
<h3>Methods</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_createobject_server.asp">CreateObject</a></td><td>Creates an instance of an object</td>
  </tr>
<tr><td><a href="met_execute.asp">Execute</a></td><td>Executes an ASP file from inside another ASP file</td>
  </tr>
<tr><td><a href="met_getlasterror.asp">GetLastError()</a></td><td>Returns an ASPError object that describes the error condition that
      occurred</td>
  </tr>
<tr><td><a href="met_htmlencode.asp">HTMLEncode</a></td><td>Applies HTML encoding to a specified string</td>
  </tr>
<tr><td><a href="met_mappath.asp">MapPath</a></td><td>Maps a specified path to a physical path</td>
  </tr>
<tr><td><a href="met_transfer.asp">Transfer</a></td><td>Sends (transfers) all the information created in one ASP file to a second
      ASP file</td>
  </tr>
<tr><td><a href="met_urlencode.asp">URLEncode</a></td><td>Applies URL encoding rules to a specified string</td>
  </tr>
</table>

<h2><span class="orange"> ASP ASPError Object</span></h2>

<h2>The ASPError Object</h2>
The ASPError object was implemented in ASP 3.0 and is available in IIS5 and later.

The ASPError object is used to display detailed information of any error that occurs
in scripts in an ASP page.

<b>Note:</b> The ASPError object is created when Server.GetLastError is
called, so the error information can only be accessed by using the Server.GetLastError method.

The ASPError object's properties are described below (all properties are read-only):


<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">ASPCode</a></td><td>Returns an error code generated by IIS</td>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">ASPDescription</a></td><td>Returns a detailed description of the error (if the error is ASP-related)</td>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">Category</a></td><td>Returns the source of the error (was the error generated by ASP? By a scripting language? By an object?)</td>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">Column</a></td><td>Returns the column position within the file that generated the error</td>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">Description</a></td><td>Returns a short description of the error</td>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">File</a></td><td>Returns the name of the ASP file that generated the error</td>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">Line</a></td><td>Returns the line number where the error was detected</td>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">Number</a></td><td>Returns the standard COM error code for the error</td>
  </tr>
<tr><td><a href="prop_asperrorobject.asp">Source</a></td><td>Returns the actual source code of the line where the error occurred</td>
  </tr>
</table>

<h2><span class="orange"> ASP FileSystemObject Object</span></h2>
a server.


<h2>More Examples</h2>
<a href="showfile.asp?filename=demo_fileexists">Does a specified file exist?</a>

How to check if a file exists.


<a href="showfile.asp?filename=demo_folderexists">Does a specified folder exist?</a>

How to check if a folder exists.


<a href="showfile.asp?filename=demo_driveexists">Does a specified drive exist?</a>

How to check if a drive exists.


<a href="showfile.asp?filename=demo_getdrivename">Get the name of a specified drive</a>

How to get the name of a specified drive.


<a href="showfile.asp?filename=demo_getparentfoldername">Get the name of the parent folder of a specified path</a>

How to get the name of the parent folder of a specified path.


<a href="showfile.asp?filename=demo_getfilename">Get file name</a>

How to get the file name of the last component in a specified path.


<a href="showfile.asp?filename=demo_getextensionname">Get the file extension</a>

How to get the file extension of the last component in a specified path.


<a href="showfile.asp?filename=demo_getbasename">Get the base name of a file or folder</a>

How to get the base name of a file or folder, in a specified path.


<h2>The FileSystemObject Object</h2>

The FileSystemObject object is used to access the file system on a server.

This object can manipulate files, folders, and directory paths. It is also
possible to retrieve file system information with this object.


The following code creates a text file (c:\test.txt) and then writes some text to
the file:


&lt;%

dim fs,fname

set fs=Server.CreateObject("Scripting.FileSystemObject")

set fname=fs.CreateTextFile("c:\test.txt",true)

fname.WriteLine("Hello World!")

fname.Close

set fname=nothing

set fs=nothing

%>




The FileSystemObject object's properties and methods are described below:

<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:32%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_drives.asp">Drives</a></td><td>Returns a collection of all Drive objects on the computer</td>
  </tr>
</table>
<h3>Methods</h3>

<table class="ws-table-all notranslate">
<tr><th style="width:32%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_buildpath.asp">BuildPath</a></td><td>Appends a name to an existing path</td>
  </tr>
<tr><td><a href="met_copyfile.asp">CopyFile</a></td><td>Copies one or more files from one location to another</td>
  </tr>
<tr><td><a href="met_copyfolder.asp">CopyFolder</a></td><td>Copies one or more folders from one location to another</td>
  </tr>
<tr><td><a href="met_createfolder.asp">CreateFolder</a></td><td>Creates a new folder</td>
  </tr>
<tr><td><a href="met_createtextfile_filesystem.asp">CreateTextFile</a></td><td>Creates a text file and returns a TextStream object that
      can be used to read from, or write to the file</td>
  </tr>
<tr><td><a href="met_deletefile.asp">DeleteFile</a></td><td>Deletes one or more specified files</td>
  </tr>
<tr><td><a href="met_deletefolder.asp">DeleteFolder</a></td><td>Deletes one or more specified folders</td>
  </tr>
<tr><td><a href="met_driveexists.asp">DriveExists</a></td><td>Checks if a specified drive exists</td>
  </tr>
<tr><td><a href="met_fileexists.asp">FileExists</a></td><td>Checks if a specified file exists</td>
  </tr>
<tr><td><a href="met_folderexists.asp">FolderExists</a></td><td>Checks if a specified folder exists</td>
  </tr>
<tr><td><a href="met_getabsolutepathname.asp">GetAbsolutePathName</a></td><td>Returns the complete path from the root of the drive for
      the specified path</td>
  </tr>
<tr><td><a href="met_getbasename.asp">GetBaseName</a></td><td>Returns the base name of a specified file or folder</td>
  </tr>
<tr><td><a href="met_getdrive.asp">GetDrive</a></td><td>Returns a Drive object corresponding to the drive in a specified
      path</td>
  </tr>
<tr><td><a href="met_getdrivename.asp">GetDriveName</a></td><td>Returns the drive name of a specified path</td>
  </tr>
<tr><td><a href="met_getextensionname.asp">GetExtensionName</a></td><td>Returns the file extension name for the last component in a
      specified path</td>
  </tr>
<tr><td><a href="met_getfile.asp">GetFile</a></td><td>Returns a File object for a specified path</td>
  </tr>
<tr><td><a href="met_getfilename.asp">GetFileName</a></td><td>Returns the file name or folder name for the last component in a
      specified path</td>
  </tr>
<tr><td><a href="met_getfolder.asp">GetFolder</a></td><td>Returns a Folder object for a specified path</td>
  </tr>
<tr><td><a href="met_getparentfoldername.asp">GetParentFolderName</a></td><td>Returns the name of the parent folder of the last component in
      a specified path</td>
  </tr>
<tr><td><a href="met_getspecialfolder.asp">GetSpecialFolder</a></td><td>Returns the path to some of Windows' special folders</td>
  </tr>
<tr><td><a href="met_gettempname.asp">GetTempName</a></td><td>Returns a randomly generated temporary file or folder</td>
  </tr>
<tr><td><a href="met_movefile.asp">MoveFile</a></td><td>Moves one or more files from one location to another</td>
  </tr>
<tr><td><a href="met_movefolder.asp">MoveFolder</a></td><td>Moves one or more folders from one location to another</td>
  </tr>
<tr><td><a href="met_opentextfile.asp">OpenTextFile</a></td><td>Opens a file and returns a TextStream object that can be used to access the
      file</td>
  </tr>
</table>

<h2><span class="orange"> ASP TextStream Object</span></h2>

<h2>More Examples</h2>
<a href="showasp.asp?filename=demo_readtextfile">Read textfile</a>

How to 
read from a text file.


<a href="showasp.asp?filename=demo_readpartoftextfile">Read only a part of a textfile</a>

How to only read a part of a TextStream file.


<a href="showasp.asp?filename=demo_readline">Read one line of a textfile</a>

How to read one line from a TextStream file.


<a href="showasp.asp?filename=demo_readlines">Read all lines from a textfile</a>

How to read all the lines from a TextStream file.


<a href="showasp.asp?filename=demo_skip">Skip a part of a textfile</a>

How to skip a specified number of characters when reading the TextStream file.


<a href="showasp.asp?filename=demo_skipline">Skip a line of a textfile</a>

How to skip a line when reading the TextStream file.


<a href="showasp.asp?filename=demo_line">Return line-number</a>

How to return the current line number in a TextStream file.


<a href="showasp.asp?filename=demo_column">Get column number</a>

How to get the column number of the current character in a file.


<h2>The TextStream Object</h2>
The TextStream object is used to access the contents of text files.

The following code creates a text file (c:\test.txt) and then writes some text
to the file (the variable f is an instance of the TextStream object):



&lt;%

dim fs,f

set fs=Server.CreateObject("Scripting.FileSystemObject")

set f=fs.CreateTextFile("c:\test.txt",true)

f.WriteLine("Hello World!")

f.Close

set f=nothing

set fs=nothing

%>

To create an instance of the TextStream object you can use the CreateTextFile or OpenTextFile methods of the FileSystemObject object,
or you can use the OpenAsTextStream method of the File object.

The TextStream object's properties and methods are described below:

<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_atendofline.asp">AtEndOfLine</a></td><td>Returns true if the file pointer is positioned immediately
      before the end-of-line marker in a TextStream file, and false if not</td>
  </tr>
<tr><td><a href="prop_atendofstream.asp">AtEndOfStream</a></td><td>Returns true if the file pointer is at the end of a
      TextStream file, and false if not</td>
  </tr>
<tr><td><a href="prop_column.asp">Column</a></td><td>Returns the column number of the current character position
      in an input stream</td>
  </tr>
<tr><td><a href="prop_line.asp">Line</a></td><td>Returns the current line number in a TextStream file</td>
  </tr>
</table>
<h3>Methods</h3>

<table class="ws-table-all notranslate">
<tr><th style="width:25%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_close.asp">Close</a></td><td>Closes an open TextStream file</td>
  </tr>
<tr><td><a href="met_read.asp">Read</a></td><td>Reads a specified number of characters from a TextStream
      file and returns the result</td>
  </tr>
<tr><td><a href="met_readall.asp">ReadAll</a></td><td>Reads an entire TextStream file and returns the result</td>
  </tr>
<tr><td><a href="met_readline.asp">ReadLine</a></td><td>Reads one line from a TextStream file and returns the result</td>
  </tr>
<tr><td><a href="met_skip.asp">Skip</a></td><td>Skips a specified number of characters when reading a TextStream file</td>
  </tr>
<tr><td><a href="met_skipline.asp">SkipLine</a></td><td>Skips the next line when reading a TextStream file</td>
  </tr>
<tr><td><a href="met_write.asp">Write</a></td><td>Writes a specified text to a TextStream file</td>
  </tr>
<tr><td><a href="met_writeline.asp">WriteLine</a></td><td>Writes a specified text and a new-line character to a TextStream file</td>
  </tr>
<tr><td><a href="met_writeblanklines.asp">WriteBlankLines</a></td><td>Writes a specified number of new-line character to a TextStream file</td>
  </tr>
</table>

<h2><span class="orange"> ASP Drive Object</span></h2>

<h2>More Examples</h2>
<a href="showfile.asp?filename=demo_totalsize">Get the total size of a specified drive</a>

How to get the total size of a specified drive.


<a href="showfile.asp?filename=demo_availablespace">Get the available space of a specified drive</a>

How to get the available space of a specified drive.


<a href="showfile.asp?filename=demo_freespace">Get the free space of a specified drive</a>

How to get the free space of a specified drive.


<a href="showfile.asp?filename=demo_driveletter">Get the drive letter of a specified drive</a>

How to get the drive letter of a specified drive.


<a href="showfile.asp?filename=demo_drivetype">Get the drive type of a specified drive</a>

How to get the drive type of a specified drive.


<a href="showfile.asp?filename=demo_filesystem">Get the file system of a specified drive</a>

How to get the file system of a specified drive.


<a href="showfile.asp?filename=demo_isready">Is the drive ready?</a>

How to check whether a specified drive is ready.


<a href="showfile.asp?filename=demo_path">Get the path of a specified drive</a>

How to get the path of a specified drive.


<a href="showfile.asp?filename=demo_rootfolder">Get the root folder of a specified drive</a>

How to get the root folder of a specified drive.


<a href="showfile.asp?filename=demo_serialnumber">Get the serialnumber of a specified drive</a>

How to get the serialnumber of a specified drive.



<h2>The Drive Object</h2>

The Drive object is used to return information about a local disk drive or a network share.
The Drive object can return information about a drive's type of file system, free space,
serial number, volume name, and more.


<b>Note:</b> You cannot return information about a drive's content with the
Drive object. For this purpose you will have to use the Folder object.


To work with the properties of the Drive object, you will have to create an 
instance of the Drive object through the FileSystemObject
object. First; create a FileSystemObject object and then instantiate the Drive object 
through the GetDrive method or
the Drives property of the FileSystemObject object.


The Drive object's properties are described below:


<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_availablespace.asp">AvailableSpace</a></td><td>Returns the amount of available space to a user on a
      specified drive or network share</td>
  </tr>
<tr><td><a href="prop_driveletter.asp">DriveLetter</a></td><td>Returns one uppercase letter that identifies the local
      drive or a network share</td>
  </tr>
<tr><td><a href="prop_drivetype.asp">DriveType</a></td><td>Returns the type of a specified drive</td>
  </tr>
<tr><td><a href="prop_filesystem.asp">FileSystem</a></td><td>Returns the file system in use for a specified drive</td>
  </tr>
<tr><td><a href="prop_freespace.asp">FreeSpace</a></td><td>Returns the amount of free space to a user on a
      specified drive or network share</td>
  </tr>
<tr><td><a href="prop_isready.asp">IsReady</a></td><td>Returns true if the specified drive is ready and false if
      not</td>
  </tr>
<tr><td><a href="prop_path_drive.asp">Path</a></td><td>Returns an uppercase letter followed by a colon that
      indicates the path name for a specified drive</td>
  </tr>
<tr><td><a href="prop_rootfolder.asp">RootFolder</a></td><td>Returns a Folder object that represents the root folder of a specified
      drive</td>
  </tr>
<tr><td><a href="prop_serialnumber.asp">SerialNumber</a></td><td>Returns the serial number of a specified drive</td>
  </tr>
<tr><td><a href="prop_sharename.asp">ShareName</a></td><td>Returns the network share name for a specified drive</td>
  </tr>
<tr><td><a href="prop_totalsize.asp">TotalSize</a></td><td>Returns the total size of a specified drive or network
      share</td>
  </tr>
<tr><td><a href="prop_volumename.asp">VolumeName</a></td><td>Sets or returns the volume name of a specified drive</td>
  </tr>
</table>

<h2><span class="orange"> ASP File Object</span></h2>

<h2>More Examples</h2>
<a href="showasp.asp?filename=demo_datelastmodified">When was the file last modified?</a>

How to get the date and time a specified file was last modified.


<a href="showasp.asp?filename=demo_datelastaccessed">When was the file last accessed?</a>

How to get the date and time a specified file was last accessed.


<a href="showasp.asp?filename=demo_attributes">Return the attributes of a specified file</a>

How to return the attributes of a specified file.


<h2>The File Object</h2>
The File object is used to return information about a specified file.

To work with the properties and methods of the File object, you will have to 
create an instance of
the File object through the FileSystemObject object. First; create a FileSystemObject
object and then instantiate the File object through the GetFile method of the
FileSystemObject object or through the Files property of the Folder object.

The following code uses the GetFile method of the FileSystemObject object to
instantiate the File object and the DateCreated property to return the date when
the specified file was created:

<h3>Example</h3>
&lt;%

Dim fs,f

Set fs=Server.CreateObject("Scripting.FileSystemObject")

Set f=fs.GetFile("c:\test.txt")

Response.Write("File created: " &amp; f.DateCreated)

set f=nothing

set fs=nothing

%>
<a href="showasp.asp?filename=demo_datecreated">Show Example </a>



The File object's properties and methods are described below:


<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:28%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_attributes_file.asp">Attributes</a></td><td>Sets or returns the attributes of a specified file</td>
  </tr>
<tr><td><a href="prop_datecreated_file.asp">DateCreated</a></td><td>Returns the date and time when a specified file was created</td>
  </tr>
<tr><td><a href="prop_datelastaccessed_file.asp">DateLastAccessed</a></td><td>Returns the date and time when a specified file was last accessed</td>
  </tr>
<tr><td><a href="prop_datelastmodified_file.asp">DateLastModified</a></td><td>Returns the date and time when a specified file was last modified</td>
  </tr>
<tr><td><a href="prop_drive_file.asp">Drive</a></td><td>Returns the drive letter of the drive where a specified 
    file or folder resides</td>
  </tr>
<tr><td><a href="prop_name_file.asp">Name</a></td><td>Sets or returns the name of a specified file</td>
  </tr>
<tr><td><a href="prop_parentfolder_file.asp">ParentFolder</a></td><td>Returns the folder object for the parent of the specified 
    file</td>
  </tr>
<tr><td><a href="prop_path_file.asp">Path</a></td><td>Returns the path for a specified file</td>
  </tr>
<tr><td><a href="prop_shortname_file.asp">ShortName</a></td><td>Returns the short name of a specified file (the 8.3 naming convention)</td>
  </tr>
<tr><td><a href="prop_shortpath_file.asp">ShortPath</a></td><td>Returns the short path of a specified file (the 8.3 naming convention)</td>
  </tr>
<tr><td><a href="prop_size_file.asp">Size</a></td><td>Returns the size, in bytes, of a specified file</td>
  </tr>
<tr><td><a href="prop_type_file.asp">Type</a></td><td>Returns the type of a specified file</td>
  </tr>
</table>
<h3>Methods</h3>

<table class="ws-table-all notranslate">
<tr><th style="width:28%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_copy_file.asp">Copy</a></td><td>Copies a specified file from one location to another</td>
  </tr>
<tr><td><a href="met_delete_file.asp">Delete</a></td><td>Deletes a specified file</td>
  </tr>
<tr><td><a href="met_move_file.asp">Move</a></td><td>Moves a specified file from one location to another</td>
  </tr>
<tr><td>
<a href="met_openastextstream.asp">OpenAsTextStream</a> </td><td>Opens a specified file and returns a TextStream object to access
      the file</td>
  </tr>
</table>

<h2><span class="orange"> ASP Folder Object</span></h2>

<h2>The Folder Object</h2>
The Folder object is used to return information about a specified folder.

To work with the properties and methods of the Folder object, you will have to 
create an instance of the Folder object through the FileSystemObject object. First; create a FileSystemObject
object and then instantiate the Folder object through the GetFolder method of the FileSystemObject object.

The following code uses the GetFolder method of the FileSystemObject object to instantiate the Folder object
and the DateCreated property to return the date when the specified folder was created:



&lt;%

Dim fs,fo

Set fs=Server.CreateObject("Scripting.FileSystemObject")

Set fo=fs.GetFolder("c:\test")

Response.Write("Folder created: " &amp; fo.DateCreated)

set fo=nothing

set fs=nothing

%>


Output:


Folder created: 10/22/2008 10:01:19 AM
The Folder object's collections, properties, and methods are described below: 


<h3>Collections</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Collection</th><th>Description</th>
  </tr>
<tr><td><a href="coll_files.asp">Files</a></td><td>Returns a collection of all the files in a
      specified folder</td>
  </tr>
<tr><td><a href="coll_subfolders.asp">SubFolders</a></td><td>Returns a collection of all subfolders in a specified folder</td>
  </tr>
</table>


<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:25%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_attributes_folder.asp">Attributes</a></td><td>Sets or returns the attributes of a specified folder</td>
  </tr>
<tr><td><a href="prop_datecreated_folder.asp">DateCreated</a></td><td>Returns the date and time when a specified folder was created</td>
  </tr>
<tr><td><a href="prop_datelastaccessed_folder.asp">DateLastAccessed</a></td><td>Returns the date and time when a specified folder was last accessed</td>
  </tr>
<tr><td><a href="prop_datelastmodified_folder.asp">DateLastModified</a></td><td>Returns the date and time when a specified folder was last modified</td>
  </tr>
<tr><td><a href="prop_drive_folder.asp">Drive</a></td><td>Returns the drive letter of the drive where the specified 
    folder resides</td>
  </tr>
<tr><td><a href="prop_isrootfolder.asp">IsRootFolder</a></td><td>Returns true if a folder is the root
      folder and false if not</td>
  </tr>
<tr><td><a href="prop_name_folder.asp">Name</a></td><td>Sets or returns the name of a specified folder</td>
  </tr>
<tr><td><a href="prop_parentfolder_folder.asp">ParentFolder</a></td><td>Returns the parent folder of a specified folder</td>
  </tr>
<tr><td><a href="prop_path_folder.asp">Path</a></td><td>Returns the path for a specified folder</td>
  </tr>
<tr><td><a href="prop_shortname_folder.asp">ShortName</a></td><td>Returns the short name of a specified folder (the 8.3 naming convention)</td>
  </tr>
<tr><td><a href="prop_shortpath_folder.asp">ShortPath</a></td><td>Returns the short path of a specified folder (the 8.3 naming convention)</td>
  </tr>
<tr><td><a href="prop_size_folder.asp">Size</a></td><td>Returns the size of a specified folder</td>
  </tr>
<tr><td><a href="prop_type_folder.asp">Type</a></td><td>Returns the type of a specified folder</td>
  </tr>
</table>
<h3>Methods</h3>

<table class="ws-table-all notranslate">
<tr><th style="width:25%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_copy_folder.asp">Copy</a></td><td>Copies a specified folder from one location to another</td>
  </tr>
<tr><td><a href="met_delete_folder.asp">Delete</a></td><td>Deletes a specified folder</td>
  </tr>
<tr><td><a href="met_move_folder.asp">Move</a></td><td>Moves a specified folder from one location to another</td>
  </tr>
<tr><td><a href="met_createtextfile_folder.asp">CreateTextFile</a></td><td>Creates a new text file in the specified folder and returns a TextStream object to
      access the
      file</td>
  </tr>
</table>

<h2><span class="orange"> ASP Dictionary Object</span></h2>

<h2>More Examples</h2>
<a href="showasp.asp?filename=demo_exists">Does a specified key exist?</a>

How to create a Dictionary object, and then use the Exists method to check if a specified key exists.


<a href="showasp.asp?filename=demo_items">Return an array of all items</a>

How to use the Items method to return an array of all the items.


<a href="showasp.asp?filename=demo_keys">Return an array of all keys</a>

How to use the Keys method to return an array of all the keys.


<a href="showasp.asp?filename=demo_item">Return the value of an item</a>

How to use the Item property to return the value of an item.


<a href="showasp.asp?filename=demo_key">Set a key</a>

How to use the Key property to set a key in a Dictionary object.


<a href="showasp.asp?filename=demo_count">Return the number of key/item pairs</a>

How to use the Count property to return the number of key/item pairs.


<h2>The Dictionary Object</h2>
The Dictionary object is used to store information in name/value pairs 
(referred to as key and item). The Dictionary object might seem similar to 
Arrays, however, the Dictionary object is a more desirable solution to 
manipulate related data.


Comparing Dictionaries and Arrays:



Keys are used to identify the items in a Dictionary object
  You do not have to call ReDim to change the size of the Dictionary object
  When deleting an item from a Dictionary, the remaining items will   automatically shift up
  Dictionaries cannot be multidimensional, Arrays can
  Dictionaries have more built-in functions than Arrays
  Dictionaries work better than arrays on accessing random elements frequently
  Dictionaries work better than arrays on locating items by their content

The following example creates a Dictionary object, adds some key/item 
pairs to it, and retrieves the item value for the key gr:



&lt;%

Dim d

Set d=Server.CreateObject("Scripting.Dictionary")

d.Add "re","Red"

d.Add "gr","Green"

d.Add "bl","Blue"

d.Add "pi","Pink"

Response.Write("The value of key gr is: " &amp; d.Item("gr"))

%>


Output:


The value of key gr is: Green

The Dictionary object's properties and methods are described below: 


<h3>Properties</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:22%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_comparemode.asp">CompareMode</a></td><td>Sets or returns the comparison mode for comparing keys in a Dictionary 
    object</td>
  </tr>
<tr><td><a href="prop_count.asp">Count</a></td><td>Returns the number of key/item pairs in a Dictionary object</td>
  </tr>
<tr><td><a href="prop_item.asp">Item</a></td><td>Sets or returns the value of an item in a Dictionary object</td>
  </tr>
<tr><td><a href="prop_key.asp">Key</a></td><td>Sets a new key value for an existing key value in a 
    Dictionary object</td>
  </tr>
</table>
<h3>Methods</h3>
<table class="ws-table-all notranslate">
<tr><th style="width:22%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_add.asp">Add</a></td><td>Adds a new key/item pair to a Dictionary object</td>
  </tr>
<tr><td><a href="met_exists.asp">Exists</a></td><td>Returns a Boolean value that indicates whether a specified key exists in 
    the Dictionary object</td>
  </tr>
<tr><td><a href="met_items.asp">Items</a></td><td>Returns an array of all the items in a Dictionary
      object</td>
  </tr>
<tr><td><a href="met_keys.asp">Keys</a></td><td>Returns an array of all the keys in a Dictionary
      object</td>
  </tr>
<tr><td><a href="met_remove.asp">Remove</a></td><td>Removes one specified key/item pair from the Dictionary 
    object</td>
  </tr>
<tr><td><a href="met_removeall.asp">RemoveAll</a></td><td>Removes all the key/item pairs in the Dictionary object</td>
  </tr>
</table>

<h2><span class="orange"> ASP AdRotator Component</span></h2>
The ASP AdRotator component creates an AdRotator object that displays a different image each time a user enters or refreshes a page. A
text file includes information about the images.

<strong>Note:</strong> The AdRotator does not work with Internet Information Server 7 (IIS7).


<h3>Syntax</h3>

&lt;%

set adrotator=server.createobject("MSWC.AdRotator")

adrotator.GetAdvertisement("textfile.txt")

%>
<h2>ASP AdRotator Example</h2>
Assume that we have the following text file, named "ads.txt":

REDIRECT banners.asp

*

w3s.gif

https://www.w3schools.com

Free Tutorials from W3Schools

50

xmlspy.gif

https://www.altova.com

XML Editor from Altova

50

The lines below the asterisk in the text file above specifies the name of the images (ads) to be displayed, the
hyperlink addresses, the alternate text (for the images), and the display rates (in percent).

The first line in the text file above specifies what to happen when a visitor clicks on one of the images.
The redirection page (banners.asp) will receive a querystring with the URL to redirect to.

<b>Tip:</b> To specify the height, width, and border of the image, you can insert the following lines under REDIRECT:


      REDIRECT banners.asp

      WIDTH 468 

      HEIGHT 60 

      BORDER 0 

      *

      w3s.gif

      ...

The "banners.asp" file looks like this:

<h3>Example</h3>
&lt;%

url=Request.QueryString("url")

If url&lt;>"" then Response.Redirect(url)

%>


    &lt;!DOCTYPE html>
&lt;html>

&lt;body>

&lt;%

set adrotator=Server.CreateObject("MSWC.AdRotator")

response.write(adrotator.GetAdvertisement("textfile.txt"))

%>

&lt;/body>

&lt;/html>


<a href="showaspfile.asp?filename=demo_adrotator">Show Example </a>

That's all!!



<h2>ASP AdRotator Properties</h2>
<table class="ws-table-all notranslate">
<tr style="vertical-align:top">
<th style="width:20%">Property</th>
    <th style="width:25%">Description</th><th>Example</th>
  </tr>
<tr><td>Border</td><td>Specifies the size of the borders around the advertisement</td><td>&lt;%

    set adrot=Server.CreateObject("MSWC.AdRotator")

    adrot.Border="2"

    Response.Write(adrot.GetAdvertisement("ads.txt"))

    %></td>
  </tr>
<tr><td>Clickable</td><td>Specifies whether the advertisement is a hyperlink</td><td>&lt;%

    set adrot=Server.CreateObject("MSWC.AdRotator")

    adrot.Clickable=false

    Response.Write(adrot.GetAdvertisement("ads.txt"))

    %></td>
  </tr>
<tr><td>TargetFrame</td><td>Name of the frame to display the advertisement</td><td>&lt;%

    set adrot=Server.CreateObject("MSWC.AdRotator")

    adrot.TargetFrame="target='_blank'"

    Response.Write(adrot.GetAdvertisement("ads.txt"))

    %></td>
  </tr>
</table>
<h2>ASP AdRotator Methods</h2>
<table class="ws-table-all notranslate">
<tr style="vertical-align:top">
<th style="width:20%">Method</th>
    <th style="width:25%">Description</th><th>Example</th>
  </tr>
<tr><td>GetAdvertisement</td><td>Returns HTML that displays the advertisement in the page</td><td>&lt;%

    set adrot=Server.CreateObject("MSWC.AdRotator")

    Response.Write(adrot.GetAdvertisement("ads.txt"))

    %></td>
  </tr>
</table>

<h2><span class="orange"> ASP Browser Capabilities Component</span></h2>
The ASP Browser Capabilities component creates a BrowserType object that determines the type, capabilities and version number of a visitor's browser.

When a browser connects to a server, a User Agent header is also sent to the server. This header contains information about the browser.

The BrowserType object compares the information in the header with information in a file on the server called "Browscap.ini".

If there is a match between the browser type and version number in the header and the information in the "Browscap.ini" file, the BrowserType object 
can be used to list the properties of the matching browser. If there is no match for the browser type and version number in the Browscap.ini file, it 
will set every property to "UNKNOWN".


<h3>Syntax</h3>

&lt;%

Set MyBrow=Server.CreateObject("MSWC.BrowserType")

%>
<h2>ASP Browser Capabilities Example</h2>
The example below creates a BrowserType object in an ASP file, and displays  
some of the capabilities of your browser:


<h3>Example</h3>
    &lt;!DOCTYPE html>
&lt;html>

&lt;body>

&lt;%

Set MyBrow=Server.CreateObject("MSWC.BrowserType")

%>


&lt;table border="0" width="100%">

&lt;tr>

&lt;th>Client OS&lt;/th>&lt;th>&lt;%=MyBrow.platform%>&lt;/th>

&lt;/tr>&lt;tr>

&lt;td >Web Browser&lt;/td>&lt;td >&lt;%=MyBrow.browser%>&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Browser version&lt;/td>&lt;td>&lt;%=MyBrow.version%>&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Frame support?&lt;/td>&lt;td>&lt;%=MyBrow.frames%>&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Table support?&lt;/td>&lt;td>&lt;%=MyBrow.tables%>&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Sound support?&lt;/td>&lt;td>&lt;%=MyBrow.backgroundsounds%>&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Cookies support?&lt;/td>&lt;td>&lt;%=MyBrow.cookies%>&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>VBScript support?&lt;/td>&lt;td>&lt;%=MyBrow.vbscript%>&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>JavaScript support?&lt;/td>&lt;td>&lt;%=MyBrow.javascript%>&lt;/td>

&lt;/tr>

&lt;/table>


&lt;/body>

&lt;/html>

Output:


    <table style="width:100%;border:0">
<tr style="text-align:left">
<th>Client OS</th>
        <th>WinNT</th>
      </tr>
<tr><td>Web Browser</td><td>IE</td>
      </tr>
<tr><td>Browser version</td><td>5.0</td>
      </tr>
<tr><td>Frame support?</td><td>True</td>
      </tr>
<tr><td>Table support?</td><td>True</td>
      </tr>
<tr><td>Sound support?</td><td>True</td>
      </tr>
<tr><td>Cookies support?</td><td>True</td>
      </tr>
<tr><td>VBScript support?</td><td>True</td>
      </tr>
<tr><td>JavaScript support?</td><td>True</td>
      </tr>
</table>


<a href="showasp.asp?filename=demo_browsercap" class="w3-btn">Show Example </a>





<h2>The Browscap.ini File</h2>
The "Browscap.ini" file is used to declare properties and to set default values for browsers.

This section is not a tutorial on how to maintain "Browscap.ini" files, it only shows you the basics;
so you get an idea what the file is all about.

The "Browscap.ini" file can contain the following:



[;comments]

[HTTPUserAgentHeader]

[parent=browserDefinition]

[property1=value1]

[propertyN=valueN]

[Default Browser Capability Settings]

[defaultProperty1=defaultValue1]

[defaultPropertyN=defaultValueN]
<table class="ws-table-all notranslate">
<tr><th>Parameter</th><th>Description</th>
  </tr>
<tr><td>comments</td><td>Optional. Any line that starts with a semicolon are ignored by the BrowserType object</td>
  </tr>
<tr><td>HTTPUserAgentHeader</td><td>Optional. Specifies the HTTP User Agent header to associate with the 
    browser-property value statements specified in propertyN. Wildcard characters are allowed</td>
  </tr>
<tr><td>browserDefinition</td><td>Optional. Specifies the HTTP User Agent header-string of a browser to 
    use as the parent browser. The current browser's definition will inherit all 
    of the property values declared in the parent browser's definition</td>
  </tr>
<tr><td>propertyN</td><td>Optional. Specifies the browser properties. The following table lists some possible properties:
ActiveXControls - Support ActiveX controls?
      Backgroundsounds - Support background sounds?
      Cdf - Support Channel Definition Format for Webcasting?
      Tables - Support tables?
      Cookies - Support cookies?
      Frames - Support frames?
      Javaapplets - Support Java applets?
      Javascript - Supports JScript?
      Vbscript - Supports VBScript?
      Browser - Specifies the name of the browser
      Beta - Is the browser beta software?
      Platform - Specifies the platform that the browser runs on
      Version - Specifies the version number of the browser
    
</td>
  </tr>
<tr><td>valueN</td><td>Optional. Specifies the value of propertyN. Can be a string, an integer (prefix with #), or a Boolean value</td>
  </tr>
<tr><td>defaultPropertyN</td><td>Optional. Specifies the name of the browser property to 
    which to assign a default value if none of the defined HTTPUserAgentHeader 
    values match the HTTP User Agent header sent by the browser</td>
  </tr>
<tr><td>defaultValueN</td><td>Optional. Specifies the value of defaultPropertyN. Can be a string, an integer (prefix with #), or a Boolean value</td>
  </tr>
</table>
A "Browscap.ini" file might look something like this:



;IE 5.0

[IE 5.0]

browser=IE

Version=5.0

majorver=#5

minorver=#0

frames=TRUE

tables=TRUE

cookies=TRUE

backgroundsounds=TRUE

vbscript=TRUE

javascript=TRUE

javaapplets=TRUE

ActiveXControls=TRUE

beta=False


;DEFAULT BROWSER

[*]

browser=Default

frames=FALSE

tables=TRUE

cookies=FALSE

backgroundsounds=FALSE

vbscript=FALSE

javascript=FALSE
<h2><span class="orange"> ASP Content Linking Component</span></h2>
<a href="showaspfile.asp?filename=demo_contentlinking">The Content Linking Component</a>

Build a table of contents.


<a href="showaspfile.asp?filename=demo_contentlinking2">The Content Linking Component 2</a>

Use the Content Linking Component to navigate between the pages in a text file.


<h2>ASP Content Linking Component</h2>
The ASP Content Linking component is used to create a quick and easy navigation system!

The Content Linking component returns a Nextlink object that is used to hold a list of Web pages to be navigated.


<h3>Syntax</h3>
&lt;%

Set nl=Server.CreateObject("MSWC.NextLink")

%>

<h2>ASP Content Linking Example</h2>
First we create a text file - "links.txt":


asp_intro.asp    ASP Intro

asp_syntax.asp    ASP Syntax

asp_variables.asp    ASP Variables

asp_procedures.asp    ASP Procedures

The text file above contains the pages to be navigated. The pages must be listed in the same order you want them to be 
displayed, and it must also contain a description for each file name (use the tab key to separate file name from description).

<b>Note:</b> If you want to add a page, or change the order of the pages in the list; you only have to 
modify the text file! The navigation will automatically be corrected!

Then we create an include file, "nlcode.inc". The .inc file creates 
a NextLink object to navigate between the pages listed in "links.txt".

"nlcode.inc":



&lt;%

dim nl

Set nl=Server.CreateObject("MSWC.NextLink")

if (nl.GetListIndex("links.txt")>1) then

   
  Response.Write("&lt;a href='" &amp; nl.GetPreviousURL("links.txt"))

   
  Response.Write("'>Previous Page&lt;/a>")

end if

Response.Write("&lt;a href='" &amp; nl.GetNextURL("links.txt"))

Response.Write("'>Next Page&lt;/a>")

%>
In each of the .asp pages listed in the text file "links.txt", put one line of code: 
<b>&lt;!-- #include file="nlcode.inc"--></b>. This line will include the code in
"nlcode.inc" on every page listed in "links.txt" and the navigation will work.



<h2>ASP Content Linking Component's Methods</h2>
<table class="ws-table-all notranslate">
<tr><th>Method</th><th>Description</th>
    <th style="width:45%">Example</th>
  </tr>
<tr><td>GetListCount</td><td> Returns the number of items listed in the Content Linking List file</td><td> &lt;%

    dim nl,c

    Set nl=Server.CreateObject("MSWC.NextLink") 

    c=nl.GetListCount("links.txt") 

    Response.Write("There are ")

    Response.Write(c)

    Response.Write(" items in the list")

    %>Output:

    There are 4 items in the list

</td>
  </tr>
<tr><td>GetListIndex</td><td> Returns the index number of the current item in the Content Linking 
    List file. The index number of the first item is 1. 0 is returned if the 
    current page is not in the Content Linking List file</td><td> &lt;%

    dim nl,c

    Set nl=Server.CreateObject("MSWC.NextLink") 

    c=nl.GetListIndex("links.txt") 

    Response.Write("Item number ")

    Response.Write(c)

    %>Output:

    Item number 3

</td>
  </tr>
<tr><td>GetNextDescription</td><td> Returns the text description of the next item listed in the Content 
    Linking List file. If the current page is not found in the list file it 
    returns the text description of the last page on the list</td><td> &lt;%

    dim nl,c

    Set nl=Server.CreateObject("MSWC.NextLink") 

    c=nl.GetNextDescription("links.txt") 

    Response.Write("Next ")

    Response.Write("description is: ")

    Response.Write(c)

    %>Next description is: ASP Variables

</td>
  </tr>
<tr><td>GetNextURL</td><td>Returns the URL of the next item listed in the Content Linking List 
    file. If the current page is not found in the list file it returns the URL 
    of the last page on the list</td><td>&lt;%

    dim nl,c

    Set nl=Server.CreateObject("MSWC.NextLink") 

    c=nl.GetNextURL("links.txt") 

    Response.Write("Next ")

    Response.Write("URL is: ")

    Response.Write(c)

    %>Next URL is: asp_variables.asp

</td>
  </tr>
<tr><td>GetNthDescription</td><td> Returns the description of the Nth page listed in the Content Linking 
    List file</td><td> &lt;%

    dim nl,c

    Set nl=Server.CreateObject("MSWC.NextLink") 

    c=nl.GetNthDescription("links.txt",3) 

    Response.Write("Third ")

    Response.Write("description is: ")

    Response.Write(c)

    %>Third description is: ASP Variables

</td>
  </tr>
<tr><td>GetNthURL</td><td>Returns the URL of the Nth page listed in the Content Linking List file</td><td>&lt;%

    dim nl,c

    Set nl=Server.CreateObject("MSWC.NextLink") 

    c=nl.GetNthURL("links.txt",3) 

    Response.Write("Third ")

    Response.Write("URL is: ")

    Response.Write(c)

    %>Third URL is: asp_variables.asp

</td>
  </tr>
<tr><td>GetPreviousDescription</td><td> Returns the text description of the previous item listed in the Content 
    Linking List file. If the current page is not found in the list file it 
    returns the text description of the first page on the list</td><td> &lt;%

    dim nl,c

    Set nl=Server.CreateObject("MSWC.NextLink") 

    c=nl.GetPreviousDescription("links.txt") 

    Response.Write("Previous ")

    Response.Write("description is: ")

    Response.Write(c)

    %>Previous description is: ASP Variables

</td>
  </tr>
<tr><td>GetPreviousURL</td><td> Returns the URL of the previous item listed in the Content Linking List 
    file. If the current page is not found in the list file it returns the URL 
    of the first page on the list</td><td> &lt;%

    dim nl,c

    Set nl=Server.CreateObject("MSWC.NextLink") 

    c=nl.GetPreviousURL("links.txt") 

    Response.Write("Previous ")

    Response.Write("URL is: ")

    Response.Write(c)

    %>Previous URL is: asp_variables.asp

</td>
  </tr>
</table>

<h2><span class="orange"> ASP Content Rotator Component (ASP 3.0)</span></h2>
The ASP Content Rotator component creates a ContentRotator object that displays a
different content string each time a visitor enters or refreshes a page.

A
text file, called the Content Schedule File, includes the information about the content strings.

The content strings can contain HTML tags so you can display any type 
of content that HTML can represent: text, images, colors, or hyperlinks.


<h3>Syntax</h3>


&lt;%

Set cr=Server.CreateObject("MSWC.ContentRotator")

%>
<h2>ASP Content Rotator Example</h2>

The following example displays a different content each time a visitor views 
the Web page.

First, create a text file named "textads.txt" and place it in a subfolder called 
"text".

"textads.txt":



%% #3 

&lt;h2>This is a great day!!&lt;/h2>


%% #3

&lt;img src="smiley.gif">


%% #4

&lt;a href="https://www.w3schools.com">Visit W3Schools.com&lt;/a>
Notice the #number at the beginning of each content string. This number is 
an optional parameter that indicates the relative weight of the HTML content 
string. In the text file above, the Content Rotator will display the first and 
second content 
string three-tenth of the time, and the third string four-tenths of 
the time.

Then, create an ASP file, and insert the following code:


<h3>Example</h3>
&lt;html>

&lt;body>

&lt;%

set cr=server.createobject("MSWC.ContentRotator")

response.write(cr.ChooseContent("text/textads.txt"))

%>

&lt;/body>

&lt;/html>


<a href="showaspfile.asp?filename=demo_contentrotator">Show Example </a>



<h2>ASP Content Rotator Component's Methods</h2>

<table class="ws-table-all notranslate">
<tr><th style="width:15%">Method</th>
    <th style="width:35%">Description</th>
    <th style="width:50%">Example</th>
  </tr>
<tr><td>ChooseContent</td><td>Gets and displays a content string</td><td>&lt;%

    dim cr

    Set cr=Server.CreateObject("MSWC.ContentRotator") 

      response.write(cr.ChooseContent("text/textads.txt"))

    %>Output:

<img src="smiley.gif" alt="Smiley">

</td>
  </tr>
<tr><td>GetAllContent</td><td> Retrieves and displays all of the content strings in the text file</td><td> &lt;%

    dim cr

    Set cr=Server.CreateObject("MSWC.ContentRotator") 

      response.write(cr.GetAllContent("text/textads.txt"))

    %>
    Output:

    <h2>This is a great day!!</h2>
    <img src="smiley.gif" alt="Smiley">

    <a href="https://www.w3schools.com">Visit W3Schools.com</a>

</td>
  </tr>
</table>

<h2><span class="orange"> ASP Quick Reference</span></h2>

<h2>Basic Syntax</h2>

ASP scripts are surrounded by &lt;% and %>.  To write some 
output to a browser:


&lt;html>

&lt;body>

&lt;%
response.write("Hello World!")
%>

&lt;/body>

&lt;/html>


The default language in ASP is VBScript. To use another scripting language, 
insert a language specification at the top of the ASP page:


&lt;%@ language="javascript" %>

&lt;html>

&lt;body>


&lt;%

....

%>


<h2>Forms and User Input</h2>

Request.QueryString is used to collect values in a form with method="get". 
Information sent from a form with the GET method is visible to everyone (it will 
be displayed in the browser's address bar) and has limits on the amount of 
information to send.

Request.Form is used to collect values in a form with method="post". 
Information sent from a form with the POST method is invisible to others and has 
no limits on the amount of information to send.


<h2>ASP Cookies</h2>

A cookie is often used to identify a user. A cookie is a small file that the 
server embeds on the user's computer. Each time the same computer requests for a 
page with a browser, it will send the cookie too.


The Response.Cookies command is used to create cookies:


&lt;%

Response.Cookies("firstname")="Alex"

Response.Cookies("firstname").Expires="May 10,2002"

%>


<b>Note:</b> The Response.Cookies command must appear BEFORE the &lt;html> tag!


The "Request.Cookies" command is used to retrieve a cookie value:


&lt;%

fname=Request.Cookies("firstname")

response.write("Firstname=" &amp; fname)

%>



<h2>Including Files</h2>
 You can insert the content of one ASP file into another ASP file before the 
server executes it, with the #include directive. The #include directive is used 
to create functions, headers, footers, or elements that will be reused on 
multiple pages

Syntax:

&lt;!--#include virtual="somefile.inc"-->

or

&lt;!--#include file ="somefile.inc"-->

Use the virtual keyword to indicate a path beginning with a virtual 
directory. If a file named "header.inc" resides in a virtual directory named 
/html, the following line would insert the contents of "header.inc":

&lt;!-- #include virtual ="/html/header.inc" -->

Use the file keyword to indicate a relative path. A relative path begins with 
the directory that contains the including file. If you have a file in the html 
directory, and the file "header.inc" resides in html\headers, the following line 
would insert "header.inc" in your file:

&lt;!-- #include file ="headers\header.inc" -->

Use the file keyword with the syntax (..\) to include a file from a 
higher-level directory.


<h2>Global.asa</h2>
The Global.asa file is an optional file that can contain declarations of 
objects, variables, and methods that can be accessed by every page in an ASP 
application.

 <b>Note:</b> The Global.asa file must be stored in the
root directory of the ASP application, and each application can only have one
Global.asa file.

The Global.asa file can contain only the following:


Application events 
  Session events 
  &lt;object> declarations  
  TypeLibrary declarations 
  the #include directive

<b>Application and Session Events</b>

In Global.asa you can tell the application and session objects what to do 
when the application/session starts and what to do when the application/session 
ends. The code for this is placed in event handlers. <b>Note:</b> We do not use
&lt;% and %>, to
insert scripts in the Global.asa file, we have to put the subroutines inside the
HTML &lt;script> tag:

&lt;script language="vbscript" runat="server">

 sub Application_OnStart

   ' some code

 end sub

 sub Application_OnEnd

   ' some code

 end sub

 sub Session_OnStart

   ' some code

 end sub

 sub Session_OnEnd

   ' some code

 end sub

 &lt;/script>


 <b>&lt;object> Declarations</b>

 It is also possible to create objects with session or application scope in 
 Global.asa by using the &lt;object> tag. <b>Note:</b> The &lt;object> tag should be 
 outside the &lt;script> tag!

 Syntax:

 &lt;object runat="server" scope="scope" id="id"

 {progid="progID"|classid="classID"}>

 .......

 &lt;/object>

 <b>TypeLibrary Declarations</b>

 A TypeLibrary is a container for the contents of a DLL file corresponding to 
 a COM object. By including a call to the TypeLibrary in the Global.asa file, 
 the constants of the COM object can be accessed, and errors can be better 
 reported by the ASP code. If your Web application relies on COM objects that 
 have declared data types in type libraries, you can declare the type libraries 
 in Global.asa.

 Syntax:

  &lt;!--METADATA TYPE="TypeLib"

 file="filename"

 uuid="typelibraryuuid"

 version="versionnumber"

 lcid="localeid"

 -->


<h2>The Session Object</h2>

The Session object is used to store information about, or change settings for 
a user session. Variables stored in the Session object hold information about 
one single user, and are available to all pages in one application.


<b>Collections</b>



Contents - Holds every item added to the session with script commands
  
StaticObjects - Holds every object added to the session with the &lt;object> tag, and a given session
  
Contents.Remove(<i>item/index</i>) - Deletes an item from the Contents collection
  
Contents.RemoveAll() - Deletes every item from the Contents collection

<b>Properties</b>


CodePage - Sets the code page that will be used to display dynamic content
  
LCID - Sets the locale identifier that will be used to display dynamic content
  
SessionID - Returns the session id
  
Timeout - Sets the timeout for the session

<b>Method</b>



Abandon - Kills every object in a session object


<h2>Application Object</h2>
 A group of ASP files that work together to perform some 
 purpose is called an application. The Application object in ASP is used to tie 
 these files together. All users share one Application object. The Application object
should hold information that will be used by many pages in the application (like
database connection information).

<b>Collections</b>



Contents - Holds every item added to the application with script commands
  
StaticObjects - Holds every object added to the application with the &lt;object>
tag
  
Contents.Remove - Deletes an item from a collection
  Contents.RemoveAll - Deletes every item from a collection

<b>Methods</b>


Lock - Prevents a user from changing the application object properties
  
Unlock - Allows a user to change the application object properties


<h2>The Response Object</h2>

The Response Object is used to send output to the user from the server.


<b>Collection</b>


Cookies(name) - Sets a cookie value. If the cookie does not exist, it will
    be created, and take the value that is specified

<b>Properties</b>


Buffer - Whether to buffer the output or not. When the output is buffered,
    the server will hold back the response until all of the server scripts have
    been processed, or until the script calls the Flush or End method. If this
    property is set, it should be before the &lt;html> tag in the ASP file
  CacheControl - Sets whether proxy servers can cache the output or not.
    When set to Public, the output can be cached by a proxy server
  Charset(<i>charset_name) - </i>Sets the name of the character set (like
    "ISO8859-1") to the content type header
  ContentType - Sets the HTTP content type (like "text/html",
    "image/gif", "image/jpeg", "text/plain"). Default
    is "text/html"
  Expires - Sets how long a page will be cached on a browser before it
    expires
  ExpiresAbsolute - Sets a date and time when a page cached on a browser
    will expire
  IsClientConnected - Checks if the client is still connected to the server
  Pics(<i>pics_label</i>) - Adds a value to the pics label response header
  Status - Specifies the value of the status line

<b>Methods</b>


AddHeader(<i>name, value</i>) - Adds an HTML header with a specified value
  AppendToLog <i>string - </i>Adds a string to the end of the server log
    entry
  BinaryWrite(<i>data_to_write</i>) - Writes the given information without
    any character-set conversion
  Clear - Clears the buffered output. Use this method to handle errors. If
    Response.Buffer is not set to true, this method will cause a run-time error
  End - Stops processing the script, and return the current result
  Flush - Sends buffered output immediately. If Response.Buffer is not set
    to true, this method will cause a run-time error
  Redirect(<i>url</i>) - Redirects the user to another url
  Write(<i>data_to_write</i>) - Writes a text to the user


<h2>Request Object</h2>
When a browser asks for a page from a server, it is called a request. The
Request Object is used to get information from the user.

<b>Collection</b>


ClientCertificate - Holds field values stored in the client certificate
  Cookies(<i>name</i>) - Holds cookie values
  Form(<i>element_name</i>) - Holds form (input) values. The form must use
    the post method
  QueryString(<i>variable_name</i>) - Holds variable values in the query
    string
  ServerVariables(<i>server_variable</i>) - Holds server variable values

<b>Property</b>


TotalBytes - Holds the total number of bytes the client is sending in the
    body of the request

<b>Method</b>


BinaryRead - Fetches the data that is sent to the server from the client
    as part of a post request


<h2>Server Object</h2>
The Server Object is used to access properties and methods on the server.

<b>Property</b>


ScriptTimeout - Sets how long a script can run before it is terminated

<b>Method</b>


CreateObject(<i>type_of_object</i>) - Creates an instance of an object
  Execute(<i>path</i>) - Executes an ASP file from inside another ASP
    file. After executing the called ASP file, the control is
    returned to the original ASP file
  GetLastError() - Returns an ASPError object that will describe the error
    that occurred
  HTMLEncode(<i>string</i>) - Applies HTML encoding to a string
  MapPath(<i>path</i>) - Maps a relative or virtual path to a physical path
  Transfer(<i>path</i>) - Sends all of the state information to another ASP
    file for processing. After the transfer, procedural control is not returned
    to the original ASP file
  URLEncode(<i>string</i>) - Applies URL encoding rules to a string

<b>Source : https://www.w3schools.com/asp/asp_quickref.asp</b>


<h2><span class="orange"> ADO Introduction</span></h2>

<h2>What you should already know</h2>
Before you continue you should have a basic understanding of the
following:


HTML
  ASP
  SQL

If you want to study these subjects first, go to our <a href="/default.asp">Home page</a>


<h2>What is ADO?</h2>

ADO is a Microsoft technology
  ADO stands for <b>A</b>ctiveX <b>D</b>ata <b>O</b>bjects
  ADO is a Microsoft Active-X component
  ADO is automatically installed with Microsoft IIS
  ADO is a programming interface to access data in a database


<h2>Accessing a Database from an ASP Page</h2>
The common way to access a database from inside an ASP page is to:

<ol>
Create an ADO connection to a database
  Open the database connection
  Create an ADO recordset
  Open the recordset
  Extract the data you need from the recordset
  Close the recordset
  Close the connection
</ol>

<h2><span class="orange"> ADO Database Connection</span></h2>
to be established.


<h2>Create a DSN-less Database Connection</h2>
The easiest way to connect to a database is to use a DSN-less connection. A
DSN-less connection can be used against any Microsoft Access database on your web site.

If you have a database called "northwind.mdb" located in a web
directory like "c:/webdata/",
you can connect to the database with the following ASP code:


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"

%>

Note, from the example above, that you have to specify the Microsoft Access
database driver (Provider) and the physical path to the database on your
computer.


<h2>Create an ODBC Database Connection</h2>
If you have an ODBC database called "northwind" you can connect to the database with the following
ASP code:


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Open "northwind"

%>

With an ODBC connection, you can connect to any database, on any computer in
your network, as long as an ODBC connection is available.


<h2>An ODBC Connection to an MS Access Database</h2>
Here is how to create a connection to a MS Access Database: 

<ol>
Open the <b>ODBC</b> icon in your Control Panel.
  Choose the <b>System DSN</b> tab.
  Click on <b> Add </b>in the System DSN tab.
  
<b>Select</b> the Microsoft Access Driver. Click <b>Finish.</b>

  In the next screen, click <b> Select</b> to locate the database.
  Give the database a <b>D</b>ata <b>S</b>ource <b>N</b>ame (DSN).
  Click <b> OK</b>.
</ol>
Note that this configuration has to be done on the computer where your web site
is located. If you are running Personal Web Server (PWS)
or Internet Information Server (IIS) on your own computer,
the instructions above will work, but if your web site is located on a remote server, you have to
have physical access to that server, or ask your web
host to do this for you. 


<h2>The ADO Connection Object</h2>
The ADO Connection object is used to create an open connection to a data
source. Through this connection, you can access and manipulate a database.

<a href="ado_ref_connection.asp">View all methods and properties of the Connection object</a>.


<h2><span class="orange"> ADO Recordset</span></h2>
into a
recordset. 


<h2>Create an ADO Table Recordset</h2>
After an ADO Database Connection has been created, as demonstrated in the
previous chapter, it is possible to create an ADO Recordset.  

Suppose we have a database named "Northwind", we can get access to the
"Customers" table inside the database with
the following lines:


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs=Server.CreateObject("ADODB.recordset")

rs.Open "Customers", conn

%>


<h2>Create an ADO SQL Recordset</h2>
We can also get access to the data in the "Customers" table using
SQL:


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs=Server.CreateObject("ADODB.recordset")

rs.Open "Select * from Customers", conn

%>


<h2>Extract Data from the Recordset</h2>
After a recordset is opened, we can extract data from recordset.  

Suppose we have a database named "Northwind", we can get access to the
"Customers" table inside the database with
the following lines:


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs=Server.CreateObject("ADODB.recordset")

rs.Open "Select * from Customers", conn


for each x in rs.fields

  response.write(x.name)

  response.write(" = ")

  response.write(x.value)

next

%>


<h2>The ADO Recordset Object</h2>
The ADO Recordset object is used to hold a set of records from a database table. 

<a href="ado_ref_recordset.asp">View all methods and properties of the Recordset object</a>.


<h2><span class="orange"> ADO Display</span></h2>
display the data in an HTML table. 


<h2>Display the Field Names and Field Values</h2>
We have a database named "Northwind" and we want to display the
data from the "Customers" table (remember to save the file with an 
.asp extension):

<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs = Server.CreateObject("ADODB.recordset")

rs.Open "SELECT * FROM Customers", conn


do until rs.EOF

  for each x in rs.Fields

    Response.Write(x.name)

    Response.Write(" = ")

    Response.Write(x.value &amp; "&lt;br>")

  next

  Response.Write("&lt;br>")

  rs.MoveNext

loop


rs.close

conn.close

%>


&lt;/body>

&lt;/html>

<a href="showfile.asp?filename=demo_display1" class="w3-btn">Show example </a>





<h2>Display the Field Names and Field Values in an HTML Table</h2>
We can also display the data from the "Customers" table inside an HTML
table with the following lines (remember to save the file with an .asp 
extension):

<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs = Server.CreateObject("ADODB.recordset")

rs.Open "SELECT Companyname, Contactname FROM Customers", conn

%>


&lt;table border="1" width="100%">

&lt;%do until rs.EOF%>

  &lt;tr>

  &lt;%for each x in rs.Fields%>

    &lt;td>&lt;%Response.Write(x.value)%>&lt;/td>

  &lt;%next

  rs.MoveNext%>

  &lt;/tr>

&lt;%loop

rs.close

conn.close

%>

&lt;/table>


&lt;/body>

&lt;/html>

<a href="showfile.asp?filename=demo_display2" class="w3-btn">Show example </a>





<h2>Add Headers to the HTML Table</h2>
We want to add headers to the HTML
table to make it more readable (remember to save the file with an .asp 
extension):

<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs = Server.CreateObject("ADODB.recordset")

sql="SELECT Companyname, Contactname FROM Customers"

rs.Open sql, conn

%>


&lt;table border="1" width="100%">

  &lt;tr>

  &lt;%for each x in rs.Fields

    response.write("&lt;th>" &amp; x.name &amp; "&lt;/th>")

  next%>

  &lt;/tr>

  &lt;%do until rs.EOF%>

    &lt;tr>

    &lt;%for each x in rs.Fields%>

      &lt;td>&lt;%Response.Write(x.value)%>&lt;/td>

    &lt;%next

    rs.MoveNext%>

    &lt;/tr>

  &lt;%loop

  rs.close

  conn.close

  %>

&lt;/table>


&lt;/body>

&lt;/html>

<a href="showfile.asp?filename=demo_display3" class="w3-btn">Show example </a>




<h2>More Examples</h2>
<a href="showfile.asp?filename=demo_display4">Add colors to the HTML table</a>

How to add colors to the HTML table to make it look nice.


<h2><span class="orange"> ADO Queries</span></h2>
only a selected set of records and fields to view.


<h2>Display Selected Data</h2>
We want to display only the records from the "Customers" table that have a "Companyname" 
that starts with an A (remember to save the file with an .asp extension):

<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs=Server.CreateObject("ADODB.recordset")

sql="SELECT Companyname, Contactname FROM Customers

WHERE CompanyName LIKE 'A%'"

rs.Open sql, conn

%>


&lt;table border="1" width="100%">

  &lt;tr>

  &lt;%for each x in rs.Fields

    response.write("&lt;th>" &amp; x.name &amp; "&lt;/th>")

  next%>

  &lt;/tr>

  &lt;%do until rs.EOF%>

    &lt;tr>

    &lt;%for each x in rs.Fields%>

      &lt;td>&lt;%Response.Write(x.value)%>&lt;/td>

    &lt;%next

    rs.MoveNext%>

    &lt;/tr>

  &lt;%loop

  rs.close

  conn.close%>

&lt;/table>


&lt;/body>

&lt;/html>

<a href="showfile.asp?filename=demo_query_1">Show example </a>


<h2>More Examples</h2>


<a href="showfile.asp?filename=demo_query_2">Display records 
where "Companyname" is > E</a>

How to display only the records from the "Customers" table that have a "Companyname" 
that is larger than E.


<a href="showfile.asp?filename=demo_query_3">Display only Spanish 
customers</a>

How to display only the Spanish customers from the "Customers" table.


<a href="showfile.asp?filename=demo_query_4">Let the user choose 
filter</a>

Let the user choose which country to show customers from.


<h2><span class="orange"> ADO Sort</span></h2>
set. 


<h2>Sort the Data</h2>
We want to display the "Companyname" and "Contactname" fields from the "Customers" 
table, ordered by "Companyname" (remember to save the file with an .asp extension):

<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs = Server.CreateObject("ADODB.recordset")

sql="SELECT Companyname, Contactname FROM

Customers ORDER BY CompanyName"

rs.Open sql, conn

%>


&lt;table border="1" width="100%">

  &lt;tr>

  &lt;%for each x in rs.Fields

    response.write("&lt;th>" &amp; x.name &amp; "&lt;/th>")

  next%>

  &lt;/tr>

  &lt;%do until rs.EOF%>

    &lt;tr>

    &lt;%for each x in rs.Fields%>

      &lt;td>&lt;%Response.Write(x.value)%>&lt;/td>

    &lt;%next

    rs.MoveNext%>

    &lt;/tr>

  &lt;%loop

  rs.close

  conn.close%>

&lt;/table>


&lt;/body>

&lt;/html>

<a href="showfile.asp?filename=demo_sort_1">Show example </a>



<h2>More Examples</h2>

<a href="showfile.asp?filename=demo_sort_2">Sort the records on a specified fieldname 
descending</a>

How to sort the data on a specified fieldname.

<a href="showcode.asp?filename=demo_sort_3">Let the user choose what column to sort on</a>

Let the user choose what column to sort on.


<h2><span class="orange"> ADO Add Records</span></h2>
table in a database. 


<h2>Add a Record to a Table in a Database</h2>
We want to add a new record to the Customers table in the Northwind database. 
We first create a form that contains the fields we want to collect data from:


&lt;html>

&lt;body>


&lt;form method="post" action="demo_add.asp">

&lt;table>

&lt;tr>

&lt;td>CustomerID:&lt;/td>

&lt;td>&lt;input name="custid">&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Company Name:&lt;/td>

&lt;td>&lt;input name="compname">&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Contact Name:&lt;/td>

&lt;td>&lt;input name="contname">&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Address:&lt;/td>

&lt;td>&lt;input name="address">&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>City:&lt;/td>

&lt;td>&lt;input name="city">&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Postal Code:&lt;/td>

&lt;td>&lt;input name="postcode">&lt;/td>

&lt;/tr>&lt;tr>

&lt;td>Country:&lt;/td>

&lt;td>&lt;input name="country">&lt;/td>

&lt;/tr>

&lt;/table>

&lt;br>&lt;br>

&lt;input type="submit" value="Add New">

&lt;input type="reset" value="Cancel">

&lt;/form>


&lt;/body>

&lt;/html>



When the user presses the submit button the form is sent to a file called "demo_add.asp". 
The "demo_add.asp" file contains the code that will add a new record to the 
Customers table:


&lt;html>

&lt;body>


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


sql="INSERT INTO customers (customerID,companyname,"

sql=sql &amp; "contactname,address,city,postalcode,country)"

sql=sql &amp; " VALUES "

sql=sql &amp; "('" &amp; Request.Form("custid") &amp; "',"

sql=sql &amp; "'" &amp; Request.Form("compname") &amp; "',"

sql=sql &amp; "'" &amp; Request.Form("contname") &amp; "',"

sql=sql &amp; "'" &amp; Request.Form("address") &amp; "',"

sql=sql &amp; "'" &amp; Request.Form("city") &amp; "',"

sql=sql &amp; "'" &amp; Request.Form("postcode") &amp; "',"

sql=sql &amp; "'" &amp; Request.Form("country") &amp; "')"


on error resume next

conn.Execute sql,recaffected

if err&lt;>0 then

  Response.Write("No update permissions!")

else

  Response.Write("&lt;h3>" &amp; recaffected &amp; " record added&lt;/h3>")

end if

conn.close

%>


&lt;/body>

&lt;/html>


<h2>Important</h2>
If you use the SQL INSERT command be aware of the following:


If the table contains a primary key, make sure to append a unique, 
non-Null value to the primary key field (if not, the provider may not append the 
  record, or an error occurs)
  If the table contains an AutoNumber field, do not include this field in 
  the SQL INSERT command (the value of this field will be taken care of 
  automatically by the provider)


<h2>What about Fields With no Data?</h2>
In a MS Access database, you can enter zero-length strings ("") in Text, 
Hyperlink, and Memo fields IF you set the AllowZeroLength property to 
Yes.

<b>Note: </b>Not all databases support zero-length strings and may cause an 
error when a record with blank fields is added. It is important to check what 
data types your database supports.



<h2><span class="orange"> ADO Update Records</span></h2>
table in a database. 


<h2>Update a Record in a Table</h2>
We want to update a record in the Customers table in the Northwind database. 
We first create a table that lists all records in the Customers table:


&lt;html>

&lt;body>

&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"

set rs=Server.CreateObject("ADODB.Recordset")

rs.open "SELECT * FROM customers",conn

%>


&lt;h2>List Database&lt;/h2>

&lt;table border="1" width="100%">

&lt;tr>

&lt;%

for each x in rs.Fields

  response.write("&lt;th>" &amp; ucase(x.name) &amp; "&lt;/th>")

next

%>

&lt;/tr>

&lt;% do until rs.EOF %>

&lt;tr>

&lt;form method="post" action="demo_update.asp">

&lt;%

for each x in rs.Fields

  if lcase(x.name)="customerid" then%>

    &lt;td>

    &lt;input type="submit" name="customerID" value="&lt;%=x.value%>">

    &lt;/td>

  &lt;%else%>

    &lt;td>&lt;%Response.Write(x.value)%>&lt;/td>

  &lt;%end if

next

%>

&lt;/form>

&lt;%rs.MoveNext%>

&lt;/tr>

&lt;%

loop

conn.close

%>

&lt;/table>


&lt;/body>

&lt;/html>



If the user clicks on the button in the "customerID" column he or she will be 
taken to a new file called "demo_update.asp". The "demo_update.asp" file 
contains the source code on how to create input fields based on the fields from 
one record in the database table. It also contains a "Update record" button 
that will save your changes:


&lt;html>

&lt;body>


&lt;h2>Update Record&lt;/h2>

&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


cid=Request.Form("customerID")


if Request.form("companyname")="" then

  set rs=Server.CreateObject("ADODB.Recordset")

  rs.open "SELECT * FROM customers WHERE customerID='" &amp; cid &amp; "'",conn

  %>

  &lt;form method="post" action="demo_update.asp">

  &lt;table>

  &lt;%for each x in rs.Fields%>

  &lt;tr>

  &lt;td>&lt;%=x.name%>&lt;/td>

  &lt;td>&lt;input name="&lt;%=x.name%>" value="&lt;%=x.value%>">&lt;/td>

  &lt;%next%>

  &lt;/tr>

  &lt;/table>

  &lt;br>&lt;br>

  &lt;input type="submit" value="Update record">

  &lt;/form>

&lt;%

else

  sql="UPDATE customers SET "

  sql=sql &amp; "companyname='" &amp; Request.Form("companyname") &amp; "',"

  sql=sql &amp; "contactname='" &amp; Request.Form("contactname") &amp; "',"

  sql=sql &amp; "address='" &amp; Request.Form("address") &amp; "',"

  sql=sql &amp; "city='" &amp; Request.Form("city") &amp; "',"

  sql=sql &amp; "postalcode='" &amp; Request.Form("postalcode") &amp; "',"

  sql=sql &amp; "country='" &amp; Request.Form("country") &amp; "'"

  sql=sql &amp; " WHERE customerID='" &amp; cid &amp; "'"

  on error resume next

  conn.Execute sql

  if err&lt;>0 then

    response.write("No update permissions!")

  else

    response.write("Record " &amp; cid &amp; " was updated!")

  end if

end if

conn.close

%>


&lt;/body>

&lt;/html>


<h2><span class="orange"> ADO Delete Records</span></h2>
table in a database. 


<h2>Delete a Record in a Table</h2>
We want to delete a record in the Customers table in the Northwind database. 
We first create a table that lists all records in the Customers table:


&lt;html>

&lt;body>

&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"

set rs=Server.CreateObject("ADODB.Recordset")

rs.open "SELECT * FROM customers",conn

%>


&lt;h2>List Database&lt;/h2>

&lt;table border="1" width="100%">

&lt;tr>

&lt;%

for each x in rs.Fields

  response.write("&lt;th>" &amp; ucase(x.name) &amp; "&lt;/th>")

next

%>

&lt;/tr>

&lt;% do until rs.EOF %>

&lt;tr>

&lt;form method="post" action="demo_delete.asp">

&lt;%

for each x in rs.Fields

  if x.name="customerID" then%>

    &lt;td>

    &lt;input type="submit" name="customerID" value="&lt;%=x.value%>">

    &lt;/td>

  &lt;%else%>

    &lt;td>&lt;%Response.Write(x.value)%>&lt;/td>

  &lt;%end if

next

%>

&lt;/form>

&lt;%rs.MoveNext%>

&lt;/tr>

&lt;%

loop

conn.close

%>

&lt;/table>


&lt;/body>

&lt;/html>



If the user clicks on the button in the "customerID" column he or she will be 
taken to a new file called "demo_delete.asp". The "demo_delete.asp" file 
contains the source code on how to create input fields based on the fields from 
one record in the database table. It also contains a "Delete record" button 
that will delete the current record:


&lt;html>

&lt;body>


&lt;h2>Delete Record&lt;/h2>

&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


cid=Request.Form("customerID")


if Request.form("companyname")="" then

  set rs=Server.CreateObject("ADODB.Recordset")

  rs.open "SELECT * FROM customers WHERE customerID='" &amp; cid &amp; "'",conn

  %>

  &lt;form method="post" action="demo_delete.asp">

  &lt;table>

  &lt;%for each x in rs.Fields%>

  &lt;tr>

  &lt;td>&lt;%=x.name%>&lt;/td>

  &lt;td>&lt;input name="&lt;%=x.name%>" value="&lt;%=x.value%>">&lt;/td>

  &lt;%next%>

  &lt;/tr>

  &lt;/table>

  &lt;br>&lt;br>

  &lt;input type="submit" value="Delete record">

  &lt;/form>

&lt;%

else

  sql="DELETE FROM customers"

  sql=sql &amp; " WHERE customerID='" &amp; cid &amp; "'"

  on error resume next

  conn.Execute sql

  if err&lt;>0 then

    response.write("No update permissions!")

  else

    response.write("Record " &amp; cid &amp; " was deleted!")

  end if

end if

conn.close

%>


&lt;/body>

&lt;/html>


<h2><span class="orange"> ADO Demonstration</span></h2>
ADO demos.



<h2>Read this First</h2>

If you try to update the database, you will get the error message: "You
do not have permission to update this database". You get this error because
you don't have write access to our server.


BUT, if you copy the code and run it on your own system, you might get the
same error. That is because the system might see you as an anonymous internet user
when you access the file via your browser. In that case, you have to change the access-rights
to get access to the file.



<h3>How to change the access-rights of your Access database?</h3>

Open Windows Explorer, find the .mdb file. Right-click on the .mdb file and 
select Properties. Go to the Security tab and set the access-rights here.



<h2>List, Edit, Update, and Delete Database Records</h2>

<a href="demo_db_list.asp">List, edit, update, and delete database records</a>



<h2>
Add a New Record to a Database
</h2>

<a href="demo_db_add.asp">Add a new record</a>



<h2><span class="orange"> ADO Speed Up With GetString()</span></h2>
of using multiple Response.Write's).


<h2>Multiple Response.Write's</h2>
The following example demonstrates one way of how to display a  
database query in an HTML table:


&lt;html>

&lt;body>


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs = Server.CreateObject("ADODB.recordset")

rs.Open "SELECT Companyname, Contactname FROM Customers", conn

%>


&lt;table border="1" width="100%">

&lt;%do until rs.EOF%>

  &lt;tr>

    &lt;td>&lt;%Response.Write(rs.fields("Companyname"))%>&lt;/td>

    &lt;td>&lt;%Response.Write(rs.fields("Contactname"))%>&lt;/td>

  &lt;/tr>

&lt;%rs.MoveNext

loop%>

&lt;/table>


&lt;%

rs.close

conn.close

set rs = Nothing

set conn = Nothing

%>


&lt;/body>

&lt;/html>

For a large query, this can slow down the script processing time, since 
many Response.Write commands must be processed by the server.

The solution is to have the entire string created, from &lt;table> to &lt;/table>, 
and then output it - using Response.Write just once.



<h2>The GetString() Method</h2>
The GetString() method allows you to display the string with only one Response.Write. 
It also eliminates the do...loop code and the conditional test that checks if 
the recordset is at EOF.

<h3>Syntax</h3>

str = rs.GetString(format,rows,coldel,rowdel,nullexpr)

To create an HTML table with data from a recordset, we only need to use three of the parameters above 
(all parameters are optional):


coldel - the HTML to use as a column-separator
  rowdel - the HTML to use as a row-separator
  nullexpr - the HTML to use if a column is NULL

<b>Note:</b> The GetString() method is an ADO 2.0 feature. You can download ADO 2.0 at
<a href="https://www.microsoft.com/data/download.htm">https://www.microsoft.com/data/download.htm</a>.

In the following example we will use the GetString() method to hold the 
recordset as a string: 

<h3>Example</h3>
&lt;html>

&lt;body>


&lt;%

set conn=Server.CreateObject("ADODB.Connection")

conn.Provider="Microsoft.Jet.OLEDB.4.0"

conn.Open "c:/webdata/northwind.mdb"


set rs = Server.CreateObject("ADODB.recordset")

rs.Open "SELECT Companyname, Contactname FROM Customers", conn


str=rs.GetString(,,"&lt;/td>&lt;td>","&lt;/td>&lt;/tr>&lt;tr>&lt;td>","&amp;nbsp;")

%>


&lt;table border="1" width="100%">

  &lt;tr>

    &lt;td>&lt;%Response.Write(str)%>&lt;/td>

  &lt;/tr>

&lt;/table>


&lt;%

rs.close

conn.close

set rs = Nothing

set conn = Nothing

%>

&lt;/body>

&lt;/html>


<a href="showfile.asp?filename=demo_display5" class="w3-btn">Show example </a>




The str variable above contains a string of all the columns and rows 
returned by the SQL SELECT statement. Between each 
column the HTML 
&lt;/td>&lt;td> will appear, and between each row, the HTML &lt;/td>&lt;/tr>&lt;tr>&lt;td> will 
appear. This will produce the exact HTML we need with only one Response.Write.


<h2><span class="orange"> ADO Command Object</span></h2>
The ADO Command object is used to execute a single query against a database. The query can
perform actions like creating, adding, retrieving, deleting or updating
records.

If the query is used to retrieve data, the data will be returned as a RecordSet object. This means that the retrieved data can be manipulated by
properties, collections, methods, and events of the Recordset object.

The major feature of the Command object is the ability to use stored queries and procedures
with parameters.


<h2>ProgID</h2>

set objCommand=Server.CreateObject("ADODB.command")


<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_comm_activeconn.asp">ActiveConnection</a></td><td>Sets or returns a definition for a connection if the connection is closed, or
      the current Connection object if the connection is open</td>
  </tr>
<tr><td><a href="prop_comm_commandtext.asp">CommandText</a></td><td>Sets or returns a provider command</td>
  </tr>
<tr><td><a href="prop_commandtimeout.asp">CommandTimeout</a></td><td>Sets or returns the number of seconds to wait while attempting to execute a
      command</td>
  </tr>
<tr><td><a href="prop_comm_commandtype.asp">CommandType</a></td><td>Sets or returns the type of a Command object</td>
  </tr>
<tr><td><a href="prop_comm_name.asp">Name</a></td><td>Sets or returns the name of a Command
      object</td>
  </tr>
<tr><td><a href="prop_comm_prepared.asp">Prepared</a></td><td>Sets or returns a Boolean value that, if set to True, indicates that the command should
      save a prepared version of the query before the first execution</td>
  </tr>
<tr><td><a href="prop_comm_state.asp">State</a></td><td>Returns a value that describes if the Command object is open, closed, connecting, executing or
      retrieving data</td>
  </tr>
</table>

<h2>Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_comm_cancel.asp">Cancel</a></td><td>Cancels an execution of a method</td>
  </tr>
<tr><td><a href="met_comm_createparameter.asp">CreateParameter</a></td><td>Creates a new Parameter object</td>
  </tr>
<tr><td><a href="met_comm_execute.asp">Execute</a></td><td>Executes the query, SQL statement or procedure in the
      CommandText property</td>
  </tr>
</table>

<h2>Collections</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Collection</th><th>Description</th>
  </tr>
<tr><td>Parameters</td><td>Contains all the Parameter objects of a Command Object</td>
  </tr>
<tr><td>Properties</td><td>Contains all the Property objects of a Command Object</td>
  </tr>
</table>

<h2><span class="orange"> ADO Connection Object</span></h2>
The ADO Connection Object is used to create an open connection to a data source. Through this
connection, you can access and manipulate
a database.

If you want to access a database multiple times, you should establish a connection using the Connection object.
You can also make a connection to a database by passing a connection string via a Command or Recordset object. However,
this type of connection is only good for one specific, single query.


<h2>ProgID</h2>

set objConnection=Server.CreateObject("ADODB.connection")


<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_conn_attributes.asp">Attributes</a></td><td>Sets or returns the attributes of a Connection
      object</td>
  </tr>
<tr><td><a href="prop_conn_commandtimeout.asp">CommandTimeout</a></td><td>Sets or returns the number of seconds to wait while
      attempting to execute a command</td>
  </tr>
<tr><td><a href="prop_conn_connectionstring.asp">ConnectionString</a></td><td>Sets or returns the details used to create a connection to a data
      source</td>
  </tr>
<tr><td><a href="prop_conn_connectiontimeout.asp">ConnectionTimeout</a></td><td>Sets or returns the number of seconds to wait for a connection to
      open</td>
  </tr>
<tr><td><a href="prop_conn_cursorlocation.asp">CursorLocation</a></td><td>Sets or returns the location of the cursor service</td>
  </tr>
<tr><td><a href="prop_conn_defaultdb.asp">DefaultDatabase</a></td><td>Sets or returns the default database name</td>
  </tr>
<tr><td><a href="prop_conn_isolationlevel.asp">IsolationLevel</a></td><td>Sets or returns the isolation level</td>
  </tr>
<tr><td><a href="prop_conn_mode.asp">Mode</a></td><td>Sets or returns the provider access permission</td>
  </tr>
<tr><td><a href="prop_conn_provider.asp">Provider</a></td><td>Sets or returns the provider name</td>
  </tr>
<tr><td><a href="prop_conn_state.asp">State</a></td><td>Returns a value describing if the connection is open or
      closed</td>
  </tr>
<tr><td><a href="prop_conn_version.asp">Version</a></td><td>Returns the ADO version number</td>
  </tr>
</table>


<h2>Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_conn_begintrans.asp">BeginTrans</a></td><td>Begins a new transaction</td>
  </tr>
<tr><td><a href="met_conn_cancel.asp">Cancel</a></td><td>Cancels an execution</td>
  </tr>
<tr><td><a href="met_conn_close.asp">Close</a></td><td>Closes a connection</td>
  </tr>
<tr><td><a href="met_conn_begintrans.asp">CommitTrans</a></td><td>Saves any changes and ends the current transaction</td>
  </tr>
<tr><td><a href="met_conn_execute.asp">Execute</a></td><td>Executes a query, statement, procedure or provider specific
      text</td>
  </tr>
<tr><td><a href="met_conn_open.asp">Open</a></td><td>Opens a connection</td>
  </tr>
<tr><td><a href="met_conn_openschema.asp">OpenSchema</a></td><td>Returns schema information from the provider about the data
      source</td>
  </tr>
<tr><td><a href="met_conn_begintrans.asp">RollbackTrans</a></td><td>Cancels any changes in the current transaction and ends the
      transaction</td>
  </tr>
</table>

<h2>Events</h2>
<b>Note:</b>  You cannot handle events using VBScript or JScript (only Visual Basic, Visual C++, and Visual J++ languages can handle
events).

<table class="ws-table-all notranslate">
<tr><th style="width:30%">Event</th><th>Description</th>
  </tr>
<tr><td><a href="ev_conn_transcomplete.asp">BeginTransComplete</a></td><td>Triggered after the BeginTrans operation</td>
  </tr>
<tr><td><a href="ev_conn_transcomplete.asp">CommitTransComplete</a></td><td>Triggered after the CommitTrans operation</td>
  </tr>
<tr><td> <a href="ev_conn_connect.asp"> ConnectComplete</a>
</td><td>Triggered after a connection starts</td>
  </tr>
<tr><td> <a href="ev_conn_connect.asp"> Disconnect</a>
</td><td>Triggered after a connection ends</td>
  </tr>
<tr><td> <a href="ev_conn_execute.asp"> ExecuteComplete</a>
</td><td>Triggered after a command has finished executing</td>
  </tr>
<tr><td> <a href="ev_conn_infomessage.asp"> InfoMessage</a>
</td><td>Triggered if a warning occurs during a ConnectionEvent
      operation</td>
  </tr>
<tr><td> <a href="ev_conn_transcomplete.asp"> RollbackTransComplete</a>
</td><td>Triggered after the RollbackTrans operation</td>
  </tr>
<tr><td><a href="ev_conn_connect.asp">WillConnect</a></td><td>Triggered before a connection starts</td>
  </tr>
<tr><td><a href="ev_conn_execute.asp">WillExecute</a></td><td>Triggered before a command is executed</td>
  </tr>
</table>

<h2>Collections</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Collection</th><th>Description</th>
  </tr>
<tr><td>Errors</td><td>Contains all the Error objects of the Connection object</td>
  </tr>
<tr><td>Properties</td><td>Contains all the Property objects of the Connection object</td>
  </tr>
</table>

<h2><span class="orange"> ADO Error Object</span></h2>
The ADO Error object contains details about data access errors that have been generated during a
single operation. 


ADO generates one Error object for each error. Each Error object contains details of the specific
error, and are stored in the Errors collection. To access the errors, you must refer to
a specific connection.

To loop through the Errors collection:


&lt;%

for each objErr in objConn.Errors

  response.write("&lt;p>")

  response.write("Description: ")

  response.write(objErr.Description &amp; "&lt;br>")

  response.write("Help context: ")

  response.write(objErr.HelpContext &amp; "&lt;br>")

  response.write("Help file: ")

  response.write(objErr.HelpFile &amp; "&lt;br>")

  response.write("Native error: ")

  response.write(objErr.NativeError &amp; "&lt;br>")

  response.write("Error number: ")

  response.write(objErr.Number &amp; "&lt;br>")

  response.write("Error source: ")

  response.write(objErr.Source &amp; "&lt;br>")

  response.write("SQL state: ")

  response.write(objErr.SQLState &amp; "&lt;br>")

  response.write("&lt;/p>")

next

%>


<h2>Syntax</h2>

objErr.property


<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_err_description.asp">Description</a></td><td>Returns an error description</td>
  </tr>
<tr><td><a href="prop_err_helpcontext.asp">HelpContext</a></td><td>Returns the context ID of a topic in
      the Microsoft Windows help system</td>
  </tr>
<tr><td><a href="prop_err_helpfile.asp">HelpFile</a></td><td>Returns the full path of the help
      file in the Microsoft Windows help system</td>
  </tr>
<tr><td><a href="prop_err_nativeerror.asp">NativeError</a></td><td>Returns an error code from the provider or the data source</td>
  </tr>
<tr><td><a href="prop_err_number.asp">Number</a></td><td>Returns a unique number that identifies the error</td>
  </tr>
<tr><td><a href="prop_err_source.asp">Source</a></td><td>Returns the name of the object or application that generated the
      error</td>
  </tr>
<tr><td><a href="prop_err_sqlstate.asp">SQLState</a></td><td>Returns a 5-character SQL error code</td>
  </tr>
</table>

<h2><span class="orange"> ADO Field Object</span></h2>
The ADO Field object contains information about a column in a Recordset object. There is one Field object for each
column in the Recordset.



<h2>ProgID</h2>

set objField=Server.CreateObject("ADODB.field")


<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_field_size.asp">ActualSize</a></td><td>Returns the actual length of a field's
      value</td>
  </tr>
<tr><td><a href="prop_field_attributes.asp">Attributes</a></td><td>Sets or returns the attributes of a Field
      object</td>
  </tr>
<tr><td><a href="prop_field_size.asp">DefinedSize</a></td><td>Returns the defined size of a field</td>
  </tr>
<tr><td><a href="prop_field_name.asp">Name</a></td><td>Sets or returns the name of a Field
      object</td>
  </tr>
<tr><td><a href="prop_field_numericscale.asp">NumericScale</a></td><td>Sets or returns the number of decimal places allowed for
      numeric values in a Field
      object</td>
  </tr>
<tr><td><a href="prop_field_originalvalue_underlyingvalue.asp">OriginalValue</a></td><td>Returns the original value of a field</td>
  </tr>
<tr><td><a href="prop_field_precision.asp">Precision</a></td><td>Sets or returns the maximum number of digits allowed when
      representing numeric values in a Field
      object</td>
  </tr>
<tr><td><a href="prop_field_status.asp">Status</a></td><td>Returns the status of a Field object</td>
  </tr>
<tr><td><a href="prop_field_type.asp">Type</a></td><td>Sets or returns the type of a Field object</td>
  </tr>
<tr><td><a href="prop_field_originalvalue_underlyingvalue.asp">UnderlyingValue</a></td><td>Returns the current value of a field</td>
  </tr>
<tr><td><a href="prop_field_value.asp">Value</a></td><td>Sets or returns the value of a Field object </td>
  </tr>
</table>

<h2>Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_field_appendchunk.asp">AppendChunk</a></td><td>Appends long binary or character data to a Field object</td>
  </tr>
<tr><td><a href="met_field_getchunk.asp">GetChunk</a></td><td>Returns all or a part of the contents of a large text or
      binary data Field object</td>
  </tr>
</table>

<h2>Collections</h2>
<table class="ws-table-all notranslate">
<tr><th>Collection</th>
      <th>Description</th></tr>
<tr><td>Properties</td>
      <td>Contains all the Property objects for a Field object</td></tr>
</table>

<h2><span class="orange"> ADO Parameter Object</span></h2>
The ADO Parameter object provides information about a single parameter used in a stored procedure or
query.  

A Parameter object is added to the Parameters Collection when it is created.
The Parameters Collection is associated with a specific Command object, which uses the
Collection to pass parameters in and out of stored procedures and queries.

Parameters can be used to create Parameterized Commands. These commands are (after they have been
defined and stored) using parameters to alter some details of the command before it is executed.
For example, an SQL SELECT statement could use a parameter to define the
criteria of a WHERE clause.

There are four types of parameters: input parameters, output parameters, input/output
parameters and return parameters.


<h2>Syntax</h2>

objectname.property

objectname.method


<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_para_attributes.asp">Attributes</a></td><td>Sets or returns the attributes of a Parameter
      object</td>
  </tr>
<tr><td><a href="prop_para_direction.asp">Direction</a></td><td>Sets or returns how a parameter is passed to or from a
      procedure</td>
  </tr>
<tr><td><a href="prop_para_name.asp">Name</a></td><td>Sets or returns the name of a Parameter
      object</td>
  </tr>
<tr><td><a href="prop_para_numericscale.asp">NumericScale</a></td><td>Sets or returns the number of digits stored to the right
      side of the decimal point for a numeric value of a Parameter object</td>
  </tr>
<tr><td><a href="prop_para_precision.asp">Precision</a></td><td>Sets or returns the maximum number of digits allowed when
      representing numeric values in a Parameter</td>
  </tr>
<tr><td><a href="prop_para_size.asp">Size</a></td><td>Sets or returns the maximum size in bytes or characters of
      a value in a Parameter object</td>
  </tr>
<tr><td><a href="prop_para_type.asp">Type</a></td><td>Sets or returns the type of a Parameter object</td>
  </tr>
<tr><td><a href="prop_para_value.asp">Value</a></td><td>Sets or returns the value of a Parameter object </td>
  </tr>
</table>

<h2>Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_para_appendchunk.asp">AppendChunk</a></td><td>Appends long binary or character data to a Parameter object</td>
  </tr>
<tr><td><a href="met_para_delete.asp">Delete</a></td><td>Deletes an object from the Parameters Collection</td>
  </tr>
</table>

<h2><span class="orange"> ADO Property Object</span></h2>
The ADO Property object represents a dynamic characteristic of an ADO object that is defined by the provider.

Each provider that talks with ADO has different ways of interacting with ADO. Therefore, ADO needs
to store information about the provider in some way. The solution is that the provider gives specific
information (dynamic properties) to ADO. ADO stores each provider property in a Property object
that is again stored in the Properties Collection. The Collection is assigned to
either a Command object, Connection object, Field object, or a Recordset object.


<h2>ProgID</h2>

set objProperty=Server.CreateObject("ADODB.property")


<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:30%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_prop_attributes.asp">Attributes</a></td><td>Returns the attributes of a Property
      object</td>
  </tr>
<tr><td><a href="prop_prop_name.asp">Name</a></td><td>Sets or returns the name of a Property
      object</td>
  </tr>
<tr><td><a href="prop_prop_type.asp">Type</a></td><td>Returns the type of a Property object</td>
  </tr>
<tr><td><a href="prop_prop_value.asp">Value</a></td><td>Sets or returns the value of a Property object </td>
  </tr>
</table>

<h2><span class="orange"> ADO Record Object</span></h2>
The ADO Record object is used to hold a row in a Recordset, a directory, or a
file from a file system.

Only structured databases could be accessed by ADO in versions prior 2.5. In
a structured database, each table has the exact same number of columns in each row, and each column is composed of the same data type.

The Record object allows access to data-sets where the number of columns and/or the data type can
be different from row to row. 


<h2>Syntax</h2>

objectname.property

objectname.method


<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:35%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_rec_activeconn.asp">ActiveConnection</a></td><td>Sets or returns which Connection object a Record object
      belongs to</td>
  </tr>
<tr><td><a href="prop_rec_mode.asp">Mode</a></td><td>Sets or returns the permission for modifying data in a
      Record object</td>
  </tr>
<tr><td><a href="prop_rec_parenturl.asp">ParentURL</a></td><td>Returns the absolute URL of the parent Record</td>
  </tr>
<tr><td><a href="prop_rec_recordtype.asp">RecordType</a></td><td>Returns the type of a Record object</td>
  </tr>
<tr><td><a href="prop_rec_source.asp">Source</a></td><td>Sets or returns the src parameter of the Open method of a Record
      object</td>
  </tr>
<tr><td><a href="prop_rec_state.asp">State</a></td><td>Returns the status of a Record object</td>
  </tr>
</table>

<h2>Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:35%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_rec_cancel.asp">Cancel</a></td><td>Cancels an execution of a CopyRecord, DeleteRecord,
      MoveRecord, or Open call</td>
  </tr>
<tr><td><a href="met_rec_close.asp">Close</a></td><td>Closes a Record object</td>
  </tr>
<tr><td><a href="met_rec_copy_move_record.asp">CopyRecord</a></td><td>Copies a file or directory to another location</td>
  </tr>
<tr><td><a href="met_rec_deleterecord.asp">DeleteRecord</a></td><td>Deletes a file or directory</td>
  </tr>
<tr><td> <a href="met_rec_getchildren.asp"> GetChildren</a>
</td><td>Returns a Recordset object where each row represents the
      files in the directory</td>
  </tr>
<tr><td><a href="met_rec_copy_move_record.asp">MoveRecord</a></td><td>Moves a file or a directory to another location</td>
  </tr>
<tr><td><a href="met_rec_open.asp">Open</a></td><td>Opens an existing Record object or creates a new file or
      directory</td>
  </tr>
</table>


<h2>Collections</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:35%">Collection</th><th>Description</th>
  </tr>
<tr><td>Properties</td><td>A collection of provider-specific properties</td>
  </tr>
<tr><td>Fields</td><td>Contains all the Field objects in the Record object</td>
  </tr>
</table>

<h2>The Fields Collection's Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:35%">Property</th><th>Description</th>
  </tr>
<tr><td>Count</td><td>Returns the number of items in the fields collection.
      Starts at zero.
      Example:

      countfields=rec.Fields.Count

    </td>
  </tr>
<tr><td>Item(named_item/number)</td><td>Returns a specified item in the fields collection.
      Example:

      itemfields=rec.Fields.Item(1)

      or

      itemfields = rec.Fields.Item("Name")

    </td>
  </tr>
</table>

<h2><span class="orange"> ADO Recordset Object</span></h2>
<a href="showfile.asp?filename=demo_ado_getrows">GetRows</a>

This example demonstrates how to use the GetRows method.


<h2>Recordset Object</h2>
The ADO Recordset object is used to hold a set of records from a database table.
A Recordset object consist of records and columns (fields).

In ADO, this object is the most important and the one used most often to 
manipulate data from a database.


<h2>ProgID</h2>

set objRecordset=Server.CreateObject("ADODB.recordset")



When you first open a Recordset, the current record pointer will point to the first record and the BOF and EOF properties are
False. If there are no records, the BOF and EOF property are True.

Recordset objects can support two types of updating: 




<b>Immediate updating</b> - all changes are written immediately to the
    database once you call the Update method.
  
<b>Batch updating</b> - the provider will cache multiple changes and then 
  send them to the database with the UpdateBatch method.

In ADO there are 4 different cursor types defined:




<b>Dynamic cursor</b> - Allows you to see additions, changes, and deletions by other
    users.
  
<b>Keyset cursor - </b>Like a dynamic cursor, except that
    you cannot see additions by other users, and it prevents access to records that other users
    have deleted. Data changes by other users will still be visible.
  
<b>Static cursor </b>- Provides a static copy of a recordset for you to use to find data or generate
    reports. Additions, changes, or deletions by other users will not be visible. This is the only type of cursor allowed when you open a client-side Recordset object.
  
<b>Forward-only cursor </b>- Allows you to only scroll forward through the Recordset. Additions, changes, or deletions by other users will not be visible. 

The cursor type can be set by the CursorType property or by the CursorType
parameter in the Open method.

<b>Note:</b> Not all providers support all methods or properties of the Recordset
object.



<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:35%">Property</th>
    <th style="width:65%">Description</th>
  </tr>
<tr><td><a href="prop_rs_absolute.asp">AbsolutePage</a></td><td>Sets or returns a value that specifies the page number in the Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_absolute.asp">AbsolutePosition</a></td><td>Sets or returns a value that specifies the ordinal position of the current record in the Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_active.asp">ActiveCommand</a></td><td>Returns the Command object associated with the Recordset</td>
  </tr>
<tr><td><a href="prop_rs_active.asp">ActiveConnection</a></td><td>Sets or returns a definition for a connection if the connection is closed,
    or the current Connection object if the connection is open</td>
  </tr>
<tr><td><a href="prop_rs_bofeof.asp">BOF</a></td><td>Returns true if the current record position is before the first record, otherwise false</td>
  </tr>
<tr><td><a href="prop_rs_bookmark.asp">Bookmark</a></td><td>Sets or returns a bookmark. The bookmark saves the position of the current record</td>
  </tr>
<tr><td><a href="prop_rs_cachesize.asp">CacheSize</a></td><td>Sets or returns the number of records that can be cached</td>
  </tr>
<tr><td><a href="prop_rs_cursorlocation.asp">CursorLocation</a></td><td>Sets or returns the location of the cursor service</td>
  </tr>
<tr><td><a href="prop_rs_cursortype.asp">CursorType</a></td><td>Sets or returns the cursor type of a Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_datamember.asp">DataMember</a></td><td>Sets or returns the name of the data member that will be
      retrieved from the object referenced by the DataSource property</td>
  </tr>
<tr><td><a href="prop_rs_datasource.asp">DataSource</a></td><td>Specifies an object containing data to be represented as a Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_editmode.asp">EditMode</a></td><td>Returns the editing status of the current record</td>
  </tr>
<tr><td><a href="prop_rs_bofeof.asp">EOF</a></td><td>Returns true if the current record position is after the last record, otherwise false</td>
  </tr>
<tr><td><a href="prop_rs_filter.asp">Filter</a></td><td>Sets or returns a filter for the data in a Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_index.asp">Index</a></td><td>Sets or returns the name of the current index for a
      Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_locktype.asp">LockType</a></td><td>Sets or returns a value that specifies the type of locking
      when editing a record in a Recordset</td>
  </tr>
<tr><td><a href="prop_rs_marshaloptions.asp">MarshalOptions</a></td><td>Sets or returns a value that specifies which records are to 
    be returned to the server</td>
  </tr>
<tr><td><a href="prop_rs_maxrecords.asp">MaxRecords</a></td><td>Sets or returns the maximum number of records to return to a Recordset object from a query</td>
  </tr>
<tr><td><a href="prop_rs_pagecount.asp">PageCount</a></td><td>Returns the number of pages with data in a Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_pagesize.asp">PageSize</a></td><td>Sets or returns the maximum number of records allowed on a
      single page of a Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_recordcount.asp">RecordCount</a></td><td>Returns the number of records in a Recordset object</td>
  </tr>
<tr><td><a href="prop_rs_sort.asp">Sort</a></td><td>Sets or returns the field names in the Recordset to sort on</td>
  </tr>
<tr><td><a href="prop_rs_source.asp">Source</a></td><td>Sets a string value or a Command object reference, or
      returns a String value that indicates the data source of the Recordset
      object</td>
  </tr>
<tr><td><a href="prop_rs_state.asp">State</a></td><td>Returns a value that describes if the Recordset object is
      open, closed, connecting, executing or retrieving data</td>
  </tr>
<tr><td><a href="prop_rs_status.asp">Status</a></td><td>Returns the status of the current record with regard to
      batch updates or other bulk operations</td>
  </tr>
<tr><td><a href="prop_rs_stayinsync.asp">StayInSync</a></td><td>Sets or returns whether the reference to the child records
      will change when the parent record position changes</td>
  </tr>
</table>

<h2>Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:35%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_rs_addnew.asp">AddNew</a></td><td>Creates a new record</td>
  </tr>
<tr><td><a href="met_rs_cancel.asp">Cancel</a></td><td>Cancels an execution</td>
  </tr>
<tr><td><a href="met_rs_cancelbatch.asp">CancelBatch</a></td><td>Cancels a batch update</td>
  </tr>
<tr><td><a href="met_rs_cancelupdate.asp">CancelUpdate</a></td><td>
Cancels changes made to a record of a Recordset
      object



    </td>
  </tr>
<tr><td><a href="met_rs_clone.asp">Clone</a></td><td>Creates a duplicate of an existing Recordset</td>
  </tr>
<tr><td><a href="met_rs_close.asp">Close</a></td><td>Closes a Recordset</td>
  </tr>
<tr><td><a href="met_rs_comparebookmarks.asp">CompareBookmarks</a></td><td>Compares two bookmarks</td>
  </tr>
<tr><td><a href="met_rs_delete.asp">Delete</a></td><td>Deletes a record or a group of records</td>
  </tr>
<tr><td><a href="met_rs_find.asp">Find</a></td><td>Searches for a record in a Recordset that
      satisfies a specified criteria</td>
  </tr>
<tr><td><a href="met_rs_getrows.asp">GetRows</a></td><td>Copies multiple records from a Recordset object
      into a two-dimensional array</td>
  </tr>
<tr><td><a href="met_rs_getstring.asp">GetString</a></td><td>Returns a Recordset as a string</td>
  </tr>
<tr><td><a href="met_rs_move.asp">Move</a></td><td>Moves the record pointer in a Recordset object</td>
  </tr>
<tr><td><a href="met_rs_movefirst.asp">MoveFirst</a></td><td>Moves the record pointer to the first record</td>
  </tr>
<tr><td><a href="met_rs_movefirst.asp">MoveLast</a></td><td>Moves the record pointer to the last record</td>
  </tr>
<tr><td><a href="met_rs_movefirst.asp">MoveNext</a></td><td>Moves the record pointer to the next record</td>
  </tr>
<tr><td><a href="met_rs_movefirst.asp">MovePrevious</a></td><td>Moves the record pointer to the previous record</td>
  </tr>
<tr><td><a href="met_rs_nextrecordset.asp">NextRecordset</a></td><td>Clears the current Recordset object and returns
      the next Recordset object by looping through a series of commands</td>
  </tr>
<tr><td> <a href="met_rs_open.asp">Open</a>
</td><td>Opens a database element that gives you access
      to records in a table, the results of a query, or to a saved Recordset</td>
  </tr>
<tr><td><a href="met_rs_requery.asp">Requery</a></td><td>Updates the data in a Recordset by re-executing
      the query that made the original Recordset</td>
  </tr>
<tr><td><a href="met_rs_resync.asp">Resync</a></td><td>Refreshes the data in the current Recordset from the original database</td>
  </tr>
<tr><td><a href="met_rs_save.asp">Save</a></td><td>Saves a Recordset object to a file or a Stream
      object</td>
  </tr>
<tr><td><a href="met_rs_seek.asp">Seek</a></td><td>Searches the index of a Recordset to find a
      record that matches the specified values</td>
  </tr>
<tr><td><a href="met_rs_supports.asp">Supports</a></td><td>Returns a boolean value that defines whether or
      not a Recordset object supports a specific type of functionality</td>
  </tr>
<tr><td><a href="met_rs_update.asp">Update</a></td><td>Saves all changes made to a single record 
      in a Recordset object</td>
  </tr>
<tr><td height="15"><a href="met_rs_updatebatch.asp">UpdateBatch</a></td>
    <td height="15">Saves all changes in a Recordset to the database.
    Used when working in batch update mode</td>
  </tr>
</table>

<h2>Events</h2>

<b>Note:</b>  You cannot handle events using VBScript or JScript (only
Visual Basic, Visual C++, and Visual J++ languages can handle events).

<table class="ws-table-all notranslate">
<tr><th style="width:35%">Event</th><th>Description</th>
  </tr>
<tr><td><a href="ev_rs_endofrecordset.asp">EndOfRecordset</a></td><td>Triggered when you try to move to a record after the last record</td>
  </tr>
<tr><td><a href="ev_rs_fetchcomplete.asp">FetchComplete</a></td><td>Triggered after all records in an asynchronous operation have
      been fetched</td>
  </tr>
<tr><td><a href="ev_rs_fetchprogress.asp">FetchProgress</a></td><td>Triggered periodically in an asynchronous operation,
    to state how many more records that have been fetched</td>
  </tr>
<tr><td><a href="ev_rs_fieldchange.asp">FieldChangeComplete</a></td><td>Triggered after the value of a Field object change</td>
  </tr>
<tr><td><a href="ev_rs_move.asp">MoveComplete</a></td><td>Triggered after the current position in the Recordset has changed</td>
  </tr>
<tr><td><a href="ev_rs_recordchange.asp">RecordChangeComplete</a></td><td>Triggered after a record has changed</td>
  </tr>
<tr><td><a href="ev_rs_recordsetchange.asp">RecordsetChangeComplete</a></td><td>Triggered after the Recordset has changed</td>
  </tr>
<tr><td><a href="ev_rs_fieldchange.asp">WillChangeField</a></td><td>Triggered before the value of a Field object change</td>
  </tr>
<tr><td><a href="ev_rs_recordchange.asp">WillChangeRecord</a></td><td>Triggered before a record change</td>
  </tr>
<tr><td><a href="ev_rs_recordsetchange.asp">WillChangeRecordset</a></td><td>Triggered before a Recordset change</td>
  </tr>
<tr><td><a href="ev_rs_move.asp">WillMove</a></td><td>Triggered before the current position in the Recordset changes</td>
  </tr>
</table>

<h2>Collections</h2>

<table class="ws-table-all notranslate">
<tr><th style="width:35%">Collection</th><th>Description</th>
  </tr>
<tr><td>Fields</td><td>Indicates the number of Field objects in the Recordset object</td>
  </tr>
<tr><td>Properties</td><td>Contains all the Property objects in the Recordset object</td>
  </tr>
</table>

<h2>The Fields Collection's Properties</h2>

<table class="ws-table-all notranslate">
<tr><th style="width:35%">Property</th><th>Description</th>
  </tr>
<tr><td>Count</td><td>Returns the number of items in the fields collection. Starts at zero.
      Example:

      countfields=rs.Fields.Count

    </td>
  </tr>
<tr><td>Item(named_item/number)</td><td>Returns a specified item in the fields collection.
      Example:

      itemfields=rs.Fields.Item(1)

      or

      itemfields=rs.Fields.Item("Name")

    </td>
  </tr>
</table>

<h2>The Properties Collection's Properties</h2>

<table class="ws-table-all notranslate">
<tr><th style="width:35%">Property</th><th>Description</th>
  </tr>
<tr><td>Count</td><td>Returns the number of items in the properties collection. Starts at zero.
      Example:

      countprop=rs.Properties.Count

    </td>
  </tr>
<tr><td>Item(named_item/number)</td><td>Returns a specified item in the properties collection.
      Example:

      itemprop = rs.Properties.Item(1)

      or

      itemprop=rs.Properties.Item("Name")

    </td>
  </tr>
</table>

<h2><span class="orange"> ADO Stream Object</span></h2>
The ADO Stream Object is used to read, write, and manage a stream of binary data or text.

A Stream object can be obtained in three ways:


From a URL pointing to a document, a folder, or a Record object
  By instantiating a Stream object to store data for your application
  By opening the default Stream object associated with a Record object


<h2>Syntax</h2>

objectname.property

objectname.method


<h2>Properties</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:40%">Property</th><th>Description</th>
  </tr>
<tr><td><a href="prop_stream_charset.asp">CharSet</a></td><td>Sets or returns a value that specifies into which character set the contents
      are to be
      translated. This property is only used with text Stream objects (type is
      adTypeText)</td>
  </tr>
<tr><td><a href="prop_stream_eos.asp">EOS</a></td><td>Returns whether the current position is at the end of the
      stream or not</td>
  </tr>
<tr><td><a href="prop_stream_lineseparator.asp">LineSeparator</a></td><td>Sets or returns the line separator character used in a text Stream
      object</td>
  </tr>
<tr><td><a href="prop_stream_mode.asp">Mode</a></td><td>Sets or returns the available permissions for modifying
      data</td>
  </tr>
<tr><td><a href="prop_stream_position.asp">Position</a></td><td>Sets or returns the current position (in bytes) from the
      beginning of a Stream object</td>
  </tr>
<tr><td><a href="prop_stream_size.asp">Size</a></td><td>Returns the size of an open Stream
      object</td>
  </tr>
<tr><td><a href="prop_stream_state.asp">State</a></td><td>Returns a value describing if the Stream object is open or
      closed</td>
  </tr>
<tr><td><a href="prop_stream_type.asp">Type</a></td><td>Sets or returns the type of data in a Stream object</td>
  </tr>
</table>


<h2>Methods</h2>
<table class="ws-table-all notranslate">
<tr><th style="width:40%">Method</th><th>Description</th>
  </tr>
<tr><td><a href="met_stream_cancel.asp">Cancel</a></td><td>Cancels an execution of an Open call on a Stream object</td>
  </tr>
<tr><td><a href="met_stream_close.asp">Close</a></td><td>Closes a Stream object</td>
  </tr>
<tr><td><a href="met_stream_copyto.asp">CopyTo</a></td><td>Copies a specified number of characters/bytes from one
      Stream object into another Stream object</td>
  </tr>
<tr><td><a href="met_stream_flush.asp">Flush</a></td><td>Sends the contents of the Stream buffer to the associated
      underlying object</td>
  </tr>
<tr><td> <a href="met_stream_loadfromfile.asp"> LoadFromFile</a>
</td><td>Loads the contents of a file into a Stream object</td>
  </tr>
<tr><td><a href="met_stream_open.asp">Open</a></td><td>Opens a Stream object</td>
  </tr>
<tr><td><a href="met_stream_read.asp">Read</a></td><td>Reads the entire stream or a specified number of bytes from
      a binary Stream object</td>
  </tr>
<tr><td> <a href="met_stream_readtext.asp"> ReadText</a>
</td><td>Reads the entire stream, a line, or a specified number of
      characters from a text Stream object</td>
  </tr>
<tr><td> <a href="met_stream_savetofile.asp"> SaveToFile</a>
</td><td>Saves the binary contents of a Stream object to a file</td>
  </tr>
<tr><td> <a href="met_stream_seteos.asp"> SetEOS</a>
</td><td>Sets the current position to be the end of the stream (EOS)</td>
  </tr>
<tr><td><a href="met_stream_skipline.asp">SkipLine</a></td><td>Skips a line when reading a text Stream</td>
  </tr>
<tr><td><a href="met_stream_write.asp">Write</a></td><td>Writes binary data to a binary Stream object</td>
  </tr>
<tr><td><a href="met_stream_writetext.asp">WriteText</a></td><td>Writes character data to a text Stream object</td>
  </tr>
</table>

<h2><span class="orange"> ADO Data Types</span></h2>
<table class="ws-table-all notranslate">
<tr><th style="width:20%">DataType Enum</th>
    <th style="width:10%">Value</th>
    <th style="width:23%">Access</th>
    <th style="width:23%">SQLServer</th>
    <th style="width:24%">Oracle</th>
  </tr>
<tr><td>adBigInt</td><td>20</td><td> </td><td>BigInt (SQL Server 2000 +)</td><td> </td>
  </tr>
<tr><td>adBinary</td><td>128</td><td> </td><td>Binary

    TimeStamp</td><td>Raw *</td>
  </tr>
<tr><td>adBoolean</td><td>11</td><td>YesNo</td><td>Bit</td><td> </td>
  </tr>
<tr><td>adChar</td><td>129</td><td> </td><td>Char</td><td>Char</td>
  </tr>
<tr><td>adCurrency</td><td>6</td><td>Currency</td><td>Money

    SmallMoney</td><td> </td>
  </tr>
<tr><td>adDate</td><td>7</td><td>Date</td><td>DateTime</td><td> </td>
  </tr>
<tr><td>adDBTimeStamp</td><td>135</td><td>DateTime (Access 97 (ODBC))</td><td>DateTime

    SmallDateTime</td><td>Date</td>
  </tr>
<tr><td>adDecimal</td><td>14</td><td> </td><td> </td><td>Decimal *</td>
  </tr>
<tr><td>adDouble</td><td>5</td><td>Double</td><td>Float</td><td>Float</td>
  </tr>
<tr><td>adGUID</td><td>72</td><td>ReplicationID (Access 97 (OLEDB)), (Access 2000 (OLEDB))</td><td>UniqueIdentifier (SQL Server 7.0 +)</td><td> </td>
  </tr>
<tr><td>adIDispatch</td><td>9</td><td> </td><td> </td><td> </td>
  </tr>
<tr><td>adInteger</td><td>3</td><td>AutoNumber

    Integer

    Long</td><td>Identity (SQL Server 6.5)

    Int

 </td><td>Int *</td>
  </tr>
<tr><td>adLongVarBinary</td><td>205</td><td>OLEObject</td><td>Image</td><td>Long Raw *

    Blob (Oracle 8.1.x)</td>
  </tr>
<tr><td>adLongVarChar</td><td>201</td><td>Memo (Access 97)

    Hyperlink (Access 97)</td><td>Text</td><td>Long *

    Clob (Oracle 8.1.x)</td>
  </tr>
<tr><td>adLongVarWChar</td><td>203</td><td>Memo (Access 2000 (OLEDB))

    Hyperlink (Access 2000 (OLEDB))</td><td>NText (SQL Server 7.0 +)</td><td>NClob (Oracle 8.1.x)</td>
  </tr>
<tr><td>adNumeric</td><td>131</td><td>Decimal (Access 2000 (OLEDB))</td><td>Decimal

    Numeric</td><td>Decimal

    Integer

    Number

    SmallInt</td>
  </tr>
<tr><td>adSingle</td><td>4</td><td>Single</td><td>Real</td><td> </td>
  </tr>
<tr><td>adSmallInt</td><td>2</td><td>Integer</td><td>SmallInt</td><td> </td>
  </tr>
<tr><td>adUnsignedTinyInt</td><td>17</td><td>Byte</td><td>TinyInt</td><td> </td>
  </tr>
<tr><td>adVarBinary</td><td>204</td><td>ReplicationID (Access 97)</td><td>VarBinary</td><td> </td>
  </tr>
<tr><td>adVarChar</td><td>200</td><td>Text (Access 97)</td><td>VarChar</td><td>VarChar</td>
  </tr>
<tr><td>adVariant</td><td>12</td><td> </td><td>Sql_Variant (SQL Server 2000 +)</td><td>VarChar2</td>
  </tr>
<tr><td>adVarWChar</td><td>202</td><td>Text (Access 2000 (OLEDB))</td><td>NVarChar (SQL Server 7.0 +)</td><td>NVarChar2</td>
  </tr>
<tr><td>adWChar</td><td>130</td><td> </td><td>NChar (SQL Server 7.0 +)</td><td> </td>
  </tr>
</table>
* In Oracle 8.0.x - decimal and int are equal to number and number(10).


<script src='https://williamkpchan.github.io/LibDocs/readbook.js'></script>
<script>
var lazyLoadInstance = new LazyLoad({
    elements_selector: ".lazy"
    // ... more custom settings?
});
</script>

</pre></body></html>