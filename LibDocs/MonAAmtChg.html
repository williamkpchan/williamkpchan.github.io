<base target="_blank"><html><head><title>A股成交金额排序表</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!--script src="https://code.jquery.com/jquery-3.6.0.min.js"></script-->
<script src="https://williamkpchan.github.io/lazyload.min.js"></script>
<script src='https://williamkpchan.github.io/mainscript.js'></script>
<script src="https://williamkpchan.github.io/commonfunctions.js"></script>
<script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
<script src="measuretrend.js"></script>
<script type="module" src='https://unpkg.com/tesseract.js@v2.1.0/dist/tesseract.min.js'></script>
<script> var showTopicNumber = false; var topicEnd = "<br>"; var bookid = "pppp"; var markerName = "h3, h4, pk" </script>
<style>
body{width:80%;margin-left: 10%; font-size:24px;}
img {max-width:100%; display: inline-block; margin-top: 2%;margin-bottom: 1%; border-radius:3px; background-color:#149;}
</style></head><body onkeypress="chkKey()"><center>

<h2>A股成交金额排序表</h2>
<center>
<span id="dateAndTime" class="imp"><script>showDateAndTime();</script></span>
<table id="stockTable">
  <thead>
    <tr>
      <th>编号</th>
      <th>股名</th>
      <th>价格变化 %</th>
      <th>成交金额变化 %</th>
    </tr>
  </thead>
  <tbody>
    <!-- Rows will be inserted here -->
  </tbody>
</table>
</center><br><br>

<script>
const codetableStr = '000001 000002 000004 000006 000007 000008 000009 000011 000012 000014 000016 000017 000019 000020 000021 000025 000027 000028 000029 000030 000031 000032 000034 000035 000037 000039 000040 000042 000045 000049 000050 000056 000058 000060 000062 000063 000065 000066 000068 000069 000070 000090 000099 000100 000151 000155 000156 000157 000158 000159 000166 000301 000333 000338 000400 000402 000403 000404 000408 000409 000410 000415 000420 000421 000422 000423 000425 000426 000429 000501 000503 000504 000505 000506 000509 000513 000514 000516 000517 000519 000520 000521 000524 000525 000526 000528 000532 000536 000538 000539 000543 000546 000547 000550 000551 000552 000555 000559 000560 000561 000563 000564 000565 000566 000567 000568 000572 000581 000584 000586 000589 000590 000591 000592 000595 000596 000597 000598 000599 000600 000603 000610 000612 000617 000620 000623 000625 000627 000628 000629 000630 000633 000636 000638 000650 000651 000656 000657 000659 000661 000663 000665 000668 000670 000676 000677 000678 000679 000680 000681 000682 000683 000686 000688 000690 000691 000697 000700 000701 000702 000703 000708 000709 000710 000712 000713 000717 000718 000719 000720 000721 000722 000723 000725 000727 000728 000729 000733 000735 000736 000737 000738 000739 000750 000755 000756 000758 000759 000762 000766 000768 000776 000777 000778 000779 000783 000785 000786 000791 000792 000793 000795 000797 000799 000800 000801 000802 000803 000807 000810 000811 000813 000815 000816 000818 000819 000821 000823 000825 000829 000830 000831 000837 000838 000839 000848 000850 000851 000858 000859 000860 000863 000868 000875 000876 000877 000878 000880 000882 000883 000886 000887 000888 000893 000895 000897 000898 000899 000901 000902 000903 000906 000908 000911 000913 000915 000917 000921 000922 000923 000925 000926 000927 000928 000930 000931 000932 000933 000935 000936 000937 000938 000948 000949 000951 000953 000955 000957 000959 000960 000962 000963 000965 000966 000969 000970 000972 000975 000977 000980 000981 000983 000985 000987 000988 000990 000995 000997 000998 000999 001208 001213 001215 001219 001227 001236 001239 001267 001270 001277 001278 001283 001286 001287 001289 001296 001298 001308 001309 001313 001314 001319 001337 001338 001339 001379 001387 001389 001696 001872 001914 001965 001979 002001 002003 002007 002008 002009 002010 002011 002012 002015 002017 002019 002020 002021 002022 002023 002024 002025 002027 002028 002030 002031 002032 002035 002036 002037 002038 002039 002042 002043 002044 002045 002046 002048 002049 002050 002052 002053 002055 002056 002058 002060 002061 002063 002064 002065 002066 002068 002072 002073 002074 002075 002076 002077 002078 002079 002080 002085 002086 002091 002093 002095 002096 002097 002100 002101 002102 002103 002104 002106 002111 002112 002114 002115 002116 002119 002120 002121 002122 002123 002124 002125 002126 002127 002128 002129 002130 002131 002134 002137 002138 002139 002142 002145 002146 002148 002150 002151 002152 002153 002154 002155 002156 002157 002158 002159 002162 002163 002166 002167 002169 002170 002171 002172 002173 002174 002176 002177 002178 002179 002180 002182 002183 002184 002185 002186 002189 002191 002192 002193 002194 002195 002196 002197 002199 002202 002203 002204 002205 002207 002212 002213 002215 002217 002219 002222 002223 002225 002226 002227 002229 002230 002231 002232 002235 002236 002237 002238 002239 002240 002241 002243 002244 002245 002246 002248 002249 002250 002252 002253 002256 002261 002262 002265 002266 002267 002268 002269 002270 002271 002272 002273 002274 002276 002277 002279 002281 002283 002284 002285 002291 002292 002294 002295 002296 002297 002298 002299 002302 002304 002305 002309 002310 002311 002312 002313 002314 002315 002317 002318 002320 002322 002323 002326 002327 002331 002332 002335 002338 002339 002340 002343 002345 002349 002350 002351 002352 002353 002354 002355 002356 002357 002358 002362 002364 002366 002368 002369 002370 002371 002372 002373 002376 002378 002379 002380 002383 002384 002385 002387 002388 002389 002392 002395 002396 002400 002401 002402 002403 002405 002406 002407 002408 002409 002410 002413 002414 002415 002416 002418 002420 002421 002422 002423 002426 002428 002429 002430 002432 002436 002438 002439 002444 002446 002449 002451 002452 002453 002455 002456 002457 002459 002460 002461 002463 002465 002466 002467 002468 002472 002474 002475 002480 002484 002486 002487 002488 002489 002491 002492 002493 002497 002500 002506 002507 002508 002510 002511 002512 002514 002517 002518 002519 002520 002521 002523 002524 002526 002527 002528 002529 002530 002531 002532 002533 002534 002536 002537 002539 002540 002541 002542 002543 002544 002547 002549 002550 002551 002553 002554 002555 002556 002557 002558 002559 002561 002563 002565 002567 002568 002570 002572 002577 002579 002580 002581 002583 002584 002585 002587 002588 002589 002590 002591 002594 002595 002596 002597 002599 002600 002601 002602 002603 002605 002606 002607 002609 002611 002612 002615 002617 002622 002624 002625 002626 002630 002632 002635 002636 002640 002642 002643 002644 002645 002646 002647 002648 002649 002650 002652 002653 002654 002655 002657 002659 002660 002667 002668 002669 002670 002673 002675 002676 002681 002682 002683 002685 002686 002689 002690 002691 002692 002693 002697 002698 002700 002701 002703 002705 002706 002707 002708 002709 002712 002713 002714 002715 002716 002717 002722 002723 002725 002726 002727 002728 002729 002735 002736 002737 002738 002739 002741 002745 002747 002755 002756 002757 002761 002762 002765 002766 002771 002773 002775 002777 002782 002785 002786 002791 002792 002796 002797 002799 002800 002803 002805 002806 002807 002812 002813 002815 002816 002819 002821 002822 002823 002827 002829 002831 002832 002835 002837 002839 002840 002841 002843 002845 002847 002848 002850 002851 002855 002856 002859 002861 002862 002864 002865 002866 002867 002869 002871 002873 002875 002876 002877 002878 002881 002882 002884 002885 002886 002888 002889 002891 002892 002893 002895 002896 002897 002898 002899 002901 002902 002903 002906 002907 002908 002911 002912 002913 002915 002916 002918 002919 002920 002922 002925 002926 002928 002929 002933 002935 002936 002937 002938 002939 002941 002943 002945 002946 002947 002948 002952 002958 002959 002960 002961 002962 002965 002966 002967 002968 002970 002978 002979 002980 002981 002983 002984 002985 002987 002989 002990 002991 002992 002993 002997 003000 003001 003002 003004 003005 003006 003007 003009 003015 003019 003021 003022 003025 003026 003029 003031 003032 003033 003036 003038 003040 003042 003043 003816 300001 300002 300003 300005 300006 300007 300008 300009 300010 300011 300012 300014 300015 300016 300017 300019 300020 300024 300025 300026 300027 300030 300031 300032 300033 300034 300035 300036 300037 300039 300040 300042 300043 300044 300045 300046 300047 300049 300050 300051 300052 300053 300054 300056 300058 300059 300061 300062 300063 300065 300067 300068 300069 300070 300071 300072 300073 300075 300076 300077 300078 300079 300080 300081 300083 300085 300086 300087 300088 300091 300093 300094 300096 300097 300098 300100 300101 300102 300106 300107 300108 300109 300110 300112 300113 300114 300115 300117 300118 300120 300121 300122 300123 300124 300125 300128 300129 300130 300131 300133 300134 300135 300136 300138 300139 300140 300142 300143 300144 300146 300147 300148 300149 300150 300151 300152 300153 300155 300157 300158 300159 300161 300162 300164 300165 300166 300167 300168 300169 300170 300171 300172 300175 300176 300177 300180 300181 300182 300183 300184 300185 300188 300189 300192 300194 300197 300199 300200 300201 300203 300204 300205 300207 300208 300209 300210 300211 300212 300213 300217 300218 300219 300221 300222 300223 300224 300225 300226 300227 300228 300229 300231 300232 300233 300235 300236 300238 300240 300241 300242 300244 300245 300247 300248 300249 300250 300251 300252 300253 300254 300255 300256 300257 300260 300261 300264 300265 300267 300269 300270 300271 300272 300274 300275 300276 300277 300278 300279 300280 300281 300284 300285 300287 300288 300290 300291 300292 300293 300294 300295 300296 300298 300299 300300 300302 300303 300304 300307 300308 300310 300311 300314 300315 300316 300319 300320 300322 300323 300324 300326 300327 300328 300329 300331 300333 300334 300337 300338 300339 300340 300341 300342 300343 300344 300345 300346 300347 300348 300349 300351 300352 300353 300355 300357 300358 300359 300360 300363 300364 300365 300366 300369 300370 300373 300374 300375 300376 300377 300378 300379 300380 300381 300382 300383 300386 300390 300391 300393 300394 300395 300396 300397 300398 300399 300400 300401 300403 300404 300406 300407 300408 300409 300410 300411 300412 300413 300415 300416 300418 300419 300421 300423 300424 300426 300428 300429 300430 300432 300433 300436 300438 300441 300442 300443 300444 300446 300448 300449 300450 300451 300454 300455 300456 300457 300458 300459 300460 300461 300462 300463 300464 300465 300466 300468 300469 300472 300473 300474 300475 300476 300477 300479 300480 300482 300484 300487 300489 300490 300491 300492 300493 300494 300496 300497 300498 300499 300502 300503 300504 300505 300506 300507 300508 300510 300511 300513 300516 300518 300520 300522 300523 300525 300527 300529 300531 300532 300533 300534 300536 300537 300538 300541 300542 300543 300545 300546 300547 300548 300550 300551 300552 300554 300556 300557 300558 300559 300560 300561 300562 300563 300565 300566 300567 300568 300570 300573 300576 300578 300579 300580 300581 300582 300583 300584 300585 300588 300590 300595 300596 300597 300598 300601 300602 300603 300604 300605 300606 300608 300609 300613 300615 300618 300619 300620 300622 300623 300624 300626 300627 300628 300629 300630 300631 300633 300634 300635 300637 300638 300639 300641 300643 300644 300645 300647 300648 300650 300652 300654 300655 300656 300657 300659 300660 300661 300662 300663 300666 300667 300668 300670 300671 300672 300674 300675 300676 300677 300678 300679 300681 300682 300684 300685 300686 300687 300688 300689 300690 300691 300693 300696 300697 300699 300705 300707 300708 300709 300710 300711 300713 300716 300718 300719 300720 300722 300723 300724 300725 300726 300729 300730 300731 300735 300736 300737 300738 300739 300740 300745 300746 300747 300748 300750 300751 300752 300753 300755 300757 300758 300759 300760 300761 300762 300763 300765 300766 300767 300768 300769 300770 300771 300772 300773 300775 300776 300777 300778 300779 300780 300781 300782 300783 300784 300785 300786 300787 300788 300790 300791 300792 300793 300796 300797 300803 300806 300807 300808 300810 300811 300812 300814 300817 300820 300822 300823 300825 300827 300830 300831 300832 300835 300836 300840 300841 300842 300843 300845 300846 300847 300850 300855 300856 300857 300859 300863 300866 300868 300870 300872 300875 300879 300880 300884 300885 300887 300889 300890 300892 300894 300895 300896 300900 300901 300903 300905 300909 300910 300912 300913 300916 300917 300919 300921 300925 300926 300927 300935 300936 300939 300941 300942 300945 300947 300948 300951 300953 300956 300957 300962 300964 300968 300969 300973 300975 300976 300977 300978 300979 300990 300991 300996 300998 300999 301001 301004 301005 301006 301007 301011 301012 301013 301015 301016 301017 301021 301023 301027 301029 301030 301031 301036 301038 301039 301041 301047 301048 301050 301052 301058 301060 301061 301062 301067 301069 301070 301073 301078 301079 301080 301085 301086 301089 301090 301091 301095 301096 301099 301101 301102 301103 301115 301117 301119 301121 301123 301128 301129 301132 301136 301137 301139 301141 301152 301153 301155 301159 301160 301162 301165 301167 301169 301171 301172 301176 301178 301180 301182 301183 301185 301187 301190 301191 301201 301205 301207 301208 301211 301213 301217 301218 301219 301221 301226 301228 301230 301231 301232 301236 301238 301239 301246 301248 301251 301257 301259 301267 301269 301270 301277 301278 301282 301285 301288 301291 301293 301297 301301 301302 301306 301307 301308 301311 301312 301315 301316 301321 301325 301326 301327 301328 301329 301330 301333 301337 301339 301345 301348 301349 301357 301358 301360 301366 301368 301369 301378 301382 301383 301387 301389 301391 301392 301393 301419 301421 301486 301487 301488 301489 301498 301508 301509 301510 301511 301516 301517 301520 301525 301526 301529 301536 301538 301550 301552 301558 301565 301567 301568 301571 301577 301578 301580 301586 301589 301596 301600 301603 301606 301607 301608 301611 600000 600004 600006 600007 600008 600009 600010 600011 600012 600015 600016 600018 600019 600020 600021 600023 600025 600026 600027 600028 600029 600030 600031 600033 600035 600036 600037 600038 600039 600048 600050 600052 600053 600055 600056 600057 600058 600059 600060 600061 600062 600064 600066 600070 600071 600072 600079 600082 600085 600088 600089 600094 600095 600096 600098 600099 600100 600101 600104 600105 600106 600107 600109 600110 600111 600114 600115 600116 600118 600119 600120 600123 600125 600127 600128 600129 600130 600131 600132 600133 600135 600138 600141 600143 600148 600149 600150 600151 600152 600153 600155 600156 600157 600158 600159 600160 600161 600165 600166 600170 600171 600176 600177 600178 600183 600184 600185 600186 600187 600188 600192 600193 600195 600196 600197 600198 600199 600200 600201 600202 600203 600206 600207 600208 600210 600211 600212 600216 600219 600221 600222 600223 600225 600227 600233 600236 600237 600239 600241 600243 600246 600248 600249 600250 600252 600256 600257 600258 600259 600262 600266 600267 600268 600269 600271 600272 600273 600276 600280 600282 600285 600288 600295 600298 600299 600301 600309 600312 600313 600315 600316 600318 600320 600322 600323 600325 600326 600328 600329 600330 600331 600332 600335 600336 600337 600338 600339 600340 600343 600345 600346 600348 600350 600351 600352 600353 600355 600358 600360 600361 600362 600363 600366 600369 600370 600372 600373 600375 600376 600377 600379 600380 600383 600386 600388 600389 600390 600391 600392 600395 600396 600398 600399 600405 600406 600409 600410 600415 600416 600418 600420 600421 600422 600426 600428 600435 600436 600438 600439 600444 600446 600449 600452 600455 600456 600459 600460 600461 600463 600467 600468 600476 600477 600478 600479 600480 600481 600482 600483 600486 600487 600489 600490 600491 600495 600497 600498 600499 600500 600501 600502 600503 600505 600506 600509 600510 600511 600515 600516 600517 600518 600519 600520 600521 600522 600523 600525 600528 600529 600531 600535 600536 600537 600543 600546 600547 600549 600550 600552 600556 600557 600559 600560 600561 600562 600563 600566 600567 600570 600571 600572 600575 600576 600577 600578 600579 600580 600581 600582 600583 600584 600585 600586 600587 600588 600589 600590 600592 600595 600596 600597 600598 600599 600600 600601 600602 600603 600604 600605 600606 600610 600611 600612 600619 600621 600622 600623 600624 600626 600629 600630 600633 600635 600636 600637 600638 600639 600640 600641 600642 600643 600645 600649 600650 600657 600658 600660 600661 600662 600663 600664 600665 600667 600673 600674 600675 600676 600679 600682 600683 600684 600685 600686 600688 600690 600691 600692 600696 600698 600699 600702 600703 600704 600705 600706 600707 600708 600710 600711 600712 600716 600717 600718 600719 600720 600721 600727 600728 600729 600730 600732 600733 600734 600736 600737 600739 600741 600742 600743 600744 600745 600748 600749 600750 600754 600755 600756 600757 600760 600761 600763 600764 600765 600769 600770 600771 600773 600775 600776 600777 600779 600782 600783 600785 600787 600789 600791 600795 600797 600801 600803 600804 600807 600809 600811 600816 600817 600818 600820 600822 600825 600826 600827 600829 600830 600835 600838 600839 600841 600843 600845 600847 600848 600850 600854 600855 600858 600859 600861 600862 600863 600864 600866 600867 600869 600871 600872 600873 600875 600877 600879 600881 600882 600884 600885 600886 600887 600888 600889 600893 600894 600895 600898 600900 600901 600905 600906 600908 600909 600916 600918 600919 600926 600927 600928 600933 600936 600938 600941 600958 600959 600961 600963 600966 600967 600968 600970 600971 600973 600975 600976 600977 600979 600981 600985 600986 600987 600988 600989 600990 600992 600993 600995 600996 600997 600998 600999 601000 601001 601006 601009 601011 601012 601016 601018 601019 601020 601021 601028 601038 601058 601059 601061 601066 601069 601077 601088 601096 601098 601099 601100 601101 601108 601111 601113 601117 601118 601126 601127 601128 601136 601137 601138 601139 601155 601156 601162 601163 601166 601168 601169 601179 601186 601198 601208 601212 601216 601222 601225 601228 601229 601231 601233 601236 601238 601288 601298 601311 601318 601319 601326 601328 601333 601336 601360 601375 601377 601390 601398 601399 601456 601500 601515 601519 601555 601567 601577 601588 601595 601598 601600 601601 601606 601607 601608 601611 601615 601618 601619 601628 601633 601636 601658 601665 601666 601668 601669 601677 601678 601688 601689 601696 601698 601699 601702 601717 601718 601727 601728 601766 601777 601778 601788 601798 601799 601800 601801 601808 601811 601816 601818 601825 601827 601828 601838 601857 601858 601860 601865 601866 601868 601869 601872 601877 601878 601880 601881 601886 601888 601890 601898 601899 601900 601901 601908 601916 601918 601919 601921 601928 601929 601933 601939 601949 601952 601958 601965 601966 601969 601975 601985 601988 601989 601990 601991 601992 601995 601997 601998 603000 603002 603004 603005 603007 603008 603009 603016 603018 603019 603025 603026 603027 603028 603029 603032 603033 603035 603037 603038 603039 603042 603050 603051 603055 603056 603063 603067 603068 603069 603077 603078 603080 603083 603085 603087 603091 603093 603097 603098 603099 603100 603106 603108 603110 603118 603122 603123 603127 603128 603129 603131 603138 603156 603160 603168 603171 603172 603178 603179 603185 603186 603188 603189 603191 603195 603196 603197 603198 603200 603203 603206 603207 603212 603214 603218 603219 603220 603222 603223 603225 603228 603232 603233 603236 603256 603258 603259 603260 603266 603267 603273 603279 603283 603286 603288 603290 603296 603297 603298 603299 603300 603305 603306 603308 603310 603312 603316 603317 603322 603323 603324 603326 603327 603328 603336 603337 603338 603341 603345 603348 603350 603355 603356 603358 603360 603363 603368 603369 603375 603378 603379 603383 603386 603389 603390 603392 603393 603396 603398 603399 603408 603416 603421 603439 603444 603456 603458 603466 603477 603486 603488 603489 603496 603499 603501 603505 603506 603507 603508 603516 603517 603519 603520 603528 603529 603530 603533 603536 603538 603556 603559 603565 603568 603580 603583 603585 603586 603588 603589 603595 603596 603598 603605 603606 603607 603611 603612 603613 603619 603626 603628 603629 603633 603636 603650 603658 603659 603660 603662 603663 603666 603667 603678 603679 603683 603688 603690 603699 603701 603703 603707 603712 603713 603716 603718 603719 603721 603722 603726 603728 603733 603737 603738 603739 603766 603768 603773 603778 603779 603786 603787 603799 603800 603801 603803 603806 603816 603818 603822 603825 603826 603829 603833 603858 603859 603860 603863 603866 603871 603876 603881 603882 603883 603885 603887 603888 603890 603893 603897 603899 603900 603906 603912 603915 603918 603919 603920 603927 603929 603931 603933 603936 603939 603958 603959 603960 603966 603970 603978 603979 603985 603986 603988 603990 603991 603993 603997 603998 605007 605009 605011 605020 605081 605086 605090 605098 605111 605116 605117 605136 605158 605168 605178 605196 605198 605199 605218 605258 605266 605277 605296 605305 605333 605358 605368 605376 605398 605499 605507 605555 605588 605589 688002 688005 688007 688008 688009 688012 688016 688017 688018 688019 688023 688025 688027 688029 688031 688032 688035 688036 688037 688039 688041 688047 688048 688049 688050 688052 688062 688063 688065 688066 688072 688076 688080 688082 688083 688088 688089 688090 688091 688095 688099 688100 688106 688108 688110 688111 688114 688116 688117 688118 688120 688122 688123 688126 688127 688131 688139 688150 688152 688153 688158 688159 688166 688167 688169 688177 688180 688182 688183 688185 688187 688188 688192 688195 688200 688201 688202 688205 688206 688207 688208 688209 688210 688212 688213 688220 688222 688223 688225 688226 688233 688234 688235 688238 688247 688248 688249 688252 688253 688256 688258 688259 688260 688261 688262 688266 688268 688270 688271 688276 688278 688279 688281 688289 688297 688300 688301 688302 688303 688313 688318 688321 688322 688326 688327 688331 688333 688336 688343 688347 688348 688351 688352 688359 688361 688362 688363 688365 688366 688372 688375 688377 688378 688380 688385 688387 688389 688390 688396 688399 688400 688401 688408 688409 688418 688425 688428 688429 688439 688469 688472 688475 688484 688486 688488 688489 688498 688502 688503 688506 688507 688508 688510 688515 688516 688518 688520 688521 688522 688525 688533 688535 688536 688538 688556 688559 688561 688567 688568 688575 688578 688579 688582 688588 688590 688593 688595 688596 688598 688599 688601 688608 688609 688612 688617 688621 688629 688630 688631 688636 688639 688658 688668 688676 688685 688686 688687 688690 688691 688692 688695 688696 688698 688699 688700 688707 688710 688717 688721 688728 688766 688772 688776 688777 688779 688787 688789 688798 688800 688819 688981 689009';
const baseurl = "https://sqt.gtimg.cn/?q=";
const chunkSize = 64;
const chunks = [];
const urlReqStr = [];

// Split the codetable string into an array of elements
const codetable = codetableStr.split(" ");

// Add prefix to each element based on the leading character
const prefixedCodetable = codetable.map(element => {
    if (element.charAt(0) === "6") {
        return "sh" + element;
    } else {
        return "sz" + element;
    }
});

// Split the prefixed codetable into chunks
for (let i = 0; i < prefixedCodetable.length; i += chunkSize) {
    chunks.push(prefixedCodetable.slice(i, i + chunkSize));
}

// Generate the URL request strings
chunks.forEach(chunk => {
    const chunkStr = chunk.join(",");
    urlReqStr.push(baseurl + chunkStr);
});

// Function to collect data for all stock codes
async function collectAllData() {
  const promises = prefixedCodetable.map(stknum => collectdata(stknum));
  await Promise.all(promises);
  console.log("All data collected:");
}

// Function to collect data for a single stock code
async function collectdata(stkcode) {
  const url = "https://web.ifzq.gtimg.cn/appstock/app/fqkline/get?_var=kline_dayqfq&param=" + stkcode + ",day,,,10,qfq";
  try {
    const responseText = await $.get(url);
    const jsonString = responseText.split("=")[1];
    const jsonData = JSON.parse(jsonString);
    const stockName = jsonData.data[stkcode].qt[stkcode][1];

    // Check if qfqday or day exists
    const stockData = jsonData.data[stkcode].qfqday || jsonData.data[stkcode].day;

    if (!stockData || !Array.isArray(stockData)) {
      throw new Error(`Invalid/missing stock data for ${stkcode} ${url}`);
    }

    // Get the array
    const volArray = stockData.map(row => Number(row[5]));
    const highArray = stockData.map(row => Number(row[3]));
    const lowArray = stockData.map(row => Number(row[4]));

    const avgAmt = Math.round(averageOfLastTen(volArray));
    const maxH = Math.max(...highArray);
    const minL = Math.min(...lowArray);

    // Store the result in BaseObj
    BaseObj[stknum] = { stockName, avgAmt, maxH, minL };
  } catch (error) {
    console.error(`Error ${stknum}:`, error);
  }
}

// Function to calculate the average of the last 10 elements
function averageOfLastTen(arr) {
  if (arr.length < 10) {
    throw new Error("Array must have at least 10 elements");
  }
  const lastTen = arr.slice(-10);
  const sum = lastTen.reduce((acc, val) => acc + val, 0);
  return sum / 10;
}

// Function to calculate the current amount position
function calcCurAmtPosition(volArray) {
  const amtavg = averageOfLastTen(volArray);
  const lastAmt = volArray[volArray.length - 1];
  let curAmtPosition = Math.round((lastAmt / amtavg) * 100);

  return curAmtPosition;
}

// Function to fetch data chunks
async function fetchDataChunks(url) {
  try {
    const response = await fetch(url);
    const data = await response.text();
    const rows = data.split(";");

    rows.forEach(row => {
      const columns = row.split("~");
      if (columns.length > 1) {
        const stockCode = columns[2]; // e.g., "s_hk00700"
        const stknum = stockCode.replace("s_hk", ""); // Extract stock code (e.g., "00700")

        // Check if BaseObj has data for this stock code
        if (BaseObj[stknum] && BaseObj[stknum].avgAmt) {
          const currentAmt = parseFloat(columns[37]); // Current amount from the API
          const avgAmt = BaseObj[stknum].avgAmt; // Average amount from BaseObj
          const stkname = BaseObj[stknum].stockName
          const codeStr = `<r onclick="xunbao('` + columns[2] + `')">`+ columns[2] + "</r>"

          // Calculate the percentage
          const amtPercentage = Math.round((currentAmt / avgAmt)/100); // unit size diff
            // console.log("stknum ",stknum,"name",stkname,"pct",columns[31]," avgAmt ",avgAmt,'currentAmt',currentAmt," amtPercentage",amtPercentage)

          // Store the result in allResults
          allResults[stknum] = {
            code: codeStr,
            name: stkname,
            pct: columns[32],
            amt: amtPercentage, // Replace amt with the calculated percentage
          };

        } else {
          console.warn(`No BaseObj data found for stock code: ${stknum}`);
        }
      }
    });
  } catch (error) {
    console.error("Error fetching data:", error);
  }
}

// Function to update the HTML page with sorted data
function updateHTML() {
  const sortedResults = Object.keys(allResults).sort((a, b) => {
    return allResults[b].amt - allResults[a].amt;
  });

  const tableBody = document.getElementById('stockTable').getElementsByTagName('tbody')[0];
  tableBody.innerHTML = '';

  sortedResults.forEach(stockCode => {
    const row = tableBody.insertRow();
    const cell1 = row.insertCell(0);
    const cell2 = row.insertCell(1);
    const cell3 = row.insertCell(2);
    const cell4 = row.insertCell(3);

    cell1.innerHTML  = allResults[stockCode].code;
    cell2.textContent = allResults[stockCode].name;
    cell3.textContent = allResults[stockCode].pct;
    cell4.textContent = allResults[stockCode].amt;
  });
}

function xunbao(xunbaocode) {
       localStorage.setItem("randomcode", xunbaocode)
       localStorage.setItem("otherCode", xunbaocode)
       localStorage.setItem("stkCode", xunbaocode)

       window.open("Random Charts.html");
       // locs = ["HIghLowTrend.html", "Random Charts.html", ]
       //  window.open("HIghLowTrend.html")
}


// Main function to run the data collection and update process
async function main() {
  await collectAllData();
  await updateInfo();
}

async function updateChanges() {
  const timearr = showTime().split(':')
  const timestr = timearr[0]+timearr[1]
  if(!(Number(timestr)>929 && Number(timestr)<1201 || 
       Number(timestr)>1259 && Number(timestr)<1601)){
    document.getElementById("dateAndTime").innerHTML ="<lg>"+showDate() +"</lg> "+ showTime() + "<o> Market Closed</o>";
    return
  }
  await updateInfo()
}

async function updateInfo() {
  for (let i = 0; i < urlReqStr.length; i++) {
    await fetchDataChunks(urlReqStr[i]);
    // console.log(urlReqStr[i])
  }
  updateHTML();
  $("#dateAndTime").html("<y>"+showDate() +"</y> "+ showTime())
}

// Start the main process
main();
setInterval(updateChanges, 60000);

</script>







<script src='https://williamkpchan.github.io/LibDocs/readbook.js'></script>
<script>
var lazyLoadInstance = new LazyLoad({
 elements_selector: ".lazy"
});

</script>
</center></bodpk>
</html>
