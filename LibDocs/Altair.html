<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<style>

a:hover,a:active{color:red}
table.w3-table-all{margin:20px 0}
.top {
 position:relative;
 background-color:black;
 height:68px;
 padding-top:20px;
 line-height:50px;
 overflow:hidden;
 z-index:2;
}
body {
 background-color: #000000;
 color: MediumSeaGreen;
 margin-left: 14%;
 margin-right: 14%;
 font-size: 24px;
}
a { text-decoration: none;
	color: #58D858;}
a:visited { color: #88C898;}
A:hover {	color: yellow;}
A:focus {	color: red;}
code { color: gray; background-color: #001010; font-size: 18px;}
pre { color: gray; background-color: #001010; font-size: 18px;}
h1, h2, h3, h4, h5, .goldword {
	color: gold;
}
table{
	width: 100%;
	font-size: 20px;
	border-collapse: collapse;
	border: 1px solid gray;
}
th{
	border: 1px solid gray;
	font-weight:bold;
	color: lightgreen;
}
td{
	padding:10px;
	border: 1px dotted dimgray;
}
tr>th:first-child{
	width:40%;
}
tr>td:first-child{
	color: lime;

}
img{
	margin-top:1%;
	margin-bottom:2%;
}
.topic{
    color: lime;
}
.goldsha {
    color: white;
    border: 1px solid gold;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px gold inset;
}
.redsha {
    color: gold;
    border: 1px solid red;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px red inset;
}
.whitesha {
    color: red;
    border: 1px solid white;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -3px -2px 3px white inset;
}
.orangesha {
    color: yellow;
    border: 1px solid orange;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px orange inset;
}
.yellowsha {
    color: lime;
    border: 1px solid yellow;
    padding: 2px;
    border-radius: 3px;
	box-shadow: 3px 3px 3px silver;
	display: inline-block;
}
.greensha {
    color: lightblue;
    border: 1px solid green;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px green inset;
}
.left {
    position: absolute;
    left: 100px;
    color: GoldenRod;
    border: 1px solid GoldenRod;
    padding: 2px;
    font-size: 60%;
}
.bord {
    color: redpink;
    border: 1px solid GoldenRod;
    padding: 1px;
    font-size: 90%;
}
.yellowbord {
    color: lime;
    border: 1px solid yellow;
    padding: 2px;
    border-radius: 3px;
	box-shadow: 3px 3px 3px silver;
}
.bluebord {
    color: white;
    border: 1px solid lightblue;
    padding: 2px;
    border-radius: 3px;
	box-shadow: -2px -2px 3px silver inset;
}
.highlight { 
    color: white;
    background-color: #002030
  }
hr {width: 50%;}
li{
	list-style-type: decimal;
}
#toc, #tang, #san, #pill {
	margin-left: 15%;
	margin-right: 15%;
	color: gold;
	padding: 1%;
	text-align: left;
	box-shadow: 5px 5px 15px silver;
	border-radius: 5px;
	border: 1px solid DarkSlateGray;
    font-size: 90%;
}
.mywords{
    color: Crimson;
}
.orangeword{
    color: orange;
}
.remarks {
	font-size: 22px;
	color: MediumSeaGreen;
}
</STYLE>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script>
$(document).ready(function(){
    $('h1, h2, h3, h4, h5, .goldword, .topic').click(function(){
    parent.history.back();
    return false;
    });
});
</script>


</head>
<body>

<center><h4>Altair &#8211; Python Declarative Visualization Library</h4></center>
<div id="toc"><ul></ul></div>
<br>
<br>
<br>

<h2></h2>
<h2>Introduction</h2>
<p>Visualization is one of the most exciting parts of data science. Plotting huge amounts of data to unveil underlying relationships has its own fun.</p>
<p>Whether you&#8217;re identifying relationships between features or simply understanding the working of a model, visualizations are usually the best way to go about it. Visualizations also help explain your work to your customers and stakeholders.</p>
<p>Python provides a lot of libraries, specifically for plotting and visualization and I usually have a tough time picking out which one to use for my problem statement.</p>
<p>I recently come across with Altair, a visualization library in Python and I was amazed by its capabilities. It is a very user-friendly library which actually performs a lot of things with the minimal amount of code.</p>
<p>Please note that Altair is still in development phase, so things might change over time. We can still do a lot of exciting work on it and the future potential really excites me &#8211; hence this article!</p>
<p>So, let&#8217;s get started.</p>
<p>&nbsp;</p>
<h2></h2>
<h2>Table of Contents</h2>
<ol>
<li>Overview of Altair
<ol>
<li>What is Altair?</li>
<li>Installation</li>
</ol>
</li>
<li>Exploring a Real World Problem</li>
<li>Pros and Cons</li>
<li>End Notes</li>
</ol>
<p>&nbsp;</p>
<h2></h2>
<h2>1. Overview of Altair</h2>
<h3>1.1 What is Altair?</h3>
<blockquote>
<p style="text-align: center;">Altair is a declarative statistical visualization library in Python, based on <a href="https://vega.github.io/vega-lite/"> Vega-lite </a> .</p>
</blockquote>
<p>I am sure many of you would be asking these two questions by now:</p>
<ul>
<li><b>What is meant by declarative?</b></li>
<li><strong>Why is another library required for visualization?</strong></li>
</ul>
<p>By declarative, we mean that while plotting any chart, you only need to declare links between data columns to the encoding channels, such as x-axis, y-axis, colour, etc. and rest all of the plot details are handled automatically. Letâ€™s understand it by an example.</p>
<p>Take a look at the plot below and above that is the code required for generating that plot in Altair.</p>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03222417/Screen-Shot-2017-12-03-at-10.24.00-PM.png"></p>
<p>So, if you notice, we just mentioned x,y and color and rest of the things like legend, axis labels, range etc. all are automatically set.</p>
<p>Now, take a look at the image below which is the matplotlib implementation of the same visualization we previously did with Altair.</p>
<p>&nbsp;</p>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03232253/Screen-Shot-2017-12-03-at-11.22.28-PM.png"></p>
<p>Here, we need to explicitly use groupby function, define axis names, legends etc. which becomes a lot of extra work while you are doing an exploratory analysis.</p>
<p>Therefore being declarative makes Altair simple, friendly and consistent. It produces beautiful and effective visualizations with the minimal amount of code. Therefore you can spend more time understanding your data rather than spending your time on setting the legends, defining axes and so on.</p>
<p>I suppose by now you must have got the answer to the second question also.</p>
<p>&nbsp;</p>
<h3>1.2 Installation</h3>
<p>Altair can be installed via conda as follows:</p>
<pre> conda install altair --channel conda-forge</pre>
<p>Or we can also install it via pip with the following:</p>
<pre> pip install altair 
 pip install --upgrade notebook</pre>
<p>Great, now you have Altair installed on your system. I always feel that the best way to learn a library is to practice it on a real-life problem. So, without any further delay, let us quickly begin!</p>
<p>&nbsp;</p>
<h2></h2>
<h2>2. Exploring a Real World Problem</h2>
<p>For this purpose, I am using <a href="https://datahack.analyticsvidhya.com/contest/practice-problem-big-mart-sales-iii/" target="_blank" rel="noopener noreferrer">The Big Mart Sales</a> dataset. Download the training file and load it into your working environment.</p>
<p>In the data set, we have product wise Sales for Multiple outlets of a chain.  Let&#8217;s take a look at the dataset.</p>
<p>&nbsp;</p>
<h3>2.1 Understanding the dataset</h3>
<pre>df = pd.read_csv('/Users/shubhamjain/Downloads/AV/Big Mart/train.csv')
df.head()</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03194728/Screen-Shot-2017-12-03-at-7.41.07-PM.png"></p>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03204539/Screen-Shot-2017-12-03-at-8.45.01-PM.png"></p>
<p>The total data frame consists of 12 columns, out of which 7 are categorical and rest are numerical. Here, we have <b>Item_Outlet_Sales</b> as the target feature.</p>
<p>NOTE: I have only used the first 1000 rows, just to provide you with the sense of different plots using Altair.</p>
<p>&nbsp;</p>
<h3>2.2 Histograms</h3>
<p>During the exploration journey, we generally start with the univariate analysis using histograms.</p>
<p>So, let&#8217;s start with the <b>Item_Outlet_Sales</b> feature, by plotting its histogram using Altair.</p>
<pre>Chart(df).mark_bar().encode(
 X('Item_Outlet_Sales',bin=True),
 Y('count(*):Q'),
)</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03205106/Screen-Shot-2017-12-03-at-8.50.54-PM.png"></p>
<p>To understand the code, let&#8217;s understand some basic terminologies, to begin with.</p>
<ul>
<li><strong>Chart</strong>: It is the basic fundamental object in Altair, which takes data frame as the single argument.</li>
<li><strong>mark</strong>: It is an attribute to visualize your data points from the chart object. There are different forms of mark objects as shown below.</li>
</ul>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03210059/Screen-Shot-2017-12-03-at-9.00.43-PM.png"></p>
<p>Here, we have shown <strong><em>bar </em></strong>mark in order to visualization our data points as a bar chart.</p>
<ul>
<li><strong>encode: </strong>It is a function which helps in mapping with different features from the data with the visualization. You can define features for the x-axis, y-axis, color etc.</li>
<li><strong>Export as PNG</strong>: You can directly download and save the plot by using this link.</li>
</ul>
<p>Above defined are the common parameters which are used in every Altair visualization. Let&#8217;s take a look at some specific attributes which are used in the above code.</p>
<ul>
<li><strong>bin</strong>: It is set TRUE to discretized a continuous feature, in order to produce a bar plot.</li>
<li><strong>count</strong>: It is a data transformation parameter, which is provided by Altair in order to customize our plots. We can also use other parameters like max, min, average, etc.</li>
<li><strong>Q</strong>: Here, Q denotes that the count will a quantitative feature. We can also use <strong>N</strong> for nominal data or <strong>O</strong> for ordinal data.</li>
</ul>
<p>That was seriously very difficult to grasp after reading it for the first time. But, surely we will get hands-on it by the end of this article.</p>
<p>Okay, now if you look at the above chart, the label for x-axis is not defined properly by the Altair, and we wish to change it. You can do this by defining another parameter called <strong>axis</strong>.</p>
<pre>Chart(df).mark_bar().encode(
 X('Item_Outlet_Sales',bin=True, axis= Axis(title='Item_Outlet_Sales (in bins)')),
 Y('count(*):Q'),
)</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03194711/Screen-Shot-2017-12-03-at-7.40.42-PM.png"></p>
<p>It comes out to be a right-skewed distribution for the sales in our dataset. If I wish to do the same visualization using matplotlib, the implementation is shown below.</p>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03232454/Screen-Shot-2017-12-03-at-11.24.33-PM.png"></p>
<p>You may consider the above code simple, but the visualization obtained from Altair is far more appealing than the one obtained from matplotlib.</p>
<p>We can also change the color of the histogram in Altair by simply adding a color attribute.</p>
<pre>Chart(df).mark_bar(color='lightblue').encode(
 X('Item_Outlet_Sales',bin=True, axis= Axis(title='Item_Outlet_Sales (in bins)')),
 Y('count(*):Q'),
)</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03220031/Screen-Shot-2017-12-03-at-10.00.17-PM.png"></p>
<p>&nbsp;</p>
<h3>2.3 Scatterplot</h3>
<p>Now, let&#8217;s try to do some bivariate analysis using Altair.</p>
<p>Now, let us look at the relationship between <strong>MRP</strong> and <strong>Sales </strong>features.</p>
<pre>Chart(df).mark_point().encode(
 x='Item_MRP',
 y='Item_Outlet_Sales',
)</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03214040/Screen-Shot-2017-12-03-at-9.40.24-PM.png"></p>
<p>We can clearly see a linear relationship between MRP and sales in the above plot. Let&#8217;s introduce some other encoding of Altair in order to draw more inferences from the visualizations.</p>
<pre>Chart(df).mark_point().encode(
 x='Item_MRP',
 y='Item_Outlet_Sales',
 color='Outlet_Type'
)
</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03194658/Screen-Shot-2017-12-03-at-7.40.36-PM.png"></p>
<p>Here, we have defined another encoding called <strong>color, </strong>which is used to differentiate the data points and helps us to understand the relationship better.</p>
<p>We can see that the sales for the grocery stores are pretty low as compared to sales in supermarkets, where supermarket type3 showing the highest sales.</p>
<p>To draw more information from the above plot, let&#8217;s add another encoding called <strong>row.</strong></p>
<pre>Chart(df).mark_point().encode(
 x='Item_MRP',
 y='Item_Outlet_Sales',
 color='Item_Weight',
 row='Outlet_Type'
).configure_cell(width=300, height=150)

</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03232635/Screen-Shot-2017-12-03-at-11.26.10-PM.png"></p>
<p>So, we can now notice that items in supermarket type 1 have comparatively more weight than the grocery store and supermarket type 2.</p>
<p>These were different variates of scatter plot that can be drawn using the Altair. Let&#8217;s now look at some barplot charts to do some bivariate analysis.</p>
<p>&nbsp;</p>
<h3>2.4 Stacked Bar Plot</h3>
<p>For this, let&#8217;s look at the relationship between Outlet_location_type and size of the outlet.</p>
<pre>Chart(df).mark_bar(stacked='normalize').encode(
 Y('Outlet_Location_Type'),
 X('count(*):Q', sort='descending'),
 Color('Outlet_Size:N')
)
</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03194625/Screen-Shot-2017-12-03-at-7.40.23-PM.png"></p>
<p>Above drawn is the stacked bar plot, which denotes that the outlets in tier 2 cities only have outlets of small size, while only tier 3 cities have outlets which are high in size.</p>
<p>Notice that here we have defined the count aggregator in the X encoding, in order to produce a horizontal stack chart.</p>
<p>&nbsp;</p>
<h3>2.5 Line Chart</h3>
<p>Now, let us look at the price of the item across the years. Generally, for the time series related visualizations, we prefer the use of line charts which is provided by Altair by using the <strong><em>line</em></strong> mark.</p>
<p>Altair supports date and discretization of dates when setting the type of it as <b>temporal (T). </b></p>
<pre>Chart(df).mark_line().encode(
 X('Outlet_Establishment_Year:T', timeUnit='year'),
 Y('Item_MRP:Q', aggregate='mean'),
)</pre>
<p>
<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03194610/Screen-Shot-2017-12-03-at-7.40.17-PM.png"></p>
<p>Notice: Here, we have separately defined our transformation using the <strong>aggregate</strong> attribute.</p>
<p>&nbsp;</p>
<h3>2.6 Heatmap</h3>
<p>Altair provides another type of chart known as heat map, which uses <strong><em>text</em></strong> mark attribute.</p>
<pre>Chart(df).mark_text(applyColorToBackground=True).encode(
 Row('Outlet_Type:N'),
 Column('Outlet_Size:N'),
 Color('mean(Item_Outlet_Sales):Q', sort='descending'),
 Text('mean(Item_Outlet_Sales):Q')
)

<img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2017/12/03234548/Screen-Shot-2017-12-03-at-11.45.31-PM.png"/pre>
<p>Similarly, you can draw more patterns in data by this and you can also try some other data transformations and plots to find various trends and relationships between features.</p>
<p>Note that, Altair is currently in the development phase and sooner it will include more and better visualizations in the coming time.</p>
<p>&nbsp;</p>
<h2></h2>
<h2>3. Pros and Cons</h2>
<p><strong>Pros:</strong></p>
<ol>
<li>It is simple and produces more beautiful and effective visualizations.</li>
<li>The framework of code remains the same, i.e., just by changing the <em>mark</em> attribute you can produce different plots.</li>
<li>Data transformations like using count, min, max aggregator functions, is great to have in order to understand your data better.</li>
</ol>
<p><strong>Cons:</strong></p>
<ol>
<li>It doesn&#8217;t produce interactive visualizations like Bokeh or D3.js</li>
<li>Some of the major plots like boxplot are missing from Altair.</li>
</ol>
<p>&nbsp;</p>
<h2></h2>
<h2>4. End Notes</h2>
<p>I hope that you had a fun time learning this new library where you can do a lot of things with the minimal amount of code. So, try using it yourself on the dataset you are working on, and share your experience or doubts in the comment section below.</p>
<p>I would also recommend you to once the visit the <a href="https://altair-viz.github.io/gallery/index.html">gallery</a> page of the Altair documentation for getting more idea about the type of visualizations possible using Altair.</p>
<br>
<br><br><br><br><br>
<script>
  $(function() {
    var toc = $('#toc>ul');

    function makeLi(text, href) {
      return $('<a href="' + href + '" target="_self">' + text + '</a><br>');
    }

    $('h2, h3').each(function(i) {
      var chapter = $(this), chapterNumber = i + 1;
      toc.append(
        makeLi(chapter.text(), '#chapter-' + chapterNumber)
      );
      chapter.attr('id', 'chapter-' + chapterNumber);
    });

  });
</script>
</body>
</html>
