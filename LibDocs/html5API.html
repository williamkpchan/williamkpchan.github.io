<base target="_blank"><html><head><title>HTML5 API</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script src="https://williamkpchan.github.io/lazyload.min.js"></script>
<script src='https://williamkpchan.github.io/mainscript.js'></script>
<script src="https://williamkpchan.github.io/commonfunctions.js"></script>
<script>
  var showTopicNumber = true;
  var topicEnd = "<br>";
  var bookid = "HTML5 API"
  var markerName = "h2, .topic"
</script>
<style>
body{width:80%;margin-left: 10%; font-size:24px;}
h1, h2 {color: gold;}
strong {color: orange;}
img {max-width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%; border-radius:3px;}
</style></head><body onkeypress="chkKey()"><center>
<h1>HTML5 API</h1>
<a href="#mustWatch" class="red goldbs" target="_self">Must Watch!</a><br><br>
<div id="toc"></div></center><br><br>
<div id="mustWatch"><center><span class="red">MustWatch</span></center><br></div>
<pre><br><br>




<h2>HTML5 Geolocation</h2>
The HTML Geolocation API is used to locate a user's position.
<button onclick="getLocation()">Try It</button>

<div id="mapholder"></div>
<script src="https://maps.google.com/maps/api/js?key=AIzaSyBu-916DdpKAjTmJNIgngS6HL_kDIKU0aU"></script>
<script>
var x=document.getElementById("demo");

function getLocation()
{
if (navigator.geolocation)
  {

  navigator.geolocation.getCurrentPosition(showPosition,showError);
  }
else{x.innerHTML="Geolocation is not supported by this browser.";}
}

function showPosition(position)
{
var lat=position.coords.latitude;
var lon=position.coords.longitude;

var latlon=new google.maps.LatLng(lat, lon)
var mapholder=document.getElementById('mapholder')
mapholder.style.height='250px';
mapholder.style.width='100%';

var myOptions={
center:latlon,zoom:14,
mapTypeId:google.maps.MapTypeId.ROADMAP,
mapTypeControl:false,

navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL}
};
var map=new google.maps.Map(document.getElementById("mapholder"),myOptions);
var marker=new google.maps.Marker({position:latlon,map:map,title:"You are here!"});

}
function showError(error)
{
switch(error.code) 

  {
  case error.PERMISSION_DENIED:
    x.innerHTML="User denied the request for Geolocation."
    break;

  case error.POSITION_UNAVAILABLE:
    x.innerHTML="Location information is unavailable."
    break;
  case error.TIMEOUT:

    x.innerHTML="The request to get user location timed out."
    break;
  case error.UNKNOWN_ERROR:
    x.innerHTML="An unknown error occurred."

    break;
  }
}
</script>

<h3>Locate the User's Position</h3>
The HTML Geolocation API is used to get the geographical position of a user.
Since this can compromise privacy, the position is not available unless the user approves it.
<strong>Note:</strong> Geolocation is most accurate for devices with GPS, like iPhone.

<h3>Browser Support</h3>
The numbers in the table specify the first browser version that fully supports 
Geolocation.
<table>

<tr><th>API</th></tr>
<tr><td>Geolocation</td><td>5.0 - 49.0 (http) 50.0 (https)</td><td>9.0</td><td>3.5</td><td>5.0</td><td>16.0</td></tr>
</table>
<strong>Note:</strong> As of Chrome 50, the Geolocation API will only work on secure contexts such 

as HTTPS. If your site is hosted on an non-secure origin (such as HTTP) the 
requests to get the users location will no longer function.
<h3>Using HTML Geolocation</h3>
The getCurrentPosition() method is used to return the user's position.

The example below returns the latitude and longitude of the user's position:
<b>Example</b>
&lt;script>
var x = document.getElementById("demo");

function getLocation() {
  if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition);
  } else {

      x.innerHTML = "Geolocation is not supported by this browser.";
  }
}
 function showPosition(position) {

  x.innerHTML = "Latitude: " + position.coords.latitude + 
  "&lt;br>Longitude: " + position.coords.longitude; 
 }
&lt;/script>

<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_geolocation" target="_blank">Try it Yourself &raquo;</a>
Example explained:
Check if Geolocation is supported
If supported, run the getCurrentPosition() method. If not, display a message to the user

If the getCurrentPosition() method is successful, it returns a coordinates object to the function specified in the parameter (showPosition)
The showPosition() function outputs the Latitude and Longitude
The example above is a very basic Geolocation script, with no error handling.
<h3>Handling Errors and Rejections</h3>

The second parameter of the getCurrentPosition() method is used to handle 
errors. It specifies a function to run if it fails to get the user's location:
<b>Example</b>
 function showError(error) {

  switch(error.code) {
      case error.PERMISSION_DENIED:
          x.innerHTML = "User denied the request for Geolocation."
          break;

      case error.POSITION_UNAVAILABLE:
          x.innerHTML = "Location information is unavailable."
          break;
      case error.TIMEOUT:

          x.innerHTML = "The request to get user location timed out."
          break;
      case error.UNKNOWN_ERROR:
          x.innerHTML = "An unknown error occurred."

          break;
  }
 }
<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_geolocation_error" target="_blank">Try it Yourself &raquo;</a>

<h3>Displaying the Result in a Map</h3>
To display the result in a map, you need access to a map service, like Google 
Maps.
In the example below, the returned latitude and longitude is used to show the location in a Google 

Map (using a static image):
<b>Example</b>
 function showPosition(position) {
  var latlon = position.coords.latitude + "," + position.coords.longitude;

  var img_url = "https://maps.googleapis.com/maps/api/staticmap?center=
   "+latlon+"&amp;zoom=14&amp;size=400x300&amp;sensor=false&amp;key=YOUR_:KEY";
 document.getElementById("mapholder").innerHTML = "&lt;img src='"+img_url+"'>";
 }

<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_geolocation_map" target="_blank">Try it Yourself &raquo;</a>
<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_geolocation_map_script" target="_blank">Google Map Script</a>
How to show an interactive Google Map with a marker, zoom and drag options.
<h3>Location-specific Information</h3>

This page has demonstrated how to show a user's position on a map.
Geolocation is also very useful for location-specific information, like:
Up-to-date local information
Showing Points-of-interest near the user

Turn-by-turn navigation (GPS)
<h3>The getCurrentPosition() Method - Return Data</h3>
The getCurrentPosition() method returns an object on success. The latitude, 
longitude and accuracy properties are always returned. The other properties are returned 

if available:
<table>
<tr>
<th>Property</th><th>Returns</th></tr>

<tr><td>coords.latitude</td><td>The latitude as a decimal number (always returned)</td></tr>
<tr><td>coords.longitude</td><td>The longitude as a decimal number (always returned)</td></tr>
<tr><td>coords.accuracy</td><td>The accuracy of position (always returned)</td></tr>
<tr><td>coords.altitude</td><td>The altitude in meters above the mean sea level (returned if available)</td></tr>

<tr><td>coords.altitudeAccuracy</td><td>The altitude accuracy of position (returned if available)</td></tr>
<tr><td>coords.heading</td><td>The heading as degrees clockwise from North (returned if available)</td></tr>
<tr><td>coords.speed</td><td>The speed in meters per second (returned if available)</td></tr>
<tr><td>timestamp</td><td>The date/time of the response (returned if available)</td></tr>

</table>
<h3>Geolocation Object - Other interesting Methods</h3>
The Geolocation object also has other interesting methods:
watchPosition() - Returns the current position of the user and continues to 

return updated position as the user moves (like the GPS in a car).
clearWatch() - Stops the watchPosition() method.
The example below shows the watchPosition() method. You need an accurate GPS device to test this (like iPhone): 
<b>Example</b>

&lt;script>
var x = document.getElementById("demo");
function getLocation() {
  if (navigator.geolocation) {

      navigator.geolocation.watchPosition(showPosition);
  } else {
      x.innerHTML = "Geolocation is not supported by this browser.";
  }

}
 function showPosition(position) {
  x.innerHTML = "Latitude: " + position.coords.latitude + 
  "&lt;br>Longitude: " + position.coords.longitude; 

 }
&lt;/script>
<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_geolocation_watchposition" target="_blank">Try it Yourself &raquo;</a>
<h2>HTML5 Drag and Drop</h2>

<div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
<img src="img_w3slogo.gif" draggable="true" ondragstart="drag(event)" id="drag1" alt="W3Schools">
<div id="div2" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
Drag the W3Schools image into the rectangle.

<h3>Drag and Drop</h3>
Drag and drop is a very common feature. It is when you "grab" an object and drag it to a different location.
In HTML5, drag and drop is part of the standard: Any element can be draggable.
<h3>Browser Support</h3>

The numbers in the table specify the first browser version that fully supports Drag and Drop.
<table>
<tr><th>API</th><th></th><th></th><th></th><th></th><th></th>                </tr>
<tr><td>Drag and Drop</td><td>4.0</td><td>9.0</td><td>3.5</td><td>6.0</td><td>12.0</td></tr>

</table>
<h3>HTML Drag and Drop Example</h3>
The example below is a simple drag and drop example:
<b>Example</b>

&lt;!DOCTYPE HTML>
&lt;html>
&lt;head>
&lt;script>

 function allowDrop(ev)
 {
 ev.preventDefault();
 }

 
 function drag(ev)
 {
 ev.dataTransfer.setData("text", ev.target.id);

 }
 
 function drop(ev)
 {

 ev.preventDefault();
 var data = ev.dataTransfer.getData("text");
 ev.target.appendChild(document.getElementById(data));
 }

&lt;/script>
&lt;/head>
&lt;body>
 

&lt;div id="div1" ondrop="drop(event)"
 ondragover="allowDrop(event)">&lt;/div>
 
&lt;img id="drag1" src="img_logo.gif" draggable="true"

 ondragstart="drag(event)" width="336" height="69">
 
&lt;/body>
&lt;/html>

<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_draganddrop" target="_blank">Try it Yourself &raquo;</a>
It might seem complicated, but lets go through all the different parts of a drag and drop event.

<h3>Make an Element Draggable</h3>
First of all: To make an element draggable, set the draggable attribute to true:
<div>&lt;img draggable="true"></div>
<h3>What to Drag - ondragstart and setData()</h3>

Then, specify what should happen when the element is dragged.
In the example above, the ondragstart attribute calls a function, drag(event), 
that specifies what data to be dragged.
The dataTransfer.setData() method sets the data type and the value of the 

dragged data:

function drag(ev) {
  ev.dataTransfer.setData("text", ev.target.id);

}
In this case, the data type is "text" and the value is the id of the draggable element ("drag1").
<h3>Where to Drop - ondragover</h3>
The ondragover event specifies where the dragged data can be dropped.

By default, data/elements cannot be dropped in other elements. To allow a drop, 
we must prevent the default handling of the element.
This is done by calling the event.preventDefault() method for the ondragover event:


<i>event</i>.preventDefault()
<h3>Do the Drop - ondrop</h3>
When the dragged data is dropped, a drop event occurs.
In the example above, the ondrop attribute calls a function, drop(event):


function drop(ev)
 {
 ev.preventDefault();

 var data = ev.dataTransfer.getData("text");
 ev.target.appendChild(document.getElementById(data));
 }
Code explained:

Call preventDefault() to prevent the browser default handling of the data (default is open as link on drop)
Get the dragged data with the dataTransfer.getData() method. This method will return any data that was set to the same type in the setData() method
The dragged data is the id of the dragged element ("drag1")
Append the dragged element into the drop element

<h3>More Examples</h3>
<h4>Drag image back and forth</h4>
How to drag (and drop) an image back and forth between two &lt;div> elements:
<iframe src="tryhtml5_draganddrop_ifr.htm"></iframe>

<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_draganddrop2" target="_blank">Try it Yourself &raquo;</a>
<h2>HTML5 Web Storage</h2>
HTML web storage; better than cookies.
<h3>What is HTML Web Storage?</h3>

With web storage, web applications can store data locally within the user's browser.
Before HTML5, application data had to be stored in cookies, included in 
every server request. Web storage is more secure, and large amounts of data 
can be stored locally, without affecting website performance.

Unlike cookies, 
the <b>storage limit is far larger (at least 5MB)</b> and information is never 
transferred to the server.
Web storage is per origin (per domain and protocol). All pages, from one 

origin, can store and access the same data.
<h3>Browser Support</h3>
The numbers in the table specify the first browser version that fully supports 
Web Storage.

<table>
<tr><th>API</th><th></th><th></th><th></th><th></th><th></th>                </tr>
<tr><td>Web Storage</td><td>4.0</td><td>8.0</td><td>3.5</td><td>4.0</td><td>11.5</td></tr>
</table>

<h3>HTML Web Storage Objects</h3>
HTML web storage provides two objects for storing data on the client:
window.localStorage - stores data with no expiration date
window.sessionStorage - stores data for one session (data is lost when the browser tab is closed)

Before using web storage, check browser support for localStorage and sessionStorage:

if (typeof(Storage) !== "undefined") {
  // <i>Code for localStorage/sessionStorage.</i>

 }
 else {
  // Sorry! No Web Storage support..
 }


<h3>The localStorage Object</h3>
The localStorage object stores the data with no expiration date. The data 

will not be deleted when the browser is closed, and will be available the next day, week, or year.
<b>Example</b>
 <span>// Store</span>
localStorage.setItem("lastname", "Smith");

<span>// Retrieve</span>
 document.getElementById("result").innerHTML = localStorage.getItem("lastname");
<a target="_blank" href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_webstorage_local">Try it Yourself &raquo;</a>
Example explained:

Create a localStorage name/value pair with name="lastname" and value="Smith"
Retrieve the value of "lastname" and insert it into the element with id="result"
The example above could also be written like this:

 // Store
localStorage.lastname = "Smith";
// Retrieve
 document.getElementById("result").innerHTML = localStorage.lastname;

The syntax for removing the "lastname" localStorage item is as follows:

 localStorage.removeItem("lastname");
<strong>Note:</strong> Name/value pairs are always stored as strings. 

Remember to convert them to another format when needed!
The following example counts the number of times a user has clicked a button. 
In this code the value string is converted to a number to be able to increase the counter:
<b>Example</b>

 if (localStorage.clickcount) {
  localStorage.clickcount = Number(localStorage.clickcount) + 1;
 } else {
  localStorage.clickcount = 1;

}
 document.getElementById("result").innerHTML = "You have clicked the button " +
localStorage.clickcount + " time(s).";
<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_webstorage_local_clickcount" target="_blank">Try it Yourself &raquo;</a>

<h3>The sessionStorage Object</h3>
The sessionStorage object is equal to the localStorage object, <strong>except</strong> 
that it stores the data for only one session. The data is deleted when the user closes the 
specific browser tab.

The following example counts the number of times a user has clicked a button, in the current session:
<b>Example</b>
if (sessionStorage.clickcount) {
sessionStorage.clickcount = Number(sessionStorage.clickcount) + 1;

}
else {
  sessionStorage.clickcount = 1;
}

document.getElementById("result").innerHTML = "You have clicked the button " +
sessionStorage.clickcount + " time(s) in this session.";
<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_webstorage_session" target="_blank">Try it Yourself &raquo;</a>
<h2>HTML5 Web Workers</h2>

A web worker is a JavaScript running in the background, without affecting the performance of the page.
<h3>What is a Web Worker?</h3>
When executing scripts in an HTML page, the page becomes unresponsive until the script is finished.
A web worker is a JavaScript that runs in the background, independently 

of other scripts, without affecting the performance of the page. You can continue to do whatever you want: 
clicking, selecting things, etc., while the web worker runs in the background.
<h3>Browser Support</h3>
The numbers in the table specify the first browser version that fully support Web Workers.

<table>
<tr><th>API</th><th></th><th></th><th></th><th></th><th></th>                </tr>
<tr><td>Web Workers</td><td>4.0</td><td>10.0</td><td>3.5</td><td>4.0</td><td>11.5</td></tr>
</table>

<h3>HTML Web Workers Example</h3>
The example below creates a simple web worker that count numbers in the background:
<b>Example</b>
Count numbers: <output id="result"></output>

<button onclick="startWorker()">Start Worker</button> 
<button onclick="stopWorker()">Stop Worker</button>
<script>
var w;

function startWorker()
{
if(typeof(Worker)!=="undefined") {
if(typeof(w)=="undefined") {

  w=new Worker("https://www.w3schools.com/html/demo_workers.js");
}
w.onmessage = function (event) {
  document.getElementById("result").innerHTML=event.data;

};
} else {
document.getElementById("result").innerHTML="Sorry, your browser does not support Web Workers...";
}

}
function stopWorker()
{ 
w.terminate();

w = undefined;
}
</script>
<a target="_blank" href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_webworker">Try it Yourself &raquo;</a>

<h3>Check Web Worker Support</h3>
Before creating a web worker, check whether the user's browser supports it:

if (typeof(Worker) !== "undefined") {

  // Yes! Web worker support!
  // <i>Some code.....</i>
 }
 else {

  // Sorry! No Web Worker support..
 }

<h3>Create a Web Worker File</h3>
Now, let's create our web worker in an external JavaScript.
Here, we create a script that counts. The script is stored in the "demo_workers.js" file:

var i = 0;
function timedCount()
{
 

i = i + 1;
 
postMessage(i);
 

setTimeout("timedCount()",500);
}
timedCount();
The important part of the code above is the <b>postMessage()</b> method - which is used to post a message back to the HTML page.

<b>Note:</b> Normally web workers are not used for such simple scripts, but for more CPU intensive tasks.
<h3>Create a Web Worker Object</h3>
Now that we have the web worker file, we need to call it from an HTML page.
The following lines checks if the worker already exists, if not - it creates a new web worker object and runs the code in 

"demo_workers.js":

if (typeof(w) == "undefined") {
  w = new Worker("demo_workers.js");

 }
Then we can send and receive messages from the web worker.
Add an "onmessage" event listener to the web worker.

w.onmessage = function(event){
  document.getElementById("result").innerHTML = event.data;
 };
When the web worker posts a message, the code within the event listener is executed. The data 

from the web worker is stored in event.data.
<h3>Terminate a Web Worker</h3>
When a web worker object is created, it will continue to listen for messages (even after the external script is finished) until it is terminated.
To terminate a web worker, and free browser/computer resources, use the 

terminate() method:

w.terminate();
<h3>Reuse the Web Worker</h3>

If you set the worker variable to undefined, after it has been terminated, 
you can reuse the code:

 w = undefined;

<h3>Full Web Worker Example Code</h3>
We have already seen the Worker code in the .js file. Below is the code for the HTML page:
<b>Example</b>
&lt;!DOCTYPE html>

&lt;html>
&lt;body>
&lt;p>Count numbers: &lt;output id="result">&lt;/output>&lt;/p>
&lt;button onclick="startWorker()">Start Worker&lt;/button> 

&lt;button onclick="stopWorker()">Stop Worker&lt;/button>
&lt;script>
var w;
function startWorker()

{
 
if(typeof(Worker) !== "undefined")
{

      if(typeof(w) == "undefined") {
          w = new Worker("demo_workers.js");
      }
      w.onmessage = function(event) {

          document.getElementById("result").innerHTML = event.data;
      };
 
}

else
{
     
document.getElementById("result").innerHTML = "Sorry! No Web Worker support.";

 
}
}
function stopWorker()

{ 
 
w.terminate();
  w = undefined;

}
&lt;/script>
&lt;/body>
&lt;/html>

<a target="_blank" href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_webworker">Try it Yourself &raquo;</a>
<h3>Web Workers and the DOM</h3>
Since web workers are in external files, they do not have access to the following JavaScript objects:
The window object

The document object
The parent object
<h2>HTML5 Server-Sent Events</h2>
Server-Sent Events allow a web page to get updates from a server.

<h3>Server-Sent Events - One Way Messaging</h3>
A server-sent event is when a web page automatically gets updates from a server.
This was also possible before, but the web page would have to ask if any updates were 
available. With server-sent events, the updates come automatically.

Examples: Facebook/Twitter updates, stock price updates, news feeds, sport results, etc.
<h3>Browser Support</h3>
The numbers in the table specify the first browser version that fully support server-sent events.
<table>

<tr><th>API</th><th></th><th></th><th></th><th></th><th></th>                </tr>
<tr><td>SSE</td><td>6.0</td><td><span>Not supported</span></td><td>6.0</td><td>5.0</td><td>11.5</td></tr>
</table>
<h3>Receive Server-Sent Event Notifications</h3>

The EventSource object is used to receive server-sent event notifications:
<b>Example</b>
 var source = new EventSource("demo_sse.php");
source.onmessage = function(event) {

  document.getElementById("result").innerHTML += event.data + "&lt;br>";
};
<a href="https://www.w3schools.com/html/tryit.asp?filename=tryhtml5_sse" target="_blank">Try it Yourself &raquo;</a>
Example explained:

Create a new EventSource object, and specify the URL of the page sending the updates (in this example "demo_sse.php")
Each time an update is received, the onmessage event occurs
When an onmessage event occurs, put the received data into the element with id="result"
<h3>Check Server-Sent Events Support</h3>

In the tryit example above there were some extra lines of code to check browser support for server-sent events:

if(typeof(EventSource) !== "undefined") {
  // Yes! Server-sent events support!

  // <i>Some code.....</i>
 }
 else {
  // Sorry! No server-sent events support..

 }

<h3>Server-Side Code Example</h3>

For the example above to work, you need a server capable of sending data updates (like PHP or ASP).
The server-side event stream syntax is simple. Set the "Content-Type" header to 
"text/event-stream". Now you can start sending event streams.
Code in PHP (demo_sse.php):

&lt;?php
header('Content-Type: text/event-stream');
 header('Cache-Control: no-cache');
$time = date('r');

echo "data: The server time is: {$time}\n\n";
flush();
?>
Code in ASP (VB) (demo_sse.asp):

&lt;%
Response.ContentType = "text/event-stream"
Response.Expires = -1
 Response.Write("data: The server time is: " &amp; now())

Response.Flush()
%>
Code explained:
Set the "Content-Type" header to 

"text/event-stream"
Specify that the page should not cache
Output the data to send (<strong>Always</strong> start with "data: ")
Flush the output data back to the web page

<h3>The EventSource Object</h3>
In the examples above we used the onmessage event to get messages. But other events are also available:
<table>
<tr><th>Events</th>

<th>Description</th></tr>
<tr><td>onopen</td><td>When a connection to the server is opened</td></tr>
<tr><td>onmessage</td><td>When a message is received</td></tr>
<tr><td>onerror</td><td>When an error occurs</td></tr>
 </table>
<script src='https://williamkpchan.github.io/LibDocs/readbook.js'></script>
<script>
var lazyLoadInstance = new LazyLoad({
    elements_selector: ".lazy"
    // ... more custom settings?
});
</script>
</pre></body></html>