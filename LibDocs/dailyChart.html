<!DOCTYPE html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<html>
<head>
<title>daily chart</title>
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src='https://williamkpchan.github.io/mainscript.js'></script>
<script src="https://williamkpchan.github.io/LibDocs/stkComments.js"></script>
<script src="https://williamkpchanhp.github.io/filterResulitLib.txt"></script>
<script src="https://code.jquery.com/mobile/1.5.0-alpha.1/jquery.mobile-1.5.0-alpha.1.min.js"></script>

<script src="https://williamkpchanhp.github.io/LibDocs/longHistList.js"></script>
<script src="https://williamkpchan.github.io/LibDocs/rchart/RGraph.common.core.js" ></script>
<script src="https://williamkpchan.github.io/LibDocs/rchart/RGraph.line.js"></script>
<script src="https://williamkpchan.github.io/LibDocs/rchart/RGraph.drawing.yaxis.js"></script>
<script src="https://williamkpchan.github.io/LibDocs/rchart/RGraph.common.dynamic.js"></script>
<script src="https://williamkpchan.github.io/LibDocs/rchart/RGraph.common.tooltips.js"></script>
<script src="https://williamkpchanhp.github.io/codeList.js"></script>

<style>
#dateTime {  text-align: left;}
#cmtNote, #instruction, #message, #usstock{display:none;}
#amtLst {font-size:14px;}
select {border-radius:10px; font-size:20px;background-color:black; color:brown;}
</style>

</head>
<body onkeypress="chkKey()">
<center>
<br>
<canvas id="cvs" width="1150" height="600">[No canvas support]</canvas>
<br>
<canvas id="accel" width="1150" height="240">[No canvas support]</canvas>
<br>
<canvas id="accaccel" width="1150" height="240">[No canvas support]</canvas>
<br>
Kçº¿å›¾æ—¥æ•°ä¸è¶‹åŠ¿å›¾ä¸åŒ
<p id="amtLst"></p>
<p id="image"></p>
<canvas id="TP" width="1150" height="240">[No canvas support]</canvas>
<canvas id="å¼ºå¼±50" width="1150" height="240">[No canvas support]</canvas>

<span id="lastValues"></span>
<br><span id="turnover"></span>
</center>

<div id="dateTime" style="margin-left:5%;" class="lime"> </div>
<span onclick="$('#instruction').toggle();"> ğŸŒ </span>
<a href="AStkList.txt" class="whitebut" target="_blank">Aè‚¡æ¸…å•</a>

<a href="http://www.etnet.com.hk/www/tc/stocks/industry_adu.php" target="_blank" class="bordred1">è¡Œæ¥­æ¿å¡Š</a>
<a href="http://www.etnet.com.hk/www/tc/stocks/indexes_detail.php?subtype=HSI" target="_blank" class="bordred1">æŒ‡æ•¸æˆåˆ†è‚¡è¡¨ç¾</a>
<a href="http://www.etnet.com.hk/www/tc/stocks/ah.php" target="_blank" class="bordred1">AHè‚¡è¡¨ç¾</a>
<select id="selectList" onchange="assignList()"></select>
<span onclick="$('#message').toggle();"> ğŸŒ </span>
<pre id="filterMarkers"></pre>

<br>
<pre id="instruction">
</pre>
<pre id="commands">
commands:
d fillLineData, paste one set data to redraw with std dev
c askforCode

z large chart

R Random Charts.html
m mlineMinutechart.html

f jpforward	b jpback
r jprandom	t jpTo 0

h chgHighList	l chgLowList	m chgMidList	C chgCloseLst

a useAttentionList

i chgIntv
L askList
5 lines: data, WAve5, WAve10, sd+, sd-
A stk code sample: 000001.sh, 399001.sz
chartColor: red green orange blue #900 #a00 #b0f #c00 #d0a gray purple yellow white
white is ma of startIntv line
purple yellow is sd
green is half startIntv
orange ia p1
note startIntv at 4 buy at red ux orange, sell at red dx green
002340 002276 600025 300548 002429 002615 688660
</pre>
<pre id="message">

</pre>
<span onclick="$('#usstock').toggle();">usstock ğŸŒ </span>
<pre id="usstock">
<b onclick='fetchUsCode("usTCEHY.PS")'>usTCEHY.PS è…¾ä¿¡</b> . <b onclick='fetchUsCode("usPEP.OQ")'>usPEP.OQ ç™¾äº‹å¯ä¹</b> . <b onclick='fetchUsCode("usORCL.N")'>usORCL.N ç”²éª¨æ–‡</b> . <b onclick='fetchUsCode("usOIL.AM")'>usOIL.AM æ ‡æ™®é«˜ç››åŸæ²¹æŒ‡æ•°ETN</b> . <b onclick='fetchUsCode("usNVS.N")'>usNVS.N è¯ºååˆ¶è¯</b> . <b onclick='fetchUsCode("usNVFY.OQ")'>usNVFY.OQ è¯ºåå®¶å…·</b> . <b onclick='fetchUsCode("usNVDA.OQ")'>usNVDA.OQ è‹±ä¼Ÿè¾¾</b> . <b onclick='fetchUsCode("usNTES.OQ")'>usNTES.OQ ç½‘æ˜“</b> . <b onclick='fetchUsCode("usNTAP.OQ")'>usNTAP.OQ ç¾å›½ç½‘å­˜</b> . <b onclick='fetchUsCode("usNKE.N")'>usNKE.N è€å…‹</b> . <b onclick='fetchUsCode("usNFLX.OQ")'>usNFLX.OQ å¥ˆé£</b> . <b onclick='fetchUsCode("usMSFT.OQ")'>usMSFT.OQ å¾®è½¯</b> . <b onclick='fetchUsCode("usMS.N")'>usMS.N æ‘©æ ¹å£«ä¸¹åˆ©</b> . <b onclick='fetchUsCode("usMPNGY.PS")'>usMPNGY.PS ç¾å›¢</b> . <b onclick='fetchUsCode("usMET.N")'>usMET.N å¤§éƒ½ä¼šäººå¯¿</b> . <b onclick='fetchUsCode("usMBLY.OQ")'>usMBLY.OQ Mobileye Global Inc</b> . <b onclick='fetchUsCode("usMAT.OQ")'>usMAT.OQ ç¾æ³°</b> . <b onclick='fetchUsCode("usLRCX.OQ")'>usLRCX.OQ æ‹‰å§†ç ”ç©¶</b> . <b onclick='fetchUsCode("usLMT.N")'>usLMT.N æ´›å…‹å¸Œå¾·é©¬ä¸</b> . <b onclick='fetchUsCode("usKWEB.AM")'>usKWEB.AM ä¸­å›½æµ·å¤–äº’è”ç½‘ETF</b> . <b onclick='fetchUsCode("usJT.N")'>usJT.N ç®€æ™®ç§‘æŠ€</b> . <b onclick='fetchUsCode("usJNJ.N")'>usJNJ.N å¼ºç”Ÿ</b> . <b onclick='fetchUsCode("usIRBT.OQ")'>usIRBT.OQ Irobot Corp</b> . <b onclick='fetchUsCode("usINTU.OQ")'>usINTU.OQ è´¢æ·</b> . <b onclick='fetchUsCode("usINTC.OQ")'>usINTC.OQ è‹±ç‰¹å°”</b> . <b onclick='fetchUsCode("usILMN.OQ")'>usILMN.OQ Illumina Inc</b> . <b onclick='fetchUsCode("usHUYA.N")'>usHUYA.N è™ç‰™</b> . <b onclick='fetchUsCode("usH.N")'>usH.N å‡¯æ‚¦é…’åº—</b> . <b onclick='fetchUsCode("usGRPN.OQ")'>usGRPN.OQ Groupon Inc</b> . <b onclick='fetchUsCode("usGOGO.OQ")'>usGOGO.OQ Gogo Inc</b> . <b onclick='fetchUsCode("usGLW.N")'>usGLW.N åº·å®</b> . <b onclick='fetchUsCode("usGHG.N")'>usGHG.N æ ¼æ—é…’åº—</b> . <b onclick='fetchUsCode("usGDS.OQ")'>usGDS.OQ ä¸‡å›½æ•°æ®</b> . <b onclick='fetchUsCode("usGDOT.N")'>usGDOT.N Green Dot Corp</b> . <b onclick='fetchUsCode("usGD.N")'>usGD.N é€šç”¨åŠ¨åŠ›</b> . <b onclick='fetchUsCode("usFTNT.OQ")'>usFTNT.OQ é£å¡”ä¿¡æ¯</b> . <b onclick='fetchUsCode("usFEDU.N")'>usFEDU.N å››å­£æ•™è‚²</b> . <b onclick='fetchUsCode("usFDX.N")'>usFDX.N è”é‚¦å¿«é€’</b> . <b onclick='fetchUsCode("usFANH.OQ")'>usFANH.OQ æ³›åæ§è‚¡é›†å›¢</b> . <b onclick='fetchUsCode("usFAMI.OQ")'>usFAMI.OQ å†œç±³è‰¯å“</b> . <b onclick='fetchUsCode("usETR.N")'>usETR.N å®‰ç‰¹å‰</b> . <b onclick='fetchUsCode("usZTO.N")'>usZTO.N ä¸­é€šå¿«é€’</b> . <b onclick='fetchUsCode("usZKIN.OQ")'>usZKIN.OQ æ­£åº·å›½é™…</b> . <b onclick='fetchUsCode("usYUMC.N")'>usYUMC.N ç™¾èƒœä¸­å›½</b> . <b onclick='fetchUsCode("usYELP.N")'>usYELP.N Yelp</b> . <b onclick='fetchUsCode("usYECO.PS")'>usYECO.PS ç‰é¾™ç”Ÿæ€ææ–™</b> . <b onclick='fetchUsCode("usXIACY.PS")'>usXIACY.PS å°ç±³é›†å›¢</b> . <b onclick='fetchUsCode("usX.N")'>usX.N ç¾å›½é’¢é“</b> . <b onclick='fetchUsCode("usWDC.OQ")'>usWDC.OQ è¥¿éƒ¨æ•°æ®</b> . <b onclick='fetchUsCode("usWDAY.OQ")'>usWDAY.OQ Workday</b> . <b onclick='fetchUsCode("usWBA.OQ")'>usWBA.OQ æ²ƒå°”æ ¼æ—-è”åˆåšå§¿</b> . <b onclick='fetchUsCode("usVXZ.AM")'>usVXZ.AM ææ…Œä¸­æœŸåšå¤šETN-iPath S</b> . <b onclick='fetchUsCode("usVXX.AM")'>usVXX.AM çŸ­æœŸVIXæŒ‡æ•°æœŸè´§ETN</b> . <b onclick='fetchUsCode("usVMW.N")'>usVMW.N å¨ç¿</b> . <b onclick='fetchUsCode("usV.N")'>usV.N Visa</b> . <b onclick='fetchUsCode("usUSNA.N")'>usUSNA.N ä¼˜èå¨œ</b> . <b onclick='fetchUsCode("usUNH.N")'>usUNH.N è”åˆå¥åº·</b> . <b onclick='fetchUsCode("usUNG.AM")'>usUNG.AM ç¾å›½å³æœˆå¤©ç„¶æ°”ETF</b> . <b onclick='fetchUsCode("usTXN.OQ")'>usTXN.OQ å¾·å·ä»ªå™¨</b> . <b onclick='fetchUsCode("usTRIP.OQ")'>usTRIP.OQ çŒ«é€”é¹°</b> . <b onclick='fetchUsCode("usTME.N")'>usTME.N è…¾è®¯éŸ³ä¹</b> . <b onclick='fetchUsCode("usTKAT.AM")'>usTKAT.AM å¤§å…¬æ–‡äº¤æ‰€</b> . <b onclick='fetchUsCode("usTGT.N")'>usTGT.N å¡”å‰ç‰¹</b> . <b onclick='fetchUsCode("usTER.OQ")'>usTER.OQ æ³°ç‘è¾¾</b> . <b onclick='fetchUsCode("usSSYS.OQ")'>usSSYS.OQ Stratasys</b> . <b onclick='fetchUsCode("usSPWR.OQ")'>usSPWR.OQ Sunpower Corp</b> . <b onclick='fetchUsCode("usSPLK.OQ")'>usSPLK.OQ Splunk Inc</b> . <b onclick='fetchUsCode("usSPI.OQ")'>usSPI.OQ é˜³å…‰åŠ¨åŠ›</b> . <b onclick='fetchUsCode("usSMI.AM")'>usSMI.AM Vaneck Hip Sustainable Muni Etf</b> . <b onclick='fetchUsCode("usSMFG.N")'>usSMFG.N ä¸‰äº•ä½å‹é‡‘è</b> . <b onclick='fetchUsCode("usSIMO.OQ")'>usSIMO.OQ æ…§è£ç§‘æŠ€</b> . <b onclick='fetchUsCode("usSBUX.OQ")'>usSBUX.OQ æ˜Ÿå·´å…‹</b> . <b onclick='fetchUsCode("usSAP.N")'>usSAP.N SAP</b> . <b onclick='fetchUsCode("usROK.N")'>usROK.N ç½—å…‹éŸ¦å°”è‡ªåŠ¨åŒ–</b> . <b onclick='fetchUsCode("usRF.N")'>usRF.N åœ°åŒºé‡‘è</b> . <b onclick='fetchUsCode("usRENN.N")'>usRENN.N äººäººç½‘</b> . <b onclick='fetchUsCode("usQD.N")'>usQD.N è¶£åº—</b> . <b onclick='fetchUsCode("usQCOM.OQ")'>usQCOM.OQ é«˜é€š</b> . <b onclick='fetchUsCode("usPLUG.OQ")'>usPLUG.OQ æ™®æ‹‰æ ¼èƒ½æº</b> . <b onclick='fetchUsCode("usPFE.N")'>usPFE.N è¾‰ç‘</b> . <b onclick='fetchUsCode("usPETZ.OQ")'>usPETZ.OQ å¤©åœ°èŸ</b> . <b onclick='fetchUsCode("usKSM.N")'>usKSM.N DWSå¸‚æ”¿å€ºåŠ¡åŸºé‡‘</b> . <b onclick='fetchUsCode("usEQIX.OQ")'>usEQIX.OQ æ˜“æ˜†å°¼å…‹æ–¯</b> . <b onclick='fetchUsCode("usENV.N")'>usENV.N Envestnet Inc</b> . <b onclick='fetchUsCode("usEBAY.OQ")'>usEBAY.OQ eBay</b> . <b onclick='fetchUsCode("usEA.OQ")'>usEA.OQ è‰ºç”µ</b> . <b onclick='fetchUsCode("usDZZ.AM")'>usDZZ.AM é»„é‡‘ä¸¤å€åšç©ºETNï¼ˆå¾·é“¶ï¼‰</b> . <b onclick='fetchUsCode("usDXCM.OQ")'>usDXCM.OQ å¾·åº·åŒ»ç–—</b> . <b onclick='fetchUsCode("usDUK.N")'>usDUK.N æœå…‹èƒ½æº</b> . <b onclick='fetchUsCode("usDGZ.AM")'>usDGZ.AM é»„é‡‘çŸ­æœŸåšç©ºETNï¼ˆå¾·é“¶ï¼‰</b> . <b onclick='fetchUsCode("usDGP.AM")'>usDGP.AM é»„é‡‘ä¸¤å€åšå¤šETN</b> . <b onclick='fetchUsCode("usDELL.N")'>usDELL.N æˆ´å°”ç§‘æŠ€</b> . <b onclick='fetchUsCode("usDB.N")'>usDB.N å¾·æ„å¿—é“¶è¡Œ</b> . <b onclick='fetchUsCode("usDAL.N")'>usDAL.N è¾¾ç¾èˆªç©º</b> . <b onclick='fetchUsCode("usCSIQ.OQ")'>usCSIQ.OQ é˜¿ç‰¹æ–¯å¤ªé˜³èƒ½</b> . <b onclick='fetchUsCode("usCPHI.AM")'>usCPHI.AM æƒ æ™®æ£®åŒ»è¯</b> . <b onclick='fetchUsCode("usCOST.OQ")'>usCOST.OQ å¥½å¸‚å¤š</b> . <b onclick='fetchUsCode("usCOP.N")'>usCOP.N åº·è²çŸ³æ²¹</b> . <b onclick='fetchUsCode("usCOF.N")'>usCOF.N ç¬¬ä¸€èµ„æœ¬ä¿¡è´·</b> . <b onclick='fetchUsCode("usCMCSA.OQ")'>usCMCSA.OQ åº·å¡æ–¯ç‰¹</b> . <b onclick='fetchUsCode("usCAT.N")'>usCAT.N å¡ç‰¹å½¼å‹’</b> . <b onclick='fetchUsCode("usCANG.N")'>usCANG.N ç¿è°·</b> . <b onclick='fetchUsCode("usCAJ.N")'>usCAJ.N ä½³èƒ½</b> . <b onclick='fetchUsCode("usC.N")'>usC.N èŠ±æ——é›†å›¢</b> . <b onclick='fetchUsCode("usBYSI.OQ")'>usBYSI.OQ ä¸‡æ˜¥åŒ»è¯</b> . <b onclick='fetchUsCode("usBK.N")'>usBK.N çº½çº¦æ¢…éš†é“¶è¡Œ</b> . <b onclick='fetchUsCode("usBIDU.OQ")'>usBIDU.OQ ç™¾åº¦</b> . <b onclick='fetchUsCode("usBAX.N")'>usBAX.N ç™¾ç‰¹å›½é™…</b> . <b onclick='fetchUsCode("usATVI.OQ")'>usATVI.OQ åŠ¨è§†æš´é›ª</b> . <b onclick='fetchUsCode("usATSG.OQ")'>usATSG.OQ èˆªç©ºè¿è¾“æœåŠ¡</b> . <b onclick='fetchUsCode("usAPH.N")'>usAPH.N å®‰è¯ºç”µå­</b> . <b onclick='fetchUsCode("usAMRC.N")'>usAMRC.N é˜¿æ¢…é›·æ–¯å…‹</b> . <b onclick='fetchUsCode("usAMGN.OQ")'>usAMGN.OQ å®‰è¿›</b> . <b onclick='fetchUsCode("usAMBA.OQ")'>usAMBA.OQ å®‰éœ¸</b> . <b onclick='fetchUsCode("usALL.N")'>usALL.N å¥½äº‹è¾¾</b> . <b onclick='fetchUsCode("usADSK.OQ")'>usADSK.OQ æ¬§ç‰¹å…‹</b> . <b onclick='fetchUsCode("usABT.N")'>usABT.N é›…åŸ¹</b> . <b onclick='fetchUsCode("usAAPL.OQ")'>usAAPL.OQ è‹¹æœ</b> . <b onclick='fetchUsCode("usYY.OQ")'>usYY.OQ æ¬¢èš</b> . <b onclick='fetchUsCode("usYRD.N")'>usYRD.N å®œäººé‡‘ç§‘</b> . <b onclick='fetchUsCode("usXNET.OQ")'>usXNET.OQ è¿…é›·</b> . <b onclick='fetchUsCode("usXIN.N")'>usXIN.N é‘«è‹‘ç½®ä¸š</b> . <b onclick='fetchUsCode("usVNET.OQ")'>usVNET.OQ ä¸–çºªäº’è”</b> . <b onclick='fetchUsCode("usVIPS.N")'>usVIPS.N å”¯å“ä¼š</b> . <b onclick='fetchUsCode("usUTSI.OQ")'>usUTSI.OQ UTæ–¯è¾¾åº·</b> . <b onclick='fetchUsCode("usTOUR.OQ")'>usTOUR.OQ é€”ç‰›</b> . <b onclick='fetchUsCode("usTEDU.OQ")'>usTEDU.OQ è¾¾å†…ç§‘æŠ€</b> . <b onclick='fetchUsCode("usTANH.OQ")'>usTANH.OQ ç¢³åšå£«æ§è‚¡</b> . <b onclick='fetchUsCode("usTAL.N")'>usTAL.N å¥½æœªæ¥</b> . <b onclick='fetchUsCode("usSOL.N")'>usSOL.N Emeren Group Ltd</b> . <b onclick='fetchUsCode("usSOHU.OQ")'>usSOHU.OQ æœç‹</b> . <b onclick='fetchUsCode("usSEED.OQ")'>usSEED.OQ å¥¥ç‘é‡‘ç§ä¸š</b> . <b onclick='fetchUsCode("usRCON.OQ")'>usRCON.OQ ç ”æ§ç§‘æŠ€</b> . <b onclick='fetchUsCode("usOIIM.OQ")'>usOIIM.OQ å‡¹å‡¸ç§‘æŠ€</b> . <b onclick='fetchUsCode("usNOAH.N")'>usNOAH.N è¯ºäºšè´¢å¯Œ</b> . <b onclick='fetchUsCode("usNCTY.OQ")'>usNCTY.OQ ç¬¬ä¹åŸå¸‚</b> . <b onclick='fetchUsCode("usMOXC.OQ")'>usMOXC.OQ é­”çº¿</b> . <b onclick='fetchUsCode("usMOMO.OQ")'>usMOMO.OQ æŒšæ–‡é›†å›¢</b> . <b onclick='fetchUsCode("usMLCO.OQ")'>usMLCO.OQ æ–°æ¿ åšäºšå¨±ä¹</b> . <b onclick='fetchUsCode("usLITB.N")'>usLITB.N å…°äº­é›†åŠ¿</b> . <b onclick='fetchUsCode("usLEJU.N")'>usLEJU.N ä¹å±…</b> . <b onclick='fetchUsCode("usKNDI.OQ")'>usKNDI.OQ åº·è¿ªè½¦ä¸š</b> . <b onclick='fetchUsCode("usJKS.N")'>usJKS.N æ™¶ç§‘èƒ½æº</b> . <b onclick='fetchUsCode("usJD.OQ")'>usJD.OQ äº¬ä¸œ</b> . <b onclick='fetchUsCode("usHTHT.OQ")'>usHTHT.OQ åä½</b> . <b onclick='fetchUsCode("usHOLI.OQ")'>usHOLI.OQ å’Œåˆ©æ—¶è‡ªåŠ¨åŒ–</b> . <b onclick='fetchUsCode("usHIHO.OQ")'>usHIHO.OQ éª‡ç»´é‡‘å±åŠ å·¥</b> . <b onclick='fetchUsCode("usHCM.OQ")'>usHCM.OQ å’Œé»„åŒ»è¯</b> . <b onclick='fetchUsCode("usGURE.OQ")'>usGURE.OQ æµ·æ¹¾èµ„æº</b> . <b onclick='fetchUsCode("usFTFT.OQ")'>usFTFT.OQ æœªæ¥é‡‘èç§‘æŠ€</b> . <b onclick='fetchUsCode("usFENG.N")'>usFENG.N å‡¤å‡°æ–°åª’ä½“</b> . <b onclick='fetchUsCode("usEDU.N")'>usEDU.N æ–°ä¸œæ–¹</b> . <b onclick='fetchUsCode("usDSWL.OQ")'>usDSWL.OQ å¾·æ–¯ç»´å°”å·¥ä¸š</b> . <b onclick='fetchUsCode("usDQ.N")'>usDQ.N å¤§å…¨æ–°èƒ½æº</b> . <b onclick='fetchUsCode("usCYD.N")'>usCYD.N ç‰æŸ´å›½é™…</b> . <b onclick='fetchUsCode("usCXDC.PS")'>usCXDC.PS é‘«è¾¾é›†å›¢</b> . <b onclick='fetchUsCode("usCREG.OQ")'>usCREG.OQ ä¸­å›½å¾ªç¯èƒ½æº</b> . <b onclick='fetchUsCode("usCOE.N")'>usCOE.N 51Talk</b> . <b onclick='fetchUsCode("usCNET.OQ")'>usCNET.OQ ä¸­ç½‘è½½çº¿</b> . <b onclick='fetchUsCode("usCMCM.N")'>usCMCM.N çŒè±¹ç§»åŠ¨</b> . <b onclick='fetchUsCode("usCLWT.OQ")'>usCLWT.OQ æ¬§é™†ç§‘ä»ª</b> . <b onclick='fetchUsCode("usCJJD.OQ")'>usCJJD.OQ ä¹æ´²å¤§è¯æˆ¿</b> . <b onclick='fetchUsCode("usCHNR.OQ")'>usCHNR.OQ ä¸­å›½å¤©ç„¶èµ„æº</b> . <b onclick='fetchUsCode("usCGA.N")'>usCGA.N ä¸­å›½ç»¿è‰²å†œä¸š</b> . <b onclick='fetchUsCode("usCCM.N")'>usCCM.N æ³°å’Œè¯šåŒ»ç–—</b> . <b onclick='fetchUsCode("usCAAS.OQ")'>usCAAS.OQ ä¸­æ±½ç³»ç»Ÿ</b> . <b onclick='fetchUsCode("usBZUN.OQ")'>usBZUN.OQ å®å°Šç”µå•†</b> . <b onclick='fetchUsCode("usBSPM.OQ")'>usBSPM.OQ Biostar Pharmaceuticals, Inc.</b> . <b onclick='fetchUsCode("usBGNE.OQ")'>usBGNE.OQ ç™¾æµç¥å·</b> . <b onclick='fetchUsCode("usBEDU.N")'>usBEDU.N åšå®ä¹</b> . <b onclick='fetchUsCode("usBABA.N")'>usBABA.N é˜¿é‡Œå·´å·´</b> . <b onclick='fetchUsCode("usATHM.N")'>usATHM.N æ±½è½¦ä¹‹å®¶</b> . <b onclick='fetchUsCode("usATAI.OQ")'>usATAI.OQ Atai Life Sciences Nv</b> . <b onclick='fetchUsCode("usUMC.N")'>usUMC.N è”ç”µ</b> . <b onclick='fetchUsCode("usTSM.N")'>usTSM.N å°ç§¯ç”µ</b> . <b onclick='fetchUsCode("usHIMX.OQ")'>usHIMX.OQ å¥‡æ™¯å…‰ç”µ</b> . <b onclick='fetchUsCode("usGIGM.OQ")'>usGIGM.OQ å’Œä¿¡è¶…åª’ä½“</b> . <b onclick='fetchUsCode("usCHT.N")'>usCHT.N ä¸­åç”µä¿¡</b> . <b onclick='fetchUsCode("usASX.N")'>usASX.N æ—¥æœˆå…‰åŠå¯¼ä½“</b> . <b onclick='fetchUsCode("usXRX.OQ")'>usXRX.OQ æ–½ä¹</b> . <b onclick='fetchUsCode("usVZ.N")'>usVZ.N Verizon</b> . <b onclick='fetchUsCode("usUBER.N")'>usUBER.N ä¼˜æ­¥</b> . <b onclick='fetchUsCode("usTSLA.OQ")'>usTSLA.OQ ç‰¹æ–¯æ‹‰</b> . <b onclick='fetchUsCode("usTMUS.OQ")'>usTMUS.OQ T-Mobile Us Inc</b> . <b onclick='fetchUsCode("usSWKS.OQ")'>usSWKS.OQ æ€ä½³è®¯</b> . <b onclick='fetchUsCode("usQRVO.OQ")'>usQRVO.OQ Qorvo Inc</b> . <b onclick='fetchUsCode("usMU.OQ")'>usMU.OQ ç¾å…‰ç§‘æŠ€</b> . <b onclick='fetchUsCode("usMSI.N")'>usMSI.N æ‘©æ‰˜ç½—æ‹‰è§£å†³æ–¹æ¡ˆ</b> . <b onclick='fetchUsCode("usMMI.N")'>usMMI.N é©¬åº“æ–¯ç±³åˆ©æŸ¥æ™®</b> . <b onclick='fetchUsCode("usMETA.OQ")'>usMETA.OQ Meta Platforms Inc</b> . <b onclick='fetchUsCode("usMCHP.OQ")'>usMCHP.OQ å¾®èŠ¯ç§‘æŠ€</b> . <b onclick='fetchUsCode("usMA.N")'>usMA.N ä¸‡äº‹è¾¾</b> . <b onclick='fetchUsCode("usLYFT.OQ")'>usLYFT.OQ Lyft Inc</b> . <b onclick='fetchUsCode("usLOGI.OQ")'>usLOGI.OQ ç½—æŠ€</b> . <b onclick='fetchUsCode("usJBL.N")'>usJBL.N æ·æ™®ç§‘æŠ€</b> . <b onclick='fetchUsCode("usIGT.N")'>usIGT.N å›½é™…æ¸¸æˆç§‘æŠ€</b> . <b onclick='fetchUsCode("usIBM.N")'>usIBM.N IBM</b> . <b onclick='fetchUsCode("usHPQ.N")'>usHPQ.N æƒ æ™®</b> . <b onclick='fetchUsCode("usHPE.N")'>usHPE.N æ…§ä¸</b> . <b onclick='fetchUsCode("usEMR.N")'>usEMR.N è‰¾é»˜ç”Ÿç”µæ°”</b> . <b onclick='fetchUsCode("usDT.N")'>usDT.N Dynatrace Inc</b> . <b onclick='fetchUsCode("usDLB.N")'>usDLB.N æœæ¯”å®éªŒå®¤</b> . <b onclick='fetchUsCode("usCMBM.OQ")'>usCMBM.OQ Cambium Networks Corporation</b> . <b onclick='fetchUsCode("usATI.N")'>usATI.N é˜¿å‹’æ ¼å°¼æŠ€æœ¯</b> . <b onclick='fetchUsCode("usARW.N")'>usARW.N è‰¾ç¿</b> . <b onclick='fetchUsCode("usADI.OQ")'>usADI.OQ äºšå¾·è¯º</b> . <b onclick='fetchUsCode("usACM.N")'>usACM.N Aecom</b> . <b onclick='fetchUsCode("usACLS.OQ")'>usACLS.OQ Axcelis Technologies</b> . <b onclick='fetchUsCode("usABNB.OQ")'>usABNB.OQ çˆ±å½¼è¿</b> . <b onclick='fetchUsCode("usVRSN.OQ")'>usVRSN.OQ å¨ç‘ä¿¡</b> . <b onclick='fetchUsCode("usTRMB.OQ")'>usTRMB.OQ å¤©å®å¯¼èˆªå…¬å¸</b> . <b onclick='fetchUsCode("usTDC.N")'>usTDC.N å¤©ç¿å…¬å¸</b> . <b onclick='fetchUsCode("usT.N")'>usT.N AT&amp;T</b> . <b onclick='fetchUsCode("usSTX.OQ")'>usSTX.OQ å¸Œæ·ç§‘æŠ€</b> . <b onclick='fetchUsCode("usSRAD.OQ")'>usSRAD.OQ Sportradar Group Ag</b> . <b onclick='fetchUsCode("usSATS.OQ")'>usSATS.OQ å›å£°æ˜Ÿé€šä¿¡</b> . <b onclick='fetchUsCode("usPYPL.OQ")'>usPYPL.OQ Paypal</b> . <b onclick='fetchUsCode("usKLAC.OQ")'>usKLAC.OQ ç§‘ç£Š</b> . <b onclick='fetchUsCode("usJNPR.N")'>usJNPR.N ç»åšç½‘ç»œ</b> . <b onclick='fetchUsCode("usGE.N")'>usGE.N é€šç”¨ç”µæ°”</b> . <b onclick='fetchUsCode("usERIC.OQ")'>usERIC.OQ çˆ±ç«‹ä¿¡</b> . <b onclick='fetchUsCode("usEAR.OQ")'>usEAR.OQ Eargo Inc</b> . <b onclick='fetchUsCode("usDD.N")'>usDD.N æœé‚¦</b> . <b onclick='fetchUsCode("usCVLT.OQ")'>usCVLT.OQ åº·æ²ƒç³»ç»Ÿ</b> . <b onclick='fetchUsCode("usCSCO.OQ")'>usCSCO.OQ æ€ç§‘</b> . <b onclick='fetchUsCode("usCRWD.OQ")'>usCRWD.OQ Crowdstrike Holdings Inc</b> . <b onclick='fetchUsCode("usCRM.N")'>usCRM.N èµ›å¯Œæ—¶</b> . <b onclick='fetchUsCode("usCIEN.N")'>usCIEN.N Cienaç§‘æŠ€</b> . <b onclick='fetchUsCode("usCDNS.OQ")'>usCDNS.OQ æ¥·ç™»ç”µå­</b> . <b onclick='fetchUsCode("usAZPN.OQ")'>usAZPN.OQ è‰¾æ–¯æœ¬</b> . <b onclick='fetchUsCode("usAVGO.OQ")'>usAVGO.OQ åšé€š</b> . <b onclick='fetchUsCode("usATNI.OQ")'>usATNI.OQ Atn International Inc</b> . <b onclick='fetchUsCode("usAMD.OQ")'>usAMD.OQ ç¾å›½è¶…å¾®å…¬å¸</b> . <b onclick='fetchUsCode("usALTR.OQ")'>usALTR.OQ Altair Engineering Inc</b> . <b onclick='fetchUsCode("usAKAM.OQ")'>usAKAM.OQ é˜¿å…‹è¿ˆ</b> . <b onclick='fetchUsCode("usACN.N")'>usACN.N åŸƒæ£®å“²</b> . <b onclick='fetchUsCode("usZM.OQ")'>usZM.OQ Zoomè§†é¢‘é€šè®¯</b> . <b onclick='fetchUsCode("usWISH.OQ")'>usWISH.OQ Contextlogic Inc</b> . <b onclick='fetchUsCode("usWE.N")'>usWE.N Wework Inc</b> . <b onclick='fetchUsCode("usVOD.OQ")'>usVOD.OQ æ²ƒè¾¾ä¸°</b> . <b onclick='fetchUsCode("usTYL.N")'>usTYL.N æ³°å‹’ç§‘æŠ€</b> . <b onclick='fetchUsCode("usTDS.N")'>usTDS.N ç”µè¯å’Œæ•°æ®ç³»ç»Ÿ</b> . <b onclick='fetchUsCode("usSPCE.N")'>usSPCE.N ç»´çé“¶æ²³</b> . <b onclick='fetchUsCode("usSNOW.N")'>usSNOW.N Snowflake Inc</b> . <b onclick='fetchUsCode("usSNAP.N")'>usSNAP.N Snap Inc</b> . <b onclick='fetchUsCode("usS.N")'>usS.N Sentinelone Inc</b> . <b onclick='fetchUsCode("usRBLX.N")'>usRBLX.N Roblox Corporation</b> . <b onclick='fetchUsCode("usPINS.N")'>usPINS.N Pinterest Inc</b> . <b onclick='fetchUsCode("usPATH.N")'>usPATH.N Uipath Inc</b> . <b onclick='fetchUsCode("usOPEN.OQ")'>usOPEN.OQ Opendoor Technologies Inc</b> . <b onclick='fetchUsCode("usNOW.N")'>usNOW.N ç°åœ¨æœåŠ¡å…¬å¸</b> . <b onclick='fetchUsCode("usNOK.N")'>usNOK.N è¯ºåŸºäºš</b> . <b onclick='fetchUsCode("usMRVL.OQ")'>usMRVL.OQ è¿ˆå¨å°”ç§‘æŠ€</b> . <b onclick='fetchUsCode("usJMIA.N")'>usJMIA.N Jumia Technologies Ag</b> . <b onclick='fetchUsCode("usINFA.N")'>usINFA.N Informatica Inc</b> . <b onclick='fetchUsCode("usGOOGL.OQ")'>usGOOGL.OQ è°·æ­Œ-A</b> . <b onclick='fetchUsCode("usGOOG.OQ")'>usGOOG.OQ è°·æ­Œ-C</b> . <b onclick='fetchUsCode("usFVRR.N")'>usFVRR.N Fiverr International Ltd</b> . <b onclick='fetchUsCode("usFSR.N")'>usFSR.N è²æ–¯å…‹</b> . <b onclick='fetchUsCode("usFFIV.OQ")'>usFFIV.OQ F5</b> . <b onclick='fetchUsCode("usDUOL.OQ")'>usDUOL.OQ å¤šé‚»å›½</b> . <b onclick='fetchUsCode("usDDD.N")'>usDDD.N 3Dç³»ç»Ÿ</b> . <b onclick='fetchUsCode("usCTSH.OQ")'>usCTSH.OQ é«˜çŸ¥ç‰¹</b> . <b onclick='fetchUsCode("usCCI.N")'>usCCI.N å† åŸå›½é™…</b> . <b onclick='fetchUsCode("usAPP.OQ")'>usAPP.OQ Applovin Corp</b> . <b onclick='fetchUsCode("usAMZN.OQ")'>usAMZN.OQ äºšé©¬é€Š</b> . <b onclick='fetchUsCode("usAMAT.OQ")'>usAMAT.OQ åº”ç”¨ææ–™</b> . <b onclick='fetchUsCode("usADBE.OQ")'>usADBE.OQ Adobe Inc</b> . <b onclick='fetchUsCode("usWFC.N")'>usWFC.N å¯Œå›½é“¶è¡Œ</b> . <b onclick='fetchUsCode("usUSB.N")'>usUSB.N ç¾å›½åˆä¼—é“¶è¡Œ</b> . <b onclick='fetchUsCode("usJPM.N")'>usJPM.N æ‘©æ ¹å¤§é€š</b> . <b onclick='fetchUsCode("usHIG.N")'>usHIG.N ç¾å›½å“ˆç‰¹ç¦å¾·é‡‘è</b> . <b onclick='fetchUsCode("usGS.N")'>usGS.N é«˜ç››</b> . <b onclick='fetchUsCode("usCI.N")'>usCI.N ä¿¡è¯º</b> . <b onclick='fetchUsCode("usBAC.N")'>usBAC.N ç¾å›½é“¶è¡Œ</b> . <b onclick='fetchUsCode("usAXP.N")'>usAXP.N ç¾å›½è¿é€š</b> . <b onclick='fetchUsCode("usAIG.N")'>usAIG.N ç¾å›½å›½é™…é›†å›¢</b> . <b onclick='fetchUsCode("usMRK.N")'>usMRK.N é»˜æ²™ä¸œ</b> . <b onclick='fetchUsCode("usMO.N")'>usMO.N å¥¥é©°äºš</b> . <b onclick='fetchUsCode("usMDT.N")'>usMDT.N ç¾æ•¦åŠ›</b> . <b onclick='fetchUsCode("usMCD.N")'>usMCD.N éº¦å½“åŠ³</b> . <b onclick='fetchUsCode("usKO.N")'>usKO.N å¯å£å¯ä¹</b> . <b onclick='fetchUsCode("usCVS.N")'>usCVS.N CVSå¥åº·</b> . <b onclick='fetchUsCode("usCPB.N")'>usCPB.N é‡‘å®æ±¤</b> . <b onclick='fetchUsCode("usBMY.N")'>usBMY.N æ–½è´µå®</b> . <b onclick='fetchUsCode("usXOM.N")'>usXOM.N åŸƒå…‹æ£®ç¾å­š</b> . <b onclick='fetchUsCode("usWMB.N")'>usWMB.N å¨å»‰å§†æ–¯</b> . <b onclick='fetchUsCode("usSO.N")'>usSO.N ç¾å›½å—æ–¹å…¬å¸</b> . <b onclick='fetchUsCode("usSLB.N")'>usSLB.N æ–¯ä¼¦è´è°¢</b> . <b onclick='fetchUsCode("usHAL.N")'>usHAL.N å“ˆé‡Œä¼¯é¡¿</b> . <b onclick='fetchUsCode("usGM.N")'>usGM.N é€šç”¨æ±½è½¦</b> . <b onclick='fetchUsCode("usF.N")'>usF.N ç¦ç‰¹æ±½è½¦</b> . <b onclick='fetchUsCode("usEXC.OQ")'>usEXC.OQ çˆ±å…‹æ–¯é¾™ç”µåŠ›</b> . <b onclick='fetchUsCode("usEP.AM")'>usEP.AM Empire Petroleum Corporation</b> . <b onclick='fetchUsCode("usCVX.N")'>usCVX.N é›ªä½›é¾™</b> . <b onclick='fetchUsCode("usAES.N")'>usAES.N AESå‘ç”µ</b> . <b onclick='fetchUsCode("usAEP.OQ")'>usAEP.OQ ç¾å›½ç”µåŠ›</b> . <b onclick='fetchUsCode("usNWS.OQ")'>usNWS.OQ æ–°é—»é›†å›¢ Class B</b> . <b onclick='fetchUsCode("usDIS.N")'>usDIS.N è¿ªå£«å°¼</b> . <b onclick='fetchUsCode("usCCU.N")'>usCCU.N æ™ºåˆ©CCUå•¤é…’</b> . <b onclick='fetchUsCode("usWY.N")'>usWY.N æƒ å¥½</b> . <b onclick='fetchUsCode("usWMT.N")'>usWMT.N æ²ƒå°”ç›</b> . <b onclick='fetchUsCode("usUPS.N")'>usUPS.N è”åˆåŒ…è£¹</b> . <b onclick='fetchUsCode("usPG.N")'>usPG.N å®æ´</b> . <b onclick='fetchUsCode("usNSC.N")'>usNSC.N è¯ºç¦å…‹å—æ–¹</b> . <b onclick='fetchUsCode("usMMM.N")'>usMMM.N 3M Company</b> . <b onclick='fetchUsCode("usIP.N")'>usIP.N å›½é™…çº¸ä¸š</b> . <b onclick='fetchUsCode("usHD.N")'>usHD.N å®¶å¾—å®</b> . <b onclick='fetchUsCode("usEL.N")'>usEL.N é›…è¯—å…°é»›</b> . <b onclick='fetchUsCode("usDOW.N")'>usDOW.N é™¶æ°åŒ–å­¦</b> . <b onclick='fetchUsCode("usCL.N")'>usCL.N é«˜éœ²æ´</b> . <b onclick='fetchUsCode("usBA.N")'>usBA.N æ³¢éŸ³</b> . <b onclick='fetchUsCode("usAA.N")'>usAA.N ç¾å›½é“ä¸šå…¬å¸</b> . <b onclick='fetchUsCode("usUSNA.N")'>USNA.N ä¼˜èå¨œ</b> . <b onclick='fetchUsCode("usUSO.AM")'>USO.AM ç¾å›½åŸæ²¹ETF</b> . </pre>

<script>
      let thestkdata = [];
      let dateLst = [];
      let openLst = [];
      let highLst = [];
      let lowLst = [];
      let midLst = [];
      let closeLst = [];
      let amtLst = [];
      let startIntv = 6;

      if (localStorage.getItem("daychartWidth") === null) {
        localStorage.setItem("daychartWidth", 75);
        period = 75;
      } else{
        period = localStorage.getItem("daychartWidth");
      }
      dataStatus = "L"
      intv1 = startIntv
      intv2 = 2*intv1
      intv3 = 3*intv1
      intv4 = 4*intv1
      intv5 = 5*intv1
      intv6 = 6*intv1
      intv7 = 7*intv1
      intv8 = 8*intv1
      intv9 = 9*intv1
      stkpriceDataArr = [];
      stkList = codeList.split(' ');
      stkPointer = 0;
      theCode = localStorage.randomcode;
      titleText = "";
      starti = 0;
      chartColor = ['red','green','orange','blue','#900','#a00','#b0f','#c00','#d0a','gray','purple','yellow','white']

      attentionList = ""

      var options = '';  // build the List select option
      for (var i = 0; i < allListNames.length; i++) {
         options += '<option value="' + allListNames[i]+ '">' + allListNames[i] + '</option>';
      }
      $("#selectList").html(options);


      if (localStorage.getItem("attentionList") === null) {
        localStorage.attentionList = "07500";
      } else{
        attentionList = localStorage.getItem("attentionList").split(',');
      }
      //console.log(attentionList)

      // load localStorage.savedCodeList
      if (localStorage.getItem("savedCodeList") === null) {
        quickCodeList = ["110000"];
        localStorage.savedCodeList = quickCodeList;
      } else{
        quickCodeList = localStorage.getItem("savedCodeList").split(',');
      }


      // added extra links
      bigVolHeader = "http://www.etnet.com.hk/www/tc/stocks/realtime/quote_transaction.php?code="
      shortsellHeader = "http://www.aastocks.com/tc/stocks/analysis/stock-short-selling-ratio.aspx?symbol="
      newshead = "http://www.aastocks.com/tc/stocks/analysis/stock-aafn/"
      newstail = "/0/all/1"

      function askforCode() {
        var tempCode = prompt("Code Number:", "");
        if (tempCode != null && tempCode != ""){

            codewidth = tempCode.length
            if(codewidth <= 5){
              theCode = "00000"+tempCode;
              codewidth = theCode.length;
              theCode = theCode.slice(codewidth-5, codewidth);
              codewidth = theCode.length; //update to be used later
            }else{
              theCode = tempCode
            }

           storeCode(theCode)
           collectStkData(theCode)  // show turnover and draw
        }
      }

      function collectStkData(theCode) {
      $("#turnover").html(
       '<br><span class="randomBut gold bordred1 borRad10" onclick="askforCode()">å·ç </span> ' +
       '<span class="randomBut gold bordred1 borRad10" onclick="jpforward()">Next</span> ' +
      '<a href="' + bigVolHeader + theCode +'" target="_blank" class="white bordred1 borRad10">å¤§æˆ¶</a>' +
      '<a href="' + newshead + theCode + newstail +'" target="_blank" class="white bordred1 borRad10">è³‡æ–™</a>' +
      '<a href="' + shortsellHeader + theCode + '" target="_blank" class="white bordred1 borRad10">æ²½ç©º</a> '
      );

        //if(isNaN(theCode.substring(0, 1))){  // is it character}
        if( theCode.substring(0, 2) == "us"){
              theurl = 'https://web.ifzq.gtimg.cn/appstock/app/usfqkline/get?_var=kline_dayqfq&param=' + theCode + ',day,,,1000,qfq';
              imageCode = theCode
        }else{

          if(theCode == "110000"){
             theCode = "HSI"; imageCode = "110000"
          }

          codewidth = theCode.length
          if(theCode == "HSI"){
              theurl = 'https://web.ifzq.gtimg.cn/appstock/app/hkfqkline/get?_var=kline_dayqfq&param=hk' + theCode + ',day,,,1000,qfq';
              imageCode = "110000"
          }else{
            if(codewidth <= 5){
              theCode = "00000"+theCode;
              codewidth = theCode.length;
              theCode = theCode.slice(codewidth-5, codewidth);
              codewidth = theCode.length; //update to be used later
              theStartCode = theCode
              imageCode = theCode
              theurl = 'https://web.ifzq.gtimg.cn/appstock/app/hkfqkline/get?_var=kline_dayqfq&param=hk' + theCode + ',day,,,1000,qfq';
            }else{
              codewidth = theCode.length
              if((codewidth == 6) && !hsReservedCode.includes(theCode)){
                 if (theCode.charAt(0) == "6"){
                    imageCode = theCode+".sh"; // note this comes before following line
                    theCode = "sh"+theCode; 
                 }else{
                    imageCode = theCode+".sz";
                    theCode = "sz"+theCode
                 }
                 theStartCode = theCode
                 theurl = 'https://web.ifzq.gtimg.cn/appstock/app/fqkline/get?_var=kline_dayqfq&param=' + theCode + ',day,,,1000,qfq';
              }else if(codewidth == 9){
                imageCode = theCode
                theCode = theCode.substring(7, 9) + theCode.substring(0, 6);
                theStartCode = theCode

                theurl = 'https://web.ifzq.gtimg.cn/appstock/app/fqkline/get?_var=kline_dayqfq&param=' + theCode + ',day,,,1000,qfq';
              }else{
                theurl = 'https://web.ifzq.gtimg.cn/appstock/app/fqkline/get?_var=kline_dayqfq&param=' + theCode + ',day,,,1000,qfq';
                theStartCode = theCode
                imageCode = theCode
              }
            }
          }
        }
          theStartCode = theCode;
        document.getElementById("image").innerHTML = '<img src="http://charts.aastocks.com/servlet/Charts?fontsize=12&15MinDelay=F&lang=1&titlestyle=1&vol=1&Indicator=3&indpara1=3&indpara2=6&indpara3=9&indpara4=12&indpara5=15&subChart1=3&ref1para1=7&ref1para2=10&ref1para3=3&subChart2=3&ref2para1=12&ref2para2=26&ref2para3=9&subChart3=7&ref3para1=7&ref3para2=5&ref3para3=0&subChart4=7&ref4para1=11&ref4para2=8&ref3para3=0&subChart5=13&ref4para1=0&ref4para2=0&ref4para3=0&scheme=3&com=100&chartwidth=1200&chartheight=760&stockid='+ imageCode +'&period=7&type=1&logoStyle=1">'


          thestkdata = [];
          thedrawdata = [];
          dateLst = [];
          openLst = [];
          highLst = [];
          lowLst = [];
          midLst = [];
          closeLst = [];
          amtLst.length = 0;
      
          RGraph.AJAX.getJSON(theurl, function (rawJSON){
              var keys = Object.keys(rawJSON); // read the structure keys ["code", "msg", "data"]

              var insideDatakey = Object.keys(rawJSON)[2] //
              // myobj[Object.keys(myobj)[0]] this is the extract method
      
              var thedata = rawJSON[Object.keys(rawJSON)[2]]
              thestkkey = Object.keys(thedata)[0] // this is the stk key name
              var tempdata = thedata[Object.keys(thedata)[0]];
              thestkdata = tempdata[Object.keys(tempdata)[0]]; // real data here, this is whole dataset

              if(thestkdata.length == 0){alert("no data in: " + thestkkey)}

              for(i=(thestkdata.length-12);i<thestkdata.length;i++){
                    thedate = thestkdata[i][0];  // date
                    if(codewidth <= 5){
                      theAmtIdx = 8;
                    }else{
                      theAmtIdx = 5;
                    }
                    theamt = Math.round(Number(thestkdata[i][theAmtIdx]));
                    if(codewidth > 5){
                      if(theCode.slice(0, 5) == "sh688"){
                        theamt = Math.round(theamt * Number(thestkdata[i][2])/10000);
                      }else{
                        theamt = Math.round(theamt * Number(thestkdata[i][2])/100);
                      }
                    }
                    theamt = theamt.toString().replace(/\B(?=(\d{4})+(?!\d))/g, ",");
                    $("#turnover").prepend( theamt,"w ");
                  }
      
              theNameObj = tempdata[Object.keys(tempdata)[1]];
              theNameObjName  = theNameObj[Object.keys(theNameObj)[0]];
              stkName = theNameObjName[1]
      
              /* data is arranged in days array, tempdata[320] is last set
              tempdata[320][0]  // date
              tempdata[320][1]  // open
              tempdata[320][3]  // high
              tempdata[320][4]  // low
              tempdata[320][2]  // close */
      
                //period + intv1, the chartwidth + max trend interval
              starti = thestkdata.length - (parseInt(period) + parseInt(intv1)) -5; 
              if(starti <= 0){
                  alert(theStartCode + " " + stkName +" not enough data! dataLength: " + thestkdata.length);
                  return;
              }

              for (let i = starti; i < thestkdata.length; i++) {
                  dateLst.push(thestkdata[i][0]);
                  openLst.push(Number(thestkdata[i][1]));
                  highLst.push(Number(thestkdata[i][3]));
                  lowLst.push(Number(thestkdata[i][4]));
                  midLst.push((Number(thestkdata[i][3]) + Number(thestkdata[i][4]))/2);
                  closeLst.push(Number(thestkdata[i][2]));
                  amtvalue = "&emsp;" + Math.round(Number(thestkdata[i][8])).toString().replace(/\B(?=(\d{4})+(?!\d))/g, ",") +"w ";
                  amtLst.push(amtvalue);
              }
              if(dataStatus == "C"){ stkpriceDataArr = closeLst
              }else if(dataStatus == "L"){ stkpriceDataArr = lowLst
              }else if(dataStatus == "M"){ stkpriceDataArr = midLst
              }else { stkpriceDataArr = highLst}

              redraw();  // this line must be inside the AJAX because AJAX run last
           });

           showDateTime();
           $("#dateTime").prepend("Item " + (stkPointer+1) + " of " + stkList.length + ", ");

           //showActivity(theCode)

      }

     function chkKey() {
       var testkey = getChar(event);
       if(testkey == '0'){ theCode = '000001.sh'; collectStkData('000001.sh');}

       else if(testkey == '3'){ theCode = '399001.sz'; collectStkData('399001.sz');}
       else if(testkey == '1'){ theCode = '110000'; collectStkData('HSI');}
       else if(testkey == '2'){ theCode = '01339'; collectStkData('02013');}
       else if(testkey == '4'){ theCode = '01766'; collectStkData('01766');}
       else if(testkey == '5'){ theCode = '03800'; collectStkData('03800');}
       else if(testkey == '6'){ theCode = '00371'; collectStkData('00371');}
       else if(testkey == '7'){ theCode = '00788'; collectStkData('00788');}
       else if(testkey == '8'){ theCode = '00308'; collectStkData('00308');}
       else if(testkey == '9'){ theCode = '00390'; collectStkData('00390');}
       else if(testkey == 'u'){ theCode = 'us.DJI'; collectStkData('us.DJI');}
       else if(testkey == 'n'){ theCode = 'us.IXIC'; collectStkData('us.IXIC');}
       else if(testkey == 'J'){ theCode = 'us.INX'; collectStkData('us.INX');}
       else if(testkey == 'U'){ $('#usstock').toggle(); window.location = '#usstock';}
       else if(testkey == 'd'){fillLineData();}
       else if(testkey == 'c'){askforCode();}
       else if(testkey == '+'){addToquickCodeList();}
       else if(testkey == 'q'){myfavor();}
       else if(testkey == 'Q'){usequickCodeList();}
       else if(testkey == 'B'){usestkListArr();}

       // if(testkey == '+'){addToAttentionList();}
       else if(testkey == '-'){removeFmquickCodeList();}
       else if(testkey == 'X'){storeCode(theCode); window.open("Random Charts.html");}
       else if(testkey == '.'){storeCode(theCode); window.open("mlineMinutechart.html");}

       else if(testkey == 'a'){useAttentionList();}
       else if(testkey == 'f'){jpforward();}
       else if(testkey == ']'){jpforward();}
       else if(testkey == 'b'){jpback();}
       else if(testkey == '['){jpback();}
       else if(testkey == 'r'){jprandom();}
       else if(testkey == 't'){jpTo0();}
       else if(testkey == 'h'){chgHighList();}
       else if(testkey == 'l'){chgLowList();}
       else if(testkey == 'm'){chgMidList();}
       else if(testkey == 'i'){chgIntv();}
       else if(testkey == 'w'){chgchartWidth();}
       else if(testkey == 'j'){period = 300; intv1 = 30; collectStkData(theCode);}
       else if(testkey == 'k'){period = 50; intv1 = 2; collectStkData(theCode);}

       else if(testkey == 'C'){chgCloseLst();}
       else if(testkey == 'L'){askList()}
       else if(testkey == 'z'){largeCht()}
       else if(testkey == 'e'){window.location = '#commands';
            window.scrollTo(window.scrollX, window.scrollY - 300);}
       else if(testkey == 'E'){window.location = '#filterMarkers';}
       else{chkOtherKeys(testkey)} 
     }

     function getChar(event) {
       if (event.which!=0 && event.charCode!=0) {
         return String.fromCharCode(event.which)   // the rest
       } else {
         return null // special key
       }
     }

	function fillLineData() {
      var dataArr = prompt("Enter data array sep by space:", "");
      if (dataArr != null && dataArr != "") {
        dataArrArr = dataArr.split(' ');

        stkpriceDataArr = dataArrArr.map(Number);
        redraw()
      }
     }

      function addToquickCodeList() {
        codewidth = theCode.length
        if(codewidth <= 5){
          theCode = "00000"+theCode;
          codewidth = theCode.length;
          theCode = theCode.slice(codewidth-5, codewidth);
        }
        if (!quickCodeList.includes(theCode)) {
          quickCodeList.push(theCode);
          quickCodeList = Array.from(new Set(quickCodeList)); // set unique
          localStorage.savedCodeList = quickCodeList;
          alert(theCode + " added to quickCodeList")
        }else{alert(theCode + " already exist!")}
      }

    function usequickCodeList() {
        stkList = quickCodeList;
        alert("quickCodeList Total: " + quickCodeList.length + "\ndetails see end of this page.\nremember to modify mustadd list!")
        $("#message").text("quickCodeList Total: " + quickCodeList.length + "\n"+stkList);
    }

    function usestkListArr() {
      stkListArr = localStorage.getItem("stkListArr")
      if (stkListArr === null) {
         stkList = quickCodeList;
      } else{
         stkList = stkListArr;
      }
        alert("Use stkListArr, Total: " + stkListArr.length + " : "+stkListArr)
        $("#message").text("stkListArr Total: " + stkListArr.length + "\n"+stkList);
    }

	function addToAttentionList() {
            codewidth = theCode.length
            if(codewidth <= 5){
              theCode = "00000"+theCode;
              codewidth = theCode.length;
              theCode = theCode.slice(codewidth-5, codewidth);
              codewidth = theCode.length; //update to be used later
            }

        attentionList.push(theCode)
        attentionList = [...new Set(attentionList)]; // set unique

        ItemIndex = attentionList.indexOf("");  // remove empty items
        if (ItemIndex > -1) { attentionList.splice(ItemIndex, 1); }

        localStorage.setItem("attentionList", attentionList);
        alert(theCode + " added to attentionList!")
     }
	function removeFmquickCodeList() {
        ItemIndex = quickCodeList.indexOf(theCode);
        if (ItemIndex > -1) { quickCodeList.splice(ItemIndex, 1); }
        quickCodeList = [...new Set(quickCodeList)]; // set unique
        localStorage.setItem("quickCodeList", quickCodeList);
        alert(theCode + " removed fm quickCodeList!")
   }

     function redraw() {
        initIntvSteps()
        titleText = showDate() +" "+ showTime()+", p1: "+intv1+ " p9: "+intv9+" w: "+(thestkdata.length-starti) +"\n"+theStartCode + " " + stkName + " æ—¥ç·š ";
        $("#amtLst").html("Amt: ".concat(amtLst.slice((amtLst.length-14),amtLst.length).join("")));

 
        RGraph.reset(document.getElementById('cvs'));

        if(dataStatus == "C"){ stkpriceDataArr = closeLst
        }else if(dataStatus == "L"){ stkpriceDataArr = lowLst
        }else if(dataStatus == "M"){ stkpriceDataArr = midLst
        }else { stkpriceDataArr = highLst}

        stdDevH = makeStd(highLst, intv3)
        stdDevL = makeStd(lowLst, intv3)
        newDevadd = makeMovAve(stkpriceDataArr, intv3).map((a, i) => a + stdDevH[i]);
        newDevminus = makeMovAve(stkpriceDataArr, intv3).map((a, i) => a - stdDevL[i]);

        mydata = [ stkpriceDataArr]
          mydata.push(makeMovAve(stkpriceDataArr, intv1/2))
          mydata.push(makeMovAve(mydata[1], intv1))
          mydata.push(makeMovAve(mydata[1], intv2))
          mydata.push(makeMovAve(mydata[1], intv3))
          mydata.push(makeMovAve(mydata[1], intv4))
          mydata.push(makeMovAve(mydata[1], intv5))
          mydata.push(makeMovAve(mydata[1], intv6))
          mydata.push(makeMovAve(mydata[1], intv7))
          mydata.push(makeMovAve(mydata[1], intv8))
          mydata.push(newDevadd)
          mydata.push(newDevminus)
        theMax = Math.max(...[].concat(...mydata));
        theMin = Math.min(...[].concat(...mydata));

        thedrawdata = mydata
        thedrawdata.push(makeMovAve(thedrawdata[2], intv1));  // add one line to check results

        thedrawdata[1] = thedrawdata[1].fill(null,0,intv1)
        thedrawdata[2] = thedrawdata[2].fill(null,0,intv2)
        thedrawdata[3] = thedrawdata[3].fill(null,0,intv3)
        thedrawdata[4] = thedrawdata[4].fill(null,0,intv4)
        thedrawdata[5] = thedrawdata[5].fill(null,0,intv5)
        thedrawdata[6] = thedrawdata[6].fill(null,0,intv6)
        thedrawdata[7] = thedrawdata[7].fill(null,0,intv7)
        thedrawdata[8] = thedrawdata[8].fill(null,0,intv8)
        thedrawdata[9] = thedrawdata[9].fill(null,0,intv9)
        thedrawdata[10] = thedrawdata[10].fill(null,0,intv3)
        thedrawdata[11] = thedrawdata[11].fill(null,0,intv3)
        thedrawdata[12] = thedrawdata[12].fill(null,0,intv1)  // add one line 

statusMsg = '<br><span class="red">price '+ mydata[0].slice(-1)[0].toFixed(3) +
'</span>, <span class="darkgreen">intvS '+ mydata[1].slice(-1)[0].toFixed(3) +
'</span>, <span class="blue">intvL '+ mydata[2].slice(-1)[0].toFixed(3) +
'</span>, <span class="purple">Top '+ mydata[3].slice(-1)[0].toFixed(3) +
'</span>, <span class="yellow">Bottom '+ mydata[4].slice(-1)[0].toFixed(3) +
'</span>, <span class="darkgreen">IntvS '+ intv1 +
'</span>, <span class="blue">IntvL '+ intv2 +
'</span>'

$("#lastValues").text("");
$("#lastValues").append(statusMsg);

       drawchart()

		// create datalog table
		 transp = transpose(mydata);
            wAveTrendRange = [];  // this is the gap diff
		  for (var row=0; row < transp.length; row++) {
		    rowRange = transp[row].slice(1, mydata.length);
      	    rowMax = Math.max(...rowRange);
      	    rowMin = Math.min(...rowRange);
      	    var rowDiff = rowMax - rowMin;
      	    wAveTrendRange.push(rowDiff);
      	  }

		wAveTrendRange.fill(null,0,intv9);
		wAvemax = Math.max(...wAveTrendRange);
		wAvemin = Math.min(...wAveTrendRange);
		drawTrend(wAveTrendRange, wAvemax, wAvemin, 'TP');

		// find derivative
		derivative = diff(makeMovAve(mydata[0], 3));
		derivative.unshift(0);
		derivative.fill(null,0,intv1+3); //array.fill(value, start, end)

		// diffaccel
		// diffaccel = thedrawdata[baseSubIdx].map(function(item, index) { return item - thedrawdata[baseMinuIdx][index]; })
		diffaccel = []
		diffaccel.push(thedrawdata[1].map(function(item, index) { return item - thedrawdata[9][index]; }))
		diffaccel.push(thedrawdata[2].map(function(item, index) { return item - thedrawdata[9][index]; }))
		diffaccel.push(thedrawdata[3].map(function(item, index) { return item - thedrawdata[9][index]; }))
		diffaccel.push(thedrawdata[4].map(function(item, index) { return item - thedrawdata[9][index]; }))
		diffaccel.push(thedrawdata[5].map(function(item, index) { return item - thedrawdata[9][index]; }))
		diffaccel.push(thedrawdata[6].map(function(item, index) { return item - thedrawdata[9][index]; }))
		diffaccel[0].fill(null,0,intv9); //array.fill(value, start, end)
		diffaccel[1].fill(null,0,intv9); //array.fill(value, start, end)
		diffaccel[2].fill(null,0,intv9); //array.fill(value, start, end)
		diffaccel[3].fill(null,0,intv9); //array.fill(value, start, end)
		diffaccel[4].fill(null,0,intv9); //array.fill(value, start, end)
		diffaccel[5].fill(null,0,intv9); //array.fill(value, start, end)

		diffaccMax = Math.max(...[].concat.apply([], diffaccel));
		diffaccMin = Math.min(...[].concat.apply([], diffaccel));
		drawTrend(diffaccel, diffaccMax, diffaccMin, 'accel');


		// ddiffaccel
		ddiffaccel = []
		ddiffaccel.push(diffaccel[0].map(function(item, index) { return item - diffaccel[4][index]; }))
		ddiffaccel.push(diffaccel[1].map(function(item, index) { return item - diffaccel[4][index]; }))
		ddiffaccel.push(diffaccel[2].map(function(item, index) { return item - diffaccel[4][index]; }))
		ddiffaccel.push(diffaccel[3].map(function(item, index) { return item - diffaccel[4][index]; }))
		ddiffaccel.push(diffaccel[4].map(function(item, index) { return item - diffaccel[4][index]; }))
		ddiffaccel[0].fill(null,0,intv8); //array.fill(value, start, end)
		ddiffaccel[1].fill(null,0,intv8); //array.fill(value, start, end)
		ddiffaccel[2].fill(null,0,intv8); //array.fill(value, start, end)
		ddiffaccel[3].fill(null,0,intv8); //array.fill(value, start, end)
		ddiffaccel[4].fill(null,0,intv8); //array.fill(value, start, end)

		ddiffaccMax = Math.max(...[].concat.apply([], ddiffaccel));
		ddiffaccMin = Math.min(...[].concat.apply([], ddiffaccel));
		drawTrend(ddiffaccel, ddiffaccMax, ddiffaccMin, 'accaccel');

		// find stoch
		stoch1 = makeStoch(mydata[0], 50)
		stochmax1 = Math.max(...stoch1);
		stochmin1 = Math.min(...stoch1);
		drawTrend(stoch1, stochmax1, stochmin1, 'å¼ºå¼±50');

     }

	function makeMovAve(bigArray, intv) {
	     // the intv-1 is correct
		return bigArray.slice(0, intv-1).concat(calcMovAve(bigArray, intv));
	}
	function calcAve(aveArray) {
		add = (a, b) =>  a + b;
		return aveArray.reduce(add) / aveArray.length;
	}
	
	function calcMovAve(bigArray, intv) {
		var ma = [];
		for (var i =0 ; i < (bigArray.length-intv+1); i++) {ma[i] = calcWAve(bigArray.slice(i, i+intv));} // points to indicator
		return ma;
	}
	function calcWAve(aveArray) {
		var sum = 0
		for( var i = 1; i <= aveArray.length; i++ ) {
			sum += aveArray[i-1] * i;
		}
		return (sum / ((1 + aveArray.length)*aveArray.length/2))
	}

	function makeStoch(bigArray, intv) {
	     tempArr = bigArray.slice(0, intv-1).concat(calcStoch(bigArray, intv));
		return tempArr.fill(50,0,intv-1)
	}

	function calcStoch(bigArray, intv) {
		var stc = [];
		for (var i =0 ; i < (bigArray.length-intv+1); i++) {
			stc[i] = calc1Stoch(bigArray.slice(i, i+intv));
		}
		return stc;
	}

	function calc1Stoch(stcArray) {
			stcMax = Math.max(...stcArray)
			stcMin = Math.min(...stcArray)
			lastVal = stcArray[stcArray.length - 1]
			stcRange = stcMax - stcMin
			if(stcRange == 0){
				stcVal = 50
			}else{
				stcVal = 100*(lastVal - stcMin) / stcRange
			}
			return stcVal
	}

	function makeStd(bigArray, intv) {
	     // the intv-1 is correct
          newArray = new Array(intv-1).fill(0)
		newArray = newArray.concat(calcStd(bigArray, intv));
		return newArray
	}

	function calcStd(bigArray, intv) {
		var stdArrar = [];
		for (var i =0 ; i < (bigArray.length-intv+1); i++) {stdArrar[i] = Std(bigArray.slice(i, i+intv));} // points to indicator
		return stdArrar;
	}

	function Std(array) {
	  const n = array.length
	  const mean = array.reduce((a, b) => a + b) / n
	  return Math.sqrt(array.map(x => Math.pow(x - mean, 2)).reduce((a, b) => a + b) / n)
	}

	function transpose(thisArr) { // Swap rows with columns of a matrix
	    return Object.keys(thisArr[0]).map(function(column) {
	        return thisArr.map(function(row) { return row[column]; });
	    });
	}

    function useAttentionList() {
        stkList = attentionList;
        alert("AttentionList Total: " + attentionList.length + "\ndetails see end of this page.\nremember to modify mustadd list!")
        $("#message").text("Total: " + attentionList.length + "\n"+stkList);
    }

    function myfavor() {
        myfavorLst = mychips.split(" ");
        stkList = myfavorLst;
        alert("mychips Total: " + myfavorLst.length + "\ndetails see end of this page.\nremember to modify mustadd list!")
        $("#message").text("mychips Total: " + myfavorLst.length + "\n"+stkList);
    }

    function askList() {
        var theList = prompt("CodeList, Number (5 digits) sep by spaceï¼š ", "");
        if (theList != null && theList != "HSI" && theList != "") {
            stkList = theList.split(" ");
            alert("Supplied List Total: " + stkList.length + "\ndetails see end of this page.\nremember to modify mustadd list!")
            $("#message").text("Supplied List Total: " + stkList.length + "\n"+stkList);
        }
    }

    function FormatNumberLength5(num) {
        var r = "" + num;
        while (r.length < 5) { r = "0" + r; }
        return r;
    }

    function jpforward() {
        if (stkPointer < stkList.length-1) {
            stkPointer = stkPointer + 1;
        } else {
            stkPointer = 0;
        }
        theCode = stkList[stkPointer];
         collectStkData(theCode)
    }

    function jpback() {
        if (stkPointer > 0) {
            stkPointer = stkPointer - 1;
        } else {
            stkPointer = stkList.length-1;
        }
        theCode = stkList[stkPointer];
         collectStkData(theCode)
    }
    function jprandom() {
        stkPointer = Math.floor(Math.random() * (stkList.length-1))
        theCode = stkList[stkPointer]
         collectStkData(theCode)
    }

    function jpTo0() {
        stkPointer = 0;
        theCode = stkList[stkPointer]
        collectStkData(theCode)
    }

    function storeCode(theCode) {
        if(typeof(Storage) !== "undefined") {
            localStorage.randomcode = theCode;
        }
    }


    function chgchartWidth() {
        newChartWidth = prompt("enter chart width:", "");
        if (newChartWidth != null && newChartWidth != "" && newChartWidth < (1000 - 2*intv1)){
          period = parseInt(newChartWidth);
          localStorage.setItem("daychartWidth", period);
          collectStkData(theCode);
        }

    }
    function chgIntv() {
        intv = prompt("intv1 value:", "");
        if (theCode != null && intv1 != ""){
          intv1 = parseInt(intv);
          initIntvSteps()
          redraw()
        }
    }
    function initIntvSteps() {
      intv2 = 2*intv1
      intv3 = 3*intv1
      intv4 = 4*intv1
      intv5 = 5*intv1
      intv6 = 6*intv1
      intv7 = 7*intv1
      intv8 = 8*intv1
      intv9 = 9*intv1
    }
    function chgHighList() {
        dataStatus = "H"
        redraw()
    }
    function chgLowList() {
        dataStatus = "L"
        redraw()
    }
    function chgMidList() {
        dataStatus = "M"
        redraw()
    }
    function chgCloseLst() {
        dataStatus = "C"
        redraw()
    }

    function largeCht() {
        imgHead = "http://charts.aastocks.com/servlet/Charts?fontsize=12&15MinDelay=F&lang=1&titlestyle=1&vol=1&Indicator=3&indpara1=3&indpara2=5&indpara3=10&indpara4=15&indpara5=20&subChart2=3&ref2para1=12&ref2para2=26&ref2para3=9&subChart3=12&ref3para1=0&ref3para2=0&ref3para3=0&scheme=3&com=100&chartwidth=1600&chartheight=900&stockid=";

        imgTail = "&period=2060&type=1&logoStyle=1"
        imgURL = imgHead + theCode + imgTail
        window.open(imgURL, "_blank")
    }

function assignList(){
  newList = eval(document.getElementById("selectList").value).split(" ");
  stkList = newList;
  codeList = newList;
  // console.log(newList)

  document.getElementById("message").focus();
  alert(" Total: " + stkList.length + "\ndetails see end of this page.\nremember to modify mustadd list!\n" + newList)
        $("#message").text("Total: " + stkList.length + "\n"+stkList);
  $('#selectList').blur()

}

function showDateTime() {
    cmtCode = theCode // use another name not to interfere other parts
    var cmtcodewidth = cmtCode.length
    if(cmtcodewidth <= 5){
      cmtCode = "00000"+cmtCode;
      cmtcodewidth = cmtCode.length;
      cmtCode = cmtCode.slice(cmtcodewidth-5, cmtcodewidth);
    }
    else if(cmtcodewidth == 8){ cmtCode = cmtCode.slice(2, 8); }
    else if(cmtcodewidth == 9){ cmtCode = cmtCode.slice(0, 6); }
    commentName = "j" + cmtCode;

    CommentListNames = Object.keys(theCommentList); // extract the names from comments
    // to show comments
    if(CommentListNames.includes(commentName)){
      cmtLocation = CommentListNames.indexOf(commentName);
      commentTxt = theCommentList[Object.keys(theCommentList)[cmtLocation]]
    }else{commentTxt = "No data!";}

    document.getElementById("dateTime").innerHTML ="<span class='orange'>" + commentTxt + "</span>";
}

    function drawchart() {
      listItems = []
      if(dataStatus == "C"){ tooltips = closeLst
      }else if(dataStatus == "L"){ tooltips = lowLst
      }else if(dataStatus == "M"){ tooltips = midLst
      }else { tooltips = highLst}

      dataTooltips = tooltips.map(item => Math.round(item * 1000) / 1000)
      for (index = 0; index < dataTooltips.length; index++) {
        listItems[index] = dateLst[index] + "<br><span class='red'>" + dataStatus + "</span>: " + dataTooltips[index];
      }

      dataTooltips = dataTooltips.map(String)

      var line = new RGraph.Line({
        id:'cvs',
        data: thedrawdata,
        options: {
			title: titleText + " " + dataStatus,
			titleColor: 'grey',
			titleSize: 20,
               colors: chartColor,
            backgroundGrid: true, backgroundGridVlines: true,
            backgroundGridColor: '#001000', backgroundGridBorder: false,
            // backgroundGridDotted: true,
            backgroundGridDashed: true, 
            axisColor: '#864',  scaleDecimals: 2,
            xaxis: true,
            //xaxisLabels: ["a","b","c","d"],
            textColor: '#ccc',
            tickmarks: 'plus',
            ticksize: 1,
            linewidth:1,
			ymax: theMax,
			ymin: theMin,
      // labels control the number of grids
            // labels: ['2008','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018'],
            spline: false,
            shadow: false,
            tooltips: listItems,
            gutterLeft: 0, gutterRight: 50,
            gutterTop: 25, gutterBottom: 25
            }
          }).trace();

		yminpct = 100 - (theMax-theMin)*100/theMax,
		ymaxpct = 100,

          yaxis1 = new RGraph.Drawing.YAxis('cvs', 1200)
                .Set('colors', ['gold'])
                .Set('text.color', 'gray')
                .Set('text.size', 8)
                .Set('max', ymaxpct)
                .Set('min', yminpct)
                .Set('linewidth', 2)
                .Set('tickmarkslength', 5)
                .Set('title', '% pct')
                .Draw();

    };

    function drawTrend(therange,maxValue, minValue, chartID) {
       // dataTooltips = therange.map(item => Math.round(item * 1000) / 1000)
       // dataTooltips = dataTooltips.map(String)
       RGraph.reset(document.getElementById(chartID));
       line = new RGraph.Line({
       	id:chartID, data:therange,
       	options: {
       		title: chartID + ", "+theStartCode + " " + stkName,
    			titleColor: 'grey', 
    			titleSize: 10,
       		backgroundGrid: true, axisColor: '#864', textColor: '#ccc',
    		numxticks: 0, colors: chartColor, scaleDecimals: 2,

       		tickmarksDotLinewidth: 0,ticksize: 1, linewidth: 1, 
       		ymax: maxValue, ymin: minValue,
               tickmarks: 'plus',

       		spline: false, shadow: false,
              // tooltips: dataTooltips,
			backgroundGridVlines: true,
			backgroundGridDashed: true, 
       		backgroundGridColor: '#001000',
       		gutterLeft: 0, gutterRight: 50, gutterTop: 25, gutterBottom: 25
       	}
       }).trace();
    };
    
    function diff(arr) {
      return arr.slice(1).map(function(n, i) { return n - arr[i]; });
    }

function showActivity(thecode){
    markers = filterResult.filter(element => element.includes(thecode));
    // clean the h2 tags
    markers = markers.map(element => element.replace(/<\/h2>.*/gi, ""))
    markers = markers.map(element => element.replace(/<h2>/gi, ""))

    markers = markers.map(element => formatWeekDay(element))
    if (markers.length > 50) markers.splice(0, markers.length-80);

    $('#filterMarkers').append("<b class='red'>" + thecode + " æ—¥çº¿ç‰¹å¾:</b><br>")
    $('#filterMarkers').append(markers)
}

// format WeekDay
function formatWeekDay(element) {
    dayStr = element.replace(/<.*?>/gi, "") // clean span tags
    dayStr = dayStr.substr(0,6)
    dayStr = convertWeekday(dayStr)
    return(dayStr + " " + element + "<br>")
}

// convert date string to weekday
function parse(str) {
    str = "20" + str
    var y = str.substr(0,4), m = str.substr(4,2) - 1,
        d = str.substr(6,2);
    var D = new Date(y,m,d);
    return (D.getFullYear() == y && D.getMonth() == m && D.getDate() == d) ? D : 'invalid date';
}
function convertWeekday(str) {
    return ["SUN","MON","TUE","WED","THU","FRI","SAT"][parse(str).getDay()]
}
function fetchUsCode(str) {
    theCode = str; collectStkData(str); window.location = '#cvs';
    $('#usstock').toggle();
}

function handleRight( event ){
    codeListPtr = codeListPtr +1
    theCode = codeList[codeListPtr];
    collectStkData(theCode);
}

    codeList = codeList.split(' ')
    codeListPtr = 0

    $( "html" ).on( "swiperight", handleRight );
    $( "html" ).on( "swipeleft", askforCode );
    collectStkData(theCode);

function docLoaded() {
    let script1 = document.createElement('script');
    script1.src = 'https://williamkpchan.github.io/LibDocs/readbook.js';
    document.body.appendChild(script1);
    let script = document.createElement('script');
    script.src = 'C:/R programs/!!! STKMon !!!/headerApp.js';
    document.body.appendChild(script);
    window.scrollTo(0,(document.body.scrollHeight));
}
</script>
</body>
</html>
