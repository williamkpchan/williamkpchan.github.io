<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width"/>
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script>
$(document).ready(function(){
    $('h1, h2, h3, h4, h5, .goldword, strong,  div.title').click(function(){
    parent.history.back();
    return false;
    });
});
</script>
<style>
body{width:80%;margin-left: 10%; font-size:22px;}
strong, h1, h2 {color: gold;}
img {width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%;}
</style>
</head><body>
<center><h1>VBNotes</h1>
<div id="toc"></div></center>
<br>
<br>
<br>
<pre>
<h2>set delay in vbscript</h2>
<a href="https://stackoverflow.com/questions/1729075/how-to-set-delay-in-vbscript">set delay in vbscript</a>
<br>
WScript.Sleep 1000
MsgBox "TEST"

Note, the number is in Milliseconds, so 1000 is 1 second.


<h2>check battery</h2>
set oLocator = CreateObject("WbemScripting.SWbemLocator")
set oServices = oLocator.ConnectServer(".","root\wmi")
set oResults = oServices.ExecQuery("select * from batteryfullchargedcapacity")
for each oResult in oResults
   iFull = oResult.FullChargedCapacity
next

while (1)
  set oResults = oServices.ExecQuery("select * from batterystatus")
  for each oResult in oResults
    iRemaining = oResult.RemainingCapacity
    bCharging = oResult.Charging
  next
  iPercent = ((iRemaining / iFull) * 100) mod 100
  if bCharging and (iPercent > 94) Then msgbox "Battery is at " & iPercent & "%",vbInformation, "Battery monitor"
  if Not(bCharging) and (iPercent < 30) Then msgbox "Chr(7)Battery is at " & iPercent & "%",vbInformation, "Battery monitor"
  wscript.sleep 300000 ' 5 minutes
wend

<h2>bell character</h2>
Chr(7)


<h2>MsgBox function</h2>
<a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/msgbox-function">MsgBox function</a>
<br>
Dim Msg, Style, Title, Help, Ctxt, Response, MyString
Msg = "Do you want to continue ?"    ' Define message.
Style = vbYesNo + vbCritical + vbDefaultButton2    ' Define buttons.
Title = "MsgBox Demonstration"    ' Define title.
Help = "DEMO.HLP"    ' Define Help file.
Ctxt = 1000    ' Define topic context. 

' Display message.
Response = MsgBox(Msg, Style, Title, Help, Ctxt)
If Response = vbYes Then    ' User chose Yes.
    MyString = "Yes"    ' Perform some action.
Else    ' User chose No.
    MyString = "No"    ' Perform some action.
End If

<h2>Visual Basic Functions</h2>

<a href="https://docs.microsoft.com/en-us/office/vba/language/reference/functions-visual-basic-for-applications">VB Functions</a><br>

Conversion functions
Asc, Chr, CVErr, Format, Hex, Oct, Str, Val

Math functions
Abs, Atn, Cos, Derived math, Exp, Int, Fix, Log, Rnd, Sgn, Sin, Sqr, Tan

Other functions
Array, CallByName, Choose, Command, CreateObject, CurDir, Date, DateAdd, DateDiff, DatePart, DateSerial, DateValue, Day, DDB, Dir, DoEvents, Environ, EOF, Error, FileAttr, FileDateTime, FileLen, Filter, FormatCurrency, FormatDateTime, FormatNumber, FormatPercent, FreeFile, FV, GetAllSettings, GetAttr, GetObject, GetSetting, Hour, IIf, IMEStatus, Input, InputBox, InStr, InStrRev, IPmt, IRR, IsArray, IsDate, IsEmpty, IsError, IsMissing, IsNull, IsNumeric, IsObject, Join, LBound, LCase, Left, Len, Loc, LOF, LTrim, RTrim, and Trim, MacID, MacScript, Mid, Minute, MIRR, Month, MonthName, MsgBox, Now, NPer, NPV, Partition, Pmt, PPmt, PV, QBColor, Rate, Replace, RGB, Right, Round, Second, Seek, Shell, SLN, Space, Spc, Split, StrComp, StrConv, String, StrReverse, Switch, SYD, Tab, Time, Timer, TimeSerial, TimeValue, TypeName, UBound, UCase, VarType, Weekday, WeekdayName, Year

<br>
<br>
<br>
<br>

<script>
	var toc = $('#toc');
	$('h2').each(function(i) {
		var topic = $(this), topicNumber = i + 1;
		toc.append('<a href="#topic-'+topicNumber+'" target="_self">'+topic.text()+'</a><br>');
		topic.attr('id', 'topic-' + topicNumber);
	});
</script>
</body>
</html>
