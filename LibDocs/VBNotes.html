<base target="_blank"><html><head><title>Visual Basic Notes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script src="../lazyload.min.js"></script>
<script type='text/javascript' src='../mainscript.js'></script>
<script src="D:/Dropbox/Public/commonfunctions.js"></script>
<script>
  var showTopicNumber = true;
  var topicEnd = "<br>";
  var bookid = "Visual Basic Notes"
  var markerName = "h2"
</script>
<style>
body{width:80%;margin-left: 10%; font-size:22px;}
h1, h2 {color: gold;}
strong {color: orange;}
img {max-width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%; border-radius:3px;}
</style></head><body onkeypress="chkKey()"><center>
<h1>Visual Basic Notes</h1>
<a href="#mustWatch" class="red goldbs" target="_self">Must Watch!</a>
<br><br>
<div id="toc"></div></center>
<br><br>

<a href="VBScript.html" class="whitebut blue">VBScript Scripting Techniques</a>
<a href="https://admhelp.microfocus.com/uft/en/all/VBScript/Content/html/bbd53502-bcf9-4bcd-a8bc-ae723a46534d.htm" class="whitebut ">Creating Scripts that Can Be Used by WSH</a>
<a href="https://admhelp.microfocus.com/uft/en/all/VBScript/Content/html/0a8270d7-7d8f-4368-b2a7-065acb52fc54.htm" class="whitebut ">VBScript Reference</a>

<a href="https://www.equestionanswers.com/c/vb-access-c.php" class="whitebut ">access C function from Visual Basic</a>
<a href="https://learn.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/call-statement" class="whitebut ">Call Statement</a>
<a href="https://www.experts-exchange.com/questions/29115132/calling-JavaScript-function-with-parameters-from-VB-from-Web-Forms-page.html" class="whitebut ">calling JavaScript from VB from Web Forms page</a>
<a href="https://stackoverflow.com/questions/22961625/visual-basic-windows-form-running-python-script-w-button" class="whitebut ">VB Form Running Python script</a>
<a href="https://support.3dsystems.com/s/article/How-to-run-external-Python-script-from-Visual-Scripting-tool?language=en_US" class="whitebut ">call external Python script from Visual Scripting</a>

<a href="VBreference.html" class="whitebut ">VBreference</a>
<a href="ASPTutorial.html" class="whitebut ">ASPTutorial</a>

<a href="VBScriptSamples.html" class="whitebut ">VBScriptSamples</a>

<a href="VBScriptTutorial.html" class="goldbut red">VBScript Tutorial</a>
<a href="https://www.tek-tips.com/threadminder.cfm?pid=329&page=1" class="whitebut ">VBScript forum</a>

<a href="https://www.motobit.com/tips/" class="whitebut ">free vbs code</a>

<a href="http://vbsedit.com/" class="whitebut ">vbsedit</a>

<a href="https://en.wikibooks.org/wiki/Visual_Basic/Getting_Started">Visual Basic Getting Started</a>
. <a href="https://www.vbtutor.net/vbtutor.html">vbtutor</a>
. <a href="http://www.freevbcode.com/listcode.asp?Category=5">vbcode</a>

</div>
<pre>
<br>
<br>
<h2>VBScript is being deprecated</h2>
<a href="https://ss64.com/vb/" class="whitebut ">VBScript commands</a>
VBScript is being deprecated (Oct 2023).
In future releases of Windows client, VBScript will be available as a feature on demand before its eventual removal from the operating system. It has not yet been deprecated from Windows Server.

<a href="https://ss64.com/vb/syntax.html" class="whitebut ">VBScript How-to guides and examples</a>


<h2><pk>wscript</pk></h2>
<a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wscript" class="redbut gold">windows commands wscript</a>  <a href="https://ss64.com/vb/" class="whitebut ">A-Z Index of Windows VBScript commands</a> <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands" class="whitebut green">Windows Commands</a>

Syntax
wscript [&lt;scriptname>] [/b] [/d] [/e:&lt;engine>] [{/h:cscript|/h:wscript}] [/i] [/job:&lt;identifier>] [{/logo|/nologo}] [/s] [/t:&lt;number>] [/x] [/?] [&lt;ScriptArguments>]

PARAMETERS
Parameter	Description

scriptname	Specifies the path and file name of the script file.
/b	Specifies batch mode, which does not display alerts, scripting errors, or input prompts. 
This is the opposite of /i.

/d	Starts the debugger.
/e	Specifies the engine that is used to run the script. 
  This lets you run scripts that use a custom file name extension. 
  Without the /e parameter, you can only run scripts that use registered file name extensions. 

  For example, if you try to run this command:
  cscript test.admin

  You will receive this error message: Input Error: There is no script engine for file extension .admin.

  One advantage of using nonstandard file name extensions is that it guards against accidentally double-clicking a script and running something you really did not want to run.

  This does not create a permanent association between the .admin file name extension and VBScript. 
  Each time you run a script that uses a .admin file name extension, you will need to use the /e parameter.

/h:cscript	Registers cscript.exe as the default script host for running scripts.
/h:wscript	Registers wscript.exe as the default script host for running scripts. 
  This is the default when the /h option is omitted.

/i	Specifies interactive mode, which displays alerts, scripting errors, and input prompts.
  This is the default and the opposite of /b.

/job:&lt;identifier>	Runs the job identified by identifier in a .wsf script file.

/logo	Specifies that the Windows Script Host banner is displayed in the console before the script runs.
  This is the default and the opposite of /nologo.

/nologo	Specifies that the Windows Script Host banner is not displayed before the script runs. 
  This is the opposite of /logo.

/s	Saves the current command prompt options for the current user.
/t:&lt;number>	Specifies the maximum time the script can run (in seconds). 
  You can specify up to 32,767 seconds.
  The default is no time limit.

/x	Starts the script in the debugger.

ScriptArguments	Specifies the arguments passed to the script. 
Each script argument must be preceded by a slash (/).

/?	Displays Help at the command prompt.
Remarks
Performing this task does not require you to have administrative credentials. 

Therefore, as a security best practice, consider performing this task as a user without administrative credentials.

To open a command prompt, on the Start screen, type cmd, and then click command prompt.
Each parameter is optional; however, you cannot specify script arguments without specifying a script. 

If you do not specify a script or any script arguments, wscript.exe displays the Windows Script Host Settings dialog box, which you can use to set global scripting properties for all scripts that wscript.exe runs on the local computer.

The /t parameter prevents excessive running of scripts by setting a timer. 
When the time exceeds the specified value, wscript interrupts the script engine and ends the process.

Windows script files usually have one of the following file name extensions: .wsf, .vbs, .js.

If you double-click a script file with an extension that has no association, the Open With dialog box appears. 
Select wscript or cscript, and then select Always use this program to open this file type. 

This registers wscript.exe or cscript.exe as the default script host for files of this file type.
You can set properties for individual scripts. 

See Windows Script Host overview for more information.
Windows Script Host can use .wsf script files. 
Each .wsf file can use multiple scripting engines and perform multiple jobs.


<h2><pk>The Windows Scripting Host</pk></h2>
<div id="TheWSHtoc" class="toc"><a href="#TheWSHtopic-0" target="_self">What you need to get started</a><br><a href="#TheWSHtopic-1" target="_self">What is the Windows Scripting Host (WSH)?</a><br><a href="#TheWSHtopic-2" target="_self">Scripting Files</a><br><a href="#TheWSHtopic-3" target="_self">A quick word about debugging and handling errors</a><br><a href="#TheWSHtopic-4" target="_self">The scripting host objects</a><br><a href="#TheWSHtopic-5" target="_self">Wscript Methods</a><br><a href="#TheWSHtopic-6" target="_self">Shell Object Properties and Methods</a><br><a href="#TheWSHtopic-7" target="_self">Network Object Properties and Methods</a><br><a href="#TheWSHtopic-8" target="_self">EnumNetworkDrives</a><br><a href="#TheWSHtopic-9" target="_self">EnumPrinterConnections</a><br><a href="#TheWSHtopic-10" target="_self">Summary</a><br></div>
https://www.codemag.com/article/0001061/The-Windows-Scripting-Host
Remember batch files?  They were simple, easy to program, and very productive since many tasks could be automated.

Windows still allows batch files, but batch files don't allow any control over the Windows shell and Windows environment. 
By introducing the Windows Scripting Host, Microsoft has introduced a script and COM based engine that can access the Windows Shell, the computer's environment and network settings using simple VBScript or JScript code. 
In addition you can even access any COM component, including your own. 
This column will introduce you to the basics of how the scripting host works and how you can incorporate its features into your Visual FoxPro Applications.

<h3 id="TheWSHtopic-0">What you need to get started</h3>
The Windows Scripting Host ships with Windows 2000 and Windows 98, and is also available as part of the NT Option Pack when installed on Windows NT 4.0. 
Older Windows NT and 95 can download the Windows Scripting Host files from the Microsoft Website at: <a href="http://msdn.microsoft.com/scripting/">http://msdn.microsoft.com/scripting/</a>. 
In addition to the core scripting engine, a series of whitepapers, code samples, and technical articles can be downloaded as well.

<h3 id="TheWSHtopic-1">What is the Windows Scripting Host (WSH)?</h3>
The Windows Scripting Host is a language independent scripting engine. 
Scripting languages such as VBScript and JScript can be used to drive many processes. 
The same language that is used in client-side scripts in Internet Explorer (IE) or server-side scripts in Internet Information Server (IIS) can now be hosted by the Windows Operating System itself.

Prior to the release of the WSH, the only scripting language that existed for Windows was MS-DOS batch files. 
Although powerful, batch files lacked the control over the Windows Operating System that is truly required. 
The WSH provides this capability.

<h3 id="TheWSHtopic-2">Scripting Files</h3>
Unlike scripting in Active Server Pages, where the language can be specified with tags, the same is not true for script files used by the Windows Scripting Host. 
Instead, the WSH relies on the file extension to determine which language to use. 
If the script file ends in VBS, VBScript is used. 
If the script file ends in JS, JScript is used.

The following files are simple hello world examples the point out the differences between VBScript and JScript:

<code>VBSscript:
'hello world.vbs
Dim WSHShell
Set WSHShell = WScript.CreateObject("WScript.Shell")
WSHShell.Popup "Hello World"</code>

<code>JScript:
//  hello world.js
var WSHShell = WScript.CreateObject("WScript.Shell");
WSHShell.Popup("Hello World")</code>

The following is a more complex example that uses scripting to open and control Microsoft Excel:

<code>'This VBScript File opens Excel and creates a workbook
Dim objXL,oWorkbook
Set objXL = WScript.CreateObject("Excel.Application")
objXL.Visible = TRUE
Set oWorkbook = objXL.WorkBooks.Add
With objXL
    .Cells(1,1) = oWorkbook.Sheets.Count
End With</code>

Running these script files is a very simple task. 
In Explorer, you can click the right mouse key over the file, and select Open. 
Alternatively, you can double-click the item in Explorer as well. 
 Yet another alternative is to use the Run Method of the Windows Scripting Shell Object. 
This technique will be illustrated when the Shell Object is discussed in more detail. 
Furthermore, you can execute these script files directly from your applications using the <code>ShellExecute()</code> API simply by specifying the filename.

<h3 id="TheWSHtopic-3">A quick word about debugging and handling errors</h3>
No programming environment is complete with a full-featured debugging environment and the Windows Scripting Host is no exception. 
As far as error handling is concerned, VBScript does not have a global error handler. 
Instead, errors need to be handled on an in-line basis. 
The following code demonstrates how to deal with errors on an in-line basis:

<code>On Error Resume Next
dim objxl
Set objXL = WScript.CreateObject("Excel.Application")
objxl.foo ' reference a non-existent Excel Method
If Err.Number &gt; 0 Then
    Call ErrorProc
End If

Sub ErrorProc
    msgbox err.description
End Sub</code>

If no error trapping exists, you will be prompted with a dialog asking if you wish to debug the application. 
Figure 1 illustrates how the code will appear in the script debugger.

<img src="https://codemag.com/Article/Image/0001061/petersonfig1.JPG">
Figure 1 - The Microsoft Script Debugger uses the same IDE as Visual InterDev and Visual J++ 6.0

<h3 id="TheWSHtopic-4">The scripting host objects</h3>
There are two primary objects contained within the Windows Scripting Host. 
The following code illustrates how these objects can be created:

<code>WSHshell = CreateObject("Wscript.Shell")
WSHNetwork = CreateObject("Wscript.Network")</code>

Both the shell and network objects are hosted by the wshom.ocx ActiveX Control.

Complete documentation for the WSHShell and WSHNetwork Objects can be found by navigating to the following URLS:

For the WSHShell Object:

<a href="http://www.microsoft.com/iis/support/iishelp/iis/htm/asp/wsho7t84.htm">http://www.microsoft.com/iis/support/iishelp/iis/htm/asp/wsho7t84.htm</a>

For the WSHNetwork Object:

<a href="http://www.microsoft.com/iis/support/iishelp/iis/htm/asp/wsho20qc.htm">http://www.microsoft.com/iis/support/iishelp/iis/htm/asp/wsho20qc.htm</a>

<h3 id="TheWSHtopic-5">Wscript Methods</h3>
<code>CreateObject (strProgid [,strPrefix])</code>

This method creates an instance of an automation server. 
This article began with an example of using the Shell Object to create an instance of Microsoft Excel. 
The ability also exists to create instances of your own COM Components as well. 
The first parameter specifies the ProgID of the automation server instance you wish to create.

<code>oMyObject = Wscript.Createobject("MyObject.MyClass")</code>

The second parameter relates to instances where the new object supports <code>an</code> event model. 
For example, if the object you create has <code>an</code> event called MyEvent, you can write a handler for <code>the</code> event. 
The only requirement is that a procedure prefix must be specified:

<code>oMyObject = Wscript.Createobject("MyObject.MyClass","eventhandler_")

Sub eventhandler_myevent()
    'Your custom event code goes here...
End Sub

ConnectObject (strObjName,strPrefix)</code>

The <code>ConnectObject</code> method allows developers to hook into the event model for objects that have already been created. 
To illustrate, an object called oMyObject already exists. 
The <code>oMyObject</code> object has an event called myevent.

<code>oMyObject = Wscript.Createobject("MyObject.MyClass")
Wscript.ConnectObject oMyObject, "eventhandler_"

Sub eventhandler_myevent()
    'Your custom event code goes here...
End Sub</code>

<h4>DisconnectObject (ObjID)</h4>

The <code>DisconnectObject</code> method allows for the uncoupling of an object instance and an event handler. 
It is important to note that once the event handler is uncoupled, the object instance remains in tact.

<code>Wscript.DisconnectObject(oMyObject)
Echo(...argN)</code>

The Echo Method provides a host independent mechanism for dialoging the user. 
Within the Windows GUI, where <code>Wscript.EXE</code> is used, the Echo Method is manifested as a Messagebox:

<code>Wscript.Echo "Cool"</code>

script files can also be run from the command prompt. 
If the previous example was contained in a file called FOO.VBS, the following code would display the word Cool on the command line:

<code>C:\Temp&gt;cScript foo.vbs
Microsoft (R) Windows Script Host Version 5.1 for Windows
Copyright (C) Microsoft Corporation 1996-1999. 
All rights reserved.
Cool</code>

<h4>Sleep</h4>

The Sleep Method suspends program execution for a specified period of time. 
The following example suspends execution for 2 seconds before continuing:

<code>Wscript.Sleep 2000</code>

<h3 id="TheWSHtopic-6">Shell Object Properties and Methods</h3>
<strong>Environment:</strong> This property provides access to environment collection. 
Information such as number of processors, paths, OS, etc can be determined from this collection.

<code>oEnv = wshshell.environment
For Each x In oEnv
    ?oEnv
Next x</code>

The following is a partial listing of some typical environmental variables:

<code>NUMBER_OF_PROCESSORS</code>
<code>OS</code>
<code>PROCESSOR_ARCHITECTURE</code>
<code>PROCESSOR_IDENTIFIER</code>
<code>WINDIR</code>

So, to find out the number of processors:

<code>Numprocessors = oEnv.Item("NUMBER_OF_PROCESSORS")</code>

Like most collections, if you want to find out how many members are contained in the collection, you can refer to the Count Property:

<code>Numitems = oEnv.Count</code>

To be compliant with the Java Language, collections in the Windows Scripting Host also support the Length Property, which provides the same functionality as the Count Property:

<code>Numitems = oEnv.Length</code>

<strong>SpecialFolders:</strong> This property provides access to the collection of Windows Shell Folders. 
The following is a listing of folders:
AllUsersDesktop
AllUsersStartMenu
AllUsersPrograms
AllUsersStartup
Desktop
Favorites
Fonts
MyDocuments
NetHood
PrintHood
Programs
Recent
SendTo
StartMenu
Startup
Templates
AllUsersDesktop
AllUsersStartMenu
AllUsersPrograms
AllUsersStartup
Desktop
Favorites
Fonts
MyDocuments
NetHood
PrintHood
Programs
Recent
SendTo
StartMenu
Startup
Templates

To find the actual path of the desktop folder, issue this line of code:

<code>DesktopPath = WSHShell.SpecialFolders("Desktop")
CreateShortcut (strPathname)</code>

This method creates and returns a shortcut object. 
The following block of code illustrates how to create a desktop shortcut:

<code>*/ Read desktop path using WshSpecialFolders object
DesktopPath = WSHShell.SpecialFolders("Desktop")

*/ Create a shortcut object on the desktop
MyShortcut = ;
WSHShell.CreateShortcut(DesktopPath + "\Shortcut to MyFile.lnk")

*/ Set shortcut object properties and save it
FileName = GetFile()
If !Empty(FileName)
    FileDir = JustPath(FileName)
    With MyShortcut
        .TargetPath = Filename
        .WorkingDirectory = FileDir
        .Save
    EndWith
Endif</code>

The CreateShortcut Method returns a WSHShortcut Object. 
This object is only exposed through the CreateShortcut Method. 
The <code>WSHShortcut</code> object has the following properties:
Arguments - Parameters to a shortcut object.
Description - A description of a shortcut object.
Hotkey - The hot key of a shortcut object.
IconLocation - The icon location of a shortcut object.
TargetPath - The target path of a shortcut object.
WindowStyle - The window style of a shortcut object.
WorkingDirectory - The working directory of a shortcut object.

The <code>WSHShortcut</code> Object only has one method, <code>Save()</code>, which saves the shortcut object to the file system.

<code>ExpandEnvironmentSettings (*strString)*</code>

This method expands a process environment variable and returns the result. 
A typical environment variable is <code>WINDIR</code>. 
The following code illustrates how this method works:

<code>Fullpath = WSHShell.ExpandEnvironmentStrings("%windir%\notepad.exe, 0")
Popup (strText, [natSecondsToWait], [strTitle], [natType])</code>

This method displays the Window MessageBox. 
Unlike the existing MessageBox Function, the <code>Popup</code> method accepts an optional argument to clear the dialog after a specified amount of time. 
The following line of code illustrates how the <code>Popup</code> Method works:

<code>WSHShell.Popup("Message",1,"Title",64)
RegDelete(strName)
RegRead(strName)
RegWrite(strName, anyValue, [strType] )</code>

The Windows Scripting Host Shell Object provides three methods for working with the Windows Registry. 
With these methods, entries can be created, written, read, and deleted. 
If you attempt to write to a key that does not exist, the key will be created. 
The following code illustrates how these three methods work:

To create a new key:

<code>WSHshell.RegWrite("HKCU\Software\Microsoft\VisualFoxPro\6.0\Desktop\JVP",'Default Value')</code>

Then, to modify the value:

<code>WSHshell.RegWrite("HKCU\Software\Microsoft\VisualFoxPro\6.0\Desktop\JVP",'New Value')</code>

Next, to just read a value from a key:

<code>WSHshell.RegRead("HKCU\Software\Microsoft\VisualFoxPro\6.0\Desktop\JVP")</code>

Finally, to delete a key:

<code>WSHshell.RegDelete("HKCU\Software\Microsoft\VisualFoxPro\6.0\Desktop\JVP")
Run(strCommand, [intWindowStyle], [blnWaitOnReturn])</code>

The Run Method creates a new process that executes a specified command with a specified window style. 
In addition to being able to specify the command and the window style, a third parameter can be used to determine if script execution should pause until the new process has terminated.

Applications windows can be started in several states. 
The following outlines the various options available:
SW_HIDE = 0
SW_MINIMIZE = 6
SW_RESTORE = 9
SW_SHOW = 5
SW_SHOWMAXIMIZED = 3
SW_SHOWMINIMIZED = 2
SW_SHOWMINNOACTIVE = 7
SW_SHOWNA = 8
SW_SHOWNOACTIVATE = 4
SW_SHOWNORMAL = 1

The following code starts Notepad with a normal window:

<code>WSHshell.Run("notepad",1)</code>

This code starts Notepad with a maximized window. 
In addition, the user must close Notepad before control will return to Visual FoxPro:

<code>WSHshell.Run("notepad",3,.T.)</code>

Fully qualified paths can be used to denote a file to execute. 
The following code starts Visio:

<code>WSHshell.Run("D:\VISIO\VISIO32.EXE")</code>

Also, script files can be executed with the Run Method as well:

<code>WSHshell.Run("hello world.vbs")
WSHshell.Run("hello world.js")</code>

<h3 id="TheWSHtopic-7">Network Object Properties and Methods</h3>
<strong>ComputerName:</strong> This property denotes the name of the computer.

<code>ComputerName = WSHNetwork.ComputerName</code>

<strong>UserDomain:</strong> This property denotes the domain to which the user belongs.

<code>DomainName = WSHNetwork.UserDomain</code>

<strong>UserName:</strong> This property denotes the ID of the currently logged-in user.

<code>UserName = WSHNetwork.UserName
AddPrinterConnection(strLocalName, strRemoteName, [bUpdateProfile], [strUser], [strPassword] )</code>

This method maps a network printer to a local resource.

<code>WSHNetwork.AddPrinterConnection("LPT1","\\server\printer_share",.T.,"UserID","Password")</code>

Of special interest here is the third parameter, bUpdateProfile. 
If this parameter is set to .T., the user profile for the local machine is updated to restore the printer mapping the next time the user logs onto the machine and network.

<h3 id="TheWSHtopic-8">EnumNetworkDrives</h3>
This method returns a collection of drive mappings. 
The following code loops through the collection of network drive mappings:

<code>oDrives = WSHNetwork.EnumDriveMappings
item = -1
For Each x In oDrives
    item = item + 1
    If Mod(item,2) = 0
        ?"Drive Letter:  ",x
    Else
        ?"Network Resource: ",x
    Endif
Next x</code>

Like other collections, the drive mapping collection supports both the Count and Length Properties, as well as the <code>Item()</code> Method.

<h3 id="TheWSHtopic-9">EnumPrinterConnections</h3>
This method works just like the EnumNetworkDrives, with the exception that the collection returned represents printers, not drive mappings:

<code>item = -1
For Each x In oPrinters
    item = item + 1
    If Mod(item,2) = 0
        ?"Printer Name:  ",x
    Else
        ?"Network Resource: ",x
    Endif
Next x

MapNetworkDrive( strLocalName, strRemoteName, [bUpdateProfile], [strUser], [strPassword] )</code>

This method works just like the <code>AddPrinterConnection</code> Method, with the exception that a local drive to a network resource is created:

<code>WSHNetwork.MapNetworkDrive("z:","\\server\server_share",.T.,"User","Password")
RemoveNetworkDrive(strName, [bForce], [bUpdateProfile] )</code>

This method removes a specified network drive mapping. 
Optionally, you can force the removal even if the resource is being used. 
An optional third parameter specifies if the user profile should be updated:

<code>WSHNetwork.RemoveNetworkDrive("z:",.T.,.T.)</code>

Or

<code>WSHNetwork.RemoveNetworkDrive("\\server\server_share",.T.,.T.)
RemovePrinterConnection( strName, [bForce], [bUpdateProfile] )</code>

This method works just like the <code>RemoveNetworkDrive</code> method, with the exception that a printer resource is being removed:

<code>WSHNetwork.RemovePrinerConnection("LPT1",.T.,.T.)</code>

Or

<code>WSHNetwork.RemovePrinterConnection("\\server\printer_share",.T.,.T.)
SetDefaultPrinter(strName)</code>

This method sets the default printer:

<code>WSHNetwork.SetDefaultPrinter("\\server\printer_share")</code>

<h3 id="TheWSHtopic-10">Summary</h3>
The ability to work with the Windows Registry, create desktop shortcuts, map and view network resources, all required you to know how to use extensive Windows API Functions, or a 3rd party DLL. 
The Windows Scripting Host provides a simple and elegant set of objects with simple interfaces that allow you to accomplish many of these tasks. 
Perhaps your application requires special Registry Entries. 
Perhaps you have been tasked with developing a utility that modifies the default printer or dynamically maps network resources. 
All of these tasks can easily be accomplished with the Windows Scripting Host.

The good news is that the Windows Scripting Host is part of the Operating System beginning with Windows 98 and Windows 2000. 
For older systems you need to make sure WSH is installed on any client workstation that uses your application. 
One approach to this problem is to add a method to your application class that tests to see if the Windows Scripting Host is installed. 
If it is not, prompt the user through the process of both downloading and installing WSH.

The Windows Scripting Host is yet another valuable tool to add to your toolbox!


<h2>Programming the Windows Script Host</h2>
<a href="https://www.informit.com/articles/article.aspx?p=1170490&seqNum=7">Programming the Windows Script Host</a>
<h3> Example: Scripting Internet Explorer</h3>
To give you a taste of the power and flexibility of scripting&#8212;particularly Automation programming&#8212;I'll close this chapter by showing you how to program a specific Automation server: Internet Explorer. You'll see that your scripts can control just about everything associated with Internet Explorer:
<li>The position and dimensions of the window</li>
<li>Whether the menu bar, toolbar, and status bar are displayed</li>
<li>The current URL</li>
<li>Sending the browser backward and forward between navigated URLs</li>
<h4> Displaying a Web Page</h4>
To get started, I'll show you how to use the <tt>InternetExplorer</tt> object to display a specified URL. You use the <tt>Navigate</tt> method to do this, and this method uses the following syntax:<em>InternetExplorer</em>.Navigate <em>URL</em> [, <em>Flags</em>,] [ <em>TargetFramename</em>] [, <em>PostData</em>]
[ ,<em>Headers</em>]
<table>
<thead/>
<tbody>
<tr><td><em><tt>InternetExplorer</tt></em></td>
<td colspan="2">A reference to the <tt>InternetExplorer</tt> object with which you're working.</td></tr>
<tr><td><em><tt>URL</tt></em></td>
<td colspan="2">The address of the web page you want to display.</td></tr>
<tr><td rowspan="5"><em><tt>Flags</tt></em></td>
<td colspan="2">One of (or the sum of two or more of) the following integers that control various aspects of the navigation:</td></tr>
<tr><td><tt>1</tt></td><td>Opens the <em><tt>URL</tt></em> in a new window</td></tr>
<tr><td><tt>2</tt></td><td>Prevents the <em><tt>URL</tt></em> from being added to the history list</td></tr>
<tr><td><tt>4</tt></td><td>Prevents the browser from reading the page from the disk cache</td></tr>
<tr><td><tt>8</tt></td><td>Prevents the <em><tt>URL</tt></em> from being added to the disk cache</td></tr>
<tr><td><em><tt>TargetFrameName</tt></em></td>
<td colspan="2">The name of the frame in which to display the <em><tt>URL</tt></em>.</td></tr>
<tr><td><em><tt>PostData</tt></em></td>
<td colspan="2">Specifies additional <tt>POST</tt> information that HTTP requires to resolve the hyperlink. The most common uses for this argument are to send a web server the contents of a form, the coordinates of an imagemap, or a search parameter for an ASP file. If you leave this argument blank, this method issues a <tt>GET</tt> call.</td></tr>
<tr><td><em><tt>Headers</tt></em></td>
<td colspan="2">Specifies header data for the HTTP header.</td></tr>
</tbody>
</table>
Here's an example:
Set objIE = CreateObject("InternetExplorer.Application")
objIE.Navigate "http://www.microsoft.com/"
<h4> Navigating Pages</h4>
Displaying a specified web page isn't the only thing the <tt>InternetExplorer</tt> object can do. It also has quite a few methods that give you the ability to navigate backward and forward through visited web pages, refresh the current page, stop the current download, and more. Here's a summary of these methods:
<table><thead/><tbody>
<tr><td><tt>GoBack</tt></td>
<td colspan="2">Navigates backward to a previously visited page</td></tr>
<tr><td><tt>GoForward</tt></td>
<td colspan="2">Navigates forward to a previously visited page</td></tr>
<tr><td><tt>GoHome</tt></td>
<td colspan="2">Navigates to Internet Explorer's default Home page</td></tr>
<tr><td><tt>GoSearch</tt></td>
<td colspan="2">Navigates to Internet Explorer's default Search page</td></tr>
<tr><td><tt>Refresh</tt></td>
<td colspan="2">Refreshes the current page</td></tr>
<tr><td rowspan="6">
<tt>Refresh2</tt></td>
<td colspan="2">Refreshes the current page using the following syntax:</td></tr>
<tr><td colspan="2"><tt>Refresh2</tt> (<em><tt>Level</tt></em>)</td></tr>
<tr><td><em><tt>Level</tt></em></td><td>A constant that determines how the page is refreshed:</td></tr>
<tr><td><tt>0</tt></td><td>Refreshes the page with a cached copy</td></tr>
<tr><td><tt>1</tt></td><td>Refreshes the page with a cached copy only if the page has expired</td></tr>
<tr><td><tt>3</tt></td><td>Performs a full refresh (doesn't use a cached copy)</td></tr>
<tr><td><tt>Stop</tt></td>
<td colspan="2">Cancels the current download or shuts down dynamic page objects, such as background sounds and animations.</td></tr>
</tbody></table>
<h4> Using the <tt>InternetExplorer</tt> Object's Properties</h4>
Here's a summary of many of the properties associated with the <tt>InternetExplorer</tt> object:
<table><thead/><tbody>
<tr><td><tt>Busy</tt></td><td>Returns <tt>True</tt> if the <tt>InternetExplorer</tt> object is in the process of downloading text or graphics. This property returns <tt>False</tt> when a download of the complete document has finished.</td></tr>
<tr><td><tt>FullScreen</tt></td><td>A Boolean value that toggles Internet Explorer between the normal window and a full-screen window in which the title bar, menu bar, toolbar, and status bar are hidden.</td></tr>
<tr><td><tt>Height</tt></td><td>Returns or sets the window height.</td></tr>
<tr><td><tt>Left</tt></td><td>Returns or sets the position of the left edge of the window.</td></tr>
<tr><td><tt>LocationName</tt></td><td>Returns the title of the current document.</td></tr>
<tr><td><tt>LocationURL</tt></td><td>Returns the URL of the current document.</td></tr>
<tr><td><tt>MenuBar</tt></td><td>A Boolean value that toggles the menu bar on and off.</td></tr>
<tr><td><tt>StatusBar</tt></td><td>A Boolean value that toggles the status bar on and off.</td></tr>
<tr><td><tt>StatusText</tt></td><td>Returns or sets the status bar text.</td></tr>
<tr><td><tt>ToolBar</tt></td><td>A Boolean value that toggles the toolbar on and off.</td></tr>
<tr><td><tt>Top</tt></td><td>Returns or sets the position of the top edge of the window.</td></tr>
<tr><td><tt>Type</tt></td><td>Returns the type of document currently loaded in the browser.</td></tr>
<tr><td><tt>Visible</tt></td><td>A Boolean value that toggles the object between hidden and visible.</td></tr>
<tr><td><tt>Width</tt></td><td>Returns or sets the window width.</td></tr>
</tbody></table>

<h4> Running Through a Sample Script</h4>
To put some of the properties and methods into practice, Listing 12.10 shows a sample script.

<h4>Example 12.10. A Script That Puts the <tt>InternetExplorer</tt> Object Through Its Paces</h4>
Option Explicit
Dim objIE, objWshShell, strMessage, intResult
' Set up the Automation objects
Set objIE = WScript.CreateObject("InternetExplorer.Application")
Set objWshShell = WScript.CreateObject("WScript.Shell")
' Navigate to a page and customize the browser window
objIE.Navigate "http://www.wordspy.com/"
objIE.Toolbar = False
objIE.StatusBar = False
objIE.MenuBar = False
' Twiddle thumbs while the page loads
Do While objIE.Busy
Loop
' Get the page info
strMessage = "Current URL:  " &amp; objIE.LocationURL &amp; vbCrLf &amp; _
"Current Title: " &amp; objIE.LocationName &amp; vbCrLf &amp; _
"Document Type: " &amp; objIE.Type &amp; vbCrLf &amp; vbCrLf &amp; _
"Would you like to view this document?"
' Display the info
intResult = objWshShell.Popup(strMessage, , "Scripting IE", vbYesNo + vbQuestion)
' Check the result
If intResult = vbYes Then
' If Yes, make browser visible
objIE.Visible = True
Else
' If no, bail out
objIE.Quit
End If
Set objIE = Nothing
Set objWshShell = Nothing

The script begins by creating instances of the <tt>InternetExplorer</tt> and WScript <tt>Shell</tt> objects. The <tt>Navigate</tt> method displays a page, and then turns off the toolbar, status bar, and menu bar. A <tt>Do...Loop</tt> checks the <tt>Busy</tt> property and loops while it's <tt>True</tt>. In other words, this loop won't exit until the page is fully loaded. A string variable is used to store the URL, the title, and type of the page, and this string is then displayed in a <tt>Popup</tt> box, which also asks whether the user wants to see the page. If the user clicks the Yes button, the browser is made visible; if the user clicks the No button, the <tt>Quit</tt> method shuts down the browser.

<h2>Difference between cscript and wscript</h2>
<b>Windows Script Host (WSH)</b> has been part of Windows since Windows NT4. 
Windows Script Host provides architecture for building dynamic scripts that consist of a core object model, scripting hosts, and scripting engines.

The key components of Windows Script Host are CSCript, WScript, WSH ActiveX Control and Scripting engines.

<b>WSH ActiveX Control:</b>
An <a href="http://www.microsoft.com/security/resources/activex-whatis.aspx" rel="ugc">ActiveX control</a> that provides the core object model for the scripting host. 

<b>Scripting engines</b>
Scripting engines provide the core functions, objects, and methods for a particular scripting language. 
VBScript and JScript scripting  engines are installed by default on Windows.

CSCript and WScript are executables for the scripting host that are used to run the scripts. 
CSCript and WScript are both interpreters to run VBScript (and other scripting languages like JScript) on the Windows platform.

CSScript is for <b>console</b> applications and WScript is for <b>Windows</b> applications. 
The <a href="http://en.wikipedia.org/wiki/Kernel_(operating_system)" rel="ugc">Kernel</a> checks a flag in the executable to determine which 

When starting using CreateProcess, if it is a console application, the kernel will create a console window for it if the parent process doesn't have one, and attach the STDIN and STDOUT and STDERR to the console. 
If it is a Windows application, no console will be created and STDIN, STDOUT and STDERR will be closed by default.

If you want your script to have a console window, use CSCRIPT.EXE. 
If you want it to NOT have a console window, use WSCRIPT.EXE.

This also affects some behaviors, such as the WScript.Echo command. 
In a CSCRIPT.EXE this writes a line to the console window. 
In WSCRIPT.EXE it shows a messagebox.

<b>When using CScript.exe:</b>
<img class="lasy" data-src="https://filedb.experts-exchange.com/incoming/2014/11_w45/881510/1.jpg" />
When we execute the above VBScript with CScript.exe, it displays <i>hi</i> (called through WScript.echo) in command prompt.

<b>When using WScript.exe:</b>
<img class="lasy" data-src="https://filedb.experts-exchange.com/incoming/2014/11_w45/881516/2.jpg" />

When we execute the above VBScript with WScript.exe, it displays <i>hi</i> (called through WScript.echo) in MessageBox. 
MsgBox will display a message box in both cases.

The WScript word in WScript.echo is not related to WScript.exe.

  WScript.exe -&gt; a command line executable for WSH.
  WSCript        -&gt; an object in Core Object Model provided in WSH.

<b>Usage of CSCript.exe:</b>
The command line options for CSCript.exe are in this screenshot.
<img class="lasy" data-src="https://filedb.experts-exchange.com/incoming/2014/11_w45/881517/3.jpg" />
[ ] refers to optional data, i.e., not mandatory. 


<b>Usage of WSCript.exe:</b>
The command line options for WSCript.exe in this screenshot.
<img class="lasy" data-src="https://filedb.experts-exchange.com/incoming/2014/11_w45/881520/41.jpg" />

Again, [ ] refers to optional data, i.e., not mandatory. 

In Windows, an executable is either a console application or a Windows application (or a SFU or Native application, but that doesn't matter here).

The kernel checks a flag in the executable to determine which.

When starting using CreateProcess WinAPI function, if it is a console application, the kernel will create a console window for it if the parent process doesn't have one, and attach the STDIN, STDOUT and STDERR streams to the console.

If it is a Windows application, no console will be created and STDIN, STDOUT and STDERR will be closed by default.

WSCRIPT.EXE and CSCRIPT.EXE are almost exactly identical, except that one is flagged as a windows application and the other is flagged as a console application (Guess which way around!).

So the answer is: If you want your script to have a console window, use CSCRIPT.EXE. If you want it to NOT have a console window, use WSCRIPT.EXE.

This also affects some behaviors, such as the WScript.Echo command. In a CSCRIPT.EXE this writes a line to the console window. In WSCRIPT.EXE it shows a messagebox.

For your application I suggest CSCRIPT.EXE. I think you should also look at PuTTY and PLink, and you should also see this here:

vbscript output to console

Wscript.Echo "Like this?"

If you run that under wscript.exe (the default handler for the .vbs extension, so what you'll get if you double-click the script) you'll get a "MessageBox" dialog with your text in it.
If you run that under cscript.exe you'll get output in your console window.

You can directly use on the wscript.exe the function MsgBox("text") or MsgBox(object.property) but Wscript.Echo is easier to write.

There are five ways to output text to the console:

Dim StdOut : Set StdOut = CreateObject("Scripting.FileSystemObject").GetStandardStream(1)

WScript.Echo "Hello"
WScript.StdOut.Write "Hello"
WScript.StdOut.WriteLine "Hello"
Stdout.WriteLine "Hello"
Stdout.Write "Hello"

WScript.Echo will output to console but only if the script is started using cscript.exe. It will output to message boxes if started using wscript.exe.

WScript.StdOut.Write and WScript.StdOut.WriteLine will always output to console.

StdOut.Write and StdOut.WriteLine will also always output to console. It requires extra object creation but it is about 10% faster than WScript.Echo.

<h2>WScript.GetObject</h2>
Retrieve an Automation object
Syntax 
      Set objObject = Wscript.GetObject(strPathname [,strProgID] ], [strPrefix])

Arguments:

   strPathname : The pathname of the file containing the object to retrieve. (required)
   strProgID   : The program identifier (ProgID) of the object. 
   strPrefix   : A prefix for subroutine names (optional) e.g. if strPrefix is "MYOBJ_" and the object fires an event named "OnBegin," WSH calls the subroutine "MYOBJ_OnBegin" 
   objObject is an Automation object. 

GetObject is a wscript method.

Example

Open a copy of the Excel application:

Set objExcel = CreateObject("Excel.Application")
objExcel.Visible = True
objExcel.Workbooks.Add
objExcel.Cells(1, 1).Value = "Some demonstration text"

Open an Excel file:

Set objExcelFile = GetObject("C:\demo\example.xlsx")
WScript.Echo objExcelFile.Name
objExcelFile.Close
“When I take action I'm not going to fire a $2 million missile at a $10 empty tent and hit a camel in the butt. It's going to be decisive” ~ George W Bush, 2001

<h2>wscript.echo embed a new line / "CR" in a text string</h2>
LF = chr(10)
wscript.echo "Hello world", LF

<h2>WScript.echo without a Carriage Return</h2>
Wscript.Echo always includes a carriage return.
If you want to write several outputs on the same line, you have to use the "StdOut" property of the scrtipt host

Here's a small example on how to use "StdOut" and "StdIn"
Wscript.Stdout.Write ("Please enter your name: "
Wscript.StdOut.Write "Your name is: " & Wscript.StdIn.ReadLin

Please notice that "StdOut" also has a "WriteLine" method that also sends a carriage return like "Wscript.Echo".
If you want to have a carriage return when using "StdOut.Write", you have to write a "vbCrLf" at the end, too

<h2>activeX component can't create object 'Wscript.Timer'</h2>
The error message "ActiveX component can't create object 'WScript.Timer'" typically occurs when the WScript.Timer object is not available or registered on the system.
This object is not natively available in VBScript.

If you encounter this error, you can use an alternative approach to implement a timer in VBScript.
One way to achieve this is by using the WScript.Sleep method in a loop to create a timer-like behavior.
Here's an example:

Set objShell = CreateObject("WScript.Shell")

' Define timer duration in milliseconds
Dim timerDuration
timerDuration = 5000 ' 5 seconds

' Define repeat count
Dim repeatCount
repeatCount = 3 ' Repeat 3 times

' Loop for the desired number of repetitions
For i = 1 To repeatCount
    ' Display a message
    objShell.Popup "Timer expired!", , "Timer"

    ' Wait for the specified duration
    WScript.Sleep timerDuration
Next

In this example, the WScript.Sleep method is used to pause the script execution for the specified duration.
After the sleep period, a message box is displayed.
The loop allows you to repeat the timer functionality as many times as needed.

Save the script with a .vbs extension and run it.
It will display the message box after the specified duration and repeat it for the desired number of times.

Please note that the WScript.Sleep method suspends the entire script execution, so it may not be suitable for scenarios where you need to perform other tasks concurrently.

<h2>WScript.ScriptName</h2>
The ScriptName property is read only and returns the filename of the script currently being executed.

Examples
Code:
WScript.Echo "Name of current script =", WScript.ScriptName

Output:
Name of current script = test.vbs


<h2>WScript.Arguments</h2>
Return command-line parameters.
Syntax 
       WScript.Arguments
       WScript.Arguments(n)
       WScript.Arguments.item(n)
   n  = Return the single argument n
        counting from 0
To pass named arguments use:
       WScript.Arguments.named
In addition to the argument itself : MyObject.item(I)you can also retrieve a count or length:
MyObject.Count
MyObject.Length
The default property is .item

Examples
C:> cscript demo.vbs arg1 value2 33 456 "Last Arg"
[demo.vbs]
' Store the arguments in a variable:
Set objArgs = Wscript.Arguments

'Count the arguments
WScript.Echo objArgs.Count

' Display all command-line arguments
For Each strArg in objArgs
  WScript.Echo strArg
Next
' Display the first 3 command-line arguments
For I = 0 to 2
  Wscript.Echo objArgs(I)
Next

'Display just the third argument
Wscript.Echo objArgs(2)

'Or without the reference
WScript.Echo "The third argument is", WScript.Arguments(2)


<h2>VBScript Tutorials</h2>
<a href="https://www.tutorialspoint.com/vbscript/">VBScript Tutorial</a>
<a href="http://www.runoob.com/try/try.php?filename=vbdemo_foreach">VBScript For Each</a>
<a href="http://www.runoob.com/vbscript/vbscript-examples.html">VBScript 实例</a>
<a href="#tutorial1" target="_self">Introduction / What is it? VBScript Tutorials</a>
<a href="#tutorial2" target="_self">Notepad++, Launch with Default Program VBScript Tutorials</a>
<a href="#tutorial3" target="_self">Variables VBScript Tutorials</a>
<a href="#tutorial4" target="_self">Option Explicit / Dim / Comments VBScript Tutorials</a>
<a href="#tutorial5" target="_self">Arithmetic Operators VBScript Tutorials</a>
<a href="#tutorial6" target="_self">Concatenation VBScript Tutorials</a>
<a href="#tutorial7" target="_self">Relational Operators VBScript Tutorials</a>
<a href="#tutorial8" target="_self">ArrayList ( methods &amp; properties ) VBScript Examples</a>
<a href="#tutorial9" target="_self">Environment Variables ( add; change; remove ) VBScript Examples</a>
<a href="#tutorial10" target="_self">FormatString Class VBScript Tutorials</a>
<a href="#tutorial11" target="_self">Message Box - Numbers (MsgBox)</a>
<a href="#tutorial12" target="_self">Message Box - Constants (MsgBox)</a>
<a href="#tutorial13" target="_self">If - ElseIf - Else - Then Statements</a>
<a href="#tutorial14" target="_self">Vertical &amp; Horizontal Spacing</a>
<a href="#tutorial15" target="_self">Run Command</a>
<a href="#tutorial16" target="_self">Input Box (InputBox)</a>
<a href="#tutorial17" target="_self">Do Loops</a>
<a href="#tutorial18" target="_self">SendKeys</a>
<a href="#tutorial19" target="_self">Len - Left - Right</a>
<a href="#tutorial20" target="_self">Script Directory</a>
<a href="#tutorial21" target="_self">Subroutines</a>
<a href="#tutorial22" target="_self">Internet Explorer - SendKeys (Automation)</a>
<a href="#tutorial23" target="_self">Internet Explorer - HTML (Automation)</a>
<a href="#tutorial24" target="_self">File - Folder - Exists</a>
<a href="#tutorial25" target="_self">Copy - Move - Rename - Files &amp; Folders</a>
<a href="#tutorial26" target="_self">Create Shortcuts</a>
<a href="#tutorial27" target="_self">Special Folders</a>
<a href="#tutorial28" target="_self">Create - Delete - Files &amp; Folders</a>
<a href="#tutorial29" target="_self">Open Files (OpenTextFile)</a>
<a href="#tutorial30" target="_self">Read Files (OpenTextFile)</a>
<a href="#tutorial31" target="_self">Write Files (OpenTextFile)</a>
<a href="#tutorial32" target="_self">Append Files (OpenTextFile)</a>
<a href="#tutorial33" target="_self">Replace Words (Replace Command)</a>
<a href="#tutorial34" target="_self">Replace Lines (Replace Command)</a>
<a href="#tutorial35" target="_self">Replace using InputBox (Replace Command)</a>
<a href="#tutorial36" target="_self">With Command</a>
<a href="#tutorial37" target="_self">Get File - Folder (Properties)</a>
<a href="#tutorial38" target="_self">Get File - Folder (Attributes)</a>
<a href="#tutorial39" target="_self">Get File - Folder (Methods)</a>
<a href="#tutorial40" target="_self">For - Each - Next - Loops</a>
<a href="#tutorial41" target="_self">Internet Explorer - Existing Window (Automation)</a>
<a href="#tutorial42" target="_self">Select Case</a>
<a href="#tutorial43" target="_self">Functions</a>
<a href="#tutorial44" target="_self">AppActivate - Maximize - Minimize - Restore - Close - Windows</a>
<a href="#tutorial45" target="_self">Kill - Create - Process</a>
<a href="#tutorial46" target="_self">Cancel Input Box (InputBox)</a>
<a href="#tutorial47" target="_self">BrowseForFolder</a>
<a href="#tutorial48" target="_self">BrowseForFile</a>
<a href="#tutorial49" target="_self">Command Prompt (Arguments)</a>
<a href="#tutorial50" target="_self">Date Functions</a>
<a href="#tutorial51" target="_self">Copy All Files In Subfolders</a>
<a href="#tutorial52" target="_self">Mid - Split - InStr</a>
<a href="#tutorial53" target="_self">LCase - UCase - Trim</a>
<a href="#tutorial54" target="_self">Creating Arrays (Arrays)</a>
<a href="#tutorial55" target="_self">Adding to an Array (Arrays)</a>
<a href="#tutorial56" target="_self">Math Functions</a>
<a href="#tutorial57" target="_self">Formatting Numbers &amp; Dates</a>
<a href="#tutorial58" target="_self">Repeating Characters - String() - Space()</a>
<a href="#tutorial59" target="_self">TypeName - VarType - IsTests</a>
<a href="#tutorial60" target="_self">Dropped Files - Folders (Arguments)</a>
<a href="#tutorial61" target="_self">Execute - Read from another vbscript file.</a>
<a href="#tutorial62" target="_self">Run As Administrator</a>
<a href="#tutorial63" target="_self">Classes</a>
<a href="#tutorial64" target="_self">Unzip - Extract Compressed Files</a>
<a href="#tutorial65" target="_self">Make your computer talk/speak (SAPI)</a>
<a href="#tutorial66" target="_self">Change the voice/gender (SAPI)</a>
<a href="#tutorial67" target="_self">Read the registry (Regedit)</a>
<a href="#tutorial68" target="_self">Write to the registry (Regedit)</a>
<a href="#tutorial69" target="_self">Delete items in the registry (Regedit)</a>
<a href="#tutorial70" target="_self">Multidimensional Arrays (Arrays)</a>
<a href="#tutorial71" target="_self">Join Multidimensional Array (Arrays)</a>
<a href="#tutorial72" target="_self">Adding and Viewing (Dictionary)</a>
<a href="#tutorial73" target="_self">Change and Remove (Dictionary)</a>
<a href="#tutorial74" target="_self">Multidimensional (Dictionary)</a>
<a href="#tutorial75" target="_self">Manipulating Clipboard Text</a>
<a href="#tutorial76" target="_self">Multiline String Formatter (create code with code)</a>
<a href="#tutorial77" target="_self">RegExp (Test &amp; Replace)</a>
<a href="#tutorial78" target="_self">RegExp (Execute)</a>
<a href="#tutorial79" target="_self">RegExp ( Submatches )</a>
<a href="#tutorial80" target="_self">Regular Expressions ( [] {} () ? )</a>
<a href="#tutorial81" target="_self">Regular Expressions ( [^] + * \w \d \s \b )</a>
<a href="#tutorial82" target="_self">Regular Expressions ( ^ $ \escape )</a>
<a href="#tutorial8" target="_self">Run as Admin ( without UAC prompt ) VBScript Tutorials</a>


<h3 id="tutorial1">01 - Introduction / What is it? VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=Kmzrf057_bA"><img class="lazy" data-src="https://i.ytimg.com/vi/Kmzrf057_bA/hqdefault.jpg"></a>
<h3 id="tutorial2">02 - Notepad++, Launch with Default Program VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=TxnLG07Bp08"><img class="lazy" data-src="https://i.ytimg.com/vi/TxnLG07Bp08/hqdefault.jpg"></a>
<h3 id="tutorial3">03 - Variables VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=gPYjF660DxE"><img class="lazy" data-src="https://i.ytimg.com/vi/gPYjF660DxE/hqdefault.jpg"></a>
<h3 id="tutorial4">04 - Option Explicit / Dim / Comments VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=pJSxGffViD8"><img class="lazy" data-src="https://i.ytimg.com/vi/pJSxGffViD8/hqdefault.jpg"></a>
<h3 id="tutorial5">05 - Arithmetic Operators VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=crYZCodbfnM"><img class="lazy" data-src="https://i.ytimg.com/vi/crYZCodbfnM/hqdefault.jpg"></a>
<h3 id="tutorial6">06 - Concatenation VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=_qUFkqohGyM"><img class="lazy" data-src="https://i.ytimg.com/vi/_qUFkqohGyM/hqdefault.jpg"></a>
<h3 id="tutorial7">07 - Relational Operators VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=43Wo6Li34BQ"><img class="lazy" data-src="https://i.ytimg.com/vi/43Wo6Li34BQ/hqdefault.jpg"></a>
<h3 id="tutorial8">ArrayList ( methods &amp; properties ) VBScript Examples</h3><a href="https://www.youtube.com/watch?v=fKmQAVXP_Nw"><img class="lazy" data-src="https://i.ytimg.com/vi/fKmQAVXP_Nw/hqdefault.jpg"></a>
<h3 id="tutorial9">Environment Variables ( add; change; remove ) VBScript Examples</h3><a href="https://www.youtube.com/watch?v=Tkr3812_es0"><img class="lazy" data-src="https://i.ytimg.com/vi/Tkr3812_es0/hqdefault.jpg"></a>
<h3 id="tutorial10">FormatString Class VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=rJb3S327hO0"><img class="lazy" data-src="https://i.ytimg.com/vi/rJb3S327hO0/hqdefault.jpg"></a>
<h3 id="tutorial11">Part 1 Message Box - Numbers (MsgBox)</h3><a href="https://www.youtube.com/watch?v=NwIOuZZqolE"><img class="lazy" data-src="https://i.ytimg.com/vi/NwIOuZZqolE/hqdefault.jpg"></a>
<h3 id="tutorial12">Part 2 Message Box - Constants (MsgBox)</h3><a href="https://www.youtube.com/watch?v=Ml99eRt9jSs"><img class="lazy" data-src="https://i.ytimg.com/vi/Ml99eRt9jSs/hqdefault.jpg"></a>
<h3 id="tutorial13">Part 3 If - ElseIf - Else - Then Statements</h3><a href="https://www.youtube.com/watch?v=zV_tvU1ye4s"><img class="lazy" data-src="https://i.ytimg.com/vi/zV_tvU1ye4s/hqdefault.jpg"></a>
<h3 id="tutorial14">Part 4 Vertical &amp; Horizontal Spacing</h3><a href="https://www.youtube.com/watch?v=3VyGgd6oRho"><img class="lazy" data-src="https://i.ytimg.com/vi/3VyGgd6oRho/hqdefault.jpg"></a>
<h3 id="tutorial15">Part 5 Run Command</h3><a href="https://www.youtube.com/watch?v=2AxiGI5KD4k"><img class="lazy" data-src="https://i.ytimg.com/vi/2AxiGI5KD4k/hqdefault.jpg"></a>
<h3 id="tutorial16">Part 6 Input Box (InputBox)</h3><a href="https://www.youtube.com/watch?v=JcPXsSy-5x8"><img class="lazy" data-src="https://i.ytimg.com/vi/JcPXsSy-5x8/hqdefault.jpg"></a>
<h3 id="tutorial17">Part 7 Do Loops</h3><a href="https://www.youtube.com/watch?v=PGsx_sXforQ"><img class="lazy" data-src="https://i.ytimg.com/vi/PGsx_sXforQ/hqdefault.jpg"></a>
<h3 id="tutorial18">Part 8 SendKeys</h3><a href="https://www.youtube.com/watch?v=BISQwNjP2NE"><img class="lazy" data-src="https://i.ytimg.com/vi/BISQwNjP2NE/hqdefault.jpg"></a>
<h3 id="tutorial19">Part 9 Len - Left - Right</h3><a href="https://www.youtube.com/watch?v=-0TsIL1mNW8"><img class="lazy" data-src="https://i.ytimg.com/vi/-0TsIL1mNW8/hqdefault.jpg"></a>
<h3 id="tutorial20">Part 10 Script Directory</h3><a href="https://www.youtube.com/watch?v=wUchp5A8rTI"><img class="lazy" data-src="https://i.ytimg.com/vi/wUchp5A8rTI/hqdefault.jpg"></a>
<h3 id="tutorial21">Part 11 Subroutines</h3><a href="https://www.youtube.com/watch?v=SmjFJrb_6PE"><img class="lazy" data-src="https://i.ytimg.com/vi/SmjFJrb_6PE/hqdefault.jpg"></a>
<h3 id="tutorial22">Part 12 Internet Explorer - SendKeys (Automation)</h3><a href="https://www.youtube.com/watch?v=ZiPR8H13e1g"><img class="lazy" data-src="https://i.ytimg.com/vi/ZiPR8H13e1g/hqdefault.jpg"></a>
<h3 id="tutorial23">Part 13 Internet Explorer - HTML (Automation)</h3><a href="https://www.youtube.com/watch?v=DDL7jYOqIJo"><img class="lazy" data-src="https://i.ytimg.com/vi/DDL7jYOqIJo/hqdefault.jpg"></a>
<h3 id="tutorial24">Part 14 File - Folder - Exists</h3><a href="https://www.youtube.com/watch?v=PTchLap5ghs"><img class="lazy" data-src="https://i.ytimg.com/vi/PTchLap5ghs/hqdefault.jpg"></a>
<h3 id="tutorial25">Part 15 Copy - Move - Rename - Files &amp; Folders</h3><a href="https://www.youtube.com/watch?v=SFWr_1vXqIE"><img class="lazy" data-src="https://i.ytimg.com/vi/SFWr_1vXqIE/hqdefault.jpg"></a>
<h3 id="tutorial26">Part 16 Create Shortcuts</h3><a href="https://www.youtube.com/watch?v=BaLD-4OMJpY"><img class="lazy" data-src="https://i.ytimg.com/vi/BaLD-4OMJpY/hqdefault.jpg"></a>
<h3 id="tutorial27">Part 17 Special Folders</h3><a href="https://www.youtube.com/watch?v=sDX1oRb-2ZM"><img class="lazy" data-src="https://i.ytimg.com/vi/sDX1oRb-2ZM/hqdefault.jpg"></a>
<h3 id="tutorial28">Part 18 Create - Delete - Files &amp; Folders</h3><a href="https://www.youtube.com/watch?v=VlRUHx-161w"><img class="lazy" data-src="https://i.ytimg.com/vi/VlRUHx-161w/hqdefault.jpg"></a>
<h3 id="tutorial29">Part 19 Open Files (OpenTextFile)</h3><a href="https://www.youtube.com/watch?v=ZUFdm6EMmTg"><img class="lazy" data-src="https://i.ytimg.com/vi/ZUFdm6EMmTg/hqdefault.jpg"></a>
<h3 id="tutorial30">Part 20 Read Files (OpenTextFile)</h3><a href="https://www.youtube.com/watch?v=27iJiWME1WM"><img class="lazy" data-src="https://i.ytimg.com/vi/27iJiWME1WM/hqdefault.jpg"></a>
<h3 id="tutorial31">Part 21 Write Files (OpenTextFile)</h3><a href="https://www.youtube.com/watch?v=dAkZ0F11k4U"><img class="lazy" data-src="https://i.ytimg.com/vi/dAkZ0F11k4U/hqdefault.jpg"></a>
<h3 id="tutorial32">Part 22 Append Files (OpenTextFile)</h3><a href="https://www.youtube.com/watch?v=VArJHD3xy0U"><img class="lazy" data-src="https://i.ytimg.com/vi/VArJHD3xy0U/hqdefault.jpg"></a>
<h3 id="tutorial33">Part 23 Replace Words (Replace Command)</h3><a href="https://www.youtube.com/watch?v=0PEIhGwHRLc"><img class="lazy" data-src="https://i.ytimg.com/vi/0PEIhGwHRLc/hqdefault.jpg"></a>
<h3 id="tutorial34">Part 24 Replace Lines (Replace Command)</h3><a href="https://www.youtube.com/watch?v=Rj9H6OQPumY"><img class="lazy" data-src="https://i.ytimg.com/vi/Rj9H6OQPumY/hqdefault.jpg"></a>
<h3 id="tutorial35">Part 25 Replace using InputBox (Replace Command)</h3><a href="https://www.youtube.com/watch?v=YqnL0raFXQ4"><img class="lazy" data-src="https://i.ytimg.com/vi/YqnL0raFXQ4/hqdefault.jpg"></a>
<h3 id="tutorial36">Part 26 With Command</h3><a href="https://www.youtube.com/watch?v=ET5rSdeGfMo"><img class="lazy" data-src="https://i.ytimg.com/vi/ET5rSdeGfMo/hqdefault.jpg"></a>
<h3 id="tutorial37">Part 27 Get File - Folder (Properties)</h3><a href="https://www.youtube.com/watch?v=je87BxZ1m4s"><img class="lazy" data-src="https://i.ytimg.com/vi/je87BxZ1m4s/hqdefault.jpg"></a>
<h3 id="tutorial38">Part 28 Get File - Folder (Attributes)</h3><a href="https://www.youtube.com/watch?v=gYRW12t_miQ"><img class="lazy" data-src="https://i.ytimg.com/vi/gYRW12t_miQ/hqdefault.jpg"></a>
<h3 id="tutorial39">Part 29 Get File - Folder (Methods)</h3><a href="https://www.youtube.com/watch?v=giCc39sMHHE"><img class="lazy" data-src="https://i.ytimg.com/vi/giCc39sMHHE/hqdefault.jpg"></a>
<h3 id="tutorial40">Part 30 For - Each - Next - Loops</h3><a href="https://www.youtube.com/watch?v=ZUklutv0y14"><img class="lazy" data-src="https://i.ytimg.com/vi/ZUklutv0y14/hqdefault.jpg"></a>
<h3 id="tutorial41">Part 31 Internet Explorer - Existing Window (Automation)</h3><a href="https://www.youtube.com/watch?v=_AHFZhdPq0U"><img class="lazy" data-src="https://i.ytimg.com/vi/_AHFZhdPq0U/hqdefault.jpg"></a>
<h3 id="tutorial42">Part 32 Select Case</h3><a href="https://www.youtube.com/watch?v=FayFsqjkZ3A"><img class="lazy" data-src="https://i.ytimg.com/vi/FayFsqjkZ3A/hqdefault.jpg"></a>
<h3 id="tutorial43">Part 33 Functions</h3><a href="https://www.youtube.com/watch?v=7oEQHu3_8xc"><img class="lazy" data-src="https://i.ytimg.com/vi/7oEQHu3_8xc/hqdefault.jpg"></a>
<h3 id="tutorial44">Part 34 AppActivate - Maximize - Minimize - Restore - Close - Windows</h3><a href="https://www.youtube.com/watch?v=615NpV_RmcA"><img class="lazy" data-src="https://i.ytimg.com/vi/615NpV_RmcA/hqdefault.jpg"></a>
<h3 id="tutorial45">Part 35 Kill - Create - Process</h3><a href="https://www.youtube.com/watch?v=l-R80jjpdlY"><img class="lazy" data-src="https://i.ytimg.com/vi/l-R80jjpdlY/hqdefault.jpg"></a>
<h3 id="tutorial46">Part 36 Cancel Input Box (InputBox)</h3><a href="https://www.youtube.com/watch?v=nIpPSh4h_AA"><img class="lazy" data-src="https://i.ytimg.com/vi/nIpPSh4h_AA/hqdefault.jpg"></a>
<h3 id="tutorial47">Part 37 BrowseForFolder</h3><a href="https://www.youtube.com/watch?v=9keDmJHdyA0"><img class="lazy" data-src="https://i.ytimg.com/vi/9keDmJHdyA0/hqdefault.jpg"></a>
<h3 id="tutorial48">Part 38 BrowseForFile</h3><a href="https://www.youtube.com/watch?v=FhDJW7TtbRM"><img class="lazy" data-src="https://i.ytimg.com/vi/FhDJW7TtbRM/hqdefault.jpg"></a>
<h3 id="tutorial49">Part 39 Command Prompt (Arguments)</h3><a href="https://www.youtube.com/watch?v=_UspNdv4Hq0"><img class="lazy" data-src="https://i.ytimg.com/vi/_UspNdv4Hq0/hqdefault.jpg"></a>
<h3 id="tutorial50">Part 40 Date Functions</h3><a href="https://www.youtube.com/watch?v=2prpZAZDsGA"><img class="lazy" data-src="https://i.ytimg.com/vi/2prpZAZDsGA/hqdefault.jpg"></a>
<h3 id="tutorial51">Part 41 Copy All Files In Subfolders</h3><a href="https://www.youtube.com/watch?v=q9spGXm31gY"><img class="lazy" data-src="https://i.ytimg.com/vi/q9spGXm31gY/hqdefault.jpg"></a>
<h3 id="tutorial52">Part 42 Mid - Split - InStr</h3><a href="https://www.youtube.com/watch?v=WQ5qE9NqPmk"><img class="lazy" data-src="https://i.ytimg.com/vi/WQ5qE9NqPmk/hqdefault.jpg"></a>
<h3 id="tutorial53">Part 43 LCase - UCase - Trim</h3><a href="https://www.youtube.com/watch?v=NLAMsMg8-No"><img class="lazy" data-src="https://i.ytimg.com/vi/NLAMsMg8-No/hqdefault.jpg"></a>
<h3 id="tutorial54">Part 44 Creating Arrays (Arrays)</h3><a href="https://www.youtube.com/watch?v=J9bjrTaemic"><img class="lazy" data-src="https://i.ytimg.com/vi/J9bjrTaemic/hqdefault.jpg"></a>
<h3 id="tutorial55">Part 45 Adding to an Array (Arrays)</h3><a href="https://www.youtube.com/watch?v=gKOHXKwqOnc"><img class="lazy" data-src="https://i.ytimg.com/vi/gKOHXKwqOnc/hqdefault.jpg"></a>
<h3 id="tutorial56">Part 46 Math Functions</h3><a href="https://www.youtube.com/watch?v=zLcRZ9AU2fE"><img class="lazy" data-src="https://i.ytimg.com/vi/zLcRZ9AU2fE/hqdefault.jpg"></a>
<h3 id="tutorial57">Part 47 Formatting Numbers &amp; Dates</h3><a href="https://www.youtube.com/watch?v=vDkcVzxzBH8"><img class="lazy" data-src="https://i.ytimg.com/vi/vDkcVzxzBH8/hqdefault.jpg"></a>
<h3 id="tutorial58">Part 48 Repeating Characters - String() - Space()</h3><a href="https://www.youtube.com/watch?v=YfE77AWXmD8"><img class="lazy" data-src="https://i.ytimg.com/vi/YfE77AWXmD8/hqdefault.jpg"></a>
<h3 id="tutorial59">Part 49 TypeName - VarType - IsTests</h3><a href="https://www.youtube.com/watch?v=DugxDjA83JU"><img class="lazy" data-src="https://i.ytimg.com/vi/DugxDjA83JU/hqdefault.jpg"></a>
<h3 id="tutorial60">Part 50 Dropped Files - Folders (Arguments)</h3><a href="https://www.youtube.com/watch?v=4lSH-0F73jc"><img class="lazy" data-src="https://i.ytimg.com/vi/4lSH-0F73jc/hqdefault.jpg"></a>
<h3 id="tutorial61">Part 51 Execute - Read from another vbscript file.</h3><a href="https://www.youtube.com/watch?v=ukDb_ZFLLSg"><img class="lazy" data-src="https://i.ytimg.com/vi/ukDb_ZFLLSg/hqdefault.jpg"></a>
<h3 id="tutorial62">Part 52 Run As Administrator</h3><a href="https://www.youtube.com/watch?v=XAQ0f2wFjTk"><img class="lazy" data-src="https://i.ytimg.com/vi/XAQ0f2wFjTk/hqdefault.jpg"></a>
<h3 id="tutorial63">Part 53 Classes</h3><a href="https://www.youtube.com/watch?v=Hk60BXz-mps"><img class="lazy" data-src="https://i.ytimg.com/vi/Hk60BXz-mps/hqdefault.jpg"></a>
<h3 id="tutorial64">Part 54 Unzip - Extract Compressed Files</h3><a href="https://www.youtube.com/watch?v=3JMy837Tv9c"><img class="lazy" data-src="https://i.ytimg.com/vi/3JMy837Tv9c/hqdefault.jpg"></a>
<h3 id="tutorial65">Part 55 Make your computer talk/speak (SAPI)</h3><a href="https://www.youtube.com/watch?v=KGnQUBLp_6E"><img class="lazy" data-src="https://i.ytimg.com/vi/KGnQUBLp_6E/hqdefault.jpg"></a>
<h3 id="tutorial66">Part 56 Change the voice/gender (SAPI)</h3><a href="https://www.youtube.com/watch?v=eYPQTfORALQ"><img class="lazy" data-src="https://i.ytimg.com/vi/eYPQTfORALQ/hqdefault.jpg"></a>
<h3 id="tutorial67">Part 57 Read the registry (Regedit)</h3><a href="https://www.youtube.com/watch?v=j7tBRE1FEgg"><img class="lazy" data-src="https://i.ytimg.com/vi/j7tBRE1FEgg/hqdefault.jpg"></a>
<h3 id="tutorial68">Part 58 Write to the registry (Regedit)</h3><a href="https://www.youtube.com/watch?v=dIGGrTpVBNw"><img class="lazy" data-src="https://i.ytimg.com/vi/dIGGrTpVBNw/hqdefault.jpg"></a>
<h3 id="tutorial69">Part 59 Delete items in the registry (Regedit)</h3><a href="https://www.youtube.com/watch?v=hRWw1rK1LMQ"><img class="lazy" data-src="https://i.ytimg.com/vi/hRWw1rK1LMQ/hqdefault.jpg"></a>
<h3 id="tutorial70">Part 60 Multidimensional Arrays (Arrays)</h3><a href="https://www.youtube.com/watch?v=1KMIlvzvWB4"><img class="lazy" data-src="https://i.ytimg.com/vi/1KMIlvzvWB4/hqdefault.jpg"></a>
<h3 id="tutorial71">Part 61 Join Multidimensional Array (Arrays)</h3><a href="https://www.youtube.com/watch?v=QAvY4w-a1W0"><img class="lazy" data-src="https://i.ytimg.com/vi/QAvY4w-a1W0/hqdefault.jpg"></a>
<h3 id="tutorial72">Part 62 Adding and Viewing (Dictionary)</h3><a href="https://www.youtube.com/watch?v=bSTOZWcWZUA"><img class="lazy" data-src="https://i.ytimg.com/vi/bSTOZWcWZUA/hqdefault.jpg"></a>
<h3 id="tutorial73">Part 63 Change and Remove (Dictionary)</h3><a href="https://www.youtube.com/watch?v=zEAfy8RgQ7s"><img class="lazy" data-src="https://i.ytimg.com/vi/zEAfy8RgQ7s/hqdefault.jpg"></a>
<h3 id="tutorial74">Part 64 Multidimensional (Dictionary)</h3><a href="https://www.youtube.com/watch?v=axwYVERWbbg"><img class="lazy" data-src="https://i.ytimg.com/vi/axwYVERWbbg/hqdefault.jpg"></a>
<h3 id="tutorial75">Part 65 Manipulating Clipboard Text</h3><a href="https://www.youtube.com/watch?v=eM-E18VJkaQ"><img class="lazy" data-src="https://i.ytimg.com/vi/eM-E18VJkaQ/hqdefault.jpg"></a>
<h3 id="tutorial76">Part 66 Multiline String Formatter (create code with code)</h3><a href="https://www.youtube.com/watch?v=mx_TJZH38Rs"><img class="lazy" data-src="https://i.ytimg.com/vi/mx_TJZH38Rs/hqdefault.jpg"></a>
<h3 id="tutorial77">Part 70 RegExp (Test &amp; Replace)</h3><a href="https://www.youtube.com/watch?v=1t5hCX-FPPo"><img class="lazy" data-src="https://i.ytimg.com/vi/1t5hCX-FPPo/hqdefault.jpg"></a>
<h3 id="tutorial78">Part 71 RegExp (Execute)</h3><a href="https://www.youtube.com/watch?v=2sM6QuYFrn4"><img class="lazy" data-src="https://i.ytimg.com/vi/2sM6QuYFrn4/hqdefault.jpg"></a>
<h3 id="tutorial79">Part 72 RegExp ( Submatches )</h3><a href="https://www.youtube.com/watch?v=3NPvAmq1e4E"><img class="lazy" data-src="https://i.ytimg.com/vi/3NPvAmq1e4E/hqdefault.jpg"></a>
<h3 id="tutorial80">Regular Expressions ( [] {} () ? )</h3><a href="https://www.youtube.com/watch?v=JWPpmx5MXzw"><img class="lazy" data-src="https://i.ytimg.com/vi/JWPpmx5MXzw/hqdefault.jpg"></a>
<h3 id="tutorial81">Regular Expressions ( [^] + * \w \d \s \b )</h3><a href="https://www.youtube.com/watch?v=qbdsxX8IXPM"><img class="lazy" data-src="https://i.ytimg.com/vi/qbdsxX8IXPM/hqdefault.jpg"></a>
<h3 id="tutorial82">Regular Expressions ( ^ $ \escape )</h3><a href="https://www.youtube.com/watch?v=Knm5r0QwGC0"><img class="lazy" data-src="https://i.ytimg.com/vi/Knm5r0QwGC0/hqdefault.jpg"></a>
<h3 id="tutorial8">Run as Admin ( without UAC prompt ) VBScript Tutorials</h3><a href="https://www.youtube.com/watch?v=Jg2UFoMWDB4"><img class="lazy" data-src="https://i.ytimg.com/vi/Jg2UFoMWDB4/hqdefault.jpg"></a>


<h2>VB Scraper</h2>
<a href="http://www.wiseowl.co.uk/blog/s393/scraping-websites-vba.htm">scrape from webpages using VBA</a>
<a href="http://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba">Scraping website using vba</a>

<h2>Visual Basic sample</h2>
counter = 2
Do 
counter=counter+1 
MsgBox("Hello World!" & cstr(counter))
Loop until counter>10

save as test.vbs and click to run

not work:
Beep()
Threading.Thread.Sleep(250)
For Each P As Process In System.Diagnostics.Process.GetProcessesByName("cmd")
      P.Kill()
Next

<h2>System Beep in Batch/VB Script</h2>
WScript.StdOut.Write Chr(7)

<h2>VBS Play Sound</h2>
play MP3 files in VBScript using Windows Media Player scripting object, WMPlayer.OCX

Dim oPlayer
Set oPlayer = CreateObject("WMPlayer.OCX")
oPlayer.URL = "C:\welcome.mp3"  ' Play audio
oPlayer.controls.play 
While oPlayer.playState &lt;> 1 ' 1 = Stopped
  WScript.Sleep 100
Wend ' Release the audio file
oPlayer.close


<h2>VBS script to play sound repeatedly</h2>
strSoundFile = "C:\Temp\test.wav"
Set objShell = CreateObject("Wscript.Shell")
strCommand = "sndrec32 /play /close " & chr(34) & strSoundFile & chr(34)
objShell.Run strCommand, 0, True
Wscript.Sleep 1000

<h2>to Run VBScript on Windows</h2>

cscript hello.vbs
Execute the VBS script by double-clicking the file


<h2>Date/Time Functions</h2>
CDate	Converts a valid date and time expression to the variant of subtype Date
Date	Returns the current system date
DateAdd	Returns a date to which a specified time interval has been added
DateDiff	Returns the number of intervals between two dates
DatePart	Returns the specified part of a given date
DateSerial	Returns the date for a specified year, month, and day
DateValue	Returns a date
Day	Returns a number that represents the day of the month (between 1 and 31, inclusive)
FormatDateTime	Returns an expression formatted as a date or time
Hour	Returns a number that represents the hour of the day (between 0 and 23, inclusive)
IsDate	Returns a Boolean value that indicates if the evaluated expression can be converted to a date
Minute	Returns a number that represents the minute of the hour (between 0 and 59, inclusive)
Month	Returns a number that represents the month of the year (between 1 and 12, inclusive)
MonthName	Returns the name of a specified month
Now	Returns the current system date and time
Second	Returns a number that represents the second of the minute (between 0 and 59, inclusive)
Time	Returns the current system time
Timer	Returns the number of seconds since 12:00 AM
TimeSerial	Returns the time for a specific hour, minute, and second
TimeValue	Returns a time
Weekday	Returns a number that represents the day of the week (between 1 and 7, inclusive)
WeekdayName	Returns the weekday name of a specified day of the week
Year	Returns a number that represents the year
<h2>Conversion Functions</h2>
Asc	Converts the first letter in a string to ANSI code
CBool	Converts an expression to a variant of subtype Boolean
CByte	Converts an expression to a variant of subtype Byte
CCur	Converts an expression to a variant of subtype Currency
CDate	Converts a valid date and time expression to the variant of subtype Date
CDbl	Converts an expression to a variant of subtype Double
Chr	Converts the specified ANSI code to a character
CInt	Converts an expression to a variant of subtype Integer
CLng	Converts an expression to a variant of subtype Long
CSng	Converts an expression to a variant of subtype Single
CStr	Converts an expression to a variant of subtype String
Hex	Returns the hexadecimal value of a specified number
Oct	Returns the octal value of a specified number
<h2>Format Functions</h2>
FormatCurrency	Returns an expression formatted as a currency value
FormatDateTime	Returns an expression formatted as a date or time
FormatNumber	Returns an expression formatted as a number
FormatPercent	Returns an expression formatted as a percentage
<h2>Math Functions</h2>
Abs	Returns the absolute value of a specified number
Atn	Returns the arctangent of a specified number
Cos	Returns the cosine of a specified number (angle)
Exp	Returns e raised to a power
Hex	Returns the hexadecimal value of a specified number
Int	Returns the integer part of a specified number
Fix	Returns the integer part of a specified number
Log	Returns the natural logarithm of a specified number
Oct	Returns the octal value of a specified number
Rnd	Returns a random number less than 1 but greater or equal to 0
Sgn	Returns an integer that indicates the sign of a specified number
Sin	Returns the sine of a specified number (angle)
Sqr	Returns the square root of a specified number
Tan	Returns the tangent of a specified number (angle)
<h2>Array Functions</h2>
Array	Returns a variant containing an array
Filter	Returns a zero-based array that contains a subset of a string array based on a filter criteria
IsArray	Returns a Boolean value that indicates whether a specified variable is an array
Join	Returns a string that consists of a number of substrings in an array
LBound	Returns the smallest subscript for the indicated dimension of an array
Split	Returns a zero-based, one-dimensional array that contains a specified number of substrings
UBound	Returns the largest subscript for the indicated dimension of an array
<h2>String Functions</h2>
InStr	Returns the position of the first occurrence of one string within another. The search begins at the first character of the string
InStrRev	Returns the position of the first occurrence of one string within another. The search begins at the last character of the string
LCase	Converts a specified string to lowercase
Left	Returns a specified number of characters from the left side of a string
Len	Returns the number of characters in a string
LTrim	Removes spaces on the left side of a string
RTrim	Removes spaces on the right side of a string
Trim	Removes spaces on both the left and the right side of a string
Mid	Returns a specified number of characters from a string
Replace	Replaces a specified part of a string with another string a specified number of times
Right	Returns a specified number of characters from the right side of a string
Space	Returns a string that consists of a specified number of spaces
StrComp	Compares two strings and returns a value that represents the result of the comparison
String	Returns a string that contains a repeating character of a specified length
StrReverse	Reverses a string
UCase	Converts a specified string to uppercase
<h2>Other Functions</h2>
CreateObject	Creates an object of a specified type
Eval	Evaluates an expression and returns the result
IsEmpty	Returns a Boolean value that indicates whether a specified variable has been initialized or not
IsNull	Returns a Boolean value that indicates whether a specified expression contains no valid data (Null)
IsNumeric	Returns a Boolean value that indicates whether a specified expression can be evaluated as a number
IsObject	Returns a Boolean value that indicates whether the specified expression is an automation object
RGB	Returns a number that represents an RGB color value
Round	Rounds a number
ScriptEngine	Returns the scripting language in use
ScriptEngineBuildVersion	Returns the build version number of the scripting engine in use
ScriptEngineMajorVersion	Returns the major version number of the scripting engine in use
ScriptEngineMinorVersion	Returns the minor version number of the scripting engine in use
TypeName	Returns the subtype of a specified variable
VarType	Returns a value that indicates the subtype of a specified variable

<h2>JavaScript 和 VBScript 的比較</h2>

JavaScript 使用「+」來並排字串，而 VBScript 使用「&」來並排字串。
JavaScript 程式碼會分辨大小寫，VBScript 程式碼則不分大小寫。
一般高階程式碼（如 C/C++ 等），都會分辨大小寫，因此 VBScript 不區分大小寫，是一個主要的缺失。

JavaScript 使用「//」或「/* ... */」來加入註解，而 VBScript 則是使用「'」來加入註解。
一般而言，JavaScript 的每一列敘述後面必須加上分號，VBScript 程式碼則不需要。
更明確地說，JavaScript 若一列只包含一項敘述，則尾端之分號可以省略。
當然如果要將數個 JavaScript 的敘述寫在同一列，就需要在每一個敘述的尾巴加上分號（但最後一個敘述仍然可以省略分號）。
JavaScript 是自由格式（Free Format），因此可以把多個敘述放在同一列，或是把同一列敘述拆放在兩列。
但是 VBScript 則不是自由格式，因此通常是每個敘述放在一列，若要將多個敘述放在同一列，必須使用「:」來分開每一個敘述；
若要將一個敘述拆成多列，必須將「_」至於每一列尾端。
javaScript/example/jsVbsComp02.htm）
JavaScript 的語法接近 C 或 C++ 程式語言，VBScript 則接近於 Basic 程式語言。
JavaScript 適用的瀏覽器包含 IE、Firefox、Opera、Netscape 等，但 VBScript 則只能用在 IE 瀏覽器。
因此若為了跨瀏覽器平台，選用 JavaScript 是正確的抉擇。
JavaScript 和 VBScript 兩者都適用於 ASP（Active Server Pages） 和 WSH（Window Scripting Hosts）。


<h2>VBScript intro and samples</h2>
Windows操作系统
VBScript可以被用来自动地完成重复性的Windows操作系统任务。
在Windows操作系统中，VBScript可以在Windows Script Host的范围内运行。
Windows操作系统可以自动辨认和执行*.VBS和*.WSF两种文件格式，此外Internet Explorer可以执行HTA和CHM文件格式。
VBS和WSF文件完全是文字式的，它们只能通过少数几种对话窗口与用户通讯。
HTA和CHM文件使用HTML格式，它们的程序码可以像HTML一样被编辑和检查。
在WSF、HTA和CHM文件中VBScript和JavaScript的程序码可以任意混合。
HTA文件实际上是加有VBS、JavaScript成分的HTML文件。
CHM文件是一种在线帮助，用户可以使用专门的编辑程序将HTML程序编辑为CHM。

Windows 操作系统也提供一些 VBScript 脚本来进行高级管理功能，例如管理 Windows 激活密钥的 slmgr.vbs（Windows Server License Manager Script）。

网页浏览器（客户端的VBS）
网页中的VBS可以用来控制客户端的网页浏览器（以浏览器执行VBS程序）。
VBS与JavaScript在这一方面是竞争者，它们可以用来实现动态HTML，甚至可以将整个程序结合到网页中来。

至今为止VBS在客户方面未能占优势，因为它只获得Microsoft Internet Explorer的支持（Mozilla Suite可以透过安装一个包来支持VBS），并且IE11起已不再支持VBScript[1]。
而JavaScript则受到所有网页浏览器的支持。
在Internet Explorer中VBS和JavaScript使用同样的权限，它们只能有限地使用Windows操作系统中的对象。

网页服务器（服务器方面的VBS）
在网页服务器方面VBS是微软的Active Server Pages的一部分，它与JavaServer Pages和PHP是竞争对手。
在这里VBS的程序码直接嵌入到HTML页内，这样的网页以ASP结尾。
网页服务器Internet信息服务执行ASP页内的程序部分并将其结果转化为HTML传递给网页浏览器供用户使用。
这样服务器可以进行数据库闻讯并将其结果放到HTML网页中。

示范
Hello World
最简单的例子：

MsgBox "Hello World"
以.vbs文件保存。
再使用cscript.exe或wscript.exe执行。

一个更复杂的例子中，示出了使用MsgBox作为函数（返回一个结果），并使用了三个参数，其中第二个参数使用的是常量。

Dim x
' These three produce the same result. However, the use of constants as in the third line 
' is considered best practice.
x = MsgBox("Hello World:Text",1+64+4096,"Hello World:Title")
x = MsgBox("Hello World:Text",4161,"Hello World:Title")
x = MsgBox("Hello World:Text", vbOKCancel+vbInformation+vbSystemModal, _
           "Hello World:Title")

' Presents the number corresponding to the button pressed. Different constants will produce 
' different behaviours. For example, vbOKCancel specifies two buttons in the dialogue box, 
' whereas vbYesNoCancel specifies three.
x = MsgBox("Hello World:Text", vbYesNoCancel+vbInformation,"Hello World:Title")
MsgBox "The result is " & x

终止任务
VBScript能访问Windows管理规范 (WMI)，就像Windows任务管理器。
以下的代码执行时将会终止（“杀掉”）任何关于notepad.exe的进程。

'Terminate all processes involving the name <strProcessToKill>
Option Explicit
Dim strComputer, strProcessToKill, objWMIService, colProcess, objProcess

strComputer = "."
strProcessToKill = "notepad.exe"
Set objWMIService = GetObject("winmgmts:" _ 
   & "{impersonationLevel=impersonate}!\\" _ 
   & strComputer _ 
   & "\root\cimv2") 
Set colProcess = objWMIService.ExecQuery _
   ("Select * from Win32_Process Where Name = '" & strProcessToKill & "'")
For Each objProcess in colProcess
   MsgBox "... terminating " & objProcess.Name
   objProcess.Terminate()
Next
使用Option Explicit并不是必须的，但它被认为是VBScript的最佳实践。

创建具有唯一的名称的十个文件
这个实例显示如何创建文件并向它添加内容。
它还演示了字符串连接。

For i = 1 to 10
	createFile( i )
Next

Public sub createFile(a)
	Dim fso,myFile
	filePath = "C:\file_name" & a & ".txt"
	Set fso=CreateObject("Scripting.FileSystemObject")
	Set MyFile= fso.CreateTextFile( filePath)
	MyFile.WriteLine("This is a separate file")
	MyFile.close

End Sub

发送按键
SendKeys方法模拟一个或多个按键到活动窗口（模拟在键盘上输入）。
 在该示例中，脚本发送字符串“Hello World！”3次，每次暂停2秒（2000毫秒）。
SendKeys宏可能会在某些程序中失效，因为一些软件（如在安装时输入许可证密钥）将检查是否是真正的按键，而不是虚拟的。

set shl = createobject("wscript.shell")
shl.sendkeys "Hello World!"
wscript.sleep 2000
shl.sendkeys "Hello World!"
wscript.sleep 2000
shl.sendkeys "Hello World!"
wscript.sleep 2000
执行期间，“Hello World!”将显示在命令提示符。

Windows文件操作
对象FileSystemObject执行一些文件操作（例如测试一个文件是否存在），并且还创建一个文本文件（一个TextStream对象）。

myfilename = "C:\Wikipedia - VBScript - Example - Hello World.txt"
MakeHelloWorldFile myfilename

Sub MakeHelloWorldFile (FileName)
'Create a new file in C: drive or overwrite existing file
   Set FSO = CreateObject("Scripting.FileSystemObject")
   If FSO.FileExists(FileName) Then 
      Answer = MsgBox ("File " & FileName & " exists ... OK to overwrite?", vbOKCancel)
      'If button selected is not OK, then quit now
      'vbOK is a language constant
      If Answer &lt;> vbOK Then Exit Sub
   Else
      'Confirm OK to create
      Answer = MsgBox ("File " & FileName & " ... OK to create?", vbOKCancel)
      If Answer &lt;> vbOK Then Exit Sub
   End If
   'Create new file (or replace an existing file)
   Set FileObject = FSO.CreateTextFile (FileName)
   FileObject.WriteLine "Time ... " & Now()
   FileObject.WriteLine "Hello World"
   FileObject.Close()
   MsgBox "File " & FileName & " ... updated."
End Sub
MakeHelloWorldFile将会在按下按钮后于C:\ 驱动器根目录创建（若已经存在则更新）一个小文本文件。

Excel对象操作
Option Explicit '所有变量必须显式声明

Dim app,workbook,sheet
Dim row,col

Set app = WScript.CreateObject("Excel.Application")
app.Visible = True
Set workbook = app.WorkBooks.Add

Set sheet = workbook.Worksheets(1)
'10x10 random value
For row = 1 To 10
  For col = 1 To 10
    sheet.Cells(row,col).Value = CInt(Int((100 * Rnd()) + 1))
  Next
Next

Set sheet = workbook.Worksheets(2)
'10x10 random value
sheet.Range("A1:J10").Formula = "=Int(Rand() * 100 + 1)"

语言
VBScript主要的优点有：
由于VBScript由操作系统，而不是由网页浏览器解释，它的文件比较小。

易学。
在所有2000 / 98SE以后的Windows版本都可直接使用。
可以使用其它程序和可使用的对象（尤其是Microsoft Office）。

缺点有：
现在VBS无法作为电子邮件的附件了。
Microsoft Outlook拒绝接受VBS为附件，收信人无法直接使用VBS附件。

VBS的各种编辑器不受欢迎。
操作系统没有任何特别的保护设施。
VBS程序与其它JS、EXE、BAT或CMD程序一样对待。
操作系统没有监察恶意功能的能力。

<br>
<a href="https://www.robvanderwoude.com/vbstech.php">VBScript Scripting Techniques</a>
<br>

<h2>set delay in vbscript</h2>
<a href="https://stackoverflow.com/questions/1729075/how-to-set-delay-in-vbscript">set delay in vbscript</a>
<br>
WScript.Sleep 1000
MsgBox "TEST"

Note, the number is in Milliseconds, so 1000 is 1 second.


<h2>check battery</h2>
set oLocator = CreateObject("WbemScripting.SWbemLocator")
set oServices = oLocator.ConnectServer(".","root\wmi")
set oResults = oServices.ExecQuery("select * from batteryfullchargedcapacity")
for each oResult in oResults
   iFull = oResult.FullChargedCapacity
next

while (1)
  set oResults = oServices.ExecQuery("select * from batterystatus")
  for each oResult in oResults
    iRemaining = oResult.RemainingCapacity
    bCharging = oResult.Charging
  next
  iPercent = ((iRemaining / iFull) * 100) mod 100
  if bCharging and (iPercent > 94) Then msgbox "Battery is at " & iPercent & "%",vbInformation, "Battery monitor"
  if Not(bCharging) and (iPercent < 30) Then msgbox "Chr(7)Battery is at " & iPercent & "%",vbInformation, "Battery monitor"
  wscript.sleep 300000 ' 5 minutes
wend

<h2>bell character</h2>
Chr(7)


<h2>MsgBox function</h2>

<a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/msgbox-function">MsgBox function</a>
The MsbBox function is set up as any function to return certain values. 
It is not set up to change fonts and add pictures.
<br>
Dim Msg, Style, Title, Help, Ctxt, Response, MyString
Msg = "Do you want to continue ?"    ' Define message.
Style = vbYesNo + vbCritical + vbDefaultButton2    ' Define buttons.
Title = "MsgBox Demonstration"    ' Define title.
Help = "DEMO.HLP"    ' Define Help file.
Ctxt = 1000    ' Define topic context. 

' Display message.
Response = MsgBox(Msg, Style, Title, Help, Ctxt)
If Response = vbYes Then    ' User chose Yes.
    MyString = "Yes"    ' Perform some action.
Else    ' User chose No.
    MyString = "No"    ' Perform some action.
End If

<h2>Visual Basic Functions</h2>

<a href="https://docs.microsoft.com/en-us/office/vba/language/reference/functions-visual-basic-for-applications">VB Functions</a><br>

Conversion functions
Asc, Chr, CVErr, Format, Hex, Oct, Str, Val

Math functions
Abs, Atn, Cos, Derived math, Exp, Int, Fix, Log, Rnd, Sgn, Sin, Sqr, Tan

Other functions
Array, CallByName, Choose, Command, CreateObject, CurDir, Date, DateAdd, DateDiff, DatePart, DateSerial, DateValue, Day, DDB, Dir, DoEvents, Environ, EOF, Error, FileAttr, FileDateTime, FileLen, Filter, FormatCurrency, FormatDateTime, FormatNumber, FormatPercent, FreeFile, FV, GetAllSettings, GetAttr, GetObject, GetSetting, Hour, IIf, IMEStatus, Input, InputBox, InStr, InStrRev, IPmt, IRR, IsArray, IsDate, IsEmpty, IsError, IsMissing, IsNull, IsNumeric, IsObject, Join, LBound, LCase, Left, Len, Loc, LOF, LTrim, RTrim, and Trim, MacID, MacScript, Mid, Minute, MIRR, Month, MonthName, MsgBox, Now, NPer, NPV, Partition, Pmt, PPmt, PV, QBColor, Rate, Replace, RGB, Right, Round, Second, Seek, Shell, SLN, Space, Spc, Split, StrComp, StrConv, String, StrReverse, Switch, SYD, Tab, Time, Timer, TimeSerial, TimeValue, TypeName, UBound, UCase, VarType, Weekday, WeekdayName, Year

<br>
<h2> Sample VBScript Programs </h2> 
Getting started:
Input string from a user and echo back: <a href="http://courses.washington.edu/css341/zander/Code/simple.vbs"> simple.vbs</a>
Simple html file: <a href="http://courses.washington.edu/css341/zander/Code/simplehtml.html"> simplehtml.html</a>
Get 3 numbers from a user and find the largest: <a href="http://courses.washington.edu/css341/zander/Code/largestNum.vbs"> largestNum.vbs</a>
Put largestNum program in an html file: <a href="http://courses.washington.edu/css341/zander/Code/largestNum.html"> largestNum.html</a>
Put largestNum program in an html file using a table: <a href="http://courses.washington.edu/css341/zander/Code/largestNumTable.html"> largestNumTable.html</a>

If you ever find that you have created an infinite loop (so your script
  keeps running and running and running ...), use ctrl-alt-delete and open
  the Task Manager. Under the "Processes" tab, end the "wscript" process.

Loop examples:
Using mod and division operators in a zero-terminated loop: <a href="http://courses.washington.edu/css341/zander/Code/digits.vbs"> digits.vbs</a>
Using mod and division operators in a loop terminated by string "done": <a href="http://courses.washington.edu/css341/zander/Code/digits2.vbs"> digits2.vbs</a>
Read in numbers until a negative number is found; determine the average: <a href="http://courses.washington.edu/css341/zander/Code/avg.vbs"> avg.vbs</a>
Start with $1, double money everyday until $1,000,000 (practice prob 4): <a href="http://courses.washington.edu/css341/zander/Code/million.vbs"> million.vbs</a>
Find the largest number inputted by a user (practice prob 6): <a href="http://courses.washington.edu/css341/zander/Code/findLarge.vbs"> findLarge.vbs</a>
Display a square of asterisks of a given size (practice prob 9): <a href="http://courses.washington.edu/css341/zander/Code/prob9.vbs"> prob9.vbs</a>

Subroutine/Function examples:
Find the largest number inputted by a user (practice prob 6), without subroutines: <a href="http://courses.washington.edu/css341/zander/Code/findLarge.vbs"> findLarge.vbs</a>
Find the largest number inputted by a user (practice prob 6), using subroutines: <a href="http://courses.washington.edu/css341/zander/Code/findLargeWithSubs.vbs"> findLargeWithSubs.vbs</a>
Sort three numbers, without subroutines: <a href="http://courses.washington.edu/css341/zander/Code/sortThreeNums.vbs"> sortThreeNums.vbs</a>
Sort three numbers, using subroutines: <a href="http://courses.washington.edu/css341/zander/Code/sortThreeNumsWithSubs.vbs"> sortThreeNumsWithSubs.vbs</a>
Demonstrate the difference between ByVal and ByRef: <a href="http://courses.washington.edu/css341/zander/Code/byValbyRef.vbs"> byValbyRef.vbs</a>

Opening files -- MS Excel, text files, and Word doc:
Open a new excel spreadsheet and enter and add two numbers: <a href="http://courses.washington.edu/css341/zander/Code/openNewExcel.vbs"> openNewExcel.vbs</a> 
Open an existing excel spreadsheet: <a href="http://courses.washington.edu/css341/zander/Code/openOldExcel.vbs"> openOldExcel.vbs</a>
Open an existing excel spreadsheet and loop through cells: <a href="http://courses.washington.edu/css341/zander/Code/loopCells.vbs"> loopCells.vbs</a>
Open an existing text file and loop through lines: <a href="http://courses.washington.edu/css341/zander/Code/openText.vbs"> openText.vbs</a>
Open an existing Word doc search for a given string: <a href="http://courses.washington.edu/css341/zander/Code/searchWord.vbs"> searchWord.vbs</a>
Open an existing Powerpoint document and display text of each slide: <a href="http://courses.washington.edu/css341/zander/Code/openPpt.vbs"> openPpt.vbs</a>
Open an existing Powerpoint document and put text of each slide into a word document: <a href="http://courses.washington.edu/css341/zander/Code/pptToWord.vbs"> pptToWord.vbs</a>

Array examples:
Demonstrate simple array manipulation using static arrays: <a href="http://courses.washington.edu/css341/zander/Code/array.vbs"> array.vbs</a>
Demonstrate dynamic arrays: <a href="http://courses.washington.edu/css341/zander/Code/arrayDynamic.vbs"> arrayDynamic.vbs</a>
Find something in an array (linear search) (find grade given name): <a href="http://courses.washington.edu/css341/zander/Code/linearSearch.vbs"> linearSearch.vbs</a>
First open a text file with names, e.g., <a href="http://courses.washington.edu/css341/zander/Code/names.txt"> names.txt</a>
Then open a text file with grades, e.g., <a href="http://courses.washington.edu/css341/zander/Code/grades.txt"> grades.txt</a>
Sort a collection of integers using a bubble sort: <a href="http://courses.washington.edu/css341/zander/Code/bubble.vbs"> bubble.vbs</a>

<a href="http://courses.washington.edu/css341/zander/code.html">Sample VBScript Programs</a>

<a href="http://w3schools.sinsixx.com/vbscript/vbscript_examples.asp.htm">VBScript Examples</a>
<a href="http://www.landofcode.com/vbscript-examples/">VBScript examples</a>
<a href="https://www3.rocketsoftware.com/bluezone/help/v52/en/bzsh/bzaa_aref_sample-vbscript.htm">Sample VBScript</a>

<br>

<h2>simple.vbs</h2>
' Based on code by Kelvin Sung
' File:  simple.vbs
'
' Purpose: Input a string from the user and echo the string back to the user.
'
' Lessons 
' -- comments start with a single quote (')
' -- execution starts from the first line
' -- always say you will explicitly declare variables
' -- variable declarations don't have types
'
' There are two ways we can run this script:
'    1. On a command (console) window type
'		   wscript simple.vbs
'    2. Click on the simple.vbs file


Option Explicit        ' says we must declare variables, we will always use it 

Dim inputString        ' user input string

' Call a function: InputBox
' pass in one parameter: the entire sentence in double-quotes, 
'     often called a string
' Notice: a function returns something, and you MUST parenthecize the parameter
'     in this situation (we'll learn the details later)
inputString = InputBox("Please enter some phrase or sentence. Thanks!")

' Calling a procedure: MsgBox
' pass in one parameter: a string (in double quotes) concatenated with
'     inputString; the '&' connects the two strings together
' Notice there are no parentices around the parameter
MsgBox "You entered:  " & inputString

<h2>largestNum.vbs</h2>
' Based on code by Kelvin Sung
' File:  largestNum.vbs
'
' Purpose:  input three numbers and figure out the maximum of the numbers.
'
' Lessons
' -- the if/then/else construct 
' -- be careful when working with numbers 
' -- continue code to the next line by using the underscore
' -- parameters are separated by a comma

Option Explicit                     ' recall force explicit var declaration

Dim largestNum                      ' variable for largest number
Dim num1, num2, num3                ' variables for the three input numbers

num1 = InputBox("Please enter the first number: ")
num2 = InputBox("Please enter the second number: ")
num3 = InputBox("Please enter the third number: ")

' check to make sure all input are "numeric" - integer/float/double
If IsNumeric(num1) and IsNumeric(num2) and IsNumeric(num3) Then
    ' MsgBox is a subroutine, the first parameter is the "prompt"
    '
    ' if the last character of the line is an underscore, then the line of
    ' code is continued to the next line (CANNOT put comment here)
    '
    ' the second parameter is what button to put on the MsgBox
    '
    ' the third parameter is the "title" for the MsgBox
    '
    ' note, there are more parameters for MsgBox, but we choose to use defaults
    MsgBox "You have entered: " & num1 & " " & num2 & " " & num3, _
           vbOKOnly,  "Entered Values"

    ' the numbers can be integers or floating point number (have dec point),
    ' compare them as "Double" (or floating point numbers)
    largestNum = num1
    If CDbl(num2) > CDbl(largestNum) Then
        largestNum = num2
    End If

    If CDbl(num3) > CDbl(largestNum) Then
        largestNum = num3
    End If

    MsgBox "The largest number entered is: "  & largestNum, vbOKOnly, _
        "Largest Number"
Else
    MsgBox "You must enter three numbers! Try Again", vbOKOnly, "Invalid Input"
End If

<h2>largestNum</h2>
    The &lt:script&gt; tag says we are going to have script code here.

    Notice, we place the &lt;script&gt; inside the &lt;body&gt; section.
    The &lt;script&gt; can be inside or outside any part of the &lt;html&gt; section. 
&lt;script Language="vbscript"&gt;

   Option Explicit

   ' This is the "service" routine for our button: SubmitButton
   ' we are going to service "_onClick" event for this button.
   ' Refer to page 161 of the VBScript reference book for all 
   ' valid events of all controls
   Sub SubmitButton_onClick

      ' Code from largestNum.vbs, but without most comments for easy reading
      ' Note that we no longer have InputBox for input. Handled below.
      ' Below, data type is &VarType(num1.value).
      ' So, num1 is a string, not a number, but num1.value is a number.

      Dim largestNum                   ' variable for largest number

      ' check to make sure all input are "numeric" - integer/float/double
      If IsNumeric(num1.value) and IsNumeric(num2.value) _
                               and IsNumeric(num3.value) Then
         MsgBox "You have entered: " & num1.value & " " & num2.value & " " _
                & num3.value, vbOKOnly, "Entered Values"

         largestNum = num1.value
         If CDbl(num2.value) > CDbl(largestNum) Then
            largestNum = num2.value
         End If

         If CDbl(num3.value) > CDbl(largestNum) Then
            largestNum = num3.value
         End If

         MsgBox "The largest number entered is: "  & largestNum, vbOKOnly, _
                "Largest Number"
      Else
         MsgBox "You must enter three numbers! Try Again", vbOKOnly, _
                "Invalid Input"
      End If
   End Sub
&lt;/script&gt;

First Number: <Input Type="Text" Name="num1" Value="" />
Second Number: <Input Type="Text" Name="num2" Value="" />
Third Number: <Input Type="Text" Name="num3" Value="" />

   Input Type - list of all valid types on page 161 of VBScript Reference book
   Name - variable name for this control
   Value - what to show on the webpage (or the label for this control)

&lt;Input Type="Button" Name="SubmitButton" Value="Submit" &gt;

<h2>largestNumTable</h2>
    The &lt;script&gt; tag says we are going to have script code here.

    Notice, we place the &lt;script&gt; inside the &lt;body&gt; section.
    The &lt;script&gt; can be inside or outside any part of the &lt;html&gt; section. 
&lt;script Language="vbscript"&gt;

   Option Explicit

   ' This is the "service" routine for our button: SubmitButton
   ' we are going to service "_onClick" event for this button.
   ' Refer to page 161 of the VBScript reference book for all 
   ' valid events of all controls
   Sub SubmitButton_onClick

      ' Code from largestNum.vbs, but without most comments for easy reading
      ' Note that we no longer have InputBox for input. Handled below.
      ' Below, data type is &VarType(num1.value).
      ' So, num1 is a string, not a number, but num1.value is a number.

      Dim largestNum                   ' variable for largest number

      ' check to make sure all input are "numeric" - integer/float/double
      If IsNumeric(num1.value) and IsNumeric(num2.value) _
                               and IsNumeric(num3.value) Then
         MsgBox "You have entered: " & num1.value & " " & num2.value & " " _
                & num3.value, vbOKOnly, "Entered Values"

         largestNum = num1.value
         If CDbl(num2.value) > CDbl(largestNum) Then
            largestNum = num2.value
         End If

         If CDbl(num3.value) > CDbl(largestNum) Then
            largestNum = num3.value
         End If

         MsgBox "The largest number entered is: "  & largestNum, vbOKOnly, _
                "Largest Number"
      Else
         MsgBox "You must enter three numbers! Try Again", vbOKOnly, _
                "Invalid Input"
      End If
   End Sub
&lt;/script&gt;

&lt;table&gt;
&lt;tr&gt;
First Number:
&lt;Input Type="Text" Name="num1" Value=""&gt;
&lt;Second Number:&gt;
&lt;Input Type="Text" Name="num2" Value=""&gt;
Third Number:
&lt;Input Type="Text" Name="num3" Value=""&gt;
&lt;/table&gt;

   Input Type - list of all valid types on page 161 of VBScript Reference book
   Name - variable name for this control
   Value - what to show on the webpage (or the label for this control)

&lt;Input Type="Button" Name="SubmitButton" Value="Submit"&gt;

<h2>digits.vbs</h2>
' Based on code by Kelvin Sung
' File:  digits.vbs
'
' example demonstrates mod (modulus, finding remainder) and integer div (\)
' by breaking a five-digit number into individual digits
 
Option Explicit                  ' must declare every variables before use

dim inputNumber                  ' input from user
dim origNumber                   ' save the inputNumber
dim onesDigit, tenDigit, hunDigit, thouDigit, tenThouDigit

do
   inputNumber = InputBox("Please Enter a 5 digit number, zero to end")

   ' check for validity
   if not IsNumeric(inputNumber) then
      MsgBox "You must enter a number. Try Again.", vbOKOnly, "Invalid Input"
   else
      ' check to see if the loop should be terminated
      if inputNumber = 0 then
         exit do
      end if

      ' have obtained a good number, demonstrate different kinds of division
      origNumber = inputNumber
      MsgBox "Using division (/):  " & origNumber & "/100 is  " _
              & origNumber/100
      MsgBox "Using integer division (\):  " & origNumber & "\100 is  " _
              & origNumber\100

      ' extract digits
      tenThouDigit = inputNumber\10000

      inputNumber = inputNumber mod 10000
      thouDigit = inputNumber\1000

      inputNumber = inputNumber mod 1000
      hunDigit = inputNumber\100

      inputNumber = inputNumber mod 100
      tenDigit = inputNumber\10

      onesDigit = inputNumber mod 10

      MsgBox "The digits of  " & origNumber & "  are  " & tenThouDigit & "  " _
              & thouDigit & "  " & hunDigit & "  " & tenDigit & "  " & onesDigit
   end if
loop

MsgBox "All done!"

<h2>digits2.vbs</h2>
' Based on code by Kelvin Sung
' File:  digits2.vbs
'
' example demonstrates mod (modulus, finding remainder) and integer div (\)
' by breaking a five-digit number into individual digits
 
Option Explicit                  ' must declare every variables before use

dim inputNumber                  ' input from user
dim origNumber                   ' save the inputNumber
dim onesDigit, tenDigit, hunDigit, thouDigit, tenThouDigit

do
   inputNumber = InputBox("Please enter a 5 digit number, enter 'done' to end")

   ' check for validity, exit on entry of word "done"
   if not IsNumeric(inputNumber) then
      if inputNumber = "done" then
         exit do
      else
         MsgBox "You must enter a number, try again.", vbOKOnly, "Invalid Input"
      end if
   else
      origNumber = inputNumber
      MsgBox "Using division (/):  " & origNumber & "/100 is  " _
             & origNumber/100
      MsgBox "Using integer division (\):  " & origNumber & "\100 is  " _
             & origNumber\100

      ' separate digits
      tenThouDigit = inputNumber\10000

      inputNumber = inputNumber mod 10000
      thouDigit = inputNumber\1000

      inputNumber = inputNumber mod 1000
      hunDigit = inputNumber\100

      inputNumber = inputNumber mod 100
      tenDigit = inputNumber\10

      onesDigit = inputNumber mod 10

      MsgBox "The digits of  " & origNumber & "  are  " & tenThouDigit & "  " _
             & thouDigit & "  " & hunDigit & "  " & tenDigit & "  " & onesDigit
   end if
loop

MsgBox "All done!"

<h2>avg.vbs</h2>
' File:  avg.vbs
'
' count how many data and compute average
 
Option Explicit                  ' must declare every variables before use

dim inputNumber                  ' input from user
dim count                        ' count data items
dim sum                          ' sum data items
dim avg                          ' average of data items

' initialize 
count = 0
sum = 0
avg = 0

' for every valid data item, sum and count it
do
   inputNumber = InputBox("Please enter one number, negative number to end")

   ' check for validity
   if not IsNumeric(inputNumber) then
      MsgBox "You must enter a number. Try Again.", vbOKOnly, "Invalid Input"
   else
      if inputNumber < 0 then
         exit do
      end if
      sum = sum + inputNumber
      count = count + 1
   end if
loop

' computer average and output
if count &lt;> 0 then
   avg = sum/count
else
   avg = 0
end if
MsgBox "The number of items entered:  " & count & "  has an average of  " & avg 

<h2>million.vbs</h2>
' File:  million.vbs
'
' 4. Suppose you start with $1 and double your money every day. How many days
' does it take to make more than $1000000?
 
Option Explicit                  ' must declare every variables before use

const MAXAMOUNT = 1000000
dim amount                       ' current amount of money
dim sum                          ' total sum of accumulated money
dim days                         ' number of days

' initialize 
amount = 1
sum = 0
days = 0

do until sum > MAXAMOUNT 
   sum = sum + amount
   amount = 2 * amount
   days = days + 1
loop

MsgBox "Start with $1 and double your money everyday. It takes  " _
       & days & "  days to make  " & sum & "  dollars" 

<h2>findLarge.vbs</h2>
' File: findLarge.vbs
'
' 6. In a loop, you input one integer at a time. The word "done" 
' terminates the loop. Find and display the largest number inputted.
 
Option Explicit                  ' force declaration of variables before use

dim inputNumber                  ' input from user
dim outputNums                   ' to show all the numbers user inputs
dim largest                      ' always current largest number
dim doneWithInput                ' whether or not user is done entering input
doneWithInput = false
outputNums = ""

' Loop to get one valid number from the user to initialize largest.
' The var doneWithInput will remember if the user is done before
' ever entering a valid number.
do
   inputNumber = InputBox("Please enter one number, enter 'done' to end")
   ' check for validity, exit on entry of word "done"
   if not IsNumeric(inputNumber) then
      if inputNumber = "done" then
         doneWithInput = true                
         exit do
      else
         MsgBox "You must enter a number, try again.", vbOKOnly, "Invalid Input"
      end if
   else
      largest = inputNumber
      outputNums = outputNums & " " & inputNumber
      exit do
   end if
loop

' If user isn't done, continue getting integers to find the largest.
' Continually compare with the current largest to see if it's larger,
' then it becomes the new current largest.
if not doneWithInput then
   do
      inputNumber = InputBox("Please enter one number, enter 'done' to end")

      ' check for validity, exit on entry of word "done"
      if not IsNumeric(inputNumber) then
         if inputNumber = "done" then
            exit do
         else
            MsgBox "You must enter a number, try again.", vbOKOnly, _
                   "Invalid Input"
         end if
      else  
         ' recall that InputBox returns a string, so convert to
         ' make sure they are treated as numbers, not strings
         if Cdbl(inputNumber) > Cdbl(largest) then
            largest = inputNumber
         end if

         outputNums = outputNums & " " & inputNumber
      end if
   loop
end if

if doneWithInput then
   MsgBox "Can't find the largest because you never entered any numbers!!" 
else
   MsgBox "Of all the numbers, " & outputNums & ", the largest is  " & largest
end if

<h2>prob9.vbs</h2>
' 9. Given some integer number as input, print out a solid square in 
' asterisks the size of that number. E.g., input is 5, output is
' *****
' *****
' *****
' *****
' *****
 
Option Explicit                  ' must declare every variables before use

dim inputNumber                  ' input from user
dim i, j
dim output                           

do
   ' start with no characters in the output string, called the empty string
   output = ""

   inputNumber = InputBox("Please enter one positive number, 'done' to end")

   ' check for validity of input
   if not IsNumeric(inputNumber) then
      if inputNumber = "done" then
         exit do
      else
         MsgBox "You must enter a number. Try Again.", vbOKOnly, "Invalid Input"
      end if

   ' can't have a negative number of asterisks in a box
   elseif inputNumber < 0 then
      MsgBox "You must enter a positive number. Try Again.", vbOKOnly, _
             "Invalid Input"

   else                                     ' have valid inputNumber
      ' i loop yields different lines of asterisks
      for i = 1 to inputNumber

         ' j loop gives all the asterisks in one line
         for j = 1 to inputNumber
            output = output & "*"
         next

         ' after the j loop asterisks are concatenated, need NewLine in output
         output = output & vbNewLine
      next
      MsgBox output
   end if
loop

<h2>findLargeWithSubs.vbs</h2>
' File: findLarge.vbs
'
' 6. In a loop, you input one integer at a time. The word "done" 
' terminates the loop. Find and display the largest number inputted.
 
Option Explicit                  ' force declaration of variables before use

dim outputNums                   ' to show all the numbers user inputs
dim largest                      ' always current largest number
dim doneWithInput                ' whether or not user is done entering input
doneWithInput = false
outputNums = ""

call setFirstLargest(outputNums, doneWithInput, largest)
call findLargestInRest(outputNums, doneWithInput, largest)
if doneWithInput then
   MsgBox "Can't find the largest because you never entered any numbers!!" 
else
   MsgBox "Of all the numbers, " & outputNums & ", the largest is  " & largest
end if


'---------------------------------------------------------------------------- 
' setFirstLargest 
' Loop to get one valid number from the user to initialize largest.
' The var doneWithInput will remember if the user is done before
' ever entering a valid number.
sub setFirstLargest(outputNums, doneWithInput, largest)
   dim inputNumber                  ' input from user
   do
      inputNumber = InputBox("Please enter one number, enter 'done' to end")
      ' check for validity, exit on entry of word "done"
      if not IsNumeric(inputNumber) then
         if inputNumber = "done" then
            doneWithInput = true                
            exit do
         else
            MsgBox "You must enter a number, try again.", vbOKOnly, _
                   "Invalid Input"
         end if
      else
         largest = inputNumber
         outputNums = outputNums & " " & inputNumber
         exit do
      end if
   loop
end sub

'---------------------------------------------------------------------------- 
' findLargestInRest
' If user isn't done, continue getting integers to find the largest.
' Continually compare with the current largest to see if it's larger,
' then it becomes the new current largest.
sub findLargestInRest(outputNums, doneWithInput, largest)
   dim inputNumber                  ' input from user
   if not doneWithInput then
      do
         inputNumber = InputBox("Please enter one number, enter 'done' to end")

         ' check for validity, exit on entry of word "done"
         if not IsNumeric(inputNumber) then
            if inputNumber = "done" then
               exit do
            else
               MsgBox "You must enter a number, try again.", vbOKOnly, _
                      "Invalid Input"
            end if
         else  
            ' recall that InputBox returns a string, so convert to
            ' make sure they are treated as numbers, not strings
            if Cdbl(inputNumber) > Cdbl(largest) then
               largest = inputNumber
            end if

            outputNums = outputNums & " " & inputNumber
         end if
      loop
   end if
end sub
<h2>sortThreeNums.vbs</h2>
' File: sortThreeNums.vbs
' Sort three Numbers

   Option Explicit

   dim num1, num2, num3            ' used for input
   dim largeNum                   ' variable for largest number
   dim middleNum                  ' variable for second largest number
   dim smallNum                   ' variable for smallest number
   dim temp

   num1 = InputBox("Please enter the first number")
   num2 = InputBox("Please enter the second number")
   num3 = InputBox("Please enter the third number")

   ' check to make sure all input are "numeric" - integer/float/double
   if IsNumeric(num1) and IsNumeric(num2) and IsNumeric(num3) then
      MsgBox "You have entered: " & num1 & " " & num2 & " " _
             & num3, vbOKOnly, "Entered Values"

      largeNum = CDbl(num1) 
      middleNum = CDbl(num2)
      smallNum = CDbl(num3)

      if largeNum < middleNum then
         temp = largeNum
         largeNum = middleNum
         middleNum = temp
      end if

      if largeNum < smallNum then
         temp = largeNum
         largeNum = smallNum
         smallNum = temp
      end if

      if middleNum < smallNum then
         temp = middleNum
         middleNum = smallNum
         smallNum = temp
      end if

      MsgBox "The numbers sorted: " & smallNum & "  " & middleNum & "  " _
             & largeNum, vbOKOnly, "Sorted Numbers"  
   else
      MsgBox "You must enter three numbers! Try Again", vbOKOnly, _
             "Invalid Input"
   end if

<h2>sortThreeNumsWithSubs.vbs</h2>
' File: sortThreeNumsWithSubs.vbs
' Sort three Numbers

   Option Explicit

   dim num1, num2, num3            ' used for input
   dim largeNum                   ' variable for largest number
   dim middleNum                  ' variable for second largest number
   dim smallNum                   ' variable for smallest number

   num1 = InputBox("Please enter the first number")
   num2 = InputBox("Please enter the second number")
   num3 = InputBox("Please enter the third number")

   ' check to make sure all input are "numeric" - integer/float/double
   if IsNumeric(num1) and IsNumeric(num2) and IsNumeric(num3) then
      MsgBox "You have entered: " & num1 & " " & num2 & " " _
             & num3, vbOKOnly, "Entered Values"

      largeNum = CDbl(num1) 
      middleNum = CDbl(num2)
      smallNum = CDbl(num3)

      call compareAndSwap(largeNum, middleNum)
      call compareAndSwap(largeNum, smallNum)
      call compareAndSwap(middleNum, smallNum)

      MsgBox "The numbers sorted: " & smallNum & "  " & middleNum & "  " _
             & largeNum, vbOKOnly, "Sorted Numbers"  
   else
      MsgBox "You must enter three numbers! Try Again", vbOKOnly, _
             "Invalid Input"
   end if

   '----------------------------------------------------------------------
   ' compareAndSwap
   ' Compare num1 to num2 and swap if they are out of order.
   ' Result is that at the end of the routine, num1 is always less than num2.
   sub compareAndSwap(num1, num2)
      dim temp
      if num1 < num2 then
         temp = num1
         num1 = num2
         num2 = temp
      end if
   end sub

<h2>byValbyRef.vbs</h2>
' File: byValbyRef.vbs
' demonstrate difference between byVal parameter and byRef parameter

option explicit

dim a, b, c, d
a = 2
b = 3
c = 2
d = 3

call byValSub(a, b)
call byRefSub(c, d)

MsgBox "a = " & a & "  b = " & b & "  c = " & c & "  d = " & d

'----------------------------------------------------------------------------
' byValSub
' Parameters that are pass by value make a copy of the value passed to
' the parameter and if the parameter is changed, it is only changed
' locally, meaning within the subprogram.
SUB byValSub(ByVal num1, ByVal num2)
   num1 = 10
   num2 = 20
end SUB

'----------------------------------------------------------------------------
' byRefSub
' Parameters that are pass by reference are sent the memory address of the
' sender. If the parameter is changed, it is changed at the sending location.
SUB byRefSub(ByRef num1, ByRef num2)
   num1 = 10
   num2 = 20
end SUB

<h2>openNewExcel.vbs</h2>
' Based on code by Kelvin Sung
' File: openNewExcel.vbs
'
' Enter two numbers from the user and add them up using Microsoft Excel 
' Shows How to open an MicroSoft Excel ActiveX service through VB
 
Option Explicit                ' force variable declarations

' Excel.Document - is a predefined name for "ActiveX" services provided by Excel
' (xlAppl is our "connection" to all functions MS Excell provides)
'
' "set" -  new VBScript for us (only can "set" non-VB types, i.e., "objects")
' For example, 
'     dim num
'     set num = 123    ' is an ERROR !!!)
'
' If you forget to use "set", e.g.,
'     xlAppl = CreateObject("Excel.Application")
' it will compile, but when it runs, we'll get a run-time error:
'     "Object Required: .... "
'
' Also note that if you encounter errors after Excel is opened,
' you have to manually close the excel application 
dim xlAppl
set xlAppl = CreateObject("Excel.Application")

' We do not need to let the user see what is going on, 
' can switch the visibility on/off
xlAppl.Application.Visible = false

' Now create a new excel document to work with,
' MS Excel refers to its documents (files) as "Workbook"
dim newDocument
set newDocument = xlAppl.Application.Workbooks.Add()

' Each excel document can have many work sheets, 
' we will activate the first one and work with it ...
dim activeSheet
set activeSheet = xlAppl.Worksheets("Sheet1")

' we can use the value returned by MsgBox, to let user decide what to see
dim choice
choice = MsgBox("Do you want to look at the Excel Page?", vbYesNo)
if choice = vbYes then
   xlAppl.Application.Visible = true
end if

' now we are ready, let's enter number and add the numbers up
' for the user
'
dim num1, num2
num1 = InputBox("Please enter a number: ")
num2 = InputBox("Please enter another number: ")

' put num values in first and second rows, put sum in third row, first column
activeSheet.Cells(1, 1).Value = num1
activeSheet.Cells(2, 1).Value = num2
activeSheet.Cells(3, 1).Value = "=Sum(A1:A2)"

dim answer
answer = activeSheet.Cells(3,1).Value

MsgBox num1 & "+" & num2 & " is: " & answer
	
' When I want to quit, let me quit, do not ask me if I want to save my work
xlAppl.Application.DisplayAlerts = true

' and quit
xlAppl.Application.Quit

<h2>openOldExcel.vbs</h2>
' Based on code by Kelvin Sung
' File: openOldExcel.vbs
'
' Use Microsoft Office (mso) ActiveX service to open an existing document
'
' Open a document from user input
 
Option Explicit

' We need to go through MS Excel (or MS Office, Word is fine), the 
' application script editor, to find the value to send to the FileDialog.
' Refer to on-line help page for the details.
'
' In this case, MsoFileDialogType.msoFileDialogOpen with a value of one
' is used to open the file.
const msoFileDialogOpen = 1

dim xlAppl
set xlAppl = CreateObject("Excel.Application")

' use Microsoft Office FileDialog to open a file
dim dlgOpen          
set dlgOpen = xlAppl.Application.FileDialog(msoFileDialogOpen)

dim selectedFile
dim dlgAnswer

' only allow the selection of one file
dlgOpen.AllowMultiSelect = false

' -1 says user clicked on "Open"
if (dlgOpen.Show() = -1 ) then
   ' since we disallow multiple select, the first selected item is our file 
   selectedFile = dlgOpen.SelectedItems(1)

   ' now open the file 
   xlAppl.Application.Workbooks.Open(selectedFile)
   msgbox "selectedFile is: " & selectedFile
else
   MsgBox "No document opened!"
end if

xlAppl.Application.DisplayAlerts = false
xlAppl.Application.Quit

<h2>loopCells.vbs</h2>
' Based on code from Kelvin Sung
' File: loopCells.vbs 
' Allow the user to open an existing excel document, and access cells 

Option Explicit           'force all variables to be declared 

' Get information on the "current folder" of this script and open a connection 
' to the "operating environment". 
dim wshShell, currentFolder

' wshShell contains the environment for which we are operating in; 
' use it to retrieve the current work folder
set wshShell = WScript.CreateObject("WScript.Shell")
        
' currentFolder contains the path to the folder where this script is located
currentFolder = wshShell.CurrentDirectory

' open the the msoFileDialog with initial folder setting to the "currentFolder"
dim xlAppl
set xlAppl = CreateObject("Excel.Application")

const msoFileDialogOpen = 1
dim dlgOpen                          ' use MS Office FileDialog to open a file
set dlgOpen = xlAppl.Application.FileDialog(msoFileDialogOpen)

dim selectedFile
dim dlgAnswer

dlgOpen.AllowMultiSelect = false           ' only allow selection of one file
dlgOpen.InitialFileName = currentFolder

if (dlgOpen.Show() = -1) then              ' -1 says user clicked on "Open"
    ' the first selected item will be our file name
    selectedFile = dlgOpen.SelectedItems(1)

    ' now open the file 
    xlAppl.Application.Workbooks.Open(selectedFile)
else
    MsgBox "No document opened!"
end if

' each excel document can have many work sheets, do our work on Sheet1
dim activeSheet
set activeSheet = xlAppl.Worksheets("Sheet1")

'--------------------------------------------------------------------------
' The code to work with the spreadsheet starts here.
dim row                      ' row is row number
dim col                      ' col is column number

' activeSheet.Cells(row, col) is the cell value 
'
' For example, activeSheet.Cells(4, 6) is the cell in row 4, column 6
' The cells are strings, so convert if needed. If you do arithmetic
' with them, they are automatically converted.

' Pause to see the original spreadsheet. 
MsgBox "Notice that there is nothing in column five or six."

' Here is a loop to demonstrate. 
' The loop puts the value of variable row into each cell in rows one
' through ten, column five. It then copies column 5 to column 6.
for row = 1 to 10
   activeSheet.Cells(row, 5) = row 
   activeSheet.Cells(row, 6) = activeSheet.Cells(row, 5) 
next

' To keep the spradsheet open to allow saving 
MsgBox "The End. Click the excel closing box if you wish to save it."

'--------------------------------------------------------------------------
xlAppl.Application.DisplayAlerts = false
xlAppl.Application.Quit

<h2>openText.vbs</h2>
' Based on code by Kelvin Sung
' File: openTextFile.vbs
'
' Define a Function to use MSO FileOpenDial facility
' to help the user select a text file to open

Option Explicit

' ask the scripting runtime environemt for access to files
dim FS 
set FS = CreateObject("Scripting.FileSystemObject")

const FILEFORREADING = 1
dim dataFile
dataFile = selectAFileOrFolder("FILE")

if FS.FileExists(dataFile) then
   ' get the fileHander based on the dataFile
   dim FileHandler
   set FileHandler = FS.GetFile(dataFile)
   
   ' open the file as a inputTextStream so text data can be "streamed"
   dim inputTextStream
   set inputTextStream = FileHandler.OpenAsTextStream(FILEFORREADING)
   
   dim inputLine                         ' a line in the file
   dim lineCount                         ' number of lines in the file
   lineCount = 0

   do while not inputTextStream.AtEndOfStream 
      lineCount = lineCount + 1
      inputLine = inputTextStream.ReadLine
      MsgBox "Line " & lineCount & " content:  " & inputLine
   loop

else
   MsgBox "File: " & dataFile & " does not exists."
end if

'------------------------------------------------------------------------------
' selectAFileOrFolder
' Takes in one input parameter, "FILE" or "FOLDER", and returns its path
' in a string that contains either the selected file or folder path.
FUNCTION selectAFileOrFolder(ByRef fileOrFolder)

   dim WshShell, currentFolder

   ' Open a "connection" to the "operating environment" .
   ' WshShell contains the environment for which we are operating in.
   ' For example, below we will use it to retrieve the current working folder.
   set WshShell = WScript.CreateObject("WScript.Shell")
   
   ' Get the current folder (where this script is opened from).
   ' currentFolder now contains the path to the folder 
   currentFolder = wshShell.CurrentDirectory
   
   ' XlAppl is our "connection" to all functions MS Excel provides
   dim XlAppl
   set XlAppl = WScript.CreateObject("Excel.Application")
    
   ' don't let user see what is going on,
   ' can switch the visibility of MSon/off (TRUE/FALSE)
   XlAppl.Application.Visible = FALSE

   ' specific constants to OFFICE Object. 
   ' VBScript cannot see these constants, so we have
   ' to find out what they are, and re-define them.
   dim msoFileDialogOpen
   if (fileOrFolder = "FILE") then
      msoFileDialogOpen = 1
   end if
   if (fileOrFolder = "FOLDER") then
      msoFileDialogOpen = 4
   end if
   
   ' OpenFile Dialog we use MSO facility, since MSO is implemented in either
   ' Word, Excel, even PowerPoint. It can be used in exactly the same way. 
   ' Notice "set" is used here too.
   dim DlgOpen   
   set DlgOpen = XlAppl.Application.FileDialog(msoFileDialogOpen)

   ' Only allow selection of one file
   ' TRUE:      Allow multiple file selection
   ' FALSE:   Do not allow multiple file selection
   DlgOpen.AllowMultiSelect = FALSE
   
   ' Set up the "Filters" so that we only work with certain types of files.
   '
   ' DlgOpen.Filters.Clear
   ' DlgOpen.Filters.Add "Text Files", "*.txt", 1
   ' Only want to work with Text files
   ' The parameters of Add are:
   '    1st - description of what is the file type
   '    2nd - the extension (don't forget the "*") 
   '    3rd - the position for this entry

   ' Start looking from current working folder
   ' currentFolder contains the path to the folder where this script is located
   DlgOpen.InitialFileName = currentFolder
   
   SelectAFileOrFolder = ""             ' Set the return value to ""

   if (DlgOpen.Show() = -1) then        ' -1 says user clicked on "Open"
      ' first selected item is the file name
      SelectAFileOrFolder = DlgOpen.SelectedItems(1)
   end if
   
   ' TRUE:    Prompt user to save the work
   ' FALSE:   Do not prompt user to save the work
   XlAppl.Application.DisplayAlerts = FALSE
   
   XlAppl.Application.Quit                  ' quit the application
end FUNCTION

<h2>searchWord.vbs</h2>
' Based on code by Kelvin Sung
' File: searchWord.vbs
'
' Shows how to open a MS Word document via ActiveX.
' Ask the user for a string and search for it in the document.
'
' Uses the same MSO FileOpenDialog as used via the excel examples.

Option Explicit

' Very similar to opening an excel document.
'   dim XlAppl
'   set XlAppl = CreateObject("Excel.Application")
dim DOCAppl
set DOCAppl = CreateObject("Word.Application")

dim searchString
dim count

if (Open_OFFICE_Document(DOCAppl, "Word Files", "*.doc")) then

   searchString = "Something"
   do while searchString &lt;> ""
      searchString = InputBox("Enter the string to search [enter to quit]: ")
      if (searchString &lt;> "") then
         count =  countStringInDoc(searchString, DOCAppl)
         if (count > 0) Then
            MsgBox "String [" & searchString & "] is found in the document: " _
                   & count & " times"
         else
            MsgBox "String [" & searchString & "] is NOT found in the document"
         end if
      end if
   loop
    
   DOCAppl.Application.Documents.Close
   DOCAppl.Application.Quit
else
   DOCAppl.Application.Quit
end if


'-----------------------------------------------------------------------------
' Function Name:    countStringInDoc(ByVal searchString)
' Description:      Takes in 1 input parameter, and returns count, the
'                   number of times the string is found in the document
'
' Input Parameters: ByRef searchString,  ByRef applObj
'                      1) searchString -- the string you want to find
'                      2)   applObj -- the application object
'
' Returns Value:    INTEGER: number of times string is found

FUNCTION countStringInDoc(ByVal searchString, ByRef applObj)

   ' set up to search the entire document
   dim findRange
   set findRange = applObj.ActiveDocument.Range()

   ' program Word's search facility
   With findRange
      .Find.Text = searchString        ' assign the string to search
      .Find.Forward = TRUE             ' look in the forward direction
   end With

   dim doneSearching, count
   doneSearching = FALSE
   count = 0

   ' search through the doc, counting occurrences of searchString
   do while not doneSearching
      findRange.Find.Execute()         ' start Word searching
      if (findRange.Find.Found) then
         count = count + 1
      else
         doneSearching = TRUE          ' can't find anymore strings
      end if
   loop

   countStringInDoc = count
end FUNCTION


'-----------------------------------------------------------------------------
' Function Name: Open_OFFICE_Document(ByRef applicationObj, ByRef filterDes,
'                                     ByRef filterExt)
' Description:  Takes in 3 input parameter, and returns
'               TRUE or FALSE, whether the file is being opened.
'
'               It uses the WScript's CreateObject method to establish the 
'               connection with the "Operation Enviroment".
'
'               After setting up the "connection", use the Microsoft Office 
'               OpenFileDialog facility to open a file, through the 
'               "connection".
'
' Input Parameters: ByRef applicationObj, ByRef filterDes, ByRef filterExt
'                   1) applicationObj -- The application object
'                   2) filterDes -- file description type you want to open,
'                      pass by reference as String
'                      e.g., filterDes = "MS Word Files" to work with Word 
'                   3) filterExt -- extension of the file type to open,
'                      pass by reference as String, e.g.,
'                      filterExt = "*.ppt" to work with PowerPoint files
'
' Returns Value:    BOOLEAN, whether the file is being opened or not
' Possible Errors:  The passed in applicationObj is not created correctly
'                   The values of filterDes or filterExt are not inside 
'                   double quotations
FUNCTION Open_OFFICE_Document(ByRef applicationObj, ByRef filterDes, _
                              ByRef filterExt)

   ' Constants specific to _OFFICE_ Object. VBScript cannot see these 
   ' constants, so we have to find out what they are, and redefine them.
   const msoFileDialogOpen = 1

   ' Open a "connection" to the "operating environment" .
   ' WshShell contains the environment for which we are operating in.
   ' For example, below it is used to retrieve the current working folder. 
   dim WshShell
   set WshShell = WScript.CreateObject("WScript.Shell")

   ' OpenFile Dialog we use MSO facility, since MSO is implemented in either
   ' Word, Excel, even PowerPoint, we can use it in exactly the same way. 
   dim DlgOpen
   set DlgOpen = applicationObj.FileDialog(msoFileDialogOpen)

   With DlgOpen
      ' Notice when we want to perform multiple operations based on the
      ' same object, we can use the "With" statement. This is much more
      ' efficient (especially when dealing with ActiveX connection)
      .AllowMultiSelect = False
         ' Only allow selection of one file
         ' TRUE:    Allow multiple file selection
         ' FALSE:   Do not allow multiple file selection
      .InitialFileName = WshShell.CurrentDirectory
         ' Start looking from current working folder
         ' CurrentFolder contains the path to the folder of this script 
      .Filters.Clear                           'clear filter

      ' Set up "Filters", so that we only work with certain types of files.
      ' The parameters of Add are:
      ' 1st - description of what is the file type
      ' 2nd - the extension (don't forget the "*")
      ' 3rd - the position for this entry
      .Filters.Add filterDes, filterExt, 1
   end With

   if ( dlgOpen.Show() = -1 ) then
      ' -1 says user clicked on "Open"
      ' Since we do not allow multiple select, the first selected item 
      ' will be our file name
      dim selectedFile
      selectedFile = dlgOpen.SelectedItems(1)

      ' Open the file, can switch the visibility of MSon/off (true/false)
      ' TRUE:    Show Excel is running
      ' FALSE:   Do not show Excel is running
      applicationObj.Visible = TRUE
      
      '--------     ALTERNATIVES     --------
      Select Case filterExt
         case "*.mdb"
               ' For Access files
               applicationObj.OpenCurrentDatabase selectedFile

         case "*.ppt"
               ' For PowerPoint files
               applicationObj.Presentations.Open selectedFile

         case "*.doc"
               ' For Word files
               applicationObj.Application.Documents.Open selectedFile

         case "*.xls"
               ' For Excel files
               applicationObj.Application.Documents.Open selectedFile
      end select

      Open_OFFICE_Document = TRUE             ' set return to TRUE
   else
      'else if user did not click on "Open"
      Open_OFFICE_Document = FALSE            ' set return to FALSE
   end if

end FUNCTION

<h2>openPpt.vbs</h2>
' Based on code by Kelvin Sung
' File: openPpt.vbs
'
' Open a powerpoint file and display the text from each slide.
' The same MSO FileOpenDialog (as used with Excel) is used.

Option Explicit

' specific constants, vbScript cannot see these constants, so 
' find out what they are, and redefine them
const msoFileDialogOpen = 1

dim WshShell
set WshShell = WScript.CreateObject("WScript.Shell")
   ' For getting our operating environment (e.g. Current Working Folder)

' Very similar to word and excel, remember:
'    dim xlAppl
'    set xlAppl = CreateObject("Excel.Application")
dim pptAppl
set pptAppl = CreateObject("Powerpoint.Application")

' OpenFile Dialog uses MSO facility, since MSO is implemented in both
' Word and Excel, use it in exactly the same way. 
dim dlgOpen
set dlgOpen = pptAppl.FileDialog(msoFileDialogOpen)

if (openPPTDocument()) then
   ' PPT uses ActivePresenation whereas
   '    Word  uses ActiveDocument 
   '    Excel uses ActiveWorkbook
   ' slideShow is the entire powerpoint presentation
   dim slideShow, oneSlide
   set slideShow = pptAppl.ActivePresentation.Slides

   MsgBox "This powerpoint file has: " & slideShow.Count & " number of slides"

   dim count
   for count = 1 To slideShow.Count
      set oneSlide = slideShow.Item(count)         ' one of the slides

      dim slideSections, titleName

      ' look at how many input boxes that are defined for this slide
      set slideSections = oneSlide.Shapes

      ' find the title for this slide
      if (slideSections.HasTitle) then
         titleName = slideSections.Title.TextFrame.TextRange.Text
      else
         titleName = "HAS NO TITLE"
      end if

      dim shapeIndex, slideText
      slideText = ""
      for shapeIndex = 1 to slideSections.Count
         ' Rest of the text for this slide
         dim aSection
         set aSection = slideSections.Item(shapeIndex)
         if (aSection.HasTextFrame) then
            slideText = slideText & aSection.TextFrame.TextRange.Text & vbCrLf
         end if
      next
         
      MsgBox "Slide Number Is: " & oneSlide.SlideNumber & vbCrLf & _
             "Title is: " & titleName & vbCrLf & "Texts In This Slide: " & _
             vbCrLf & slideText
   next
      
   pptAppl.ActivePresentation.Close
   pptAppl.Quit
else
   MsgBox("No PowerPoint Document Selected, Bye Bye")
   pptAppl.Quit
end if

'-----------------------------------------------------------------------------
' FUNCTION: openPPTDocument()
'
' Input:   none (uses the global dlgOpen to let user open a .ppt document)
' Returns: none (changes the global pptAppl variable to have an opened document)
' Error:   Checks to make sure input is a number
'
'   Remark: 
FUNCTION openPPTDocument()

   with dlgOpen
      ' Notice when we want to perform multiple operations based on the
      ' same object, we can use the "with" statement. This is much more
      ' efficient (especially when dealing with ActiveX connection)
      '
      .AllowMultiSelect = FALSE
      .InitialFileName = WshShell.CurrentDirectory
      .Filters.Clear
      .Filters.Add "PowerPoint Files", "*.ppt"
      end with

   openPPTDocument = FALSE
   if (dlgOpen.Show() = -1) then
      dim selectedFile                          ' -1 says user clicked "Open"

      selectedFile = dlgOpen.SelectedItems(1)
      pptAppl.Visible = TRUE                    ' first set ppt to visible
      pptAppl.Presentations.Open selectedFile   ' now open the file 
      openPPTDocument = TRUE
   end if
end FUNCTION

<h2>pptToWord.vbs</h2>
' Based on code by Kelvin Sung
' File: pptToWord.vbs
'
' Open a powerpoint document and put all the text into a word document.

Option Explicit

' specific constants, vbScript cannot see these constants, so 
' find out what they are, and redefine them
const msoFileDialogOpen = 1

' getting the operating environment (e.g., Current Working Folder)
dim WshShell
set WshShell = WScript.CreateObject("WScript.Shell")

dim pptAppl
set pptAppl = CreateObject("Powerpoint.Application")

dim WdAppl
set WdAppl = CreateObject("Word.Application")

WdAppl.Application.Visible = FALSE

' OpenFile Dialog using MSO facility, since MSO is implemented in both
' Word and Excel, use it in exactly the same way. 
dim DlgOpen
set DlgOpen = pptAppl.FileDialog(msoFileDialogOpen)

if (OpenPPTDocument()) then

   ' Powerpoint uses ActivePresenation just as Word uses ActiveDocument 
   ' and Excel uses ActiveWorkbook.
   '
   ' slideShow is now the entire powerpoint presentation
   dim slideShow, oneSlide
   set slideShow = pptAppl.ActivePresentation.Slides

   MsgBox "This powerpoint file has: " & slideShow.Count & " number of slides"

   SavePptToWord slideShow, pptAppl.ActivePresentation.Name

   ' quit powerpoint
   pptAppl.ActivePresentation.Close
   pptAppl.Quit

   ' quit word
   WdAppl.Application.Quit
else
   MsgBox("No PowerPoint Document Selected, Bye Bye")
   pptAppl.Quit
   WdAppl.Application.Quit
end if

'----------------------------------------------------------------------------
' Function: OpenPPTDocument()
'
' Input:   none (uses the global DlgOpen to let user open a .doc document)
' Returns: none (changes the global pptAppl variable to have an opened document
' Error:   Checks to make sure input is a number
 
FUNCTION OpenPPTDocument()

   ' perform multiple operations based on the same object, so use the
   ' "with" statement. This is cleaner, especially with activeX.
   with DlgOpen
      .AllowMultiSelect = FALSE
      .InitialFileName = WshShell.CurrentDirectory
      .Filters.Clear
      .Filters.Add "PowerPoint Files", "*.ppt"
   end with

   OpenPPTDocument = FALSE
   if (dlgOpen.Show() = -1) then
      dim selectedFile                          ' -1 says user clicked "Open"
      selectedFile = dlgOpen.SelectedItems(1)
      pptAppl.Visible = TRUE                    ' set ppt to visible
      pptAppl.Presentations.Open selectedFile   ' now open the file 
      OpenPPTDocument = TRUE
   end if
end FUNCTION

'----------------------------------------------------------------------------
' SUB SavePptToWord slideShow:
'
' Creates an MS Word Doc document with from ppt slideShow content.
' It is formatted somewhat.
SUB SavePptToWord(ByRef slides, ByVal name)
   const wdToggle = 9999998
   ' create a new MS Word Doc
   dim newWdDoc
   set newWdDoc = WdAppl.Documents.Add

   dim sel
   set sel = WdAppl.Application.Selection

   WdAppl.Application.Visible = TRUE      ' get back reference for editing

   with sel
      .Style = WdAppl.Application.ActiveDocument.Styles("Heading 1")
      .TypeText "Content of the Presenation: " + name
      .TypeParagraph
      .TypeParagraph
   end with

   dim count
   for count = 1 to slides.Count
      Set oneSlide = slides.Item(count)       ' one of the slides

      ' look at how many input boxes are defined for this slide
      dim slideSections, titleName
      set slideSections = oneSlide.Shapes

      ' find the title for this slide
      if (slideSections.HasTitle) then
         titleName = slideSections.Title.TextFrame.TextRange.Text
      else
         titleName = "HAS NO TITLE"
      end if

      with sel
         .Style = WdAppl.Application.ActiveDocument.Styles("Heading 2")
         .TypeText "Slide " & Count & ": " & titleName
         .TypeParagraph
      end with

      dim shapeIndex
      for shapeIndex = 1 to slideSections.Count
         ' Rest of the text for this slide
         dim aSection
         set aSection = slideSections.Item(shapeIndex)
         if (aSection.HasTextFrame) then
            with sel
               .TypeText aSection.TextFrame.TextRange.Text 
               .TypeParagraph
            end with
         end if
      next
   next
end SUB

<h2>array.vbs</h2>
' File: array.vbs
'
' Demonstrate very basic array functionality.

Option Explicit

dim i, j                      ' to be used for subscripting arrays

dim A(10)                     ' A has 11 elements: A(0) to A(10)
for i = 0 to 6
   A(i) = 2 * i 
next

' notice there are only have 6 entries in a size 11 array
call printOneArray(A, "This is the A Array")

dim B
B = Array(11, 22, 33, 44)
' This is the same as:  dim B(3) with setting 
'    B(0) = 11
'    B(1) = 22
'    B(2) = 33
'    B(3) = 44
call printOneArray(B, "This is the B Array")

' C is a 2-dimensional array, with 3 rows and 4 columns
' The first subscript is the row, second is column, 
' e.g., C(1,2) is the element in row 1, column 2
dim C(2, 3)
for i = 0 to 2
   for j = 0 to 3
      C(i,j) = i + j 
   next
next
call printTwoDArray(C, "This is the C Array")


'----------------------------------------------------------------------------
' printOneArray
' Takes in 2 input parameters, the array to display and a string which 
' is a description of what is displayed to be used as the MsgBox title. 
' It displays the contents of the array in message box titled description.
SUB printOneArray(ByRef myArray, ByRef description)
   dim output, i
   output = ""
   For i = 0 to UBound(myArray)
      output = output & "myArray(" & i & ") = " & myArray(i) & vbNewLine
   next

   ' concatenate lower and upper bound of the array
   output = output & "Array Lower Bound: " & LBound(myArray) & vbNewLine
   output = output & "Array Upper Bound: " & UBound(myArray) & vbNewLine

   MsgBox output, ,description
end SUB


'----------------------------------------------------------------------------
' printTwoDArray
' Takes in 2 input parameters, the 2D array to display and a string which 
' is a description of what is displayed to be used as the MsgBox title. 
' It displays the contents of the array in message box titled description.
SUB printTwoDArray(ByRef myArray, ByRef description)
   dim output, i, j
   output = ""
   for i = 0 to UBound(myArray, 1)
      for j = 0 to UBound(myArray, 2)
         output = output & "myArray(" & i & "," & j &") = " & _
                            myArray(i,j) & vbNewLine
      next
      output = output & vbNewLine
   next

   ' concatenate lower and upper bound of the array
   ' second parameter of LBound or UBound is the dimension
   output = output & "Array Row Lower Bound: " & LBound(myArray, 1) & vbNewLine
   output = output & "Array Row Upper Bound: " & UBound(myArray, 1) & vbNewLine
   output = output & "Array Col Lower Bound: " & LBound(myArray, 2) & vbNewLine
   output = output & "Array Col Upper Bound: " & UBound(myArray, 2) & vbNewLine

   MsgBox output, ,description
end SUB

<h2>arrayDynamic.vbs</h2>
' File: arrayDynamic.vbs
' Demonstrate dynamic arrays. 

Option Explicit

dim A(), B()            ' A and B have no memory allocated yet

redim A(3), B(5)        ' allocate 4 elements for A, 6 elements for B

call fillArrayWithMult2(A, 0, UBound(A))
call fillArrayWithMult2(B, 0, UBound(B))
call printOneArray(A, "This is the A Array with 4 values")
call printOneArray(B, "This is the B Array with 6 values")

' redimension A to be of size 11 and display
' notice different memory is allocated and you lose all the values
' of the original array A
redim A(10)
call printOneArray(A, "This is the A Array with 10 values, redimensioned")

' fill again and display
call fillArrayWithMult2(A, 0, UBound(A))
call printOneArray(A, "This is the A Array with 10 values, redimensioned")

' preserve the values in B by using "preserve" keyword
redim preserve B(10)
call printOneArray(B, "This is the B Array with 10 values, preserved")

' can fill some or the rest of B
call fillArrayWithMult2(B, 7, 9)
call printOneArray(B, "This is the B Array with 10 values, preserved and more")


'----------------------------------------------------------------------------
' fillArrayWithMult2:
'
SUB fillArrayWithMult2(ByRef myArray, ByVal beginIndex, ByVal endIndex)
   dim i
   for i = beginIndex to endIndex
      myArray(i) = 2 * i 
   next
end SUB


'----------------------------------------------------------------------------
' printOneArray
' Takes in 2 input parameters, the array to display and a string which 
' is a description of what is displayed to be used as the MsgBox title. 
' It displays the contents of the array in message box titled description.
SUB printOneArray(ByRef myArray, ByRef description)
   dim output, i
   output = ""
   for i = 0 to UBound(myArray)
      output = output & "myArray(" & i & ") = " & myArray(i) & vbNewLine
   next

   ' concatenate lower and upper bound of the array
   output = output & "Array Lower Bound: " & LBound(myArray) & vbNewLine
   output = output & "Array Upper Bound: " & UBound(myArray) & vbNewLine

   MsgBox output, ,description
end SUB

<h2>linearSearch.vbs</h2>
' File: linearSearch.vbs
'
' Open a text file to save names into an array.
' Open another text file to save grades into another array.
' Given a name to search for, display the grade.

Option Explicit

dim names(50)                ' holds names 
dim grades(50)               ' holds grades 

dim count                    ' total number of names, subscript 0 to count-1
dim count2                   ' used for filling array with grades
count = 0
count2 = 0

' Fill the names and grades arrays with data from text files that
' are opened in the subroutine. Display the two arrays in MsgBoxes.
call fillArray(names, count)
call fillArray(grades, count2)
call printOneArray(names, "The names")
call printOneArray(grades, "The grades")

dim targetName                        ' name to search for
dim foundGrade                        ' grade associated with name 

' For each name that is entered, locate the name in the names array,
' and display the associated grade from the grades array.
do 
   targetName = inputBox("Enter a name to search for [enter to quit]")
   if targetName = "" then
      exit do
   end if

   ' search the names array for targetName and return the associated grade
   foundGrade = gradeValue(targetName, names, grades, count)
   if foundGrade &lt;> -1 then
      MsgBox(targetName & " has a grade of " & foundGrade)
   else
      MsgBox(targetName & " was not found in the list of names")
   end if
loop


'------------------------------------------------------------------------------
' gradeValue
' Given an array of names and an array of grades with the count of how 
' many are in the array, return the grade of the entered name.
' Return a -1 if the name is not found.
FUNCTION  gradeValue(ByVal targetName, ByRef names, ByRef grades, ByVal count)
   dim i, found
   i = 0
   found = FALSE                           ' have not found name yet
   gradeValue = -1

   ' Look for targetName as long as we are still within the bounds
   ' of the array and the name has not been found yet.
   do while i <= count and not found
      if names(i) = targetName then
         gradeValue = grades(i)
         found = TRUE
      end if
      i = i + 1
   loop
end FUNCTION   


'------------------------------------------------------------------------------
' fillArray
' Open a text file and read the data into an array.
' The count will be the true size of the array (number of elements in use).
SUB fillArray(ByRef myArray, ByRef count)

   ' ask the scripting runtime environemt for access to files
   dim FS 
   set FS = CreateObject("Scripting.FileSystemObject")

   const FILEFORREADING = 1
   dim dataFile
   dataFile = selectAFileOrFolder("FILE")

   if FS.FileExists(dataFile) then
      ' get the fileHander based on the dataFile
      dim FileHandler
      set FileHandler = FS.GetFile(dataFile)
   
      ' open the file as a inputTextStream so text data can be "streamed"
      dim inputTextStream
      set inputTextStream = FileHandler.OpenAsTextStream(FILEFORREADING)

      dim inputLine                         ' a line in the file

      ' As long as we're not at the end of the file, read a line from
      ' the file and place it into myArray.
      do while not inputTextStream.AtEndOfStream 
         inputLine = inputTextStream.ReadLine
         myArray(count) = inputLine 
         count = count + 1
      loop
   else
      MsgBox "File: " & dataFile & " does not exists."
   end if
end SUB


'----------------------------------------------------------------------------
' printOneArray
' Takes in 2 input parameters, the array to display and a string which 
' is a description of what is displayed to be used as the MsgBox title. 
' It displays the contents of the array in message box titled description.
SUB printOneArray(ByRef myArray, ByRef description)
   dim output, i
   output = ""
   For i = 0 to UBound(myArray)
      output = output & "myArray(" & i & ") = " & myArray(i) & vbNewLine
   next

   MsgBox output, ,description
end SUB


'------------------------------------------------------------------------------
' selectAFileOrFolder
' Takes in one input parameter, "FILE" or "FOLDER", and returns its path
' in a string that contains either the selected file or folder path.
FUNCTION selectAFileOrFolder(ByRef fileOrFolder)

   dim WshShell, currentFolder

   ' Open a "connection" to the "operating environment" .
   ' WshShell contains the environment for which we are operating in.
   ' For example, below we will use it to retrieve the current working folder.
   set WshShell = WScript.CreateObject("WScript.Shell")
   
   ' Get the current folder (where this script is opened from).
   ' currentFolder now contains the path to the folder 
   currentFolder = wshShell.CurrentDirectory
   
   ' XlAppl is our "connection" to all functions MS Excel provides
   dim XlAppl
   set XlAppl = WScript.CreateObject("Excel.Application")
    
   ' don't let user see what is going on,
   ' can switch the visibility of MSon/off (TRUE/FALSE)
   XlAppl.Application.Visible = FALSE

   ' specific constants to OFFICE Object. 
   ' VBScript cannot see these constants, so we have
   ' to find out what they are, and re-define them.
   dim msoFileDialogOpen
   if (fileOrFolder = "FILE") then
      msoFileDialogOpen = 1
   end if
   if (fileOrFolder = "FOLDER") then
      msoFileDialogOpen = 4
   end if
   
   ' OpenFile Dialog we use MSO facility, since MSO is implemented in either
   ' Word, Excel, even PowerPoint. It can be used in exactly the same way. 
   ' Notice "set" is used here too.
   dim DlgOpen   
   set DlgOpen = XlAppl.Application.FileDialog(msoFileDialogOpen)

   ' Only allow selection of one file
   ' TRUE:      Allow multiple file selection
   ' FALSE:   Do not allow multiple file selection
   DlgOpen.AllowMultiSelect = FALSE
   
   ' Set up the "Filters" so that we only work with certain types of files.
   '
   ' DlgOpen.Filters.Clear
   ' DlgOpen.Filters.Add "Text Files", "*.txt", 1
   ' Only want to work with Text files
   ' The parameters of Add are:
   '    1st - description of what is the file type
   '    2nd - the extension (don't forget the "*") 
   '    3rd - the position for this entry

   ' Start looking from current working folder
   ' currentFolder contains the path to the folder where this script is located
   DlgOpen.InitialFileName = currentFolder
   
   SelectAFileOrFolder = ""             ' Set the return value to ""

   if (DlgOpen.Show() = -1) then        ' -1 says user clicked on "Open"
      ' first selected item is the file name
      SelectAFileOrFolder = DlgOpen.SelectedItems(1)
   end if
   
   ' TRUE:    Prompt user to save the work
   ' FALSE:   Do not prompt user to save the work
   XlAppl.Application.DisplayAlerts = FALSE
   
   XlAppl.Application.Quit                  ' quit the application
end FUNCTION

<h2>names.txt</h2>
Joe
Sue
Andy
Sally
Jane
Bill
John
Mary

<h2>grades.txt</h2>
82
70
60
95
85
74
92
67


<h2>bubble.vbs</h2>

' File: bubble.vbs
'
' Sort a list of numbers using a bubble sort

Option Explicit

const MINVALUE = 0
const MAXVALUE = 1000

dim a(20)                   ' array to demonstrate bubble sort

' Initialize the random generation system of VB-script.
' After this call, Rnd will return a number between 0 and 1.
Randomize

call fillWithRandomNumbers(a, MINVALUE, MAXVALUE)
call printOneArray(a, "An unsorted array")

call bubbleSort(a)
call printOneArray(a, "A sorted array")


'----------------------------------------------------------------------------
' bubbleSort
' Sort the input array using a bubble sort
SUB bubbleSort(ByRef a())
   dim pass                               ' pass of the sort
   dim done                               ' whether sorted or not 
   dim i, temp

   pass = 0
   done = FALSE

   ' Each pass puts one element into its sorted position,
   ' smallest value bubbles to the top of the array.
   while not done 
      done = TRUE                         ' possibly sorted

      ' compare consecutive elements, swap if out of order
      for i = UBound(a) to pass+1 step -1
         if a(i) < a(i-1) then
            temp = a(i)                      ' swap a(i) and a(i-1)
            a(i) = a(i-1)
            a(i-1) = temp
            done = FALSE                     ' had to swap so still not sorted
         end if
      next
      pass = pass + 1
   wend

end SUB

'----------------------------------------------------------------------------
' printOneArray
' Takes in 2 input parameters, the array to display and a string which
' is a description of what is displayed to be used as the MsgBox title.
' It displays the contents of the array in message box titled description.
SUB printOneArray(ByRef myArray, ByRef description)
   dim output, i
   output = ""
   for i = 0 to UBound(myArray)
      output = output & "myArray(" & i & ") = " & myArray(i) & vbNewLine
   next

   MsgBox output, ,description
end SUB

'----------------------------------------------------------------------------
' RandomNumber
' Given two input parameters, a min value and max value for a range of numbers,
' it will generate and return random number between the parameter values.
FUNCTION RandomNumber(ByVal min, ByVal max)
   RandomNumber = CInt( ((max - min + 1) * Rnd) + min)
end FUNCTION

'----------------------------------------------------------------------------
' fillWithRandomNumbers
' Given an input array, fill it with random numbers generated by a
' random number generator.
SUB fillWithRandomNumbers(ByRef a, ByRef minValue, ByRef maxValue)
   dim index

   'continually generate random numbers to fill the array
   for index = 0 to UBound(a)
      a(index) = RandomNumber(minValue, maxValue)
   next
end SUB

<h2>list all available ProgIDs</h2>
The following VBScript code can be used to list all available ProgIDs:

Option Explicit

Const HKEY_CLASSES_ROOT = &H80000000

Dim arrProgID, lstProgID, objReg, strMsg, strProgID, strSubKey, subKey, subKeys()

Set lstProgID = CreateObject( "System.Collections.ArrayList" )
Set objReg    = GetObject( "winmgmts://./root/default:StdRegProv" )

' List all subkeys of HKEY_CLASSES_ROOT\CLSID
objReg.EnumKey HKEY_CLASSES_ROOT, "CLSID", subKeys

' Loop through the list of subkeys
For Each subKey In subKeys
	' Check each subkey for the existence of a ProgID
	strSubKey = "CLSID\" & subKey & "\ProgID"
	objReg.GetStringValue HKEY_CLASSES_ROOT, strSubKey, "", strProgID
	' If a ProgID exists, add it to the list
	If Not IsNull( strProgID ) Then lstProgID.Add strProgID
Next

' Sort the list of ProgIDs
lstProgID.Sort

' Copy the list to an array (this makes displaying it much easier)
arrProgID = lstProgID.ToArray

' Display the entire array
WScript.Echo Join( arrProgID, vbCrLf )



<h2>StdOut.Write</h2>
Echo text to the screen (Stdout)

Syntax 
      WScript.StdOut.Write("text string to display")
      WScript.StdOut.Write(strMyTextVariable)
Example
  Set objStdOut = WScript.StdOut
  objStdOut.Write "User: "
  objStdOut.Write "Joe Smith"
  objStdOut.WriteBlankLines(1)
  objStdOut.Write "Procurement Dept"

<h2>VBScript Do While Loop</h2>
Dim x
x=1
Do While x&lt;5
document.write("Welcome.")
x=x+1
Loop

Dim x
x=7
Do 
document.write("Welcome.")
x=x+1
Loop While x&lt;5

<h2>VBScript Do Until Loop</h2>
&lt;script type="text/vbscript">
Dim x
x=1
Do Until x=5
document.write("Welcome.")
x=x+1
Loop
&lt;/script>

<h2>VBScript While Loop</h2>
Dim x
x = 1   
While x &lt; 5   
document.write("Welcome.")
x=x+1
Wend  

<h2>VBScript For-Next Loop</h2>
For i = 1 To 5
  document.write("The number is " & i & "
")
Next

<h2>VBScript For-Step-Next Loop</h2>
For i = 1 To 5 Step 2
  document.write("The number is " & i & "&lt;br />")
Next

For i = 1 To 5 Step 2
  If i=3 Then Exit For
  document.write("The number is " & i & "&lt;br />")
Next

<h2>VBScript For-Each-Next Loop</h2>
Dim students(4)
students(0)="John"
students(1)="Hanah"
students(2)="Sarah"
students(3)="Kevin"
students(4)="Emma"

For Each x In students
  document.write(x & "&lt;br />")
Next
Dim name, length
name = InputBox("Enter your name")
length = Len(name)’Gives length of the input string

For i = 1 To length
  txt = Mid(name,i,1)'Returns a specified number of characters from a string, the first parameter is the string, second parameter is the starting position and third parameter is the number of characters to return
  If txt="a" or txt="A" or txt="e" or txt="E" or txt="i" or txt="I" or txt="o" or txt="O" or txt="u" or txt="U" Then 
  counter = counter+1
  End If
Next
document.write("Hi " & name & "!!!Your name contains " & counter & " vowels.")

<h2>Run a vbscript from another vbscript</h2>
<a href="https://stackoverflow.com/questions/1686454/run-a-vbscript-from-another-vbscript" class="whitebut ">Run a vbscript from another vbscript</a>

CreateObject("WScript.Shell").Run "Your-VBScript-Here"

Dim objShell
Set objShell = Wscript.CreateObject("WScript.Shell")
objShell.Run "TestScript.vbs" 

' Using Set is mandatory
Set objShell = Nothing

<h2>Show time</h2>
Show time in form 24 hours
Right("0" & hour(now),2) & ":" & Right("0" & minute(now),2)   = 01:35
Right("0" & hour(now),2)                                      = 01
Right("0" & minute(now),2)                                    = 35

FormatDateTime(Now)                = 2/29/2016 1:02:03 PM
FormatDateTime(Now, vbGeneralDate) = 2/29/2016 1:02:03 PM
FormatDateTime(Now, vbLongDate)    = Monday, February 29, 2016
FormatDateTime(Now, vbShortDate)   = 2/29/2016
FormatDateTime(Now, vbLongTime)    = 1:02:03 PM
FormatDateTime(Now, vbShortTime)   = 13:02
FormatDateTime(now, 4)             = 08:12

Year(Now)   = 2016
Month(Now)  = 2
Day(Now)    = 29
Hour(Now)   = 13
Minute(Now) = 2
Second(Now) = 3

Year(Date)   = 2016
Month(Date)  = 2
Day(Date)    = 29

Hour(Time)   = 13
Minute(Time) = 2
Second(Time) = 3

Function LPad (str, pad, length)
    LPad = String(length - Len(str), pad) & str
End Function

LPad(Month(Date), "0", 2)    = 02
LPad(Day(Date), "0", 2)      = 29
LPad(Hour(Time), "0", 2)     = 13
LPad(Minute(Time), "0", 2)   = 02
LPad(Second(Time), "0", 2)   = 03

Weekday(Now)                     = 2
WeekdayName(Weekday(Now), True)  = Mon
WeekdayName(Weekday(Now), False) = Monday
WeekdayName(Weekday(Now))        = Monday

MonthName(Month(Now), True)  = Feb
MonthName(Month(Now), False) = February
MonthName(Month(Now))        = February

Set os = GetObject("winmgmts:root\cimv2:Win32_OperatingSystem=@")
os.LocalDateTime = 20131204215346.562000-300
Left(os.LocalDateTime, 4)    = 2013 ' year
Mid(os.LocalDateTime, 5, 2)  = 12   ' month
Mid(os.LocalDateTime, 7, 2)  = 04   ' day
Mid(os.LocalDateTime, 9, 2)  = 21   ' hour
Mid(os.LocalDateTime, 11, 2) = 53   ' minute
Mid(os.LocalDateTime, 13, 2) = 46   ' second

Dim wmi : Set wmi = GetObject("winmgmts:root\cimv2")
Set timeZones = wmi.ExecQuery("SELECT Bias, Caption FROM Win32_TimeZone")
For Each tz In timeZones
    tz.Bias    = -300
    tz.Caption = (UTC-05:00) Eastern Time (US & Canada)
Next

<h2>inputbox</h2>
dim v
v = inputbox ("what is ur name?")
msgbox " hello, " & v
beep

to beep multiple times
Beeep(3)

Sub Beeep(itimes)
dim itemp
For itemp = 1 to itimes
beep
next
end sub



<h2>Play a beep in VBS</h2>
From Windows Scripting Host you can do either one of the below:

Set Shell = CreateObject("WScript.Shell")
Shell.Run "sndrec32 /play /close %windir%\media\ding.wav",0

or
Set Shell = CreateObject("WScript.Shell")
Shell.Run "%comspec% /cecho " & Chr(7),0

or
strSoundFile = “C:\Windows\Media\Notify.wav”
Set objShell = CreateObject(“Wscript.Shell”)
strCommand = “sndrec32 /play /close ” & chr(34) & strSoundFile & chr(34)
objShell.Run strCommand, 0, True


To run Sound Recorder from the command-prompt, we need to type in this command:
sndrec32 /play /close “C:\Windows\Media\Notify.wav”

Sample script that plays a sound and pops up a message box:

strSoundFile = “C:\windows\Media\Notify.wav”
Set objShell = CreateObject(“Wscript.Shell”)
strCommand = “sndrec32 /play /close ” & chr(34) & strSoundFile & chr(34)
objShell.Run strCommand, 0, False
Wscript.Sleep 1000
Msgbox “A problem has occurred.”

<h2>vbs call external program with parameters</h2>
Set WshShell = CreateObject("WScript.Shell")
WshShell.Exec("C:\Program Files\App\start.exe -resexport -r C:\test.txt")    

Set ss = CreateObject("WScript.Shell")
ss.run "COMMAND /C C:\util\pkzip.exe a:master02.zip",1,TRUE

Set WshShell = WScript.CreateObject("WScript.Shell")
runCmd = "%systemroot%\system32\servermanagercmd.exe -install SNMP-Service"
WshShell.Run "cmd /c " & runCmd, 0, True

The following VBScript code opens a copy of the currently running script with Notepad.

Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.Run "%windir%\notepad " & WScript.ScriptFullName

Set WshShell = WScript.CreateObject("WScript.Shell")
Return = WshShell.Run("notepad " & WScript.ScriptFullName, 1, true)

Dim oShell
Set oShell = WScript.CreateObject ("WSCript.shell")
oShell.run "cmd /K CD C:\ & Dir"
Set oShell = Nothing

<h2>play sound</h2>
Dim oPlayer
Set oPlayer = CreateObject("WMPlayer.OCX")

oPlayer.URL = "C:\Windows\Media\Notify.wav"
oPlayer.controls.play 
While oPlayer.playState &lt;> 1 ' 1 = Stopped
  WScript.Sleep 100
Wend

oPlayer.URL = "C:\Windows\Media\recycle.wav"
While oPlayer.playState &lt;> 1 ' 1 = Stopped
  WScript.Sleep 100
Wend

oPlayer.close

<h2>call R script from VB Script</h2>

Dim oShell As Object
    Set oShell = CreateObject("WScript.Shell")

    Dim oExec As Object
    Dim oOutput As Object
    Set oExec = oShell.Exec("C:\Program Files\R\R-3.2.3\bin\Rscript.exe C:\SubFolder\YourScriptName.R " & "" & var1 & "")
    Set oOutput = oExec.StdOut

    "handle the results as they are written to and read from the StdOut object"
    Dim s As String
    Dim sLine As String
    While Not oOutput.AtEndOfStream
        sLine = oOutput.ReadLine
        If sLine &lt;> "" Then s = s & sLine & vbCrLf
    Wend

Above code also showing how to pass arguments to Rscript.
If your Rscript returns value it will return to vbscript again.

<h2>Calling MPlayer</h2>
Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.Run """c:\mplayer.exe"" ""I:\DVCapture\video.avi"""

<h2>Video Downloader</h2>
<a href="https://catonmat.net/writing-a-youtube-video-downloader-in-vbscript" class="whitebut ">Writing a YouTube Video Downloader</a>

<h2>use of input box and speak message</h2>
Dim message, sapi
message = InputBox("What do you want me to say?","Made by Candy")
Set sapi=CreateObject("sapi.spvoice")
sapi.Speak message

Dim text, speech
text = "High critical limit"
Set speech = CreateObject("SAPI.SpVoice")
speech.Speak text

<h2>Converting alarm/event text to speech</h2>
https://www.reliance-scada.com/en/support/articles/technical/vbscript-tip-converting-alarm-event-text-to-speech

<h2>VBScript to run .bat file</h2>
Set shell = CreateObject("WScript.Shell")
shell.CurrentDirectory = "C:\Users\js\Desktop\createIndex"
shell.Run "createindex.bat"

https://stackoverflow.com/questions/34820685/want-to-use-vbscript-to-run-bat-file-in-a-different-folder

<h2>speak the time</h2>
Dim speech, hr, sez
hr=hour(time)
if hr=0 then
    hr = 12
end if
if hr>12 then
   hr = hr - 12
end if
sez = hr & " O'clock"
Set speech = CreateObject("sapi.spvoice")
speech.Speak sez
Wscript.Quit


<h2>print random number</h2>
Sub randomAnum()
  nLow = 1
  nHigh = 100
  Randomize
  msgbox Int((nHigh - nLow + 1) * Rnd + nLow)
End Sub
randomAnum()

<h2>randomly play a sound</h2>
Randomize
With CreateObject("WMPlayer.OCX")
    .URL = "C:\Users\User\Music\freesound\" & Int(Rnd * 2027)) & ".mp3"
    .controls.play 
    Do While .playState &lt;> 1
        WScript.Sleep 100
    Loop
    .close
End With

<h2>Regular Expressions</h2>
Regular Expressions is a sequence of characters that forms a pattern, which is mainly used for search and replace. The purpose of creating a pattern is to match specific strings, so that the developer can extract characters based on conditions and replace certain characters.

RegExp Object
RegExp object helps the developers to match the pattern of strings and the properties and methods help us to work with Regular Expressions easily. It is similar to RegExp in JavaScript

Properties
Pattern − The Pattern method represents a string that is used to define the regular expression and it should be set before using the regular expression object.

IgnoreCase − A Boolean property that represents if the regular expression should be tested against all possible matches in a string if true or false. If not specified explicitly, IgnoreCase value is set to False.

Global − A Boolean property that represents if the regular expression should be tested against all possible matches in a string. If not specified explicitly, Global value is set to False.

Methods
Test(search-string) − The Test method takes a string as its argument and returns True if the regular expression can successfully be matched against the string, otherwise False is returned.

Replace(search-string, replace-string) − The Replace method takes 2 parameters. If the search is successful then it replaces that match with the replace-string, and the new string is returned. If there are no matches then the original search-string is returned.

Execute(search-string) − The Execute method works like Replace, except that it returns a Matches collection object, containing a Match object for each successful match. It doesn't modify the original string.

Matches Collection Object
The Matches collection object is returned as a result of the Execute method. This collection object can contain zero or more Match objects and the properties of this object are read-only.

Count − The Count method represents the number of match objects in the collection.

Item − The Item method enables the match objects to be accessed from matches collections object.

Match Object
The Match object is contained within the matches collection object. These objects represent the successful match after the search for a string.

FirstIndex − It represents the position within the original string where the match occurred. This index are zero-based which means that the first position in a string is 0.

Length − A value that represents the total length of the matched string.

Value − A value that represents the matched value or text. It is also the default value when accessing the Match object.

All about Pattern Parameter
The pattern building is similar to PERL. Pattern building is the most important thing while working with Regular Expressions. In this section, we will deal with how to create a pattern based on various factors.

Position Matching
The significance of position matching is to ensure that we place the regular expressions at the correct places.

Symbol	Description
^	Matches only the beginning of a string.
$	Match only the end of a string.
\b	Matches any word boundary
\B	Matches any non-word boundary
Literals Matching
Any form of characters such as alphabet, number or special character or even decimal, hexadecimal can be treated as a Literal. Since few of the characters have already got a special meaning within the context of Regular Expression, we need to escape them using escape sequences.

Symbol	Description
Alphanumeric	Matches alphabetical and numerical characters only.
\n	Matches a new line.
\[	Matches [ literal only
\]	Matches ] literal only
\(	Matches ( literal only
\)	Matches ) literal only
\t	Matches horizontal tab
\v	Matches vertical tab
\|	Matches | literal only
\{	Matches { literal only
\}	Matches } literal only
\\	Matches \ literal only
\?	Matches ? literal only
\*	Matches * literal only
\+	Matches + literal only
\.	Matches . literal only
\b	Matches any word boundary
\B	Matches any non-word boundary
\f	Matches a form feed
\r	Matches carriage return
\xxx	Matches the ASCII character of an octal number xxx.
\xdd	Matches the ASCII character of an hexadecimal number dd.
\uxxxx	Matches the ASCII character of an UNICODE literal xxxx.
Character Classes Matching
The character classes are the Pattern formed by customized grouping and enclosed within [ ] braces. If we are expecting a character class that should not be in the list, then we should ignore that particular character class using the negative symbol, which is a cap ^.

Symbol	Description
[xyz]	Match any of the character class enclosed within the character set.
[^xyz]	Matches any of the character class that are NOT enclosed within the character set.
.	Matches any character class except \n
\w	Match any word character class. Equivalent to [a-zA-Z_0-9]
\W	Match any non-word character class. Equivalent to [^a-zA-Z_0-9]
\d	Match any digit class. Equivalent to [0-9].
\D	Match any non-digit character class. Equivalent to [^0-9].
\s	Match any space character class. Equivalent to [ \t\r\n\v\f]
\S	Match any space character class. Equivalent to [^\t\r\n\v\f]
Repetition Matching
Repetition matching allows multiple searches within the regular expression. It also specifies the number of times an element is repeated in a Regular Expression.

Symbol	Description
*	Matches zero or more occurrences of the given regular Expression. Equivalent to {0,}.
+	Matches one or more occurrences of the given regular Expression. Equivalent to {1,}.
?	Matches zero or one occurrences of the given regular Expression. Equivalent to {0,1}.
{x}	Matches exactly x number of occurrences of the given regular expression.
{x,}	Match atleast x or more occurrences of the given regular expression.
{x,y}	Matches x to y number of occurences of the given regular expression.
Alternation & Grouping
Alternation and grouping helps developers to create more complex Regular Expressions in particularly handling intricate clauses within a Regular Expression which gives a great flexibility and control.

Symbol	Description
0	Grouping a clause to create a clause. "(xy)?(z)" matches "xyz" or "z".
|	Alternation combines one regular expression clause and then matches any of the individual clauses. "(ij)|(23)|(pq)" matches "ij" or "23" or "pq".
Building Regular Expressions
Given below are a few examples that clearly explain how to build a Regular Expression.

Regular Expression	Description
"^\s*.." and "..\s*$"	Represents that there can be any number of leading and trailing space characters in a single line.
"((\$\s?)|(#\s?))?"	Represents an optional $ or # sign followed by an optional space.
"((\d+(\.(\d\d)?)?))"	Represents that at least one digit is present followed by an optional decimals and two digits after decimals.

<h2>Regular Expressions Example</h2>
strid = "welcome.user@tutorialspoint.co.us"
Set re = New RegExp
With re
   .Pattern    = "^[\w-\.]{1,}\@([\da-zA-Z-]{1,}\.){1,}[\da-zA-Z-]{2,3}$"
   .IgnoreCase = False
   .Global     = False
End With
        
' Test method returns TRUE if a match is found
If re.Test( strid ) Then
   Document.write(strid & " is a valid e-mail address")
Else
   Document.write(strid & " is NOT a valid e-mail address")
End If
        
Set re = Nothing

<h2>VB scripts samples</h2>
<a href="https://www.vbsedit.com/scripts/" class="whitebut ">VB scripts samples</a>

<h2>Option Explicit</h2>
Use Option Explicit to generate an error whenever a variable that has not been declared is encountered.

The Option Explicit statement must appear in a script before any other statements; otherwise, a nontrappable error occurs.

Where Option Explicit is used, all variables must be declared using the Dim, Private, Public, or ReDim statements.

<h2>vbs calculator</h2>
Dim strResult: strResult = Wscript.ScriptName
Dim strExpr, strInExp, strLastY, yyy
strInExp = "1+1"
strLastY = ""
Do While True

  strExpr = inputbox("Last calculation:" & vbCR & strLastY, "Calculator", strInExp)

  If Len( strExpr) = 0 Then Exit Do 

  ''' in my locale, decimal separator is a comma but VBScript arithmetics premises a dot  
  strExpr = Replace( strExpr, ",", ".")   ''' locale specific

  On Error Resume Next             ' enable error handling
  yyy = Eval( strExpr)
  If Err.Number = 0 Then
    strInExp = CStr( yyy)
    strLastY = strExpr & vbTab & strInExp
    strResult = strResult & vbNewLine & strLastY
  Else
    strLastY = strExpr & vbTab & "!!! 0x" & Hex(Err.Number) & " " & Err.Description
    strInExp = strExpr
    strResult = strResult & vbNewLine & strLastY
  End If
  On Error GoTo 0                  ' disable error handling
Loop

Wscript.Echo strResult
Wscript.Quit

<h2>Creating and writing lines to a file</h2>
Set objFSO=CreateObject("Scripting.FileSystemObject")

' How to write file
outFile="c:\test\autorun.inf"
Set objFile = objFSO.CreateTextFile(outFile,True)
objFile.Write "test string" & vbCrLf
objFile.Close

'How to read a file
strFile = "c:\test\file"
Set objFile = objFS.OpenTextFile(strFile)
Do Until objFile.AtEndOfStream
    strLine= objFile.ReadLine
    Wscript.Echo strLine
Loop
objFile.Close

'to get file path without drive letter, assuming drive letters are c:, d:, etc
strFile="c:\test\file"
s = Split(strFile,":")
WScript.Echo s(1)

<h2>Read files from URL</h2>
url = "http://main/shared/css/main.css"

Set req = CreateObject("Msxml2.XMLHttp.6.0")
req.open "GET", url, False
req.send

If req.Status = 200 Then
  Set fso = CreateObject("Scripting.FileSystemObject")
  fso.OpenTextFile("C:\main.txt", 2).Write req.responseText
End If

<h2>Run a vbscript from another vbscript</h2>
Dim oShell 
Set oShell = Wscript.CreateObject("WScript.Shell")
oShell.Run "name_of_vbs_file_here.vbs"   
Set oShell = Nothing 


Dim objShell
Set objShell = Wscript.CreateObject("WScript.Shell")
objShell.Run "TestScript.vbs" 
' Using Set is mandatory
Set objShell = Nothing


Send 3 arguments like this:
objShell.Run "TestScript.vbs 42 ""an arg containing spaces"" foo" 

Using the Wshshell.Run method or the WshShell.Exec method give you control to terminate it, get a response, pass more parameters (other than commandline args), get status, and others

To use Run (Simple Method)

Dim ProgramPath, WshShell, ProgramArgs, WaitOnReturn,intWindowStyle
Set WshShell=CreateObject ("WScript.Shell")
ProgramPath="c:\test run script.vbs"
ProgramArgs="/hello /world"
intWindowStyle=1
WaitOnReturn=True
WshShell.Run Chr (34) & ProgramPath & Chr (34) & Space (1) & ProgramArgs,intWindowStyle, WaitOnReturn

To Use EXEC (Advanced Method)

Dim ProgramPath, WshShell, ProgramArgs, Process, ScriptEngine
Set WshShell=CreateObject ("WScript.Shell")
ProgramPath="c:\test run script.vbs"
ProgramArgs="/hello /world"
ScriptEngine="CScript.exe"
Set Process=WshShell.Exec (ScriptEngine & space (1) & Chr(34) & ProgramPath & Chr (34) & Space (1) & ProgramArgs)
Do While Process.Status=0
    'Currently Waiting on the program to finish execution.
    WScript.Sleep 300
Loop

<h2>load the body of the script and execute it within the same process</h2>
Set fs = CreateObject("Scripting.FileSystemObject")
Set ts = fs.OpenTextFile("script2.vbs")
body = ts.ReadAll
ts.Close
Execute body

<h2>VBScript RegExp</h2>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-regexp.html" class="whitebut ">VBScript RegExp</a>


use vbNewLine, vbTab and vbCrLf instead of \n\r\t when you use replace like: newLine = re.Replace(oldLine, vbTab) ( < this is what you'd use if you want to replace 4 spaces with a Tab for example), while you should use the escaped characters in the pattern like re.Pattern = "\t"

Examples

'this sub finds the matches
Sub RegExpTest(strMatchPattern, strPhrase)
'create variables
Dim objRegEx, Match, Matches, StrReturnStr
'create instance of RegExp object
Set objRegEx = New RegExp
'find all matches
objRegEx.Global = True
'set case insensitive
objRegEx.IgnoreCase = True
'set the pattern
objRegEx.Pattern = strMatchPattern
'create the collection of matches
Set Matches = objRegEx.Execute(strPhrase)
'print out all matches
For Each Match in Matches
strReturnStr = "Match found at position "
strReturnStr = strReturnStr Match.FirstIndex ". Match
Value is '"
strReturnStr = strReturnStr Match.value "'."
'print
Response.Write(strReturnStr "<BR>")
Next
End Sub
'call the subroutine
RegExpTest "is.", "Is1 is2 Is3 is4"
%>
Output:
Match found at position 0. 
Match Value is 'Is1'. 
Match found at position 4. 
Match Value is 'is2'. 
Match found at position 8. 
Match Value is 'Is3'. 
Match found at position 12. 
Match Value is 'is4'.

<h2>MsgBox</h2>
MsgBox(prompt[,buttons][,title][,helpfile,context])

Prompt − A Required Parameter. 
A String that is displayed as a message in the dialog box. 
The maximum length of prompt is approximately 1024 characters. 
If the message extends to more than a line, then we can separate the lines using a carriage return character (Chr(13)) or a linefeed character (Chr(10)) between each line.

buttons − An Optional Parameter. 
A Numeric expression that specifies the type of buttons to display, the icon style to use, the identity of the default button, and the modality of the message box. 
If left blank, the default value for buttons is 0.

Title − An Optional Parameter. 
A String expression displayed in the title bar of the dialog box. 
If the title is left blank, the application name is placed in the title bar.

helpfile − An Optional Parameter. 
A String expression that identifies the Help file to use to provide context-sensitive help for the dialog box.

context − An Optional Parameter. 
A Numeric expression that identifies the Help context number assigned by the Help author to the appropriate Help topic. 
If context is provided, helpfile must also be provided.

The Buttons parameter can take any of the following values −
0 vbOKOnly Displays OK button only.
1 vbOKCancel Displays OK and Cancel buttons.
2 vbAbortRetryIgnore Displays Abort, Retry, and Ignore buttons.
3 vbYesNoCancel Displays Yes, No, and Cancel buttons.
4 vbYesNo Displays Yes and No buttons.
5 vbRetryCancel Displays Retry and Cancel buttons.
16 vbCritical Displays Critical Message icon.
32 vbQuestion Displays Warning Query icon.
48 vbExclamation Displays Warning Message icon.
64 vbInformation Displays Information Message icon.

0 vbDefaultButton1 First button is default.
256 vbDefaultButton2 Second button is default.
512 vbDefaultButton3 Third button is default.
768 vbDefaultButton4 Fourth button is default.
0 vbApplicationModal Application modal. 

The current application will not work until the user responds to the message box.
4096 vbSystemModal System modal. 
All applications will not work until the user responds to the message box.

The above values are logically divided into four groups: 
The first group(0 to 5) indicates the buttons to be displayed in the message box. 
The second group (16, 32, 48, 64) describes the sytle of the icon to be displayed, the third group (0, 256, 512, 768) indicates which button must be the default, and the fourth group (0, 4096) determines the modality of the message box.

Return Values
The MsgBox function can return one of the following values −
1 - vbOK - OK was clicked
2 - vbCancel - Cancel was clicked
3 - vbAbort - Abort was clicked
4 - vbRetry - Retry was clicked
5 - vbIgnore - Ignore was clicked
6 - vbYes - Yes was clicked
7 - vbNo - No was clicked

Example
   MsgBox("Welcome")    
   a = MsgBox("Do you like blue color?",3,"Choose options")
   document.write("The Value of a is " & a)

When the above script is executed, the message box is displayed, and if you press No Button, then the value of a is 7.

The Value of a is 7

<h2>InputBox</h2>

The InputBox function helps the user to get the values from the user. 
After entering the values, if the user clicks the OK button or presses ENTER on the keyboard, the InputBox function will return the text in the text box. 
If the user clicks on the Cancel button, the function will return an empty string ("").

Syntax
InputBox(prompt[,title][,default][,xpos][,ypos][,helpfile,context])
Parameter Description
Prompt − A Required Parameter. 
A String that is displayed as a message in the dialog box. 
The maximum length of prompt is approximately 1024 characters. 
If the message extends to more than a line, then we can separate the lines using a carriage return character (Chr(13)) or a linefeed character (Chr(10)) between each line.

Title − An Optional Parameter. 
A String expression displayed in the title bar of the dialog box. 
If the title is left blank, the application name is placed in the title bar.

Default − An Optional Parameter. 
A default text in the text box that the user would like to be displayed.

XPos − An Optional Parameter. 
The Position of X axis which represents the prompt distance from left side of the screen horizontally. 
If left blank, the input box is horizontally centered.

YPos − An Optional Parameter. 
The Position of Y axis which represents the prompt distance from left side of the screen Vertically. 
If left blank, the input box is Vertically centered.

helpfile − An Optional Parameter. 
A String expression that identifies the Help file to use to provide context-sensitive Help for the dialog box.

context − An Optional Parameter. 
A Numeric expression that identifies the Help context number assigned by the Help author to the appropriate Help topic. 
If context is provided, helpfile must also be provided.

Example

InputBox("Enter a number")
a = InputBox("Enter a Number","Enter Value")
msgbox a
a = InputBox("Enter a Number","Enter Value",123)
msgbox a
a = InputBox("Enter your name","Enter Value",123,700)
msgbox a
a = InputBox("Enter your name","Enter Value",123,,500)
msgbox a

<h2>display an image</h2>
Create a VBS file:
Set objExplorer = CreateObject("InternetExplorer.Application")
With objExplorer
    .Navigate "about:blank"
    .Visible = 1
    .Document.Title = "Show Image"
    .Toolbar=False
    .Statusbar=False
    .Top=400
    .Left=400
    .Height=200
    .Width=200
    .Document.Body.InnerHTML = "&lt;img src='C:\Users\pankaj\Desktop\a.jpg'>"
End With

<h2>VBS call chrome</h2>
Dim objShell
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run "https://www.youtube.com/watch?v=nIpPSh4h_AA"

OR:
Dim URL, theShell
URL = "D:/Dropbox/Public/start20120304.htm"

set theShell = CreateObject("Shell.Application")
theShell.ShellExecute "chrome.exe", URL, "", "", 1


<h2>Shell.Application</h2>
The wscript.Shell + Shell.Application objects
Provides access to OS Shell methods.

<h3>Wscript.Shell</h3> Syntax 
      Set objShell = CreateObject("Wscript.Shell") 

Methods
   .AppActivate      'Activate running command.
   .Run              'Run an application
   .TileVertically   'Tile app windows
   .RegRead          'Read from registry
   .RegDelete        'Delete from registry
   .RegWrite         'Write to the registry

<h3>Shell.Application</h3>Syntax 
      Set objShell = CreateObject("Shell.Application")

Methods
   .CanStartStopService("ServiceName")   'Can the current user start/stop the named service?
   .CascadeWindows      'Arrange app windows
   .EjectPC             'Eject PC from a docking station
   .Explore(FolderPath) 'Open a folder
   .FileRun             'Open the File-run dialogue
   .GetSystemInformation("PhysicalMemoryInstalled")  'Physical memory installed, in bytes.
   .IsServiceRunning("ServiceName")  'Check if a Windows service is running
   .MinimizeAll         'Minimize everything
   .NameSpace("C:\\")   'Create an object reference to a folder
   .ServiceStart("ServiceName", true)  'Start a windows service
   .ServiceStop("ServiceName", true)   'Stop a windows service
   .SetTime             'Open the set time GUI
   .ShellExecute        'Run a script or application
   .ShutdownWindows
   .TileHorizontally   'Tile app windows
   .TileVertically     'Tile app windows
   .ToggleDesktop      'Show/Hide Desktop
   .TrayProperties     'Display the Taskbar/Start Menu Properties
   .UndoMinimizeAll    'Un-Minimize everything

Example

Dim objShell
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run "C:\Demo"
Set objShell = Nothing

Dim objShell
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run "https://www.youtube.com/watch?v=nIpPSh4h_AA"



<h2>An A-Z Index of Windows VBScript commands</h2>
<a href="https://ss64.com/vb/abs.html">Abs</a>(<i>number</i>)     Absolute (positive) value of <i>number</i>
<a href="https://ss64.com/vb/appactivate.html">.AppActivate</a>     Activate running command
<a href="https://ss64.com/vb/application.html">.Application</a>     BrowseForFolder/Open
<a href="https://ss64.com/vb/array.html">Array</a>(<i>el1,el2,el3</i>)   Add values to an Array variable
<a href="https://ss64.com/vb/arguments.html">Arguments</a>       Command line arguments
<a href="https://ss64.com/vb/asc.html">Asc</a>(<i>String</i>)     Return ASCII code for <i>string</i>
<a href="https://ss64.com/vb/ascb.html">AscB</a>(<i>String</i>)    Return the byte code for a character
<a href="https://ss64.com/vb/ascw.html">AscW</a>(<i>String</i>)    Return Unicode code for <i>string</i>
b
Beep - see <a href="https://ss64.com/vb/stdoutwrite.html">StdOut.Write</a>
<a href="https://ss64.com/vb/browseforfolder.html">.BrowseForFolder</a> Prompt the user to select a folder
c
Call <i>subroutine </i>(<i>arguments</i>) <span class="body">or </span><i> subroutine arguments</i>
<a href="https://ss64.com/vb/cbool.html">CBool</a>(<i>expression</i>)  Convert <i>expression</i> to Boolean (True/False) •
<a href="https://ss64.com/vb/cbyte.html">CByte</a>(<i>expression</i>)  Convert <i>expression</i> to Byte (0-255) •
<a href="https://ss64.com/vb/ccur.html">CCur</a>(<i>expression</i>)   Convert <i>expression</i> to Currency (numeric) •
<a href="https://ss64.com/vb/cdate.html">CDate</a>(<i>expression</i>)  Convert <i>expression</i> to Date •
<a href="https://ss64.com/vb/cdbl.html">CDbl</a>(<i>expression</i>)   Convert <i>expression</i> to Double (up to 1.79x10<sup>308</sup>) •
<a href="https://ss64.com/vb/chr.html">Chr</a>(<i>ChrCode</i>)       Return the string character for <i>ChrCode</i> (ASCII code)
<a href="https://ss64.com/vb/chrb.html">ChrB</a>(<i>ChrCode</i>)      Return the string character for <i>ChrCode</i> (Byte code)
<a href="https://ss64.com/vb/chrw.html">ChrW</a>(<i>ChrCode</i>)      Return the string character for <i>ChrCode</i> (Unicode/DBCS)
<a href="https://ss64.com/vb/cint.html">CInt</a>(<i>expression</i>)   Convert <i>expression</i> to Integer •
<a href="https://ss64.com/vb/clng.html">CLng</a>(<i>expression</i>)   Convert <i>expression</i> to long •
<a href="https://ss64.com/vb/csng.html">CSng</a>(<i>expression</i>)   Convert <i>expression</i> to single •
<a href="https://ss64.com/vb/cstr.html">CStr</a>(<i>expression</i>)   Convert <i>expression</i> to a string •
<a href="https://ss64.com/vb/createobject.html">.CreateObject</a>     Create an automation object / run an external command
<a href="https://ss64.com/vb/shortcut.html">.CreateShortcut</a>   Create Shortcut
<a href="https://ss64.com/vb/cscript.html">cscript</a>          Run a VBScript .vbs file
<a href="https://ss64.com/vb/cd.html">.CurrentDirectory</a> Retrieve or change the current directory
d
<a href="https://ss64.com/vb/date.html">Date</a>()         The current system date
<a href="https://ss64.com/vb/dateadd.html">DateAdd</a>        Add a time interval to a Date
<a href="https://ss64.com/vb/datediff.html">DateDiff</a>       Return the time interval between two dates
<a href="https://ss64.com/vb/datepart.html">DatePart</a>       Return part of a given date
<a href="https://ss64.com/vb/dateserial.html">DateSerial</a>     Return a Date from a numeric Year, Month and Day
<a href="https://ss64.com/vb/datevalue.html">DateValue</a>      Return a Date from a string expression 
<a href="https://ss64.com/vb/day.html">Day</a>(<i>date</i>)      Return the day component of <i>date</i> (1-31)
<a href="https://ss64.com/vb/dim.html">Dim</a>            Declare a new variable or array variable
<a href="https://ss64.com/vb/do.html">Do..Loop</a>       Repeat a block of statements
<a href="https://ss64.com/vb/filesystemobject.html">Drives</a>
Drive Map     <a href="https://ss64.com/vb/mapnetworkdrive.html">.MapNetworkDrive</a> - <a href="https://ss64.com/vb/enumnetworkdrives.html">.Enum </a>- <a href="https://ss64.com/vb/removenetworkdrive.html">.Remove</a>
e
<a href="https://ss64.com/vb/echo.html">.Echo</a>           Echo text to screen, also <a href="https://ss64.com/vb/stdoutwrite.html">StdOut.Write</a> /<a href="https://ss64.com/vb/popup.html">.Popup</a>
End            End a procedure or code block
<a href="https://ss64.com/vb/env.html">Environment Variables</a>  - <a href="https://ss64.com/vb/envexpand.html">Expand</a> - <a href="https://ss64.com/vb/envrm.html">.Delete/Remove</a>
<a href="https://ss64.com/vb/escape.html">Escape</a>(<i>String</i>) Return only ASCII characters from a Unicode string.
<a href="https://ss64.com/vb/eval.html">Eval</a>(<i>expr</i>)     Evaluate an expression
<a href="https://ss64.com/vb/exec.html">.Exec</a>           Run a command
<a href="https://ss64.com/vb/execute.html">Execute</a>        Execute one or more  statements
<a href="https://ss64.com/vb/exp.html">Exp</a>(<i>n</i>)         Return e (base of natural logs) raised to a power <i>n</i>.
<a href="https://ss64.com/vb/exit.html">Exit</a>           Exit a block of code immediately
f
<a href="https://ss64.com/vb/filesystemobject.html">FileSystemObject</a> Work with Drives, Folders and Files
<a href="https://ss64.com/vb/filter.html">Filter</a>         Produce an array by filtering an existing array
<a href="https://ss64.com/vb/fix.html">Fix</a>(<i>number</i>)    Return the integer portion of a number
<a href="https://ss64.com/vb/for.html">For...Next</a>     Repeat a block of statements a given number of times
<a href="https://ss64.com/vb/foreach.html">For Each...</a>    Loop through the items in a collection or array
<a href="https://ss64.com/vb/formatcurrency.html">FormatCurrency</a> Format a number with a currency symbol
<a href="https://ss64.com/vb/formatnumber.html">FormatNumber</a>   Format a number
<a href="https://ss64.com/vb/formatpercent.html">FormatPercent</a>  Format a number with a % symbol
<a href="https://ss64.com/vb/formatdatetime.html">FormatDateTime</a> Format a Date/Time value
<a href="https://ss64.com/vb/function.html">Function</a>       Define a function procedure
g
<a href="https://ss64.com/vb/getlocale.html">GetLocale</a>()    Return the Regional <a href="https://ss64.com/vb/../locale.html">LocaleID</a>
<a href="https://ss64.com/vb/getobject.html">.GetObject</a>      Get an Automation object
h
<a href="https://ss64.com/vb/hex.html">Hex</a>(<i>number</i>)    Return the hex value of <i>number</i>
<a href="https://ss64.com/vb/hour.html">Hour</a>(<i>time</i>)     Return the hour component of <i>time</i>
i
<a href="https://ss64.com/vb/if.html">If..Then</a>       Conditionally execute a block of statements
<a href="https://ss64.com/vb/inputbox.html">InputBox</a>       Prompt for user input
<a href="https://ss64.com/vb/instr.html">InStr</a>          Find one string within another
<a href="https://ss64.com/vb/instrrev.html">InStrRev</a>       Find one string within another, starting from the end
<a href="https://ss64.com/vb/int.html">Int</a>(<i>number</i>)    Return the integer portion of a number
<a href="https://ss64.com/vb/isarray.html">IsArray</a>(<i>varname</i>)      Is varname an array?
<a href="https://ss64.com/vb/../access/isdate.html">IsDate</a>(<i>expression</i>)    Is <i>expression</i> a DateTime? 
<a href="https://ss64.com/vb/isempty.html">IsEmpty</a>(<i>expression</i>)   Is <i>expression</i> initialised?
<a href="https://ss64.com/vb/isnull.html">IsNull</a>(<i>expression</i>)    Is <i>expression</i> NULL?
<a href="https://ss64.com/vb/isnumeric.html">IsNumeric</a>(<i>expression</i>) Is <i>expression</i> a Numeric? 
<a href="https://ss64.com/vb/isobject.html">IsObject</a>(<i>expression</i>)  Is <i>expression</i> an object?
<a href="https://ss64.com/vb/join.html">Join</a>           Combine the contents of an array into a single variable. 
l
<a href="https://ss64.com/vb/lbound.html">LBound</a>             Return the smallest subscript for an array.
<a href="https://ss64.com/vb/lcase.html">LCase</a>(<i>String</i>)      Return <i>String</i> in lower case
<a href="https://ss64.com/vb/left.html">Left</a>(<i>String</i>,<i>len</i>)   Return the leftmost <i>len </i>characters of <i>string</i>
LeftB(<i>String</i>,<i>len</i>)  Return the leftmost <i>len </i>bytes of <i>string</i>
<a href="https://ss64.com/vb/len.html">Len</a>(<i>String</i>)    Return length of <i>string</i> in characters
LenB(<i>String</i>)   Return length of <i>string</i> in Bytes
<a href="https://ss64.com/vb/log.html">Log</a>(<i>number</i>)    Return natural log of <i>number</i>
<a href="https://ss64.com/vb/logevent.html">.LogEvent</a>       Log an item in the Event log
<a href="https://ss64.com/vb/ltrim.html">LTrim</a>(<i>String</i>)  Remove any leading spaces from a string expression    
m
<a href="https://ss64.com/vb/mapnetworkdrive.html">.MapNetworkDrive</a> Drive Map     
<a href="https://ss64.com/vb/mid.html">Mid</a>            Return a mid-section from a string
<a href="https://ss64.com/vb/minute.html">Minute</a>(<i>time</i>)   Return the minute component of <i>time</i>
<a href="https://ss64.com/vb/month.html">Month</a>(<i>date</i>)    Return the month component of <i>date</i>
<a href="https://ss64.com/vb/monthname.html">MonthName</a>      Convert a month number to a descriptive Month
<a href="https://ss64.com/vb/msgbox.html">MsgBox</a>         Display a dialogue box message
n
.<a href="https://ss64.com/vb/network.html">Network</a>        Access network resources
<a href="https://ss64.com/vb/now.html">Now</a>            Return the current Date and Time
o
<a href="https://ss64.com/vb/onerror.html">On Error</a>       Error handling
Option Explicit   Force all variables to be <a href="https://ss64.com/vb/dim.html">defined</a>
p
<a href="https://ss64.com/vb/addprinterconnection.html">.AddPrinterConn</a> / <a href="https://ss64.com/vb/addwindowsprinterconnection.html">.AddWindowsPrConn</a> Add Printer connection
<a href="https://ss64.com/vb/enumprinterconnections.html">.EnumPrinterConnections</a>   List Printer connections
<a href="https://ss64.com/vb/setdefaultprinter.html">.SetDefaultPrinter</a>        Set default printer
<a href="https://ss64.com/vb/removeprinterconnection.html">.RemovePrinterConnection</a>  Remove printer connection
Private <i>VarName</i>          Declare a local <a href="https://ss64.com/vb/dim.html">variable</a>/array variable
Public <i>VarName</i>           Declare a public <a href="https://ss64.com/vb/dim.html">variable</a>/array variable
q
<a href="https://ss64.com/vb/quit.html">.Quit</a>            Quit
r
Randomize(<i>number</i>)   Initialise the random number generator
<a href="https://ss64.com/vb/stdoutread.html">.ReadLine</a>       Accept user text input
<a href="https://ss64.com/vb/redim.html">ReDim</a>          Resize a dynamic array
RegExp         Regular expression search object
<a href="https://ss64.com/vb/regdel.html">.RegDelete</a>      Registry, delete
<a href="https://ss64.com/vb/regread.html">.RegRead</a>        Registry, read
<a href="https://ss64.com/vb/regwrite.html">.RegWrite</a>       Registry, write
<a href="https://ss64.com/vb/rem.html">REM</a>            Add a Comment
<a href="https://ss64.com/vb/replace.html">Replace</a>        Find and replace text

<a href="https://ss64.com/vb/rgb.html">RGB</a>(<i>Red</i>,<i>Green</i>,<i>Blue</i>) Return a system color code
<a href="https://ss64.com/vb/right.html">Right</a>(<i>String</i>,<i>len</i>)   Return the rightmost <i>len </i>characters of <i>string</i>
RightB(<i>String</i>,<i>len</i>)  Return the rightmost <i>len </i>bytes of <i>string</i>
<a href="https://ss64.com/vb/rnd.html">Rnd</a>            Return a random number  
<a href="https://ss64.com/vb/round.html">Round</a>          Round a number to <i>n</i> decimal places
<a href="https://ss64.com/vb/rtrim.html">RTrim</a>(<i>String</i>)  Remove any trailing spaces from a string expression
<a href="https://ss64.com/vb/run.html">.Run</a> a command
s
<a href="https://ss64.com/vb/second.html">Second</a>(<i>time</i>)   Return the second component of <i>time</i>
<a href="https://ss64.com/vb/select.html">Select...Case</a>  Conditionally execute a block of statements
<a href="https://ss64.com/vb/sendkeys.html">.SendKeys</a>
<a href="https://ss64.com/vb/set.html">Set</a> <i>variable</i> = <i>object</i>   Assign an object reference
<a href="https://ss64.com/vb/setlocale.html">SetLocale</a>(<i>LocaleID</i>)     Set the Regional <a href="https://ss64.com/vb/../locale.html">LocaleID</a>
<a href="https://ss64.com/vb/sgn.html">Sgn</a>(<i>number</i>)             The sign of a number
<a href="https://ss64.com/vb/shell.html">.Shell + Shell.Application</a> objects/methods
<a href="https://ss64.com/vb/shellexecute.html">.ShellExecute</a>   Run a script/application in the Windows Shell 
Shortcut create <a href="https://ss64.com/vb/shortcut.html">.CreateShortcut</a>
<a href="https://ss64.com/vb/sleep.html">.Sleep</a>
<a href="https://ss64.com/vb/space.html">Space</a>          Return a string consisting of spaces. 
<a href="https://ss64.com/vb/special.html">.SpecialFolders</a> Path to Desktop,Start menu, Programs...
<a href="https://ss64.com/vb/split.html">Split</a>          Parse a string of delimited values into an array
<a href="https://ss64.com/vb/sqr.html">Sqr</a>(<i>number</i>)    Square root
<a href="https://ss64.com/vb/stdoutread.html">StdOut.Read</a>    Obtain User Input from the command prompt
<a href="https://ss64.com/vb/stdoutwrite.html">StdOut.Write</a>   Echo text to the screen, also beep.
<a href="https://ss64.com/vb/strcomp.html">StrComp</a>        Compare two strings
<a href="https://ss64.com/vb/string.html">String</a>         Create a string with a single character repeated
<a href="https://ss64.com/vb/strreverse.html">StrReverse</a>     Reverse a string
<a href="https://ss64.com/vb/sub.html">Sub</a>            Declare a sub procedure
t
<a href="https://ss64.com/vb/time.html">Time</a>()         The current system time
Timer()        The number of seconds since midnight
<a href="https://ss64.com/vb/timeserial.html">TimeSerial</a>     Construct a Time value from Hours, Minutes and seconds
<a href="https://ss64.com/vb/timevalue.html">TimeValue</a>      Convert a string to a Time value
<a href="https://ss64.com/vb/trim.html">Trim</a>(<i>String</i>)   Remove leading and trailing spaces from <i>string</i>
<a href="https://ss64.com/vb/typename.html">TypeName</a>       Return variable type (variant subtype). 
u
<a href="https://ss64.com/vb/ubound.html">UBound</a>         Return the largest subscript for an array dimension
<a href="https://ss64.com/vb/ucase.html">UCase</a>(<i>String</i>)  Uppercase <i>String</i>
<a href="https://ss64.com/vb/unescape.html">UnEscape</a>(<i>Str</i>)  Return Unicode characters from an escaped ASCII string
w
<a href="https://ss64.com/vb/weekday.html">Weekday</a>        Return the day of the week (1-7)
<a href="https://ss64.com/vb/weekdayname.html">WeekdayName</a>    Return the named day of the week
<a href="https://ss64.com/vb/while.html">While...Wend</a>   Conditionally repeat a block of statements
<a href="https://ss64.com/vb/with.html">With</a>           Assign multiple properties of an object
<a href="https://ss64.com/vb/year.html">Year</a>(<i>date</i>)     Return the year component of <i>date</i> (1-12)
<a href="https://ss64.com/vb/rem.html">' Remark</a>       Add a Comment

<a href="https://ss64.com/vb/syntax.html" class="whitebut ">Syntax and Examples How-to</a>

<h2>vbs close chrome tab</h2>
try keyboard actions.

example: Browser("...").Type micCtrlDwn+micF4+micCtrlUp.

For Each w In CreateObject("Shell.Application").Windows 
  If InStr(1, w.LocationURL, "google", 1) Then _
    w.Quit()
Next 'w

<h2>to stop a vb script running in windows</h2>
2 different ways:
using Task Manager (Ctrl-Shift-Esc), end process name cscript.exe or wscript.exe

From the command line
taskkill /fi "imagename eq cscript.exe" (change to wscript.exe as needed)
taskkill /F /IM wscript.exe /T

Another way is using scripting and WMI.
Here are some hints: look for the Win32_Process class and the Terminate method.

However, scripts that perpetually focus program windows using .AppActivate may make it very difficult to get to the task manager -i.e you and the script will be fighting for control. Hence i recommend writing a script (which i call self destruct for obvious reasons) and make a keyboard shortcut key to activate the script.

Self destruct script:

Option Explicit
Dim WshShell
Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.Run "taskkill /f /im Cscript.exe", , True 
WshShell.Run "taskkill /f /im wscript.exe", , True  

Keyboard shortcut: rightclick on the script icon, select create shortcut, rightclick on script shortcut icon, select properties, click in shortcutkey and make your own.

type your shortcut key and all scripts end. Cheers

<h2>VBScript Main Index</h2>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-apostrophesign.html">VBScript statement apostrophe sign: '</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-minussign.html">VBScript operator minus sign: -</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-ampersand.html">VBScript operator ampersand sign: &amp;</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-greater-than.html">VBScript operator greater than: &gt;</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-greater-than-or-equal.html">VBScript operator greater than or equal: &gt;=</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-less-than.html">VBScript operator less than: &lt;</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-inequality.html">VBScript operator inequality: &lt;&gt;</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-less-than-or-equal.html">VBScript operator less than or equal: &lt;=</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-multiplication.html">VBScript operator multiplication: *</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-division.html">VBScript operator division: /</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-roundingdivision.html">VBScript operator rounding division: \</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-hat.html">VBScript operator hat: ^</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-plussign.html">VBScript operator plus sign: +</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-assign.html">VBScript operator assignment: =</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-abs.html">VBScript function abs: Abs</a>
Add 
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-add.html">VBScript dictionary add: Dictionary</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folderscollection-add.html">VBScript folders collection add: Folders Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-and.html">VBScript operator and: And</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-array.html">VBScript function array: Array</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-asc.html">VBScript function asc: Asc</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-atendofline.html">VBScript textstream atendofline: AtEndOfLine</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-atendofstream.html">VBScript textstream atendofstream: AtEndOfStream</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-atn.html">VBScript function atn: Atn</a>
Attributes 
<a href="https://www.devguru.com/content/technologies/vbscript/file-attributes.html">VBScript file attributes: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-attributes.html">VBScript folder attributes: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-availablespace.html">VBScript drive available space: AvailableSpace</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-buildpath.html">VBScript file system object buildpath: BuildPath</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-call.html">VBScript call statement: Call</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-cbool.html">VBScript function cbool: CBool</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-cbyte.html">VBScript function cbyte: CByte</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-ccur.html">VBScript function ccur: CCur</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-CDate.html">VBScript function CDate: CDate</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-CDbl.html">VBScript function CDbl: CDbl</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-Chr.html">VBScript function Chr: Chr</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-chrb.html">VBScript function chrb: ChrB</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-chrw.html">VBScript function chrw: ChrW</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-CInt.html">VBScript function CInt: CInt</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-class.html">VBScript statement class: Class</a>
<a href="https://www.devguru.com/content/technologies/vbscript/err-clear.html">VBScript err clear method: Clear</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-CLng.html">VBScript function CLng: CLng</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-close.html">VBScript textstream close: Close</a>
<a href="https://www.devguru.com/content/technologies/vbscript/constants-COLOR.html">VBScript constant COLOR: COLOR</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-column.html">VBScript textstream column: Column</a>
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-comparemode.html">VBScript dictionary compare mode: CompareMode</a>
<a href="https://www.devguru.com/content/technologies/vbscript/constants-comparison.html">VBScript constant comparison: COMPARISON</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-const.html">VBScript statement const: Const</a>
Copy 
<a href="https://www.devguru.com/content/technologies/vbscript/file-copy.html">VBScript file copy method: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-copy.html">VBScript folder copy method: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-copyfile.html">VBScript file system object copyfile: CopyFile</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-copyfolder.html">VBScript file system object copyfolder: CopyFolder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-Cos.html">VBScript function Cos: Cos</a>
Count 
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-count.html">VBScript dictionary count property: Dictionary</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drivescollection-count.html">VBScript drives collection count property: Drives Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filescollection-count.html">VBScript files collection count property: Files Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folderscollection-count.html">VBScript folders collection count property: Folders Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/matchescollection-count.html">VBScript matches collection count property: Matches Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-createfolder.html">VBScript file system object createfolder: CreateFolder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-createfolder.html">VBScript file system object createfolder: CreateFolder</a>
CreateTextFile 
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-createtextfile.html">VBScript file system object create textfile: FileSystemObject</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-createtextfile.html">VBScript folder create textfile method: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-CSng.html">VBScript function CSng: CSng</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-CStr.html">VBScript function CStr: CStr</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-date.html">VBScript function date: Date</a>
<a href="https://www.devguru.com/content/technologies/vbscript/constants-dateandtime.html">VBScript constant dateandtime: Date And Time</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-DateAdd.html">VBScript function DateAdd: DateAdd</a>
DateCreated 
<a href="https://www.devguru.com/content/technologies/vbscript/file-datecreated.html">VBScript file datecreated property: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-datecreated.html">VBScript folder datecreated property: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-DateDiff.html">VBScript function DateDiff: DateDiff</a>
<a href="https://www.devguru.com/content/technologies/vbscript/constants-dateformat.html">VBScript constant dateformat: DateFormat</a>
DateLastAccessed 
<a href="https://www.devguru.com/content/technologies/vbscript/file-datelastaccessed.html">VBScript file date last accessed property: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-datelastaccessed.html">VBScript folder date last accessed: Folder</a>
DateLastModified 
<a href="https://www.devguru.com/content/technologies/vbscript/file-datelastmodified.html">VBScript file-date last modified: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-datelastmodified.html">VBScript folder date last modified: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-DatePart.html">VBScript function DatePart: DatePart</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-DateSerial.html">VBScript function DateSerial: DateSerial</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-DateValue.html">VBScript function DateValue: DateValue</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-Day.html">VBScript function Day: Day</a>
Delete 
<a href="https://www.devguru.com/content/technologies/vbscript/file-delete.html">VBScript file delete method: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-delete.html">VBScript folder delete method: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-deletefile.html">VBScript file system object deletefile: DeleteFile</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-deletefolder.html">VBScript file system object deletefolder: DeleteFolder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/err-description.html">VBScript err description property: Description</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-dictionary.html">VBScript object dictionary: Dictionary</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-dim.html">VBScript statement dim: Dim</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-do.html">VBScript statement do: Do</a>
Drive 
<a href="https://www.devguru.com/content/technologies/vbscript/objects-drive.html">VBScript object drive: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/file-drive.html">VBScript file drive: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-driveexists.html">VBScript file system object driveexists: DriveExists</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-driveletter.html">VBScript drive driveletter: DriveLetter</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-drives.html">VBScript file system object drives: Drives</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-drivescollection.html">VBScript object drives collection: Drives Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-drivetype.html">VBScript drive drivetype: DriveType</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/operators-eqv.html">VBScript operator eqv: Eqv</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-erase.html">VBScript statement erase: Erase</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-err.html">VBScript object err: Err</a>
</span></td>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-Eval.html">VBScript function Eval: Eval</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-execute.html">VBScript statement execute: Execute</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-executeglobal.html">VBScript statement executeglobal: ExecuteGlobal</a>
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-exists.html">VBScript dictionary exists method: Exists</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-exit.html">VBScript statement exit: Exit</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-Exp.html">VBScript function Exp: Exp</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-file.html">VBScript object file: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/constants-FILEATTRIBUTE.html">VBScript constant FILEATTRIBUTE: FILE ATTRIBUTE</a>
<a href="https://www.devguru.com/content/technologies/vbscript/constants-fileinputoutput.html">VBScript constant fileinputoutput: File Input/Output</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-fileexists.html">VBScript file system object fileexists: FileExists</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-files.html">VBScript folder files: Files</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-filescollection.html">VBScript object filescollection: Files Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-filesystem.html">VBScript drive file system: FileSystem</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-filesystemobject.html">VBScript file system object: FileSystemObject</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-Filter.html">VBScript function Filter: Filter</a>
<a href="https://www.devguru.com/content/technologies/vbscript/match-firstindex.html">VBScript match first index: FirstIndex</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-Fix.html">VBScript function Fix: Fix</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-folder.html">VBScript object folder: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-folderexists.html">VBScript file system object folderexists: FolderExists</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-folderscollection.html">VBScript object folderscollection: Folders Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-for.html">VBScript statement for: For</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-foreach.html">VBScript statement foreach: ForEach</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-formatcurrency.html">VBScript function format currency: FormatCurrency</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-FormatDateTime.html">VBScript function Format Date Time: FormatDateTime</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-FormatNumber.html">VBScript function Format Number: FormatNumber</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-FormatPercent.html">VBScript function Format Percent: FormatPercent</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-freespace.html">VBScript drive freespace: FreeSpace</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-function.html">VBScript statement function: Function</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getabsolutepathname.html">VBScript file system object getabsolutepathname: GetAbsolutePathName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getbasename.html">VBScript file system object getbasename: GetBaseName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getdrive.html">VBScript file system object getdrive: GetDrive</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getdrivename.html">VBScript file system object getdrivename: GetDriveName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getextensionname.html">VBScript file system object getextensionname: GetExtensionName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getfile.html">VBScript file system object getfile: GetFile</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getfilename.html">VBScript file system object getfilename: GetFileName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getfileversion.html">VBScript file system object getfileversion: GetFileVersion</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getfolder.html">VBScript file system object getfolder: GetFolder</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/functions-GetLocale.html">VBScript function GetLocale: GetLocale</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-GetObject.html">VBScript function GetObject: GetObject</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getparentfoldername.html">VBScript file system object- getparentfoldername: GetParentFolderName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-GetRef.html">VBScript function GetRef: GetRef</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-getspecialfolder.html">VBScript file system object getspecialfolder: GetSpecialFolder</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-gettempname.html">VBScript file system object gettempname: GetTempName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/regexp-global.html">VBScript regexp global: Global</a>
<a href="https://www.devguru.com/content/technologies/vbscript/err-helpcontext.html">VBScript err helpcontext: HelpContext</a>
<a href="https://www.devguru.com/content/technologies/vbscript/err-helpfile.html">VBScript err helpfile: HelpFile</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-Hex.html">VBScript function Hex: Hex</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-hour.html">VBScript function hour: Hour</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-if.html">VBScript statements if: If</a>
<a href="https://www.devguru.com/content/technologies/vbscript/regexp-ignorecase.html">VBScript regexp ignorecase: IgnoreCase</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-imp.html">VBScript operator imp: Imp</a>
<a href="https://www.devguru.com/content/technologies/vbscript/events-initialize.html">VBScript event initialize: Initialize</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-inputbox.html">VBScript function inputbox: InputBox</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-instr.html">VBScript function instr: InStr</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-instrrev.html">VBScript function instrrev: InStrRev</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-int.html">VBScript function int: Int</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/operators-is.html">VBScript operator is: Is</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-isarray.html">VBScript function isarray: IsArray</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-isdate.html">VBScript function isdate: IsDate</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/functions-isempty.html">VBScript function isempty: IsEmpty</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-isnull.html">VBScript function isnull: IsNull</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-isnumeric.html">VBScript function isnumeric: IsNumeric</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-isobject.html">VBScript function isobject: IsObject</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-isready.html">VBScript drive isready: IsReady</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-isrootfolder.html">VBScript folder isrootfolder: IsRootFolder</a>
Item 
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-item.html">VBScript dictionary item property: Dictionary</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drivescollection-item.html">VBScript drivescollection item property: Drives Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filescollection-item.html">VBScript files collection item property: Files Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folderscollection-item.html">VBScript folders collection item property: Folders Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/matchescollection-item.html">VBScript matches collection item property: Matches Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-items.html">VBScript dictionary items: Items</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-join.html">VBScript function join: Join</a>
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-key.html">VBScript dictionary key: Key</a>
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-keys.html">VBScript dictionary keys: Keys</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-lbound.html">VBScript function lbound: LBound</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-lcase.html">VBScript function lcase: LCase</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-left.html">VBScript function left: Left</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-len.html">VBScript function len: Len</a>
<a href="https://www.devguru.com/content/technologies/vbscript/match-length.html">VBScript match length: Length</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-line.html">VBScript textstream line: Line</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-loadpicture.html">VBScript function loadpicture: LoadPicture</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-log.html">VBScript function log: Log</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-ltrim.html">VBScript function ltrim: LTrim</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-match.html">VBScript object match: Match</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-matchescollection.html">VBScript object matches collection: Matches Collection</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-mid.html">VBScript function mid: Mid</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-minute.html">VBScript function minute: Minute</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-mod.html">VBScript operator mod: Mod</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-month.html">VBScript function month: Month</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-monthname.html">VBScript function monthname: MonthName</a>
Move 
<a href="https://www.devguru.com/content/technologies/vbscript/file-move.html">VBScript file move: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-move.html">VBScript folder move: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-movefile.html">VBScript file system object movefile: MoveFile</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-movefolder.html">VBScript file system object movefolder: MoveFolder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-msgbox.html">VBScript function msgbox: MsgBox</a>
Name 
<a href="https://www.devguru.com/content/technologies/vbscript/file-name.html">VBScript file name: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-name.html">VBScript folder name: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-not.html">VBScript operator not: Not</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-now.html">VBScript function now: Now</a>
<a href="https://www.devguru.com/content/technologies/vbscript/err-number.html">VBScript err number: Number</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-oct.html">VBScript function oct: Oct</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-onerror.html">VBScript statement onerror: OnError</a>
</span></td>
<a href="https://www.devguru.com/content/technologies/vbscript/file-openastextstream.html">VBScript file openastextstream: OpenAsTextStream</a>
<a href="https://www.devguru.com/content/technologies/vbscript/filesystemobject-opentextfile.html">VBScript file system object opentextfile: OpenTextFile</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-optionexplicit.html">VBScript statement optionexplicit: Option Explicit</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-or.html">VBScript operator or: Or</a>
ParentFolder 
<a href="https://www.devguru.com/content/technologies/vbscript/file-parentfolder.html">VBScript file parent folder: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-parentfolder.html">VBScript folder parent folder: Folder</a>
Path 
<a href="https://www.devguru.com/content/technologies/vbscript/drive-path.html">VBScript drive path: Drive</a>
<a href="https://www.devguru.com/content/technologies/vbscript/file-path.html">VBScript file path: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-path.html">VBScript folder path: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/regexp-pattern.html">VBScript regexp pattern: Pattern</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-private.html">VBScript statement private: Private</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-propertyget.html">VBScript statement propertyget: PropertyGet</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-propertylet.html">VBScript statement propertylet: PropertyLet</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-propertyset.html">VBScript statement propertyset: PropertySet</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-public.html">VBScript statement public: Public</a>
<a href="https://www.devguru.com/content/technologies/vbscript/err-raise.html">VBScript err raise: Raise</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-randomize.html">VBScript statement randomize: Randomize</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-read.html">VBScript textstream read: Read</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-readall.html">VBScript textstream readall: ReadAll</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-readline.html">VBScript textstream readline: ReadLine</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-redim.html">VBScript statement redim: ReDim</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-regexp.html">VBScript object regexp: RegExp</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-rem.html">VBScript statement rem: Rem</a>
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-remove.html">VBScript dictionary remove: Remove</a>
<a href="https://www.devguru.com/content/technologies/vbscript/dictionary-removeall.html">VBScript dictionary removeall: RemoveAll</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-replace.html">VBScript function replace: Replace</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-RGB.html">VBScript function RGB: RGB</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-right.html">VBScript function right: Right</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-rnd.html">VBScript function rnd: Rnd</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-roofolder.html">VBScript drive roofolder: RootFolder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-round.html">VBScript function round: Round</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-rtrim.html">VBScript function rtrim: RTrim</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-scriptengine.html">VBScript function scriptengine: ScriptEngine</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-scriptenginebuildversion.html">VBScript function scriptenginebuildversion: ScriptEngineBuildVersion</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-scriptenginemajorversion.html">VBScript function scriptenginemajorversion: ScriptEngineMajorVersion</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-scriptengineminorversion.html">VBScript function scriptengineminorversion: ScriptEngineMinorVersion</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-second.html">VBScript function second: Second</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-selectcase.html">VBScript statement selectcase: SelectCase</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-serialnumber.html">VBScript drive serialnumber: SerialNumber</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-set.html">VBScript statement set: Set</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-setlocale.html">VBScript function setlocale: SetLocale</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-sgn.html">VBScript function sgn: Sgn</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-sharename.html">VBScript drive sharename: ShareName</a>
ShortName 
<a href="https://www.devguru.com/content/technologies/vbscript/file-shortname.html">VBScript file short name: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-shortname.html">VBScript folder short name: Folder</a> 
ShortPath 
<a href="https://www.devguru.com/content/technologies/vbscript/file-shortpath.html">VBScript file short path: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-shortpath.html">VBScript folder short path: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-sin.html">VBScript function sin: Sin</a>
Size 
<a href="https://www.devguru.com/content/technologies/vbscript/file-size.html">VBScript file size: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-size.html">VBScript folder size: Folder</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-skip.html">VBScript textstream skip: Skip</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-skipline.html">VBScript textstream skipline: SkipLine</a>
<a href="https://www.devguru.com/content/technologies/vbscript/err-source.html">VBScript err source: Source</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-space.html">VBScript function space: Space</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-split.html">VBScript function split: Split</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-sqr.html">VBScript function sqr: Sqr</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-strcomp.html">VBScript function strcomp: StrComp</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/functions-string.html">VBScript function string: String</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-strreverse.html">VBScript function strreverse: StrReverse</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-sub.html">VBScript statement sub: Sub</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-subfolders.html">VBScript folder subfolders: SubFolders</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-tan.html">VBScript function tan: Tan</a>
<a href="https://www.devguru.com/content/technologies/vbscript/events-terminate.html">VBScript event terminate: Terminate</a>
<a href="https://www.devguru.com/content/technologies/vbscript/regexp-test.html">VBScript regexp test: Test</a>
<a href="https://www.devguru.com/content/technologies/vbscript/objects-textstream.html">VBScript object textstream: TextStream</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-time.html">VBScript function time: Time</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-timer.html">VBScript function timer: Timer</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-timeserial.html">VBScript function timeserial: TimeSerial</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-timevalue.html">VBScript function timevalue: TimeValue</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-totalsize.html">VBScript drive totalsize: TotalSize</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-trim.html">VBScript function trim: Trim</a>
<a href="https://www.devguru.com/content/technologies/vbscript/constants-tristate.html">VBScript constant tristate: Tristate</a>
Type 
<a href="https://www.devguru.com/content/technologies/vbscript/file-type.html">VBScript file type: File</a>
<a href="https://www.devguru.com/content/technologies/vbscript/folder-type.html">VBScript folder type: Folder</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-typename.html">VBScript function typename: TypeName</a> 
<a href="https://www.devguru.com/content/technologies/vbscript/functions-ubound.html">VBScript function ubound: UBound</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-ucase.html">VBScript function ucase: UCase</a>
<a href="https://www.devguru.com/content/technologies/vbscript/match-value.html">VBScript match value: Value</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-vartype.html">VBScript function vartype: VarType</a>
<a href="https://www.devguru.com/content/technologies/vbscript/constants-vbobjecterror.html">VBScript constant vbobjecterror: VBObjectError</a>
<a href="https://www.devguru.com/content/technologies/vbscript/drive-volumename.html">VBScript drive volumename: VolumeName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-weekday.html">VBScript function weekday: Weekday</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-weekdayname.html">VBScript function weekdayname: WeekdayName</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-while.html">VBScript statement while: While</a>
<a href="https://www.devguru.com/content/technologies/vbscript/statements-with-endwith.html">VBScript statement with endwith: With...End With</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-write.html">VBScript textstream write: Write</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-writeblanklines.html">VBScript textstream writeblanklines: WriteBlankLines</a>
<a href="https://www.devguru.com/content/technologies/vbscript/textstream-writeline.html">VBScript textstream writeline: WriteLine</a>
<a href="https://www.devguru.com/content/technologies/vbscript/operators-xor.html">VBScript operator xor: Xor</a>
<a href="https://www.devguru.com/content/technologies/vbscript/functions-year.html">VBScript function year: Year</a>

<h2>run js from vb</h2>
wscript.exe C:\Scripts\helloworld.js

<h2>VBScript Variable</h2>
Variables can also be used for holding expressions. 
Suppose you have stored the marks of a student in English and Mathematics using the variables markE and markM. 

You want to find the total marks. 
Then, you can use a variable named markT and set its value to markE + markM. 
In other words, markT = markE + markM. 
Here, markT is a variable which holds an expression. 

<h3>Declaring Variables</h3>
Declaring variables is the same as creating variables because you are instructing the computer to reserve memory space. 
You can name the variable the way you want. 
It can be short names like x, y or z or more self-describing names like student, Name, salary etc. 
Providing clear and meaningful names to variables is considered a good programming practice.

There are certain rules for VBScript variable names. 

Variable name must begin with a letter. 
Examples: salary, mark etc. 
Variables beginning with numbers or special characters are not allowed. 
Examples: 1stSchool, 3rdCar, _name etc.
Variable name cannot exceed 255 characters.
Variable name should not contain a period (.). 
For declaring variables, you need to use the keyword Dim. 
Suppose you plan to use a variable named “salary” in your VBScript program, syntax 
Dim salary;

Just declaring the VBS variables will not help you, use it. 
You will have to assign a value to it at some point or another and this process is known as initializing the variable. 
If you are planning to declare a variably named salary, then you can code like this: 
Dim salary
salary = 10000

<strong>The important thing you need to make sure is that you should not assign a value to the variable as and when you declare it.</strong> Suppose you write a statement like this: 
Dim salary = 10000

If you try to output salary using document.write, it will not return any output. 

<strong>Code Example</strong> 
<strong>Step 1)</strong> Open your text editor and add the following lines of code. 

&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Variables&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;script type="text/vbscript"&gt;
Dim variable1
variable1="John"
document.write(variable1)
‘Dim variable2 = "Smith"
‘document.write(variable2)
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;

<strong>Step 2)</strong> Save this file as variable.html in your preferred location and then open this in IE (following the steps specified in the previous chapter). 
Now, you will see the value John on the browser. 

<strong>Step 3)</strong> Next, uncomment line # 11 &amp; 12 
Again save the file and refresh the IE browser if it is already opened or open the file in the IE browser. 
You might be wondered to see nothing; neither John nor Smith. 
The problem here is that you tried to assign the value to the variable while declaring it which is not allowed. 
<h3>Loose Binding</h3>
VBScript provides you the freedom to use variables without declaring it (called loose binding). 
<strong>For example,</strong> without having the statement Dim student, you can assign a value to the variable student like – student = "John" 
But, it is not at all a good programming practice. 
If you use a variable without declaring it and misspell the same variable when you use it again, VBScript will not prompt you of the error. 

So to make the code easier to read and to identify the errors, you should use the Option Explicit statement at the beginning of your code so that you will be forced to declare all your variables even if you forget to do so. 
To avoid variable type related issues, it is always good to specify the statement Option Explicit at the beginning of your VBScript code. 

<strong>Code Example:</strong> 
<strong>Step 1)</strong> Open your text editor and add the following lines of code. 

&lt;html&gt;
&lt;body&gt;
&lt;script type="text/vbscript"&gt;
Option Explicit
‘Dim markE, markM, markT
markE=90
markM=86
markT=markE+markM
document.write("Your marks in English is " &amp; markE &amp; "." &amp; "&lt;br /&gt;")
document.write("Your marks in Mathematics is " &amp; markM &amp; "." &amp; "&lt;br /&gt;")
document.write("Your total marks is " &amp; markT &amp; ".")
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;

<strong>Step 2)</strong> Save the file as variables.html in your preferred location. 
Now open the file in Internet Explorer and your screen is blank. 
Why ? because you have used option explicit but not declared variables before using them 
<strong>Step 3)</strong> Now to understand the importance of Option Explicit statement, uncomment Line 5 in the above code 
<strong>Step 4)</strong> Save the variables.html file and refresh your browser. 
Now, your output will be like this: 

<img src="https://www.guru99.com/images/VBScript/marks.png"> 
<strong>Note</strong> - To concatenate two strings, you need to use “&amp;”. 
In above example, its used inside document.write command. 
It is obvious that the calculation of total marks is wrong. 
Now just add the first statement Option Explicit at the beginning of VBScript code (without the Dim statement). 

Save the file and see the output. 
You will get nothing as output which indicates that your code has some error. 
Here the error is you have not declared variables before using it even after specifying Option Explicit statement. 

You can also declare variables using public and private keywords like a public student or private student. 
But, you have to be more careful while using these two keywords for declaring variables because it will change the scope of your variables. 

You can also store multiple values in a single variable and such variables are known as <strong>VBScript array</strong> variables. 
Suppose, you want to store details like name, marks, address etc of 30 students. 
It will be really difficult to create and manage sets of 30 variables for names, marks, addresses and so on. 

Instead, you can declare a single variable named students and store the names of all 30 students in this variable. 
In such case, you will declare the variable as Dim students(29) (array index starts from zero) and you will assign values as 
students(0) = "John"
students(1) = "Hannah"
students(2) = "Kevin"
.......
.......
students(28) = "Rose"
students(29) = "Emma"

Similarly, you can create variables like marks, address etc to store the respective values of all 30 students. 
You can also create multidimensional arrays having up to 60 dimensions. 

<strong>Code Example:</strong> 
Open your text editor and add the following lines of code. 

&lt;html&gt;
&lt;body&gt;

&lt;script type="text/vbscript"&gt;
Option Explicit
Dim students(19), marks(19)
students(0) = "John"
marks(0) = 95
students(1) = "Emma"
marks(1) = "83"
students(2) = "Kevin"
marks(2) = 87
 
document.write(students(0) &amp; " has scored " &amp; marks(0)  &amp; ".&lt;br /&gt;")
document.write(students(1) &amp; " has scored " &amp; marks(1)  &amp; ".&lt;br /&gt;")
document.write(students(2) &amp; " has scored " &amp; marks(2)  &amp; ".&lt;br /&gt;")
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;


Here, we have stored details of only three students. 
You can add details of up to 20 students as we have set the size of the array as 20 (as index starts from 0). 
<h3>VBScript Data Types</h3>
In the previous section, you might have noticed that we assigned different types of data to the variables.We have stored numbers (mark and salary), strings (name) etc in different variables.

These numbers, strings etc are known as <strong>data types</strong>. 
In fact, VBScript has only one data type called Variant. 
A variant is a special kind of data type which can hold different kinds of information. 

<strong>If you use Variant in a numeric context, it behaves like a number and when you use it in a string context, it behaves as a string.</strong> 
In other words, when you specify salary=10000, VBScript assumes that salary is a numeric data type. 
A Variant makes specific distinctions about the nature of the data. 
For example, you can use variant type to store Boolean values, currency, date and so on. 

These different categories of information that can be contained in a Variant are called subtypes. 
Though most of the time, Variant behaves in such a way that is most appropriate for the data it contains, you should be aware of different subtypes. 

<strong>Following is the list of VBScript Data Types.</strong> 

Empty: A special subtype to represent a variable that has not been assigned with any value yet.
Null: A special subtype to represent a variable assigned with a null value.
Integer: Using 2 bytes to express signed integer in the range -32,768 to 32,767.
Long: Using 4 bytes to express signed integers ranging from -2,147,483,648 to 2,147,483,647.
Single: Using 4 bytes to express real numbers in floating-point format ranging from -3.402823e38 to -1.401298e-45 for negative values, and from 1.401298e-45 to 3.402823e38 for positive value.
Double: Using 8 bytes to express real numbers in floating-point format ranging from -1.79769313486232e308 to -4.94065645841247e-324 for negative values, and from 4.94065645841247e-324 to 1.79769313486232e308 for positive values.
Currency: Using 8 bytes to express real numbers in decimal format ranging from -922,337,293,685,477.5808 to 922,337,293,685,477.5807.
Date: Using 8 bytes to express dates ranging from January 1, 100 to December 31, 9999.
String: Using 1 byte per character to express a sequence of characters that can be up to approximately 2 billion characters.
Object: A special subtype to represent a reference to an object.
Error: A special subtype to represent an error number.
Boolean: Using 2 bytes to contain either True or False.
Byte: Using 1 byte to express integer in the range 0 to 255. </ul>
There are two built-in VBScript functions that help you know the subtype of a variable: “varType()” and “typeName()”. 

The var type returns the numeric representation and typeName() returns the text representation of the subtype of the variable. 
Each subtype has a predefined numeric representation. 

<strong>Code Example</strong> 
Open your text editor and add the following lines of code. 

&lt;html&gt;
&lt;head&gt;
&lt;script type="text/vbscript"&gt;
Option Explicit
Dim a
a = Empty
document.write("a = " &amp; a &amp; "&lt;br /&gt;")
document.write("The numeric representation of a is " &amp; VarType(a)  &amp; "&lt;br /&gt;")
document.write("The variable a is of " &amp; TypeName(a) &amp; " data type."  &amp; "&lt;br /&gt;&lt;br /&gt;")

Dim b
b = Null
document.write("b = " &amp; b &amp; "&lt;br /&gt;")
document.write("The numeric representation of b is " &amp; VarType(b)  &amp; "&lt;br /&gt;")
document.write("The variable b is of " &amp; TypeName(b) &amp; " data type."  &amp; "&lt;br /&gt;&lt;br /&gt;")

Dim c
c = 4
document.write("c = " &amp; c &amp; "&lt;br /&gt;")
document.write("The numeric representation of c is " &amp; VarType(c)  &amp; "&lt;br /&gt;")
document.write("The variable c is of " &amp; TypeName(c) &amp; " data type."  &amp; "&lt;br /&gt;&lt;br /&gt;")

Dim d
d = -2100483648
document.write("d = " &amp; d &amp; "&lt;br /&gt;")
document.write("The numeric representation of d is " &amp; VarType(d)  &amp; "&lt;br /&gt;")
document.write("The variable d is of " &amp; TypeName(d) &amp; " data type."  &amp; "&lt;br /&gt;&lt;br /&gt;")

Dim e
e = -3.402823E38
document.write("e = " &amp; e &amp; "&lt;br /&gt;")
document.write("The numeric representation of e is " &amp; VarType(e)  &amp; "&lt;br /&gt;")
document.write("The variable e is of " &amp; TypeName(e) &amp; " data type."  &amp; "&lt;br /&gt;&lt;br /&gt;")

Dim f
f = "John"
document.write("f = " &amp; f &amp; "&lt;br /&gt;")
document.write("The numeric representation of f is " &amp; VarType(f)  &amp; "&lt;br /&gt;")
document.write("The variable f is of " &amp; TypeName(f) &amp; " data type."  &amp; "&lt;br /&gt;&lt;br /&gt;")

Dim g
g = True
document.write("g = " &amp; g &amp; "&lt;br /&gt;")
document.write("The numeric representation of g is " &amp; VarType(g)  &amp; "&lt;br /&gt;")
document.write("The variable g is of " &amp; TypeName(g) &amp; " data type."  &amp; "&lt;br /&gt;&lt;br /&gt;")
&lt;/script&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;

Save the file as subtype.html and open it in IE. 
Your output will look like this: 
<img src=https://www.guru99.com/images/VBScript/subtype.png alt="Declaring and Using VBScript Variables"/>
NOTE: You can also declare variables using <strong>public</strong> and <strong>private</strong> keywords like public student or private student. 
But, you have to be more careful while using these two keywords for declaring variables because it will change the scope of your variables. 
<h3>Summary</h3>

Variables are used to hold value or an expression while programming. 
Variables are to be declared and initialized separately.
Though you can use variables without declaring, declaring variables before using them is considered as a good programming practice.
A variant is the only data type of VBScript and variant has different subtypes including String, Boolean, Integer, Currency etc. </ul><h3>Troubleshooting</h3>
In case you see a blank page after you run the code, do the following 

Press F12 to open developer tools
In left toolbar scroll down until you see "Emulation" settings page
Change Document Mode from a default ("Edge") to 10
Add the following code to the head 
&lt;meta http-equiv="x-ua-compatible" content="IE=10"&gt;

<h2>VBScript special characters</h2>
VBScript has two built-in functions
—Escape and Unescape—
that replace special characters to make them URL-safe. 

VBScript's Help file doesn't document the Escape and Unescape functions. 
However, if you use an object browser such as Microsoft OLEView to view VBScript's vbscript.dll file, you can see that these functions are implemented.

The Escape function assesses a string argument one character at a time. 

When the function encounters a special character (i.e., a character other than a letter or number or one of the characters * + - . 
/ @ or _), 
it replaces the character with a percent sign (%) and the replaced character's hexadecimal number. 

For example, the line-feed character is ASCII character code 10; 10 in hex notation is 0A—
so, Escape replaces a line-feed character embedded in a string with

For a demonstration, run the following code in a VBScript file:

WScript.Echo Unescape("%40")

You usually can't display characters such as the carriage return and line feed, but Escape lets you at least display their representation. 

For example, the following code shows the Escape codes for carriage return and line-feed characters:

WScript.Echo Escape(VbCrLf)

Although Escape and Unescape were designed to work with Internet URLs, I use these functions for debugging scripts that use unusual characters. 

For example, a few months ago I was testing a script that read the output of the Windows shell Ipconfig command. 
The Escape function showed me that the command inserted some special formatting characters that caused problems with extracting information.

<h2>VBScript - Working With Strings</h2>
<a href="https://support.smartbear.com/testcomplete/docs/scripting/working-with/strings/vbscript.html" class="whitebut ">vbscript strings</a>
This topic contains information about handling strings in VBScript and provides examples of operations that deal with strings. 
It contains the following sections:
<div class="toc"  target="_self"><a href="#VBScriptBasics"  target="_self">Basics</a>
<a href="#VBScriptSpecChars"  target="_self">Special characters</a>
<a href="#VBScriptStrLen"  target="_self">Getting the string length</a>
<a href="#VBScriptConcat"  target="_self">Concatenating strings</a>
<a href="#VBScriptComparing"  target="_self">Comparing strings</a>
<a href="#VBScriptGetChar"  target="_self">Accessing individual character of a string</a>
<a href="#VBScriptTextSearch"  target="_self">Searching for characters and substrings</a>
<a href="#VBScriptGetStr"  target="_self">Getting a substring</a>
<a href="#VBScriptSplit"  target="_self">Splitting strings</a>
<a href="#VBScriptTrimming"  target="_self">Removing extra spaces from a string</a>
<a href="#VBScriptReplaceStr"  target="_self">Replacing characters and substrings</a>
<a href="#VBScriptLetterCase"  target="_self">Changing the letter case</a>
<a href="#VBScriptStringLists"  target="_self">Working with string lists</a>
</div>

<h3 id="VBScriptBasics">Basics</h3>

A <span class="orange">String</span> is a sequence of symbols or digits.
Strings are among the most frequently used data types. 
Like any other data type, strings in TestComplete are represented as OLE-compatible variants. 
In VBScript, a sequence of literal characters, enclosed in double quotes ("), is recognized as a string. 
Single quotation marks (') are allowed within a string. 
To insert a double quotation mark into a string, it should be duplicated. 
The following is an example of string:

str1 = "The brig was heading to Liverpool, when the captain noticed a ship."
str2 = "'Ahoy! Is there anyone?' - the captain cried."
str3 = """Nobody."" - was the answer."

To deal with strings, TestComplete has a special <code>aqString</code> scripting object. 
The object is available for all supported scripting languages, so that you can use it to operate with string values regardless of the chosen language. 

<table class="aqTable" width="90%" cellspacing="0" cellpadding="0">
<thead>
<tr>
<th class="aqTableHeader" width="30%">Method, Property</th>
<th class="aqTableHeader" width="70%">Description</th></tr>
</thead>
<tbody>

<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/addlistitem.html"><code>aqString.AddListItem</code></a></td><td>Adds a new item to a string list.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/changelistitem.html"><code>aqString.ChangeListItem</code></a></td><td>Changes the value of the string list item with the given index.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/compare.html"><code>aqString.Compare</code></a></td><td>Compares two specified strings.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/concat.html"><code>aqString.Concat</code></a></td><td>Concatenates two specified strings.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/deletelistitem.html"><code>aqString.DeleteListItem</code></a></td><td>Removes an item with the given index from a string list.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/find.html"><code>aqString.Find</code></a></td><td>Searches for a substring within the given string. 
Use this method instead of the obsolete <code>aqString.Contains</code>.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/format.html"><code>aqString.Format</code></a></td><td>Generates a formatted string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/getchar.html"><code>aqString.GetChar</code></a></td><td>Retrieves a single character from the input string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/getlength.html"><code>aqString.GetLength</code></a></td><td>Returns the number of characters in a string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/getlistitem.html"><code>aqString.GetListItem</code></a></td><td>Returns an individual item from the list passed through the input string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/getlistlength.html"><code>aqString.GetListLength</code></a></td><td>Returns the number of items in the string list.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/insert.html"><code>aqString.Insert</code></a></td><td>Inserts one string to another at the specified position.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/listseparator.html"><code>aqString.ListSeparator</code></a></td><td>Specifies a character used to separate individual values in a list.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/quote.html"><code>aqString.Quote</code></a></td><td>Encloses the specified string in quotes.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/quotesymbol.html"><code>aqString.QuoteSymbol</code></a></td><td>Specifies a symbol used as a quotation mark.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/remove.html"><code>aqString.Remove</code></a></td><td>Removes a number of characters from the input string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/replace.html"><code>aqString.Replace</code></a></td><td>Replaces all the occurrences of one substring with another substring.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/substring.html"><code>aqString.SubString</code></a></td><td>Retrieves a substring from the input string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/tolower.html"><code>aqString.ToLower</code></a></td><td>Converts the specified string to lower case.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/toupper.html"><code>aqString.ToUpper</code></a></td><td>Converts the specified string to upper case.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/trim.html"><code>aqString.Trim</code></a></td><td>Removes spaces and control characters from the specified string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqstring/unquote.html"><code>aqString.Unquote</code></a></td><td>Converts a quoted string to an unquoted string.</td></tr>
</tbody>
</table>
Another scripting object that is useful for string manipulation is <a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/index.html"><code>aqConvert</code></a>. 
This object has several methods that convert values of different types to a string representation and vice versa.
<table class="aqTable" width="90%" cellspacing="0" cellpadding="0">
<thead>
<tr>
<th class="aqTableHeader" width="30%">Method</th>
<th class="aqTableHeader" width="70%">Description</th></tr>
</thead>
<tbody>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/currencytoformatstr.html"><code>aqConvert.CurrencyToFormatStr</code></a></td><td>Converts a currency value to a string using the specified format settings.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/currencytostr.html"><code>aqConvert.CurrencyToStr</code></a></td><td>Converts a currency value to a string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/datetimetoformatstr.html"><code>aqConvert.DateTimeToFormatStr</code></a></td><td>Converts the given date value to a string using the specified format.
</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/datetimetostr.html"><code>aqConvert.DateTimeToStr</code></a></td><td>Converts the given date value to a string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/floattostr.html"><code>aqConvert.FloatToStr</code></a></td><td>Converts a floating-point value to a string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/inttostr.html"><code>aqConvert.IntToStr</code></a></td><td>Converts the given number into a string.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/strtocurrency.html"><code>aqConvert.StrToCurrency</code></a></td><td>Converts the specified string to a currency value.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/strtodate.html"><code>aqConvert.StrToDate</code></a></td><td>Converts the specified string to a date value.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/strtodatetime.html"><code>aqConvert.StrToDateTime</code></a></td><td>Converts the specified string to a date/time value.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/strtofloat.html"><code>aqConvert.StrToFloat</code></a></td><td>Converts the specified string to a floating-point value.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/strtoint.html"><code>aqConvert.StrToInt</code></a></td><td>Converts the specified string to an integer value.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/strtoint64.html"><code>aqConvert.StrToInt64</code></a></td><td>Converts the specified string to a long integer value.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/strtotime.html"><code>aqConvert.StrToTime</code></a></td><td>Converts the specified string to a time value.</td></tr>
<tr><td><a href="https://support.smartbear.com/testcomplete/docs/reference/program-objects/aqconvert/vartostr.html"><code>aqConvert.VarToStr</code></a></td><td>Converts the specified variant value to a string.</td></tr>
</tbody>
</table>
Furthermore, you can use native VBScript functions that operate with strings. 
A detailed description of VBScript functions can be found in the <a href="http://msdn.microsoft.com/en-us/library/3ca8tfek(v=vs.84).aspx" target="_blank" rel="noopener noreferrer">Functions (VBScript)</a> article of the MSDN  library. 
The table below only lists major functions:
<table class="aqTable" width="90%" cellspacing="0" cellpadding="0">
<thead>
<tr>
<th class="aqTableHeader" width="40%">Function</th>
<th class="aqTableHeader" width="60%">Description</th></tr>
</thead>
<tbody>
<tr><td>Asc(<i>string</i>)</td><td>Returns the ASCII character code corresponding to the first letter in a string.</td></tr>
<tr><td>Chr(<i>charcode</i>)</td><td>Returns the character associated with the specified ANSI character code.</td></tr>
<tr><td>CStr(<i>expression</i>)</td><td>Returns an expression that has been converted to a variant of sub-type string.</td></tr>
<tr><td>Escape(<i>charString</i>)</td><td>Encodes a string so it only contains ASCII characters. 
Non-ASCII characters are replaced with <b>%</b><i>xx</i> encoding, where <i>xx</i> is equivalent to the hexadecimal number representing the character.</td></tr>
<tr><td>InStr([<i>startpos</i>, ]<i>string1</i>, <i>string2</i>[, <i>compare</i>])</td><td>Returns the position of the first occurrence for one string within another.The search can start at a given position and use binary (compare=0) or text (compare=1) comparisons.</td></tr>
<tr><td>InStrRev(<i>string1</i>, <i>string2</i>[, <i>start</i>[, <i>compare</i>]])</td><td>Returns the position of an occurrence for one string within another, from the end of string. 
The search can start at a given position and use binary (compare=0) or text (compare=1) comparisons.</td></tr>
<tr><td>Join(<i>list</i>[, <i>delimiter</i>])</td><td>Returns a string created by joining a number of substrings contained in an array.</td></tr>
<tr><td>LCase(<i>string</i>)</td><td>Returns a string that has been converted to lowercase.</td></tr>
<tr><td>Left(<i>string, length</i>)</td><td>Returns a specified number of characters from the left side of a string.</td></tr>
<tr><td>Len(<i>string</i> | <i>varname</i>)</td><td>Returns the number of characters in a string or the number of bytes required to store a variable.</td></tr>
<tr><td>LTrim(<i>string</i>)</td><td>Returns a copy of a string without leading spaces.</td></tr>
<tr><td>Mid(<i>string</i>, <i>start</i>[, <i>length</i>])</td><td>Returns a specified number of characters from a string.</td></tr>
<tr><td>Replace(<i>string, findstr, replacewith</i>[, <i>start</i>[, <i>count</i>[, <i>compare</i>]]])</td><td>Returns a string in which a specified substring has been replaced with another substring a specified number of times.</td></tr>
<tr><td>Right(<i>string, length</i>)</td><td>Returns a specified number of characters from the right side of a string.</td></tr>
<tr><td>RTrim(<i>string</i>)</td><td>Returns a copy of a string without trailing spaces.</td></tr>
<tr><td>Space(<i>number</i>)</td><td>Returns a string consisting of the specified number of spaces.</td></tr>
<tr><td>Split(<i>expression</i>[, <i>delimiter</i>[, <i>count</i>[, <i>compare</i>]]])</td><td>Returns a zero-based, one-dimensional array containing a specified number of substrings.</td></tr>
<tr><td>StrComp(<i>string1, string2</i>[, <i>compare</i>])</td><td>Returns a value indicating the result of a string comparison.</td></tr>
<tr><td>String(<i>number, character</i>)</td><td>Returns a repeating character string of the length specified.</td></tr>
<tr><td>StrReverse(<i>string</i>)</td><td>Returns a string in which the character order of a specified string is reversed.</td></tr>
<tr><td>Trim(<i>string</i>)</td><td>Returns a copy of a string without leading and trailing spaces.</td></tr>
<tr><td>UCase(<i>string</i>)</td><td>Returns a string that has been converted to uppercase.</td></tr>
<tr><td>Unescape(<i>charString</i>)</td><td>Decodes a string encoded with the Escape function.</td></tr>
</tbody>
</table>
<a name="SpecialCharacters"></a><h3 id="VBScriptSpecChars">Special characters</h3>

In VBScript you can emulate any character by using the <code>Chr</code> function  with the appropriate ASCII code. 
This also applies to special characters that are used to format string values. 
Alternatively, you can emulate control characters using native string constants. 
The table below lists the most frequently used special characters and their constants.
<table class="aqTable" cellspacing="0" cellpadding="0">
<thead>
<tr>
<th class="aqTableHeader">Description</th>
<th class="aqTableHeader">Character sequence</th></tr>
</thead>
<tbody>
<tr><td>Carriage return.</td><td><code>Chr</code>(13) -- or -- <code>vbCr</code></td></tr>
<tr><td>Line feed.
 On Unix platforms it is interpreted as new line.</td><td><code>Chr</code>(10) -- or -- <code>vbLf</code></td></tr>
<tr><td>A combination of carriage return and line feed.
 On Windows platforms it is interpreted as new line.</td><td><code>Chr</code>(13)+<code>Chr</code>(10) -- or -- <code>VbCrLf</code></td></tr>
<tr><td>New line.
 Either a line feed character or a combination of carriage return and line feed.</td><td><code>vbNewLine</code></td></tr>
<tr><td>Form feed.</td><td><code>Chr</code>(12) -- or -- <code>vbFormFeed</code></td></tr>
<tr><td>Horizontal tab.</td><td><code>Chr</code>(9) -- or -- <code>vbTab</code></td></tr>
<tr><td>Vertical tab.</td><td><code>Chr</code>(11) -- or -- <code>vbVerticalTab</code></td></tr>
</tbody>
</table>
Special characters obtained by a function or constant should be joined to the string by <a href="#VBScriptConcat">concatenation</a>:

Str1 = "A string." & Chr(13) & Chr(10) & "Another string."

Str2 = "A string." & vbNewLine & "Another string."



<h3 id="VBScriptStrLen">Getting the string length</h3>

To obtain the total number of characters in a string, you can call either the <a href="../../../reference/program-objects/aqstring/getlength.html"><code>aqString.GetLength</code></a> method, or the <code>Len</code> function of VBScript.
The character position in VBScript is not zero-based, so the maximum position number in a string equals the string length. 
The following code demonstrates both ways of obtaining the string length:

<b>Sub</b> StringLengthDemo
  <b>Dim</b> aString
  aString="Some text"
  Log.Message("The string is " & aqString.GetLength(aString) & " character(s) long.")
  Log.Message("The string is " & Len(aString) & " character(s) long.")
<b>End</b> <b>Sub</b>
<table class="aqNoteTableStyle">
<tbody><tr>
<td><img class="lazy" data-src="/testcomplete/docs/_assets/commonImages/pay-attention.gif"></td>
<td>Using TestComplete, you can limit the length of string parameters returned by functions of the tested application. 
For this purpose, use the <a href="https://support.smartbear.com/testcomplete/docs/working-with/managing-projects/properties/open-apps/debug-agent.html"><span class="aqOption">Maximum string length of [out] parameters</span></a> project property. 
If the length of the string returned from the application via one of its out parameters exceeds the property’s value, TestComplete treats the returned string as a null one.</td></tr>
</tbody></table>

<h3 id="VBScriptConcat">Concatenating strings</h3>

The operation that forms a string out of several others is called <span class="orange">concatenation</span>. 
The <code>aqString</code> object has special method <a href="../../../reference/program-objects/aqstring/concat.html"><code>aqString.Concat</code></a> that perform this operation. 
In VBScript the concatenation is performed both by plus (+) and by ampersand (&) operators. 
The plus operator is intended to perform addition, but if both operators are strings, then string concatenation occurs. 
However it is more convenient to use the ampersand operator since it does not require a preliminary conversion to a string type.
This sample code shows how to make a string out of several substrings:

<b>Sub</b> ConcatenationDemo
  <b>Dim</b> Str1
  Str1 = "String No 1 "
  Log.Message(aqString.Concat(Str1, "String No 2"))
  Log.Message(Str1 + "String No 2 " + "String No " + aqConvert.IntToStr(3))
  Log.Message(Str1 & "String No 2 " & "String No " & 3)
<b>End</b> <b>Sub</b>

<h3 id="VBScriptComparing">Comparing strings</h3>

String comparison is widely used during testing. 
Generally, a test procedure obtains textual data (user input, file contents, property values and so on) and then compares it with the expected data. 
That is why both TestComplete and VBScript have their own methods to compare one string value with another. 
These methods are: <a href="../../../reference/program-objects/aqstring/compare.html"><code>aqString.Compare</code></a> and <code>StrComp</code>.
The <code>aqString.Compare</code> method has three parameters: two of them,  <span class="aqParam">String 1</span> and <span class="aqParam">String2</span>, specify the strings to be compared; the third parameter (<span class="aqParam">CaseSensitive</span>) defines whether the comparison should be case-sensitive or not.
Similarly, VBScript's <code>StrComp</code> function has two mandatory parameters, <span class="aqParam">Str1</span> and <span class="aqParam">Str2</span>, that define the compared strings, and one optional parameter, <span class="aqParam">CompType</span>, that specifies the comparison type. 
The <span class="aqParam">CompType</span> parameter can accept the following values: <code>vbBinaryCompare</code> (or <code>0</code>), and <code>vbTextCompare</code> (or <code>1</code>). 
<code>vbBinaryCompare</code> means binary case-sensitive comparison. 
<code>vbTextCompare</code> means case-insensitive comparison. 
The default type is <code>vbBinaryCompare</code>. 
The function result is -1 if <span class="aqParam">Str1</span> is less than <span class="aqParam">Str2</span>, 1 if <span class="aqParam">Str1</span> is greater than <span class="aqParam">Str2</span> and they equal 0 if the strings are the same.
Both methods can compare strings holding specific national symbols, for example characters with diacritical marks (<img class="lazy" data-src="../../../_images/app-objects/simulating/agrave.gif" border="0"> , <img class="lazy" data-src="../../../_images/app-objects/simulating/acirc.gif" border="0"> , <img class="lazy" data-src="../../../_images/app-objects/simulating/ccedil.gif" border="0">  and others).
The code below demonstrates how to use both methods:

<i>' This helper function obtains the integer comparison result from the</i>
<i>' StrComp routine and returns a textual interpretation of the result.</i>
<b>Function</b> GetComparisonStr(IntegerComparisonResult)
  <b>If</b> IntegerComparisonResult = 0 <b>Then</b>
        GetComparisonStr = CStr(IntegerComparisonResult) & ". 
The strings are the same."
      <b>Else</b>
        GetComparisonStr = CStr(IntegerComparisonResult) & ". 
The strings are different."
  <b>End</b> <b>If</b>
<b>End</b> <b>Function</b>

<b>Sub</b> StringComparison
  <i>' Use the method of the aqString object </i>
  Log.Message("aqString.Compare(""Abra"", ""abra"", False): " & aqString.Compare("Abra", "abra", <b>False</b>))
  Log.Message("aqString.Compare(""Abra"", ""abra"", True): "& aqString.Compare("Abra", "abra", <b>True</b>))

  <i>' Use the native routine of VBScript </i>
  Log.Message("StrComp(""abra"", ""ABRA"", vbBinaryCompare): " & GetComparisonStr(StrComp("abra", "ABRA", vbBinaryCompare)))
  Log.Message("StrComp(""abra"", ""ABRA"", vbTextCompare): " & GetComparisonStr(StrComp("abra", "ABRA", vbTextCompare)))

  <i>' Working with native-language characters</i>
  <i>' The following code assumes that the French layout is installed on the computer</i>
  <i>' 040C is the identifier of the French layout </i>
  <b>If</b> IsLanguageSupported(&H040C) <b>And</b> SetKeyboardLayout(Sys.Process("TestComplete").Id, "0000040c") <b>Then</b>
    Log.Message("aqString.Compare(""français"", ""Français"", False): " & aqString.Compare("français","Français", <b>True</b>))
    Log.Message("aqString.Compare(""français"", ""Français"", True): " & aqString.Compare("français","Français", <b>False</b>))
    Log.Message("aqString.Compare(""français"", ""francais"", True): " & aqString.Compare("français","francais", <b>False</b>))

    Log.Message("StrComp(""français"", ""Français"", vbBinaryCompare): " & GetComparisonStr(StrComp("français", "Français", vbBinaryCompare)))
    Log.Message("StrComp(""français"", ""Français"", vbTextCompare): " & GetComparisonStr(StrComp("français", "Français", vbTextCompare)))
    Log.Message("StrComp(""français"", ""francais"", vbTextCompare): " & GetComparisonStr(StrComp("français", "francais", vbTextCompare)))
  <b>End If</b>
<b>End</b> <b>Sub</b>


<h3 id="VBScriptGetChar">Accessing individual character of a string</h3>

The VBScript scripting language has no data type that can be used to store single symbols. 
However, this is not a problem, since the string type can hold both a series of characters and individual characters. 
Moreover, you can extract a single character from a string using the <a href="../../../reference/program-objects/aqstring/getchar.html"><code>aqString.GetChar</code></a> method and VBScript’s <code>Mid</code> function. 
The latter retrieves the given number of characters starting from the specified position.
Note however that the VBScript function uses 1-based indexes, whereas the <code>GetChar</code> method uses zero-based indexes. 
The sample routine below demonstrates how to use both of these routines. 
It posts text to TestComplete log in two different ways:  as a whole string and by a single letter.

<b>Sub</b> StringByLetter
  <b>Dim</b> aString, i
  aString = "Per aspera ad astra"
  Log.Message("The string is : " & aString)
  Log.Message("And now this text letter by letter using aqString.GetChar:")
  <b>For</b> i = 0 <b>To</b> aqString.GetLength(aString)-1
    Log.Message(aqString.GetChar(aString, i))
  <b>Next</b>
  Log.Message("And now this text letter by letter using Mid function:")
  <b>For</b> i = 1 <b>To</b> Len(aString)
    Log.Message(Mid(aString, i, 1))
  <b>Next</b>
<b>End</b> <b>Sub</b>

<h3 id="VBScriptTextSearch">Searching for characters and substrings</h3>

One of the most common tasks that one has to perform when working with string values is determining whether specific text is part of a string. 
To perform such tasks, the <code>aqString</code> object has the <a href="../../../reference/program-objects/aqstring/find.html"><code>Find</code></a> method. 
If the specified substring was found, the method returns the number of the first occurrence of the substring within the source string. 
If the specified substring was not found, the method returns -1:

<b>Sub</b> StringOccurrenceDemo
  <b>Dim</b> aString, aSubString, Res

  aString = "Per aspera ad astra"
  aSubString = "astra"
  Res = aqString.Find(aString, aSubString)
  <b>If</b> Res &lt;&gt; -1 <b>Then</b>
    Log.Message("A substring '" & aSubString & "' was found in string '" & aString & "' at position " & Res)
  <b>Else</b>
    Log.Message("There are no occurrences of '" & aSubString & "' in '" & aString & "'")
  <b>End</b> <b>If</b>
<b>End</b> <b>Sub</b>

You can also get the position where the specified substring occurs using the VBScript functions <code>InStr</code> and <code>InStrRev</code>. 
They both return the initial position (from 1) of the first substring match, but the first one searches from left to right, while the other from right to left. 
If the substring was found, the functions return the initial position of the first substring match. 
If no occurrences were found, they return 0. 
The code below demonstrates how to use the <code>InStr</code> function:


<b>Sub</b> TextPosDemo
  <b>Dim</b> aString, aSubString, findpos

  aString = "Per aspera ad astra"
  aSubString = "astra"
  findpos = InStr(aString, aSubString)
  <b>If</b> findpos &lt;&gt; 0 <b>Then</b>
    Log.Message("A substring '" & aSubString & "' was found at position " & findpos)
  <b>Else</b>
    Log.Message("There are no occurrences of '" & aSubString & "' in '" & aString & "'")
  <b>End</b> <b>If</b>
<b>End</b> <b>Sub</b>

<h3 id="VBScriptGetStr">Getting a substring</h3>

VBScript has several methods that allow you to extract a substring out of a string.
They are <code>Left, Right</code> and <code>Mid</code>. 
These methods vary in how the extracted substring is defined.
Function <code><b>Left</b></code>  returns a text fragment that starts at the beginning of the given string and has the specified length. 
Function <code><b>Right</b></code> does a similar action, but it gets the last fragment of the given string. 
If the fragment’s length is greater than the length of the whole string, then the entire string is returned. 
Negative length values are not allowed, zero-length returns an empty string.
Function <code><b>Mid</b></code> returns a text fragment that starts at a given position and has a specified length. 
The length parameter is optional, and if it is omitted then the resulting substring continues up to the end of the source string.
The <code>aqString</code> object also has a similar method, <a href="../../../reference/program-objects/aqstring/substring.html"><code>SubString</code></a> that returns a substring that starts from the specified position and has the given length. 
However, this method requires all tree parameters, and position numbers are zero-based.
The sample code below demonstrates how to use these functions:

<b>Sub</b> GetStringDemo
  <b>Dim</b> Str
  Str = "123456789"

  Log.Message("Function 'Left' demo:")
  Log.Message(Left(Str, 3))    <i>' Posts "123"</i>
  Log.Message(Left(Str, 20))   <i>' Posts "123456789"</i>
  Log.Message(Left(Str, 0))    <i>' Posts ""</i>

  Log.Message("Function 'Right' demo:")
  Log.Message(Right(Str, 3))    <i>' Posts "789"</i>
  Log.Message(Right(Str, 20))   <i>' Posts "123456789"</i>
  Log.Message(Right(Str, 0))    <i>' Posts ""</i>

  Log.Message("Function 'Mid' demo:")
  Log.Message(Mid(Str, 4, 3))  <i>' Posts "456"</i>
  Log.Message(Mid(Str, 5))    <i>' Posts "456789"</i>
  Log.Message(Mid(Str, 4, 0))  <i>' Posts ""</i>

  Log.Message("Method 'aqString.SubString' demo:")
  Log.Message(aqString.SubString(Str, 3, 3))  <i>' Posts "456"</i>
  Log.Message(aqString.SubString(Str, 4, 20)) <i>' Posts "56789" </i>
  Log.Message(aqString.SubString(Str, 2, 0))  <i>' Posts ""</i>
<b>End</b> <b>Sub</b>


<h3 id="VBScriptSplit">Splitting strings</h3>

Sometimes it is required to make several strings out of a single string. 
This operation splits a string into substrings. 
It can be performed by VBScript's native function called <code>Split</code>. 
This routine searches the string for a delimiter character, separates the string and returns an array holding the constituent strings. 
If the delimiter is omitted, then the space character is assumed as a delimiter. 
Also you can constrain the maximum array length with the third parameter and set the comparison method with the forth. 
They are not obligatory and can be omitted. 
The same method can be used to split a string onto substrings, sentences and even separate words; it all depends on the specified delimiter. 
The first sample routine below uses a space character as a delimiter to extract words out of a string, and the second routine splits the string by line breaks:

<b>Sub</b> SplitDemo
    <b>Dim</b> s, ss

    s = "Better late than never but better never late."
    <i>' Split at each space character.</i>
    ss = Split(s)
    Log.Message("There are " & (UBound(ss)+1) & " words in the array")
    Log.Message("The first word is: " & ss(0))
<b>End</b> <b>Sub</b>
<b>Sub</b> SplitDemo2
    <b>Dim</b> s, ss

    s = "Better late than never " & Chr(13) & " but better never late."
    <i>' Split at line break character.</i>
    ss = Split(s, Chr(13))
    Log.Message("There are " & (UBound(ss)+1) & " words in the array")
    Log.Message("The first word is: " & ss(0))
<b>End</b> <b>Sub</b>

<a id="GetListItem1" name="GetListItem1"></a>TestComplete has a similar method called <a href="../../../reference/program-objects/aqstring/getlistitem.html">aqString.GetListItem</a>. 
It extracts a substring with the specified index from the input string. 
It was designed to read items from a string list, see <a href="#VBScriptStringLists">Working with string lists</a> for more information. 
However, it allows you to redefine the delimiter characters and, like the <code>Split</code> method, it can be used to get sentences, single words and so on.

<b>Sub</b> SplitDemo3
    <b>Dim</b> s, prevSep

    s = "Better late than never but better never late."
    <i>' Assign list separator to space character</i>
    prevSep = aqString.ListSeparator
    aqString.ListSeparator = " "
    <i>' Split by spaces</i>
    Log.Message("There are " & aqString.GetListLength(s) & " words in a string")
    Log.Message("The first word is: " & aqString.GetListItem(s, 0))
    <i>' Restore previous separator</i>
    aqString.ListSeparator = prevSep
<b>End</b> <b>Sub</b>

<h3 id="VBScriptTrimming">Removing extra spaces from a string</h3>

The <code>aqString</code> object has a special routine, <a href="../../../reference/program-objects/aqstring/trim.html"><code>aqString.Trim</code></a>, that excludes leading and trailing spaces (or both) from a string. 
VBScript has also the <code>LTrim, RTrim</code> and <code>Trim</code> functions that exclude, leading, trailing and both leading and trailing spaces from the input string.
Generally, all these methods are used to remove unnecessary spaces at the beginning or at the end of strings obtained from the user input.

<b>Sub</b> TrimDemo
  <b>Dim</b> str
  str="  Hallo  "

  Log.Message("'" & aqString.Trim(str, aqString.stLeading) & "'")  <i>'Posts 'Hallo  '</i>
  Log.Message("'" & aqString.Trim(str, aqString.stTrailing) & "'") <i>'Posts '  Hallo' </i>
  Log.Message("'" & aqString.Trim(str, aqString.stAll) & "'")      <i>'Posts 'Hallo'</i>

  Log.Message("'" & LTrim(str) & "'")  <i>' Posts 'Hallo  '</i>
  Log.Message("'" & RTrim(str) & "'")  <i>' Posts '  Hallo' </i>
  Log.Message("'" & Trim(str) & "'")   <i>' Posts 'Hallo'</i>
<b>End</b> <b>Sub</b>
Another function that can be useful when handling user input strings is excluding extra inner spaces out of the string. 
This function seems to be similar to <code>Trim</code>, but the latter only removes spaces at the beginning or end of the string and does not affect the spaces inside the string. 
The general idea of the function is for the string to be parsed into separate words and then a new string is constructed. 
The new string consists of the same words but is separated with a single space between words. 


<b>Function</b> TrimInner(Str)
    <b>Dim</b> WordArray, i
    WordArray = Split(Str)
    Str = ""
    <b>For</b> i = 0 <b>To</b> UBound(WordArray)
      <b>If</b> WordArray(i) &lt;&gt; "" <b>Then</b> Str = Str & WordArray(i) & " "
    <b>Next</b>
    TrimInner = Trim(Str)
<b>End</b> <b>Function</b>


<i>'An example of how to use this function</i>
<b>Sub</b> TrimInnerDemo
  Log.Message(TrimInner("Follow the     white rabbit"))
<b>End</b> <b>Sub</b>

<h3 id="VBScriptReplaceStr">Replacing characters and substrings</h3>

Quite often we need to find and replace a character or substring within a string. 
There are two ways to do this: by using the <code><a href="../../../reference/program-objects/aqstring/replace.html">aqString.Replace</a></code> method or by using the <code>Replace</code> method of a <code>RegExp</code> object.
The <code>aqString</code> object method is much easier to use. 
It can be used when you need to change a certain character or string. 
It allows you to set whether the search should be case-sensitive or not. 
Here is an example of how to use this method:

<b>Sub</b> StringReplaceDemo
  <b>Dim</b> str
  str = "Hi, Bob. 
Have you seen Bob Robbinson?"

  str = aqString.Replace(str, "Bob", "Jack")
  Log.Message(str)
<b>End</b> <b>Sub</b>
The <code>RegExp.Replace</code> method is a little more complicated, but it offers more flexibility. 
You can not only change a definite character or string, but all fragments matching the specified regular expression pattern. 
However you have to create an instance of the <code>RegExp</code> object and set the pattern before replacing. 
The regular expression pattern is enclosed in double quotation marks ("). 
Additionally you can specify the following Boolean flags that affect the search procedure: <code>RegExp.Global</code>  - performs a global search for all occurrences of a pattern, <code>RegExp.IgnoreCase</code> - searches regardless of the letter case and <code>RegExp.MultiLine</code> - performs a multi-line search. 
For a full description of how to use regular expressions, refer to the <a href="http://msdn.microsoft.com/en-us/library/6wzad2b2(v=vs.84).aspx" target="_blank" rel="noopener noreferrer">Introduction to Regular Expressions</a> article in the MSDN library.
The first sample demonstrates how to change a definite string using the <code>replace</code> method.

<b>Sub</b> RegExReplaceDemo1
  <b>Dim</b> str, re
  str = "Hi, Bob. 
Have you seen Bob Robbinson?"
  <i>' Create RegExp instance.</i>
  <b>Set</b> re = <b>New</b> RegExp
  <i>' Define regular expression pattern</i>
  re.Pattern = "Bob"
  <i>' Set global search flag</i>
  re.Global = <b>True</b>
  <i>' Perform replace operation</i>
  str = re.Replace(str, "Jack")
  Log.Message(str)
<b>End</b> <b>Sub</b>
The second example shows how to replace a substring with alternative parts. 
The patterns of alternative parts are separated by pipe characters (" | "). 
For instance in the sample below the "ht(ml|m)" pattern matches both <i>html</i> and <i>htm</i>:

<b>Sub</b> RegExReplaceDemo2
  <b>Dim</b> str, re
  str = "The html is widely used in Internet. 
The HTM file is a text file with tags."
  <i>' Create RegExp instance.</i>
  <b>Set</b> re = <b>New</b> RegExp
  <i>' Define regular expression pattern.</i>
  re.Pattern = "ht(ml|m)"
  <i>' Set global search flag</i>
  re.Global = <b>True</b>
  <i>' Set ignore letter case flag</i>
  re.IgnoreCase = <b>True</b>
  <i>' Perform replace operation</i>
  str = re.Replace(str, "hypertext markup language")
  Log.Message(str)
<b>End</b> <b>Sub</b>
Furthermore, using regular expressions you can search for the text fragments that match the specified format. 
In the next sample, all dates written in the  DD/MM/YYYY format are substituted with the <i>Some Date</i> string. 
This operation can be useful, for example, when comparing two reports that contain the generation date.

<b>Sub</b> RegExReplaceDemo3
  <b>Dim</b> str, re
  str = "Date of report: 30/04/2005."
  <i>' Create RegExp instance.</i>
  <b>Set</b> re = <b>New</b> RegExp
  <i>' Define regular expression pattern.</i>
  re.Pattern = "\d{1,2}.\d{1,2}.\d{2,4}"
  <i>' Set global search flag</i>
  re.Global = <b>True</b>
  <i>' Perform replace operation</i>
  str = re.Replace(str, "Some Date")
  Log.Message(str)
<b>End</b> <b>Sub</b>

<h3 id="VBScriptLetterCase">Changing the letter case</h3>

A string can contain both uppercase and lowercase letters. 
The TestComplete <code>aqString</code> object and the native <code>String</code> object have methods that convert uppercase letters to lowercase and vice versa. 
They are: <code><a href="../../../reference/program-objects/aqstring/tolower.html">aqString.ToLower</a>, <a href="../../../reference/program-objects/aqstring/toupper.html">aqString.ToUpper</a>, LCase</code> and <code>UCase</code>.
The code below demonstrates how all of these methods are applied.

<b>Sub</b> LetterCaseDemo
  <b>Dim</b> str
  str = "The word 'Champagne' is of French origin"

  <i>' Converting to lower case</i>
  Log.Message(aqString.ToLower(str))
  Log.Message(LCase(str))

  <i>' Converting to upper case</i>
  Log.Message(aqString.ToUpper(str))   
  Log.Message(UCase(str))
<b>End</b> <b>Sub</b>

<h3 id="VBScriptStringLists">Working with string lists</h3>

Some scripting objects, generally, controls like ListBoxes, ComboBoxes and Memos, return information about their state or contents as string lists. 
Individual data elements (or items) in this list are separated by commas, line breaks, carriage returns or some other delimiter characters.
The <code>aqString</code> object has a number of specific methods (<a href="../../../reference/program-objects/aqstring/addlistitem.html"><code>AddListItem</code></a>, <a href="../../../reference/program-objects/aqstring/changelistitem.html"><code>ChangeListItem</code></a>, <a href="../../../reference/program-objects/aqstring/deletelistitem.html"><code>DeleteListItem</code></a>, <a href="../../../reference/program-objects/aqstring/getlistitem.html"><code>GetListItem</code></a> and <a href="../../../reference/program-objects/aqstring/getlistlength.html"><code>GetListLength</code></a>) that are used to work with such lists. 
<code>AddListItem</code> and <code>DeleteListItem</code> add an item to or remove if from the list respectively. 
The <code>GetListItem</code> method retrieves the item with the given index, and <code>ChangeListItem</code> assigns a new value to the given item. 
The <code>GetListLength</code> method returns the total number of items in the string list.
The symbol that is used as the separator between list items is defined by the <a href="../../../reference/program-objects/aqstring/listseparator.html"><code>ListSeparator</code></a> property. 
By default, the list separator is a pipe (|), but it can also be a comma, column, line break, carriage return, tabulation, and any other printable and non-printable character, or even several characters.
Here is sample code that demonstrates how to work with the string lists returned by scripting objects.

<b>Sub</b> ListDialogOptions
    <b>Dim</b> StrList, prevSep, i

    <i>' Get a string with dialog options</i>
    OptStr = UserForms.UserForm1.SaveDialog1.Options
    <i>' Assign a comma as the list separator</i>
    prevSep = aqString.ListSeparator 
    aqString.ListSeparator = "," 
    <i>' Get the number of dialog options </i>
    Log.Message("The dialog has " & aqString.GetListLength(OptStr) & " option(s) enabled:")
    <i>' Iterate through the options list</i>
    <b>For</b> i = 0 <b>To</b> aqString.GetListLength(OptStr)-1
      <i>' Get an option and post it to the log</i>
      Log.Message("Option No " & (i+1) & " is: " & aqString.GetListItem(OptStr, i))
      <b>Next</b>
    <i>' Restore the previous separator</i>
    aqString.ListSeparator = prevSep
<b>End</b> <b>Sub</b>

<b>Sub</b> ManageMemoText
    <b>Dim</b> StrList, prevSep

    <i>' Get a string with memo lines</i>
    StrList = UserForms.UserForm1.cxMemo1.Lines.Text
    <i>' Post the memo contents to the log</i>
    Log.Message(UserForms.UserForm1.cxMemo1.Lines.Text) 
    <i>' Assign a newline character as the list separator</i>
    prevSep = aqString.ListSeparator 
    aqString.ListSeparator = vbNewLine     
    <i>' Append one more line </i>
    StrList = aqString.AddListItem(StrList, "Last Line")
    Log.Message(StrList)
    <i>' Change the value of the first line</i>
    StrList = aqString.ChangeListItem(StrList, "New First Line", 0) 
    <i>' Add the memo contents to a new list</i>
    UserForms.UserForm1.cxMemo1.Lines.Text = StrList 
    <i>' Post the memo contents to the log</i>
    Log.Message(UserForms.UserForm1.cxMemo1.Lines.Text)
    <i>' Restore the previous separator</i>
    aqString.ListSeparator = prevSep 
<b>End</b> <b>Sub</b>


<h2>to dispaly an image</h2>
Set objHtml = CreateObject("InternetExplorer.Application")
With objHtml
    .Navigate "about:blank"
    .Visible = 1
    .Toolbar=False
    .Statusbar=False
    .Top=440
    .Left=1040
    .Height=400
    .Width=300
    .Document.Body.InnerHTML = "<body onkeypress='window.close()'><img src='https://media.tenor.com/images/eff22afc2220e9df92a7aa2f53948f9f/tenor.gif' style='height:100%'>"
End With


objHtml.navigate(surl) 'Navigate to the website

'Set the browser to fullscreen and theatermode
objHtml.Fullscreen=true
'This makes the window not closable until the user exits the page using a script on the html
'page that has a window.close command or they use Alt-F4
'Setting the TheaterMode on and then off makes the object show properly.

objHtml.TheaterMode=true
objHtml.TheaterMode=false

'Turn off the status bar
objHtml.statusbar=false

'Turn off the toolbar
objHtml.toolbar=false

'Turn off Resizable
objHtml.Resizable=false

objHtml.document.focus()
'Set the browser to focus which brings it to the top.
' dont work

objHtml.top =0
objHtml.Left=0
'Sets the window to the upper left hand corner


<h2>vbs now function</h2>
The now function returns the current date and time

Now   = 2/29/2016 1:02:03 PM
Date  = 2/29/2016
Time  = 1:02:03 PM
Timer = 78826.31     ' seconds since midnight

FormatDateTime(Now)                = 2/29/2016 1:02:03 PM
FormatDateTime(Now, vbGeneralDate) = 2/29/2016 1:02:03 PM
FormatDateTime(Now, vbLongDate)    = Monday, February 29, 2016
FormatDateTime(Now, vbShortDate)   = 2/29/2016
FormatDateTime(Now, vbLongTime)    = 1:02:03 PM
FormatDateTime(Now, vbShortTime)   = 13:02

FormatDateTime(now, 4)             = 08:12

Year(Now)   = 2016
Month(Now)  = 2
Day(Now)    = 29
Hour(Now)   = 13
Minute(Now) = 2
Second(Now) = 3

Year(Date)   = 2016
Month(Date)  = 2
Day(Date)    = 29

Hour(Time)   = 13
Minute(Time) = 2
Second(Time) = 3

Function LPad (str, pad, length)
    LPad = String(length - Len(str), pad) & str
End Function

LPad(Month(Date), "0", 2)    = 02
LPad(Day(Date), "0", 2)      = 29
LPad(Hour(Time), "0", 2)     = 13
LPad(Minute(Time), "0", 2)   = 02
LPad(Second(Time), "0", 2)   = 03

Weekday(Now)                     = 2
WeekdayName(Weekday(Now), True)  = Mon
WeekdayName(Weekday(Now), False) = Monday
WeekdayName(Weekday(Now))        = Monday

MonthName(Month(Now), True)  = Feb
MonthName(Month(Now), False) = February
MonthName(Month(Now))        = February

Set os = GetObject("winmgmts:root\cimv2:Win32_OperatingSystem=@")
os.LocalDateTime = 20131204215346.562000-300
Left(os.LocalDateTime, 4)    = 2013 ' year
Mid(os.LocalDateTime, 5, 2)  = 12   ' month
Mid(os.LocalDateTime, 7, 2)  = 04   ' day
Mid(os.LocalDateTime, 9, 2)  = 21   ' hour
Mid(os.LocalDateTime, 11, 2) = 53   ' minute
Mid(os.LocalDateTime, 13, 2) = 46   ' second

Dim wmi : Set wmi = GetObject("winmgmts:root\cimv2")
Set timeZones = wmi.ExecQuery("SELECT Bias, Caption FROM Win32_TimeZone")
For Each tz In timeZones
    tz.Bias    = -300
    tz.Caption = (UTC-05:00) Eastern Time (US & Canada)
Next

There are also separate Time() and Date() functions.

Show time in form 24 hours
Right("0" & hour(now),2) & ":" & Right("0" & minute(now),2)
// 01:35
Right("0" & hour(now),2)    //01
Right("0" & minute(now),2)  //35

msgbox "month: " & Month(Now) & " day: " & Day(Now)
// month: 8 day: 18


<h2>vbs read text file</h2>
Use the method OpenTextFile

Set fso = CreateObject("Scripting.FileSystemObject")
Set file = fso.OpenTextFile("testfile.txt", 1)
content = file.ReadAll
msgbox content

or line by line with the method ReadLine:
Set dict = CreateObject("Scripting.Dictionary")
Set file = fso.OpenTextFile ("c:\test.txt", 1)
row = 0
Do Until file.AtEndOfStream
  line = file.Readline
  dict.Add row, line
  row = row + 1
Loop

file.Close

'Loop over it
For Each line in dict.Items
  WScript.Echo line
Next



<h2>VBA Variant</h2>
A VBA Variant is a VBA variable that has not been declared to have a specific data type. 
It can therefore hold any type of data that VBA variables are able to hold – be it text, numbers, dates, time or objects.

Variants use more memory than variables in which the data type is specified, and therefore can slow down the execution of the program that you are running.

If you have large procedures or complicated code, this speed can be extremely important in the efficient running of your program. 
So the rule of the thumb should be to always specify what data is going to be held in your variable by explicitly declaring them.

Why would I use a variant then?
There may be some occasions where you need to use a variant. 
When you declare your variables, you are restricted to what type of data is stored in the variable – so if you declare an integer, for example, the data that is stored in that variable has to be between -32768 to 32767. 
If the number that is going into that variable falls outside of that scope, your code will end up throwing an error.

This would be particularly annoying if you were importing data into Excel from a database using VBA code for example – some of the data may need ‘cleaning’ – a number may perhaps have a rogue letter in it and therefore if imported as a number, would end up breaking the program at that point. 
 Using a variant variable could solve this problem.

Sub Test1()
Dim ProductPrice As Currency
Dim Qty As Double
Dim TaxAmount as Currency
Dim FinalAmount as Currency

ProductPrice = "$5.00 "
Qty = "10"
TaxAmount = "$4.14"
FinalAmount = "$54.14"

Range("A1 ") = ProductPrice
Range("B1 ") = Qty
Range("C1 ") = TaxAmount
Range("D1 ") = FinalAmount
However, when you try to run this code, the following error appears.

<img class="lazy" data-src="https://software-solutions-online.com/wp-content/uploads/2020/08/vba-variant-01-runtime-error-13.png?ezimgfmt=ng:webp/ngcb7">

This is due to the dollar signs that are in the data – the Product Price, Tax Amount and Final Amount have been declared as numbers – yet the data being populated into those variables contains a $ – therefore turning the number into a string – hence an error will occur.

However, if you amend your code…

Sub Test2()
Dim ProductPrice As Variant
Dim Qty As Variant
Dim TaxAmount as Variant
Dim FinalAmount as Variant

ProductPrice = "$5.00 "
Qty = "10"
TaxAmount = "$4.14"
FinalAmount = "$54.14"

Range("A1 ") = ProductPrice
Range("B1 ") = Qty
Range("C1 ") = TaxAmount
Range("D1 ") = FinalAmount
The correct information will then go into your Excel file:

<img class="lazy" data-src="https://software-solutions-online.com/wp-content/uploads/2020/08/vba-variant-02-excel-file-results.png?ezimgfmt=ng:webp/ngcb7">
So even though you declared your variables as variants, Excel cleverly knew to bring them in as numbers.

Things to remember and to watch out for
Variant variables take more memory and slow down your program

The Variant data type is automatically specified by the type of data it takes in – so in the four variables we created, three of them would have been string variables and one would have been a number variable.

Variant variables take in any data – which might make your code more difficult to debug.

In summary, if you know what data you are going to be storing in your variable, a good rule to follow is to always EXPLICITLY declare your variables ie as a string, integer, double or single for example. 
If you are worried about data being stored that it not of a specific type – then declare your variable IMPLICTLY using a VARIANT.


<h2>vbs read file and split</h2>
Set fso = CreateObject("Scripting.FileSystemObject")
Set file = fso.OpenTextFile("testfile.txt", 1)
content = file.ReadAll
msgbox content

outputObject = Split(content,"	")
MsgBox TypeName(outputObject)
for each x in outputObject
    MsgBox x
next
# the output is not arrange line by line


<h2>vbs read file, split into array and access element</h2>
Set fso = CreateObject("Scripting.FileSystemObject")
Set file = fso.OpenTextFile("testfile.txt", 1)

Do Until file.AtEndOfStream
    outputObject = file.Readline
    MsgBox outputObject
    output = Split(outputObject,"	")

    'to access element in array
    MsgBox "the leading element is: " &output(0)
    MsgBox "the trailing element is: " &output(1)

    for each x in output
      MsgBox "each element is: " & x
    next
Loop


<h2>reading and writing lines to a file</h2>
Set fso = CreateObject("Scripting.FileSystemObject")
' How to write file
outFileName="c:\test\autorun.inf"
Set outputFile = fso.CreateTextFile(outFileName,True)
outputFile.Write "test string" & vbCrLf
outputFile.Close

'How to read a file
inputFileName = "c:\test\file"
Set inputFile = objFS.OpenTextFile(inputFileName)

Do Until inputFile.AtEndOfStream
    strLine = inputFile.ReadLine
    Wscript.Echo strLine
Loop
inputFile.Close

'to get file path without drive letter, assuming drive letters are c:, d:, etc

strFile="c:\test\file"
s = Split(strFile,":")
WScript.Echo s(1)


<h2>Accessing array</h2>
https://www.tutorialspoint.com/vbscript/vbscript_arrays.htm
https://www.tutorialspoint.com/vbscript/vbscript_object_oriented.htm

to create an object:
set variablename = CreateObject("objectname")

Accessing the properties of an Object, use parentheses:
variable = object.property("arguments", "in", "parens")

Array Declaration
'Method 1 : Using Dim
Dim arr1() 'Without Size

'Method 2 : Mentioning the Size
Dim arr2(5) 'Declared with size of 5

'Method 3 : using 'Array' Parameter
Dim arr3
arr3 = Array("apple","Orange","Grapes")

arr(0) = "1"            'Number as String
arr(1) = "VBScript"     'String
arr(2) = 100            'Number
arr(3) = 2.45           'Decimal Number
arr(4) = #10/07/2013#   'Date
arr(5) = #12.45 PM#     'Time

Multi Dimension Arrays
Dim arr(2,3)	' Which has 3 rows and 4 columns
arr(0,0) = "Apple" 
arr(0,1) = "Orange"
arr(0,2) = "Grapes"           
arr(0,3) = "pineapple" 

arr(1,0) = "cucumber"           
arr(1,1) = "beans"           
arr(1,2) = "carrot"           
arr(1,3) = "tomato"    

arr(2,0) = "potato"             
arr(2,1) = "sandwitch"            
arr(2,2) = "coffee"             
arr(2,3) = "nuts"            

Redim Statement
used to declare dynamic-array variables and allocate or reallocate storage space.

ReDim [Preserve] varname(subscripts) [, varname(subscripts)]

Preserve − An Optional parameter used to preserve the data in an existing array when you change the size of the last dimension.

varname − A Required parameter, which denotes Name of the variable, which should follow the standard variable naming conventions.

subscripts − A Required parameter, which indicates the size of the array.

Dim a()
i = 0
redim a(5)
a(0) = "XYZ"
a(1) = 41.25
a(2) = 22
  
REDIM PRESERVE a(7)
For i = 3 to 7
a(i) = i
Next
  
'to Fetch the output
For i = 0 to ubound(a)
   Msgbox a(i)
Next

Array Methods
LBound	A Function, which returns an integer that corresponds to the smallest subscript of the given arrays.
UBound	A Function, which returns an integer that corresponds to the Largest subscript of the given arrays.
Split	A Function, which returns an array that contains a specified number of values. Splitted based on a Delimiter.
Join	A Function, which returns a String that contains a specified number of substrings in an array. This is an exact opposite function of Split Method.
Filter	A Function, which returns a zero based array that contains a subset of a string array based on a specific filter criteria.
IsArray	A Function, which returns a boolean value that indicates whether or not the input variable is an array.
Erase	A Function, which recovers the allocated memory for the array variables.


<h2>Run Command Line & Command From VBS</h2>
The problem is on this line:

oShell.run "cmd.exe /C copy "S:Claims\Sound.wav" "C:\WINDOWS\Media\Sound.wav"
Your first quote next to "S:Claims" ends the string; you need to escape the quotes around your files with a second quote, like this:

oShell.run "cmd.exe /C copy ""S:\Claims\Sound.wav"" ""C:\WINDOWS\Media\Sound.wav"" "

Set oShell = CreateObject("WScript.Shell") 
oShell.run "cmd.exe /C copy ""S:Claims\Sound.wav"" ""C:\WINDOWS\Media\Sound.wav"" "

Set oShell = CreateObject("WScript.Shell") 
oShell.run "cmd.exe /C C:\Users\william\Desktop\gravity.html"

<h2>convert text files to Unicode from UTF8</h2>
Unfortunately VBScript doesn't support this kind of conversion by itself.
use an ADODB.Stream object:

Set stream = CreateObject("ADODB.Stream")
stream.Open
stream.Type = 2 'text
stream.Charset = "utf-8"
stream.LoadFromFile "C:\input.txt"
text = stream.ReadText
stream.Close

Set fso = CreateObject("Scripting.FileSystemObject")
Set f = fso.OpenTextFile("C:\output.txt", 2, True, True)
f.Write text
f.Close

Or a little more streamlined:
Set fso = CreateObject("Scripting.FileSystemObject")
Set stream = CreateObject("ADODB.Stream")
stream.Open
stream.Type = 2 'text
stream.Charset = "utf-8"
stream.LoadFromFile "C:\input.txt"
fso.OpenTextFile("C:\output.txt", 2, True, True).Write stream.ReadText
stream.Close

If you want to replace the existing file you'll have to use the first version and use the same file for input and output.
Use a loop like this to iterate over all files in a folder:

Set fso = CreateObject("Scripting.FileSystemObject")
Set stream = CreateObject("ADODB.Stream")

For Each f In fso.GetFolder("C:\source\folder").Files
  stream.Open
  stream.Type = 2 'text
  stream.Charset = "utf-8"
  stream.LoadFromFile f.Path
  text = stream.ReadText
  stream.Close

  fso.OpenTextFile(f.Path, 2, True, True).Write text
Next

<h2>chinese inside VBScript</h2>
someone said VBScript does not support double byte characters. Use PowerShell instead.
but VBScript only understand ansi and Unicode.
You cannot use UTF-8 or any other encoding.

so to embed doubyte characters in vb script save or convert to unicode, ie utf-16 LE with bom

<h2>ask for input</h2>+
x = InputBox("the input message", "My Input Box title","default input text")
msgbox x


<h2>Xmlhttp Web Scrape</h2>
https://officetricks.com/vbscript-extract-data-web-scrape-parse-html/
Xmlhttp Web Scrape
https://stackoverflow.com/questions/12217761/vba-vbscripting-automated-web-scraping-looping-w-ie-logon
To get website data to using vbscript (.vbs) file, we need to know 2 processes. 
First one is to extract HTML code from website & then parse required data from HTML elements or tags.


To parse data from html, we can use the below commands on a htmlfile object.

getElementById(“idname”)
getElementsByClassName(“classname”)
getElementsByTagName(“tagname – a,p,div,table,td,tr etc.,”)
DOMobject.getAttribute(“attributename – title, href,class,id etc.,”)
DOMobject.parentElement.NextSibling


<strong>Objects Used: </strong>
CreateObject(“MSXML2.XMLHTTP”) 'To sent xmlhttp request to webserver & get html code
CreateObject(“htmlfile”) 'To parse data from html tags

To parse data from html, we can use the below commands on a htmlfile object.
getElementById(“idname”)
getElementsByClassName(“classname”)
getElementsByTagName(“tagname – a,p,div,table,td,tr etc.,”)DOMobject.getAttribute(“attributename – title, href,class,id etc.,”)
DOMobject.parentElement.NextSibling

There are plenty of functions like this to traverse through each tags or elements in a valid html file. 

Now, lets see a working example. 
To test this code, replace the URL with a valid website address.

myURL = "http://URL.com"

'Create XMLHTTP Object & HTML File
Set oXMLHttp = CreateObject("MSXML2.XMLHTTP")
Set ohtmlFile = CreateObject("htmlfile")

'Send Request To Web Server
oXMLHttp.Open "GET", myURL, False
oXMLHttp.send

'If Return Status is Success
If oXMLHttp.Status = 200 Then

    'Get Web Data to HTML file Object
    ohtmlFile.Write oXMLHttp.responseText
    ohtmlFile.Close
        
    'Parse HTML File
    Set oTable = ohtmlFile.getElementsByTagName("table")
    For Each oTab In oTable
        MsgBox oTab.Innertext
    Next
End If

'Process Completed
WScript.Quit

To execute this code, copy paste this code to a text editor & save the file as “testing.vbs”. 
Then double click on this file, Windows OS will start to execute the commands one by one.
<em><strong>Reference:</strong></em>
To write the extracted data to a Text file, <a href=https://officetricks.com/vba-open-text-file-import-data-any-programming-language/ target=_blank rel="noopener noreferrer">check this article</a> on how to write to a external file using vbs code.To scrape data from <a href=https://officetricks.com/extract-data-from-website-to-excel-vba/ target=_blank rel="noopener noreferrer">Webpage using Excel VBA</a>, refer this page.


<h2>read chinese from file</h2>
The FSO can read only ASCII text files. 
So the FSO cannot read Unicode files or to read binary file formats such as Microsoft Word or Microsoft Excel.

To read Unicode files, use ADO like this:
Dim objStream, strData
Set objStream = CreateObject("ADODB.Stream")

objStream.CharSet = "utf-8"
objStream.Open
objStream.LoadFromFile("textfile.txt")
strData = objStream.ReadText()
objStream.Close
Set objStream = Nothing

<h2>GetLocale and setlocale</h2>
MsgBox getLocale()

SetLocale(2052) 'set chinese locale
MsgBox getLocale()

Note: VBScript only understand ansi and Unicode.
You cannot use UTF-8 or any other encoding.
To hard code utf8 string, convert script file to unicode by notepad

<h2>detect numeric value</h2>
if IsNumeric(v) = False Then v = 0

<h2>write file</h2>
Set objFSO=CreateObject("Scripting.FileSystemObject")

' How to write file
outFile="c:\test\autorun.inf"
Set objFile = objFSO.CreateTextFile(outFile,True)
objFile.Write "test string" & vbCrLf
objFile.Close

'How to read a file
strFile = "c:\test\file"
Set objFile = objFS.OpenTextFile(strFile)
Do Until objFile.AtEndOfStream
    strLine= objFile.ReadLine
    Wscript.Echo strLine
Loop
objFile.Close

'to get file path without drive letter, assuming drive letters are c:, d:, etc
strFile="c:\test\file"
s = Split(strFile,":")
WScript.Echo s(1)

<h2>convert vbs file into an executable</h2>
<a href="https://stackoverflow.com/questions/4425681/how-can-i-convert-a-vbscript-to-an-executable-exe-file" class="whitebut ">VBScript to an exe</a>
There is no way to convert a VBScript (.vbs file) into an executable (.exe file) because VBScript is not a compiled language.

Visual Basic 6 is extremely similar in syntax to VBScript, but does support compiling to native code into a native executable. Running the .exe file will require that the user has the VB 6 Run-time libraries installed, but they come built into most versions of Windows that are found now in the wild.

Visual Basic .NET similar in syntax to VB 6 and VBScript. VB.NET programs will also compile to an .exe file, but they require the .NET Framework runtime to be installed on the user's computer.
Fortunately, this has also become commonplace, and it can be easily redistributed if your users don't happen to have it.

Vbsedit is a good application for VBscripter
Use VBSedit to convert VBS code to .exe file.
Also convert HTML, CSS and JavaScript into Application.

download free version
http://www.vbsedit.com/

<h2>vbs Read & Write UTF-8 Files</h2>
<a href="https://developer.rhino3d.com/guides/rhinoscript/read-write-utf8/" class="whitebut ">vbs Read & Write UTF-8 Files</a>
FUNCTION saveFile() ' fileContent will be saved
  outFile="alarmSchedule.txt"
  Set theFile = CreateObject("ADODB.Stream")
  theFile.CharSet = "utf-8"
  theFile.Open
  theFile.WriteText fileContent
  theFile.SaveToFile outFile, 2
end FUNCTION


<h2>delete() method for vbScript arrays</h2>
There is no delete() method for vbScript arrays.
We write one:

Sub delete(idx)
  ub = UBound(ar) - 1
  idx = idx - 1
  For i = idx To ub
    ar(i) = ar(i + 1)
  Next
  ReDim Preserve ar(ub)
End Sub


<h2>objShell.SendKeys command</h2>
<a href="https://stackoverflow.com/questions/23683839/chrome-possible-to-script-like-internetexplorer-application-in-vbscript" class="whitebut ">objShell.SendKeys command</a>
<a href="https://support.foxtrotalliance.com/hc/en-us/articles/360023770832-How-To-Automate-IE-With-VBScript" class="whitebut ">Automate IE With VBScript</a>

'This is an infinite loop, only disposed of by exiting Wscript.exe or Cscript.exe
Do While(true)
Dim PageTitleToRefresh, IntervalinSeconds, x, objShell, Success

'Page Titles - NOT the page address - (google.com = NO) (Google = YES)
'Page Titles are normally stored at the top of the browser or in the tab name of the browser. 
PageTitleToRefresh = "Google"
IntervalinSeconds = 10

x = IntervalinSeconds * 1000
Set objShell = WScript.CreateObject("WScript.Shell")
    Do Until Success = True
        Success = objShell.AppActivate(PageTitleToRefresh)
        Wscript.Sleep 1000
    Loop
    wscript.echo "Activated, now refreshing"
objShell.SendKeys "^r"

Wscript.Sleep IntervalinSeconds
Loop


<h2>SendKeys</h2>
<a href="https://devguru.com/content/technologies/wsh/wshshell-sendkeys.html" class="whitebut ">WSH » wshshell » SendKeys</a>
WSH &raquo; wshshell &raquo; SendKeys
<a href="https://devguru.com/content/technologies/wsh/home.html">WSH</a>   &raquo; <a href="https://devguru.com/content/technologies/wsh/objects-wshshell.html">wshshell</a> &raquo; SendKeys

Syntax:
WshShell.SendKeys (strKeyString)
The SendKeys method sends keystrokes to the active window. 
Similar to VB's SendKeys statement. 

The SendKeys method sends one or more keystrokes to the active window as if they were typed at the keyboard. 
This method is similar to VB's SendKeys method. 

Each ordinary key can be represented by the character of the key itself. 
For example, the key sequence ABCD can be represented simply by "ABCD". 
Some special keys, such as the control keys, function keys, '{', '}', '[', ']', etc... 
are encoded in a string enclosed by braces ({}). 

The following table shows the list of special characters and their respective encoding for SendKeys. 
<table border="1" cellpadding="5">
<tr><th><b>Key</b></th><th><b>Code</b></th></tr>
<tr><td>{</td><td>{{}</td></tr>
<tr><td>}</td><td>{}}</td></tr>
<tr><td>[</td><td>{[}</td></tr>
<tr><td>]</td><td>{]}</td></tr>
<tr><td>~</td><td>{~}</td></tr>
<tr><td>+</td><td>{+}</td></tr>
<tr><td>^</td><td>{^}</td></tr>
<tr><td>%</td><td>{%}</td></tr>
<tr><td>BACKSPACE</td><td>{BACKSPACE}, {BS}, or {BKSP}</td></tr>
<tr><td>BREAK</td><td>{BREAK}</td></tr>
<tr><td>CAPS LOCK</td><td>{CAPSLOCK}</td></tr>
<tr><td>DEL or DELETE</td><td>{DELETE} or {DEL}</td></tr>
<tr><td>DOWN ARROW</td><td>{DOWN}</td></tr>
<tr><td>END</td><td>{END}</td></tr>
<tr><td>ENTER</td><td>{ENTER} or ~</td></tr>
<tr><td>ESC</td><td>{ESC}</td></tr>
<tr><td>HELP</td><td>{HELP}</td></tr>
<tr><td>HOME</td><td>{HOME}</td></tr>
<tr><td>INS or INSERT</td><td>{INSERT} or {INS}</td></tr>
<tr><td>LEFT ARROW</td><td>{LEFT}</td></tr>
<tr><td>NUM LOCK</td><td>{NUMLOCK}</td></tr>
<tr><td>PAGE DOWN</td><td>{PGDN}</td></tr>
<tr><td>PAGE UP</td><td>{PGUP}</td></tr>
<tr><td>PRINT SCREEN</td><td>{PRTSC}</td></tr>
<tr><td>RIGHT ARROW</td><td>{RIGHT}</td></tr>
<tr><td>SCROLL LOCK</td><td>{SCROLLLOCK}</td></tr>
<tr><td>TAB</td><td>{TAB}</td></tr>
<tr><td>UP ARROW</td><td>{UP}</td></tr>
<tr><td>F1</td><td>{F1}</td></tr>
<tr><td>F2</td><td>{F2}</td></tr>
<tr><td>F3</td><td>{F3}</td></tr>
<tr><td>F4</td><td>{F4}</td></tr>
<tr><td>F5</td><td>{F5}</td></tr>
<tr><td>F6</td><td>{F6}</td></tr>
<tr><td>F7</td><td>{F7}</td></tr>
<tr><td>F8</td><td>{F8}</td></tr>
<tr><td>F9</td><td>{F9}</td></tr>
<tr><td>F10</td><td>{F10}</td></tr>
<tr><td>F11</td><td>{F11}</td></tr>
<tr><td>F12</td><td>{F12}</td></tr>
<tr><td>F13</td><td>{F13}</td></tr>
<tr><td>F14</td><td>{F14}</td></tr>
<tr><td>F15</td><td>{F15}</td></tr>
<tr><td>F16</td><td>{F16}</td></tr>
</table>

To specify keys combined with any combination of the SHIFT, CTRL, and ALT keys, precede the key code with one or more of the
following codes: 
<table border="1" cellpadding="5">
<tr><th><b>Key</b></th><th><b>Code</b></th></tr>
<tr><td>+</td><td>SHIFT</td></tr>
<tr><td>^</td><td>CTRL</td></tr>
<tr><td>%</td><td>ALT</td></tr>
</table>

For example, the following strKeyString produces the CTRL-ALT-DELETE keystroke combination: "^%{DELETE}"

<h3>Examples</h3>
<h5>Code:</h5>
Set WshShell = WScript.CreateObject("WScript.Shell") WshShell.Run "notepad", 9
WScript.Sleep 500 ' Give Notepad some time to load

For i = 1 To 10
  WshShell.SendKeys "Hello World!"
  WshShell.SendKeys "{ENTER}"
Next
<h5>Explanation:</h5>This VBScript code creates an instance of Notepad and types the words "Hello World!" ten times into Notepad.
<h5>Language(s): VBScript </h5>

<h2>checks Chrome browser is closed</h2>
This piece of code checks every few minutes to open it if the Chrome browser is closed.
But the problem is that I want to check a specific profile, not the whole Chrome browser.
And I do not know what the code is.

Set objShell = CreateObject("WScript.Shell")
i = 1

strProfile = objShell.ExpandEnvironmentStrings("%LOCALAPPDATA%")
strPath = strProfile & "\Google\Chrome\Application\chrome.exe"

Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & "." & "\root\cimv2")

Do While i = 1
    booChrome = False

    Set colProcesses = objWMIService.ExecQuery _
        ("Select * From Win32_Process")
    For Each objItem in colProcesses
        strProcessName = objItem.Caption
		'msgbox strProcessName
        If strProcessName = "chrome.exe" Then 
		
		booChrome = True
		end if
		
    Next
    
    If booChrome = False Then objShell.Run(Chr(34) & strPath & Chr(34))
    WScript.Sleep 300000
Loop


<h2>The WshShell object</h2>
<a href="https://devguru.com/content/technologies/wsh/objects-wshshell.html" class="whitebut ">wshshell</a>
The WshShell object makes it easy to creates shortcuts, access the environment variables, run applications, access system registry, and more.

Methods
AppActivate
Syntax: WshShell.AppActivate (strTitle)

The AppActivate method activates an application.

CreateShortcut
Syntax: WshShell.CreateShortcut (strPathName)

The CreateShortcut method creates and returns a WshShortcut object.

ExpandEnvironmentStrings
Syntax: WshShell.ExpandEnvironmentStrings (strString)

The ExpandEnvironmentStrings method expands the environment variables in a string and returns the resulting string.

LogEvent
Syntax: WshShell.LogEvent (intType, strMessage [,strTarget])

The LogEvent method logs an event in the Windows NT event log or WSH.log file.

Popup
Syntax: WshShell.Popup [,intSecondsToWait] [,strTitle] [,intType]

The Popup method displays a pop-up message box.

some of the values that can be used for intType.
Value	Button
0	OK
1	OK, Cancel
2	Abort, Ignore, Retry
3	Yes, No, Cancel
4	Yes, No
5	Retry, Cancel
16	Critical
32	Question
48	Exclamation
64	Information

RegDelete
Syntax: WshShell.RegDelete (strName)

The RegDelete method removes a registry entry based on strName.

RegRead
Syntax: WshShell.RegRead (strName)

The RegRead method reads and returns a registry entry based on strName.

RegWrite
Syntax: WshShell.RegWrite (strName, varValue [,strType])

The RegWrite method writes a new entry into the registry.

Run
Syntax: WshShell.Run (strCommand [,intWindowStyle] [,bWaitOnReturn])

The Run method runs an application in a new process.

SendKeys
Syntax: WshShell.SendKeys (strKeyString)

The SendKeys method sends keystrokes to the active window. Similar to VB's SendKeys statement.


<a href="https://ss64.com/vb/syntax.html" class="redbut gold bluebackgrad whitebs">VBScript guides and examples</a>

<h2>Run a VBScript file</h2>
To run a VBScript from within another VBScript:
Dim objShell
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run "cscript c:\batch\demo.vbs"

Run a CMD batch file
To run a CMD batch file from VBScript:
Dim objShell
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run "c:\batch\test.cmd"

Run a PowerShell script
To run a PowerShell script from VBScript:
Dim objShell
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run "powershell -file ""c:\batch\demo.ps1"""

<a href="https://ss64.com/vb/syntax-hybrid.html" class="whitebut ">Hybrid Batch and VBscript, to run both a batch file and a VBScript</a>


<h2>get Quotient & Remainder</h2>
Quotient = 5 \ 3.
Notice we use integer division, \ vs /.
This results in a value of 1
Remainder = 5 - (Quotient * 3).
This results in a value of 2


<h2>sort arrays using vbscript</h2>

for a = UBound(ArrayOfTerms) - 1 To 0 Step -1
    for j = 0 to a
        if ArrayOfTerms(j) > ArrayOfTerms(j+1) then
            temp = ArrayOfTerms(j+1)
            ArrayOfTerms(j+1) = ArrayOfTerms(j)
            ArrayOfTerms(j) = temp
        end if
    next
next 

<h2>convert string to datetime format classic</h2>
https://www.w3schools.com/asp/func_datediff.asp

adate=CDate("May 6, 2020")
response.write(d)
4/22/2010

d=CDate("3:18:40 AM")
MsgBox IsDate(d)

https://www.w3schools.com/asp/func_formatdatetime.asp
FormatDateTime(date,format) 

d=CDate("2019-05-31 13:45")
response.write(FormatDateTime(d) & "<br />")

Format contains following constants:

0 = vbGeneralDate - Default. Returns date: mm/dd/yy and time if specified: hh:mm:ss PM/AM.
1 = vbLongDate - Returns date: weekday, monthname, year
2 = vbShortDate - Returns date: mm/dd/yy
3 = vbLongTime - Returns time: hh:mm:ss PM/AM
4 = vbShortTime - Return time: hh:mm


https://www.vbsedit.com/html/fe4e5302-9602-4e0f-8496-559c7f58c8fa.asp
Syntax
DateDiff(interval,date1,date2[,firstdayofweek[,firstweekofyear]])
Parameter	Description
interval	Required. The interval you want to use to calculate the differences between date1 and date2
Can take the following values:

yyyy - Year
q - Quarter
m - Month
y - Day of year
d - Day
w - Weekday
ww - Week of year
h - Hour
n - Minute
s - Second
date1,date2	Required. Date expressions. Two dates you want to use in the calculation
firstdayofweek	Optional. Specifies the day of the week.
Can take the following values:

0 = vbUseSystemDayOfWeek - Use National Language Support (NLS) API setting
1 = vbSunday - Sunday (default)
2 = vbMonday - Monday
3 = vbTuesday - Tuesday
4 = vbWednesday - Wednesday
5 = vbThursday - Thursday
6 = vbFriday - Friday
7 = vbSaturday - Saturday
firstweekofyear	Optional. Specifies the first week of the year.
Can take the following values:

0 = vbUseSystem - Use National Language Support (NLS) API setting
1 = vbFirstJan1 - Start with the week in which January 1 occurs (default)
2 = vbFirstFourDays - Start with the week that has at least four days in the new year
3 = vbFirstFullWeek - Start with the first full week of the new year

Example
How many weeks (start on Monday),
between December 31 2009 and December 31 2012:

fromDate=CDate("2009/12/31")
toDate=CDate("2012/12/31")
DateDiff("w",fromDate,toDate,vbMonday)


The difference between January 31 2009, and January 31 2010:
fromDate="31-Jan-09 00:00:00"
toDate="31-Jan-10 23:59:00"
DateDiff("yyyy",fromDate,toDate)
DateDiff("q",fromDate,toDate)
DateDiff("m",fromDate,toDate)
DateDiff("y",fromDate,toDate)
DateDiff("d",fromDate,toDate)
DateDiff("w",fromDate,toDate)
DateDiff("ww",fromDate,toDate)
DateDiff("h",fromDate,toDate)
DateDiff("n",fromDate,toDate)
DateDiff("s",fromDate,toDate)


VBS get the Date & Time
FormatDateTime(now, 4)
  08:12

Format(Now(),"HH:mm:ss")

There are also separate Time() and Date() functions.


Here's various date and time information you can pull in vbscript running under Windows Script Host (WSH):

Now   = 2/29/2016 1:02:03 PM
Date  = 2/29/2016
Time  = 1:02:03 PM
Timer = 78826.31     ' seconds since midnight

FormatDateTime(Now)                = 2/29/2016 1:02:03 PM
FormatDateTime(Now, vbGeneralDate) = 2/29/2016 1:02:03 PM
FormatDateTime(Now, vbLongDate)    = Monday, February 29, 2016
FormatDateTime(Now, vbShortDate)   = 2/29/2016
FormatDateTime(Now, vbLongTime)    = 1:02:03 PM
FormatDateTime(Now, vbShortTime)   = 13:02

Year(Now)   = 2016
Month(Now)  = 2
Day(Now)    = 29
Hour(Now)   = 13
Minute(Now) = 2
Second(Now) = 3

Year(Date)   = 2016
Month(Date)  = 2
Day(Date)    = 29

Hour(Time)   = 13
Minute(Time) = 2
Second(Time) = 3


' Usage: > cscript.exe /nologo datetime.vbs

Dim wmi : Set wmi = GetObject("winmgmts:root\cimv2")

Dim n : n = #2/29/2016 1:02:03 PM#
Dim d : d = #2/29/2016#
Dim t : t = #1:02:03 PM#
WScript.Echo "Now   = " & n
WScript.Echo "Date  = " & d
WScript.Echo "Time  = " & t
WScript.Echo "Timer = " & Timer & "     ' seconds since midnight"
WScript.Echo

' http://msdn.microsoft.com/en-us/library/office/gg251489.aspx
'Const vbGeneralDate = 0
'Const vbLongDate    = 1
'Const vbShortDate   = 2
'Const vbLongTime    = 3
'Const vbShortTime   = 4

WScript.Echo "FormatDateTime(Now)                = " & FormatDateTime(n)
WScript.Echo "FormatDateTime(Now, vbGeneralDate) = " & FormatDateTime(n, vbGeneralDate)
WScript.Echo "FormatDateTime(Now, vbLongDate)    = " & FormatDateTime(n, vbLongDate)
WScript.Echo "FormatDateTime(Now, vbShortDate)   = " & FormatDateTime(n, vbShortDate)
WScript.Echo "FormatDateTime(Now, vbLongTime)    = " & FormatDateTime(n, vbLongTime)
WScript.Echo "FormatDateTime(Now, vbShortTime)   = " & FormatDateTime(n, vbShortTime)
WScript.Echo

WScript.Echo "Year(Now)   = " & Year(n)
WScript.Echo "Month(Now)  = " & Month(n)
WScript.Echo "Day(Now)    = " & Day(n)
WScript.Echo "Hour(Now)   = " & Hour(n)
WScript.Echo "Minute(Now) = " & Minute(n)
WScript.Echo "Second(Now) = " & Second(n)
WScript.Echo

WScript.Echo "Year(Date)   = " & Year(d)
WScript.Echo "Month(Date)  = " & Month(d)
WScript.Echo "Day(Date)    = " & Day(d)
WScript.Echo

WScript.Echo "Hour(Time)   = " & Hour(t)
WScript.Echo "Minute(Time) = " & Minute(t)
WScript.Echo "Second(Time) = " & Second(t)
WScript.Echo

Function LPad (str, pad, length)
    ' http://www.vbforums.com/showthread.php?676463-Right-Pad-and-Left-Pad-in-VBScript
    LPad = String(length - Len(str), pad) & str
End Function
WScript.Echo "Function LPad (str, pad, length)"
WScript.Echo "    LPad = String(length - Len(str), pad) & str"
WScript.Echo "End Function"
WScript.Echo

WScript.Echo "LPad(Month(Date), ""0"", 2)    = " & LPad(Month(d), "0", 2)
WScript.Echo "LPad(Day(Date), ""0"", 2)      = " & LPad(Day(d), "0", 2)
WScript.Echo "LPad(Hour(Time), ""0"", 2)     = " & LPad(Hour(t), "0", 2)
WScript.Echo "LPad(Minute(Time), ""0"", 2)   = " & LPad(Minute(t), "0", 2)
WScript.Echo "LPad(Second(Time), ""0"", 2)   = " & LPad(Second(t), "0", 2)
WScript.Echo

WScript.Echo "Weekday(Now)                     = " & Weekday(n)
WScript.Echo "WeekdayName(Weekday(Now), True)  = " & WeekdayName(Weekday(n), True)
WScript.Echo "WeekdayName(Weekday(Now), False) = " & WeekdayName(Weekday(n), False)
WScript.Echo "WeekdayName(Weekday(Now))        = " & WeekdayName(Weekday(n))
WScript.Echo

WScript.Echo "MonthName(Month(Now), True)  = " & MonthName(Month(n), True)
WScript.Echo "MonthName(Month(Now), False) = " & MonthName(Month(n), False)
WScript.Echo "MonthName(Month(Now))        = " & MonthName(Month(n))
WScript.Echo

' http://msdn.microsoft.com/en-us/library/aa394239%28v=vs.85%29.aspx
' http://include.wutils.com/wmi/ROOT%5Ccimv2/CIM_ManagedSystemElement/CIM_LogicalElement/CIM_OperatingSystem/Win32_OperatingSystem.html
WScript.Echo "Set os = GetObject(""winmgmts:root\cimv2:Win32_OperatingSystem=@"")"
Dim os : Set os = GetObject("winmgmts:root\cimv2:Win32_OperatingSystem=@")
WScript.Echo "os.LocalDateTime = " & os.LocalDateTime
WScript.Echo "Left(os.LocalDateTime, 4)    = " & Left(os.LocalDateTime, 4)    & " ' year"
WScript.Echo "Mid(os.LocalDateTime, 5, 2)  = " & Mid(os.LocalDateTime, 5, 2)  & "   ' month"
WScript.Echo "Mid(os.LocalDateTime, 7, 2)  = " & Mid(os.LocalDateTime, 7, 2)  & "   ' day"
WScript.Echo "Mid(os.LocalDateTime, 9, 2)  = " & Mid(os.LocalDateTime, 9, 2)  & "   ' hour"
WScript.Echo "Mid(os.LocalDateTime, 11, 2) = " & Mid(os.LocalDateTime, 11, 2) & "   ' minute"
WScript.Echo "Mid(os.LocalDateTime, 13, 2) = " & Mid(os.LocalDateTime, 13, 2) & "   ' second"
WScript.Echo

' http://msdn.microsoft.com/en-us/library/aa394498.aspx
' http://include.wutils.com/wmi/ROOT%5Ccimv2/CIM_Setting/Win32_TimeZone.html#vbscript
WScript.Echo "Set timeZones = wmi.ExecQuery(""SELECT Bias, Caption FROM Win32_TimeZone"")"
Dim timeZones: Set timeZones = wmi.ExecQuery("SELECT Bias, Caption FROM Win32_TimeZone")
WScript.Echo "For Each tz In timeZones"
For Each tz In timeZones
	WScript.Echo "    tz.Bias    = " & tz.Bias
	WScript.Echo "    tz.Caption = " & tz.Caption
Next

<h2>To return a value from a VBScript function</h2>
assign the value to the name of the function, like this:

Function getNumber
    getNumber = "423"
End Function

A function can only return one value.
In the function definition you assign the value to function name.
You can use "Exit Function" statements to make the function return with different values at different points.
For example:
Function Example(strValue)
    If (strValue = "A") Then
        Example = 1
        Exit Function
    End If
    If (strValue = "B") Then
        Example = 2
        Exit Function
    End If
    Example = 3
End Function

<h2>Vb script restarts another vbs script</h2>
use Exec method to run another VB Script, but you are likely to get a console window flash.

Dim WshShell
Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.Exec("CMD /C Test_To_Block.vbs")

<a href="https://ss64.com/vb/" class="whitebut ">A-Z Index of Windows VBScript commands</a>

Dim WshShell, oExec
Set WshShell = CreateObject("WScript.Shell")

Set oExec = WshShell.Exec("Test_To_Block.vbs")
Do
If NOT WshShell.Status = 1 then
    WScript.Exec("Test_To_Block.vbs")
End If
WScript.Sleep(100)
Loop


Here is a VBScript that uses WMI to start and stop a service.

'Start Service
strServiceName = "Alerter"
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2")
Set colListOfServices = objWMIService.ExecQuery ("Select * from Win32_Service Where Name ='" & strServiceName & "'")
For Each objService in colListOfServices
objService.StartService()
Next

'Stop Service
strServiceName = "Alerter"
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2")
Set colListOfServices = objWMIService.ExecQuery("Select * from Win32_Service Where Name ='" & strServiceName & "'")
For Each objService in colListOfServices
objService.StopService()
Next


<h2>: the colon just a statement separator</h2>
the code would work exactly the same on two lines
Dim g_oSB : Set g_oSB = CreateObject("System.Text.StringBuilder")

<h2>CreateDate</h2>
Description:
Creates date and time from its individual components.

var tDate = Pm.CreateDate(2018, 3, 22, 12, 30, 30, 500);   // Returns date 22.3.2018 12:30:30.500 (43181.5211863426)

<h2>vbs Do While Loop</h2>
If you do not know the number of times you need to execute a block of code, then you will be using Do While loops.

Dim x
x=1
Do While x<5
document.write("Welcome.")
x=x+1
Loop


Do While loop

Dim x
x=7
Do 
document.write("Welcome.")
x=x+1
Loop While x<5


Do Until Loop
â€˜Do Untilâ€™ loop is also used when you do not know the number of time you need to execute a block of code.

Dim x
x=1
Do Until x=5
document.write("Welcome.")
x=x+1
Loop


to exit a Do While or Do Until loop in between, then you can use Exit Do statement.

Dim x
x=1
Do Until x=5
If x=3 Then Exit Do
document.write("Welcome.")
x=x+1
Loop

While Loop
Whileâ€¦Wend loop is similar to Do While loop though not used commonly.
As Do While is more structured than Whileâ€¦..Wend loop, programmers usually use Do While statements.

Dim x
x = 1   
While x < 5   
document.write("Welcome.")
x=x+1
Wend  

For-Next Loop
The For-Next loop can be used to execute a block of code for a specific number of times.
For i = 1 To 5
  document.write("The number is " & i & "
")
Next


For-Step-Next Loop
By default, the counter variable is incremented by one.
If you want to increase or decrease the counter variable by the value you specify, then you can use Forâ€¦.Stepâ€¦.Next loop. 

For i = 1 To 5 Step 2
  document.write("The number is " & i & "<br />")
Next


to exit a For Next or For Step Next loop in between, then you can use Exit for the statement.

For i = 1 To 5 Step 2
  If i=3 Then Exit For
  document.write("The number is " & i & "<br />")
Next


For-Each-Next Loop
If you want to repeat a block of code for each item in a collection or for each element of a VBS array

Dim students(4)
students(0)="John"
students(1)="Hanah"
students(2)="Sarah"
students(3)="Kevin"
students(4)="Emma"

For Each x In students
  document.write(x & "<br />")
Next




<h2>for each loop</h2>
'fruits is an array 
fruits = Array("apple","orange","cherries")

Dim fruitnames

'iterating using For each loop. 
For each item in fruits
   fruitnames = fruitnames & item & vbnewline
Next

msgbox fruitnames


<h2>list battery details</h2>
' List Battery Information

On Error Resume Next

strComputer = "."
Set objWMIService = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colItems = objWMIService.ExecQuery("Select * from Win32_Battery")

report = ""
For Each objItem in colItems
    report = report & "Availability: " & objItem.Availability & vbcrlf
    report = report & "Battery Status: " & objItem.BatteryStatus & vbcrlf
    report = report & "Chemistry: " & objItem.Chemistry & vbcrlf
    report = report & "Description: " & objItem.Description & vbcrlf
    report = report & "Design Voltage: " & objItem.DesignVoltage & vbcrlf
    report = report & "Device ID: " & objItem.DeviceID & vbcrlf
    report = report & "Estimated Run Time: " & objItem.EstimatedRunTime & vbcrlf
    report = report & "Name: " & objItem.Name & vbcrlf
    report = report & "Power Management Capabilities: " & vbcrlf
    For Each objElement In objItem.PowerManagementCapabilities
        report = report & vbTab & objElement & vbcrlf
    Next
    report = report & "Power Management Supported: " & objItem.PowerManagementSupported & vbcrlf
Next
msgbox report


<h2>vbs Do While Loop</h2>
If you do not know the number of times you need to execute a block of code, then you will be using Do While loops.

Dim x
x=1
Do While x<5
document.write("Welcome.")
x=x+1
Loop


Do While loop

Dim x
x=7
Do 
document.write("Welcome.")
x=x+1
Loop While x<5


Do Until Loop
‘Do Until’ loop is also used when you do not know the number of time you need to execute a block of code.

Dim x
x=1
Do Until x=5
document.write("Welcome.")
x=x+1
Loop


to exit a Do While or Do Until loop in between, then you can use Exit Do statement.

Dim x
x=1
Do Until x=5
If x=3 Then Exit Do
document.write("Welcome.")
x=x+1
Loop

While Loop
While…Wend loop is similar to Do While loop though not used commonly.
As Do While is more structured than While…..Wend loop, programmers usually use Do While statements.

Dim x
x = 1   
While x < 5   
document.write("Welcome.")
x=x+1
Wend  

For-Next Loop
The For-Next loop can be used to execute a block of code for a specific number of times.
For i = 1 To 5
  document.write("The number is " & i & "
")
Next


For-Step-Next Loop
By default, the counter variable is incremented by one.
If you want to increase or decrease the counter variable by the value you specify, then you can use For….Step….Next loop. 

For i = 1 To 5 Step 2
  document.write("The number is " & i & "<br />")
Next


to exit a For Next or For Step Next loop in between, then you can use Exit for the statement.

For i = 1 To 5 Step 2
  If i=3 Then Exit For
  document.write("The number is " & i & "<br />")
Next


For-Each-Next Loop
If you want to repeat a block of code for each item in a collection or for each element of a VBS array

Dim students(4)
students(0)="John"
students(1)="Hanah"
students(2)="Sarah"
students(3)="Kevin"
students(4)="Emma"

For Each x In students
  document.write(x & "<br />")
Next




<h2>for each loop</h2>
'fruits is an array 
fruits = Array("apple","orange","cherries")

Dim fruitnames

'iterating using For each loop. 
For each item in fruits
   fruitnames = fruitnames & item & vbnewline
Next

msgbox fruitnames

<h2>list battery details</h2>
' List Battery Information

On Error Resume Next

strComputer = "."
Set objWMIService = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colItems = objWMIService.ExecQuery("Select * from Win32_Battery")

report = ""
For Each objItem in colItems
    report = report & "Availability: " & objItem.Availability & vbcrlf
    report = report & "Battery Status: " & objItem.BatteryStatus & vbcrlf
    report = report & "Chemistry: " & objItem.Chemistry & vbcrlf
    report = report & "Description: " & objItem.Description & vbcrlf
    report = report & "Design Voltage: " & objItem.DesignVoltage & vbcrlf
    report = report & "Device ID: " & objItem.DeviceID & vbcrlf
    report = report & "Estimated Run Time: " & objItem.EstimatedRunTime & vbcrlf
    report = report & "Name: " & objItem.Name & vbcrlf
    report = report & "Power Management Capabilities: " & vbcrlf
    For Each objElement In objItem.PowerManagementCapabilities
        report = report & vbTab & objElement & vbcrlf
    Next
    report = report & "Power Management Supported: " & objItem.PowerManagementSupported & vbcrlf
Next
msgbox report


<h2>two functions to enable or disable IE security warning</h2>
Basically, modified certain registry values to enable and disable the IE security warning.

Sub EnableActiveXWarning ()
Dim SHL
Dim sReg

Set SHL = CreateObject ("WScript.Shell")

sReg = "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1201"

If SHL.RegRead (sReg) = 1 Then
    MsgBox "ActiveX Warning is already enabled!",vbExclamation
Else
    SHL.RegWrite sReg,1,"REG_DWORD"

    If SHL.RegRead (sReg) = 1 Then
        MsgBox "The ActiveX Warning was successfully enabled.",vbInformation
    Else
        MsgBox "An unknown error has occured !!",vbCritical
    End If
End If
Set SHL = Nothing
End Sub


Sub DisableActiveXWarning ()
Dim SHL
Dim sReg

Set SHL = CreateObject ("WScript.Shell")

sReg = "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1201"

If SHL.RegRead (sReg) = 0 Then
    MsgBox "ActiveX Warning is already disabled!",vbExclamation
Else
    SHL.RegWrite sReg,0,"REG_DWORD"

    If SHL.RegRead (sReg) = 0 Then
        MsgBox "The ActiveX Warning was successfully disabled.",vbInformation
    Else
        MsgBox "An unknown error has occured !!",vbCritical
    End If
End If
Set SHL = Nothing
End Sub


<h2>to see what's available CreateObject() object List for vbs</h2>
to see what's available is by looking under Tools> References in the VBA editor within Word or other Office products. 
Then include a reference, and go to the Object Browser to see its methods and properties.

If you don't have Office installed, there are other ways to list the COM interfaces on your machine using VBScript. 
Take a look at <a href="https://www.robvanderwoude.com/vbstech_objectbrowsers.php" class="whitebut ">VBScript Scripting Techniques</a>
where describes some programs that provide an object browser.

also a script that shows how to list ProgIds from your registry. 
I have over 3000 on my machine. 
Not all will have scriptable interfaces, but many will. 
.NET alone has hundreds of useful objects, and all are documented on MSDN. 
Once you have an interesting looking ProgId, do a Google search to find more about it.

https://www.robvanderwoude.com/vbstech_objectbrowsers.php
<h2>CreateObject Create an automation object</h2>
<r>That means to run an external command</r>

Set objShell = CreateObject("Wscript.Shell")
CreateObject("WScript.Shell").Run "Your-VBScript-Here"
Set WshShell = WScript.CreateObject("WScript.Shell") WshShell.Run "notepad", 9
Set objPlayer = CreateObject( "WMPlayer.OCX" )
With CreateObject("WMPlayer.OCX")
Set objWMPlayer = CreateObject( "WMPlayer.OCX.7" )
Set objExcel = CreateObject("Excel.Application")
Set app = WScript.CreateObject("Excel.Application")
set DOCAppl = CreateObject("Word.Application")
set pptAppl = CreateObject("Powerpoint.Application")
Set lstProgID = CreateObject( "System.Collections.ArrayList" )
Set objSortList = CreateObject( "System.Collections.SortedList" )
Set speech = CreateObject("SAPI.SpVoice")
Set IE = CreateObject("InternetExplorer.Application")
Set objIE = WScript.CreateObject("InternetExplorer.Application")
Set objShell = CreateObject("Shell.Application")
For Each w In CreateObject("Shell.Application").Windows 
Set theFile = CreateObject("ADODB.Stream")
'To sent xmlhttp request to webserver & get html code
Set oXMLHttp = CreateObject("MSXML2.XMLHTTP")
Set req = CreateObject("Msxml2.XMLHttp.6.0")
Set xml2Doc = CreateObject( "Msxml2.DOMDocument.5.0" )
'To parse data from html tags
Set ohtmlFile = CreateObject("htmlfile")
' to create an instance of FileSystemObject.
Set FSO = CreateObject("Scripting.FileSystemObject")
Dim StdOut : Set StdOut = CreateObject("Scripting.FileSystemObject").GetStandardStream(1)
Set dict = CreateObject("Scripting.Dictionary")
set oLocator = CreateObject("WbemScripting.SWbemLocator")
Set objEmail = CreateObject( "CDO.Message" )
Set objIE = CreateObject( "InternetExplorer.Application" )
Set objInet = CreateObject( "InetCtls.Inet.1" )
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
Set objExcel = CreateObject( "Excel.Application" )
Set objOutlook = CreateObject( "Outlook.Application" )
Set objPpt = CreateObject( "PowerPoint.Application" )
Set objWord = CreateObject( "Word.Application" )
Set objCal = CreateObject( "MSCAL.Calendar" )
Set objQPro = CreateObject( "QuattroPro.PerfectScript" )
Set objWP = CreateObject( "WordPerfect.PerfectScript" )
Set objConn = CreateObject( "ADODB.Connection" )
Set objRecSet = CreateObject( "ADODB.Recordset" )
Set objDic = CreateObject( "Scripting.Dictionary" )
Set objFSO = CreateObject( "Scripting.FileSystemObject" )
Set wshNetwork = CreateObject( "WScript.Network" )
Set wshShell = CreateObject( "WScript.Shell" )
Set objRandom = CreateObject( "System.Random" )
Set objArrList = CreateObject( "System.Collections.ArrayList" )
Set xmlDoc = CreateObject( "Microsoft.XmlDom" )
Set objiTunes = CreateObject( "iTunes.Application" )
Set objReal = CreateObject( "rmocx.RealPlayer G2 Control.1" )
Set objFSDialog = CreateObject( "SAFRCFileDlg.FileSave" )
Set objFODialog = CreateObject( "SAFRCFileDlg.FileOpen" )
Set objDialog = CreateObject( "UserAccounts.CommonDialog" )
Set SOAPClient = CreateObject( "MSSOAP.SOAPClient" )
Set objWOL = CreateObject( "UltraWOL.ctlUltraWOL" )
Set objSearcher = CreateObject( "Microsoft.Update.Searcher" )
Set objShell = CreateObject( "Shell.Application" )
Set myConn = CreateObject("ADODB.Connection")
Set myCommand = CreateObject("ADODB.Command" )
Set AdCn = CreateObject("ADODB.Connection")
Set AdRec = CreateObject("ADODB.Recordset")
Dim g_oSB : Set g_oSB = CreateObject("System.Text.StringBuilder")
Set objEmail= CreateObject( "CDO.Message" )

The following VBScript code can be used to list all available ProgIDs:

Option Explicit

Const HKEY_CLASSES_ROOT = &H80000000

Dim arrProgID, lstProgID, objReg, strMsg, strProgID, strSubKey, subKey, subKeys()

Set lstProgID = CreateObject( "System.Collections.ArrayList" )
Set objReg    = GetObject( "winmgmts://./root/default:StdRegProv" )

' List all subkeys of HKEY_CLASSES_ROOT\CLSID
objReg.EnumKey HKEY_CLASSES_ROOT, "CLSID", subKeys

' Loop through the list of subkeys
For Each subKey In subKeys
	' Check each subkey for the existence of a ProgID
	strSubKey = "CLSID\" & subKey & "\ProgID"
	objReg.GetStringValue HKEY_CLASSES_ROOT, strSubKey, "", strProgID
	' If a ProgID exists, add it to the list
	If Not IsNull( strProgID ) Then lstProgID.Add strProgID
Next

' Sort the list of ProgIDs
lstProgID.Sort

' Copy the list to an array (this makes displaying it much easier)
arrProgID = lstProgID.ToArray

' Display the entire array
WScript.Echo Join( arrProgID, vbCrLf )
 
Don't try to load these objects all at once, it might crash your computer.

https://www.reliance-scada.com/en/support/articles/technical/vbscript-tip-working-with-an-object-list
VBScript tip: Working with an object list

https://www.informit.com/articles/article.aspx?p=29570&seqNum=3
Windows Scripting and Objects

https://www.itprotoday.com/devops-and-software-development/understanding-vbscript-object-management
VBScript Object Management


<h2>GetObject</h2>

Set objExcelFile = GetObject("C:\Scripts\Test.xls")
WScript.Echo objExcelFile.Name
objExcelFile.Close
This code will get you the Excel Workbook object contained in C:\Scripts\Test.xls. You can use TypeName() to confirm that:

Set objExcelFile = GetObject("C:\Scripts\Test.xls")
WScript.Echo objExcelFile.Name
WScript.Echo TypeName(objExcelFile)
objExcelFile.Close

The output will be:

test.xls
Workbook
If the specified Excel workbook doesn't exist the script will return an error. If an instance of Excel is already running you can use this code to get a reference to it:

Set objExcel = GetObject( , "Excel.Application")

For Each objWorkbook In objExcel.Workbooks
    WScript.Echo objWorkbook.Name
Next

objExcel.Quit
Notice the comma before 'Excel.Application'. The script gets a reference to a running Excel application, lists open workbooks names and quits Excel. If there is no Excel instance running you will receive an error. This is also why you couldn't use GetObject() to get an instance of Scripting.FileSystemObject - there was no running instance.

You could use GetObject if there is an instance og Scripting.FileSystemObject already running in memory. Try this code:

Set objFso = CreateObject("Scripting.FileSystemObject")
Set objFso1 = GetObject("", "Scripting.FileSystemObject")

WScript.Echo TypeName(objFso)
WScript.Echo TypeName(objFso1)
You can see that you first need to use CreateObject() to and when FileSystemObject is running it is possible to get a reference to it, but this doesn't make much sense because you already have a reference to it (objFso). So, use CreateObject() to create an instance of FileSystemObject.

<h2>Scripting.FileSystemObject</h2>
The following code illustrates how the FileSystemObject object is used to return a TextStream object that can be read from or written to:

Set fs = CreateObject("Scripting.FileSystemObject")
Set a = fs.CreateTextFile("c:\testfile.txt", True)
a.WriteLine("This is a test.")
a.Close
In the example code:

The CreateObject function returns the FileSystemObject (fs).
The CreateTextFile method creates the file as a TextStream object (a).
The WriteLine method writes a line of text to the created text file.
The Close method flushes the buffer and closes the file.
Methods

METHODS
Method	Description
BuildPath	Appends a name to an existing path.
CopyFile	Copies one or more files from one location to another.
CopyFolder	Copies one or more folders from one location to another.
CreateFolder	Creates a new folder.
CreateTextFile	Creates a text file and returns a TextStream object that can be used to read from, or write to the file.
DeleteFile	Deletes one or more specified files.
DeleteFolder	Deletes one or more specified folders.
DriveExists	Checks if a specified drive exists.
FileExists	Checks if a specified file exists.
FolderExists	Checks if a specified folder exists.
GetAbsolutePathName	Returns the complete path from the root of the drive for the specified path.
GetBaseName	Returns the base name of a specified file or folder.
GetDrive	Returns a Drive object corresponding to the drive in a specified path.
GetDriveName	Returns the drive name of a specified path.
GetExtensionName	Returns the file extension name for the last component in a specified path.
GetFile	Returns a File object for a specified path.
GetFileName	Returns the file name or folder name for the last component in a specified path.
GetFolder	Returns a Folder object for a specified path.
GetParentFolderName	Returns the name of the parent folder of the last component in a specified path.
GetSpecialFolder	Returns the path to some of Windows' special folders.
GetTempName	Returns a randomly generated temporary file or folder.
Move	Moves a specified file or folder from one location to another.
MoveFile	Moves one or more files from one location to another.
MoveFolder	Moves one or more folders from one location to another.
OpenAsTextStream	Opens a specified file and returns a TextStream object that can be used to read from, write to, or append to the file.
OpenTextFile	Opens a file and returns a TextStream object that can be used to access the file.
WriteLine	Writes a specified string and new-line character to a TextStream file.

PROPERTIES
Property	Description
Drives	Returns a collection of all Drive objects on the computer.
Name	Sets or returns the name of a specified file or folder.
Path	Returns the path for a specified file, folder, or drive.
Size	For files, returns the size, in bytes, of the specified file; for folders, returns the size, in bytes, of all files and subfolders contained in the folder.
Type	Returns information about the type of a file or folder (for example, for files ending in .TXT, "Text Document" is returned).


<h2>CreateObject function</h2>
The CreateObject function creates an object

Syntax
CreateObject(servername.typename[,location])

Parameter	Description
servername	Required. The name of the application that provides the object
typename	Required. The type/class of the object
location	Optional. Where to create the object

Example
Creating a regular expression object:

txt = "This is a beautiful day"
Set objReg = CreateObject("vbscript.regexp")
objReg.Pattern = "i"

response.write(objReg.Replace(txt,"##"))

The output of the code above will be:

Th##s is a beautiful day



<h2>Visual Basic Functions</h2>
https://github.com/MicrosoftDocs/VBA-Docs/blob/master/Language/Reference/functions-visual-basic-for-applications.md

Functions (Visual Basic for Applications)
Conversion functions
Asc
Chr
CVErr
Format
Hex
Oct
Str
Val

Math functions
Abs
Atn
Cos

Derived math
Exp
Int, Fix
Log
Rnd
Sgn
Sin
Sqr
Tan

Other functions
Array
CallByName
Choose
Command
CreateObject
CurDir
Date
DateAdd
DateDiff
DatePart
DateSerial
DateValue
Day
DDB
Dir
DoEvents
Environ
EOF
Error
FileAttr
FileDateTime
FileLen
Filter
FormatCurrency
FormatDateTime
FormatNumber
FormatPercent
FreeFile
FV
GetAllSettings
GetAttr
GetObject
GetSetting
Hour
IIf
IMEStatus
Input
InputBox
InStr
InStrRev
IPmt
IRR
IsArray
IsDate
IsEmpty
IsError
IsMissing
IsNull
IsNumeric
IsObject
Join
LBound
LCase
Left
Len
Loc
LOF
LTrim, RTrim, and Trim
MacID
MacScript
Mid
Minute
MIRR
Month
MonthName
MsgBox
Now
NPer
NPV
Partition
Pmt
PPmt
PV
QBColor
Rate
Replace
RGB
Right
Round
Second
Seek
Shell
SLN
Space
Spc
Split
StrComp
StrConv
String
StrReverse
Switch
SYD
Tab
Time
Timer
TimeSerial
TimeValue
TypeName
UBound
UCase
VarType
Weekday
WeekdayName
Year

<h2>connect to SQL Server</h2>

Const DB_CONNECT_STRING = "Provider=SQLOLEDB.1;Data Source=sql14\qw;Initial Catalog=fret;user id ='admin';password='pass'"

Set myConn = CreateObject("ADODB.Connection")
Set myCommand = CreateObject("ADODB.Command" )

myConn.Open DB_CONNECT_STRING

Set myCommand.ActiveConnection = myConn
myCommand.CommandText = "UPDATE lookup SET Col1 = 'Hello'"
myCommand.Execute
myConn.Close


First, you have to define the connection and recordset that you'll be using:

Set AdCn = CreateObject("ADODB.Connection")
Set AdRec = CreateObject("ADODB.Recordset")

After that, it's all about the connection string:

connstr="Provider=SQLOLEDB.1;Data Source=" & server & ";Initial Catalog=" & database & ";user id = '" & uid & "';password='" & pwd & "'"
The string consists of a few parts:

Provider: the type of connection you are establishing, in this case SQL Server.

Data Source: The server you are connecting to.

Initial Catalog: The name of the database.

user id: your username.

password: um, your password. 
;)

Note that if you want to use your Windows login credentials and are running the script locally then you can substitute the following for the username and password fields:

Integrated Security=SSPI
Of course, this won't work if you're using your script on a website, so you'll have to explicitly use username and password. 
Then, making sure your connection is open, you just open the recordset, hand over the SQL query, and capture the returned data as an array.

SQL="Select @@version as name"
AdCn.Open connstr
AdRec.Open SQL, AdCn,1,1
queryReturn=Adrec("name")
Just remember that the data is being returned as an array (often two dimensional, where the results you want are actually in the second dimension of the array!) and that you may need to either Trim to kill blank spaces at the end of results or parse the results with string functions like Left. 
Personally, I always Trim() a result while assigning it to a variable as I've been bitten by hidden blanks more times than I can count.


<h2>What is a VBA module?</h2>
VBScript does not have a module system

A VBA module is where you type your computer code. 
The code you type in a module when run can perform tasks in Excel like format worksheet data, process data, create charts, command databases...etc.

VBA code is typed and viewed in the VBA Editor in what are called modules. 
A collection of modules is called a VBA project. 
In the VBA Editor, a VBA module when viewed resembles and behaves like a Word document in both basic organization and typing. 
When viewed, a VBA module will appear in its own window within the VBA Editor. 
Think of modules as organizational units for your code, you add VBA modules as needed to a project to organize and run code.

VBA modules come in three different flavors: Standard modules, Object modules, and Class modules. 

A Standard module is where you will be typing most of your code when starting off in Excel VBA. 
Think of it as the town square, everybody can easily get to you and talk to you. 
You can assign shape buttons to procedures in these modules to easily run them. 

An Object module belongs to an Excel element like a workbook, chart, worksheet or a VBA element like a userform. 
You create events in them which are just Sub procedures that run when something occurs like pressing enter in a cell, opening a workbook, or clicking on a worksheet tab. 

These procedures can be used in place of clicking buttons to run code which is really cool but they require a lot of logic and programming know how to bring them under control. 
They tend to run when you do not want them to run. 

A Class module is used to create a class for an object. 
Classes are what you will be using to command Excel, Word, PowerPoint..., but these are already made, you will just learn to run them. 

Object oriented programming involves advanced programming concepts which are better left to investigate till after you learn the programming fundamentals. 

All of the modules just discussed appear in the Project Explorer window as icons. 

They are organized as follows: Standard modules are found under the Modules folder, Object modules are found under the Excel Objects folder, and Class modules are found under the Class Modules folder. 

One note here, they all do look alike so you have to look at the name of the module and then locate it in the Project Explorer tree to tell what type it is.

<a href="https://www.emagenit.com/VBA%20Folder/what_is_a_vba_module.htm" class="whitebut ">VBA Module</a>


<h2>open webpage in VBS</h2>
Dim URL,WshShell,i
URL = "www.yahoo.com"
Set WshShell = CreateObject("WScript.shell")
For i = 0 to 50
    WshShell.SendKeys(chr(175))
Next
WshShell.run "CMD /C start chrome.exe " & URL & "",0,False

<h2>Keep a VBScript window on top</h2>
' as well as adding a logoff button

Dim Title,ws,nMinutes,nSeconds,sMessage,Command,Executer
Title = "Session Timer"
Set ws = CreateObject("wscript.Shell")
nMinutes = 0
nSeconds = 10
sMessage = "&lt;font color=Red size=2>&lt;b>You have"
'Open a chromeless window with message
with HTABox("lightBlue",130,300,1070,600)
.document.title = "Session Timer"
.msg.innerHTML = sMessage
do until .done.value or (nMinutes + nSeconds &lt; 1)
    .msg.innerHTML = sMessage & "&lt;br>" & nMinutes & ":" &   Right("0"&nSeconds, 2) _
    & " minutes of session time remaining&lt;/b>&lt;/font>&lt;br>"
    wsh.sleep 1000 ' milliseconds
    nSeconds = nSeconds - 1
    if nSeconds &lt; 0 then 
        if nMinutes > 0 then
            nMinutes = nMinutes - 1
            nSeconds = 59
        end if
    end if
loop
.done.value = true
.close
end with
ws.Popup "Your session time has finished. You will now be logged off.","5",Title,0+48
'Command ="cmd /c Shutdown.exe -l -f"
'Executer = WS.Run(Command,0,False) 
'*****************************************************************
Function HTABox(sBgColor,h, w, l, t)
Dim IE, HTA, sCmd, nRnd
randomize : nRnd = Int(1000000 * rnd)
sCmd = "mshta.exe ""javascript:{new " _
& "ActiveXObject(""InternetExplorer.Application"")" _
& ".PutProperty('" & nRnd & "',window);" _
& "window.resizeTo(" & w & "," & h & ");" _
& "window.moveTo(" & l & "," & t & ")}"""
with CreateObject("WScript.Shell")
    .Run sCmd, 1, False
    do until .AppActivate("javascript:{new ") : WSH.sleep 10 : loop
    end with  'WSHShell
    For Each IE In CreateObject("Shell.Application").windows
        If IsObject(IE.GetProperty(nRnd)) Then
            set HTABox = IE.GetProperty(nRnd)
            IE.Quit
            HTABox.document.title = "HTABox"
            HTABox.document.write _
            "&lt;HTA:Application contextMenu=no border=thin " _
            & "minimizebutton=no maximizebutton=no sysmenu=no SHOWINTASKBAR=no >" _
            & "&lt;body scroll=no style='background-color:" _
            & sBgColor & ";font:normal 10pt Arial;" _
            & "border-Style:inset;border-Width:3px'" _
            & "onbeforeunload='vbscript:if not done.value then " _
            & "window.event.cancelBubble=true:" _
            & "window.event.returnValue=false:" _
            & "done.value=true:end if'>" _
            & "&lt;input type=hidden id=done value=false>" _
            & "&lt;center>&lt;span id=msg>&nbsp;&lt;/span>&lt;br>" _
            & "&lt;input type=button id=btn1 value=' Log Off ' "_
            & "onclick=done.value=true>&lt;center>&lt;/body>"
            HTABox.btn1.focus
            Exit Function
        End If
    Next
    MsgBox "HTA window not found."
    wsh.quit
End Function

<h2>VBS InternetExplorer.Application的屬性和方法介紹</h2>
示例程式碼
<code>
Set ie = CreateObject("InternetExplorer.Application") 
ie.Navigate "//www.jb51.net" 
Wscript.Sleep 1000 
ie.Toolbar = 0 
ie.visible=False 
ie.Document.f1.word.value = kw 
If ie.Document.f1.word.value="" Then Wscript.Quit </code>

上面是在網上看到的，Navigate Toolbar visible 等都是怎麼用的？？ 
怎麼網上找不到它們的用法？ 
下面是一些屬性說明：

Set ie=WScript.CreateObject(&#8220;internetexplorer.application&#8221;) 
ie.menubar=0 &#8216;不顯示IE物件選單欄 
ie.AddressBar=0 &#8216;不顯示IE物件位址列 
ie.ToolBar=0 &#8216;不顯示IE物件工具欄 
ie.StatusBar=0 &#8216;不顯示IE物件狀態列 
ie.FullScreen=1 &#8216;全屏化IE物件 
ie.Width=800 &#8216;設定IE物件寬度 
ie.Height=600 &#8216;設定IE物件高度 
ie.Resizable=0 &#8216;設定IE物件大小是否可以被改動 
ie.visible=1 &#8216;設定是否可見 
ie.Navigate &#8220;//www.jb51.net&#8221; &#8216;設定IE物件預設指向的頁面

目的留個備份，方便我以後去MSDN上找用法。

<strong>InternetExplorer Object</strong>

42 out of 82 rated this helpful <a title="Rate this topic" target="_blank" href="https://msdn.microsoft.com/en-us/library/aa752084#feedback">Rate this topic</a>

Controls an instance of Windows Internet Explorer through automation.

Members Table

The following table lists the members exposed by the InternetExplorer object.

Events
<tr><th>Event</th><th>Description</th></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768325" target="_blank">BeforeNavigate</a></td><td>Fires before navigation occurs in the given object (on either a window or frameset element).</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768326" target="_blank">BeforeNavigate2</a></td><td>Fires before navigation occurs in the given object (on either a window element or a frameset element).</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768328" target="_blank">CommandStateChange</a></td><td>Fires when the enabled state of a command changes.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768329" target="_blank">DocumentComplete</a></td><td>Fires when a document is completely loaded and initialized.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768330" target="_blank">DownloadBegin</a></td><td>Fires when a navigation operation begins.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768331" target="_blank">DownloadComplete</a></td><td>Fires when a navigation operation finishes, is halted, or fails.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/bb268220" target="_blank">FileDownload</a></td><td>Fires to indicate that a file download is about to occur. If a file download dialog box can be displayed, this event fires prior to the appearance of the dialog box.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768332" target="_blank">NavigateComplete</a></td><td>Fires after a navigation to a link is completed on either a <a href="https://msdn.microsoft.com/en-us/library/ms535873" target="_blank">window</a> element or a <a href="https://msdn.microsoft.com/en-us/library/ms535251" target="_blank">frameSet</a> element.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768334" target="_blank">NavigateComplete2</a></td><td>Fires after a navigation to a link is completed on a window element or a frameSet element.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/bb268221" target="_blank">NavigateError</a></td><td>Fires when an error occurs during navigation.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/cc891504" target="_blank">NewProcess</a></td><td>Creates a new process to handle the navigation.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768335" target="_blank">NewWindow</a></td><td>Fires when a new window is to be created.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768336" target="_blank">NewWindow2</a></td><td>Fires when a new window is to be created.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768337" target="_blank">NewWindow3</a></td><td>Raised when a new window is to be created. Extends <a href="https://msdn.microsoft.com/en-us/library/aa768336" target="_blank">NewWindow2</a> with additional information about the new window.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768338" target="_blank">OnFullScreen</a></td><td>Fires when the <a href="https://msdn.microsoft.com/en-us/library/aa752054" target="_blank">FullScreen</a> property is changed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768339" target="_blank">OnMenuBar</a></td><td>Fires when the <a href="https://msdn.microsoft.com/en-us/library/aa752059" target="_blank">MenuBar</a> property is changed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768340" target="_blank">OnQuit</a></td><td>Fires before the Internet Explorer application quits.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768341" target="_blank">OnStatusBar</a></td><td>Fires when the <a href="https://msdn.microsoft.com/en-us/library/aa752075" target="_blank">StatusBar</a> property is changed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768342" target="_blank">OnTheaterMode</a></td><td>Fires when the <a href="https://msdn.microsoft.com/en-us/library/aa752077" target="_blank">TheaterMode</a> property is changed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768343" target="_blank">OnToolBar</a></td><td>Fires when the <a href="https://msdn.microsoft.com/en-us/library/aa752078" target="_blank">ToolBar</a> property is changed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768344" target="_blank">OnVisible</a></td><td>Fires when the <a href="https://msdn.microsoft.com/en-us/library/aa752082" target="_blank">Visible</a> property of the object is changed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768345" target="_blank">PrintTemplateInstantiation</a></td><td>Fires when a print template is instantiated.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768346" target="_blank">PrintTemplateTeardown</a></td><td>Fires when a print template is destroyed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/bb268223" target="_blank">PrivacyImpactedStateChange</a></td><td>Fired when an event occurs that impacts privacy, or when a user navigates away from a URL that has impacted privacy.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768347" target="_blank">ProgressChange</a></td><td>Fires when the progress of a download operation is updated on the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768348" target="_blank">PropertyChange</a></td><td>Fires when the <a href="https://msdn.microsoft.com/en-us/library/aa752095" target="_blank">PutProperty</a> method of the object changes the value of a property.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/dd565687" target="_blank">RedirectXDomainBlocked</a></td><td>Fired when a cross-domain redirect request is blocked.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa741308" target="_blank">SetPhishingFilterStatus</a></td><td>Fires to indicate the progress and status of Microsoft Phishing Filter analysis of the current webpage.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/bb268224" target="_blank">SetSecureLockIcon</a></td><td>Fires when there is a change in encryption level.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768349" target="_blank">StatusTextChange</a></td><td>Fires when the status bar text of the object has changed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/cc848905" target="_blank">ThirdPartyUrlBlocked</a></td><td>Fired when a third-party URL is blocked.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768350" target="_blank">TitleChange</a></td><td>Fires when the title of a document in the object becomes available or changes.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768351" target="_blank">UpdatePageStatus</a></td><td>Not implemented.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/bb268225" target="_blank">WindowActivate</a></td><td>Not implemented.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/bb268226" target="_blank">WindowMove</a></td><td>Not implemented.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/bb268227" target="_blank">WindowResize</a></td><td>Not implemented.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa768358" target="_blank">WindowStateChanged</a></td><td>Fires when the visibility state of a content window, such as the browser window or a tab, changes.</td></tr>
</tbody></table>
Methods
<tr><th>Method</th><th>Description</th></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752086" target="_blank">ClientToWindow</a></td><td>Computes the full size of the browser window when given the specified width and height of the content area.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752087" target="_blank">ExecWB</a></td><td>Executes a command and returns the status of the command execution using the <a href="https://msdn.microsoft.com/en-us/library/ms683797" target="_blank">IOleCommandTarget</a> interface.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752088" target="_blank">GetProperty</a></td><td>Gets the value associated with a user-defined property name.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752089" target="_blank">GoBack</a></td><td>Navigates backward one item in the history list.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752090" target="_blank">GoForward</a></td><td>Navigates forward one item in the history list.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752091" target="_blank">GoHome</a></td><td>Navigates to the current home or start page.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752092" target="_blank">GoSearch</a></td><td>Navigates to the current search page.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752093" target="_blank">Navigate</a></td><td>Navigates to a resource identified by a URL or to a file identified by a full path.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752094" target="_blank">Navigate2</a></td><td>Navigates the browser to a location that might not be expressed as a URL, such as a pointer to an item identifier list (PIDL) for an entity in the Windows Shell namespace.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752095" target="_blank">PutProperty</a></td><td>Associates a user-defined name/value pair with the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752096" target="_blank">QueryStatusWB</a></td><td>Queries the object for the status of commands using the IOleCommandTarget interface.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752097" target="_blank">Quit</a></td><td>Closes the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752098" target="_blank">Refresh</a></td><td>Reloads the file that is currently displayed in the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752099" target="_blank">Refresh2</a></td><td>Reloads the file that is currently displayed with the specified refresh level.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752100" target="_blank">ShowBrowserBar</a></td><td>Shows or hides a specified browser bar.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752101" target="_blank">Stop</a></td><td>Cancels a pending navigation or download, and stops dynamic page elements, such as background sounds and animations.</td></tr>
</tbody></table>
Properties
<tr><th>Property</th><th>Description</th></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752048" target="_blank">AddressBar</a></td><td>Sets or gets a value that indicates whether the address bar of the object is visible or hidden.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752049" target="_blank">Application</a></td><td>Gets the automation object for the application that is hosting the <a href="https://msdn.microsoft.com/en-us/library/aa752040" target="_blank">WebBrowser Control</a>.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752050" target="_blank">Busy</a></td><td>Gets a value that indicates whether the object is engaged in a navigation or downloading operation.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752051" target="_blank">Container</a></td><td>Gets an object reference to a container.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752052" target="_blank">Document</a></td><td>Gets the automation object of the active document, if any.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752053" target="_blank">FullName</a></td><td>Retrieves the fully qualified path of the Internet Explorer executable.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752054" target="_blank">FullScreen</a></td><td>Sets or gets a value that indicates whether Internet Explorer is in full-screen mode or normal window mode.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752055" target="_blank">Height</a></td><td>Sets or gets the height of the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/bb268219" target="_blank">HWND</a></td><td>Gets the handle of the Internet Explorer main window.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752056" target="_blank">Left</a></td><td>Sets or gets the coordinate of the left edge of the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752057" target="_blank">LocationName</a></td><td>Retrieves the path or title of the resource that is currently displayed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752058" target="_blank">LocationURL</a></td><td>Gets the URL of the resource that is currently displayed.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752059" target="_blank">MenuBar</a></td><td>Sets or gets a value that indicates whether the Internet Explorer menu bar is visible.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752060" target="_blank">Name</a></td><td>Retrieves the frame name or application name of the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752061" target="_blank">Offline</a></td><td>Sets or gets a value that indicates whether the object is operating in offline mode.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752063" target="_blank">Parent</a></td><td>Gets the parent of the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752064" target="_blank">Path</a></td><td>Retrieves the system folder of the Internet Explorer executable.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752066" target="_blank">ReadyState</a></td><td>Gets the ready state of the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752069" target="_blank">RegisterAsBrowser</a></td><td>Sets or gets a value that indicates whether the object is registered as a top-level browser window.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752072" target="_blank">RegisterAsDropTarget</a></td><td>Sets or gets a value that indicates whether the object is registered as a drop target for navigation.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752073" target="_blank">Resizable</a></td><td>Sets or gets a value that indicates whether the object can be resized.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752074" target="_blank">Silent</a></td><td>Sets or gets a value that indicates whether the object can display dialog boxes.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752075" target="_blank">StatusBar</a></td><td>Sets or gets a value that indicates whether the status bar for the object is visible.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752076" target="_blank">StatusText</a></td><td>Sets or gets the text in the status bar for the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752077" target="_blank">TheaterMode</a></td><td>Sets or gets whether the object is in theater mode.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752078" target="_blank">ToolBar</a></td><td>Sets or gets whether toolbars for the object are visible.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752079" target="_blank">Top</a></td><td>Sets or gets the coordinate of the top edge of the object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752080" target="_blank">TopLevelContainer</a></td><td>Gets a value that indicates whether the object is a top-level container.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752081" target="_blank">Type</a></td><td>Gets the user type name of the contained document object.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752082" target="_blank">Visible</a></td><td>Sets or gets a value that indicates whether the object is visible or hidden.</td></tr>
<tr><td><a href="https://msdn.microsoft.com/en-us/library/aa752083" target="_blank">Width</a></td><td>Sets or gets the width of the object.</td></tr>
</tbody></table>
Remarks
<blockquote>
Internet Explorer 8. On Windows Vista, to create an instance of Internet Explorer running at a medium integrity level, pass CLSID_InternetExplorerMedium (defined in exdisp.idl) to <a href="https://msdn.microsoft.com/en-us/library/ms686615" target="_blank">CoCreateInstance</a>. The resulting InternetExplorerMedium object supports the same events, methods, and properties as the InternetExplorer object.
</blockquote>
Examples
<blockquote>
The following example uses <a href="https://msdn.microsoft.com/en-us/library/7t9k08y5(VS.71).aspx" target="_blank">CreateObject</a> in Microsoft Visual Basic to launch an instance of Internet Explorer.
</blockquote>
<code>
Dim IE As SHDocVw.InternetExplorer
Set IE = CreateObject("InternetExplorer.Application")</code>

The following C# example launches an instance of Internet Explorer and navigates to a Web page. The code also demonstrates how to create an event handler to listen for the BeforeNavigate2 event. The project requires a reference to the Microsoft Internet Controls (SHDocVw) type library.

<code>
using System;
using System.Collections.Generic;
using System.Text;
namespace ConsoleApplication1
{
class EventHandlers
{
public void OnBeforeNavigate2(object sender, ref object URL, 
ref object Flags, ref object Target, 
ref object PostData, ref object Headers, 
ref bool Cancel) 
{
Console.WriteLine("BeforeNavigate2 fired!");
}
}
class Program
{
static void Main(string[] args)
{
EventHandlers e = new EventHandlers();
SHDocVw.InternetExplorer IE = new SHDocVw.InternetExplorer();
object Empty = 0;
object URL = "http://www.live.com";
// override BeforeNavigate2 event
IE.BeforeNavigate2  = new
SHDocVw.DWebBrowserEvents2_BeforeNavigate2EventHandler(
e.OnBeforeNavigate2);
IE.Visible = true;
IE.Navigate2(ref URL, ref Empty, ref Empty, ref Empty, ref Empty);
System.Threading.Thread.Sleep(5000);
IE.Quit();
}
}
}
</code>


<h2>Better Than Batch: A Windows Scripting Host Tutorial</h2>
If you've been working in the computer world for a while then you're probably pretty familiar with batch jobs. 
IT professionals around the world utilized them to run all sorts of automated computer processing jobs and personal tasks. 
In fact Paul <a href="https://www.makeuseof.com/tag/write-simple-batch-bat-file/">recently covered</a> how to write such a file.

The problem with batch jobs is that they were very limited. 
The command set was somewhat short and didn't allow for very much functionality when it came to structured logic using if-then, for, next and while loops.

Later, Windows Scripting Host came along. 
The MS Windows Scripting Host is a multi-language script utility that Microsoft started installing as standard on all PCs from Windows 98 onward. 
By the second generation of the tool, it was renamed to Microsoft Script Host (MSH).

<h3> A Microsoft Scripting Host Tutorial</h3>

Here at MUO, we love computer automation. 
For example, Varun covered Sikuli, a tool to write automation scripts, and Guy showed you how to use <a href="https://www.makeuseof.com/tag/how-to-automate-mundane-tasks-with-autoit/">AutoIt</a> to automate tasks. 
The cool thing about MSH is that if you have any post-Win 98 PC, you can write a "batch" script in a variety of languages.

Available languages include JScript, VBA, and VBscript. 
It's also possible to write scripts in Perl, Python, PHP, Ruby or even Basic if you have the right implementation with the right scripting engine.

Personally, I know Visual Basic well, so I usually opt for VBScript. 
The beauty here is that you don't need any special programming software or compiler. 
Just open up Notepad and write your script, just like how you wrote your batch jobs.

Without installing anything, you can write scripts in VB. 
The simplest script is printing text to a pop-up window, like this:

 <source media="(min-width: 1024px)"
 sizes="750px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh1.jpg?q=50&fit=crop&w=750&dpr=1.5"/>
 <source media="(min-width: 768px)"
 sizes="943px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh1.jpg?q=50&fit=crop&w=943&dpr=1.5"/>
 <source media="(min-width: 481px)"
 sizes="767px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh1.jpg?q=50&fit=crop&w=767&dpr=1.5"/>
 <source media="(min-width: 0px)"
 sizes="480px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh1.jpg?q=50&fit=crop&w=480&dpr=1.5"/>
 
<img width="311" height="225" alt="windows scripting host tutorial"/>

Save the file as a .vbs and Windows will recognize and run it. 
This is what happens when you double click on the file above:

 <source media="(min-width: 1024px)"
 sizes="750px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh2.jpg?q=50&fit=crop&w=750&dpr=1.5"/>
 <source media="(min-width: 768px)"
 sizes="943px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh2.jpg?q=50&fit=crop&w=943&dpr=1.5"/>
 <source media="(min-width: 481px)"
 sizes="767px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh2.jpg?q=50&fit=crop&w=767&dpr=1.5"/>
 <source media="(min-width: 0px)"
 sizes="480px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh2.jpg?q=50&fit=crop&w=480&dpr=1.5"/>
 
<img width="168" height="158" alt="windows scripting"/>

You can write more advanced scripts utilizing the languages you're accustomed to. 
For the most flexibility, place &lt;job&gt; and &lt;script language="VBScript"&gt; (or whatever language you choose) around each segment of code in your file, and save it as a .wsf file. 
This way, so long as you enclose the code in the defined script language tags, you can use multiple languages in the same file.

To show you how cool this can be, I decided to write a script that would reach out to the NIST atomic clock to check the current time. 
If morning, it automatically opens my Thunderbird email client. 
If noon, it would open my browser to CNN.com. 
This conditional script gives you the ability to make your computer much more intelligent. 
If you run this script when your PC starts up, you can make it automatically launch whatever you like depending what time of day it is.

 <source media="(min-width: 1024px)"
 sizes="750px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh3a.jpg?q=50&fit=crop&w=750&dpr=1.5"/>
 <source media="(min-width: 768px)"
 sizes="943px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh3a.jpg?q=50&fit=crop&w=943&dpr=1.5"/>
 <source media="(min-width: 481px)"
 sizes="767px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh3a.jpg?q=50&fit=crop&w=767&dpr=1.5"/>
 <source media="(min-width: 0px)"
 sizes="480px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh3a.jpg?q=50&fit=crop&w=480&dpr=1.5"/>
 
<img width="426" height="415" alt="windows scripting"/>

The first part of the script goes out to the time server "<span>http://time.nist.gov:13</span>" and gets the current time. 
After formatting it correctly, it sets the computer time. 
Credit where credit is due, this script was adapted from TomRiddle's excellent script over at VisualBasicScript.com</a>. 
To save time, <em>always</em> find the example code you need online, and then tweak it to your needs.

Here's what the script does with just the code above implemented so far.

 <source media="(min-width: 1024px)"
 sizes="750px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh4.jpg?q=50&fit=crop&w=750&dpr=1.5"/>
 <source media="(min-width: 768px)"
 sizes="943px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh4.jpg?q=50&fit=crop&w=943&dpr=1.5"/>
 <source media="(min-width: 481px)"
 sizes="767px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh4.jpg?q=50&fit=crop&w=767&dpr=1.5"/>
 <source media="(min-width: 0px)"
 sizes="480px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh4.jpg?q=50&fit=crop&w=480&dpr=1.5"/>
 
<img width="243" height="163" alt="windows scripting"/>

Now that the script is working and will sync my PC every time it's launched, it's time to have it determine what to automatically launch depending on the time of day. 
In Windows Scripting Host, this task is as easy as an If-Then statement checking the hour of the day in the "Now" function, and then launching the appropriate software.

 <source media="(min-width: 1024px)"
 sizes="750px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/WSH5.jpg?q=50&fit=crop&w=750&dpr=1.5"/>
 <source media="(min-width: 768px)"
 sizes="943px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/WSH5.jpg?q=50&fit=crop&w=943&dpr=1.5"/>
 <source media="(min-width: 481px)"
 sizes="767px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/WSH5.jpg?q=50&fit=crop&w=767&dpr=1.5"/>
 <source media="(min-width: 0px)"
 sizes="480px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/WSH5.jpg?q=50&fit=crop&w=480&dpr=1.5"/>
 
<img width="549" height="340" alt="windows scripting host"/>

When launched between 8 to 10 in the morning, this script will start up my Thunderbird email client. 
When run between 11am to 1pm, it'll launch CNN.com in a browser. 
As you can see, just by being creating and adding a little bit of intelligence to a script file, you can do some pretty cool computer automation.

By the way, it's a very good idea to have a reference of scripting commands handy when you write these scripts. 
If you're into VBScript like me, a great resources is <a href="http://ss64.com/vb/" target="_blank">ss64.com</a>, which lists all VBScript commands alphabetically on one page.

 <source media="(min-width: 1024px)"
 sizes="750px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh6.jpg?q=50&fit=crop&w=750&dpr=1.5"/>
 <source media="(min-width: 768px)"
 sizes="943px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh6.jpg?q=50&fit=crop&w=943&dpr=1.5"/>
 <source media="(min-width: 481px)"
 sizes="767px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh6.jpg?q=50&fit=crop&w=767&dpr=1.5"/>
 <source media="(min-width: 0px)"
 sizes="480px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh6.jpg?q=50&fit=crop&w=480&dpr=1.5"/>
 
<img width="539" height="419" alt="windows scripting host"/>

Writing scripts alone isn't going to automate anything, because you'll still have to manually launch them. 
So to complete your automation using the Windows Script Host, go into the Task Scheduler in the control panel (administrator area) and select to create a task.

 <source media="(min-width: 1024px)"
 sizes="750px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh7.jpg?q=50&fit=crop&w=750&dpr=1.5"/>
 <source media="(min-width: 768px)"
 sizes="943px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh7.jpg?q=50&fit=crop&w=943&dpr=1.5"/>
 <source media="(min-width: 481px)"
 sizes="767px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh7.jpg?q=50&fit=crop&w=767&dpr=1.5"/>
 <source media="(min-width: 0px)"
 sizes="480px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh7.jpg?q=50&fit=crop&w=480&dpr=1.5"/>
 
<img width="491" height="258" alt="windows scripting host"/>

The scheduler lets you launch your script upon a whole assortment of events, such as time of day or on a specific schedule, when a system event takes place, or when the computer is first booted or logged into. 
Here, I'm creating a scheduled task to launch my script above every time the PC starts.

 <source media="(min-width: 1024px)"
 sizes="750px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh8b.jpg?q=50&fit=crop&w=750&dpr=1.5"/>
 <source media="(min-width: 768px)"
 sizes="943px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh8b.jpg?q=50&fit=crop&w=943&dpr=1.5"/>
 <source media="(min-width: 481px)"
 sizes="767px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh8b.jpg?q=50&fit=crop&w=767&dpr=1.5"/>
 <source media="(min-width: 0px)"
 sizes="480px" data-srcset="https://static1.makeuseofimages.com/wordpress/wp-content/uploads/2010/12/wsh8b.jpg?q=50&fit=crop&w=480&dpr=1.5"/>
 
<img width="516" height="347" alt="windows scripting host tutorial"/>

This is only a very brief Windows Scripting Host tutorial. 
Considering the number of commands and functions available in any of these scripting languages, the possibilities to automate all sorts of cool tasks on your PC are pretty much only limited by your imagination.

Some of the best sites to find pre-written scripts that you can use or customize include the following:

<ul> 
<a href="http://technet.microsoft.com/en-us/scriptcenter/default.aspx" target="_blank">Microsoft Script Center</a> - Straight from microsoft, and includes categories like Office, desktop, databases and active directory </li> 
<a href="http://www.computerperformance.co.uk/vbscript/" target="_blank">Computer Performance</a> - This UK site offers the best selection of VBScripts that I've seen online. 
</li> 
<a href="http://vlaurie.com/computers2/Articles/script.htm" target="_blank">Computer Education</a> - You'll find a small collection of scripts here, but they're very useful and they all work. 
</li> 
<a href="http://labmice.techtarget.com/scripting/default.htm" target="_blank">Lab Mice</a> - An awesome collection of batch programming resources like an assortment of logon scripts. 
</li> </ul>

Have you ever used the Windows Script Host? Do you have any cool tips or examples to share? Offer your insight and share your experiences in the comments section below.


<h2>fso.OpenTextFile</h2>
fso.OpenTextFile( filename, [ iomode, [ create, [ format ]]] )
https://analystcave.com/vba-filesystemobject-fso-in-excel/vba-opentextfile/
filename	Name of the text file to open.
iomode	Optional. One of three options:

Option	Value	Description
ForReading	1	Open the file as read only
ForWriting	2	Open file for write only
ForAppending	8	Open for appending only. Does not allow to overwrite existing text only writing to the end of the file

create	Optional. If True will allow to create a new file if no such file exists. If False file will not be created and an error will be raised.
format
Defines the coding of the text file:

Option	Value	Description
TristateUseDefault	-2	Default system coding
TristateTrue	-1	Unicode coding
TristateFalse	0	ASCII coding

The following code illustrates the use of the OpenTextFile method to open a file for appending text:

Sub OpenTextFileTest
    Const ForReading = 1, ForWriting = 2, ForAppending = 8
    Dim fs, f
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set f = fs.OpenTextFile("c:\testfile.txt", ForAppending, TristateFalse)
    f.Write "Hello world!"
    f.Close
End Sub


<h2>Win32-ComputerSystemProduct - WMI VBScript sample</h2>
The foundations for Manageability in Windows 2019/2016/2012/2008 and Windows 10/7/XP are Windows Management Instrumentation (WMI; formerly WBEM) and WMI extensions for Windows Driver Model (WDM).

ActiveXperts Network Monitor provides the ability to build monitor check routines based on WMI.
ActiveXperts has collected more than a hundred WMI samples.
You can use these samples as a base for new check routines you can write yourself.

The Win32_ComputerSystemProduct WMI class can be used in ActiveXperts Network Monitor to monitor your servers.

Win32-ComputerSystemProduct
Description
The Win32_ComputerSystemProduct WMI class represents a product. This includes software and hardware used on this computer system.

Example(s)
  On Error Resume Next
strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set colItems = objWMIService.ExecQuery("Select * from Win32_ComputerSystemProduct",,48)
For Each objItem in colItems
    Wscript.Echo "Caption: " & objItem.Caption
    Wscript.Echo "Description: " & objItem.Description
    Wscript.Echo "IdentifyingNumber: " & objItem.IdentifyingNumber
    Wscript.Echo "Name: " & objItem.Name
    Wscript.Echo "SKUNumber: " & objItem.SKUNumber
    Wscript.Echo "UUID: " & objItem.UUID
    Wscript.Echo "Vendor: " & objItem.Vendor
    Wscript.Echo "Version: " & objItem.Version
Next

<h2>to uniquely identify a computer</h2>
<a href="https://www.nextofwindows.com/the-best-way-to-uniquely-identify-a-windows-machine" class="whitebut ">UUID good way to uniquely identify a computer</a>

use wmic DISKDRIVE get SerialNumber

use MAC address
' get MAC address
dim WMI:
set WMI = GetObject("winmgmts:\\.\root\cimv2")
dim Nads: 
set Nads = WMI.ExecQuery("Select * from Win32_NetworkAdapter where physicaladapter=true") 
dim nad

for each Nad in Nads
if not isnull(Nad.MACAddress) then Wscript.Echo Nad.description, Nad.MACAddress
 next 

use uuid
'get uuid
'use the uuID attributes of the Win32_ComputerSystemProduct class
'to get the machine's GUID, which is read from the BIOS

strComputer ="."
' --------------------------------------------
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\CIMV2")
Set colItems = objWMIService.ExecQuery ("SELECT * FROM Win32_ComputerSystemProduct")

' On Error Resume Next
For Each objComputer In colItems
Wscript.Echo "uuID: " & objComputer.uuID
Next

WScript.Quit

<a href="https://activedirectory.ncsu.edu/advanced-topics/scripting-center/" class="whitebut ">PowerShell/VBScript example scripts for connecting/modifying AD or managing Windows machines</a>
<a href="https://www.youtube.com/watch?v=cYJr182tKHk&list=PLnK11SQMNnE6ViokNhxenEQ8vN2DuQFqx" class="whitebut ">PowerShell Universal tutorial</a>
<a href="https://ironmansoftware.com/powershell-universal" class="whitebut ">powershell-universal</a>

<a href="https://www.tutorialspoint.com/powershell/index.htm" class="whitebut ">Powershell Tutorial</a>

<h2>Time function</h2>
To output a script's execution time, include this at the beginning:
 
    dtmStartTime = Timer
 
And include this at the end:
 
    Wscript.Echo "Script execution time: " & Round(Timer - dtmStartTime, 2) & " seconds"
 
The Timer Jump function returns the number of seconds that have elapsed since midnight (12:00 a.m.).
The Round Jump function controls the number of decimal places displayed.
 
Here is a function that will convert seconds to days, hours, and minutes.
 
Function GetElapsedTime
    Const SECONDS_IN_DAY = 86400
    Const SECONDS_IN_HOUR = 3600
    Const SECONDS_IN_MINUTE = 60
    Const SECONDS_IN_WEEK = 604800
    dtmEndTime = Timer
    seconds = Round(dtmEndTime - dtmStartTime, 2)
    If seconds < SECONDS_IN_MINUTE Then
        GetElapsedTime = seconds & " seconds "
        Exit Function
    End If
    If seconds < SECONDS_IN_HOUR Then
        minutes = seconds / SECONDS_IN_MINUTE
        seconds = seconds MOD SECONDS_IN_MINUTE
        GetElapsedTime = Int(minutes) & " minutes " & seconds & " seconds "
        Exit Function
    End If
    If seconds < SECONDS_IN_DAY Then
        hours = seconds / SECONDS_IN_HOUR
        minutes = (seconds MOD SECONDS_IN_HOUR) / SECONDS_IN_MINUTE
        seconds = (seconds MOD SECONDS_IN_HOUR) MOD SECONDS_IN_MINUTE
        GetElapsedTime = Int(hours) & " hours " & Int(minutes) & " minutes " & seconds & " seconds "
        Exit Function
    End If
    If seconds < SECONDS_IN_WEEK Then
        days = seconds / SECONDS_IN_DAY
        hours = (seconds MOD SECONDS_IN_DAY) / SECONDS_IN_HOUR
        minutes = ((seconds MOD SECONDS_IN_DAY) MOD SECONDS_IN_HOUR) / SECONDS_IN_MINUTE
        seconds = ((seconds MOD SECONDS_IN_DAY) MOD SECONDS_IN_HOUR) MOD SECONDS_IN_MINUTE
        GetElapsedTime = Int(days) & " days " & Int(hours) & " hours " & Int(minutes) & " minutes " & seconds & " seconds "
        Exit Function
    End If
End Function
 
Here is a sample script using the function that prints "Hello World!" to the screen, waits for 1 second, then outputs the script execution time.
 
dtmStartTime = Timer
Wscript.Echo "Hello, World!"
Wscript.Sleep 1000
Wscript.Echo "Script completed in " & GetElapsedTime
 
Function GetElapsedTime
    Const SECONDS_IN_DAY = 86400
    Const SECONDS_IN_HOUR = 3600
    Const SECONDS_IN_MINUTE = 60
    Const SECONDS_IN_WEEK = 604800
 
    dtmEndTime = Timer
 
    seconds = Round(dtmEndTime - dtmStartTime, 2)
    If seconds < SECONDS_IN_MINUTE Then
        GetElapsedTime = seconds & " seconds "
        Exit Function
    End If
    If seconds < SECONDS_IN_HOUR Then
        minutes = seconds / SECONDS_IN_MINUTE
        seconds = seconds MOD SECONDS_IN_MINUTE
        GetElapsedTime = Int(minutes) & " minutes " & seconds & " seconds "
        Exit Function
    End If
    If seconds < SECONDS_IN_DAY Then
        hours = seconds / SECONDS_IN_HOUR
        minutes = (seconds MOD SECONDS_IN_HOUR) / SECONDS_IN_MINUTE
        seconds = (seconds MOD SECONDS_IN_HOUR) MOD SECONDS_IN_MINUTE
        GetElapsedTime = Int(hours) & " hours " & Int(minutes) & " minutes " & seconds & " seconds "
        Exit Function
    End If
    If seconds < SECONDS_IN_WEEK Then
        days = seconds / SECONDS_IN_DAY
        hours = (seconds MOD SECONDS_IN_DAY) / SECONDS_IN_HOUR
        minutes = ((seconds MOD SECONDS_IN_DAY) MOD SECONDS_IN_HOUR) / SECONDS_IN_MINUTE
        seconds = ((seconds MOD SECONDS_IN_DAY) MOD SECONDS_IN_HOUR) MOD SECONDS_IN_MINUTE
        GetElapsedTime = Int(days) & " days " & Int(hours) & " hours " & Int(minutes) & " minutes " & seconds & " seconds "
        Exit Function
    End If
End Function

<h2>execution time</h2>
StartTime = Timer()
....
EndTime = Timer()
Wscript.Echo "Seconds to 2 decimal places: " & FormatNumber(EndTime - StartTime, 2) 

use of left, right and mid

If (Right("0" & hour(now),2) + Right("0" & Minute(now),2)) > endTime then freq = 0


<h2>Create a Userform in Excel VBA</h2>
<b>Step 1</b> − Navigate to VBA Window by pressing Alt+F11 and Navigate to "Insert" Menu and select "User Form". 
Upon selecting, the user form is displayed as shown in the following screenshot.

<img src="https://www.tutorialspoint.com/vba/images/vba_user_form_1.jpg" >
<b>Step 2</b> − Design the forms using the given controls.
<img src="https://www.tutorialspoint.com/vba/images/vba_user_form_2.jpg" >

<b>Step 3</b> − After adding each control, the controls have to be named. 
Caption corresponds to what appears on the form and name corresponds to the logical name that will be appearing when you write VBA code for that element.
<img src="https://www.tutorialspoint.com/vba/images/vba_user_form_2_1.jpg" >

<b>Step 4</b> − Following are the names against each one of the added controls.

Control			Logical Name		Caption
From				frmempform		Employee Form
Employee ID Label Box	empid		Employee ID
firstname Label Box		firstname		First Name
lastname Label Box		lastname		Last Name
dob Label Box			dob		Date of Birth
mailid Label Box		mailid		Email ID
Passportholder Label Box	Passportholder		Passport Holder
Emp ID Text Box		txtempid		NOT Applicable
First Name Text Box		txtfirstname		NOT Applicable
Last Name Text Box		txtlastname		NOT Applicable
Email ID Text Box		txtemailid		NOT Applicable
Date Combo Box			cmbdate		NOT Applicable
Month Combo Box		cmbmonth		NOT Applicable
Year Combo Box			cmbyear		NOT Applicable
Yes Radio Button		radioyes		Yes
No Radio Button		radiono		No
Submit Button			btnsubmit		Submit
Cancel Button			btncancel		Cancel
<b>Step 5</b> − Add the code for the form load event by performing a right-click on the form and selecting 'View Code'.
<img src="https://www.tutorialspoint.com/vba/images/vba_user_form_3.jpg" >

<b>Step 6</b> − Select ‘Userform’ from the objects drop-down and select 'Initialize' method as shown in the following screenshot.
<img src="https://www.tutorialspoint.com/vba/images/vba_user_form_4.jpg" >
<b>Step 7</b> − Upon Loading the form, ensure that the text boxes are cleared, drop-down boxes are filled and Radio buttons are reset.

<pre class="prettyprint notranslate prettyprinted" style="">Private Sub UserForm_Initialize()
   'Empty Emp ID Text box and Set the Cursor 
   txtempid.Value = ""
   txtempid.SetFocus
   
   'Empty all other text box fields
   txtfirstname.Value = <k>""</k>
   txtlastname.Value = <k>""</k>
   txtemailid.Value = <k>""</k>
   
   'Clear All Date of Birth Related Fields
   cmbdate.Clear
   cmbmonth.Clear
   cmbyear.Clear
   
   'Fill Date Drop Down box - Takes 1 to 31
   With cmbdate
      .AddItem <k>"1"</k>
      .AddItem <k>"2"</k>
      .AddItem <k>"3"</k>
      .AddItem <k>"4"</k>
      .AddItem <k>"5"</k>
      .AddItem <k>"6"</k>
      .AddItem <k>"7"</k>
      .AddItem <k>"8"</k>
      .AddItem <k>"9"</k>
      .AddItem <k>"10"</k>
      .AddItem <k>"11"</k>
      .AddItem <k>"12"</k>
      .AddItem <k>"13"</k>
      .AddItem <k>"14"</k>
      .AddItem <k>"15"</k>
      .AddItem <k>"16"</k>
      .AddItem <k>"17"</k>
      .AddItem <k>"18"</k>
      .AddItem <k>"19"</k>
      .AddItem <k>"20"</k>
      .AddItem <k>"21"</k>
      .AddItem <k>"22"</k>
      .AddItem <k>"23"</k>
      .AddItem <k>"24"</k>
      .AddItem <k>"25"</k>
      .AddItem <k>"26"</k>
      .AddItem <k>"27"</k>
      .AddItem <k>"28"</k>
      .AddItem <k>"29"</k>
      .AddItem <k>"30"</k>
      .AddItem <k>"31"</k>
   End With
   
   'Fill Month Drop Down box - Takes Jan to Dec
   With cmbmonth
      .AddItem "JAN"
      .AddItem "FEB"
      .AddItem "MAR"
      .AddItem "APR"
      .AddItem "MAY"
      .AddItem "JUN"
      .AddItem "JUL"
      .AddItem "AUG"
      .AddItem "SEP"
      .AddItem "OCT"
      .AddItem "NOV"
      .AddItem "DEC"
   End With
   
   'Fill Year Drop Down box - Takes 1980 to 2014
   With cmbyear
      .AddItem <k>"1980"</k>
      .AddItem <k>"1981"</k>
      .AddItem <k>"1982"</k>
      .AddItem <k>"1983"</k>
      .AddItem <k>"1984"</k>
      .AddItem <k>"1985"</k>
      .AddItem <k>"1986"</k>
      .AddItem <k>"1987"</k>
      .AddItem <k>"1988"</k>
      .AddItem <k>"1989"</k>
      .AddItem <k>"1990"</k>
      .AddItem <k>"1991"</k>
      .AddItem <k>"1992"</k>
      .AddItem <k>"1993"</k>
      .AddItem <k>"1994"</k>
      .AddItem <k>"1995"</k>
      .AddItem <k>"1996"</k>
      .AddItem <k>"1997"</k>
      .AddItem <k>"1998"</k>
      .AddItem <k>"1999"</k>
      .AddItem <k>"2000"</k>
      .AddItem <k>"2001"</k>
      .AddItem <k>"2002"</k>
      .AddItem <k>"2003"</k>
      .AddItem <k>"2004"</k>
      .AddItem <k>"2005"</k>
      .AddItem <k>"2006"</k>
      .AddItem <k>"2007"</k>
      .AddItem <k>"2008"</k>
      .AddItem <k>"2009"</k>
      .AddItem <k>"2010"</k>
      .AddItem <k>"2011"</k>
      .AddItem <k>"2012"</k>
      .AddItem <k>"2013"</k>
      .AddItem <k>"2014"</k>
   End With
   
   <k>'Reset Radio Button. Set it to False when form loads.</k>
   radioyes.Value = False
   radiono.Value = False

End Sub

<b>Step 8</b> − Now add the code to the Submit button. 

Upon clicking the submit button, the user should be able to add the values into the worksheet.
Private Sub btnsubmit_Click()
Dim emptyRow As Long

'Make Sheet1 active
Sheet1.Activate
'Determine emptyRow

emptyRow = WorksheetFunction.CountA(Range("A:A")) + 1
'Transfer information
Cells(emptyRow, 1).Value = txtempid.Value

Cells(emptyRow, 2).Value = txtfirstname.Value
Cells(emptyRow, 3).Value = txtlastname.Value
Cells(emptyRow, 4).Value = cmbdate.Value &amp; "/" &amp; cmbmonth.Value &amp; "/" &amp; cmbyear.Value

Cells(emptyRow, 5).Value = txtemailid.Value
If radioyes.Value = True Then
Cells(emptyRow, 6).Value = "Yes"

Else
Cells(emptyRow, 6).Value = "No"
End If

End Sub
<b>Step 9</b> − Add a method to close the form when the user clicks the Cancel button.
Private Sub btncancel_Click()

Unload Me
End Sub
<b>Step 10</b> − Execute the form by clicking the "Run" button. 

Enter the values into the form and click the 'Submit' button. 
Automatically the values will flow into the worksheet as shown in the following screenshot.
<img src="https://www.tutorialspoint.com/vba/images/vba_user_form_5.jpg" >


<h2>opening PDF to send some keys to it</h2>
Sub Sample()
    ActiveWorkbook.FollowHyperlink "C:\MyFile.pdf"
End Sub
assuming that some pdf reader installed.

<h2>VBA execute a shell command</h2>
retVal = Shell("C:\Temp\gc.exe 1", vbNormalFocus)
Link: Shell Invoked from VBA


<h2>VBA open workbook</h2>
Steps to Open a Workbook using VBA
To start the code, use the “Workbooks” object.
Type a dot (.) after that and select the Open method from the list.
Specify the file path in the first argument and make sure to enclose it in double quotation marks.
In the end, run the code to open the workbook.

Sub vba_open_workbook()
Workbooks.Open "C:UsersDellDesktopmyFile.xlsx"
End Sub

<h2>VBScript CreateObject Function</h2>

CreateObject(servername.typename[,location])

Parameter	Description
  servername	Required. Name of the application
  typename	Required. The type/class of the object
  location	Optional. Where to create the object

Example
Creating a regular expression object:

txt="This is a beautiful day"
Set objReg=CreateObject("vbscript.regexp")
objReg.Pattern="i"
response.write(objReg.Replace(txt,"##"))

The output of the code above will be:
Th##s is a beautiful day

<h2>give list of running processes</h2>
Option Explicit
Call KillProcessbyName("common-api.jar")

'*

Sub KillProcessbyName(FileName)
    On Error Resume Next
    Dim WshShell,strComputer,objWMIService,colProcesses,objProcess
    Set WshShell = CreateObject("Wscript.Shell")
    strComputer = "."
    Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
    Set colProcesses = objWMIService.ExecQuery("SELECT * FROM Win32_Process")
    For Each objProcess in colProcesses
        If InStr(objProcess.CommandLine,FileName) > 0 Then
            If Err &lt;> 0 Then
                MsgBox Err.Description,VbCritical,Err.Description
            Else
                objProcess.Terminate(0) 
            End if
        End If
    Next
End Sub

<h3>vbscript view all running processes</h3>
<b>Using TaskList Command</b>

TaskList Command can be used to display a list of all running applications and services with their details and Process IDs(PIDs).

<code>
Dim ProTFPath, ProTF, StrPrInfo, StrPrInfoA, PrInfo

Set WshShell = WScript.CreateObject("Wscript.Shell")
Set FSO = WScript.CreateObject("Scripting.FileSystemObject")

ProTFPath = "C:\Users\User\Desktop\PROCESSES.txt"

WshShell.Run "CMD /C TASKLIST /V /FO LIST > """ + ProTFPath + """", 0, True
' Here Run is used instead Exec to avoid console window flashes.

If FSO.FileExists(ProTFPath) Then
  Set ProTF = FSO.OpenTextFile(ProTFPath, 1, False)
End If

StrPrInfoA = ProTF.ReadAll

PrInfo = Split(StrPrInfoA, VbCrLf + VbCrLf)

For I = 0 To UBound(PrInfo)
  WScript.Echo PrInfo(I)
Next

Erase PrInfo
ProTF.Close
</code>

If you no longer need this file, add following lines to the end of the script:
<code>
If FSO.FileExists(ProTFPath) Then
  FSO.DeleteFile(ProTFPath, True)
End If
</code>

by another answer
EXE_Process = AllProcessRunningEXE(".")
Vbs_Process = AllProcessRunningVBS (".")

Function AllProcessRunningEXE( strComputerArg )
strProcessArr = ""
    Dim Process, strObject
    strObject   = "winmgmts://" & strComputerArg
    For Each Process in GetObject( strObject ).InstancesOf( "win32_process" )
        strProcessArr = strProcessArr & ";" & vbNewLine & Process.name
    Next
    AllProcessRunningEXE = Mid(strProcessArr,3,Len(strProcessArr))
End Function


Function AllProcessRunningVBS (strComputerArg)
    strProcessArr = ""
    Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & strComputerArg & "\root\cimv2")
    Set colItems = objWMIService.ExecQuery ("Select * from Win32_Process Where Name = 'cscript.exe' OR Name = 'wscript.exe'")
    For Each objItem in colItems
        strProcessArr = strProcessArr & ";" & vbNewLine & objItem.CommandLine
    Next
    AllProcessRunningVBS = Mid(strProcessArr,3,Len(strProcessArr))

    Set objWMIService = Nothing
    Set colItems = Nothing
End Function

<b>VBScript via WMI</b>

This is straightforward script.
We are only querying the local workstation.

You could conceivably get a list of processes on machine B from machine A, and even stop/start those processes.
All remotely.
<code>
Option Explicit

Dim objWMIService, objProcess, colProcess
Dim strComputer, strList

strComputer = "."

Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colProcess = objWMIService.ExecQuery ("Select * from Win32_Process")

For Each objProcess in colProcess

    strList = strList & vbCr & objProcess.Name

Next

WSCript.Echo strList
</code>

<h2>用 VBScript 创建一个定时闹钟</h2>
使用 Windows Script Host (WSH) 对象模型中的计时器对象来实现。
以下是一个示例脚本，它可以设置多个定时器并具有重复响铃功能：

vbscript
Set objShell = CreateObject("WScript.Shell")

' 定义闹钟列表
Dim alarms(2)
alarms(0) = "08:00:00" ' 第一个闹钟时间
alarms(1) = "12:30:00" ' 第二个闹钟时间

' 定义重复响铃的次数
Dim repeatCount
repeatCount = 3 ' 每个闹钟响铃3次

' 处理每个闹钟
For Each alarm In alarms
    ' 获取当前时间和闹钟时间
    currentTime = Time
    alarmTime = CDate(alarm)

    ' 计算下一个闹钟时间
    If alarmTime &lt; currentTime Then
        nextAlarm = DateAdd("d", 1, Date) & " " & alarm
    Else
        nextAlarm = Date & " " & alarm
    End If

    ' 计算闹钟触发时间间隔（毫秒）
    interval = DateDiff("s", Now, CDate(nextAlarm)) * 1000

    ' 设置定时器并触发闹钟
    Set objTimer = CreateObject("WScript.Timer")
    objTimer.Interval = interval
    WScript.Sleep interval
    For i = 1 To repeatCount
        objShell.Popup "闹钟时间：" & alarm & vbCrLf & "响铃次数：" & i, , "闹钟"
        WScript.Sleep 1000 ' 1秒钟的延迟
    Next
Next

Set objTimer = Nothing

这个脚本使用一个数组来存储闹钟时间，您可以根据需要添加或修改闹钟。
每个闹钟的重复响铃次数由 repeatCount 变量控制，您可以根据需要进行调整。

脚本中的 objShell.Popup 语句用于显示弹出窗口，以模拟闹钟的铃声。
您可以根据需要修改弹出窗口的内容和样式。

要运行这个 VBScript 脚本，您可以将其保存为后缀名为 .vbs 的文件，然后双击运行。
脚本将按照设置的闹钟时间触发弹出窗口并进行重复响铃。

<h2>设置定时闹钟的日期，而不仅仅是时间</h2>
Set objShell = CreateObject("WScript.Shell")

' 定义闹钟列表
Dim alarms(2)
alarms(0) = "2023-11-13 08:00:00" ' 第一个闹钟日期和时间
alarms(1) = "2023-11-14 12:30:00" ' 第二个闹钟日期和时间

' 定义重复响铃的次数
Dim repeatCount
repeatCount = 3 ' 每个闹钟响铃3次

' 处理每个闹钟
For Each alarm In alarms
    ' 获取当前日期和时间
    currentDateTime = Now
    alarmDateTime = CDate(alarm)

    ' 计算下一个闹钟日期和时间
    If alarmDateTime < currentDateTime Then
        nextAlarm = DateAdd("d", 1, alarm)
    Else
        nextAlarm = alarm
    End If

    ' 计算闹钟触发时间间隔（毫秒）
    interval = DateDiff("s", Now, CDate(nextAlarm)) * 1000

    ' 设置定时器并触发闹钟
    Set objTimer = CreateObject("WScript.Timer")
    objTimer.Interval = interval
    WScript.Sleep interval
    For i = 1 To repeatCount
        objShell.Popup "闹钟日期和时间：" & alarm & vbCrLf & "响铃次数：" & i, , "闹钟"
        WScript.Sleep 1000 ' 1秒钟的延迟
    Next
Next

Set objTimer = Nothing

在这个修改后的脚本中，闹钟的日期和时间被存储在 alarms 数组中。您可以按照 "YYYY-MM-DD HH:mm:ss" 的格式设置日期和时间。如果闹钟的日期早于当前日期和时间，脚本将自动将其设置为下一天。

请注意，为了在日期和时间之间进行比较和计算，脚本使用了 Now 函数获取当前日期和时间，以及 CDate 函数将字符串转换为日期和时间类型。

保存并运行修改后的脚本，它将按照设置的日期和时间触发弹出窗口并进行重复响铃。

<h2>从文本文件中读取闹钟的日期和时间</h2>
使用 VBScript 中的文件操作功能。

Set objShell = CreateObject("WScript.Shell")

' 读取闹钟日期和时间的文本文件路径
Dim filePath
filePath = "C:\Path\to\alarms.txt"

' 打开文本文件并读取闹钟日期和时间
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.OpenTextFile(filePath, 1) ' 1 表示以只读模式打开文件

' 存储闹钟日期和时间的数组
Dim alarms()
i = 0

' 逐行读取文本文件并存储闹钟日期和时间
Do Until objFile.AtEndOfStream
    alarm = objFile.ReadLine()
    ReDim Preserve alarms(i)
    alarms(i) = alarm
    i = i + 1
Loop

' 关闭文件
objFile.Close
Set objFile = Nothing
Set objFSO = Nothing

' 定义重复响铃的次数
Dim repeatCount
repeatCount = 3 ' 每个闹钟响铃3次

' 处理每个闹钟
For Each alarm In alarms
    ' 获取当前日期和时间
    currentDateTime = Now
    alarmDateTime = CDate(alarm)

    ' 计算下一个闹钟日期和时间
    If alarmDateTime < currentDateTime Then
        nextAlarm = DateAdd("d", 1, alarm)
    Else
        nextAlarm = alarm
    End If

    ' 计算闹钟触发时间间隔（毫秒）
    interval = DateDiff("s", Now, CDate(nextAlarm)) * 1000

    ' 设置定时器并触发闹钟
    Set objTimer = CreateObject("WScript.Timer")
    objTimer.Interval = interval
    WScript.Sleep interval
    For i = 1 To repeatCount
        objShell.Popup "闹钟日期和时间：" & alarm & vbCrLf & "响铃次数：" & i, , "闹钟"
        WScript.Sleep 1000 ' 1秒钟的延迟
    Next
Next

Set objTimer = Nothing

在这个示例脚本中，您需要将 filePath 变量设置为包含闹钟日期和时间的文本文件的路径。
脚本将打开该文件并逐行读取闹钟的日期和时间，然后存储在 alarms 数组中。

注意，文本文件中的每一行应包含一个闹钟的日期和时间，按照您希望的格式进行存储，例如 "YYYY-MM-DD HH:mm:ss"。
每个闹钟的日期和时间应占据单独的一行。

保存并运行修改后的脚本，它将从文本文件中读取闹钟的日期和时间，并根据设置的日期和时间触发弹出窗口并进行重复响铃。


<h2>To split a string by a tab regular expressions</h2>
use the Split function along with a regular expression pattern.

Dim regex, inputString, splitArray

' Input string with tabs
inputString = "Hello" & vbTab & "World" & vbTab & "123"

' Create a regular expression pattern for matching tabs
Set regex = New RegExp
regex.Pattern = vbTab

' Split the string using the regular expression pattern
splitArray = Split(regex.Replace(inputString, ";"), ";")

' Display the split values
For Each item In splitArray
    WScript.Echo item
Next

The regex.Replace method is used to replace all occurrences of tabs with a semicolon ;.
Then, the Split function is used to split the modified string using the semicolon as the delimiter.
The result is stored in the splitArray variable.

Finally, you can iterate over the splitArray to display each individual split value.

<h2>.Popup method</h2>
Dim WshShell, answer
Set WshShell = WScript.CreateObject("WScript.Shell")
answer = WshShell.Popup("Do you feel alright?", 7, "Answer This Question:", 4 + 32)

Select Case answer
   case 6      WScript.Echo "Glad to hear you feel alright."
   case 7      WScript.Echo "Hope you're feeling better soon."
   case -1     WScript.Echo "Is there anybody out there?"
End Select

While WshShell.Popup("popup 2 secs without buttons", 2, "Title", buttonType) &lt;> -1
WEnd

<h2>the purpose of the colon</h2>
e. g.
Dim objConn : Set objConn = OpenConnection()

the colon used to combine the two statements into one line
the code would work exactly the same on two lines;
the colon's just a statement separator.

<h2>CreateObject</h2>
CreateObject Create an automation object / run an external command
CreateObject (strProgid [,strPrefix])

Depending on what software you've installed, you will already have hundreds if not thousands of COM objects available to play with.

One way to see what's available such list is by looking under Tools> References in the VBA editor within Word or other Office products. 

Then include a reference, and go to the Object Browser to see its methods and properties.

If you don't have Office installed, there are other ways to list the COM interfaces on your machine using VBScript. 

Take a look at Rob van der Woude's <a href="https://www.robvanderwoude.com/vbstech_objectbrowsers.php" class="whitebut ">VBScript Scripting Techniques - Editors, IDEs & Object Browsers page</a> where he describes some programs that provide an object browser.

He also gives a script that shows how to list ProgIds from your registry. 
I have over 3000 on my machine. 
Not all will have scriptable interfaces, but many will. .NET alone has hundreds of useful objects, and all are documented on MSDN. 

Once you have an interesting looking ProgId, do a Google search to find more about it.

<h2>example CreateObject() object List for vbs</h2>
CreateObject("ADODB.Command")
CreateObject("ADODB.Connection")
CreateObject("ADODB.Recordset")
CreateObject("ADODB.Stream")

CreateObject("Excel.Application")
WScript.CreateObject("Excel.Application")
CreateObject("InternetExplorer.Application")
WScript.CreateObject("InternetExplorer.Application")
CreateObject("iTunes.Application")
CreateObject("Outlook.Application")
CreateObject("Powerpoint.Application")
CreateObject("Shell.Application")
CreateObject("Word.Application")
For Each IE In CreateObject("Shell.Application").windows

CreateObject("CDO.Message")
CreateObject("htmlfile") 'To parse data from html tags
CreateObject("InetCtls.Inet.1")

CreateObject("Microsoft.Update.Searcher")
CreateObject("Microsoft.XmlDom")
CreateObject("MSCAL.Calendar")
CreateObject("MSSOAP.SOAPClient")

CreateObject("Msxml2.DOMDocument.5.0")
CreateObject("MSXML2.XMLHTTP") 'To sent xmlhttp request to webserver & get html code
CreateObject("Msxml2.XMLHttp.6.0")

CreateObject("objectname")
CreateObject("QuattroPro.PerfectScript")
CreateObject("rmocx.RealPlayer G2 Control.1")
CreateObject("SAFRCFileDlg.FileOpen")
CreateObject("SAFRCFileDlg.FileSave")
CreateObject("sapi.spvoice")
CreateObject("Scripting.Dictionary")
CreateObject("Scripting.FileSystemObject")
CreateObject("Scripting.FileSystemObject").GetStandardStream(1)
CreateObject("System.Collections.ArrayList")
CreateObject("System.Collections.SortedList")
CreateObject("System.Random")
CreateObject("System.Text.StringBuilder")
CreateObject("UltraWOL.ctlUltraWOL")
CreateObject("UserAccounts.CommonDialog")
CreateObject("vbscript.regexp")
CreateObject("WbemScripting.SWbemLocator")
CreateObject("WinHttp.WinHttpRequest.5.1")
CreateObject("WMPlayer.OCX")
CreateObject("WMPlayer.OCX.7")
CreateObject("WordPerfect.PerfectScript")
CreateObject("Wscript.Network")
CreateObject("Wscript.Shell")
CreateObject("WScript.Shell").Run "Your-VBScript-Here"
CreateObject("WScript.Timer")
CreateObject(servername.typename[,location])
Set colItems = objWMIService.ExecQuery ("Select * from Win32_Process Where Name = 'cscript.exe' OR Name = 'wscript.exe'")
taskkill /F /IM wscript.exe /T
taskkill /fi "imagename eq cscript.exe" (change to wscript.exe as needed)
With CreateObject("WMPlayer.OCX")
with CreateObject("WScript.Shell")
Wscript.ConnectObject oMyObject, "eventhandler_"
WScript.CreateObject("WSCript.shell")
Wscript.Createobject("MyObject.MyClass")
Wscript.Createobject("MyObject.MyClass","eventhandler_")
WScript.CreateObject("Scripting.FileSystemObject")
WScript.CreateObject("WScript.Shell")
WScript.CreateObject("WScript.Shell") WshShell.Run "notepad", 9
Wscript.DisconnectObject(oMyObject)
Wscript.Echo "Cool"
WScript.Echo Escape(VbCrLf)
WScript.Echo item
WScript.Echo Join( arrProgID, vbCrLf )
wscript.exe C:\Scripts\helloworld.js
WScript.Exec("Test_To_Block.vbs")
WScript.GetObject
Wscript.GetObject(strPathname [,strProgID] ], [strPrefix])
Wscript.Quit
WScript.ScriptName
Wscript.Shell
WScript.Sleep 100
WScript.Sleep interval
WScript.Sleep timerDuration
WScript.Sleep(100)
WScript.StdOut
Wscript.StdOut.Write "Your name is: " & Wscript.StdIn.ReadLin
WScript.StdOut.Write Chr(7)
WScript.StdOut.Write("text string to display")
WScript.StdOut.WriteLine "Hello"
Wscript.Timer
WSHNetwork = CreateObject("Wscript.Network")
WSHshell = CreateObject("Wscript.Shell")

WshShell.Run "%windir%\notepad " & WScript.ScriptFullName
WshShell.Run "taskkill /f /im wscript.exe", , True
WshShell.Run "notepad", 9

<h2>debug stand-alone VBScript script</h2>
Run cscript.exe for full command args
cscript //X scriptfile.vbs MyArg1 MyArg2
will run the script in a debugger

In order to debug vbs file, 
specify "//D //X" options in script host.
Both Windows-based script host (wscript.exe) and Command-based script host (cscript.exe) supports the same options.
When //D //X options are specified, Visual Studio debugger will be launched and start debugging for the VB script.
Microsoft Script Debugger
relatively minimal debugger for Windows Script Host-supported scripting languages, such as VBScript and JScript. 
Its user interface allows the user to set breakpoints and/or step through execution of script code line by line, and examine values of variables and properties after any step. 
Microsoft considers it to be deprecated. 

The Microsoft Script Editor
(MSE or "MSE.EXE" or "mse7.exe" in Office 2003) is an optional tool included in Microsoft Office

<h2>VBA爬网页数据</h2>
<h3>方法1 ：CreateObject(“InternetExplorer.Application”)</h3> 
Sub 方法1()
  url = "https://www.csdn.net/"
  Set ie = CreateObject("InternetExplorer.Application")
  With ie
    .Visible = False
    .navigate url
    Do Until .readystate - 4
        DoEvents
    Loop
    Set oDom = .document
  End With
    Debug.Print oDom.getElementsByTagName("p")(0).innertext
End Sub

PS:此方法会打开浏览器读取数据，虽然我们看不到打开浏览器是因为设置的：.Visible = False不可见，实际在后台操作。
并且需要等待浏览器返回数据的时间，不然可能会跳出错误。

<h3>方法2 ：CreateObject(“WinHttp.WinHttpRequest.5.1”)</h3> 
Sub 方法2()
  url = "https://www.csdn.net/"
  Set xmlHttp = CreateObject("WinHttp.WinHttpRequest.5.1")
  Set oDom = CreateObject("htmlFile")
  With xmlHttp
    .Open "GET", url, False
    .send
    oDom.body.innerHTML = .ResponseText
  End With
  Debug.Print oDom.getElementsByTagName("p")(0).innertext
End Sub
PS:
 1、此方法如果P标签内为汉字，返回的为乱码，
 2、使用WPS用户访问外部网站会跳出安全频道的错误，局域网网址并不会出现，此问题暂时无解。

 <img src="https://img-blog.csdnimg.cn/20210331161836490.png"> 

<h3>方法3：CreateObject(“msxml2.xmlhttp”)</h3> 
Sub 方法3()
  Dim oDom As Object
  url = "https://www.csdn.net/"
  Set oDom = CreateObject("htmlFile")
  Set ms = CreateObject("msxml2.xmlhttp")
  With ms
    .Open "GET", url, True
    .send
    oDom.body.innerHTML = .responseText
  End With
  Debug.Print oDom.getElementsByTagName("p")(1).innertext
End Sub
PS：
 1、msxml2可以自动适应字符乱码问题，兼容性较强。
 2、缺点对于对于已经访问的 网站，如果网站内更新的内容，仍然是以前的老数据。
 原因msxml2是读取的上次缓存的数据才造成的。

 解决方案：程序运行前先清空浏览器缓存。
 使用：Shell "RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 8 "。
 如果不行，请自行测试下其他方式，注释及方法纯个人理解，难免有差错。
 
Sub Clear_Temp_Files()
  Shell "RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 8 " '清除临时文件
End Sub

Sub Clear_Cookies()
  Shell "RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 2" '清除Cookies
End Sub

Sub Clear_History()
  Shell "RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 1" '清除历史记录
End Sub
 
Sub Clear_Form_Data()
  Shell "RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 16" '清除表单数据
End Sub

Sub Clear_Saved_Passwords()
  Shell "RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 32" '清除记住的账号密码
End Sub

Sub Clear_All()
  Shell "RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 255" '清除所有
End Sub

Sub Clear_Clear_Add_ons_Settings()
  Shell "RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 4351" '清除创建默认设置
End Sub
<img src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png">

<h3>方法4： CreateObject(“Msxml2.ServerXMLHTTP”)</h3> 
Sub 方法3()
  Dim oDom As Object
  url = "https://www.csdn.net/"
  Set oDom = CreateObject("htmlFile")
  Set ms =  CreateObject("Msxml2.ServerXMLHTTP")
  With ms
    .Open "GET", url, False
    .send
    oDom.body.innerHTML = .responseText
  End With
  Debug.Print oDom.getElementsByTagName("p")(1).innertext
End Sub
PS:
 1、与方法3基本一致，唯一不同是加上此方法不会造成数据缓存的问题，保证读取的数据都是最新的。
 2、和方法2问题一样WPS用户访问外部网站会跳出安全频道的错误，局域网网址并不会出现，此问题暂时无解 

<h3>解决CreateObject(“WinHttp.WinHttpRequest.5.1”)乱码问题</h3> 
Function UrlFile(Url, Ucode) '获取网页源文件(网址,编码)
    Dim oServerXmlHttp, ObjStream, oStream
    Set oServerXmlHttp = CreateObject("WinHttp.WinHttpRequest.5.1")
    oServerXmlHttp.Open "GET", Url, False
    oServerXmlHttp.send
    oStream = oServerXmlHttp.responseBody
    If Not IsEmpty(oStream) Then
        If InStr(1, oServerXmlHttp.getResponseHeader("content-type"), "charset", 1) Then '通过判断"content-type"是否有"charset"字符串来决定是否根据参数2转码(文本比较——不区分大小写)
            UrlFile = oServerXmlHttp.responseText
        Else
            Set ObjStream = CreateObject("Adodb.Stream") 'With...end with省略对象不可写在判断内
            ObjStream.Type = 1
            ObjStream.Mode = 3
            ObjStream.Open
            ObjStream.Write oStream
            ObjStream.Position = 0
            ObjStream.Type = 2
            ObjStream.Charset = Ucode
            UrlFile = ObjStream.ReadText
        End If
    Else
        UrlFile = ""
    End If
    Set ObjStream = Nothing: Set oServerXmlHttp = Nothing
End Function

Sub 读取整个网页()
  tex = UrlFile("https://www.csdn.net/", "UTF-8")
  Debug.Print tex
End Sub

<img src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png">

<h3>其他问题（获取某个标签的值）</h3> 
使用以下方法时有时会出现自动打开网页问题： 
<h6>方法2 ：CreateObject(“WinHttp.WinHttpRequest.5.1”)</h6> 
<h6>方法3：CreateObject(“msxml2.xmlhttp”)</h6> 
<h6>方法4： CreateObject(“Msxml2.ServerXMLHTTP”)</h6> 
 后来发现是oDom在作怪，在oDom.body.innerHTML = .ResponseText数据转换时会发生。

 解决方案：
 不使用oDOM，使用正则表达式取值,假如我要取所有P标签的值，如下 
 Part = .responseText
 Set re = CreateObject("VBScript.RegExp")
    re.Pattern = "&lt;p.*>(.*?)&lt;/p>"
    're.Pattern = "p>.*[\s\S]*&lt;/p"
    re.Global = True
    re.IgnoreCase = False
    Set matchs = re.Execute(OrgStr)
   
    For Each m In matchs
        Debug.Print m.submatches(0) 
    Next
完结



<h2>change CurrentDirectory</h2>
Set objShell = CreateObject("Wscript.Shell")
Wscript.Echo objShell.CurrentDirectory

objShell.CurrentDirectory = "C:\Windows"
Wscript.Echo objShell.CurrentDirectory

shell.currentdirectory = "c:\Deploy\"
shell.Run("""c:\Deploy\MainForm.exe""")

Dim oShell : Set oShell = CreateObject("WScript.Shell")
oShell.CurrentDirectory = ".\backup"

Set fso = CreateObject("Scripting.FileSystemObject")
currentPath = fso.GetAbsolutePathName(".")

Set fso = CreateObject("Scripting.FileSystemObject")  
Set f1 = fso.GetFolder(".") ' Returns the current directory  
Set f2 = fso.GetFolder(".\backup") ' Returns the "backup" directory under the current directory

<h2>Download a file with VBS</h2>
https://stackoverflow.com/questions/2973136/download-a-file-with-vbs

using XMLHTTP and leverage an ADO stream to write the binary data;

dim xHttp: Set xHttp = createobject("Microsoft.XMLHTTP")
dim bStrm: Set bStrm = createobject("Adodb.Stream")
xHttp.Open "GET", "http://example.com/someimage.png", False
xHttp.Send

with bStrm
    .type = 1 '//binary
    .open
    .write xHttp.responseBody
    .savetofile "c:\temp\someimage.png", 2 '//overwrite
end with

The above answer threw the error Write to file failed.
Code: 800A0BBC, however this worked:

HTTPDownload "http://www.emagcloud.com/europeansealing/FSA_ESA_Compression_Packing_Technical_Manual_v3/pubData/source/images/pages/page10.jpg", "C:\"

Where

Sub HTTPDownload( myURL, myPath )
    ' This Sub downloads the FILE specified in myURL to the path specified in myPath.
    '
    ' myURL must always end with a file name
    ' myPath may be a directory or a file name; in either case the directory must exist
    '
    ' Written by Rob van der Woude
    ' http://www.robvanderwoude.com
    '
    ' Based on a script found on the Thai Visa forum
    ' http://www.thaivisa.com/forum/index.php?showtopic=21832
    
        ' Standard housekeeping
        Dim i, objFile, objFSO, objHTTP, strFile, strMsg
        Const ForReading = 1, ForWriting = 2, ForAppending = 8
    
        ' Create a File System Object
        Set objFSO = CreateObject( "Scripting.FileSystemObject" )
    
        ' Check if the specified target file or folder exists,
        ' and build the fully qualified path of the target file
        If objFSO.FolderExists( myPath ) Then
            strFile = objFSO.BuildPath( myPath, Mid( myURL, InStrRev( myURL, "/" ) + 1 ) )
        ElseIf objFSO.FolderExists( Left( myPath, InStrRev( myPath, "\" ) - 1 ) ) Then
            strFile = myPath
        Else
            WScript.Echo "ERROR: Target folder not found."
            Exit Sub
        End If
    
        ' Create or open the target file
        Set objFile = objFSO.OpenTextFile( strFile, ForWriting, True )
    
        ' Create an HTTP object
        Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )
    
        ' Download the specified URL
        objHTTP.Open "GET", myURL, False
        objHTTP.Send
    
        ' Write the downloaded byte stream to the target file
        For i = 1 To LenB( objHTTP.ResponseBody )
            objFile.Write Chr( AscB( MidB( objHTTP.ResponseBody, i, 1 ) ) )
        Next
    

<h2>display an image in vbscript</h2>
Dim iURL 
Dim objShell

iURL = "https://storage.googleapis.com/pai-images/6fd3acaec2c241e6b1a2076003a5b260.jpeg"

set objShell = CreateObject("WScript.Shell")
objShell.run(iURL)

if chrome is not default:
set objShell = CreateObject("Shell.Application")
objShell.ShellExecute "chrome.exe", iURL, "", "", 1


<h2>Web Scraping Demo Script</h2>
'Web Scraping Demo Script
option Explicit
dim myBrowser, i, s, allData, data, line

' The SeeShell Browser for Web Automation
' https://ui.vision/download/seeshell-browser

set myBrowser = CreateObject ("seeshell.browser")

If myBrowser Is Nothing Then msgbox ("API not installed")

i = myBrowser.open(true)

if i < 0 then msgbox ("Start error: " + cstr(i) +" " +myBrowser.getLastError())
i = myBrowser.echo ("Processing...")
i = myBrowser.Play("demo-webscraping")

if i < 0 then
    msgbox "Error playing macro: " + cstr(i) + vbCrLf + vbCrLf +"Text: "+myBrowser.getLastError()
    'Stop here
    i = myBrowser.close()
    WScript.Quit(i)
 end if 
  
i = myBrowser.echo ("Done!")

'Display all data 
allData = myBrowser.GetExtractImageData()
s = "Extraction done - this is how the raw returned data looks like:"+vbCrLf+vbCrLf
s = s+ allData+vbCrLf+vbCrLf
s = s + "Press OK to display the exchange rates."
msgbox s

'The data is separated by [REC] for each line, and by [DATA] for each line (if there is more than one pink frame)
'http://stackoverflow.com/questions/14103510/split-function-on-an-array
data = Split(allData, "[DATA]")

'In this case we ignore all the extracted HTML and URLs, this is only in the macro for demo purposes
'In this script, we only care and display the extracted TEXT data - the exchange rate
'line 0 - BTC HTML code 
'line 1 - BTC Text... we need this
'line 2 - BTC Link... not needed
'line 3 - OCR'ed result (here the same as the text, but OCR works even with images and PDF)
'line 4 - Currency rates - needed

msgbox "Today's Bitcoin/US$ exchange rate is "+data(0)  'FIRST element has index = 0

s= "Today's currency exchange rates are"+vbCrLf+vbCrLf 
dim iStartPos 
iStartPos = 6
s = s+"USD/EUR: "+data(iStartPos+1)+vbCrLf 
s = s+ "USD/GBP: "+data(iStartPos+3)+vbCrLf 
s = s+ "USD/CNY: "+data(iStartPos+5)+vbCrLf 
s = s+ "EUR/GBP: "+data(iStartPos+4)+vbCrLf 
s = s+ "EUR/CNY: "+data(iStartPos+0)+vbCrLf 
s = s+ "GBP/CNY: "+data(iStartPos+2) +vbCrLf+vbCrLf 
s= s+ "In the next step, the data will be saved (appended) to a CSV file."
msgbox s

'SAVE TO CSV FILE
Dim sOut, fso, objFile
Const ForAppending = 8
sOut = "./exchangerates.txt"
Set fso = CreateObject("Scripting.fileSystemObject")
Set objFile = fso.OpenTextFile( sOut, ForAppending, True )
'Same "Today's exchange rates" to a file in CSV format
s = FormatDateTime(Now) + ","+  data(iStartPos+0) + "," + data(iStartPos+1) + "," + data(iStartPos+2) + "," + data(iStartPos+3) + "," + data(iStartPos+4) + "," + data(iStartPos+5)  
objFile.WriteLine(s)
objFile.Close
Set fso = Nothing

msgbox ("Data saved. Press OK to close the SeeShell Browser.")
i = myBrowser.close()
WScript.Quit(i)



<h2>run a VBS script from R and pass arguments</h2>
write the VBS as follows:
Dim Msg_Text
Msg_Text = WScript.Arguments(0)
MsgBox("Hello " & Msg_Text)

create a system command in R like this:
system_command <- paste("WScript", '"Msg_Script.vbs"', '"World"', sep = " ")
system(command = system_command, wait = TRUE)

Using named arguments:
Dim Msg_Text
Msg_Text = WScript.Arguments.Named.Item("Msg_Text")
MsgBox("Hello " & Msg_Text)

create a system command in R like this:
system_command <- paste("WScript", '"Msg_Script.vbs"', '/Msg_Text:"World"', sep = " ")
system(command = system_command, wait = TRUE)

<h2>Adding a GUI to VBScript</h2>
VBScript has dialogs, only not many and no checkboxes, you would need a COM object to do so (and there are).

Dim WshShell, BtnCode
Set WshShell = WScript.CreateObject("WScript.Shell")

BtnCode = WshShell.Popup("Do you feel alright?", 7, "Answer This Question:", 4 + 32)

Select Case BtnCode
   case 6      WScript.Echo "Glad to hear you feel alright."
   case 7      WScript.Echo "Hope you're feeling better soon."
   case -1     WScript.Echo "Is there anybody out there?"
End Select

However, the best way to have more dialogs in vbscript is using HTA which is rubbish too.

Take a look at Ruby, the start is easy to learn an it is FUN. Here an example of u ruby script using shoes as GUI

require 'green_shoes'
Shoes.app{
  button("Click me!"){alert("You clicked me.")}
}

EDIT: since my Ruby alternative rises some questions, here a more traditionel way closer to Vbscript uses of the same sample. The sample above is used more for a functional chained way of programming.

require 'green_shoes'
Shoes.app do
  button("Click me!") do
    alert("You clicked me.")
  end
end

<h2>vbscript Looping through a form to get field names and filed values</h2>

    For Each Item In Request.Form
      fieldName = Item
      fieldValue = Request.Form(Item)

      Response.Write(""& fieldName &" = Request.Form("""& fieldName &""")")       
    Next 

To test receiving correct input, change Response.Write to
Response.Write fieldName & " = " & fieldValue & "<br>"

Here's a Dictionary Object to put field names and field values together:

Dim Item, fieldName, fieldValue
Dim a, b, c, d

Set d = Server.CreateObject("Scripting.Dictionary")

For Each Item In Request.Form
    fieldName = Item
    fieldValue = Request.Form(Item)

    d.Add fieldName, fieldValue
Next

' Rest of the code is for going through the Dictionary
a = d.Keys  ' Field names  '
b = d.Items ' Field values '

For c = 0 To d.Count - 1
    Response.Write a(c) & " = " & b(c)
    Response.Write "<br>"
Next

VBScript code to add validation functionality to a Web page

Paste the following code in a new text file, save the file with an .htm extension, and then double-click the file to view it in a browser.
The HTML code is for a text box and a button.

Return result will be submitted to a server.

&lt;html>
&lt;head>&lt;title>Simple Validation&lt;/title>
&lt;SCRIPT LANGUAGE="VBScript"> 
&lt;!--
Sub Validate
  Dim TheForm
  Set TheForm = Document.forms("ValidForm")
  If IsNumeric(TheForm.Text1.Value) Then
    If TheForm.Text1.Value &lt; 1 Or TheForm.Text1.Value > 10 Then
      MsgBox "Please enter a number between 1 and 10."
    Else
      MsgBox "Thank you."
    End If
  Else
    MsgBox "Please enter a numeric value."
  End If
End Sub-->
&lt;/script>
&lt;/head>

&lt;body>
&lt;H3>Simple Validation&lt;/H3>

  &lt;form id="ValidForm" action="nothing.asp" onsubmit="Validate(); return false;" language="jscript">
    Enter a value between 1 and 10: 
      &lt;input name="Text1" TYPE="TEXT" SIZE="2">
      &lt;input name="Submit" TYPE="Submit" VALUE="Submit">
  &lt;/form>
&lt;/body>
&lt;/html>

<h2>Clipboard in vbscript</h2>
html object to retrieve the contents of the clipboard

' Get clipboard text
Set objHTML = CreateObject("htmlfile")
text = objHTML.ParentWindow.ClipboardData.GetData("text")

'use this snippet to put text back on the clipboard, but it needs third party software; a standalone executable clip.exe which can be found on Windows 2003 Server or just on the internet

' Do something with the text
text = replace(text, "you ", "you and your dog ")

' Put it back to the clipboard
Set WshShell = CreateObject("WScript.Shell")
Set oExec = WshShell.Exec("clip")

Set oIn = oExec.stdIn

oIn.WriteLine text
oIn.Close

Here's a code snippit (Outp. is a text stream)
VBScript doesn't support the clipboard.
Most hosts host vbscript, therefore vbscript running in IE or an HTA can use IE's clipboard support.
The scripting hosts do not give clipboard support.
You can use a vbs file to start IE through COM automation, navigate to a local page (to bypass security warnings), then use IE's clipboard.

    Set ie = CreateObject("InternetExplorer.Application") 
ie.Visible = 0
ie.Navigate2 "C:\Users\David Candy\Desktop\Filter.html"
Do 
    wscript.sleep 100
Loop until ie.document.readystate = "complete"  
txt=ie.document.parentwindow.clipboardData.GetData("TEXT")
ie.quit
If IsNull(txt) = true then 
    outp.writeline "No text on clipboard"
else
    outp.writeline txt
End If

'TO CLEAR
ClipBoard("")

'TO SET
ClipBoard("Hello World!")

'TO GET
Result = ClipBoard(Null)

Function ClipBoard(input)
'@description: A quick way to set and get your clipboard.
'@author: Jeremy England (SimplyCoded)
  If IsNull(input) Then
    ClipBoard = CreateObject("HTMLFile").parentWindow.clipboardData.getData("Text")
    If IsNull(ClipBoard) Then ClipBoard = ""
  Else
    CreateObject("WScript.Shell").Run _
      "mshta.exe javascript:eval(""document.parentWindow.clipboardData.setData('text','" _
      & Replace(Replace(Replace(input, "'", "\\u0027"), """","\\u0022"),Chr(13),"\\r\\n") & "');window.close()"")", _
      0,True
  End If
End Function

For the equivalent of a "paste" operation I would run a command-line utility like ClipOut or paste, redirect output to a file and read the file contents.

return = WshShell.Run("cmd /c clipout.exe > output.txt", 0, true)

Set fso  = CreateObject("Scripting.FileSystemObject")
Set file = fso.OpenTextFile("output.txt", 1)
text = file.ReadAll
file.Close
You can get ClipOut here: http://jasonfaulkner.com/ClipOut.aspx

You can get paste here: https://www.c3scripts.com/tutorials/msdos/paste.html

For the equivalent of a "copy" operation I would use the clip command line utility that actually comes with Windows and similar code as above.

About the clip utility: https://blogs.msdn.microsoft.com/oldnewthing/20091110-00/?p=16093

<h2>list of useful WScript properties</h2>
Properties of the WScript object:

<pk>WScript.Application</pk>
This property is read only and returns a reference to the current WScript instance.

<pk>WScript.BuildVersion</pk>
This property is read only and returns a Long value which is the build version number of cscript (or wscript).

<pk>WScript.FullName</pk>
This property returns the full path to cscript (or wscript). This property is read only.

<pk>WScript.Interactive [= True|False]</pk>
The Interactive property returns a Boolean that indicates if cscript (or wscript) was invoked in interactive mode. This property is read/write and can be used to change the mode of the currently executing script at runtime.
When this property is False, the interactive commands Echo, MsgBox and InputBox have no effect.

<pk>WScript[.Name]</pk>
The Name property is read only and returns the name of the WScript object (usually "Windows Script Host").
This is the default property of the WScript object.

<pk>WScript.Path</pk>
This property is read only and returns the full path to the directory containing cscript (or wscript).

<pk>WScript.ScriptFullName</pk>
This property is read only and returns the full path to the script currently being executed.

<pk>WScript.ScriptName</pk>
This property is read only and returns the filename of the script currently being executed.

<pk>WScript.StdErr</pk>
This property returns a TextStream object that outputs text to the Standard Error stream.
This property is read only and can only be used when cscript is the host executable.

<pk>WScript.StdIn</pk>
The StdIn property returns a TextStream object that reads text from the Standard Input stream.
This property is read only and can only be used when cscript is the host executable.

<pk>WScript.StdOut</pk>
This property returns a TextStream object that outputs text to the Standard Output stream.
This property is read only and can only be used when cscript is the host executable.

<pk>WScript.Timeout[ = lngTimeout]</pk>
This property is used to set or get the timeout period (in seconds) for the currently executing script. The script will automatically be terminated after the number of seconds specified by this property, which is of type Long.

<pk>WScript.Version</pk>
This property is read only and returns a string that is the version number of the host executable.

<pk>Examples</pk>
'Output the version of Microsoft Windows Script Host.
strVer = WScript.Version
<pk>WScript.Echo strVer</pk>

'Output the full path-name of the currently running script.
strFull = WScript.ScriptFullName
<pk>WScript.Echo strFull</pk>

'The Application property returns a reference to the current instance of the WScript object.
Set objWScript = WScript.Application
If WScript = objWScript Then
 WScript.Echo "This proves they refer to the same thing"
End If

<h2><pk>VB Lectures</pk></h2>
<br>
<br>
<div id="VBLecturestoc" class="toc"><a href="#VBLecturestopic-0" target="_self">Lecture 1 Scripting Concepts</a><br><a href="#VBLecturestopic-1" target="_self">Lecture 2 VBScript Basics</a><br><a href="#VBLecturestopic-2" target="_self">Lecture 3 Logon Scripts</a><br><a href="#VBLecturestopic-3" target="_self">Lecture 4 Objects in VBScript</a><br><a href="#VBLecturestopic-4" target="_self">Lecture 5 Getting access to remote machines</a><br><a href="#VBLecturestopic-5" target="_self">Lecture 6 Manage Folders/Files Using FSO </a><br><a href="#VBLecturestopic-6" target="_self">Lecture 7 Working with ADSI</a><br><a href="#VBLecturestopic-7" target="_self">Lecture 8 E-Mail Automation</a><br><a href="#VBLecturestopic-8" target="_self">Lecture 9 Hypertext Applications (HTAs)</a><br><a href="#VBLecturestopic-9" target="_self">Lecture 10 CGI Scripting</a><br><a href="#VBLecturestopic-10" target="_self">Lecture 11 Server Side programming Using Perl</a><br><a href="#VBLecturestopic-11" target="_self">Lecture 12 Conclusion</a><br></div></center>
https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___1.html

<h3 id="VBLecturestopic-0">Lecture 1 Scripting Concepts</h3>
<pk>Key words</pk>
WSH (Windows Script Host), VBScript (short for Visual Basic Scripting Edition).

Download the script: <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___1_files/Sample1.vbs" title="Lecture___1_files/Sample1.vbs">Sample1.vbs</a>. 
Save it in any folder and double click it. 
By the way, you have to work with Windows (hopefully the version is no earlier than Windows 2000).

You will see "I am Jamie Yang!" in a small window. 
Otherwise, you might have to reinstall your operating system. 
Of course, you are not 'Jamie Yang'. 
Right click the file and choose Edit. 
You will open it in Notepad. 
Change 'Jamie Yang' to your name. 
Run it again - does it display your name?

If succeeded, try on another one: <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___1_files/Sample2.vbs" title="Lecture___1_files/Sample2.vbs">Sample2.vbs</a>. 

What do we mean by scripting?

"For the purposes of this book, scripting refers to the act of creating, executing, and utilizing small computer programs that are written in a high-end scripting language, specifically, VBScript."

Not really. 
VBScript is just one of the many scripting languages. 
There are plenty of others, some for unix, some for Windows, and some for both. 
Examples of scripting languages are Perl, php, shell script, JScript, JavaScript, .... 
In this subject, we will use VBScript for Windows and Perl for Unix.

By the way, is there any link between VBScript and Visual Basic, also JavaScript and Java? Yes, there is. 
VBScript can be viewed as a lightweight version of VB and JavaScript can be viewed as a lightweight version of Java. 
If you do not agree, think in this way - they are similar in syntax at least. 
However, unlike C and C++, none of the pairs is compatible. 

What about JavaScript and JScript? JScript is Windows' version of JavaScript. 
It is more C style.

VB is one of the simplest programming languages, compared to Java, C, and C++. 
VBScript is even simpler. 
Therefore we are learning probably the simplest programming language in the world. 

Common characteristics of scripting languages:

1. Interpreted: the scripting engine reads each line of script, one at a time, and executes it.
2. Text-based: program itself is a text file.
3. Native: mostly a scripting language can only be used for certain purposes or with certain operating systems. 
4. Easy to deploy: lightweight.

The environment running VBScript programs

Like VB and Java, VBScript is an interpreted language, which means that the program itself is not runnable. 
It needs another program to execute it. 
This program is Windows Script Host (WSH). 
The WSH architecture is shown in the figure below:  

WSH is a built-in component of Windows 2000, Windows XP, Windows Server 2003, Windows Vista, and later versions of Windows. 
If you have an early version of Windows, you need to download a file WScript.exe or CScript.exe from Microsoft.

WScript.exe is window-based WSH environment, and CScript.exe sets up a command-line style of WSH  interpreter. 
Try this:

1.Open a command-line window.
2.Change directory to the folder where the script sample1.vbs is.
3.Enter: CScript sample1.vbs.

You will see the same message appears in the command-line window as you have seen by double clicking the program. 
Trust me. 
CScript.exe is useful when you debug a program. 

We can do more things using VBScript

VBScript is completely capable of utilizing COM, the Component Object Model, which makes VBScript powerful. 
You can get a COM object by using the function: GetObject(). 
As such you can use almost all Windows' functionalities as well as other Microsoft applications' functionalities packaged in COM. 
Try this: 
 
 Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___1_files/SerialNoOS.vbs" title="Lecture___1_files/SerialNoOS.vbs">SerialNoOS.vbs</a>, and execute it. 

This script tells you the serial number of your Windows operating system. 
Of course, you need a good knowledge of Windows systems to know where the information is stored. 
At least, you now know where it is. 
So try more, know more. 
Here is another one. 

 Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___1_files/WhoOpened.vbs" title="Lecture___1_files/WhoOpened.vbs">WhoOpened.vbs</a>, and execute it. 

The language itself isn't complicated, is it?  However, to do a better job, we need to use some appropriate functionalities/services of the operating system. 
How to locate the relevant functionalities for carrying out a task? This could be the scary point of learning VBScript. 
A good thing is that you don't have to know everything about the operating system. 
Most administrative tasks are quite routine. 
You only need to know a few facts. 
Then you use them every day. 
Or once a job is done, it works forever. 
This is what we want to achieve with this subject. 

 
I have to remind you that the power of VBScript can be used not only for beneficial administrative tasks, but also for malicious hacking, and many viruses are based on VBScript or other AcvtiveX scripting languages. 
 
That's all for today. 
Now have a cup of tea?  

 

 
<h3 id="VBLecturestopic-1">Lecture 2 VBScript Basics</h3>

Did you enjoy the first lecture? Trust you did - at least you enjoyed your coffee. 

VBScript is powerful and mostly used by computing professionals. 
While you can write some fairly simple scripts, you can also write sophisticated scripting code. 
In this lecture, we will learn the basics of VBScript - working with variables, calling functions, controlling structures etc. 

<pk>Key words</pk>

Variable, Function, Procedure/Subroutine, Control Structure

Another common practice is referencing to online VBScript tutorials if necessary. 
This is very handy, and there are heaps of tutorial lessons over the Web - why don't we share the experience? 

In fact, the lecture notes cannot cover everything in details. 
I just pick the most important issues and explain them with examples. 
Since you have done at least Programming Fundamentals, you know C++. 
What you need to know are the differences of the language basics between C++ and VBScript.

Variables

Variables are used to store data. 
Note that data can be anything from characters, strings, integers to encapsulated objects. 
Different from the general purpose languages, such as C, C++, and Java, VBScript is not a strongly typed language, which means that you don't have to tell the interpreter what type of data you are going to store in the variable you define. 
You can simply use Dim to declare any variables:

Dim myInteger
Dim myDouble
Dim myObject

The rules for variable names are similar to other languages but they are not case sensitive (see Textbook page 80). 

Strange enough, you even don't have to declare a variable.

Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___2_files/variables1.vbs" title="Lecture___2_files/variables1.vbs">variables1.vbs</a>, and run it. 

Also

Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___2_files/variables2.vbs" title="Lecture___2_files/variables2.vbs">variables2.vbs</a>, and run it. 

However, good scripts are planned. 
It's better to declare the variables that you are going to use. 
VBScript provides a simple statement 'Option Explicit' to tighten up your scripts, which says that: if a variable is not declared, then you cannot use it. 
(see Textbook page 81).

A variable can also store an array of elements. 
See the following example. 
Please pay attention to the declaration of an array variable and assignment of elements to the array. 

Dim aList(3)

aList(0) = "Monday"
aList(1) = "Tuesday"
aList(2) = "Wednesday"
aList(3) = "Thursday"

In this code, 

Dim aList(3) 

defines an array with Four members. 
If you do not believe that you can store four members in it,

Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___2_files/array1.vbs" title="Lecture___2_files/array1.vbs">array1.vbs</a>, and execute it. 

Alternatively, we do the same thing as follows:

Dim aList

aList = Array("Monday","Tuesday","Wednesday","Thursday")

Practice it with <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___2_files/array2.vbs" title="Lecture___2_files/array2.vbs">array2.vbs</a>. 

You can even resize an array after you have defined it.

Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___2_files/array3.vbs" title="Lecture___2_files/array3.vbs">array3.vbs</a>, and execute it. 

Functions

As for all other programming languages, VBScript allows you to create functions to modularize your code. 
Functions are isolated bits of code that are called to perform specific or repetitive operations. 
The following piece of  code shows you how to create a function:

function sum(a,b)
    sum = a + b
end function

Note that we don't have a return statement. 
We use the function name to return the value of the function. 
So convenient, isn't it? Use the following code for practice.

Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___2_files/functions.vbs" title="Lecture___2_files/functions.vbs">functions.vbs</a>, and execute it. 

 
Procedures/Subroutines

Procedures/Subroutines are functions without return values. 
Therefore it is like a void function. 
However, the syntax used to define a subroutine is different from that used to define a function (sub vs. 
function), and the way calling a subroutine is also different from calling functions.

Dim sum

a = 10
b = 20

calculate_sum a, b

MsgBox sum

sub calculate_sum( a, b)
    sum = a + b
end sub

Note that all variables used here are global, except that defined inside functions or subroutines.
  
Display messages

There are two built-in functions available for us to output messages: WScript.echo and MsgBox. 
The former can work in both a window-based scripting host and a command-line scripting host. 
The latter can only work in the Windows environment but is more versatile. 

Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___2_files/output1.vbs" title="Lecture___2_files/output1.vbs">output1.vbs</a>, and execute it. 

There is only one line in the code:

MsgBox "Are you sure?",4,"Check" 

The function MsgBox takes three arguments. 
The first one is the message you want displayed. 
The third one gives the title of the message box. 
The most tricky one, the second one, specifies the type of the message box. 
For instance, "4" indicates that the box contains 'Yes' and 'No' buttons. 
Change it to 1 to see what will happen. 
See details from the following webpage to learn about the MsgBox function:

<a title="http://msdn.microsoft.com/en-us/library/sfw6660x.aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/sfw6660x.aspx">http://msdn.microsoft.com/en-us/library/sfw6660x.aspx</a>

Download the script, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___2_files/output2.vbs" title="Lecture___2_files/output2.vbs">output2.vbs</a>, and execute it. 

This code shows you how to get a return value from MsgBox function.

Asking for input

To get input from users, you can simply use the built-in function InputBox. 
The following code illustrates its usage:

Dim vInput 

vInput = InputBox("Enter a server name", "Server")
MsgBox "You entered " &amp; vInput

The function returns an empty string if the cancel button is pressed. 
It returns -1 if esc key is pressed.

Controlling the flow of execution

As a powerful programming language, VBSript provides enough controlling structures for you. 
The following summarize the syntax of these structures. 
Most of them have been used in my example code.

Conditional execution: 
If  condition_expression Then
    statement1
ElseIf 
    statement2
else
    statement3
End if
 
Selection execution:

Select Case caseNumber
    Case 1
        statement1
    Case 2
        statement1

    ...

    Case Else
        statementn
End Select

Loops:

Do While condition
    statement
Loop

or 

Do 
    statement
Loop While condition

or

Do Until condition
    statement
Loop

or 

Do 
    statement
Loop Until

or

For counter = start To end
    statement
Next

or 

For counter = start To end Step number
    statement
Next

or 

For Each element In collection
    statement
Next

If you are a good C++ or Java programmer, it should be easy for you to get used to these structures. 
Otherwise, you need extra practice.

 
That's all for today. 
You may have spent more than two hours on this lecture. 
Thanks for your attention. 

  
  
  
 
<h3 id="VBLecturestopic-2">Lecture 3 Logon Scripts</h3>

From language point of view, VBScript is not a difficult programming language. 
Indeed, it is much less complicated than those popular general purpose programming languages, such as C, C++, and Java. 
However, use of the language requires knowledge of the operating system. 

From this lecture we start to learn Windows scripting techniques by performing a set of administrative tasks. 
The first task we are going to do today is to write a logon script to allocate network resources to users when they login.
            
<pk>Key words</pk>

WSH Object, WScript.Network, Network User, Network Drive, User Group, WMI

WSH objects
Download the script <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__3_files/userName.vbs" title="Lecture__3_files/userName.vbs">userName.vbs</a> and run it. 

The main part of the code is:

Dim objNetwork
Set objNetwork = WScript.CreateObject("WScript.Network")

Dim strComputer, strDomain, strUser
strComputer = objNetwork.ComputerName
strDomain = objNetwork.UserDomain
strUser = objNetwork.UserName

The first statement declares a variable objNetwork. 
The second statement assigns an object to the variable. 

Microsoft operating system, more accurately the WSH (Windows Script Host), provides a few objects for typical scripting purposes of performing administrative tasks. 
WScript.Network is one of most useful WSH Objects (also called WScript Objects). 
The following is the hierarchy of WSH objects:

Learn more about WSH Objects and Associated Tasks from <a href="http://msdn.microsoft.com/en-us/library/a74hyyw0(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/a74hyyw0(VS.85).aspx">Microsoft website</a>.

The Network object 

WScript.Network is an object that provides network information, such as computer name, domain name and username, as well as the functions of mapping drives and printers. 
We use the following statement to create an instance of the object:
 
WScript.CreateObject("WScript.Network")

WScript.Network has a set of properties and methods (See <a title="http://msdn.microsoft.com/en-us/library/s6wt333f(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/s6wt333f(VS.85).aspx">msdn online documents</a> or textbook page 174-179):

ComputerName Property

UserDomain Property

UserName Property

AddPrinterConnection Method

AddWindowsPrinterConnection Method

EnumNetworkDrives Method

EnumPrinterConnections Method

MapNetworkDrive Method

RemoveNetworkDrive Method

RemovePrinterConnection Method

SetDefaultPrinter Method

Using these properties or methods is not hard. 
For instance, suppose you assign the object WScript.Network to variable objNetwork, i.e.,

objNetwork = WScript.CreateObject("WScript.Network")

Please note that the real name which corresponds to the WScript.WshNetwork object is "WScript.Network". 
There is no a property of the WScript object that we can use to return the WScript.WshNetwork object, but using CreateObject("WScript.Network").

To get the computer name you are using, you can simply write

WScript.echo objNetwork.ComputerName

or assign objNetwork.ComputerName to a variable as we did in <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__3_files/userName_1.vbs" title="Lecture__3_files/userName_1.vbs">userName.vbs</a>.

Map a network drive

Whenever you login to a lab computer, you automatically get a U: drive. 
Obviously it is not a local drive. 
In fact it is a network drive that is mapped to a file folder located on a remote computer to which you have access. 
As a network user, you might not know which file folder is available to you. 
However, if you are an administrator, you have control over your network storage. 

Suppose that you are an administrator, and jamie is one of the network users. 
You have allocated a network folder to jamie as follows:

\\server\users\jamie

Now, you want to map X: drive of the machine to the network folder above so that whenever jamie logs on to one of the computers in the network he can access the network folder through X: drive. 
You can use the following script for the job:

Dim objNetwork
Set objNetwork = WScript.CreateObject("WScript.Network")
objNetwork.MapNetworkDrive "X:", "\\server\user\jamie"
 
Of course you can't test the above code on your computer unless you have a network folder "\\server\user\jamie". 
If you want to test the program now on your computer, follow the instructions <a title="http://compnetworking.about.com/cs/winxpnetworking/ht/findwinshares.htm" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://compnetworking.about.com/cs/winxpnetworking/ht/findwinshares.htm">here</a> to find a shared network folder provided that your computer is connected to a network (you can do this in a SCM lab). 

To disconnect a network drive, use the following code:

Dim objNetwork
Set objNetwork = WScript.CreateObject("WScript.Network")
objNetwork.RemoveNetworkDrive "X:"

See <a title="http://msdn.microsoft.com/en-us/library/s6wt333f(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/s6wt333f(VS.85).aspx">msdn online documents</a> for more details of the task. 

To check the information about all connected network drives, use the following code:

Dim objNetwork
Set objNetwork = WScript.CreateObject("WScript.Network")
Set objDrives = objNetwork.EnumNetworkDrives
For i =0 to objDrives.count - 1 Step 2
    WScript.echo objDrives.Item(i) &amp; ":" &amp; objDrives.Item(i+1)
Next
 
Map a network printer

Assume that you have two networked computers at home but have only one network-ready printer. 
If you want to share the printer between the two computers, the following script can help you to do this job:

 Dim objNetwork
Set objNetwork = WScript.CreateObject("WScript.Network")
objNetwork.AddWindowsPrinterConnection "\\server\\printerName"

Similarly, you can remove a network printer connection and list the information of all connected printers.

Get user's groups

Gaining group information is a bit harder because the same user can belong to different groups. 
The following code, <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__3_files/GetGroup.vbs" title="Lecture__3_files/GetGroup.vbs">GetGroup.vbs</a>, can list all the groups a user belongs to:

Set oNetwork = CreateObject("WScript.Network")
sDomain = oNetwork.UserDomain
sUser = oNetwork.UserName

Set oUser = GetObject("WinNT://" &amp; sDomain &amp; "/" &amp; sUser &amp; ",user")
For Each oGroup In oUser.Groups
MsgBox oGroup.Name
Next

GetObject is a built-in method of VBScript, which returns user a reference to an object, given the user domain and user name. 
The property Groups of the object contains all the roles of the user.

Get IP address

The following script can get IP address:

Set oWMI = GetObject("winmgmts:" &amp; "\\.\root\cimv2")

Set resultObj = oWMI.ExecQuery("select IPAddress from " &amp; _
 "Win32_NetworkAdapterConfiguration" &amp; " where IPEnabled = TRUE")

For Each IPAddress in resultObj
If IPAddress.IPAddress(0) &lt;&gt; "0.0.0.0" Then
myIP = IPAddress.IPAddress(0)
Exit For
End If
Next

MsgBox myIP

Note that we have used a WMI query to get the IP address (see Chapter 18). 
We will learn more about it later. 
The information we have collected is now enough for writing a simple logon script. 
Try to write your logon script now. 
Don't be shy away from searching on the Web.

 

 
<h3 id="VBLecturestopic-3">Lecture 4 Objects in VBScript</h3>

VBScript is a kind of Object-Oriented programming language. 
However, we do not write any class definition in VBScript. 
Instead, we use the objects that are provided by <a title="http://msdn.microsoft.com/en-us/library/a74hyyw0(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/a74hyyw0(VS.85).aspx">Windows Script Host Object Model</a>. 
In this lecture, we will discuss how to use these objects in a script. 

            
<pk>Key words</pk>

WSH, WSH Object, WSH Object Model

The WScript Object
WScript is the root object of the Windows Script Host (WSH). 
You can use all its properties and methods directly, for instance WScript.echo. 
 The WScript object allows you to:

 create objects via <a title="http://msdn.microsoft.com/en-us/library/xzysf6hc(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/xzysf6hc(VS.85).aspx">CreateObject Method</a>

 connect to objects via <a title="http://msdn.microsoft.com/en-us/library/ccxe1xe6(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/ccxe1xe6(VS.85).aspx">ConnectObject Method</a>

 disconnect from objects via  <a title="http://msdn.microsoft.com/en-us/library/2d26y0c1(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/2d26y0c1(VS.85).aspx">DisconnectObject Method</a>

 sync events via <a href="http://msdn.microsoft.com/en-us/library/6t81adfd(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/6t81adfd(VS.85).aspx">Sleep Method</a>

 stop a script's execution programmatically via <a href="http://msdn.microsoft.com/en-us/library/fw0fx1aw(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/fw0fx1aw(VS.85).aspx">Quit Method</a>

 output information to the default output device via  <a href="http://msdn.microsoft.com/en-us/library/h8f603s7(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/h8f603s7(VS.85).aspx">Echo Method</a>

Follow the above links to learn how to use these methods. 
We have known how to use WScript.echo for message output. 
We have also used CreateObject method to create WScript.network object in last lecture. 
Here is another example to use WScript object.

WScript.echo "Wait me for 5 minutes"
WScript.Sleep 300000
WScript.echo "I am ready now, let's go"
WScript.Quit

Copy and paste this code and run it on your computer.

The Shell Object

The Shell object is used to execute external applications, work with special folders and shortcuts, manipulate environment variables, write to the event log, read and write to the Registry, create timed dialog boxes, and even send keystrokes to another application. 

Just like the Network object, the Shell object must be explicitly created and assigned to a variable.

'Create shell object
Set objShell = CreateObject("WScript.Shell")

WSH Shell run method

WSH Shell is so powerful that it can do whatever you can do with command line. 
In fact, WSH Shell object allows you to execute applications within your script. 
There are two shell methods to execute applications: Exec and Run. 

Let's try the script <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___4_files/dirRun.vbs" title="Lecture___4_files/dirRun.vbs">dirRun.vbs</a> first:

Dim objShell
Set objShell = CreateObject("WScript.Shell")
objShell.Run "cmd /c dir &gt; test.txt" 

where ¡°cmd /c dir &gt; test.txt¡± is a command that lists the current directory and output the result to a text file (the option "/C" means "Carries out the command specified by string and then terminates").

The Run method can take two more parameters in addition to the specified command. 
The following code <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___4_files/runNotepad.vbs" title="Lecture___4_files/runNotepad.vbs">runNotepad.vbs</a> starts the notepad.exe program, and waits for you to complete and display a message: 

'Create shell object
Dim objShell
Set objShell = CreateObject("WScript.Shell")

'call Notepad program
objShell.Run "notepad.exe",1,true
MsgBox "I know what you wrote :-)"
 
Read <a href="http://msdn.microsoft.com/en-us/library/d5fk67ky(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/d5fk67ky(VS.85).aspx">Microsoft VBScript WSH reference</a> for more details. 

WSH Shell Exec method

The Exec method is more advanced. 
It returns a WSHScriptExec object, which wraps the standard stream objects stdIn, StdOut, and StdErr services. 
This enables the script to read the output directly from the application without first having to save the output to a file. 

The following script <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___4_files/execPing.vbs" title="Lecture___4_files/execPing.vbs">execPing.vbs</a> illustrates how to use Shell Exec method to check network using command line Ping:

WScript.Echo("Check Network using command line Ping")
Set objShell = CreateObject("WScript.Shell")
Set objWshScriptExec = objShell.Exec("cmd /c ping 127.0.0.1")

Set objStdOut = objWshScriptExec.StdOut
While Not objStdOut.AtEndOfStream
    strLine = objStdOut.ReadLine
    strOutput=strOutput &amp; strLine &amp; vbcrlf
Wend
WScript.Echo(strOutput)

In this code, the Exec method returns a WSHScriptExec object, named objWshScriptExec, which outputs the outcome of the command line to a standard stream object. 
The loop simply reads each line from the standard stream and puts it into a string. 
Note that vbcrlf is a VB constant for a new line (like \n in C++).

 
WSH Shell SendKeys method

You can use the SendKeys method to type keystrokes to applications that have no automation interface. 
Most keyboard characters are represented by a single keystroke. 
Some keyboard characters are made up of combinations of keystrokes (CTRL+SHIFT+HOME, for example). 
To send a single keyboard character, send the character itself as the string argument. 
For example, to send the letter x, send the string argument "x". 

Run the following script for fun:

Dim objShell
Set objShell = CreateObject("WScript.Shell")

objShell.Run "notepad.exe"
WScript.Sleep 5000
objShell.AppActivate "Notepad"
objShell.SendKeys "Ghost writing is fun."
 
Learn more about SendKeys method from <a href="http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx">Microsoft VBScript WSH reference</a>. 
Practice with this code <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___4_files/calculator.vbs" title="Lecture___4_files/calculator.vbs">calculator.vbs</a> 

Learn more about WSH Shell methods from <a href="http://msdn.microsoft.com/en-us/library/aew9yb99(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aew9yb99(VS.85).aspx">Microsft VBScrip WSH reference</a>.

The Shortcut object

Shortcut object allows you to create a shortcut programmatically. 
Learn how to use the object by using the following script <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___4_files/shortcut.vbs" title="Lecture___4_files/shortcut.vbs">shortcut.vbs</a>.

set WshShell = WScript.CreateObject("WScript.Shell")
strDesktop = WshShell.SpecialFolders("Desktop")

set oShellLink = WshShell.CreateShortcut(strDesktop &amp; "\IE.lnk")
with oShellLink
.TargetPath = "C:\Program Files\Internet Explorer\IEXPLORE.EXE"
.WindowStyle = 1
.Hotkey = "Ctrl+Alt+I"
    .IconLocation = "C:\Program Files\Internet Explorer\IEXPLORE.EXE, 0"
    .Description = "Internet Explorer"
.WorkingDirectory = strDesktop
.Save
end with

set oUrlLink = WshShell.CreateShortcut(strDesktop &amp; "\Script Programming.url")
oUrlLink.TargetPath = "http://www.scm.uws.edu.au/~jianhua/SAP10/"
oUrlLink.Save

The script firstly creates a WSH Shell object and calls its method SpecialFolders to get the actual path of your Desktop folder (different user has difference path). 
The second part creates a shortcut for Internet Explorer and puts it on your Desktop. 
The third part of the code creates a shortcut for the unit webpage of Systems Administration Programming.

Summary

In this lecture, we learnt how to use WSH built-in objects, such as WScript, Shell and Shortcut. 
In fact, the Windows Script Host object model provides a logical, systematic way to perform many administrative tasks. 
The following is the hierarchy of WSH objects:

Learn more about WSH objects from <a href="http://msdn.microsoft.com/en-us/library/a74hyyw0(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/a74hyyw0(VS.85).aspx">Microsoft website</a>. 
Microsoft's Philosophy: Create a minimal core WSH structure that can interact with any number of separate object models for extention. 
For instance, Windows Management Instrumentation (WMI, See Lecture 5), the FileSystemObject (FSO, See Lecture 6), Active Directory Service Interfaces (ADSI, See Lecture 7), Collaboration Data Objects (CDO, See Lecture 8) object models are separate from the WSH object model (i.e. 
WMI, FSO, ADSI, and CDO are not built in WSH).

What's the time now? Have a kit-kat. 
...

<a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___4_files/Lecture 4 VBScript Objects.pdf" title="Lecture___4_files/Lecture 4 VBScript Objects.pdf">Pring page</a>

<h3 id="VBLecturestopic-4">Lecture 5 Getting access to remote machines</h3>
(WMI Basics)

In this lecture, we learn how to get access to remote computers via WMI in order to remotely control a network computer. 
Nowadays, computer security has become extremely complicated. 
The way to access a remote computer depends heavily on the security settings and the Internet settings of both computers. 
Therefore, you should not expect that all the code listed in this lecture can be run straight away on your computer. 
You have to try your luck and set up your network and computers properly before you test the scripts.
            
<pk>Key words</pk>

Windows Management, WMI (Windows Management Instrumentation), WMI class, WMI service, WMI query, WMI Scripting Library, CIM (Common Information Model), CIM Repository, Namespace, WBEM (Web-Based Enterprise Management), Security Settings, Internet/Network Settings

Shutting down remote computers: an introductory script

Dim sMachine
sMachine = InputBox("Shut down which computer?")

Dim sWMI
sWMI = "SELECT * FROM Win32_OperatingSystem WHERE Primary = true"

Dim oOS
Set oOS = GetObject("winmgmts://" &amp; sMachine &amp; "/root/cimv2").ExecQuery(sWMI)

Dim oItem 
For Each oItem in oOS
oItem.Shutdown
Next

In the above script, the first two statements are used to input the name of a remote computer. 
<a title="http://msdn.microsoft.com/en-us/library/aa394239(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa394239(VS.85).aspx">Win32_OperatingSystem</a><u+2002>is a WMI class, containing the information about the Windows operating systems installed on that computer. 
The string, sWMI, defines a WMI query to get all instances of Win32_OperatingSystem that are the primary operating system on the remote machine. 
Cimv2 is a namespace under the root of the computer (root\cimv2 namespace) that contains all of the Win32 classes, including the Win32_OperatingSystem class. 
The third group of statements executes the WMI query. 
Finally, the script shutting down all Windows operating systems that are running on the computer (the existing windows systems up to date can only allow one primary windows operating system running at the same time but Microsoft leaves the possibility for the future that more than one windows operating systems can be run at the same time). 

With similar code, we can also reboot, logoff, or power off a remote computer by changing the statement: oItem.Shutdown. 
See more details from <a title="http://msdn.microsoft.com/en-us/library/aa394058(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa394058(VS.85).aspx">Win32Shutdown Method of the Win32_OperatingSystem Class</a>.

What is WMI?

The above script actually uses windows WMI services. 
<a title="http://msdn.microsoft.com/en-us/library/aa394582.aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa394582.aspx">Windows Management Instrumentation</a> (WMI) is the primary infrastructure for management data and operations on Windows operating systems. 
We can utilize the facilities of WMI to write scripts for administrative tasks on local but mainly remote computers. 
WMI also supplies management data to other parts of the operating system and products, for example, System Center Operations Manager, formerly Microsoft Operations Manager (MOM), or Windows Remote Management. 
WMI enables consistent and uniform management, control, and monitoring of systems throughout your enterprise. 
It allows system administrators to query, change, and monitor configuration settings on desktop and server systems, applications, networks, and other enterprise components. 
System administrators can write scripts that use the WMI Scripting Library to work with WMI and create a wide range of systems management and monitoring scripts.

Connecting to WMI on a Remote Computer

You might consider that remotely controlling a computer is not that hard once we have the above script. 
But in reality, the remote access is not straight forward. 
If you don't believe that, download the code <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___5_files/shutdown.vbs" title="Lecture___5_files/shutdown.vbs">shutdown.vbs</a> and run it. 

Unless you leave your firewall open you will encounter problems when trying to run the script. 
A large amount of work on security setting is needed. 

Assume that you are working on Computer A and you are going to remotely control Computer B.

There are a few necessary conditions:

1. You have an account on Computer B which is in the Administrator group.
2. The password  of your account on Computer A is not blank.
3. Both Computer A and Computer B must be running IPv6 if the computer is running under Vista. 
Either computer may be running IPv4.

For more details of how to set up the computers, see <a href="http://msdn.microsoft.com/en-us/library/aa389290(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aa389290(VS.85).aspx">Connecting to WMI on a Remote Computer</a>.

Understanding WMI

You can check whether the WMI setting works on a computer by running the following program (WbemTest) in the command line:

    wbemtest

You will see a window called Windows Management Instrumentation Tester. 
The eBook Chapter 3 shows you all the details of this tool. 
Try first to connect to the remote computer you set. 
If no luck, you can connect to the local WMI to learn more about WMI. 
Suppose that you have successfully connected to a WMI (either remotely or locally). 
WMI contains large groups of classes in different hierarchy, dealing with:
 Computer System Hardware

 Operating System

 Installed Applications

 WMI Service Management

 Performance Counter

The most useful classes are Win32_OperatingSystem, Win32_LogicalDisk, Win32_NetworkAdapterConfiguration and so on. 

<a title="http://msdn.microsoft.com/en-us/library/aa394572(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa394572(VS.85).aspx">WMI Reference</a> gives a complete list of all <a href="http://msdn.microsoft.com/en-us/library/aa394554(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aa394554(VS.85).aspx">WMI classes</a>. 
There are more than 100 WMI classes and may be more in the upgraded windows versions. 
WbemTest can show your all the instances of these classes that are running on the computer to which you have connected (the remote computer or local machine). 
More importantly, you can retrieve data from these running objects by using a SQL-like query language - WMI Query Language (WQL). 
For instance, to get information about the Windows operating systems that are running on the machine, you can make the the following query in the query menu (click "query button"):

 SELECT * FROM Win32_OperatingSystem WHERE Primary = true

You will likely see the following outcome or something similar:

 Win32_OperatingSystem.Name="Microsoft Windows XP Professional|C:\\WINDOWS|\\Device\\Harddisk0\\Partition1" 

You may also remember how we get the IP address (See Lecture 3): 

 SELECT IPAddress FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled = TRUE"

Learn more on WQL from <a href="http://msdn.microsoft.com/en-us/library/aa392902(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aa392902(VS.85).aspx">http://msdn.microsoft.com/en-us/library/aa392902(VS.85).aspx</a>.

Write WMI Scripts

If the connection is ok, you can write your WMI script for any remote tasks.

First, let¡¯s get the other computer¡¯s IP address and MAC address with the <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___5_files/checkIPnMAC.vbs" title="Lecture___5_files/checkIPnMAC.vbs">checkIPnMAC.vbs</a>:

Dim computer_B
Dim objWMIService
Dim colItems

'the remote computer's name, here means local 
computer_B = "."

Set objWMIService = getObject("winmgmts://" &amp; _
computer_B &amp; "\root\cimv2")

Set colItems = objWMIService.ExecQuery( _
"SELECT * FROM Win32_NetworkAdapterConfiguration", , 48)

For Each objItem in colItems
WScript.Echo "IP Address: " &amp; objItem.IPAddress(0)
WScript.Echo "MAC Adress: " &amp; objItem.MACAddress

Next

You can use this code as a template to perform more complicated tasks. 
Most WMI scripts follow a simple three-step pattern. 
In general, WMI scripts:

1. Connect to the WMI service.
2. Retrieve a WMI object or collection of objects.
3. Perform some sort of task on the object or objects.

How do you feel - comfortable or had a headache? I suggest you search on the Web using the key words provided here for an in-depth understanding, for instance, <a href="http://msdn.microsoft.com/en-us/library/aa394553(VS.85).aspx">WMI Architecture</a>. 
Of course, have a break first:) 

<h3 id="VBLecturestopic-5">Lecture 6 Manage Folders/Files Using FSO </h3>

Welcome to our Lecture 6:) 
            

When writing scripts for Windows Script Host, Active Server Pages, or other applications where scripting can be used, it often requires to operate folders/files, such as adding, moving, changing, creating, or deleting folders and files. 
In this lecture, we will learn how to use the FileSystemObject (FSO) Library to operate drives, folders and files. 

            
<pk>Key words</pk>

FSO (FileSystemObject), FSO library, Scripting Runtime Library, WBEM (Web-Based Enterprise Management), File System, Folder Manipulation, File Manipulation

The FileSystemObject Library

FSO library contains a set of objects for variety of file operations, which allows you to create, delete, gain information about, and generally manipulate drives, folders, and files. 
Before we get into any details, let's practise the following script <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__6_files/createFile.vbs" title="Lecture__6_files/createFile.vbs">createFile.vbs</a>. 

Dim oFSO
Set oFSO = CreateObject("Scripting.FileSystemObject")
Set a = oFSO.CreateTextFile("c:\\testfile.txt", true)
a.WriteLine "This is a test."
a.Close

The code simply creates a text file and writes a message to the file. 
 In general, to program with the FileSystemObject (FSO) object library, we need to consider the following three scripting steps:

<u+2734> use the CreateObject method to create a FileSystemObject object

<u+2734> use the appropriate method on the newly created object

<u+2734> access the object's properties. 

To create a FileSystemObject object, simply use the following statement.
    CreateObject("Scripting.FileSystemObject")

Note that you need to use Set to assign the object to a variable. 
Once you get the object, you can use the following method to create text files, create folders, delete files, and delete folders:

<u+2734> CreateTextFile, CreateFolder

<u+2734> GetFile, GetFolder, GetDrive

<u+2734> MoveFile, MoveFolder

<u+2734> CopyFile, CopyFolder

<u+2734> DeleteFile, DeleteFolder

See <a title="http://msdn.microsoft.com/en-us/library/ch28h2s7(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/ch28h2s7(VS.85).aspx">Working with Drives and Folders</a> from Micrisoft Developer Network for the details of how to use these methods. 
See <a title="http://msdn.microsoft.com/en-us/library/6tkce7xa(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/6tkce7xa(VS.85).aspx">FileSystemObject Methods</a> for a full list of the methods.

Operating Drives

The following code shows you how to get drive information programmatically:

Dim oFSO, oDrive
Set oFSO = WScript.CreateObject("Scripting.FileSystemObject")
For Each oDrive In oFSO.Drives
    IF oDrive.isReady THEN
         MsgBox "Drive " &amp; oDrive.DriveLetter &amp; _
         " has a capacity of " &amp; oDrive.TotalSize &amp; " bytes " &amp; _
         " and is drive type " &amp; oDrive.DriveType
    END IF
Next

Note that oFSO.Drives  contains all the drive objects mounted by the operating system that is running. 
Drive objects represent the logical drives attached to your system, including network drives, CD-ROM drives, and so forth. 
Therefore they can be many.

Each drive object contains the following data members:

 AvailableSpace 

 DriveLetter

 DriveType

 FileSystem

 FreeSpace

 IsReady

 Path

 RootFolder

 SerialNumber

 ShareName

 TotalSize

 VolumeName  

The following code shows you how to operate a particular drive by providing a drive path drvPath. 
      Dim fso, d, s, drvPath
   'give your drive path
   drvPath = ??? 
   Set fso = CreateObject("Scripting.FileSystemObject")
   Set d = fso.GetDrive(fso.GetDriveName(drvPath))
   s = "Drive " &amp; UCase(drvPath) &amp; " - " 
   s = s &amp; d.VolumeName   &amp; 
   s = s &amp; "Free Space: " &amp; FormatNumber(d.FreeSpace/1024, 0) 
   s = s &amp; " Kbytes"
   MsgBox s

Drives also provide an entry point into each drive's file system, starting with the root folder of the file system hierarchy. 
Because the Drive object represents one of the simplest aspects of the file system, it's one of the simplest objects in the FSO.

Operating Folders

FSO offers more methods to the Folder object for manipulating folders than the Drive object:

  CopyFolder: copies a folder.

  CreateFolder: creates a new folder.

  DeleteFolder: removes a folder permanently. 
Note that the deleted folder doesn't ever make it to the Recycle Bin, and there's no "Are you sure?" prompt.

  FolderExists:, like DriveExists, returns a True or False indicating whether the specified folder exists.

  GetFolder: accepts a complete folder path and, if the folder exists, returns a Folder object that represents the folder.

  GetParentFolderName: accepts a complete folder path and returns the name of its parent folder. 

  GetSpecialFolder: returns the complete path to special operating system folders. 

  MoveFolder: moves a file a folder.

Download the program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__6_files/FolderOperation.vbs" title="Lecture__6_files/FolderOperation.vbs">FolderOperation.vbs</a> to practice.

Similar to drive objects, once you call GetFolder method of FSO, you get a folder object. 
Each folder object have the following methods:

  Copy

  Delete

  Move

  CreateTextFile

Using these methods is straightforward. 

You can also use FSO to retrieve attribute information about folders. 

Operating Files:

File operation is also similar. 
Download the program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__6_files/fileOperatrion.vbs" title="Lecture__6_files/fileOperatrion.vbs">fileOperatrion.vbs</a> to practice. 
Note that a file object contains the following properties:

Attributes

DateCreated

DateLastAccessed

DateLastModified

Drive

Name

ParentFolder

Path

ShortName

Size

Type

Surprisingly, not only can you get the information about a file's or folder's attributes but also change these attributes.

Dim fso, f1, f2, s
Set fso = CreateObject("Scripting.FileSystemObject")
Set f = fso.GetFile("c:\test.txt")
f.attributes = 1

This code changes the attribute of C:\test.txt to read-only. 
See <a href="http://msdn.microsoft.com/en-us/library/5tx15443(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/5tx15443(VS.85).aspx">Attributes Property</a> for the meaning of the attribute values.

Microsoft provides a comprehensive example code <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__6_files/FileOperationCollection.vbs" title="Lecture__6_files/FileOperationCollection.vbs">FileOperationCollection.vbs</a> which can be run directly. 
It is very useful. 
We will practice it in the practical tasks. 

At the end, I'd like to remind you again of Microsoft's Philosophy: Create a minimal core WSH structure that can interact with any number of separate object models for extention. 
For instance, Windows Management Instrumentation (WMI, See Lecture 5), the FileSystemObject (FSO, See Lecture 6), Active Directory Service Interfaces (ADSI, See Lecture 7), Collaboration Data Objects (CDO, See Lecture 8) object models are separate from the WSH object model (i.e. 
WMI, FSO, ADSI, and CDO are not built in WSH).

<h3 id="VBLecturestopic-6">Lecture 7 Working with ADSI</h3>

Welcome to Lecture 7.

Domain, group and user maintenance is probably one of the top administrative tasks that we want to automate. 

Administering a directory service often involves numerous repetitive tasks such as creating, deleting, and modifying users, groups, organizational units, computers, and other directory resources. 
Performing these steps manually by using graphical user interface (GUI) tools is time-consuming, tedious, and error prone. 
Active Directory Service Interfaces (ADSI) is the technology that allows you to create custom scripts to automate such repetitive tasks. 
In this lecture we will learn how to manipulate domains, groups and users via ADSI. 
  
            
Unfortunately if you do not have a network or system administrative role on the computer or network you are using, you will be unable to perform all the tasks we discuss in this lecture. 
However, all the programs provided in this lecture can be run with an Administrator user account, therefore you should be able to run them at home. 
 
            
<pk>Key words</pk>

Directory Service, ADSI (Active Directory Service Interfaces), Network Resources, Distributed Computing, Domain, Group, User Manipulation, Domain Name, Domain Object, Domain Component, Group Name, Group Object, User Name, User Object, Organization Unit, Common Name, Administrative Role 

Active Directory Services Interface (ADSI): basic concepts

Active Directory (AD) is a <a title="http://msdn.microsoft.com/en-us/library/ms682458(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/ms682458(VS.85).aspx">directory service</a> used to store information about the network resources across a domain and user information on the local computer. 
Microsoft provides many tools to enumerate, diagnose, and manage AD, and more and more commercial tools are also available. 
ADSI is one of the most useful tools.

Similar to WMI, <a href="http://msdn.microsoft.com/en-us/library/aa772161(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aa772161(VS.85).aspx">Active Directory Service Interfaces</a> (ADSI) is an object library. 
It can be used in a distributed computing environment for managing network resources from different network providers. 
Administrators and developers can use ADSI services to enumerate and manage the resources in a directory service, no matter which network environment contains the resource. 

The tasks that ADSI can perform: 

 creating, deleting, and modifying users, groups, organizational units, computers;

 managing printers, and 

 locating resources in a distributed computing environment. 

Like WMI, you can write ADSI client applications in many languages, such as Visual Basic, C++, JScript, VBScript.

Note that Active Directory runs on Windows Server 2008, Microsoft Windows Server 2003, and Windows 2000 Server domain controllers. 
Only client applications using ADSI may run on Windows Vista, Windows XP, Windows 2000, Windows NT 4.0.

ADSI providers

ADSI provides a well-defined set of objects, methods, and properties to interact with supported directories. 
Abstracted access to an independent directory resource is via an ADSI provider. 
Surprisingly, we can use <a href="http://msdn.microsoft.com/en-us/library/aa772235(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aa772235(VS.85).aspx">several ADSI service providers</a> to access same information. 
The commonly used ADSI providers are WinNT, LDAP, NDS, and NWCOMPAT. 
In this lecture, we mainly discuss the use of the <font color="#FF0000">WinNT</font> provider.

The <a title="http://msdn.microsoft.com/en-us/library/aa772237(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa772237(VS.85).aspx">WinNT provider</a> can connect to any NT-compatible domain, therefore can be used in any Windows NT compatible operating systems, such as Windows 2000 or above. 
The following code is a typical ADSI program using WinNT provider. 

Remember that we ever use WinNT ADSI in lecture three:

Set oNetwork = CreateObject("WScript.Network")
sDomain = oNetwork.UserDomain
sUser = oNetwork.UserName

Set oUser = GetObject("WinNT://" &amp; sDomain &amp; "/" &amp; sUser &amp; ",user")
For Each oGroup In oUser.Groups
MsgBox oGroup.Name
Next

The fourth line of the code gets an ADSI object from WinNT with specified a <a title="http://msdn.microsoft.com/en-us/library/aa746534(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa746534(VS.85).aspx">WinNT ADsPath</a>. 
This object contains the information of the user who's currently logging in. 

In general, in order to get a WinNT provided ADSI object, you have to specify a WinNT ADsParh. 
The syntax of WinNT ADsPath is the following:

WinNT:
WinNT://&lt;domain name&gt;
WinNT://&lt;domain name&gt;/&lt;server&gt;
WinNT://&lt;domain name&gt;/&lt;object path&gt;
WinNT://&lt;domain name&gt;/&lt;object name&gt;
WinNT://&lt;domain name&gt;/&lt;object name&gt;,&lt;object class&gt;
WinNT://&lt;server&gt;
WinNT://&lt;server&gt;/&lt;object name&gt;
WinNT://&lt;server&gt;/&lt;object name&gt;,&lt;object class&gt;

The domain name can be either a NETBIOS name or a DNS name, which can be retrieved through WScript.Network object. 
The server is the name of a specific server within the domain. 
The object path is the path of an object, such as "printserver1/printer2". 
The object name is the name of a specific object. 
The object class is the class name of the named object. 
The information about an object can also be retrieved through WScript.Network object. 
With my computer, for the user object of my account, the ADsPath will be "WinNT://jamie-win/jamie,user", where "jamie-win" is the domain name and "jamie" is the object name and "user" is the specified class.

Another more commonly used but more complicated ADSI provider is <a href="http://msdn.microsoft.com/en-us/library/aa772203(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aa772203(VS.85).aspx">LDAP Provider</a>. 
LDAP stands for Lightweight Directory Access Protocol. 
 The LDAP provider implements a set of ADSI objects that support various ADSI interfaces, therefore it can work with any LDAP compatible directory, not just Active Directory.

Similar to WinNT ADSI provider, to access an ADSI LDAP object, we need to specify a <a href="http://msdn.microsoft.com/en-us/library/aa746384(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aa746384(VS.85).aspx">LDAP ADsPath</a>. 
The syntax is slightly different from the one for WinNT ADsPath.

' Bind to the root of the LDAP namespace.
LDAP:                                                                                            
' Bind to a specific server.
LDAP://server01
' Bind to a specific server using the specified port number. 
                                                                          
LDAP://server01:390                                                                           
' Bind to a specific object.
LDAP://CN=Jeff Smith,CN=users,DC=fabrikam,DC=com                
' Bind to a specific object through a specific server.
LDAP://server01/CN=Jeff Smith,CN=users,DC=fabrikam,DC=com

We have to follow the following conventions when we specify a LDAP ADsPath:

Use DC when specifying any portion of a domain name. 
Always list the domain name components in their regular order. 
For example, a domain named scm.uws.edu.au would have an LDAP path of "dc=scm,dc=uws,dc=edu,dc=au". 
DC stands for "Domain Component".

Use OU when specifying an "Organizational Unit". 

Use CN when specifying a "Common Name", such as a user, group, or any of the built-in AD containers. 

With the ADSI LDAP provider, you can only create a global user account. 
Local accounts reside in the SAM database and must be created using the WinNT provider. 
Since I don't have a network administrative credentials in my office network, I can't create a global user. 
Therefore I can't run any LDAP query in my computer. 
If you have a network environment at home, please try the code listed in the textbook Chapter 15.

Manipulating domains

If you have administrative credentials of your network, you can access and change the setting of the network domain. 
To query domain information by using the WinNT provider, simply do the following (specifying your domain name; the domain name can be retrieved through WScript.Network object):

Dim objDomain
Set objDomain = GetObject("WinNT://MyDomain")

Then you can get the information about your domain by using get method. 
For instance,

objDomain.Get("MinPasswordAge")

will give you the minimum number of days a user must keep this password. 

To set this this property, simply do something like this:

objDomain.put("MinPasswordAge", 10)

The properties of a domain you can operate by using the WinNT provider are:
  

MinPasswordLength

MinPasswordAge

MaxPasswordAge

MaxBadPasswordsAllowed

PasswordHistoryLength

AutoUnlockInterval

LockoutObservationInterval

See <a title="http://msdn.microsoft.com/en-us/library/aa746539(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa746539(VS.85).aspx">WinNT Schema's Mandatory and Optional Properties</a> from Microsoft.

For settings of Organization Units, please refer to the textbook pages 260-263.

Manipulating users and groups

To manipulate users and groups, we first get an domain object as we did above (objDomain). 
Then you can call Create method to create a new user or group:

Set oNetwork = WScript.CreateObject("WScript.Network")
sDomain = oNetwork.UserDomain
sUser = oNetwork.UserName
msgbox "User domain: " &amp; sDomain &amp; "   User name:  " &amp; sUser
Set oDomain = GetObject("WinNT://" &amp; sDomain)

Set oUser = oDomain.Create("user", "Daniel")
oUser.Description = "Test user"

Set oGroup = oDomain.Create("group", "TestGroup")
oGroup.Description = "Test group"

oUser.SetInfo
oGroup.SetInfo

oUser.GetInfo
oGroup.GetInfo

WScript.echo "User name: " &amp; oUser.Name
WScript.echo "User description: " &amp; oUser.Description

WScript.echo "Group name: " &amp; oGroup.Name
WScript.echo "Group description: " &amp; oGroup.Description

This code (<a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__7_files/CreateUserGroup.vbs" title="Lecture__7_files/CreateUserGroup.vbs">CreateUserGroup.vbs</a>) can explain itself. 
It creates a new user "Daniel", a new group "TestGroup" and display the related information. 
You might be curious about the methods GetInfo and SetInfo. 
GetInfo method is used to load into the cache of ADSI object properties from the underlying directory store. 
SetInfo method saves the cached property values of the ADSI objects to the underlying directory store. 
Note that any property value changes made by Create or Put methods will be lost if GetInfo (or GetInfoEx) is invoked before SetInfo is called.

If you have an administrative role in a Windows system, you can test the program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__7_files/CreateUserGroup_1.vbs" title="Lecture__7_files/CreateUserGroup_1.vbs">CreateUserGroup.vbs</a> without needing any change.

If a user name or a group name already exist, you can create a user object or a group object from their names by calling GetObject method:

Set oNetwork = WScript.CreateObject("WScript.Network")
sDomain = oNetwork.UserDomain
Set oDomain = GetObject("WinNT://" &amp; sDomain)
Set oUser1 = GetObject("WinNT://" &amp; sDomain &amp; "/Daniel,user")
WScript.echo oUser1.Description
Set oGroup1 = GetObject("WinNT://" &amp; sDomain &amp; "/TestGroup,group")
WScript.echo oGroup1.Description

The above code (<a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__7_files/UserGroupMore.vbs" title="Lecture__7_files/UserGroupMore.vbs">UserGroupMore.vbs</a>) must be run after <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__7_files/CreateUserGroup_2.vbs" title="Lecture__7_files/CreateUserGroup_2.vbs">CreateUserGroup.vbs</a> has been run. 
The following code (<a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture__7_files/SetPassword.vbs" title="Lecture__7_files/SetPassword.vbs">SetPassword.vbs</a>) demonstrates how to change password programmatically:

Set oNetwork = WScript.CreateObject("WScript.Network")
sDomain = oNetwork.UserDomain
Set oDomain = GetObject("WinNT://" &amp; sDomain)
Set oUser = GetObject("WinNT://" &amp; sDomain &amp; "/Daniel,user")
oUser.SetPassword "12345"
oUser.SetInfo
WScript.echo "Password changed"

For more information for user and group manipulation, read Microsoft references  <a title="http://msdn.microsoft.com/en-us/library/aa746340(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa746340(VS.85).aspx">IADsUser Interface</a>, <a title="http://msdn.microsoft.com/en-us/library/aa706021(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa706021(VS.85).aspx">IADsGroup Interface</a> or more generally <a title="http://msdn.microsoft.com/en-us/library/aa772211(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa772211(VS.85).aspx">ADSI Objects of WinNT</a>. 
Microsoft also provides a few examples for <a href="http://msdn.microsoft.com/en-us/library/aa746540(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/aa746540(VS.85).aspx">User Account Management</a>. 
Please read these examples carefully because a few quiz questions might be based on some of the examples. 

All in all, Active Directory Service is a complicated and powerful facility. 
It takes a while to get familiar with its internal structure and usage. 
Hope you had an easy time. 

<h3 id="VBLecturestopic-7">Lecture 8 E-Mail Automation</h3>

In the previous lectures, we have learnt the basic language components of VBScript and the key scripting technologies for Windows. 
In this and the next lectures we apply the scripting technologies to extended Windows system administration. 

Nowadays almost all of us send emails using email softwares, such as Office Outlook, Thunderbird, Pine, Webmail and etc. 
These popular email softwares have to be used manually. 
Assume that we are going to send monthly bills to thousands of our customers via emails. 
Most email softwares cannot do the job efficiently. 
In this lecture, we introduce the techniques for generating and delivering emails automatically. 

            
<pk>Key words</pk>

CDO (Collaboration Data Objects), SMTP (Simple Mail Transfer Protocol), Local SMTP Server, Remote SMTP Server, TCP/IP, Port Number

The email automation is not covered by the textbook. 
Part of the materials of this lecture were taken from Jeff Fellinge's book "IT Administrator's Top 10 Introductory Scripts for Windows" and Paul Sadowski's website "<a title="http://www.paulsadowski.com/WSH/cdo.htm" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://www.paulsadowski.com/WSH/cdo.htm">http://www.paulsadowski.com/</a>" (unformtunately the link is no longer active). 
However, you can find plenty of related scripts from the Internet. 

Email scripts

If you have installed SMTP service on your computer, sending an email programmatically is extremely easy:

Set objMsg = CreateObject("CDO.Message")
objMsg.Subject = "subject of the message here"
objMsg.From = "your email address here"
objMsg.To = "addressee's email address here"
objMsg.TextBody = "the message text here"
objMsg.Send

Download the code <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___8_files/mail1.vbs" title="Lecture___8_files/mail1.vbs">mail1.vbs</a> and try to run it. 
If it is not runnable, most likely you do not have a local SMTP or it has not been configured properly (See <a href="http://msdn.microsoft.com/en-us/library/8b83ac7t.aspx" title="http://msdn.microsoft.com/en-us/library/8b83ac7t.aspx">How to install and Configure SMTP Virtual Servers </a>). 
In such a case, the best way to go is specify a remote SMTP server to deliver your message (say the school email server). 
Try the following script <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___8_files/mail2.vbs" title="Lecture___8_files/mail2.vbs">mail2.vbs</a>:

Dim objMsg, objConfiguration, objConfigFields
Set objConfiguration = CreateObject("CDO.Configuration")
Set objConfigFields = objConfiguration.Fields

objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/sendusing") = 2
objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/smtpserverport") = 25
'replace the SMPT server address with your SMTP address
objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/smtpserver") = "mail.westernsydney.edu.au"
'or try SCEM's remote SMTP server "mail.scem.westernsydney.edu.au"
objConfigFields.Update

Set objMsg = CreateObject("CDO.Message")
objMsg.Configuration = objConfiguration
objMsg.Subject = "subject of the message here"
objMsg.From = "your email address here"
objMsg.To = "addressee's email address here"
objMsg.TextBody = "the message text here"
objMsg.Send

Note that if you use WSU' or SCEM's remote SMTP server, your computer needs to be connected to the school network (you can use vpn if you are working at home).

Simple Mail Transfer Protocol (SMTP) and Collaboration Data Objects (CDO)

There are two basic concepts that are crucial for the understanding of the above code: CDO and SMTP. 

  
Firstly, let's see how an email message is delivered. 
Typically an email message is delivered across the Internet under the Simple Mail Transfer Protocol (SMTP). 
Delivery of a message is initiated by transferring the message to a designated SMTP server. 
Based on the domain name of the recipient e-mail address, the SMTP server initiates communications with a Domain Name System (DNS) server, which looks up and then returns the host name of the destination SMTP server for that domain.

The originating SMTP server communicates with the destination SMTP server directly through Transmission Control Protocol/Internet Protocol (TCP/IP) on port 25. 
If the user name of the recipient e-mail address matches one of the authorized user accounts on the destination server, the original e-mail message is transferred to that server, waiting for the recipient to pick up the message through a client program.

In the case where the originating SMTP server cannot communicate directly with the destination server, the SMTP service can transfer messages through one or more intermediate relay SMTP servers. 
A relay server receives the original message and then delivers it to the destination server, or redirects it to another relay server. 
This process is repeated until the message is delivered or a designated timeout period passes.

Next, let's see how to compose an email message. 
An email message consists of the following components:

To:  receiver's email address.

From: sender's email address

Subject: a brief description of the message

Cc: carbon copy

Bcc: blind carbon copy

Attachments: attached files

In the example code above, we use Microsoft <a title="http://msdn.microsoft.com/en-us/library/dd717119.aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/dd717119.aspx" style="line-height: 14px; ">Collaboration Data Objects (CDO)</a> to create an email message and specify a SMTP service. 
Collaboration Data Objects are a high-level set of COM objects that allow, among other functionalities, easily access of the email system embedded in the Microsoft Windows products.

CDO Configuration

In order to use CDO to send a message, we first need to create a CDO configuration object: 

Set objConfiguration = CreateObject("CDO.Configuration")

A CDO Configuration object contains information such as the method used to deliver messages, the paths to the pickup directories for SMTP and Network News Transfer Protocol (NNTP) servers, a user's mailbox Uniform Resource Identifier (URI), and so forth. 
The following setting specifies the SMTP server we are going to use for sending our message: 

[Take a break ...] 

Set objConfigFields = objConfiguration.Fields
objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/sendusing") = 2
objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/smtpserverport") = 25
'replace the SMPT server address with your SMTP address
objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/smtpserver") = "mail.westernsydney.edu.au"
'or try SCEM's remote SMTP server "mail.scem.westernsydney.edu.au"
objConfigFields.Update

The three configuration fields that this script uses are sendusing, smtpserverport, and smtpserver. 
The configuration field sendusing instructs CDO whether to send the message using the <font color="#FF0000">local SMTP</font> service (sendusing = 1), send to a <font color="#FF0000">remote SMTP</font> (sendusing = 2) or send using an Exchange Server mail submission URI (sendusing =3). 

The field smtpserverport specifies the SMTP port to use, which is 25, by default. 
If your remote SMTP server listens on a different port, you can configure CDO to send to that port instead.

The last configuration field specifies the SMTP server. 
You should fill in the name of the SMTP server you are going to use to send messages. 
If you run your program in a SCEM lab, you could use the school email server mail.scem.westernsydney.edu.au. 
This may not work at ITD computer labs, where you should be able to use mail.westernsydney.edu.au. 

Lastly, we must update the configuration by calling the Update method. 

More and more administrators are restricting access to their servers to control spam or limit which users may utilize the server. 
Adding the following lines to the Mail.vbs if your SMTP server uses the basic authentication, the most commonly used authentication method.

'Type of authentication, NONE, Basic (Base64 encoded), NTLM
objconfigFileds.Item("<a href="http://schemas.microsoft.com/cdo/configuration/smtpauthenticate" title="http://schemas.microsoft.com/cdo/configuration/smtpauthenticate">http://schemas.microsoft.com/cdo/configuration/smtpauthenticate</a>") = cdoBasic

'Your UserID on the SMTP server
objconfigFileds.Item("<a href="http://schemas.microsoft.com/cdo/configuration/sendusername" title="http://schemas.microsoft.com/cdo/configuration/sendusername">http://schemas.microsoft.com/cdo/configuration/sendusername</a>") = "youruserid"

'Your password on the SMTP server
objconfigFileds.Item("<a href="http://schemas.microsoft.com/cdo/configuration/sendpassword" title="http://schemas.microsoft.com/cdo/configuration/sendpassword">http://schemas.microsoft.com/cdo/configuration/sendpassword</a>") = "yourpassword"

'Use SSL for the connection (False or True)
objconfigFileds.Item("<a href="http://schemas.microsoft.com/cdo/configuration/smtpusessl" title="http://schemas.microsoft.com/cdo/configuration/smtpusessl">http://schemas.microsoft.com/cdo/configuration/smtpusessl</a>") = False

For a full list of the CDO configuration fields, please visit <a title="http://msdn.microsoft.com/en-us/library/aa493877.aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa493877.aspx">CDO Messaging Configuration</a>. 
Note that if you do not set a CDO configuration, then CDO sets one for you prior to sending out each message using the default values. 

Creating an email message

To create an email message, we first create an CDO message object:

Set objMessage = CreateObject("CDO.Message")

Secondly, we set this message to use the above setting of CDO configuration to send:

objMsg.Configuration = objConfiguration

Next, we fill-in Sender, Subject and Recipient fields of the headers and the body text which can be either plain text or HTML. 

objMsg.Subject = "subject of the message here"
objMsg.From = "your email address here"
objMsg.To = "addressee's email address here"
objMsg.TextBody = "the message text here"

Finally, you use the Send method to send the message.

objMsg.Send

Manipulating files with an email

You might like to edit an email message body in a separate file. 
The following function can be used to load a text file to an email message:

function ReadTextFile(strFileName)
 Dim objFSO, objTextFile, strReadLine
 Set objFSO = CreateObject("Scripting.FileSystemObject")
 Set objTextFile = objFSO.OpenTextFile(strFileName,1)
 do while not objTextFile.AtEndOfStream 
  strReadLine = strReadLine + objTextFile.ReadLine()
 loop
 objTextFile.Close()

 ReadTextFile = strReadLine
end function 

You can attach files to an email message as email attachments. 
See the code for a comprehensive example <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___8_files/Mail.vbs" title="Lecture___8_files/Mail.vbs" style="line-height: 14px; ">Mail.vbs</a>. 
Please note, when using the AddAttachment method in your scripts you must use a fully qualified pathname as the argument to the method. 
Using just a file name or a relative path will produce the error " The specified protocol is unknown".

If you want to send a message to a large group of persons, say sending an announcement, you can put all the receivers' addresses in a text file and load them to the email message you want to send by using a similar function as above. 
Even more, you can connect to a database to collect information from the database, generate email messages and send them automatically. 

<!-- Paul Sadowski's website "<a href="http://www.paulsadowski.com/WSH/cdo.htm" title="http://www.paulsadowski.com/WSH/cdo.htm">http://www.paulsadowski.com</a>/" lists a set of sample code to show how to do this. 

-->

<h3 id="VBLecturestopic-8">Lecture 9 Hypertext Applications (HTAs)</h3>

In Lecture 8, we learnt how to write a script to create and send an email. 
In this lecture, we consider another application of scripting technologies. 
We learn how to write an <a href="http://msdn.microsoft.com/en-us/library/ms536471(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/ms536471(VS.85).aspx" style="line-height: 16px; ">HTML Application (HTA)</a>. 
 An HTML application is a Windows-based program written in a language that combines HTML and script languages. 
Such a combination packs the power of Web browsers and scripting. 
Due to the use of HTML, an HTA requires a Web browser to run. 
However, it does not require hosting on a Web server to run the embedded scripts because an HTA uses the client machine to run (you have to download and run it locally). 

            
<pk>Key words</pk>

HTAs (Hypertext Applications), HTML, DHTML (Dynamic HTML)

Why use HTAs

Let's start with a code snippet (download from <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___9_files/embedScript.html" title="Lecture___9_files/embedScript.html" style="line-height: 14px; ">embedScript.html</a>), which is to send a message taken from a web page to a specified address. 

 &lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Web Mail&lt;/TITLE&gt;
&lt;SCRIPT LANGUAGE="VBScript"&gt;
Sub cmdSendEmail_OnClick
  Dim objMsg, objConfiguration, objConfigFields
  Set objConfiguration = CreateObject("CDO.Configuration")
  Set objConfigFields = objConfiguration.Fields

  objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/" style="line-height: 14px; ">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/sendusing") = 2
  objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/" style="line-height: 14px; ">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/smtpserverport") = 25
  objConfigFields.Item("<a href="http://schemas.microsoft.com/cdo/" title="http://schemas.microsoft.com/cdo/" style="line-height: 14px; ">http://schemas.microsoft.com/cdo/</a>" &amp; _
 "configuration/smtpserver") = "email.westernsydney.edu.au"
  objConfigFields.Update

  Set objMsg = CreateObject("CDO.Message")
  objMsg.Configuration = objConfiguration
  objMsg.Subject = "subject of the message here"
  objMsg.From = "<a href="mailto:dongmo@scem.westernsydney.edu.au" title="mailto:dongmo@scm.westernsydney.edu.au" style="line-height: 14px; ">j.yang@westernsydney.edu.au</a>"
  objMsg.To = Document.webmail.EmailAddress.Value
  objMsg.TextBody = Document.webmail.Message.Value
  objMsg.Send
End Sub
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;H1&gt;Web Mail&lt;/H1&gt;
&lt;FORM NAME="webmail"&gt;
  &lt;B&gt;EmailAddress: &lt;/B&gt;
      &lt;INPUT TYPE="Text" NAME="EmailAddress" SIZE=30&gt;
  &lt;br&gt;  
&lt;B&gt;Message: &lt;/B&gt;&lt;INPUT TYPE="Text" NAME="Message" SIZE=80&gt;
  &lt;BR&gt;
  &lt;INPUT TYPE="Button" NAME="cmdSendEmail" VALUE="Send"&gt;
&lt;/FORM&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

The coding structure is obvious - simply a combination of HTML text and VBScript code, where VBScript statements are embedded into an HTML file to create an interactive webpage. 
It tries to collect a message from the Message textfield and use CDO to send the message. 
Unfortunately this code does not work. 
This is because the Web browser that runs the HTML file has no access to the CDO object on the local machine. 
The Web browser security (sandbox) prevents a browser from accessing local system information. 
In fact, if you take the VBScript code out from the HMTL and make it a standalone VBScript program, it works well. 
So this sample code is not what we mean by HTML application. 

An <a title="http://msdn.microsoft.com/en-us/library/ms536471(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/ms536471(VS.85).aspx" style="line-height: 14px; ">HTA</a> is an HTML-based script that runs locally in a web browser but is not served via HTTP from a web server. 
An HTA runs under the security context of the currently logged-in user who executes the script, which widens the script operational features beyond the limited to the browser. 
In fact, if you insert the following statement

    &lt;HTA:APPLICATION /&gt;

into the second line of the above HTML file and change the extension of the file name from .html to .hta, the program will work well. 
Download and run <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___9_files/embedScript.hta" title="Lecture___9_files/embedScript.hta" style="line-height: 14px; ">embedScript.hta</a> (<font color="#FF0000">Note: save the code locally and change the email address and SMTP server name to fit into your case</font>).

An HTA gets advantages from HTML and scripting languages. 
HTML provides an easy control of user interface design. 
Scripting technologies allows a full control on the client computer. 
Moreover, HTAs are not subject to the same security constraints as Web pages. 
Does this mean that HTAs are insecure? No. 
 As with any executable file, the user is asked for permission of downloading an HTA. 
The user has to save and run the application in the local machine. 
In other words, the user is fully aware of the running of the program.

HTAs are suited to many uses, whether you are prototyping, making wizards, or building full-scale applications. 
Everything Dynamic HTML and script can deliver¡ªforms, multimedia, Web applications, HTML editors, and browsers¡ªHTAs can too. 
See Microsoft's HTA tutorial for more details:<a href="http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx" title="http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx" style="line-height: 14px; "> Introduction to HTML Applications (HTAs)</a>. 
You are also encouraged to search the Web.

                
HTA template 

An HTA begins with the standard HTML framework but will likely include additional &lt;script&gt; tags to define the functionality of the application. 
The following is the general format of an HTA:

&lt;html&gt;
&lt;HTA:APPLICATION options/&gt;
&lt;head&gt;
&lt;title&gt;HTA test&lt;/title&gt;
&lt;style&gt;Include Cascading Style Sheet information here&lt;/style&gt;
&lt;script&gt;Include the program functionality here&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
Include the HTML document defining the HTA format here and call functions or subroutines from this section.
&lt;/body&gt;
&lt;/html&gt;

It is easy to see that the ONLY visible difference of an HTA from a normal HTML file is the tag &lt;HTA:APPLICATION options/&gt; (besides the difference in  file names). 
For instance, the following are the HTA options of the script <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___9_files/ClientCheck_1.hta" title="Lecture___9_files/ClientCheck_1.hta" style="line-height: 14px; ">ClientCheck.hta</a> we are going to study in this lecture:

&lt;HTA:APPLICATION 
     ID="ClientCheck" 
     APPLICATIONNAME="Client Diagnostic Tool"
     SCROLL="no"
     SINGLEINSTANCE="yes"
     WINDOWSTATE="normal"
     BORDER="thick"
     BORDERSTYLE="normal"
     MAXIMIZEBUTTON="yes"
     MINIMIZEBUTTON="yes"
     INNERBORDER="yes"
     SYSMENU="yes" /&gt;

Check out <a title="http://msdn.microsoft.com/en-us/library/ms536495(VS.85).aspx#" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/ms536495(VS.85).aspx#" style="line-height: 14px; ">the options of HTA:APPLICATION</a> for the meaning of the parameters and other options.

The second part of an HTA is the definition of layout style. 
You are allowed to use cascading style sheet (CCS) to define the look and feel of the application, including font style, size and color. 
The CSS styles are defined within the &lt;style&gt; tags. 
You can leave everything to be default if you do not seek for a fancy layout. 

The third part, and possible the most tricky part, of an HTA is the script. 
You can write the script in either VBScript or JScript. 
The script is specified within the &lt;script tags&gt;. 
For instance,

&lt;script language = "VBScript"&gt;

The final part is the body where you format a front-end. 
You can use HTML to define buttons, checkboxes, and text fields for collecting data and out put information.

Case study: Checking Client Machine

Jeff Fellinge introduced an HTA in his book: IT Administrator's Top 10 Introductory Scripts for Windows, which implements a tool that can be used to gather information for network connectivity, machine configuration and running processes from a client machine. 
The interface of the program  <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture___9_files/ClientCheck_2.hta" title="Lecture___9_files/ClientCheck_2.hta" style="line-height: 19px; ">ClientCheck.hta</a> is the following:

 
The script accepts input from the user through HTML forms, including the buttons for controlling the process, the checkboxes for choosing different tasks and the text fields for specifying an IP address for testing. 

Exactly following the template of HTAs, the file consists the following four components:

HTA application declaration (within the tag &lt;HTA:APPLICATION /&gt;)

Defining document style (within the tag &lt;style&gt;)

VBScript (within the tag &lt;script&gt;)

HTML body (within the tag &lt;body&gt;)

Let's explain the script in more detail. 
 The first subroutine Window_Onload is to configure the initial parameters of the HTA. 
Note that this subroutine is called automatically when the HTA is run. 
More specifically, it runs when the _onload event is fired. 

Sub Window_Onload
Dim iReturn, objFSO, objShell, objLocator, strHTML 
window.ResizeTo 640,480
cmdRun.disabled = False
cmdSave.disabled = True

On Error Resume Next
Set objLocator = CreateObject("WbemScripting.SWbemLocator")
If Err &lt;&gt; 0 Then 
strHTML=Heading("The WMI Core Components do not " &amp;_
"appear to be installed.","Red") &amp; " As a result, both " &amp;_
"the PC Check and Process Check have been disabled. 
&lt;br&gt;&lt;br&gt;"
strHTML=strHTML &amp; "&lt;i&gt;To run diagnostics, please download " &amp;_
"and install the core WMI services for Windows.&lt;br&gt;" &amp;_
"Download these files from Microsoft &lt;a href=" &amp; chr(34) &amp;_
    "<a href="http://msdn.microsoft.com/library/default.asp?url" title="http://msdn.microsoft.com/library/default.asp?url">http://msdn.microsoft.com/library/default.asp?url</a>" &amp;_
    "=/downloads/list/wmi.asp" &amp; chr(34) &amp; "&gt;here&lt;/a&gt;." &amp;_
    "&lt;/i&gt;&lt;br&gt;&lt;br&gt;"
output.innerHTML= strHTML 
chkPC.checked=False
chkPC.disabled=True
chkProcess.checked=False
chkProcess.disabled=True
End If
On Error Goto 0
Set objShell=CreateObject ("WScript.Shell")
g_strTemp=objShell.ExpandEnvironmentStrings("%temp%") &amp;_
 "/tempdiagnostics.txt"
End Sub

The subroutine first sets the size of the HTA widow, enables the Run button and disable the Save button. 
Next, it creates a SWbemLocator object. 
<a title="http://msdn.microsoft.com/en-us/library/aa393719(VS.85).aspx" onkeypress="window.open(this.href); return false;" onclick="window.open(this.href); return false;" href="http://msdn.microsoft.com/en-us/library/aa393719(VS.85).aspx" style="line-height: 19px; ">SWbemLocator</a> is a scripting object that can get access to WMI on a particular host computer, much as the WMI moniker "winmgmts:" The next segment of code provides basic error handling. 

The second subroutine PerformDiagnostics is used to launch the processes of PC check, Process check and Network check in response to the user's selection. 
The functions PCcheck, Processcheck and Networkcheck are designed to perform the  functionality of checking information about the computer, current running processes, and network. 

The PC Check subroutine uses WMI to demonstrate how to retrieve a variety of information from a local computer. 
The information is collected from five different WMI classes: Win32_OperatingSystem, Win32_BIOS, Win32_ComputerSystem, Win32_Processor,  and Win32_LogicalDisk. 

The Process Check subroutine also uses WMI in order to retrieve the information of the active processes. 
The WMI class that is used in the subroutine is Win32_Process, which contains the information about the active processes, such as the process name, the command line that was used to start it, how much memory the process has consumed, the number of page faults caused by the process, and others. 

The Network Check subroutine uses WSH run methods and FSO methods to drive external applications such as ping, ipconfig, and tracert. 
Before running the test, the user can specify the IP address of a remote computer to measure the quality of the connection between the two computers. 
By default, this value is set to the 127.0.0.1, or localhost. 

There are a few other  subroutines or functions that are used for formating, save test results and quit the HTA. 
I would recommend all of you  to read the code carefully for an in-depth understanding. 
Thanks for your time.

<h3 id="VBLecturestopic-9">Lecture 10 CGI Scripting</h3>

The techniques we have learnt in the previous lectures are mostly for client side programming. 
 In other words, the code is executed at the machine the user is running. 
However, for most Internet applications, significant amounts of processing must be performed on the server side. 
For instance, to build an online booking system for a hotel, all the enquiries on the availability of hotel rooms have to be transfered to a server where the database of booking information is situated. 

Getting a Web server to perform application processing is not necessarily complicated. 
Most Web servers support the Common Gateway Interface (CGI) protocol, which allows a degree of interaction between the client browser and the server. 
For instance, our school Web server supports CGI. 
Therefore we can build a website based on our school Web server. 
In the last two lectures, we will learn the basic scripting techniques for building a website using CGI. 

CGI applications can be written in any language. 
However, the standard all-purpose languages, such as C, C++, and Java, are mostly  too heavy for simple CGI applications. 
 The commonly used languages for CGI applications are scripting languages, such as Unix shell script, Perl, PHP, VBScript and so on. 
Among them, the most popular languages for small CGI applications are Perl and PHP. 

<pk>Key words</pk>

CGI, Client-side/Server-side Web Programming, Perl, PHP 

In this unit, we only use Perl. 
The reason I pick up Perl rather than PHP is that I know Perl more than PHP, although both are good and easy to learn. 
For basic knowledge on Perl, here is an online book: <a href="http://www.perl.org/books/beginning-perl/">Simon Cozens, Beginning Perl.</a> 

Lab setup

We will not systematically introduce CGI and Perl language. 
Instead, we learn by practice. 
To make this possible, we have to set up a server which support CGI. 
For Windows system, you need to run IIS and install Perl interpreter. 
 For unix system, the school Web server supports CGI and has Perl interpreter installed. 
Therefore we only have to learn how to use the facility. 
Let me explain the steps of CGI server setting by using a simple example. 

Before we start, you need to download the client side  program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_10_files/firstCGITest.html">firstCGITest.html</a>  and the server side program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_10_files/myFirstCGI.cgi">myFirstCGI.cgi</a> <font color="#FF0000">[Note: If you are not allowed to download .CGI file, try <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_10_files/cgi-bin.zip" title="CGI Files" onmouseover="window.status='Zipped CGI Files'; return true" onmouseout="window.status=' '">this link</a>]</font>. 
Store them in a folder on your local machine. 
Next, we install the server side program to the school Web server via the following steps: 

1. Logon to the School unix server through SSH. 
 If you have never used SSH before, please refer to the school Website: <a href=" https://www.scem.westernsydney.edu.au/home/support/secureshell">https://www.scem.westernsydney.edu.au/home/support/secureshell</a>.
2. Create a folder called Homepage (case sensitive) if it does not exist, and make the folder executable by all by executing (skip this step if the folder already exists):
 mkdir Homepage
 chmod 755 Homepage

3. Go inside the subfolder Homepage. 
Create another subfolder cgi-bin and make it executable by all (skip this step if the folder already exists):
 cd Homepage
 mkdir cgi-bin
 chmod 755 cgi-bin

4. You also have to make your home directory executable:
 cd
 chmod 755 <b>.</b>

Note that there is a dot at the end of the above command.

5. From the SSH main menu, choose <b>window -&gt; New File Transfer</b>. 
You will see a new window: SSH Secure File Transfer.

6. Choose <b>Operation -&gt; File Transfer Mode -&gt; ASCII</b> from the new window.

7. Go inside the subdirectory cgi-bin under Homepage (on the right column of the window). 
Upload the file <i>myFirstCGI.cgi</i>.

8. Change the attribute of the file to be everybody can run:
 chmod 711 myFirstCGI.cgi

9. Open <i>firstCGITest.html</i> file on your local computer by using a text editor. 
You will see

 &lt;html&gt;&lt;head&gt;&lt;title&gt;My First CGI&lt;/title&gt; 
 &lt;/head&gt;&lt;body&gt; 
 &lt;form action="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/myFirstCGI.cgi"&gt; 
 &lt;h1&gt;Connect to the server.&lt;/h1&gt; 
 &lt;input type="submit"&gt; 
 &lt;/form&gt; 
 &lt;/body&gt; 
 &lt;/html&gt; 

Change the URL http://<font color="#FF0000">staff</font>.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~<font color="#FF0000">jianhua</font>/myFirstCGI.cgi into your login name: <font face="Courier New">http://<font color="#FF0000">student</font>.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~<font color="#FF0000">XXXXXXX</font>/myFirstCGI.cgi</font>, where XXXXXXX is your school user id.

10. If you are not using the school lab computer, you must connect your computer to the school network using VPN.
11. Run firstCGITest.html by using a Web Browser from your local computer. 
Click Submit button. 
If you can see: 

 Congratulations! You have successfully connected to the server. 

then the job is done. 
Otherwise, check if you have had followed all the above steps. 
Do these steps again if necessary.

HTML Forms 

The most common way for a user to communicate information from a Web browser to the server is through a form. 
In the above client side program, the form defines an action that calls a CGI program on the Web server:

&lt;form action="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/myFirstCGI.cgi"&gt;
&lt;/form&gt; 

In fact, it does nothing but specifies the URL of the CGI script <font face="Courier New">myFirstCGI.cgi</font> on the school web server (note that the URL is different from the path of the file). 
You can actually call this script manually from a web browser using the URL: <font face="Courier New" ;="" size="2.5px">http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/myFirstCGI.cgi</font> 

A form is defined by the &lt;form&gt; tag. 
The tag can contain a few attributes, which further specifies the properties of the form. 
The most frequently used attributes are: 

action:  specifies the URL where Web application is located.

method: specifies which HTTP method will be used to submit the form data set. 
Possible (case-insensitive) values are "get" (the default) and "post".

enctype: specifies the content type used to submit the form to the server (when the value of method is "post"). 
The default value for this attribute is "application/x-www-form-urlencoded". 
The value "multipart/form-data" should be used in combination with the INPUT element, type="file".

name: specifies the id of the form so that the form may be referred to from style sheets or scripts.

See more attributes of a form from <a href="http://www.w3.org/TR/html401/interact/forms.html">http://www.w3.org/TR/html401/interact/forms.html</a>. 

A form can be controlled by a set of widgets, which is used for text, passwords, checkboxes, radio buttons, Submit button and Reset button. 
A widget is defined by the &lt;input&gt; tag. 
For instance, the following statement specifies a text input box: 

 &lt;input type = "text" name = "giveItaName" size = "20"/&gt; 

Similarly, the following statement defies a radio button: 

 &lt;input type="radio" name="sex" value="Male"&gt; 

You may contain as many widgets as required. 
In any case, you must define a submit button; otherwise the action specified in the form tag will not be taken and the data collected by the input fields will not be transferred to the server. 
A submit button can also trigger a call to a local script embedded in the HTML file or an HTA. 
To learn how to define a form, see another more complicated example <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_10_files/moreForms.htm">moreForms.htm</a>. 
 Note that the action specified in this form is to call the default email program to send the collected information to the specified receiver. 
For more detailed instructions for building a form, see <a href="http://www.w3.org/TR/html401/interact/forms.html">http://www.w3.org/TR/html401/interact/forms.html</a>. 

CGI scripts 

The <a href="http://www.w3.org/CGI/">Common Gateway Interface</a> (CGI) is a standard protocol for a Web server to pass a Web user's request to an application program and to receive data back to forward to the user. 
When a user fills out a form on a Web page and sends it in, it usually needs to be processed by an application program. 
The Web server typically passes the form information to a small application program that processes the data and may send back a confirmation message. 
This method or convention for passing data back and forth between the server and the application is called the common gateway interface (CGI). 
It is part of the Web's Hypertext Transfer Protocol (HTTP). 
With such an interface, we can write a CGI application in a number of different languages, such as C, C++, Java. 
However, since most of the CGI applications are quite small, it is more popular to use a scripting language such as unix shell, Perl, PHP, VBScript and etc., to write a CGI application. 
In this lecture, we use Perl.

The following code is the CGI application (myFirstCGI.cgi) you just put on the school server under your Homepage:

#!/usr/bin/perl 
use CGI ':standard'; 
print "Content-type: text/html\n\n"; 
print "Congratulations! You have successfully connected to the server."; 

The code is written in Perl. 
The first line of the code simply tells the Web server to call a Perl interpreter to execute this code. 
The next statement specifies the module we use in CGI, which is the standard module. 
 The next two print statements are the messages that are sent to the client's browser. 
Therefore it is a way the server communicates with clients. 
The first print statement is telling the client browser that the coming MIME content is of type text/html. 
Note that there is a space between <font face="Courier New">Content-type:</font> and <font face="Courier New">text/html\n\n</font>. 
Note that the browser won't be able to display the output at all without this line.

Interaction between the server and clients 

One may wonder how the server side program communicates with clients. 
To see the secrete inside, let's try the following example:

Server side program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_10_files/myName.cgi">myName.cgi</a>: <font color="#FF0000">[Note: If you are not allowed to download .CGI file, try <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_10_files/cgi-bin.zip" title="CGI Files" onmouseover="window.status='Zipped CGI Files'; return true" onmouseout="window.status=' '">this link</a> - a zip file with all .CGI files used in Lectures 10 and 11 as well as relevant pracs].</font>
#!/usr/bin/perl 
use CGI ':standard'; 
my $name = param("<font color="#FF0000">myName</font>"); 
print "Content-type: text/html\n\n"; 
print "Hello, $name."; 

Client side program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_10_files/myName.html">myName.html</a>: 

&lt;html&gt;&lt;head&gt;&lt;title&gt;What's your name&lt;/title&gt;&lt;/head&gt; 
&lt;body&gt; 
&lt;form action="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/myName.cgi"&gt; 
&lt;h1&gt;What's your name?&lt;/h1&gt; 
&lt;input name = "myName" type = "text" size = "25" /&gt; &lt;br&gt; 
&lt;input type="submit" value ="Submit"&gt; 
&lt;/form&gt; 
&lt;/body&gt; 
&lt;/html&gt; 

Follow the steps we did before to upload the server-side program to the cgi-bin folder under your unix Homepage and run the client side html file. 
You will see similar results as shown in the figures below. 
It is easy to see that in order to capture the content of the text field, named myName, in the client side program, call the param function in the server-side program as param("myName"). 
 The function will return the content that has been filled in the text field.

We will show more complicated examples in next lecture. 

<h3 id="VBLecturestopic-10">Lecture 11 Server Side programming Using Perl</h3>

In the previous lecture, we have learnt the basic concept of CGI and server side programming. 
In this lecture we'll reinforce CGI programming skills via a set of examples, where file operations are to be illustrated. 
Note that all these examples are very fragile. 
I did not include too much error catching in the code in order to make the code more readable. 
Any change on the code could cause problem to run. 

All the code is tested in my working environment. 
To make the code working for you, the URL of your CGI program should be in the following format:

http://student.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~XXXXXXX/YYYYYYY.cgi
where XXXXXXX is your school user id and YYYYYY is your CGI program name. 
To run your CGI, you must be connect to the school using VPN or work at school lab. 

<pk>Key words</pk>

CGI (Common Gateway Interface), Client-side/Server-side Web Programming, Perl, PHP 

Reference to textbook chapters

For basic knowledge on Perl, here is an online book: <a href="http://www.perl.org/books/beginning-perl/">Simon Cozens, Beginning Perl.</a> There are also plenty of online Perl tutorials over the Web. 

File operations: read files

The following script <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_11_files/readTextFile.cgi" title="Lecture_11_files/readTextFile.cgi">readTextFile.cgi</a>  can read a text file (lyrics.txt) from the server and publish the content of the file to the client's browser. 

#!/usr/bin/perl -w
use CGI qw ( :standard);
print "Content-type: text/html\n\n";
$file="lyrics.txt";

open(FILE, "&lt;$file") or die("The file could not be opened!");
while($line=&lt;FILE&gt;){
   print("$line &lt;br&gt;");
}
close(FILE);

The program simply reads the file lyrics.txt line-by-line and outputs to the client's browser. 
 $file is a variable, which is used to store the name of the input file. 
Similar to VBScript, we do not need to declare a variable before we use it. 
We also do not need to worry about the type of an variable. 
The statement open(FILE, "&lt;$file") is used to open the file. 
The label FILE is called filehandle, which is used for file processing. 
We can view it as a reference of $file. 
Note that the symbol "&lt;" in the statement indicates that the file is opened for <i>reading</i>. 
You do not need to set the text file to be 'everybody can read'. 
It just needs to be accessible by your script. 
If the file is placed in a different directory other than cgi-bin, you need to specify its relative path, say "../../documents/lyrics.txt".

To call this script, you can simply type in this URL:  <a href="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/readTextFile.cgi" title="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/readTextFile.cgi">http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/readTextFile.cgi</a>  in your Web browser. 
You can also write a HTML file to call the script (<a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_11_files/readTextFile.html">readTextFile.html</a>):

&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Read File&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;FORM ACTION="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/readTextFile.cgi" METHOD="POST"&gt;
&lt;INPUT TYPE="submit" VALUE="Get file"&gt;
&lt;/FORM&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

Remember to change the URL to fix your working environment when testing your own CGI code.
 
File operations: write files

The code for write a message into a text file is similar. 
Note that the resulting file is stored in the server side. 

First, let's look at the client-side program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_11_files/writeTextFile.html" title="Lecture_11_files/writeTextFile.html">writeTextFile.html</a>:

&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Write a message&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;FORM ACTION="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/writeTextFile.cgi" METHOD="POST"&gt;
Write your message here&lt;br&gt;
&lt;TEXTAREA NAME="message" ROWS=4 COLS=45&gt;&lt;/TEXTAREA&gt;
&lt;P&gt;&lt;INPUT TYPE="submit" VALUE="Send"&gt;
&lt;/FORM&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

Run the client-side program before you install the server-side CGI program to get a feeling of the HTML form. 
In fact, it takes client's message from a textarea and send it to the server via a CGI query. 
The server catches this query and write the message into a file (logfile.txt). 
The server side program <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_11_files/writeTextFile.cgi" title="Lecture_11_files/writeTextFile.cgi">writeTextFile.cgi</a> is the following:

#!/usr/bin/perl
use CGI qw(:standard);
print "Content-type: text/html\n\n";

$content = param("message");
$file="logfile.txt";

open(FILE, "&gt;$file") || die("Fail to open the file");
print FILE "$content";
close (FILE);
print "Thanks for your message.";

The program is almost the same as "readTextFile.cgi" except:

1.the statement that catches the message from the client side program and save it to the variable $content:

    $content = param("message"); 

2.and the statement that open the file logfile.txt for write:

    open(FILE, "&gt;$file")

Note that "&gt;" means overwriting the file. 
To append data to the file, use "&gt;&gt;". 

Upload files to the server programmatically

First, create a special folder at your server (not necessarily readable and writable to every body but should be true to your script) where you are going to upload files. 
For instance, you can make a folder named "upload" under your home directory in Unix drive by the following commands:

cd ~
mkdir upload

Next you create a client side program to collect client's files ( <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_11_files/uploading.html" title="Lecture_11_files/uploading.html">uploading.html</a>):

&lt;html&gt;&lt;head&gt;&lt;title&gt;Uploading Files&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;form action="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/uploading.cgi" method="post" enctype="multipart/form-data"&gt;

What file would you like to upload?
&lt;input type="file" name="uploadfile" size="30"&gt;&lt;br&gt;
&lt;input type="submit"&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;

Download the file and save it locally. 
Change the URL to point to  the CGI code on your server.

Now the job left is to write a server side program to accept the files to upload. 
See <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_11_files/uploading.cgi" title="Lecture_11_files/uploading.cgi">uploading.cgi</a>:

#!/usr/bin/perl -w
use CGI qw/:standard/;
print "Content-type: text/html\n\n";

my $file = param('uploadfile');
my $upload_dir = "&gt;../../upload";
my $fileName = $file;
$fileName =~ s/.*[\/\\](.*)/$1/;

if ($file) {
open (UPLOAD, "&gt;$upload_dir/$fileName") || Error ();
my ($data, $length, $chunk);
while ($chunk = read ($file, $data, 1024)) {
print UPLOAD $data;
}
close (UPLOAD);
print "&lt;p&gt;Thank you for uploading &lt;b&gt;$fileName&lt;/b&gt;.";
} else {
print "No file was chosen.";
}

sub Error {
print "Couldn't open temporary file: $!";
exit;
}

In the above code, the first three line are standard. 
The highlighted block in blue defines the file names of the file to upload and the file to save. 
The variable $file holds the file name to upload (now on your local machine). 
$upload_dir specifies the folder "upload" your just created. 
$fileName gives the name of the file to be saved on the server. 
Note that the saved file name is the same as its original name except the possible path of the original file has been removed (use regular expression). 
The highlighted part in red reads the file to upload, block-by-block, and save it to the file on the server. 
The <i>read</i> function reads 1024 bytes data from $file to $data variable each time. 
The <i>print</i> statement saves the data from $data to UPLOAD, a reference of the saved file. 
   

Password checking

The final example I am going to show you is the code for checking user id and password. 
The client side code <a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_11_files/password.html" title="Lecture_11_files/password.html">password.html</a> is the following:

&lt;html&gt;&lt;head&gt;&lt;title&gt;Verifying a username and a password&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h2&gt;Type in your username and password below. 
&lt;/h2&gt;
&lt;form action="http://staff.scem.westernsydney.edu.au/cgi-bin/cgiwrap/~jianhua/password.cgi" method="post"&gt;
  &lt;table&gt;&lt;tbody&gt;&lt;tr&gt;
        &lt;td&gt;Username:&lt;/td&gt; 
        &lt;td&gt; &lt;input name="username" type="text"&gt; &lt;/td&gt;
      &lt;/tr&gt;&lt;tr&gt;
        &lt;td&gt;Password:&lt;/td&gt;
        &lt;td&gt; &lt;input name="password" type="password"&gt; &lt;/td&gt;
      &lt;/tr&gt;&lt;tr&gt;
        &lt;td&gt; &lt;input type="submit" value="Enter"&gt; &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;&lt;/table&gt;
&lt;/form&gt;
&lt;/body&gt;&lt;/html&gt;

As usual the URL points to the CGI program password.cgi. 
Two inputs widgets accept user name (as text) and password (as password), respectively. 
Note that the Web browser can automatically blind user's input of password.

The server side program (<a href="https://staff.cdms.westernsydney.edu.au/~jianhua/SAP_300165/lectures/Lecture_11_files/password.cgi" title="Lecture_11_files/password.cgi">password.cgi</a>) is a bit more complicated.

#!/usr/bin/perl -w
use CGI qw( :standard );
print "Content-type: text/html\n\n";
   
$testUsername = param( "username" );
$testPassword = param( "password" );

open(FILE, "password.txt" ) || die( "The database could not be opened." );
while ( $line = &lt;FILE&gt; ) {                        
    chomp( $line );                                
    ( $username, $password ) = split(",", $line );  
    if( $testUsername eq $username ) {            
        $userVerified = 1;
   if( $testPassword eq $password ) {
 $passwordVerified = 1;
 last;
        }
    } 
}
close( FILE );
   
if ( $userVerified &amp;&amp; $passwordVerified ) {
    accessGranted();
}elsif ( $userVerified &amp;&amp; !$passwordVerified ) {
    wrongPassword();
}else {
      accessDenied();
}
   
sub accessGranted{
    print "Permission has been granted";
}
   
sub wrongPassword{
    print "You entered an invalid password. 
Access has been denied.";
}
   
sub accessDenied{
    print "You have been denied access to this site.";
}

The core of the program is the highlighted part in red. 
It reads the password.txt file line-by-line. 
Each line of the file is in the format: username, password. 
The chomp function removes any terminating newline characters from its parameter. 
The split function splits each line into two parts and store the result into the array $username, $password. 
The two if statements check user name and password, respectively (match the information provided by a user to records stored in a file). 
The rest of the code is trivial.

Tips for debugging a Perl program

1. Always start from the simplest code and make sure it works well. 
Add more functionalities one by one. 
Once you implement a new functionality, save it to a backup folder before you add more functionalities to it. 

2. A server side program is supposed to be small. 
Too complicated programs would slow down the server.

3. A CGI program needs to be everybody executable. 
However, you should keep other file to be safe, especially the password database. 

4. Perl and Unix commands are case sensitive.

<h3 id="VBLecturestopic-11">Lecture 12 Conclusion</h3>

We have learnt the basic scripting techniques from the previous eleven lectures. 
By using FSO, ADSI, and WMI, we can retrieve information of a local or network computer, execute a Windows command, remotely control a network computer, and manipulate domains, groups and users programmatically using VBScript. 
We have also learnt how to write a CGI script using Perl. 
All of these form the foundation of Windows system administration. 

We tried a few new approaches in teaching this subject. 
All the lectures are online so that students can "attend" the lectures without need to travel. 
Students' work was checked individually to ensure that every student can actually do the job. 
One may wonder what if we use the traditional approach to deliver the subject. 
The ideas to use this online approach are the following:

1.Script programming is mainly a skill that needs more practice. 
As mentioned in the practical sessions, the skill of programming is like the skill of driving. 
You can't learn to drive by attending a university course or watching other persons to drive. 
You have to do it by yourself. 
  

2.The main difficulty of script programming is not the scripting language but the background knowledge of using the language. 
For instance, to use ADSI and WMI, we need to know which Windows object contains what information. 
There are thousands of Windows objects. 
Even searching for a related object or attributes of an object can be a burden, it's less feasible to include all the details of the objects in lecture notes. 
With online lectures, we can refer to related knowledge by using hypertext links to the related Websites, say Microsoft's MSDN. 
Actually, you may often need to search the Web on demands when reading the lecture note. 
So a set of key words have been provided for in each lecture your convenience. 
In addition, the textbook itself is also in an eBook format.

3.As a hands-on subject, it is important that the skill of programming is built step-by-step. 
Checking students' work individually can "push" students to follow the designed learning process.

Due to some uncontrollable situation, not all the ideas above have been implemented. 
Nevertheless, I have been enjoying the teaching of this subject even though it took me considerable time to maintain this unit throughout the semester. 
Trust you enjoyed the unit too.

=========Thank you and Good luck=========

<h2>to pipe a script to WScript</h2>
Short answer is No unfortunately.
The WScript Engine does not provide a way to pass script either piped or via the command arguments, the only option is using StdIn to interpret and process the commands.

<h2>Simple HTTP Server in VB.Net</h2>

Imports System.Net
Imports System.Net.Sockets
Imports System.Text
Imports System.Threading

Public Class Server
#Region "Declarations"
    Private Shared singleServer As Server
    Private Shared blnFlag As Boolean

    Private LocalTCPListener As TcpListener
    Private LocalPort As Integer
    Private LocalAddress As IPAddress = GetIPAddress()
    Private ServerThread As Thread
#End Region

#Region "Properties"
    Public Property ListenPort() As Integer
        Get
            Return LocalPort
        End Get
        Set(ByVal Value As Integer)
            LocalPort = Value
        End Set
    End Property

    Public ReadOnly Property ListenIPAddress() As IPAddress
        Get
            Return LocalAddress
        End Get
    End Property
#End Region

#Region "Methods"
    Private Function GetIPAddress() As IPAddress
        With System.Net.Dns.GetHostEntry(System.Net.Dns.GetHostName())
            If .AddressList.Length > 0 Then
                Return New IPAddress(.AddressList.GetLowerBound(0))
            End If
        End With
        Return Nothing
    End Function

    Friend Shared Function getServer(ByVal LocalPort As Integer, ByVal Optional LocalAddress As String = Nothing) As Server
        If Not blnFlag Then
            singleServer = New Server
            If Not LocalAddress Is Nothing Then
                Server.singleServer.LocalAddress = IPAddress.Parse(LocalAddress)
            End If
            If Not LocalPort = 0 Then
                Server.singleServer.LocalPort = LocalPort
            End If
            blnFlag = True
            Return Server.singleServer
        Else
            Return Server.singleServer
        End If
    End Function

    Public Sub StartServer()
        Try
            LocalTCPListener = New TcpListener(LocalAddress, LocalPort)
            LocalTCPListener.Start()
            ServerThread = New Thread(AddressOf StartListen)
            serverThread.Start()
        Catch ex As Exception
            Console.WriteLine(ex.Message)
        End Try
    End Sub

    Public Overloads Sub SendResponse(ByVal sData As String, ByRef thisSocket As Socket)
        SendResponse(Encoding.UTF8.GetBytes(sData), thisSocket)
    End Sub

    Public Overloads Sub SendResponse(ByVal bSendData As [Byte](), ByRef thisSocket As Socket)
        Dim iNumBytes As Integer = 0
        If thisSocket.Connected Then
            If (iNumBytes = thisSocket.Send(bSendData, bSendData.Length, 0)) = -1 Then
                ' socket error can't send packet
            Else
                ' number of bytes sent.
            End If
        Else
            ' connection dropped.
        End If
    End Sub

    Private Sub New()
        ' create a singleton
    End Sub

    Private Sub StartListen()
        Do While True
            ' accept new socket connection
            Dim mySocket As Socket = LocalTCPListener.AcceptSocket
            If mySocket.Connected Then
                Dim ClientThread As Thread = New Thread(Sub() Me.ProcessRequest(mySocket))
                ClientThread.Start()
            End If
        Loop
    End Sub

    Private Sub ProcessRequest(ByRef mySocket As Socket)
        Dim bReceive() As Byte = New [Byte](1024) {}
        Dim i As Integer = mySocket.Receive(bReceive, bReceive.Length, 0)
        Dim sRequest = Encoding.UTF8.GetString(bReceive)
        Dim sResponse As String
        sResponse = "Your message was : " & sRequest
        SendResponse(sResponse, mySocket)
        mySocket.Close()
    End Sub

    Public Sub StopServer()
        Try
            LocalTCPListener.Stop()
            ServerThread.Abort()
        Catch ex As Exception
            Console.WriteLine(ex.Message)
        End Try
    End Sub
#End Region
End Class

It remains to process the request and generate the response in the processRequest method.

<h2>TCP Client/Server Simple Chat Program</h2>

<pk>Server Side that accepts Messages from Client</pk>
Option Explicit On
Imports System.IO, System.Net.Sockets
Public Class Form1
Dim listener As New TcpListener(4000)
Dim client As TcpClient

Private Sub Form1_FormClosing(ByVal sender As Object, ByVal e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
listener.Stop()

End Sub

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
listener.Start()
Timer1.Start()
End Sub

Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
Dim message As String
Dim nStart As Integer
Dim nLast As Integer
If listener.Pending = True Then
  message = ""
client = listener.AcceptTcpClient()
Dim reader As New StreamReader(client.GetStream())
While reader.Peek > -1
message &= Convert.ToChar(reader.Read()).ToString
End While
If message.Contains("<>") Then
nStart = InStr(message, "<>") + 4
nLast = InStr(message, "<>")
End If
TextBox1.Text = message
TextBox1.Text = message
If message = "#GO" Then
MsgBox("Test Command has been receive. xD")
End If
End If
End Sub
The Problem is I dont know how to.. Send back message to Client(s) And i want 2 or more clients can connect to this Server...
---------------------------------------------------
2nd Problem is i don't know how to accept Message from Server.

Here is the code for Client Side..
Option Explicit On
Imports System.IO
Imports System.Net.Sockets
Public Class Client
Dim client As TcpClient
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
Try
client = New TcpClient("127.0.0.1", 8281)
Dim writer As New StreamWriter(client.GetStream())
writer.Write("<>" & TextBox1.Text & "<>")
writer.Flush()
Catch ex As Exception

End Try
End Sub
' COMMAND BUTTON Send to Server
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
Try
client = New TcpClient("127.0.0.1", 8281)
Dim writer As New StreamWriter(client.GetStream())
writer.Write("#GO") ' This is for my Future Commands that Can Control Another PC on my Network..
writer.Flush()
Catch ex As Exception

End Try
End Sub

End Sub
End Class

<h2>scripting Windows Media Player</h2>

Set oPlayer = CreateObject("WMPlayer.OCX")
oPlayer.openPlayer("F:\abc.mp3") ' Launches WMP window    

' This launches background process, don't want this...
'oPlayer.url = "file:///F:/2014-04-27.mp3"

' Wait for file to load...
wscript.sleep 200

' Check the state of the player...
While oPlayer.Playstate &lt;> 3
    log "Waiting for player. Current state is: " & oPlayer.Playstate
    WScript.Sleep 100 
Wend
oPlayer.controls.pause()
wscript.sleep 2000
oPlayer.controls.play()

<h3>simple example</h3>
  Dim oPlayer
  Set oPlayer = CreateObject("WMPlayer.OCX")
  oPlayer.URL = "C:\Users\User\Music\freesound\955.mp3"
  oPlayer.controls.play 
  While oPlayer.playState <> 1 ' 1 = Stopped 3 = playing
    WScript.Sleep 100
  Wend
  oPlayer.close










<script type='text/javascript' src='readbook.js'></script>
<script>
var lazyLoadInstance = new LazyLoad({ elements_selector: ".lazy"});
</script>

</pre>
</body>
</html>
