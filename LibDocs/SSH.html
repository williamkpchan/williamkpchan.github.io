<base target="_blank"><html><head><title>SSH</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://williamkpchan.github.io/maincss.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script src="https://williamkpchan.github.io/lazyload.min.js"></script>
<script src='https://williamkpchan.github.io/mainscript.js'></script>
<script src="https://williamkpchan.github.io/commonfunctions.js"></script>
<script>
var showTopicNumber = false;
var topicEnd = "<br>";
var bookid = "SSH"
var markerName = "h2, h3"
</script>
<style>
body{width:80%;margin-left: 10%; font-size:24px;}
h1, h2 {color: gold;}
strong {color: orange;}
img {max-width:90%; display: inline-block; margin-top: 2%;margin-bottom: 1%;-radius:3px;}
k {color: #205080;}
</style></head><body onkeypress="chkKey()"><center>
<h1>SSH</h1>
<a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh">connecting-to-github-with-ssh</a>

<div id="toc"></div></center>
<pre>
<h2><span class="orange">Using SSH agent forwarding</span></h2>
To simplify deploying to a server, you can set up SSH agent forwarding to securely use local SSH keys.
SSH agent forwarding can be used to make deploying to a server simple. 
It allows you to use your local SSH keys instead of leaving keys (without passphrases!) sitting on your server.

If you've already set up an SSH key to interact with GitHub, you're probably familiar with <code>ssh-agent</code>. 
It's a program that runs in the background and keeps your key loaded into memory, so that you don't need to enter your passphrase every time you need to use the key. 
The nifty thing is, you can choose to let servers access your local <code>ssh-agent</code> as if they were already running on the server. 

This is sort of like asking a friend to enter their password so that you can use their computer.
Check out <a href="http://www.unixwiz.net/techtips/ssh-agent-forwarding.html">Steve Friedl's Tech Tips guide</a> for a more detailed explanation of SSH agent forwarding.
<h2>&emsp;Setting up SSH agent forwarding</h2>
Ensure that your own SSH key is set up and working. 
You can use <a href="/en/articles/generating-ssh-keys">our guide on generating SSH keys</a> if you've not done this yet.
You can test that your local key works by entering <code>ssh -T git@github.com</code> in the terminal:
<code>$ ssh -T git@github.com
# Attempt to SSH in to github
> Hi USERNAME! You've successfully authenticated, but GitHub does not provide
> shell access.</code>
We're off to a great start. 

Let's set up SSH to allow agent forwarding to your server.
Using your favorite text editor, open up the file at <code>~/.ssh/config</code>. 
If this file doesn't exist, you can create it by entering <code>touch ~/.ssh/config</code> in the terminal.
Enter the following text into the file, replacing <code>example.com</code> with your server's domain name or IP:
<code>Host example.com
 ForwardAgent yes</code>
<strong>Warning:</strong> You may be tempted to use a wildcard like <code>Host *</code> to just apply this setting to all SSH connections. 
That's not really a good idea, as you'd be sharing your local SSH keys with <em>every</em> server you SSH into. 
They won't have direct access to the keys, but they will be able to use them <em>as you</em> while the connection is established. 
<strong>You should only add servers you trust and that you intend to use with agent forwarding.</strong>
<h2>&emsp;Testing SSH agent forwarding</h2>
To test that agent forwarding is working with your server, you can SSH into your server and run <code>ssh -T git@github.com</code> once more. 
If all is well, you'll get back the same prompt as you did locally.
If you're unsure if your local key is being used, you can also inspect the <code>SSH_AUTH_SOCK</code> variable on your server:
<code>$ echo "$SSH_AUTH_SOCK"
# Print out the SSH_AUTH_SOCK variable
> /tmp/ssh-4hNGMk8AZX/agent.79453</code>
If the variable is not set, it means that agent forwarding is not working:
<code>$ echo "$SSH_AUTH_SOCK"
# Print out the SSH_AUTH_SOCK variable
> [No output]
$ ssh -T git@github.com
# Try to SSH to github
> Permission denied (publickey).</code>
<h2>&emsp;Troubleshooting SSH agent forwarding</h2>
Here are some things to look out for when troubleshooting SSH agent forwarding.
<h3>&emsp;&emsp;You must be using an SSH URL to check out code</h3>
SSH forwarding only works with SSH URLs, not HTTP(s) URLs. 
Check the <code>.git/config</code> file on your server and ensure the URL is an SSH-style URL like below:
<code>[remote "origin"]
 url = git@github.com:YOUR_ACCOUNT/YOUR_PROJECT.git
 fetch = +refs/heads/*:refs/remotes/origin/*</code>
<h3>&emsp;&emsp;Your SSH keys must work locally</h3>
Before you can make your keys work through agent forwarding, they must work locally first. 
<a href="/en/articles/generating-ssh-keys">Our guide on generating SSH keys</a> can help you set up your SSH keys locally.

<h3>&emsp;&emsp;Your system must allow SSH agent forwarding</h3>
Sometimes, system configurations disallow SSH agent forwarding. 
You can check if a system configuration file is being used by entering the following command in the terminal:
<code>$ ssh -v URL
# Connect to the specified URL with verbose debug output
> OpenSSH_8.1p1, LibreSSL 2.7.3
> debug1: Reading configuration data /Users/YOU/.ssh/config
> debug1: Applying options for example.com
> debug1: Reading configuration data /etc/ssh_config
> debug1: Applying options for *
$ exit
# Returns to your local command prompt</code>
In the example above, the file <code>~/.ssh/config</code> is loaded first, then <code>/etc/ssh_config</code> is read. 
We can inspect that file to see if it's overriding our options by running the following commands:
<code>$ cat /etc/ssh_config
# Print out the /etc/ssh_config file
> Host *
>   SendEnv LANG LC_*
>   ForwardAgent no</code>
In this example, our <code>/etc/ssh_config</code> file specifically says <code>ForwardAgent no</code>, which is a way to block agent forwarding. 
Deleting this line from the file should get agent forwarding working once more.
<h3>&emsp;&emsp;Your server must allow SSH agent forwarding on inbound connections</h3>
Agent forwarding may also be blocked on your server. 
You can check that agent forwarding is permitted by SSHing into the server and running <code>sshd_config</code>. 
The output from this command should indicate that <code>AllowAgentForwarding</code> is set.
<h3>&emsp;&emsp;Your local <code>ssh-agent</code> must be running</h3>
On most computers, the operating system automatically launches <code>ssh-agent</code> for you. 
On Windows, however, you need to do this manually. 
We have <a href="/en/github/authenticating-to-github/working-with-ssh-key-passphrases#auto-launching-ssh-agent-on-git-for-windows">a guide on how to start <code>ssh-agent</code> whenever you open Git Bash</a>.
To verify that <code>ssh-agent</code> is running on your computer, type the following command in the terminal:
<code>$ echo "$SSH_AUTH_SOCK"
# Print out the SSH_AUTH_SOCK variable
> /tmp/launch-kNSlgU/Listeners</code>
<h3>&emsp;&emsp;Your key must be available to <code>ssh-agent</code></h3>
You can check that your key is visible to <code>ssh-agent</code> by running the following command:
<code>ssh-add -L</code>
If the command says that no identity is available, you'll need to add your key:
<code>$ ssh-add YOUR-KEY</code>
On macOS, <code>ssh-agent</code> will "forget" this key, once it gets restarted during reboots. 
But you can import your SSH keys into Keychain using this command:
<code>$ ssh-add --apple-use-keychain YOUR-KEY</code>
For MacOS versions prior to Monterey (12.0), use <code>-K</code> instead of <code>--apple-use-keychain</code>. 
<h2><span class="orange">Managing deploy keys</span></h2>
Learn different ways to manage SSH keys on your servers when you automate deployment scripts and which way is best for you.
You can manage SSH keys on your servers when automating deployment scripts using SSH agent forwarding, HTTPS with OAuth tokens, deploy keys, or machine users.
<h2>&emsp;SSH agent forwarding</h2>
In many cases, especially in the beginning of a project, SSH agent forwarding is the quickest and simplest method to use. 
Agent forwarding uses the same SSH keys that your local development computer uses.
<b>&emsp;&emsp;Pros of SSH agent forwarding</b>

You do not have to generate or keep track of any new keys.
There is no key management; users have the same permissions on the server that they do locally.
No keys are stored on the server, so in case the server is compromised, you don't need to hunt down and remove the compromised keys.

<b>&emsp;&emsp;Cons of SSH agent forwarding</b>

Users <strong>must</strong> SSH in to deploy; automated deploy processes can't be used.
SSH agent forwarding can be troublesome to run for Windows users.

<h3>&emsp;&emsp;Set up SSH agent forwarding</h3>
Turn on agent forwarding locally. 
See <a href="/en/guides/using-ssh-agent-forwarding">our guide on SSH agent forwarding</a> for more information.
Set your deploy scripts to use agent forwarding. 
For example, on a bash script, enabling agent forwarding would look something like this:
<code>ssh -A serverA 'bash -s' &#x3C; deploy.sh</code>
<h2>&emsp;HTTPS cloning with OAuth tokens</h2>
If you don't want to use SSH keys, you can use HTTPS with OAuth tokens.
<b>&emsp;&emsp;Pros of HTTPS cloning with OAuth tokens</b>

Anyone with access to the server can deploy the repository.
Users don't have to change their local SSH settings.
Multiple tokens (one for each user) are not needed; one token per server is enough.
A token can be revoked at any time, turning it essentially into a one-use password.

<b>&emsp;&emsp;Cons of HTTPS cloning with OAuth tokens</b>

You must make sure that you configure your token with the correct access scopes.
Tokens are essentially passwords, and must be protected the same way.

<h3>&emsp;&emsp;Set up HTTPS cloning with OAuth tokens</h3>
See <a href="/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token">our guide on creating a personal access token</a>.
<h2>&emsp;Deploy keys</h2>
You can launch projects from a repository on GitHub.com to your server by using a deploy key, which is an SSH key that grants access to a single repository. 
GitHub attaches the public part of the key directly to your repository instead of a personal account, and the private part of the key remains on your server. 
Deploy keys with write access can perform the same actions as an organization member with admin access, or a collaborator on a personal repository. 
<b>&emsp;&emsp;Pros of deploy keys</b>

Anyone with access to the repository and server has the ability to deploy the project.
Users don't have to change their local SSH settings.
Deploy keys are read-only by default, but you can give them write access when adding them to a repository.

<b>&emsp;&emsp;Cons of deploy keys</b>

Deploy keys only grant access to a single repository. 
More complex projects may have many repositories to pull to the same server.
Deploy keys are usually not protected by a passphrase, making the key easily accessible if the server is compromised.

<h3>&emsp;&emsp;Set up deploy keys</h3>
<a href="/en/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/#generating-a-new-ssh-key">Run the <code>ssh-keygen</code> procedure</a> on your server, and remember where you save the generated public and private rsa key pair.
On GitHub.com, navigate to the main page of the repository.
Under your repository name, click  <strong>Settings</strong>. 
If you cannot see the "Settings" tab, select the <strong></strong> dropdown menu, then click <strong>Settings</strong>.
<picture><source srcset="/assets/cb-60526/mw-1000/images/help/repository/repo-actions-settings.webp" type="image/webp"><img src="/assets/cb-60526/images/help/repository/repo-actions-settings.png" alt="Screenshot of a repository header showing the tabs. 
The &#x22;Settings&#x22; tab is highlighted by a dark orange outline."></picture>
In the sidebar, click <strong>Deploy Keys</strong>.
Click <strong>Add deploy key</strong>.
In the "Title" field, provide a title.
In the "Key" field, paste your public key.
Select <strong>Allow write access</strong> if you want this key to have write access to the repository. 
A deploy key with write access lets a deployment push to the repository.
Click <strong>Add key</strong>.
<h3>&emsp;&emsp;Using multiple repositories on one server</h3>
If you use multiple repositories on one server, you will need to generate a dedicated key pair for each one. 
You can't reuse a deploy key for multiple repositories.
In the server's SSH configuration file (usually <code>~/.ssh/config</code>), add an alias entry for each repository. 
For example:
<code>Host github.com-repo-0
       Hostname github.com
       IdentityFile=/home/user/.ssh/repo-0_deploy_key
Host github.com-repo-1
       Hostname github.com
       IdentityFile=/home/user/.ssh/repo-1_deploy_key</code>

<code>Host github.com-repo-0</code> - The repository's alias.
<code>Hostname github.com</code> - Configures the hostname to use with the alias.
<code>IdentityFile=/home/user/.ssh/repo-0_deploy_key</code> - Assigns a private key to the alias.

You can then use the hostname's alias to interact with the repository using SSH, which will use the unique deploy key assigned to that alias. 
For example:
<code>$ git <span>clone</span> git@github.com-repo-1:OWNER/repo-1.git</code>
<h2>&emsp;GitHub App installation access tokens</h2>
If your server needs to access repositories across one or more organizations, you can use a GitHub App to define the access you need, and then generate <em>tightly-scoped</em>, installation access tokens from that GitHub App. 
The installation access tokens can be scoped to single or multiple repositories, and can have fine-grained permissions. 
For example, you can generate a token with read-only access to a repository's contents.
Since GitHub Apps are a first class actor on  GitHub, the installation access tokens are decoupled from any GitHub user, which makes them comparable to "service tokens". 
Additionally, installation access tokens have dedicated rate limits that scale with the size of the organizations that they act upon. 
<b>&emsp;&emsp;Pros of installation access tokens</b>

Tightly-scoped tokens with well-defined permission sets and expiration times (1 hour, or less if revoked manually using the API).
Dedicated rate limits that grow with your organization.
Decoupled from GitHub user identities, so they do not consume any licensed seats.
Never granted a password, so cannot be directly signed in to.

<b>&emsp;&emsp;Cons of installation access tokens</b>

Additional setup is needed to create the GitHub App.
Installation access tokens expire after 1 hour, and so need to be re-generated, typically on-demand using code.

<h3>&emsp;&emsp;Set up installation access tokens</h3>
Determine if your GitHub App should be public or private. 
If your GitHub App will only act on repositories within your organization, you likely want it private.
Determine the permissions your GitHub App requires, such as read-only access to repository contents.
Create your GitHub App via your organization's settings page. 
Note your GitHub App <code>id</code>.
Generate and download your GitHub App's private key, and store this safely. 
Install your GitHub App on the repositories it needs to act upon, optionally you may install the GitHub App on all repositories in your organization.
Identify the <code>installation_id</code> that represents the connection between your GitHub App and the organization repositories it can access. 
Each GitHub App and organization pair have at most a single <code>installation_id</code>. 
You can identify this <code>installation_id</code> via <a href="/en/rest/apps#get-an-organization-installation-for-the-authenticated-app">Get an organization installation for the authenticated app</a>. 
This requires authenticating as a GitHub App using a JWT, for more information see <a href="/en/apps/creating-github-apps/authenticating-with-a-github-app/authenticating-as-a-github-app">Authenticating as a GitHub App</a>.
Generate an installation access token using the corresponding REST API endpoint, <a href="/en/rest/apps#create-an-installation-access-token-for-an-app">Create an installation access token for an app</a>. 
This requires authenticating as a GitHub App using a JWT, for more information see <a href="/en/apps/creating-github-apps/authenticating-with-a-github-app/authenticating-as-a-github-app">Authenticating as a GitHub App</a>, and <a href="/en/apps/creating-github-apps/authenticating-with-a-github-app/authenticating-as-a-github-app-installation">Authenticating as an installation</a>.
Use this installation access token to interact with your repositories, either via the REST or GraphQL APIs, or via a Git client.
<h2>&emsp;Machine users</h2>
If your server needs to access multiple repositories, you can create a new account on GitHub.com and attach an SSH key that will be used exclusively for automation. 
Since this account on GitHub.com won't be used by a human, it's called a <em>machine user</em>. 
You can add the machine user as a <a href="/en/articles/inviting-collaborators-to-a-personal-repository">collaborator</a> on a personal repository (granting read and write access), as an <a href="/en/articles/adding-outside-collaborators-to-repositories-in-your-organization">outside collaborator</a> on an organization repository (granting read, write, or admin access), or to a <a href="/en/articles/adding-organization-members-to-a-team">team</a> with access to the repositories it needs to automate (granting the permissions of the team).
<strong>Tip:</strong> Our <a href="/en/github/site-policy/github-terms-of-service">terms of service</a> state:
<blockquote>
<em>Accounts registered by "bots" or other automated methods are not permitted.</em>
</blockquote>
This means that you cannot automate the creation of accounts. 
But if you want to create a single machine user for automating tasks such as deploy scripts in your project or organization, that is totally cool.
<b>&emsp;&emsp;Pros of machine users</b>

Anyone with access to the repository and server has the ability to deploy the project.
No (human) users need to change their local SSH settings.
Multiple keys are not needed; one per server is adequate.

<b>&emsp;&emsp;Cons of machine users</b>

Only organizations can restrict machine users to read-only access. 
Personal repositories always grant collaborators read/write access.
Machine user keys, like deploy keys, are usually not protected by a passphrase.

<h3>&emsp;&emsp;Set up machine users</h3>
<a href="/en/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/#generating-a-new-ssh-key">Run the <code>ssh-keygen</code> procedure</a> on your server and attach the public key to the machine user account.
Give the machine user account access to the repositories you want to automate. 
You can do this by adding the account as a <a href="/en/articles/inviting-collaborators-to-a-personal-repository">collaborator</a>, as an <a href="/en/articles/adding-outside-collaborators-to-repositories-in-your-organization">outside collaborator</a>, or to a <a href="/en/articles/adding-organization-members-to-a-team">team</a> in an organization.
<h2><span class="orange">Checking for existing SSH keys</span></h2>
Before you generate an SSH key, you can check to see if you have any existing SSH keys.
<h2>&emsp;About SSH keys</h2>
You can use SSH to perform Git operations in repositories on GitHub.com. 
If you have an existing SSH key, you can use the key to authenticate Git operations over SSH.
<h2>&emsp;Checking for existing SSH keys</h2>
Before you generate a new SSH key, you should check your local machine for existing keys.
<strong>Note:</strong> GitHub improved security by dropping older, insecure key types on March 15, 2022.
As of that date, DSA keys (<code>ssh-dss</code>) are no longer supported. 
You cannot add new DSA keys to your personal account on GitHub.com.
RSA keys (<code>ssh-rsa</code>) with a <code>valid_after</code> before November 2, 2021 may continue to use any signature algorithm. 
RSA keys generated after that date must use a SHA-2 signature algorithm. 
Some older clients may need to be upgraded in order to use SHA-2 signatures.
Open <span>Terminal</span><span>Terminal</span><span>Git Bash</span>.
Enter <code>ls -al ~/.ssh</code> to see if existing SSH keys are present.
<code>$ ls -al ~/.ssh
# Lists the files in your .ssh directory, if they exist</code>
Check the directory listing to see if you already have a public SSH key. 
By default, the filenames of supported public keys for GitHub are one of the following.

<em>id_rsa.pub</em>
<em>id_ecdsa.pub</em>
<em>id_ed25519.pub</em>

<strong>Tip</strong>: If you receive an error that <em>~/.ssh</em> doesn't exist, you do not have an existing SSH key pair in the default location. 
You can create a new SSH key pair in the next step.
Either generate a new SSH key or upload an existing key.

If you don't have a supported public and private key pair, or don't wish to use any that are available, generate a new SSH key.
If you see an existing public and private key pair listed (for example, <em>id_rsa.pub</em> and <em>id_rsa</em>) that you would like to use to connect to GitHub, you can add the key to the ssh-agent.
For more information about generation of a new SSH key or addition of an existing key to the ssh-agent, see "<a href="/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generating a new SSH key and adding it to the ssh-agent</a>."
<h2><span class="orange">Generating a new SSH key and adding it to the ssh-agent</span></h2>
After you've checked for existing SSH keys, you can generate a new SSH key to use for authentication, then add it to the ssh-agent.
<h2>&emsp;About SSH key passphrases</h2>
You can access and write data in repositories on GitHub.com using SSH (Secure Shell Protocol). 
When you connect via SSH, you authenticate using a private key file on your local machine. 
When you generate an SSH key, you can add a passphrase to further secure the key. 
Whenever you use the key, you must enter the passphrase. 
If your key has a passphrase and you don't want to enter the passphrase every time you use the key, you can add your key to the SSH agent. 
The SSH agent manages your SSH keys and remembers your passphrase.
If you don't already have an SSH key, you must generate a new SSH key to use for authentication. 
If you're unsure whether you already have an SSH key, you can check for existing keys. 
If you want to use a hardware security key to authenticate to GitHub, you must generate a new SSH key for your hardware security key. 
You must connect your hardware security key to your computer when you authenticate with the key pair. 
<h2>&emsp;Generating a new SSH key</h2>
You can generate a new SSH key on your local machine. 
After you generate the key, you can add the key to your account on GitHub.com to enable authentication for Git operations over SSH.
<strong>Note:</strong> GitHub improved security by dropping older, insecure key types on March 15, 2022.
As of that date, DSA keys (<code>ssh-dss</code>) are no longer supported. 
You cannot add new DSA keys to your personal account on GitHub.com.
RSA keys (<code>ssh-rsa</code>) with a <code>valid_after</code> before November 2, 2021 may continue to use any signature algorithm. 
RSA keys generated after that date must use a SHA-2 signature algorithm. 
Some older clients may need to be upgraded in order to use SHA-2 signatures.
Open <span>Terminal</span><span>Terminal</span><span>Git Bash</span>.
Paste the text below, substituting in your GitHub email address.
  <code>$ ssh-keygen -t ed25519 -C "your_email@example.com"</code>
  
  <strong>Note:</strong> If you are using a legacy system that doesn't support the Ed25519 algorithm, use:
  <code>$ ssh-keygen -t rsa -b 4096 -C "your_email@example.com"</code>
  
  This creates a new SSH key, using the provided email as a label.
  <code>> Generating public/private ALGORITHM key pair.</code>
When you're prompted to "Enter a file in which to save the key", you can press <strong>Enter</strong> to accept the default file location. 
Please note that if you created SSH keys previously, ssh-keygen may ask you to rewrite another key, in which case we recommend creating a custom-named SSH key. 
To do so, type the default file location and replace id_ssh_keyname with your custom key name.
  
  <code>> Enter a file in which to save the key (/Users/YOU/.ssh/id_ALGORITHM: [Press enter]</code>
  
  
  <code>> Enter a file in which to save the key (/c/Users/YOU/.ssh/id_ALGORITHM):[Press enter]</code>
  
  
  <code>> Enter a file in which to save the key (/home/YOU/.ssh/ALGORITHM):[Press enter]</code>
  
At the prompt, type a secure passphrase. 
<code>> Enter passphrase (empty for no passphrase): [Type a passphrase]
> Enter same passphrase again: [Type passphrase again]</code>
<h2>&emsp;Adding your SSH key to the ssh-agent</h2>
Before adding a new SSH key to the ssh-agent to manage your keys, you should have checked for existing SSH keys and generated a new SSH key. 
<span>When adding your SSH key to the agent, use the default macOS <code>ssh-add</code> command, and not an application installed by <a href="https://www.macports.org/">macports</a>, <a href="http://brew.sh/">homebrew</a>, or some other external source.</span>
Start the ssh-agent in the background. 
<code>$ eval "$(ssh-agent -s)"
> Agent pid 59566</code>
Depending on your environment, you may need to use a different command. 
For example, you may need to use root access by running <code>sudo -s -H</code> before starting the ssh-agent, or you may need to use <code>exec ssh-agent bash</code> or <code>exec ssh-agent zsh</code> to run the ssh-agent.
If you're using macOS Sierra 10.12.2 or later, you will need to modify your <code>~/.ssh/config</code> file to automatically load keys into the ssh-agent and store passphrases in your keychain.

First, check to see if your <code>~/.ssh/config</code> file exists in the default location.
<code>$ open ~/.ssh/config
> The file /Users/YOU/.ssh/config does not exist.</code>
If the file doesn't exist, create the file.
<code>$ touch ~/.ssh/config</code>
Open your <code>~/.ssh/config</code> file, then modify the file to contain the following lines. 
If your SSH key file has a different name or path than the example code, modify the filename or path to match your current setup.
<code>Host github.com
 AddKeysToAgent yes
 UseKeychain yes
 IdentityFile ~/.ssh/id_ed25519</code>
<strong>Notes:</strong>

If you chose not to add a passphrase to your key, you should omit the <code>UseKeychain</code> line.
If you see a <code>Bad configuration option: usekeychain</code> error, add an additional line to the configuration's' <code>Host *.github.com</code> section.
<code>Host github.com
 IgnoreUnknown UseKeychain</code>


Add your SSH private key to the ssh-agent and store your passphrase in the keychain. 
If you created your key with a different name, or if you are adding an existing key that has a different name, replace <em>id_ed25519</em> in the command with the name of your private key file.
<code>$ ssh-add --apple-use-keychain ~/.ssh/id_ed25519</code>
<strong>Note:</strong> The <code>--apple-use-keychain</code> option stores the passphrase in your keychain for you when you add an SSH key to the ssh-agent. 
If you chose not to add a passphrase to your key, run the command without the <code>--apple-use-keychain</code> option.
The <code>--apple-use-keychain</code> option is in Apple's standard version of <code>ssh-add</code>. 
In MacOS versions prior to Monterey (12.0), the <code>--apple-use-keychain</code> and <code>--apple-load-keychain</code> flags used the syntax <code>-K</code> and <code>-A</code>, respectively.
If you don't have Apple's standard version of <code>ssh-add</code> installed, you may receive an error. 

Add the SSH key to your account on GitHub. 
If you have <a href="https://desktop.github.com/">GitHub Desktop</a> installed, you can use it to clone repositories and not deal with SSH keys.
Ensure the ssh-agent is running. 
You can use the "Auto-launching the ssh-agent" instructions in "<a href="/en/articles/working-with-ssh-key-passphrases">Working with SSH key passphrases</a>", or start it manually:
<code># start the ssh-agent in the background
$ eval "$(ssh-agent -s)"
> Agent pid 59566</code>
Add your SSH private key to the ssh-agent. 
If you created your key with a different name, or if you are adding an existing key that has a different name, replace <em>id_ed25519</em> in the command with the name of your private key file.
<code>$ ssh-add ~/.ssh/id_ed25519</code>
Add the SSH key to your account on GitHub. 
Start the ssh-agent in the background. 
<code>$ eval "$(ssh-agent -s)"
> Agent pid 59566</code>
Depending on your environment, you may need to use a different command. 
For example, you may need to use root access by running <code>sudo -s -H</code> before starting the ssh-agent, or you may need to use <code>exec ssh-agent bash</code> or <code>exec ssh-agent zsh</code> to run the ssh-agent.
Add your SSH private key to the ssh-agent. 
If you created your key with a different name, or if you are adding an existing key that has a different name, replace <em>id_ed25519</em> in the command with the name of your private key file.
<code>$ ssh-add ~/.ssh/id_ed25519</code>
Add the SSH key to your account on GitHub. 
<h2>&emsp;Generating a new SSH key for a hardware security key</h2>
If you are using macOS or Linux, you may need to update your SSH client or install a new SSH client prior to generating a new SSH key. 
Insert your hardware security key into your computer.
Open <span>Terminal</span><span>Terminal</span><span>Git Bash</span>.
Paste the text below, substituting in the email address for your account on GitHub.
<code>$ ssh-keygen -t ed25519-sk -C "YOUR_EMAIL"</code>
<strong>Note:</strong> If the command fails and you receive the error <code>invalid format</code> or <code>feature not supported,</code> you may be using a hardware security key that does not support the Ed25519 algorithm. 
Enter the following command instead.
<code>$ ssh-keygen -t ecdsa-sk -C "your_email@example.com"</code>
When you are prompted, touch the button on your hardware security key.
When you are prompted to "Enter a file in which to save the key," press Enter to accept the default file location.
<code>> Enter a file in which to save the key (/Users/YOU/.ssh/id_ed25519_sk): [Press enter]</code>
<code>> Enter a file in which to save the key (/c/Users/YOU/.ssh/id_ed25519_sk):[Press enter]</code>
<code>> Enter a file in which to save the key (/home/YOU/.ssh/id_ed25519_sk):[Press enter]</code>
When you are prompted to type a passphrase, press <strong>Enter</strong>.
<code>> Enter passphrase (empty for no passphrase): [Type a passphrase]
> Enter same passphrase again: [Type passphrase again]</code>
Add the SSH key to your account on GitHub. 
<h2><span class="orange">Adding a new SSH key to your GitHub account</span></h2>
To configure your account on GitHub.com to use your new (or existing) SSH key, you'll also need to add the key to your account.
<h2>&emsp;About addition of SSH keys to your account</h2>
You can access and write data in repositories on GitHub.com using SSH (Secure Shell Protocol). 
When you connect via SSH, you authenticate using a private key file on your local machine. 
You can also use SSH to sign commits and tags. 
For more information about commit signing, see "<a href="/en/authentication/managing-commit-signature-verification/about-commit-signature-verification">About commit signature verification</a>."
After you generate an SSH key pair, you must add the public key to GitHub.com to enable SSH access for your account.
<h2>&emsp;Prerequisites</h2>
Before adding a new SSH key to your account on GitHub.com, complete the following steps.
Check for existing SSH keys. 
Generate a new SSH key and add it to your machine's SSH agent. 
<h2>&emsp;Adding a new SSH key to your account</h2>
After adding a new SSH authentication key to your account on GitHub.com, you can reconfigure any local repositories to use SSH. 
<strong>Note:</strong> GitHub improved security by dropping older, insecure key types on March 15, 2022.
As of that date, DSA keys (<code>ssh-dss</code>) are no longer supported. 
You cannot add new DSA keys to your personal account on GitHub.com.
RSA keys (<code>ssh-rsa</code>) with a <code>valid_after</code> before November 2, 2021 may continue to use any signature algorithm. 
RSA keys generated after that date must use a SHA-2 signature algorithm. 
Some older clients may need to be upgraded in order to use SHA-2 signatures.
Copy the SSH public key to your clipboard.
 If your SSH public key file has a different name than the example code, modify the filename to match your current setup. 
When copying your key, don't add any newlines or whitespace.
 <code>$ pbcopy &#x3C; ~/.ssh/id_ed25519.pub
 # Copies the contents of the id_ed25519.pub file to your clipboard</code>
 
 <strong>Tip:</strong> If <code>pbcopy</code> isn't working, you can locate the hidden <code>.ssh</code> folder, open the file in your favorite text editor, and copy it to your clipboard.
 
 <code>$ clip &#x3C; ~/.ssh/id_ed25519.pub
 # Copies the contents of the id_ed25519.pub file to your clipboard</code>
 
 <strong>Tip:</strong> With Windows Subsystem for Linux (WSL), you can use <code>clip.exe</code>. 
Otherwise if <code>clip</code> isn't working, you can locate the hidden <code>.ssh</code> folder, open the file in your favorite text editor, and copy it to your clipboard.
 
 <code>$ cat ~/.ssh/id_ed25519.pub
 # Then select and copy the contents of the id_ed25519.pub file
 # displayed in the terminal to your clipboard</code>
 
 <strong>Tip:</strong> Alternatively, you can locate the hidden <code>.ssh</code> folder, open the file in your favorite text editor, and copy it to your clipboard.
 
In the upper-right corner of any page, click your profile photo, then click <strong>Settings</strong>. 
<picture><source srcset="/assets/cb-139735/mw-1000/images/help/settings/userbar-account-settings.webp" type="image/webp"><img src="/assets/cb-139735/images/help/settings/userbar-account-settings.png" alt="Screenshot of GitHub&#x27;s account menu showing options for users to view and edit their profile, content, and settings. 
The menu item &#x22;Settings&#x22; is outlined in dark orange."></picture>
In the "Access" section of the sidebar, click <strong> SSH and GPG keys</strong>.
Click <strong>New SSH key</strong> or <strong>Add SSH key</strong>.
<picture><source srcset="/assets/cb-28257/mw-1000/images/help/settings/ssh-add-ssh-key-with-auth.webp" type="image/webp"><img src="/assets/cb-28257/images/help/settings/ssh-add-ssh-key-with-auth.png" alt="SSH Key button"></picture>
In the "Title" field, add a descriptive label for the new key. 
For example, if you're using a personal laptop, you might call this key "Personal laptop".
Select the type of key, either authentication or signing. 
For more information about commit signing, see "<a href="/en/authentication/managing-commit-signature-verification/about-commit-signature-verification">About commit signature verification</a>."
Paste your public key into the "Key" field.
<picture><source srcset="/assets/cb-47495/mw-1000/images/help/settings/ssh-key-paste-with-type.webp" type="image/webp"><img src="/assets/cb-47495/images/help/settings/ssh-key-paste-with-type.png" alt="The key field"></picture>
Click <strong>Add SSH key</strong>.
<picture><source srcset="/assets/cb-6592/mw-1000/images/help/settings/ssh-add-key.webp" type="image/webp"><img src="/assets/cb-6592/images/help/settings/ssh-add-key.png" alt="The Add key button"></picture>
If prompted, confirm access to your account on GitHub. 
To learn more about GitHub CLI, see "<a href="/en/github-cli/github-cli/about-github-cli">About GitHub CLI</a>."
Before you can use the GitHub CLI to add an SSH key to your account, you must authenticate to the GitHub CLI. 
At present, you can only use GitHub CLI to add SSH authentication keys, you cannot add SSH signing keys.
To add an SSH authentication key to your GitHub account, use the <code>ssh-key add</code> subcommand, specifying your public key.
<code>gh ssh-key add KEY-FILE</code>
To include a title for the new key, use the <code>-t</code> or <code>--title</code> flag.
<code>gh ssh-key add KEY-FILE --title "personal laptop"</code>
If you generated your SSH key by following the instructions in "<a href="/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generating a new SSH key and adding it to the ssh-agent</a>", you can add the key to your account with this command.
<code>gh ssh-key add ~/.ssh/id_ed25519.pub</code>
<h2><span class="orange">Testing your SSH connection</span></h2>
After you've set up your SSH key and added it to your account on GitHub.com, you can test your connection.
Before testing your SSH connection, you should have:
<a href="/en/authentication/connecting-to-github-with-ssh/checking-for-existing-ssh-keys">Checked for existing SSH keys</a>
<a href="/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generated a new SSH key</a>
<a href="/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account">Added a new SSH key to your GitHub account</a>
When you test your connection, you'll need to authenticate this action using your password, which is the SSH key passphrase you created earlier. 
For more information on working with SSH key passphrases, see "<a href="/en/authentication/connecting-to-github-with-ssh/working-with-ssh-key-passphrases">Working with SSH key passphrases</a>."
Open <span>Terminal</span><span>Terminal</span><span>Git Bash</span>.
Enter the following:
<code>$ ssh -T git@github.com
# Attempts to ssh to GitHub</code>
You may see a warning like this:
<code>> The authenticity of host 'github.com (IP ADDRESS)' can't be established.
> RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.
> Are you sure you want to continue connecting (yes/no)?</code>
Verify that the fingerprint in the message you see matches <a href="/en/authentication/keeping-your-account-and-data-secure/githubs-ssh-key-fingerprints">GitHub's public key fingerprint</a>. 
If it does, then type <code>yes</code>:
<code>> Hi USERNAME! You've successfully authenticated, but GitHub does not
> provide shell access.</code>
You may see this error message:
<code>...
Agent admitted failure to sign using the key.
debug1: No more authentication methods to try.
Permission denied (publickey).</code>
This is a known problem with certain Linux distributions. 

<strong>Note:</strong> The remote command should exit with code 1.

Verify that the resulting message contains your username. 
If you receive a "permission denied" message, see "<a href="/en/authentication/troubleshooting-ssh/error-permission-denied-publickey">Error: Permission denied (publickey)</a>."
<h2><span class="orange">Working with SSH key passphrases</span></h2>
In this article
About passphrases for SSH keys</span>
You can secure your SSH keys and configure an authentication agent so that you won't have to reenter your passphrase every time you use your SSH keys.
<h2>&emsp;About passphrases for SSH keys</h2>
With SSH keys, if someone gains access to your computer, the attacker can gain access to every system that uses that key. 
To add an extra layer of security, you can add a passphrase to your SSH key. 
To avoid entering the passphrase every time you connect, you can securely save your passphrase in the SSH agent.
<h2>&emsp;Adding or changing a passphrase</h2>
You can change the passphrase for an existing private key without regenerating the keypair by typing the following command:
<code>$ ssh-keygen -p -f ~/.ssh/id_ed25519
> Enter old passphrase: [Type old passphrase]
> Key has comment 'your_email@example.com'
> Enter new passphrase (empty for no passphrase): [Type new passphrase]
> Enter same passphrase again: [Repeat the new passphrase]
> Your identification has been saved with the new passphrase.</code>
If your key already has a passphrase, you will be prompted to enter it before you can change to a new passphrase.
<h2>&emsp;Auto-launching <code>ssh-agent</code> on Git for Windows</h2>
You can run <code>ssh-agent</code> automatically when you open bash or Git shell. 
Copy the following lines and paste them into your <code>~/.profile</code> or <code>~/.bashrc</code> file in Git shell:
<code><span>env</span>=~/.ssh/agent.env
<span><span>agent_load_env</span></span> () { <span>test</span> -f <span>"<span>$env</span>"</span> &#x26;&#x26; . 
<span>"<span>$env</span>"</span> >| /dev/null ; }
<span><span>agent_start</span></span> () {
   (<span>umask</span> 077; ssh-agent >| <span>"<span>$env</span>"</span>)
   . 
<span>"<span>$env</span>"</span> >| /dev/null ; }
agent_load_env
<span># agent_run_state: 0=agent running w/ key; 1=agent w/o key; 2=agent not running</span>
agent_run_state=$(ssh-add -l >| /dev/null 2>&#x26;1; <span>echo</span> $?)
<span>if</span> [ ! <span>"<span>$SSH_AUTH_SOCK</span>"</span> ] || [ <span>$agent_run_state</span> = 2 ]; <span>then</span>
   agent_start
   ssh-add
<span>elif</span> [ <span>"<span>$SSH_AUTH_SOCK</span>"</span> ] &#x26;&#x26; [ <span>$agent_run_state</span> = 1 ]; <span>then</span>
   ssh-add
<span>fi</span>
<span>unset</span> <span>env</span></code>
If your private key is not stored in one of the default locations (like <code>~/.ssh/id_rsa</code>), you'll need to tell your SSH authentication agent where to find it. 
To add your key to ssh-agent, type <code>ssh-add ~/path/to/my_key</code>. 
<strong>Tip:</strong> If you want <code>ssh-agent</code> to forget your key after some time, you can configure it to do so by running <code>ssh-add -t &#x3C;seconds></code>.
Now, when you first run Git Bash, you are prompted for your passphrase:
<code>> Initializing new SSH agent...
> succeeded
> Enter passphrase for /c/Users/YOU/.ssh/id_rsa:
> Identity added: /c/Users/YOU/.ssh/id_rsa (/c/Users/YOU/.ssh/id_rsa)
> Welcome to Git (version 1.6.0.2-preview20080923)
>
> Run 'git help git' to display the help index.
> Run 'git help <command>' to display help for specific commands.</command></code>
The <code>ssh-agent</code> process will continue to run until you log out, shut down your computer, or kill the process.
<h2>&emsp;Saving your passphrase in the keychain</h2>
On Mac OS X Leopard through OS X El Capitan, these default private key files are handled automatically:

<em>.ssh/id_rsa</em>
<em>.ssh/identity</em>

The first time you use your key, you will be prompted to enter your passphrase. 
If you choose to save the passphrase with your keychain, you won't have to enter it again.
Otherwise, you can store your passphrase in the keychain when you add your key to the ssh-agent. 








</script>

<script src='https://williamkpchan.github.io/LibDocs/readbook.js'></script>
<script>
var lazyLoadInstance = new LazyLoad({
 elements_selector: ".lazy"
});
</script>

</body></html>
