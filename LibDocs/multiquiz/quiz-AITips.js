// Science Quiz Data
window.quizData = [
'<h2>开源的文本到图像模型</h2>	<center><div id="文本到图像toc" class="toc"><a href="#文本到图像topic-0" target="_self">开源文本到图像模型</a><br><a href="#文本到图像topic-1" target="_self"> 1. FLUX</a><br><a href="#文本到图像topic-2" target="_self"> 2. RPG</a><br><a href="#文本到图像topic-3" target="_self"> 3. 混元文生图大模型</a><br><a href="#文本到图像topic-4" target="_self">使用R语言生成图像的方法</a><br><a href="#文本到图像topic-5" target="_self"> 1. 安装相关包</a><br><a href="#文本到图像topic-6" target="_self"> 2. 加载预训练模型</a><br><a href="#文本到图像topic-7" target="_self"> 3. 准备输入文本</a><br><a href="#文本到图像topic-8" target="_self"> 4. 生成图像</a><br><a href="#文本到图像topic-9" target="_self"> 5. 后处理与保存图像</a><br><a href="#文本到图像topic-10" target="_self">注意事项</a><br></div></center><br><br>\n有多个开源的文本到图像模型可供使用。\n以下是一些流行的模型及其使用R语言生成图像的方法：\n<h3 id="文本到图像topic-0">开源文本到图像模型</h3>\n<o id="文本到图像topic-1"> 1. FLUX</o>\n特点：拥有120亿参数的高性能模型，提供高质量图像生成，包括先进的人体解剖学和照片真实感。\n版本：\nFLUX.1 (dev)：开源非商业版本，可从Hugging Face和GitHub下载。\nFLUX.1 (schnell)：开源精简版，运行速度提升最高10倍。\n<o id="文本到图像topic-2"> 2. RPG</o>\n特点：由Pika Labs、北京大学和斯坦福大学研发，采用多模态大语言模型（MLLM）技术，解决复杂文本提示下图像生成的语义一致性和细节还原问题。\n优势：在多对象合成、属性绑定等场景下表现优异，支持文本、轮廓图、深度图等多模态输入。\n代码：可在GitHub上获取预训练模型权重和技术文档。\n<o id="文本到图像topic-3"> 3. 混元文生图大模型</o>\n特点：腾讯自研的开源多模态生成模型，基于DiT架构，支持文本生成图像和视频，具备中英文细粒度理解能力。\n版本：\n混元图像2.0：实现毫秒级实时生图，支持超写实画质生成。\n资源：模型权重、推理代码和训练代码已在Hugging Face平台和GitHub上开源。\n<h3 id="文本到图像topic-4">使用R语言生成图像的方法</h3>\n<o id="文本到图像topic-5"> 1. 安装相关包</o>\n根据所选模型，安装相应的R包，如tensorflow、keras、torch等，用于与深度学习模型进行交互。\n安装图像处理包，如magick、png、jpeg等，用于图像的读取、处理和保存。\n<o id="文本到图像topic-6"> 2. 加载预训练模型</o>\n下载模型的权重文件和相关配置文件。\n使用相应的R包函数加载模型，例如：\nlibrary(tensorflow)\nmodel &lt;- load_model_hdf5("path/to/model.h5")\n\n<o id="文本到图像topic-7"> 3. 准备输入文本</o>\n将待生成的文本进行预处理，如分词、编码等，使其符合模型的输入要求。\n部分模型可能需要将文本转换为张量形式。\n<o id="文本到图像topic-8"> 4. 生成图像</o>\n调用模型的预测函数，传入预处理后的文本数据，生成图像张量。\n例如：\nimage_tensor &lt;- predict(model, text_tensor)\n\n<o id="文本到图像topic-9"> 5. 后处理与保存图像</o>\n将生成的图像张量转换为R中的图像对象。\n使用图像处理包对图像进行后处理，如调整大小、格式转换等。\n保存图像到本地文件，例如：\nlibrary(magick)\nimage &lt;- image_read(image_tensor)\nimage_write(image, "generated_image.png")\n\n<h3 id="文本到图像topic-10">注意事项</h3>\n不同的模型可能有不同的输入格式和输出要求，需要根据具体模型的文档进行调整。\n生成高质量的图像可能需要较高的计算资源和时间，特别是在处理复杂文本或大尺寸图像时。\n在使用开源模型时，请遵守相应的许可协议和使用条款。\n\n通过以上步骤，你可以使用R语言调用开源的文本到图像模型生成图像。选择合适的模型和相应的R包，按照模型的要求进行文本预处理和图像后处理，即可实现文本到图像的转换。\n',
'<h2>Open Source Text-to-Image Models &amp; Image Generation in R</h2>	<center><div id="ImageGenerationtoc" class="toc"><a href="#ImageGenerationtopic-0" target="_self">Popular Open-Source Text-to-Image Models</a><br><a href="#ImageGenerationtopic-1" target="_self"> AI Model Landscape</a><br><a href="#ImageGenerationtopic-2" target="_self">Generating Images in R: Examples</a><br><a href="#ImageGenerationtopic-3" target="_self"> R Image Generation Tools</a><br><a href="#ImageGenerationtopic-4" target="_self">Summary</a><br></div></center><br><br>\nGenerate images using R, primarily through packages that interface with powerful AI models or provide image processing capabilities.\n\n<h3 id="ImageGenerationtopic-0">Popular Open-Source Text-to-Image Models</h3>\nHere are some of the most widely discussed open-source text-to-image models:\n\n<o id="ImageGenerationtopic-1"> AI Model Landscape</o>\nStable Diffusion\nThe most popular open-source model, with variants like SD 1.5 and SDXL.\n\nFLUX\nA newer model gaining popularity, known for its efficiency and quality.\n\nPony\nA niche model, though its development status is uncertain.\n\n- Stable Diffusion\nThis is currently the most popular open-source text-to-image model. It has several variants, such as Stable Diffusion 1.5 and Stable Diffusion XL (SDXL), which offer different levels of detail and artistic styles. These models can be run locally on your machine with sufficient computational resources or accessed through various APIs and user interfaces.\n- FLUX\nAnother model that has been gaining attention in the community. It\'s mentioned as a contender in terms of popularity and image quality, though the exact details about its architecture and performance are not specified in the available information.\n- Pony\nA free, open-source text-to-image model that was previously discussed in the community. However, the development status of Pony (e.g., Ponyv7) is uncertain and may not be actively maintained.\nNote: While these models are open-source, generating images from them typically requires significant technical setup, including installing the model weights, dependencies, and often a compatible deep learning framework like PyTorch or TensorFlow.\n\n<h3 id="ImageGenerationtopic-2">Generating Images in R: Examples</h3>\nR provides several packages for image processing and generation. Below are examples demonstrating both creating images from scratch and manipulating existing ones.\n\n1. Using `magick` for Image Processing\nThe `magick` package is a powerful toolkit for image processing in R, wrapping the comprehensive ImageMagick library. While it doesn\'t generate images from text, it\'s excellent for manipulating and creating images programmatically.\n# Install and load the package\ninstall.packages("magick")\nlibrary(magick)\n\n# Create a simple image (e.g., a red rectangle)\nimg &lt;- image_blank(width = 200, height = 100, color = "white")\nimg &lt;- image_draw(img, type = "rectangle", x1 = 10, y1 = 10, x2 = 190, y2 = 90, \n                  color = "red", fill = "red")\n\n# Save the image\nimage_write(img, path = "red_rectangle.png")\n2. Using Base R Graphics for Simple Image Generation\nR\'s base plotting system can also be used to generate simple images or visualizations. Here\'s an example of creating a "thermometer" image using colored rectangles. \n\nR\n# Set up the PNG device to save the image\npng(filename = "thermometer.png", width = 5, height = 15, units = "cm", res = 300)\n\n# Create a plot with no axes or labels\nplot(x = NULL, y = NULL, type = "n", axes = FALSE, xlab = "", ylab = "",\n     xlim = c(0, 51), ylim = c(0, 450))\n\n# Draw colored rectangles to form the thermometer\nrect(0, 0, 50, 148, col = "red", border = "transparent")\nrect(0, 148, 50, 225, col = "orange", border = "transparent")\nrect(0, 225, 50, 297, col = "gold", border = "transparent")\nrect(0, 297, 50, 360, col = "lightgreen", border = "transparent")\nrect(0, 360, 50, 450, col = "darkgreen", border = "transparent")\n\n# Close the device\ndev.off()\n<o id="ImageGenerationtopic-3"> R Image Generation Tools</o>\nmagick Advanced Processing\nBase Graphics Simple Creation\nAI APIs Text-to-Image\n3. Using AI APIs for Text-to-Image Generation\nSeveral AI models that offer text-to-image capabilities have R packages or APIs that allow you to generate images directly from R code. These typically require API keys or subscriptions.\n- ChatGPT / GPT-4o: OpenAI\'s models, particularly GPT-4o, have multimodal capabilities, including vision understanding and image generation. You can use them through the `openai` R package.\n- Gemini: Google\'s AI model that can process and generate various data types, including images. It\'s available via the `googleai` R package.\n- Shakker: A platform that allows you to turn your imagination into images with features like style transformation and precise editing tools.\n<h3 id="ImageGenerationtopic-4">Summary</h3>\nTo summarize, while there are robust open-source text-to-image models like Stable Diffusion and FLUX, directly generating images from text in R typically involves either:\n- Using R packages that interface with AI APIs (e.g., `openai`, `googleai`), which is the most straightforward method if you have access to the required services.\n- Setting up a local AI model (e.g., Stable Diffusion), which is more complex but offers greater control and privacy.\nFor basic image creation and manipulation within R, the `magick` package and R\'s base graphics are powerful tools. \n\n"The future of AI is not just about generating images, but about empowering everyone to create with code."\n—— AI Researcher\n',
'<h2>to fine longest strings</h2>	t2i = readLines("D:/Dropbox/Public/LibDocs/t2i.js")\nt2inchar <- nchar(t2i)\nlongest_indices <- order(nchar(t2i), decreasing = TRUE)[1:10]\n\n# print the summary\noutput <- paste("\nIndex:", longest_indices,\n                "\nLength:", nchar(t2i[longest_indices]),\n                "\nText:", t2i[longest_indices])\ncat(output, sep = "\n")\n\n# print the summary without index\ninvisible(sapply(t2i[longest_indices], function(x) {\n  cat("Length:", nchar(x), "\nText:", x, "\n\n")\n}))\n\n# print indices where nchar > 150\nlongest_indices <- order(nchar(t2i), decreasing = TRUE)\nfiltered_indices <- longest_indices[nchar(t2i[longest_indices]) > 150]\ncat("Total number > 150: ",length(filtered_indices), "\n")\n\n# Print results\nfor(idx in filtered_indices) {\n  cat("Index:", idx, \n      " Length:", nchar(t2i[idx]), \n      " Text:", t2i[idx], "\n")\n}\n',
'<h2>proverb</h2>	1、永不消失的9大行业：\n一、医院：不会消失，只会更多。\n二、修车店：永远要在实体店修。\n三、理发店：理发永远是人刚需。\n四、金融业：只要有人就离不开。\n五、物流：只要有网购，就有物流。\n六、药房：有医院的地方就有药店。\n七、教育业：有人就必须有教育。\n八、餐饮业：民以食为天，刚需。\n九、农业：没农业，就没有世界。\n哪个最离不开？\n\n2、人，往往在贪欲中失去幸福，在忙碌中失去健康，在怀疑中失去信任，在计较中失去友情。\n人不争，一身轻松；\n事不比，一路畅通；\n心不求，一生平静。\n每个人都有自己的活法，没必要去复制别人的生活。\n有的人表面风光，暗地里却不知流了多少眼泪。\n有的人看似生活窘迫，实际上却过得潇洒快活。\n幸福没有标准答案，快乐也不止一条道路。\n收回羡慕别人的目光，反观自己的内心。\n自己喜欢的日子，就是最好的日子；\n自己喜欢的活法，就是最好的活法。\n\n\n3、你买车了，发现有车也就那么回事；\n你买房了，发现有房子也并不稀奇，你好不容易当上老板了，才发现，员工比老板厉害多了；\n你以为荣归故里了，可村里都不屑搭理你。\n不是社会冷漠了，而是大家都活明白了，你好不好与他无关。\n所以不要总觉着别人都在注视你，人家根本就没空搭理你。\n\n\n4、世界上什么都不公平，唯独时间最公平，\n如果你整天这样，不读书不运动，不节制消费，不自律，无兴趣爱好，无目标期望，生活是不会变好的，\n努力不是为了得到更多，而是为了人生有更多的选择。\n努力的意义：\n大概就是当好运来临的时候，你觉得你值得。\n所以，从现在开始努力，一切还来得及，别在最好的年纪，辜负了最好的自己。\n\n5、一段让人深思的话：\n衣裳能少买就少买，饭食能少吃就少吃。\n老辈人传下句俗语：\n减衣添福，减食添寿。\n如今的人偏反其道而行，一味增衣加食，欲望不断膨胀，身体的负荷也跟着越发沉重。\n人要学着给生活做减法，省去多余的负担与开销，\n明白适可而止，福禄方能细水长流、绵延不绝，大道本就至简。\n修行的至高境界，正是低配生活、高配灵魂。\n懂得丰盈内心的人，才能活得更通透。\n',
'<h2>using javascript and sessionStorage to pass data to another webpage</h2>	\nfunction setData() {\n  // Store data in sessionStorage\n  sessionStorage.setItem(\'myData\', \'Hello from Page 1!\');\n  // Redirect to the next page\n  window.location.href = \'receiver.html\';\n}\n\nreceiver.html\n// Get data from sessionStorage\nconst receivedData = sessionStorage.getItem(\'myData\');\n\nif (receivedData) {\n  document.getElementById(\'display\').textContent = receivedData;\n  console.log(\'Received data:\', receivedData);\n  \n  // Optional: Clear the data after use\n  // sessionStorage.removeItem(\'myData\');\n} else {\n  document.getElementById(\'display\').textContent = \'No data received\';\n}\n',
'<h2>bluetooth protocols</h2>	<div id="bluetoothprotocolstoc" class="toc"><a href="#bluetoothprotocolstopic-0" target="_self">Web Bluetooth API Basics</a><br><a href="#bluetoothprotocolstopic-1" target="_self"> 1. Check Bluetooth Availability</a><br><a href="#bluetoothprotocolstopic-2" target="_self"> 2. Request Device and Discover Services (Protocols)</a><br><a href="#bluetoothprotocolstopic-3" target="_self"> 3. Common Bluetooth Protocols/Profiles and Their Service UUIDs</a><br><a href="#bluetoothprotocolstopic-4" target="_self"> 4. Browser Support and Limitations</a><br><a href="#bluetoothprotocolstopic-5" target="_self"> 5. Complete Example with UI</a><br><a href="#bluetoothprotocolstopic-6" target="_self">Alternative Approaches</a><br><a href="#bluetoothprotocolstopic-7" target="_self">Summary</a><br></div></center><br><br>\n<pre>Bluetooth devices support various protocols (profiles), but in JavaScript/Web Bluetooth API, you can\'t directly enumerate all available protocols on the current device. Instead, you can discover devices and see what services (which correspond to specific protocols/profiles) they offer.\n\n<h3 id="bluetoothprotocolstopic-0">Web Bluetooth API Basics</h3>\n\nThe Web Bluetooth API allows you to connect to Bluetooth Low Energy (BLE) devices and discover their services/characteristics.\n<o id="bluetoothprotocolstopic-1"> 1. Check Bluetooth Availability</o>\n\n// Check if Web Bluetooth is supported\nif (!navigator.bluetooth) {\n  console.log(\'Web Bluetooth API is not supported in this browser.\');\n  console.log(\'Use Chrome, Edge, Opera, or Android WebView.\');\n} else {\n  console.log(\'Web Bluetooth is supported!\');\n}\n<o id="bluetoothprotocolstopic-2"> 2. Request Device and Discover Services (Protocols)</o>\n\nasync function discoverBluetoothServices() {\n  try {\n    // Request a Bluetooth device with some common services\n    const device = await navigator.bluetooth.requestDevice({\n      acceptAllDevices: true,\n      optionalServices: [\n        \'battery_service\',\n        \'device_information\',\n        \'heart_rate\',\n        \'cycling_speed_and_cadence\',\n        // Add more service UUIDs as needed\n      ]\n    });\n\n    console.log(\'Device Name:\', device.name);\n    console.log(\'Device ID:\', device.id);\n\n    // Connect to the GATT server\n    const server = await device.gatt.connect();\n    \n    // Get all primary services\n    const services = await server.getPrimaryServices();\n    \n    console.log(\'\nAvailable Services (Protocols):\');\n    for (const service of services) {\n      console.log(`- ${service.uuid}: ${service.uuid.startsWith(\'0x\') ? \n        getServiceName(service.uuid) : \'Unknown Service\'}`);\n      \n      // Get characteristics for each service\n      const characteristics = await service.getCharacteristics();\n      characteristics.forEach(char =&gt; {\n        console.log(`  └─ Characteristic: ${char.uuid}`);\n      });\n    }\n    \n    // Don\'t forget to disconnect when done\n    // server.disconnect();\n    \n  } catch (error) {\n    console.error(\'Error:\', error);\n  }\n}\n\n// Helper function to map UUIDs to service names\nfunction getServiceName(uuid) {\n  const serviceMap = {\n    \'0x1800\': \'Generic Access\',\n    \'0x1801\': \'Generic Attribute\',\n    \'0x1802\': \'Immediate Alert\',\n    \'0x1803\': \'Link Loss\',\n    \'0x1804\': \'Tx Power\',\n    \'0x1805\': \'Current Time Service\',\n    \'0x1806\': \'Reference Time Update Service\',\n    \'0x1807\': \'Next DST Change Service\',\n    \'0x1808\': \'Glucose\',\n    \'0x1809\': \'Health Thermometer\',\n    \'0x180a\': \'Device Information\',\n    \'0x180d\': \'Heart Rate\',\n    \'0x180f\': \'Battery Service\',\n    \'0x1810\': \'Blood Pressure\',\n    \'0x1811\': \'Alert Notification Service\',\n    \'0x1812\': \'Human Interface Device\',\n    \'0x1813\': \'Scan Parameters\',\n    \'0x1814\': \'Running Speed and Cadence\',\n    \'0x1815\': \'Automation IO\',\n    \'0x1816\': \'Cycling Speed and Cadence\',\n    \'0x1818\': \'Cycling Power\',\n    \'0x1819\': \'Location and Navigation\',\n    \'0x181a\': \'Environmental Sensing\',\n    \'0x181b\': \'Body Composition\',\n    \'0x181c\': \'User Data\',\n    \'0x181d\': \'Weight Scale\',\n    \'0x181e\': \'Bond Management Service\',\n    \'0x181f\': \'Continuous Glucose Monitoring\',\n    \'0x1820\': \'Internet Protocol Support Service\',\n    \'0x1821\': \'Indoor Positioning\',\n    \'0x1822\': \'Pulse Oximeter Service\',\n    \'0x1823\': \'HTTP Proxy\',\n    \'0x1824\': \'Transport Discovery\',\n    \'0x1825\': \'Object Transfer Service\',\n    \'0x1826\': \'Fitness Machine\',\n    \'0x1827\': \'Mesh Provisioning Service\',\n    \'0x1828\': \'Mesh Proxy Service\',\n    \'0x1829\': \'Reconnection Configuration\',\n    \'0x183a\': \'Insulin Delivery\',\n    \'0x183b\': \'Binary Sensor\',\n    \'0x183c\': \'Emergency Configuration\',\n    \'0x183d\': \'Authorization Control\',\n    \'0x183e\': \'Physical Activity Monitor\',\n    \'0x183f\': \'Elapsed Time Service\',\n    \'0x1840\': \'Generic Health Sensor\',\n    \'0x1841\': \'Audio Input Control\',\n    \'0x1842\': \'Volume Control\',\n    \'0x1843\': \'Volume Offset Control\',\n    \'0x1844\': \'Coordinated Set Identification Service\',\n    \'0x1845\': \'Device Time\',\n    \'0x1846\': \'Media Control Service\',\n    \'0x1847\': \'Generic Media Control Service\',\n    \'0x1848\': \'Constant Tone Extension\',\n    \'0x1849\': \'Telephone Bearer Service\',\n    \'0x184a\': \'Generic Telephone Bearer Service\',\n    \'0x184b\': \'Microphone Control\',\n    \'0x184c\': \'Audio Stream Control Service\',\n    \'0x184d\': \'Broadcast Audio Scan Service\',\n    \'0x184e\': \'Published Audio Capabilities Service\',\n    \'0x184f\': \'Basic Audio Announcement Service\',\n    \'0x1850\': \'Broadcast Audio Announcement Service\',\n    \'0x1851\': \'Common Audio Service\',\n    \'0x1852\': \'Hearing Access Service\',\n    \'0x1853\': \'Telephony and Media Audio Service\',\n    \'0x1854\': \'Public Broadcast Announcement Service\',\n  };\n  \n  return serviceMap[uuid.toLowerCase()] || \'Unknown Service\';\n}\n<o id="bluetoothprotocolstopic-3"> 3. Common Bluetooth Protocols/Profiles and Their Service UUIDs</o>\n\nHere are some common Bluetooth profiles and their corresponding service UUIDs:\n\nconst bluetoothProfiles = {\n  // GATT Services (BLE)\n  \'Generic Access\': \'00001800-0000-1000-8000-00805f9b34fb\',\n  \'Generic Attribute\': \'00001801-0000-1000-8000-00805f9b34fb\',\n  \'Heart Rate\': \'0000180d-0000-1000-8000-00805f9b34fb\',\n  \'Battery Service\': \'0000180f-0000-1000-8000-00805f9b34fb\',\n  \'Device Information\': \'0000180a-0000-1000-8000-00805f9b34fb\',\n  \'Human Interface Device (HID)\': \'00001812-0000-1000-8000-00805f9b34fb\',\n  \'Running Speed and Cadence\': \'00001814-0000-1000-8000-00805f9b34fb\',\n  \'Cycling Speed and Cadence\': \'00001816-0000-1000-8000-00805f9b34fb\',\n  \'Cycling Power\': \'00001818-0000-1000-8000-00805f9b34fb\',\n  \n  // Classic Bluetooth profiles (not directly accessible via Web Bluetooth)\n  // These typically require different APIs or platform-specific access\n  \'A2DP\': \'Audio Distribution Profile\',  // For audio streaming\n  \'AVRCP\': \'Audio/Video Remote Control Profile\',\n  \'HFP\': \'Hands-Free Profile\',\n  \'HSP\': \'Headset Profile\',\n  \'PBAP\': \'Phone Book Access Profile\',\n  \'MAP\': \'Message Access Profile\',\n  \'SPP\': \'Serial Port Profile\',\n  \'HID\': \'Human Interface Device Profile\',\n  \'PAN\': \'Personal Area Networking\',\n  \'FTP\': \'File Transfer Profile\',\n  \'OPP\': \'Object Push Profile\',\n};\n\n// Function to scan for devices with specific profiles\nasync function scanForProfiles() {\n  const profileServices = {\n    \'Heart Rate Monitor\': [\'heart_rate\'],\n    \'Fitness Device\': [\'heart_rate\', \'cycling_speed_and_cadence\', \'cycling_power\'],\n    \'Smart Watch\': [\'battery_service\', \'device_information\', \'heart_rate\'],\n    \'Bluetooth HID\': [\'human_interface_device\'],\n  };\n  \n  for (const [deviceType, services] of Object.entries(profileServices)) {\n    console.log(`\nLooking for ${deviceType}...`);\n    \n    try {\n      const device = await navigator.bluetooth.requestDevice({\n        filters: [{ services }],\n        optionalServices: services\n      });\n      \n      console.log(`Found ${deviceType}: ${device.name}`);\n      \n      // Connect and verify services\n      const server = await device.gatt.connect();\n      const deviceServices = await server.getPrimaryServices();\n      \n      console.log(`Available services on ${device.name}:`);\n      deviceServices.forEach(service =&gt; {\n        console.log(`- ${service.uuid}`);\n      });\n      \n      server.disconnect();\n      \n    } catch (error) {\n      if (error.name !== \'NotFoundError\') {\n        console.error(`Error scanning for ${deviceType}:`, error);\n      }\n    }\n  }\n}\n<o id="bluetoothprotocolstopic-4"> 4. Browser Support and Limitations</o>\n\n**Important Limitations:**\n1. **Web Bluetooth only works with BLE (Bluetooth Low Energy) devices**\n2. **Cannot access Classic Bluetooth profiles** (A2DP, HFP, SPP, etc.)\n3. **Requires HTTPS** (except localhost for development)\n4. **User interaction required** - must be triggered by a user gesture (click)\n5. **Browser support** - primarily Chrome/Edge/Opera\n<o id="bluetoothprotocolstopic-5"> 5. Complete Example with UI</o>\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;Bluetooth Protocol Scanner&lt;/title&gt;\n  &lt;style&gt;\n    body { font-family: Arial, sans-serif; margin: 20px; }\n    button { padding: 10px 15px; margin: 5px; }\n    #results { margin-top: 20px; }\n    .device { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }\n    .service { margin-left: 20px; color: #666; }\n  &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;h1&gt;Bluetooth Protocol Scanner&lt;/h1&gt;\n  \n  &lt;button onclick="scanBluetooth()"&gt;Scan Bluetooth Devices&lt;/button&gt;\n  &lt;button onclick="scanForProfiles()"&gt;Scan by Profile Type&lt;/button&gt;\n  \n  &lt;div id="results"&gt;&lt;/div&gt;\n  \n  &lt;script&gt;\n    async function scanBluetooth() {\n      const results = document.getElementById(\'results\');\n      results.innerHTML = \'&lt;p&gt;Scanning for Bluetooth devices...&lt;/p&gt;\';\n      \n      try {\n        const device = await navigator.bluetooth.requestDevice({\n          acceptAllDevices: true,\n          optionalServices: [\'battery_service\', \'device_information\']\n        });\n        \n        results.innerHTML = `\n          &lt;div class="device"&gt;\n            &lt;h3&gt;Device Found: ${device.name || \'Unnamed Device\'}&lt;/h3&gt;\n            &lt;p&gt;ID: ${device.id}&lt;/p&gt;\n            &lt;p&gt;Connected via GATT: ${device.gatt.connected}&lt;/p&gt;\n          &lt;/div&gt;\n        `;\n        \n        // Connect and get services\n        const server = await device.gatt.connect();\n        const services = await server.getPrimaryServices();\n        \n        let servicesHTML = \'&lt;h4&gt;Available Services:&lt;/h4&gt;\';\n        for (const service of services) {\n          servicesHTML += `\n            &lt;div class="service"&gt;\n              &lt;strong&gt;${service.uuid}&lt;/strong&gt;\n              ${getServiceName(service.uuid) ? \n                ` - ${getServiceName(service.uuid)}` : \'\'}\n            &lt;/div&gt;\n          `;\n        }\n        \n        results.innerHTML += servicesHTML;\n        \n      } catch (error) {\n        results.innerHTML = `&lt;p&gt;Error: ${error.message}&lt;/p&gt;`;\n      }\n    }\n    \n    // Include getServiceName() function from above\n    function getServiceName(uuid) {\n      // ... (use the function from above)\n    }\n  &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n<h3 id="bluetoothprotocolstopic-6">Alternative Approaches</h3>\n\nFor **Classic Bluetooth profiles**, you might need:\n\n1. **Platform-specific APIs** (Cordova, React Native plugins)\n2. **Native desktop applications** using platform APIs\n3. **Chrome Extensions** with `chrome.bluetooth` API\n4. **Node.js** with libraries like `noble` or `bluetooth-hci-socket`\n\n**Chrome Extension Example** (has more access):\n// In a Chrome Extension with bluetooth permission\nchrome.bluetooth.getAdapterState(function(adapter) {\n  console.log(\'Adapter address:\', adapter.address);\n  console.log(\'Adapter name:\', adapter.name);\n  console.log(\'Adapter discoverable:\', adapter.discoverable);\n});\n\nchrome.bluetooth.getDevices(function(devices) {\n  devices.forEach(device =&gt; {\n    console.log(\'Device:\', device.name, device.type);\n  });\n});\n\n<h3 id="bluetoothprotocolstopic-7">Summary</h3>\n\n1. **Web Bluetooth API** only exposes BLE services, not all Bluetooth protocols\n2. You can discover **GATT services** which correspond to specific BLE profiles\n3. **Classic Bluetooth profiles** (A2DP, HFP, SPP) are not accessible via Web Bluetooth\n4. Always handle permissions and user interactions properly\n5. Check browser compatibility before implementing\n\nThe key is to understand that in the Web Bluetooth context, "protocols" are represented as **services** that you can discover once connected to a device.\n',
'<h2>To add uninstalled protocols or profiles to current device</h2>	<div id="addprotocolstoc" class="toc"><a href="#addprotocolstopic-0" target="_self">1. The Reality: Protocol Support is Multi-Layered</a><br><a href="#addprotocolstopic-1" target="_self">2. Platform-by-Platform Analysis</a><br><a href="#addprotocolstopic-2" target="_self"> A. WINDOWS</a><br><a href="#addprotocolstopic-3" target="_self"> B. ANDROID</a><br><a href="#addprotocolstopic-4" target="_self"> C. iOS / macOS</a><br><a href="#addprotocolstopic-5" target="_self"> D. LINUX</a><br><a href="#addprotocolstopic-6" target="_self">3. Specific Protocol/Profile Examples</a><br><a href="#addprotocolstopic-7" target="_self"> Adding A2DP Sink (Receive Audio)</a><br><a href="#addprotocolstopic-8" target="_self"> Adding SPP (Serial Port Profile)</a><br><a href="#addprotocolstopic-9" target="_self"> Adding HID (Human Interface Device)</a><br><a href="#addprotocolstopic-10" target="_self">4. Web/JavaScript Limitations and Workarounds</a><br><a href="#addprotocolstopic-11" target="_self">5. Hardware-Level Considerations</a><br><a href="#addprotocolstopic-12" target="_self"> Bluetooth Chipset Capabilities</a><br><a href="#addprotocolstopic-13" target="_self"> Firmware Updates</a><br><a href="#addprotocolstopic-14" target="_self">6. Practical Approaches by Use Case</a><br><a href="#addprotocolstopic-15" target="_self"> Case 1: I want to add A2DP source/sink to my PC</a><br><a href="#addprotocolstopic-16" target="_self"> Case 2: I want to add SPP for Arduino/RPi communication</a><br><a href="#addprotocolstopic-17" target="_self"> Case 3: I want to add HID to make my phone act as keyboard</a><br><a href="#addprotocolstopic-18" target="_self"> Case 4: I want to add MAP for car message display</a><br><a href="#addprotocolstopic-19" target="_self">7. Developer-Focused Solutions</a><br><a href="#addprotocolstopic-20" target="_self"> Building Custom Bluetooth Stacks</a><br><a href="#addprotocolstopic-21" target="_self"> Creating Virtual Bluetooth Devices</a><br><a href="#addprotocolstopic-22" target="_self">8. Security and Permission Implications</a><br><a href="#addprotocolstopic-23" target="_self"> Why You Usually Can\'t Add Profiles:</a><br><a href="#addprotocolstopic-24" target="_self"> What Requires Admin/System Privileges:</a><br><a href="#addprotocolstopic-25" target="_self">9. Recommended Tools for Experimentation</a><br><a href="#addprotocolstopic-26" target="_self">10. The Bottom Line</a><br><a href="#addprotocolstopic-27" target="_self"> What\'s REALISTICALLY Possible:</a><br><a href="#addprotocolstopic-28" target="_self"> What\'s GENERALLY NOT Possible:</a><br><a href="#addprotocolstopic-29" target="_self"> Best Practical Approach:</a><br><a href="#addprotocolstopic-30" target="_self">Final Recommendation:</a><br></div></center><br><br>\n<pre>\n\nIt\'s possible in some cases, but with significant limitations and platform dependencies.\nLet me explain in detail:\n<h3 id="addprotocolstopic-0">1. The Reality: Protocol Support is Multi-Layered</h3>\n\n┌─────────────────────────────────────────┐\n│          Application Layer               │ ← CAN add (JavaScript, apps)\n├─────────────────────────────────────────┤\n│         Host Stack (OS Level)            │ ← SOMETIMES can add (drivers)\n├─────────────────────────────────────────┤\n│    Controller Firmware (Hardware)       │ ← RARELY can add (chipset limits)\n└─────────────────────────────────────────┘\n<h3 id="addprotocolstopic-1">2. Platform-by-Platform Analysis</h3>\n<o id="addprotocolstopic-2"> A. WINDOWS</o>\n<lg>Most flexible, but still limited:</lg>\n\npowershell\n# Check installed Bluetooth profiles\nGet-PnpDevice -Class Bluetooth | Format-List\n\n# Check for additional drivers available\npnputil /enum-devices /class Bluetooth\n\n<lg>What you CAN add:</lg>\n1. <lg>Generic drivers</lg> for specific device classes\n2. <lg>Virtual COM ports</lg> for SPP (Serial Port Profile)\n3. <lg>Third-party software</lg> that adds profile support:\n - <lg>Bluetooth Stack for Windows by Toshiba</lg> (adds OBEX, FTP)\n - <lg>BlueSoleil</lg> (adds various profiles)\n - <lg>IVT BlueSoleil</lg> (adds PAN, DUN, etc.)\n\n<lg>Limitations:</lg>\n- Still requires hardware/chipset support\n- Many drivers are vendor-specific\n<o id="addprotocolstopic-3"> B. ANDROID</o>\n<lg>Limited, requires root/system permissions:</lg>\n\njava\n// System-level Bluetooth profile installation requires:\n// 1. Root access\n// 2. System app signing\n// 3. Hardware compatibility\n\n// Example: Check if profile is supported\nBluetoothProfile profile = BluetoothProfile.HEADSET;\nint state = bluetoothAdapter.getProfileConnectionState(profile);\n\n<lg>What\'s possible:</lg>\n1. <lg>Rooted devices</lg>: Can modify `/system/etc/bluetooth/` files\n2. <lg>Custom ROMs</lg>: Can include additional profiles\n3. <lg>App-level emulation</lg>: Some apps create virtual profiles\n\n<lg>Example apps that add functionality:</lg>\n- <lg>Bluetooth Audio Codec Changer</lg> (changes codecs within supported profiles)\n- <lg>Bluetooth Auto Connect</lg> (manages connections, not adds profiles)\n- <lg>Tasker/Automate</lg> (can script Bluetooth interactions)\n<o id="addprotocolstopic-4"> C. iOS / macOS</o>\n<lg>Most restricted:</lg>\n- <lg>No user-accessible way</lg> to add Bluetooth profiles\n- <lg>Only Apple-approved profiles</lg> via MFI program\n- <lg>Developer options</lg>: Only for BLE services in your own apps\n<o id="addprotocolstopic-5"> D. LINUX</o>\n<lg>Most flexible for technical users:</lg>\n\nbash\n# Check available profiles\nsdptool browse local\n\n# Install additional Bluetooth packages\nsudo apt-get install pulseaudio-module-bluetooth  # Adds A2DP support\nsudo apt-get install blueman                      # GUI with additional features\nsudo apt-get install obexftp obexfs               # FTP/OBEX support\n\n# Check kernel modules\nlsmod | grep bt_\n\n# Load additional modules\nsudo modprobe btusb\nsudo modprobe btrtl\nsudo modprobe btintel\n\n<lg>BlueZ (Linux Bluetooth stack) extensions:</lg>\n\nbash\n# BlueZ profiles are typically in:\n/usr/lib/bluetooth/plugins/\n\n# You can sometimes add custom plugins here\n# Example: Adding HID over GATT (HOGP) support\nsudo apt-get install bluez-tools\nsudo hciconfig hci0 leadv 3  # Enable advertising\n<h3 id="addprotocolstopic-6">3. Specific Protocol/Profile Examples</h3>\n<o id="addprotocolstopic-7"> Adding A2DP Sink (Receive Audio)</o>\nbash\n# On Linux (Ubuntu/Debian):\nsudo apt-get install pulseaudio pulseaudio-module-bluetooth\npactl load-module module-bluetooth-discover\n\n# Configure as A2DP sink\nsudo nano /etc/bluetooth/audio.conf\n# Add: Enable=Source,Sink,Media,Socket\n<o id="addprotocolstopic-8"> Adding SPP (Serial Port Profile)</o>\npython\n# Python with PyBluez (Linux/Windows)\nimport bluetooth\n\n# Create RFCOMM server\nserver_sock = bluetooth.BluetoothSocket(bluetooth.RFCOMM)\nserver_sock.bind(("", bluetooth.PORT_ANY))\nserver_sock.listen(1)\n\n# Advertise service\nbluetooth.advertise_service(\n    server_sock,\n    "SerialPort",\n    service_id=bluetooth.SERIAL_PORT_CLASS,\n    profiles=[bluetooth.SERIAL_PORT_PROFILE]\n)\n<o id="addprotocolstopic-9"> Adding HID (Human Interface Device)</o>\n<lg>On Linux:</lg>\nbash\n# Install HID support\nsudo apt-get install bluez-tools\n\n# Enable HID over GATT\nsudo hciconfig hci0 leadv\nsudo btmgmt add-uuids 00001812-0000-1000-8000-00805f9b34fb\n\n<lg>On Windows (C#):</lg>\ncsharp\n// Requires Windows.Devices.Bluetooth namespace\n// Can create HID devices via UWP API\nvar device = await BluetoothLEDevice.FromIdAsync(deviceId);\nvar services = await device.GetGattServicesAsync();\n// GATT-based HID is possible via HOGP\n<h3 id="addprotocolstopic-10">4. Web/JavaScript Limitations and Workarounds</h3>\n\n<lg>Direct profile addition: NOT POSSIBLE</lg>\n<lg>Workarounds:</lg>\n\njavascript\n// 1. BLE Custom Services - You can create your own\nasync function createCustomService() {\n    const serviceOptions = {\n        uuid: \'12345678-1234-5678-1234-56789abcdef0\', // Your UUID\n        isPrimary: true,\n        characteristics: [{\n            uuid: \'abcdef01-2345-6789-abcd-ef0123456789\',\n            properties: [\'read\', \'write\', \'notify\'],\n            permissions: [\'readable\', \'writable\'],\n            value: new ArrayBuffer(16)\n        }]\n    };\n    \n    // This only works in your app\'s context\n    // Doesn\'t add system-wide profile support\n}\n\n// 2. Web Serial API + Bluetooth bridge\n// Can emulate SPP-like behavior\nasync function emulateSPP() {\n    // Connect to BLE device\n    const device = await navigator.bluetooth.requestDevice({\n        filters: [{ services: [\'custom-serial-service\'] }]\n    });\n    \n    // Use Web Serial for actual serial communication\n    const port = await navigator.serial.requestPort();\n    await port.open({ baudRate: 9600 });\n    \n    // Bridge BLE &lt;-&gt; Serial\n    bridgeBLEtoSerial(device, port);\n}\n<h3 id="addprotocolstopic-11">5. Hardware-Level Considerations</h3>\n<o id="addprotocolstopic-12"> Bluetooth Chipset Capabilities</o>\nCommon chips and their extensibility:\n\n<table>\n<tbody><tr>\n  <th>Chipset	Extensible	Method</th>\n</tr>\n<tr>\n  <td>Broadcom	Limited	OEM tools only</td>\n</tr>\n<tr>\n  <td>Intel Wireless	Moderate	Linux drivers, firmware blobs</td>\n</tr>\n<tr>\n  <td>Nordic nRF52	Highly extensible	Full custom firmware via SDK</td>\n</tr>\n<tr>\n  <td>ESP32	Highly extensible	Arduino/ESP-IDF, full control</td>\n</tr>\n<tr>\n  <td>Raspberry Pi	Moderate	BlueZ modifications</td>\n</tr>\n</tbody></table>\n<o id="addprotocolstopic-13"> Firmware Updates</o>\nSome devices allow firmware updates that add profiles:\n\nbash\n# Example: Intel Bluetooth firmware update\n# Check current firmware\ndmesg | grep -i bluetooth\n\n# Update tools available from Intel\n# https://www.intel.com/content/www/us/en/download/18881/bluetooth.html\n<h3 id="addprotocolstopic-14">6. Practical Approaches by Use Case</h3>\n<o id="addprotocolstopic-15"> Case 1: I want to add A2DP source/sink to my PC</o>\n<lg>Solution:</lg>\nbash\n# Linux\nsudo apt install pulseaudio-module-bluetooth\npactl load-module module-bluetooth-discover\n\n# Windows\n# Use third-party software like:\n# - Bluesoleil\n# - Toshiba Bluetooth Stack\n# Or buy a USB Bluetooth dongle with needed profiles\n<o id="addprotocolstopic-16"> Case 2: I want to add SPP for Arduino/RPi communication</o>\n<lg>Solution:</lg>\npython\n# Python server with PyBluez\nsudo apt-get install python-bluez\n# Create SPP-like service with custom UUID\n<o id="addprotocolstopic-17"> Case 3: I want to add HID to make my phone act as keyboard</o>\n<lg>Android Solution (requires root):</lg>\njava\n// Modify /system/etc/permissions/platform.xml\n// Add Bluetooth HID permissions\n// Or use apps like "Bluetooth Keyboard &amp; Mouse"\n<o id="addprotocolstopic-18"> Case 4: I want to add MAP for car message display</o>\n<lg>Almost Impossible</lg> for users - requires:\n- Car manufacturer cooperation\n- Deep system integration\n- Security certification\n<h3 id="addprotocolstopic-19">7. Developer-Focused Solutions</h3>\n<o id="addprotocolstopic-20"> Building Custom Bluetooth Stacks</o>\n<lg>For embedded systems (ESP32, nRF52):</lg>\n\nc\n// ESP32 with Arduino\n#include <bluetoothserial.h>\n#include <blekeyboard.h>  // HID profile\n#include <blemouse.h>     // HID profile\n\nBluetoothSerial SerialBT;\nBleKeyboard bleKeyboard("MyKeyboard");\n\nvoid setup() {\n    SerialBT.begin("ESP32"); // SPP-like\n    bleKeyboard.begin();     // HID profile\n}\n\n// Nordic nRF52 SDK (more control)\n// Can implement any profile in software\n<o id="addprotocolstopic-21"> Creating Virtual Bluetooth Devices</o>\n<lg>On Linux with dbus/BlueZ:</lg>\n\npython\nimport dbus\nimport dbus.service\nfrom dbus.mainloop.glib import DBusGMainLoop\n\nclass VirtualHIDDevice(dbus.service.Object):\n    @dbus.service.method("org.bluez.Device1")\n    def Connect(self):\n        # Implement HID connection\n        pass\n    \n    # Register as Bluetooth HID device\n    # This creates a system-level virtual device\n<h3 id="addprotocolstopic-22">8. Security and Permission Implications</h3>\n<o id="addprotocolstopic-23"> Why You Usually Can\'t Add Profiles:</o>\n1. <lg>Security</lg>: Profiles like HID could create keyboards/mice (security risk)\n2. <lg>DRM</lg>: Audio profiles (A2DP) have copyright protection\n3. <lg>Certification</lg>: Bluetooth SIG requires profile certification\n4. <lg>Hardware limitations</lg>: Some profiles need specific hardware support\n5. <lg>Driver signing</lg>: OSes require signed drivers\n<o id="addprotocolstopic-24"> What Requires Admin/System Privileges:</o>\n- Modifying Bluetooth stack files\n- Installing kernel modules/drivers\n- Changing system Bluetooth configuration\n- Accessing raw HCI commands\n<h3 id="addprotocolstopic-25">9. Recommended Tools for Experimentation</h3>\n\n\n<table>\n<tbody><tr>\n  <th>Tool	Platform	Purpose</th>\n</tr>\n<tr>\n  <td>BtStack	Embedded	Lightweight, portable stack</td>\n</tr>\n<tr>\n  <td>PyBluez	Windows/Linux	Python Bluetooth library</td>\n</tr>\n<tr>\n  <td>nRF Connect	Desktop/Mobile	BLE development/debugging</td>\n</tr>\n<tr>\n  <td>Wireshark	All	Bluetooth packet analysis</td>\n</tr>\n<tr>\n  <td>Bluetility	macOS	Bluetooth exploration</td>\n</tr>\n</tbody></table>\n<h3 id="addprotocolstopic-26">10. The Bottom Line</h3>\n<o id="addprotocolstopic-27"> What\'s REALISTICALLY Possible:</o>\n1. ✅ <lg>Add BLE services</lg> to your own applications\n2. ✅ <lg>Install third-party Bluetooth software</lg> (Windows/Linux)\n3. ✅ <lg>Use USB Bluetooth adapters</lg> with needed profiles\n4. ✅ <lg>Create virtual devices</lg> via software (limited)\n5. ✅ <lg>Modify existing profiles</lg> (codecs, settings)\n6. ✅ <lg>Use workarounds</lg> (emulate via TCP/IP, serial, etc.)\n<o id="addprotocolstopic-28"> What\'s GENERALLY NOT Possible:</o>\n1. ❌ <lg>Add Classic Bluetooth profiles</lg> to iOS/Android without root\n2. ❌ <lg>Modify Bluetooth chip firmware</lg> on most consumer devices\n3. ❌ <lg>Add profiles that require hardware acceleration</lg> without compatible hardware\n4. ❌ <lg>Create system-wide profile support</lg> without admin/root access\n5. ❌ <lg>Bypass Bluetooth SIG certification</lg> for standardized profiles\n<o id="addprotocolstopic-29"> Best Practical Approach:</o>\njavascript\n// Instead of trying to add protocols to the OS,\n// create application-level solutions:\n\n// 1. Use BLE for custom communication\nnavigator.bluetooth.requestDevice({\n    filters: [{ services: [CUSTOM_SERVICE_UUID] }]\n});\n\n// 2. Bridge to other technologies\n//    BLE → WebSocket → Internet\n//    BLE → Serial → USB\n//    BLE → HTTP → Cloud\n\n// 3. Use platform-specific APIs when available\n//    (Web Serial, Web USB, Native APIs)\n<h3 id="addprotocolstopic-30">Final Recommendation:</h3>\n\nIf you need specific Bluetooth functionality:\n1. <lg>Check your hardware</lg> first (chipset capabilities)\n2. <lg>Consider USB Bluetooth adapters</lg> with the profiles you need\n3. <lg>Look for software solutions</lg> that add the functionality\n4. <lg>For development</lg>: Use BLE with custom services\n5. <lg>For production</lg>: Choose hardware that natively supports needed profiles\n\nThe reality is that while technically possible in some environments, adding new Bluetooth profiles to existing devices is challenging and often impractical for end users. The ecosystem is designed around certified, standardized implementations for security and compatibility reasons.\n',
'<h2>available Bluetooth protocols</h2>	<div id="aBluetoothprotocolstoc" class="toc"><a href="#aBluetoothprotocolstopic-0" target="_self">1. Bluetooth Classic (BR/EDR) Protocols</a><br><a href="#aBluetoothprotocolstopic-1" target="_self"> A. Audio/Video Distribution</a><br><a href="#aBluetoothprotocolstopic-2" target="_self"> B. Telephony/Communication</a><br><a href="#aBluetoothprotocolstopic-3" target="_self"> C. Data Transfer/Networking</a><br><a href="#aBluetoothprotocolstopic-4" target="_self"> D. Human Interface Devices</a><br><a href="#aBluetoothprotocolstopic-5" target="_self">2. Bluetooth Low Energy (BLE/Bluetooth Smart) Protocols</a><br><a href="#aBluetoothprotocolstopic-6" target="_self"> A. Generic Access Framework</a><br><a href="#aBluetoothprotocolstopic-7" target="_self"> B. Common BLE Services (GATT Services)</a><br><a href="#aBluetoothprotocolstopic-8" target="_self"> C. Bluetooth Mesh Protocols</a><br><a href="#aBluetoothprotocolstopic-9" target="_self">3. Modern Bluetooth Standards &amp; Versions</a><br><a href="#aBluetoothprotocolstopic-10" target="_self">4. Bluetooth Protocol Stack Architecture</a><br><a href="#aBluetoothprotocolstopic-11" target="_self">5. Device-Specific Protocol Combinations</a><br><a href="#aBluetoothprotocolstopic-12" target="_self"> 1. Wireless Earbuds:</a><br><a href="#aBluetoothprotocolstopic-13" target="_self"> 2. Smart Watch:</a><br><a href="#aBluetoothprotocolstopic-14" target="_self"> 3. Car Infotainment:</a><br><a href="#aBluetoothprotocolstopic-15" target="_self"> 4. IoT Sensor:</a><br><a href="#aBluetoothprotocolstopic-16" target="_self"> 5. Smart Home Device:</a><br><a href="#aBluetoothprotocolstopic-17" target="_self">6. How to Identify Available Protocols</a><br><a href="#aBluetoothprotocolstopic-18" target="_self">7. Protocol Adoption Trends (2024)</a><br><a href="#aBluetoothprotocolstopic-19" target="_self">8. Practical Identification Tools</a><br></div></center><br><br>\n<pre>Let me provide a comprehensive overview of modern Bluetooth protocols and profiles. There are two main Bluetooth technologies with different protocol stacks:\n<h3 id="aBluetoothprotocolstopic-0">1. Bluetooth Classic (BR/EDR) Protocols</h3>\n<o id="aBluetoothprotocolstopic-1"> A. Audio/Video Distribution</o>\n<table>\n<tbody><tr>\n  <th>Protocol	Full Name	Purpose	Common Use</th>\n</tr>\n<tr>\n  <td>AVRCP	Audio/Video Remote Control Profile	Remote control functions (play/pause, volume)	Media controls on headphones/car systems</td>\n</tr>\n<tr>\n  <td>AVCTP	Audio/Video Control Transport Protocol	Transport for AVRCP commands	Underlying transport for AV controls</td>\n</tr>\n<tr>\n  <td>AVDTP	Audio/Video Distribution Transport Protocol	Transport for A2DP audio streams	Audio streaming foundation</td>\n</tr>\n</tbody></table>\n<o id="aBluetoothprotocolstopic-2"> B. Telephony/Communication</o>\n<table>\n<tbody><tr>\n  <th>Protocol	Full Name	Purpose	Common Use</th>\n</tr>\n<tr>\n  <td>HSP	Headset Profile	Basic headset functionality	Simple headsets</td>\n</tr>\n<tr>\n  <td>SAP	SIM Access Profile	SIM card sharing	Car systems with eSIM</td>\n</tr>\n<tr>\n  <td>PBAP	Phone Book Access Profile	Access to phone contacts	Car infotainment systems</td>\n</tr>\n<tr>\n  <td>MAP	Message Access Profile	Access to SMS/email messages	Car message display</td>\n</tr>\n</tbody></table>\n<o id="aBluetoothprotocolstopic-3"> C. Data Transfer/Networking</o>\n<table>\n<tbody><tr>\n  <td>Protocol	Full Name	Purpose	Common Use</td>\n</tr>\n<tr>\n  <td>SPP	Serial Port Profile	Emulates serial cable communication	Industrial devices, medical equipment</td>\n</tr>\n<tr>\n  <td>DUN	Dial-up Networking	Internet access via phone	Tethering (largely replaced by PAN)</td>\n</tr>\n<tr>\n  <td>PAN	Personal Area Networking	IP networking over Bluetooth	Tethering, network sharing</td>\n</tr>\n<tr>\n  <td>FTP	File Transfer Profile	File transfers between devices	Phone-to-phone file sharing</td>\n</tr>\n<tr>\n  <td>OPP	Object Push Profile	Simple object pushing	Contact/photo sharing</td>\n</tr>\n<tr>\n  <td>BIP	Basic Imaging Profile	Image transfer/control	Camera to phone transfers</td>\n</tr>\n<tr>\n  <td>BPP	Basic Printing Profile	Simple printing	Receipt printers, labels</td>\n</tr>\n<tr>\n  <td>HCRP	Hardcopy Cable Replacement	Printer communication	Printers without drivers</td>\n</tr>\n</tbody></table>\n<o id="aBluetoothprotocolstopic-4"> D. Human Interface Devices</o>\n<table>\n<tbody><tr>\n  <td>Protocol	Full Name	Purpose	Common Use</td>\n</tr>\n<tr>\n  <td>HID	Human Interface Device Profile	Keyboard/mouse/joystick	Wireless keyboards, mice, gamepads</td>\n</tr>\n<tr>\n  <td>HOGP	HID over GATT	HID over BLE (modern)	Low-power keyboards/mice</td>\n</tr>\n</tbody></table>\n<h3 id="aBluetoothprotocolstopic-5">2. Bluetooth Low Energy (BLE/Bluetooth Smart) Protocols</h3>\n<o id="aBluetoothprotocolstopic-6"> A. Generic Access Framework</o>\n<table>\n<tbody><tr>\n  <td>Protocol	Purpose	GATT Service UUID</td>\n</tr>\n<tr>\n  <td>GAP	Generic Access Profile	Device discovery/connection</td>\n</tr>\n<tr>\n  <td>GATT	Generic Attribute Profile	Data structure/services</td>\n</tr>\n<tr>\n  <td>ATT	Attribute Protocol	Data exchange foundation</td>\n</tr>\n<tr>\n  <td>SMP	Security Manager Protocol	Pairing/encryption</td>\n</tr>\n</tbody></table>\n<o id="aBluetoothprotocolstopic-7"> B. Common BLE Services (GATT Services)</o>\n<table>\n<tbody><tr>\n  <td>Service	UUID	Purpose	Common Devices</td>\n</tr>\n<tr>\n  <td>Battery Service	0x180F	Battery level monitoring	All battery-powered devices</td>\n</tr>\n<tr>\n  <td>Device Information	0x180A	Manufacturer/model info	All devices</td>\n</tr>\n<tr>\n  <td>Heart Rate	0x180D	Heart rate monitoring	Fitness trackers, watches</td>\n</tr>\n<tr>\n  <td>Health Thermometer	0x1809	Temperature measurement	Medical thermometers</td>\n</tr>\n<tr>\n  <td>Blood Pressure	0x1810	Blood pressure monitoring	Medical devices</td>\n</tr>\n<tr>\n  <td>Glucose Monitor	0x1808	Glucose level monitoring	Medical devices</td>\n</tr>\n<tr>\n  <td>Cycling Speed &amp; Cadence	0x1816	Cycling metrics	Bike computers/sensors</td>\n</tr>\n<tr>\n  <td>Running Speed &amp; Cadence	0x1814	Running metrics	Fitness trackers</td>\n</tr>\n<tr>\n  <td>Location &amp; Navigation	0x1819	Position data	GPS devices</td>\n</tr>\n<tr>\n  <td>Environmental Sensing	0x181A	Environmental sensors	Weather stations</td>\n</tr>\n<tr>\n  <td>Human Interface Device	0x1812	Input devices	Keyboards, mice</td>\n</tr>\n<tr>\n  <td>Alert Notification	0x1811	Notifications/alerts	Smart watches</td>\n</tr>\n</tbody></table>\n<o id="aBluetoothprotocolstopic-8"> C. Bluetooth Mesh Protocols</o>\n<table>\n<tbody><tr>\n  <td>Protocol	Purpose	Use Cases</td>\n</tr>\n<tr>\n  <td>Mesh Profile	Multi-device networking	Smart lighting, building automation</td>\n</tr>\n<tr>\n  <td>Mesh Model	Application-level functionality	Light control, sensor networks</td>\n</tr>\n<tr>\n  <td>Mesh Provisioning	Adding devices to mesh	Device onboarding</td>\n</tr>\n<tr>\n  <td>Mesh Proxy	GATT to mesh bridging	Phone-to-mesh communication</td>\n</tr>\n</tbody></table>\n<h3 id="aBluetoothprotocolstopic-9">3. Modern Bluetooth Standards &amp; Versions</h3>\nBluetooth 5.0+ Features\n<table>\n<tbody><tr>\n  <td>Feature	Protocol/Profile	Capability</td>\n</tr>\n<tr>\n  <td>2M PHY	Enhanced data rate	2 Mbps data transfer</td>\n</tr>\n<tr>\n  <td>LE Long Range	LE Coded PHY	4x range extension</td>\n</tr>\n<tr>\n  <td>LE Advertising Extensions	Extended Advertising	Larger advertising packets</td>\n</tr>\n<tr>\n  <td>LE Channel Selection	Improved coexistence	Better Wi-Fi/BT coexistence</td>\n</tr>\n<tr>\n  <td>LE Audio	New audio architecture	Multi-stream, LC3 codec</td>\n</tr>\n<tr>\n  <td>Auracast	Broadcast audio	Public broadcast audio</td>\n</tr>\n</tbody></table>\nBluetooth 5.2+ (LE Audio)\n<table>\n<tbody><tr>\n  <td>Protocol	Purpose	Benefits</td>\n</tr>\n<tr>\n  <td>LC3	Low Complexity Communication Codec	Better quality at lower bitrates</td>\n</tr>\n<tr>\n  <td>Multi-stream Audio	Multiple synchronized streams	True wireless earbuds sync</td>\n</tr>\n<tr>\n  <td>Broadcast Audio	Audio sharing	Auracast public broadcasts</td>\n</tr>\n<tr>\n  <td>Hearing Aid Support	Hearing aid compatibility	Direct to hearing aids</td>\n</tr>\n</tbody></table>\n<h3 id="aBluetoothprotocolstopic-10">4. Bluetooth Protocol Stack Architecture</h3>\n┌─────────────────────────────────────────┐\n│           Applications                   │\n├─────────────────────────────────────────┤\n│               Profiles                   │  ← A2DP, HFP, HID, etc.\n├─────────────────────────────────────────┤\n│      Generic Access Profile (GAP)       │\n├─────────────────────────────────────────┤\n│   Generic Attribute Profile (GATT)      │  ← BLE Services/Characteristics\n├─────────────────────────────────────────┤\n│ Attribute Protocol (ATT)  Security (SMP)│\n├─────────────────────────────────────────┤\n│   Logical Link Control (L2CAP)          │\n├─────────────────────────────────────────┤\n│  Host Controller Interface (HCI)        │\n├─────────────────────────────────────────┤\n│        Link Manager (LM)                │\n├─────────────────────────────────────────┤\n│        Baseband (PHY)                   │  ← Physical radio\n└─────────────────────────────────────────┘\n<h3 id="aBluetoothprotocolstopic-11">5. Device-Specific Protocol Combinations</h3>\nCommon Device Configurations:\n<o id="aBluetoothprotocolstopic-12"> 1. Wireless Earbuds:</o>\ntext\n- A2DP (stereo audio)\n- AVRCP (playback controls)\n- HFP/HSP (phone calls)\n- LE Audio (newer models)\n<o id="aBluetoothprotocolstopic-13"> 2. Smart Watch:</o>\ntext\n- BLE GATT Services:\n  • Device Information (0x180A)\n  • Battery Service (0x180F)\n  • Heart Rate (0x180D)\n  • Alert Notification (0x1811)\n- SPP or custom profile for data sync\n<o id="aBluetoothprotocolstopic-14"> 3. Car Infotainment:</o>\ntext\n- A2DP (music streaming)\n- AVRCP (media control)\n- HFP (hands-free calls)\n- PBAP (contact sync)\n- MAP (message display)\n- PAN (WiFi hotspot tethering)\n<o id="aBluetoothprotocolstopic-15"> 4. IoT Sensor:</o>\ntext\n- BLE Advertising (beacon mode)\n- Environmental Sensing (0x181A)\n- Battery Service (0x180F)\n- Custom manufacturer service\n<o id="aBluetoothprotocolstopic-16"> 5. Smart Home Device:</o>\ntext\n- BLE for setup (provisioning)\n- WiFi for main connectivity\n- Bluetooth Mesh (for multi-device systems)\n<h3 id="aBluetoothprotocolstopic-17">6. How to Identify Available Protocols</h3>\nOn Different Platforms:\nAndroid (Java/Kotlin):\njava\n// Check Bluetooth profiles\nBluetoothAdapter adapter = BluetoothAdapter.getDefaultAdapter();\nSet&lt;BluetoothDevice&gt; bondedDevices = adapter.getBondedDevices();\nfor (BluetoothDevice device : bondedDevices) {\n    // Check specific profiles\n    int a2dp = adapter.getProfileConnectionState(BluetoothProfile.A2DP);\n    int hfp = adapter.getProfileConnectionState(BluetoothProfile.HEADSET);\n}\niOS/macOS (Swift):\nswift\nimport CoreBluetooth\n// BLE Services discovery\nfunc peripheral(_ peripheral: CBPeripheral, \n                didDiscoverServices error: Error?) {\n    for service in peripheral.services ?? [] {\n        print("Service UUID: \(service.uuid)")\n        // Service UUIDs map to protocols\n    }\n}\nLinux (Bluetoothctl):\nbash\n$ bluetoothctl\n[bluetooth]# info &lt;device_mac&gt;\nDevice AA:BB:CC:DD:EE:FF\n    Name: My Headphones\n    Icon: audio-headset\n    Paired: yes\n    Trusted: yes\n    Blocked: no\n    Connected: yes\n    UUID: Audio Source        (0000110a-0000-1000-8000-00805f9b34fb)  # A2DP\n    UUID: A/V Remote Control  (0000110e-0000-1000-8000-00805f9b34fb)  # AVRCP\n    UUID: Handsfree           (0000111e-0000-1000-8000-00805f9b34fb)  # HFP\n<h3 id="aBluetoothprotocolstopic-18">7. Protocol Adoption Trends (2024)</h3>\n<table>\n<tbody><tr>\n  <th>Trend	Increasing	Decreasing</th>\n</tr>\n<tr>\n  <td>LE Audio	Growing in headphones, hearing aids	Traditional A2DP in new designs</td>\n</tr>\n<tr>\n  <td>Bluetooth Mesh	Smart lighting, industrial IoT	Proprietary mesh solutions</td>\n</tr>\n<tr>\n  <td>Classic Profiles	Still strong in automotive/audio	Legacy profiles (FTP, OPP, DUN)</td>\n</tr>\n<tr>\n  <td>SPP	Industrial/IoT applications	Consumer file transfer</td>\n</tr>\n</tbody></table>\n<h3 id="aBluetoothprotocolstopic-19">8. Practical Identification Tools</h3>\nFor End Users:\nBluetooth Scanner apps (LightBlue, nRF Connect)\nSystem Bluetooth settings (shows connected profiles)\nDevice specifications/manuals\nFor Developers:\nAndroid Bluetooth API - Profile constants\niOS CoreBluetooth - Service/Characteristic discovery\nBlueZ (Linux) - sdptool browse <mac>\nWireshark with BT dissectors - Protocol analysis\nKey Takeaways:\nTwo main branches: Classic (A2DP, HFP, SPP) and BLE (GATT services)\nOver 30+ standardized profiles plus many custom/vendor-specific ones\nModern trend: BLE for low-power, Classic for high-throughput audio\nLE Audio is the future for audio applications\nWeb Bluetooth only exposes BLE GATT services, not Classic profiles\nThe Bluetooth ecosystem continues to evolve with Bluetooth 5.4 (released 2023) adding enhanced features for electronic shelf labels, asset tracking, and improved security. The move toward LE Audio represents the biggest shift since Bluetooth\'s inception for audio applications.\n',
'<h2>金属-有机框架(MOF)材料</h2>	<div id="MOFtoc" class="toc"><a href="#MOFtopic-0" target="_self">MOF简介</a><br><a href="#MOFtopic-1" target="_self">MOF的核心特点</a><br><a href="#MOFtopic-2" target="_self">合成方法</a><br><a href="#MOFtopic-3" target="_self">主要应用领域</a><br><a href="#MOFtopic-4" target="_self">经典MOF案例</a><br><a href="#MOFtopic-5" target="_self">挑战与未来发展</a><br></div></center><br><br>\n\nMetal-Organic Framework - 化学界的"乐高"\n多孔晶体材料 | 超高比表面积 | 结构可设计\n<h3 id="MOFtopic-0">MOF简介</h3>\n<i>金属-有机框架(MOF)</i>是一种由金属离子或金属簇与有机配体通过配位键自组装形成的<i>多孔晶体材料</i>。\n它被誉为"化学界的乐高"，因其结构可设计性极高，在能源、环境、医疗等领域展现出巨大潜力。\n<i>核心特点：</i> MOF的孔隙率极高，比表面积可达<i>1000–10,000 m²/g</i>，是活性炭的3-10倍。\n例如，MOF-210的比表面积甚至达到<i>10,400 m²/g</i>，是目前已知比表面积最大的多孔材料之一。\n<h3 id="MOFtopic-1">MOF的核心特点</h3>\n超高比表面积\n孔隙率极高，比表面积可达1000–10,000 m²/g，提供大量活性位点\n\n结构可调控性\n通过改变金属节点和有机配体组合，可精准调控孔道尺寸、形状和化学环境\n\n高孔隙率与功能化\n孔道内可修饰功能基团，或负载催化剂、药物分子，实现"定制化"功能\n\n<h3 id="MOFtopic-2">合成方法</h3>\n<ul style="padding-left: 20px; margin: 15px 0;"> <li><i>水热/溶剂热法</i>：最常用，在高温高压下于溶剂中反应生成晶体</li> <li><i>微波法/超声法</i>：快速合成纳米级MOF</li> <li><i>机械化学法</i>：无溶剂研磨，适用于绿色合成</li></ul>\n\n<h3 id="MOFtopic-3">主要应用领域</h3>\n<table> <thead>\n<tr> <th>领域</th> <th>具体应用</th> <th>代表MOF</th>\n</tr> </thead> <tbody>\n<tr> <td><i>气体吸附与储存</i></td> <td>氢气、甲烷储存、二氧化碳捕获</td> <td>MOF-210, UIO-66, Mg-MOF-74</td></tr>\n<tr> <td><i>催化</i></td> <td>多相催化剂，利用孔道限域效应提高选择性</td> <td>MIL-101, ZIF-8</td></tr>\n<tr> <td><i>药物递送</i></td> <td>负载抗癌药物，实现可控释放</td> <td>MIL-100, ZIF-90</td></tr>\n<tr> <td><i>传感与检测</i></td> <td>荧光传感检测重金属、爆炸物或生物分子</td> <td>Ln-MOFs（镧系MOF）</td></tr>\n<tr> <td><i>分离技术</i></td> <td>分离烯烃/烷烃、水处理</td> <td>ZIF-8, MIL-53</td></tr>\n<tr> <td><i>能源存储</i></td> <td>超级电容器、电池电极材料</td> <td>Co-MOF-74</td></tr>\n</tbody>\n</table>\n\n<h3 id="MOFtopic-4">经典MOF案例</h3>\nHKUST-1 (Cu-BTC)\n由铜与均苯三甲酸合成，用于甲烷储存，具有三维孔道结构\n\nMIL-53 (Al)\n具有"呼吸效应"，孔道可随外界刺激（如温度、压力）可逆伸缩\n\nZIF-8 (锌咪唑酯)\n高化学稳定性和热稳定性，用于气体分离和催化\n\nUIO-66 (锆基)\n耐水耐酸，稳定性优异，适用于催化与吸附领域\n\n<h3 id="MOFtopic-5">挑战与未来发展</h3>\n<ul style="padding-left: 20px; margin: 15px 0;"> <li><i>稳定性问题</i>：部分MOF对水、酸碱性环境敏感（如ZIF-8耐水，但某些MOF易水解）</li> <li><i>规模化生产</i>：低成本、大批量合成仍是产业化的瓶颈</li> <li><i>功能化集成</i>：发展多功能MOF复合材料，如MOF/聚合物混合基质膜</li> <li><i>新兴方向</i>：导电MOF、光催化MOF、柔性MOF（呼吸效应）等</li>\n</ul>\n\n  <i>总结：</i> MOF作为21世纪的新型多孔材料，凭借其<i>可设计的结构与功能</i>，已成为材料科学和化学领域的研究热点。\n随着稳定性与规模化技术的突破，MOF有望在碳中和、清洁能源、精准医疗等关键领域实现产业化应用。\n',
'<h2>LocalStorage Array Manager</h2>	Load an array from localStorage on initialization, and to save array content back to localStorage.\n\nSix functions created:\n- show status messages\n- display the array\n- load array from localStorage\n- save array to localStorage\n- add a random item to the array\n- clear the array\n\n// Initialize array with default value or from localStorage\nlet historyArray = [];\nconst STORAGE_KEY = \'historyArrayData\';\n\n// Function to show status messages\nfunction showStatus(message, type = \'info\') {\n  statusMessage.textContent = message;\n  statusMessage.className = `status ${type}`;\n  statusMessage.style.display = \'block\';\n  \n  // Auto-hide after 3 seconds\n  setTimeout(() => {\n    statusMessage.style.display = \'none\';\n  }, 3000);\n}\n\n// Function to display the array\nfunction displayArray() {\n  if (historyArray.length === 0) {\n    arrayDisplay.innerHTML = \'<span class="empty-array">Array is empty. Add some items using the "Add Random Item" button.</span>\';\n  } else {\n    arrayDisplay.textContent = JSON.stringify(historyArray, null, 2);\n  }\n}\n\n// Function to load array from localStorage\nfunction loadArrayFromLocalStorage() {\n  try {\n    const storedData = localStorage.getItem(STORAGE_KEY);\n    \n    if (storedData) {\n        historyArray = JSON.parse(storedData);\n        showStatus(`Array loaded from localStorage with ${historyArray.length} items`, \'success\');\n    } else {\n        // Initialize with default data if nothing is stored\n        historyArray = [\n          "First item loaded from default",\n          "Second item",\n          "Third item"\n        ];\n        showStatus(\'No data found in localStorage. Using default array.\', \'info\');\n    }\n  } catch (error) {\n    console.error(\'Error loading from localStorage:\', error);\n    historyArray = ["Error loading data"];\n    showStatus(\'Error loading data from localStorage. Using empty array.\', \'error\');\n  }\n  \n  displayArray();\n}\n\n// Function to save array to localStorage\nfunction saveArrayToLocalStorage() {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(historyArray));\n    showStatus(`Array saved to localStorage with ${historyArray.length} items`, \'success\');\n  } catch (error) {\n    console.error(\'Error saving to localStorage:\', error);\n    showStatus(\'Error saving data to localStorage\', \'error\');\n  }\n}\n\n// Function to add a random item to the array\nfunction addRandomItem() {\n  const items = [\n    "Random Item " + Math.floor(Math.random() * 1000),\n    "New Entry " + Date.now().toString().slice(-4),\n    "Sample Data " + Math.floor(Math.random() * 100),\n    "Test Item " + String.fromCharCode(65 + Math.floor(Math.random() * 26)),\n    "Generated at " + new Date().toLocaleTimeString()\n  ];\n  \n  const randomItem = items[Math.floor(Math.random() * items.length)];\n  historyArray.push(randomItem);\n  displayArray();\n  showStatus(`Added: "${randomItem}" to the array`, \'info\');\n}\n\n// Function to clear the array\nfunction clearArray() {\n  if (historyArray.length > 0) {\n    historyArray = [];\n    displayArray();\n    showStatus(\'Array cleared\', \'info\');\n  } else {\n    showStatus(\'Array is already empty\', \'info\');\n  }\n}\n\n// Event listeners\nsaveButton.addEventListener(\'click\', saveArrayToLocalStorage);\naddButton.addEventListener(\'click\', addRandomItem);\nclearButton.addEventListener(\'click\', clearArray);\n\n// Initialize on page load\ndocument.addEventListener(\'DOMContentLoaded\', loadArrayFromLocalStorage);\n\n// Also show localStorage info on page load\ndocument.addEventListener(\'DOMContentLoaded\', () => {\n  console.log(\'LocalStorage Array Manager initialized\');\n  console.log(\'LocalStorage key:\', STORAGE_KEY);\n  console.log(\'Current array:\', historyArray);\n});\n',
'<h2>get unique values from an array</h2>	several ways to get unique values from an array in JavaScript\nThe simplest and most performant way:\nconst uniqueArray = [...new Set(array)];',
'<h2>function to browse and select items</h2>	// Add this function to browse and select items\nfunction browseAndSelectFixedSelections() {\n  const categories = {\n    色调: t2i[0].色调,\n    构图: t2i[0].构图,\n    紋理: t2i[0].紋理,\n    风格: t2i[0].风格,\n    算法: t2i[0].算法,\n    物件: t2i[0].物件,\n    形容词: t2i[0].形容词,\n    场景: t2i[0].场景\n  };\n  \n  const fixedSelections = {};\n  const selectedItems = [];\n  \n  // Create UI for browsing and selection\n  let html = \'&lt;div id="fixedSelectionUI" style="padding: 20px; background: #f5f5f5; border-radius: 8px; margin: 10px 0;">\';\n  html += \'&lt;h3>选择固定要包含的项目&lt;/h3>\';\n  \n  // For each category\n  for (const [categoryName, items] of Object.entries(categories)) {\n    html += `&lt;div class="category-section" style="margin-bottom: 15px; padding: 10px; background: white; border-radius: 5px;">`;\n    html += `&lt;h4 style="margin-top: 0;">${categoryName} (${items.length} 个项目)&lt;/h4>`;\n    html += `&lt;div class="category-items" style="display: flex; flex-wrap: wrap; gap: 8px;">`;\n    \n    // Create checkbox for each item\n    items.forEach((item, index) => {\n      const uniqueId = `${categoryName}_${index}`;\n      html += `\n        &lt;div style="flex: 0 0 auto;">\n          &lt;input type="checkbox" id="${uniqueId}" value="${index}" data-category="${categoryName}">\n          &lt;label for="${uniqueId}" style="font-size: 12px; cursor: pointer;">\n            ${item.substring(0, 30)}${item.length > 30 ? \'...\' : \'\'}\n          &lt;/label>\n        &lt;/div>\n      `;\n    });\n    \n    html += `&lt;/div>&lt;/div>`;\n  }\n  \n  html += `\n    &lt;div style="margin-top: 20px;">\n      &lt;button onclick="confirmFixedSelections()" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">\n        确认选择并生成\n      &lt;/button>\n      &lt;button onclick="cancelFixedSelections()" style="padding: 10px 20px; margin-left: 10px; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer;">\n        取消\n      &lt;/button>\n    &lt;/div>\n  `;\n  html += \'&lt;/div>\';\n  \n  // Display the UI\n  const container = document.createElement(\'div\');\n  container.innerHTML = html;\n  document.body.appendChild(container);\n  \n  // Store selected items\n  window.confirmFixedSelections = function() {\n    // Clear any previous selections\n    const checkboxes = document.querySelectorAll(\'input[type="checkbox"]:checked\');\n    \n    // Group selections by category\n    checkboxes.forEach(checkbox => {\n      const category = checkbox.getAttribute(\'data-category\');\n      const index = parseInt(checkbox.value);\n      \n      if (!fixedSelections[category]) {\n        fixedSelections[category] = [];\n      }\n      \n      if (!fixedSelections[category].includes(index)) {\n        fixedSelections[category].push(index);\n      }\n      \n      // Also store the actual item for display\n      selectedItems.push({\n        category: category,\n        index: index,\n        text: categories[category][index]\n      });\n    });\n    \n    // Remove the UI\n    container.remove();\n    \n    // Show summary of selected items\n    showSelectionSummary(selectedItems);\n    \n    // Call joinMultiTips with the fixed selections\n    joinMultiTips(fixedSelections);\n  };\n  \n  window.cancelFixedSelections = function() {\n    // Remove the UI\n    container.remove();\n    // Call original function without fixed selections\n    joinMultiTips();\n  };\n}\n\n// Function to show summary of selected items\nfunction showSelectionSummary(selectedItems) {\n  let summaryHtml = \'&lt;div style="margin: 15px 0; padding: 10px; background: #e8f5e8; border-radius: 5px;">\';\n  summaryHtml += \'&lt;strong>已选择的固定项目:&lt;/strong>&lt;br>\';\n  \n  if (selectedItems.length === 0) {\n    summaryHtml += \'未选择固定项目，将完全随机生成。\';\n  } else {\n    // Group by category\n    const grouped = {};\n    selectedItems.forEach(item => {\n      if (!grouped[item.category]) {\n        grouped[item.category] = [];\n      }\n      grouped[item.category].push(`${item.index}: ${item.text.substring(0, 50)}${item.text.length > 50 ? \'...\' : \'\'}`);\n    });\n    \n    for (const [category, items] of Object.entries(grouped)) {\n      summaryHtml += `&lt;div style="margin-top: 5px;">`;\n      summaryHtml += `&lt;strong>${category}:&lt;/strong> ${items.length} 个项目&lt;br>`;\n      items.forEach(item => {\n        summaryHtml += `&lt;span style="font-size: 12px; color: #666;">• ${item}&lt;/span>&lt;br>`;\n      });\n      summaryHtml += `&lt;/div>`;\n    }\n  }\n  \n  summaryHtml += \'&lt;/div>\';\n  \n  // Insert the summary before the result\n  const resultDiv = document.querySelector(\'#question\');\n  if (resultDiv) {\n    resultDiv.insertAdjacentHTML(\'beforebegin\', summaryHtml);\n  }\n}\n\n// Updated joinMultiTips function with better fixed selection handling\nfunction joinMultiTips(fixedSelections = {}) {\n  let finalArray = []; // use \'let\' because we reassign\n\n  // Helper function to add selections\n  function addSelections(category, categoryKey, randomCnt, percent) {\n    let selections = [];\n    let fixedIndices = [];\n    \n    // Get fixed indices for this category\n    if (fixedSelections[categoryKey] && fixedSelections[categoryKey].length > 0) {\n      fixedIndices = fixedSelections[categoryKey]\n        .filter(idx => idx >= 0 && idx &lt; category.length);\n      \n      // Add the fixed items\n      fixedIndices.forEach(idx => {\n        selections.push(category[idx]);\n      });\n    }\n    \n    // Calculate how many more random items we need\n    const randomNeeded = Math.max(0, randomCnt - fixedIndices.length);\n    \n    // If we need more random selections\n    if (randomNeeded > 0) {\n      // Get available indices (excluding fixed ones)\n      const availableIndices = Array.from({length: category.length}, (_, i) => i)\n        .filter(i => !fixedIndices.includes(i));\n      \n      // Get random selections from available indices\n      const randomSelections = getRandomItems(category, availableIndices, randomNeeded);\n      selections = selections.concat(randomSelections);\n    }\n    \n    // If we have more fixed items than requested, truncate to requested count\n    if (selections.length > randomCnt) {\n      selections = selections.slice(0, randomCnt);\n    }\n    \n    return selections;\n  }\n  \n  // Helper function to get random items from available indices\n  function getRandomItems(arr, availableIndices, count) {\n    if (availableIndices.length === 0 || count &lt;= 0) return [];\n    \n    // Shuffle available indices\n    const shuffled = [...availableIndices].sort(() => Math.random() - 0.5);\n    \n    // Take the first \'count\' indices (or all if not enough)\n    const selectedIndices = shuffled.slice(0, Math.min(count, shuffled.length));\n    \n    // Return the corresponding items\n    return selectedIndices.map(idx => arr[idx]);\n  }\n\n  // Apply selections for each category\n  finalArray = finalArray.concat(addSelections(色调, \'色调\', 色调cnt, 10));\n  finalArray = finalArray.concat(addSelections(构图, \'构图\', 构图cnt, 33));\n  finalArray = finalArray.concat(addSelections(紋理, \'紋理\', 紋理cnt, 10));\n  finalArray = finalArray.concat(addSelections(风格, \'风格\', 风格cnt, 50));\n  finalArray = finalArray.concat(addSelections(算法, \'算法\', 算法cnt, 10));\n  finalArray = finalArray.concat(addSelections(形容词, \'形容词\', 形容词cnt, 50));\n  finalArray = finalArray.concat(addSelections(物件, \'物件\', 物件cnt, 10));\n  finalArray = finalArray.concat(addSelections(场景, \'场景\', 场景cnt, 15));\n\n  // Clean up the final string\n  let finalString = finalArray.join(\', \').replace(/,(\s*,)+/g, \', \');\n  document.querySelector(\'#question\').innerHTML = finalString;\n  return finalArray;\n}\n\n// Create a button to trigger the browser UI\nfunction createFixedSelectionButton() {\n  const button = document.createElement(\'button\');\n  button.textContent = \'选择固定项目\';\n  button.style.cssText = `\n    padding: 10px 20px;\n    margin: 10px 0;\n    background: #2196F3;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n  `;\n  button.onclick = browseAndSelectFixedSelections;\n  \n  // Insert the button before the #question element\n  const questionDiv = document.querySelector(\'#question\');\n  if (questionDiv && questionDiv.parentNode) {\n    questionDiv.parentNode.insertBefore(button, questionDiv);\n  }\n  \n  return button;\n}\n\n// Also update the existing function to show current selections\ndocument.addEventListener(\'DOMContentLoaded\', function() {\n  // Create the browse button\n  createFixedSelectionButton();\n  \n  // Add some CSS for better UI\n  const style = document.createElement(\'style\');\n  style.textContent = `\n    .category-items input[type="checkbox"] {\n      margin-right: 5px;\n    }\n    \n    .category-items label:hover {\n      background: #e3f2fd;\n      padding: 2px 5px;\n      border-radius: 3px;\n    }\n    \n    #fixedSelectionUI {\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      max-width: 90%;\n      max-height: 90vh;\n      overflow-y: auto;\n      z-index: 1000;\n      box-shadow: 0 0 20px rgba(0,0,0,0.3);\n    }\n    \n    .category-section {\n      max-height: 200px;\n      overflow-y: auto;\n      border: 1px solid #ddd;\n    }\n  `;\n  document.head.appendChild(style);\n});\n',
];