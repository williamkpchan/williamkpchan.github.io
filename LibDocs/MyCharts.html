

<!DOCTYPE html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>尋寶機</title>

<link href="..\maincss.css" rel="stylesheet" type="text/css">
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="..\js\jquery.mobile-1.4.5.min.js"></script>
<script type='text/javascript' src='..\mainscript.js'></script>

<style>
html,body { -webkit-text-size-adjust:none; }
body {
  background-color: black  !important;
  color: gray;
  justify-content: center;
  align-content: center;
}
#stkChart {font-size: 18px; font-weight:lighter;}
img{width:100%;}
a:visited { color: #389898;}

</style>

</head>

<body onkeypress="chkKey()">
<center>
	<div id="mainFrame">
	<b class="ulleft" onclick="window.open('mailto:williamkpchan@gmail.com?subject=HK Stk Chart Suggestion&body=some suggestions:');">Suggestions</b>

	<button class="orangeb" onclick=showSmallChart()>尋寶</button>
	<button class="greenb" onclick=shortSCt()>分鐘圖</button>
	<button class="goldb" onclick=addToHeedCodeList()>&hearts;</button>
	<a href="heedChart.html" target="_blank"><span class="whiteb">關注組</span></a> 
	<a href="Hour STK Charts.html" target="_blank"><span class="goldblackb">指標</span></a> 


	<button id="jumpButton" onclick=jpButClick()>Stks Left: <span id="stkChartsLeft"></span></button>
	<button onclick=jpback()>back</button>
	<br>
	<div id="dateTime" style="text-align:center;"> </div>

	<div id="stkChart" style="text-align:center;"> </div><br>
	</div>
</center>

<script>
// List of Q & A
var stkChartList = [
'1041',
'1157',
'1383',
'142',
'1613',
'1766',
'1810',
'1816',
'2098',
'2338',
'2380',
'2779',
'327',
'3339',
'3918',
'631',
'7312',
'7328',
'763',
'110000',
'600115.sh',
'601766.sh',
'000725.sz',
];

var remainChtNo = stkChartList.length;
var thecode ="";

function shuffle() {
 var listlen = stkChartList.length, j = 0, temp;

 while (listlen--) {
  j = Math.floor(Math.random() * (listlen+1));

  temp = stkChartList[listlen];
  stkChartList[listlen] = stkChartList[j];
  stkChartList[j] = temp;
 }
}

function showSTKChart() {
  remainChtNo = remainChtNo - 1;
  var pointer = remainChtNo;
  thecode = stkChartList[pointer];

  document.querySelector('#stkChartsLeft').innerHTML = remainChtNo;
  sSCt(thecode);
  document.querySelector('#jumpButton').focus();
}


function jpButClick() {
  var jpBut = document.querySelector('#jumpButton');
  if (remainChtNo > 0) {showSTKChart();}
  if (remainChtNo === 0) {
      jpBut.innerHTML = 'Bye!';
      jpBut.classList.add('disabled');
  }
}

function jpback() {
  remainChtNo = remainChtNo + 2;
  if (remainChtNo <= stkChartList.length){
	jpButClick();
  } else {
	remainChtNo = stkChartList.length -1;
  }
}


function chkKey() {
  var testkey = getChar(event);
  if(testkey == 'f'){jpButClick();}
  if(testkey == 'b'){jpback();}
  if(testkey == 'c'){showSmallChart();}
  if(testkey == '+'){addToHeedCodeList();}
  if(testkey == 'g'){window.open("heedChart.html", "_blank");}
  if(testkey == 'h'){window.open("Hour STK Charts.html", "_blank");}
  if(testkey == 'm'){shortSCt();}

  jQuery("#mainframe").on( "swipeleft", function( event ) {jpback();} );
  jQuery("#mainframe").on( "swiperight", function( event ) {jpButClick();});
}
function getChar(event) {
  if (event.which!=0 && event.charCode!=0) {
    return String.fromCharCode(event.which)   // the rest
  } else {
    return null // special key
  }
}

function showSmallChart() {
    thecode = prompt("Code Number:", "");
    if (thecode != null && thecode != "") {sSCt(thecode);}
}

function sSCt(stkcode) {
  imgHead = "<img src='http://charts.aastocks.com/servlet/Charts?fontsize=12&15MinDelay=F&lang=1&titlestyle=1&vol=1&Indicator=9&indpara1=20&indpara2=2&indpara3=0&indpara4=0&indpara5=0&subChart1=3&ref1para1=5&ref1para2=10&ref1para3=3&subChart2=3&ref2para1=12&ref2para2=26&ref2para3=9&subChart3=12&ref3para1=0&ref3para2=0&ref3para3=0&scheme=3&com=100&chartwidth=1050&chartheight=690&stockid=";
  imgPCode= "&period=";
  imgTail="&type=1&logoStyle=1'><br>";

  intv = [4, 7, 11, 12];
  newshead = "http://www.aastocks.com/tc/stocks/analysis/stock-aafn/"
  newstail = "/0/all/1"
  newsStr = newshead + stkcode + newstail
  imgAdr = "<a href='" + newsStr + "' target = _blank>" + stkcode + "</a><br>" 

  for( var imgPeriod = 0; imgPeriod < intv.length; imgPeriod++){
    imgAdr = imgAdr + imgHead + stkcode + imgPCode + intv[imgPeriod] + imgTail;
  };
    document.getElementById("stkChart").innerHTML = imgAdr;
    showDateTime();
}

function shortSCt() {
  var stkcode = thecode;
  imgHead = "<img src='http://charts.aastocks.com/servlet/Charts?fontsize=12&15MinDelay=F&lang=1&titlestyle=1&vol=1&Indicator=9&indpara1=20&indpara2=2&indpara3=0&indpara4=0&indpara5=0&subChart1=3&ref1para1=5&ref1para2=10&ref1para3=3&subChart2=3&ref2para1=12&ref2para2=26&ref2para3=9&subChart3=12&ref3para1=0&ref3para2=0&ref3para3=0&scheme=3&com=100&chartwidth=1050&chartheight=690&stockid=";
  imgPCode= "&period=";
  imgTail="&type=1&logoStyle=1'><br>";

  intv = [5000,2];
  newshead = "http://www.aastocks.com/tc/stocks/analysis/stock-aafn/"
  newstail = "/0/all/1"
  newsStr = newshead + stkcode + newstail
  imgAdr = "<a href='" + newsStr + "' target = _blank>" + stkcode + "</a><br>" 

  for( var imgPeriod = 0; imgPeriod < intv.length; imgPeriod++){
    imgAdr = imgAdr + imgHead + stkcode + imgPCode + intv[imgPeriod] + imgTail;
  };
    document.getElementById("stkChart").innerHTML = imgAdr;
    showDateTime();
}

if (localStorage.getItem("savedCodeList") === null) {
  heedCodeList = [];
  localStorage.savedCodeList = JSON.stringify(heedCodeList);
} else{
  heedCodeList = JSON.parse(localStorage.savedCodeList);
}

function addToHeedCodeList() {
  heedCodeList = JSON.parse(localStorage.savedCodeList);
  if (!heedCodeList.includes(thecode)) {
    heedCodeList.push(thecode);
    heedCodeList = Array.from(new Set(heedCodeList))
    localStorage.savedCodeList = JSON.stringify(heedCodeList);
  }
}

function showDateTime() {
    var theDateTime = showDate() +" "+ showTime();
    document.getElementById("dateTime").innerHTML = theDateTime;
}

shuffle();
showSTKChart();

</script>
</body>
</html>
