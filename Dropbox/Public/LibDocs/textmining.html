<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><base target=_blank><style>body { margin: 10%; font-size: 24px; background-color: #000000; color: #109030;}a { text-decoration: none; color: #28B8B8;}a:visited { color: #389898;}A:hover { color: yellow;}A:focus { color: red;}code { color: pink; background-color: #001500}pre { color: gray; background-color: #001010}</style>
                <h1>Text Mining</h1>
                <p>When it comes down to it R does a really good job handling structured data like matrices and data frames. However, its ability to work with unstructured data is still a work in progress. It can and it does handle text mining but the documentation is incomplete and the capabilities still don&#8217;t compare to other programs such as MALLET or Mahout.</p>
<p>Though the formal documentation is still lacking. Though this is not an example on real data it does provide the basic tools on text mining and, in particular,<em> latent dirichlet allocation</em>.</p>
<p>There are three R libraries that are useful for text mining: <em>tm</em>, <em>RTextTools</em>, and <em>topicmodels</em>. The tm library is the core of text mining capabilities in R.</p>
<p>Unstructured text files can come in many different formats. I often find that I must get my own data and consequently the data generally originates as plain text (.txt) files. However, those who want to analyze Twitter feeds can user the <em>twitteR</em> library which is useful for analyzing social media topics in real time. This example will incorporate the CNN twitter feed.</p>
<p>In order for R to interpret and analyze these text files they must ultimately be converted into a <em>document term matrix</em>. But first a <em>corpus</em> must be created. A corpus is simply a collection of documents where each document its a topic.</p>
<p>When reading text documents directly from local file the following R code can be used.</p>
<p><strong>Data Preparation using Local Text Files</strong></p>
<pre class="brush: css">

#These files can be just raw text. For example it could be simply copied and pasted from a Web site.
dir = &quot;C:\\Documents and Settings\\clints\\My Documents\\LDA-S&quot;;
filenames = list.files(path=dir,pattern=&quot;\\.txt&quot;);
setwd(dir);

docs = NULL;
titles = NULL;

for (filename in filenames){
#here I specify a file that contains all the titles of the documents
if(filename==&quot;titles.txt&quot;){
titles = paste(readLines(file(filename)));
} else {
docs = c(docs,list( paste(readLines(file(filename)), collapse=&quot;\n&quot;) ));
}
}

</pre>
<p>To pull the text from a Twitter Feed rather than text files then the following lines of code can be used.</p>
<p><strong>Data Preparation using Twitter</strong></p>
<pre class="brush: css">

library(tm);
library(RTextTools);
library(topicmodels);
library(twitteR);

twitter_feed &lt;- searchTwitter(&#039;@cnn&#039;, n=150);

### Optional twitter feed retrieval
##twitter_feed &lt;- userTimeline(&quot;rdatamining&quot;, n=150);
###

df &lt;- do.call(&quot;rbind&quot;, lapply(twitter_feed, as.data.frame));
myCorpus &lt;- Corpus(VectorSource(df$text));

k = length(docs3);
myCorpus = Corpus(VectorSource(docs));
myCorpus = tm_map(myCorpus, tolower);
myCorpus = tm_map(myCorpus, removePunctuation);
myCorpus = tm_map(myCorpus, removeNumbers);
myStopwords = c(stopwords(&#039;english&#039;), &quot;available&quot;, &quot;via&quot;);
idx = which(myStopwords == &quot;r&quot;);
myStopwords = myStopwords[-idx];
myCorpus = tm_map(myCorpus, removeWords, myStopwords);

dictCorpus = myCorpus;

myCorpus = tm_map(myCorpus, stemDocument);

myCorpus = tm_map(myCorpus, stemCompletion, dictionary=dictCorpus);

myDtm = DocumentTermMatrix(myCorpus, control = list(minWordLength = 3));

findFreqTerms(myDtm, lowfreq=50);
#find the probability a word is associated
findAssocs(myDtm, &#039;find_a_word&#039;, 0.5);

</pre>
<p><strong>Word Cloud</strong></p>
<pre class="brush: css">

library(wordcloud);
m = as.matrix(myDtm);
v = sort(colSums(m), decreasing=TRUE);
myNames = names(v);
k = which(names(v)==&quot;miners&quot;);
myNames[k] = &quot;mining&quot;;
d = data.frame(word=myNames, freq=v);
wordcloud(d$word, colors=c(3,4), random.color=FALSE, d$freq, min.freq=20);

</pre>
<p><a href="https://i0.wp.com/statistical-research.com/wp-content/uploads/2012/10/Rplot.png" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://statistical-research.com/wp-content/uploads/2012/10/Rplot.png', '']);" rel="nofollow" target="_blank"><img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i1.wp.com/statistical-research.com/wp-content/uploads/2012/10/Rplot-300x163.png?resize=300%2C163" class="aligncenter size-medium wp-image-640" title="Word Cloud for CNN" alt  data-recalc-dims="1"><noscript><img class="aligncenter size-medium wp-image-640" title="Word Cloud for CNN" src="https://i1.wp.com/statistical-research.com/wp-content/uploads/2012/10/Rplot-300x163.png?resize=300%2C163" alt="" data-recalc-dims="1" /></noscript></a></p>
<p><strong>Latent Dirichlet Allocation</strong></p>
<pre class="brush: css">

k = 2;
SEED = 1234;
my_TM =
list(VEM = LDA(myDtm, k = k, control = list(seed = SEED)),
VEM_fixed = LDA(myDtm, k = k,
control = list(estimate.alpha = FALSE, seed = SEED)),
Gibbs = LDA(myDtm, k = k, method = &quot;Gibbs&quot;,
control = list(seed = SEED, burnin = 1000,
thin = 100, iter = 1000)),
CTM = CTM(myDtm, k = k,
control = list(seed = SEED,
var = list(tol = 10^-4), em = list(tol = 10^-3))));

Topic = topics(my_TM[[&quot;VEM&quot;]], 1);

#top 5 terms for each topic in LDA
Terms = terms(my_TM[[&quot;VEM&quot;]], 5);
Terms;

(my_topics =
topics(my_TM[[&quot;VEM&quot;]]));

most_frequent = which.max(tabulate(my_topics));

terms(my_TM[[&quot;VEM&quot;]], 10)[, most_frequent];

</pre>
<p>Here, a model is fit setting the number of unobserved latent topics equal to two (k=2).    We can then identify the most frequently occurring topics and then identify the top five terms used for the topic.  In this example these are the top five terms when setting the number of groups equal to two.</p>
<table class="aligncenter" width="241" border="0" cellspacing="0" cellpadding="0">
<colgroup>
<col width="117" />
<col width="124" /> </colgroup>
<tbody>
<tr>
<td width="117" height="20">Topic 1</td>
<td width="124">Topic 2</td>
</tr>
<tr>
<td height="20">&#8220;amp&#8221;</td>
<td>&#8220;cnn&#8221;</td>
</tr>
<tr>
<td height="20">&#8220;cnn&#8221;</td>
<td>&#8220;tweet&#8221;</td>
</tr>
<tr>
<td height="20">&#8220;jobs&#8221;</td>
<td>&#8220;abc&#8221;</td>
</tr>
<tr>
<td height="20">&#8220;romney&#8221;</td>
<td>&#8220;bainport&#8221;</td>
</tr>
<tr>
<td height="20">&#8220;sensata&#8221;</td>
<td>&#8220;cbs&#8221;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>

