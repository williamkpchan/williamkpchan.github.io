
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<style>

a:hover,a:active{color:red}
table.w3-table-all{margin:20px 0}
.top {
 position:relative;
 background-color:black;
 height:68px;
 padding-top:20px;
 line-height:50px;
 overflow:hidden;
 z-index:2;
}
body {
 background-color: #000000;
 color: MediumSeaGreen;
 margin-left: 14%;
 margin-right: 14%;
 font-size: 24px;
}
a { text-decoration: none;
	color: #58D858;}
a:visited { color: #88C898;}
A:hover {	color: yellow;}
A:focus {	color: red;}
code { color: gray; background-color: #002010}
pre { color: gray; background-color: #001010;  font-size: 20px;}
h1, h2, h3, h4, h5, .goldword {
	color: gold;
}
img { display: inline-block; width: 900px; margin-bottom: 2%; margin-top: 2%;}
table{
	width: 100%;
	font-size: 20px;
	border-collapse: collapse;
	border: 1px solid gray;
}
th{
	border: 1px solid gray;
	font-weight:bold;
	color: lightgreen;
}
td{
	padding:10px;
	border: 1px dotted dimgray;
}}
tr>th:first-child{
	width:40%;
}
tr>td:first-child{
	color: lime;

}
.topic{
    color: lime;
}
.left {
    position: absolute;
    left: 100px;
    color: GoldenRod;
    border: 1px solid GoldenRod;
    padding: 2px;
    font-size: 60%;
}
.bord {
    color: redpink;
    border: 1px solid GoldenRod;
    padding: 1px;
    font-size: 90%;
}
.highlight { 
    color: white;
    background-color: #002030
  }
hr {width: 50%;}
li{
	list-style-type: decimal;
}
#toc, #tang, #san, #pill {
	margin-left: 28%;
	margin-right: 28%;
	color: gold;
	padding: 1%;
	text-align: left;
	box-shadow: 5px 5px 15px silver;
	border-radius: 5px;
	border: 1px solid DarkSlateGray;
    font-size: 90%;
}
.mywords{
    color: Crimson;
}
.orangeword{
    color: orange;
}
.remarks {
	font-size: 22px;
	color: MediumSeaGreen;
}
</STYLE>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script>
$(document).ready(function(){
    $('h1, h2, h3, h4, h5, .goldword, .topic').click(function(){
    parent.history.back();
    return false;
    });
});
</script>


</head><body>

<center><h1>Build Node.js RESTful APIs in 10 Minutes</h1></center>
<div id="toc"><ul></ul></div>
<br>
<br>
<br>


<h3 id="what-is-rest">
 What is REST?
</h3>
<p>

<a href="https://www.codementor.io/restful/tutorial/rest-api-design-best-practices-strategy" title="REST API Tutorial: How to Design a Sustainable Web API" target="_blank" rel="nofollow">
REST
</a>
 is an acronym for Representational State Transfer. It is web standards architecture and HTTP Protocol. The REST architectural style describes six constraints that were originally communicated by Roy Fielding in his doctoral dissertation and defines the basis of RESTful-style as:
</p>
<ol>
<li>Uniform Interface</li>
<li>Stateless</li>
<li>Cacheable</li>
<li>Client-Server</li>
<li>Layered System</li>
<li>Code on Demand (optional)</li>
</ol>
<p>
RESTful applications use HTTP requests to perform four operations termed as CRUD (C: create, R: read, U: update, and D: delete). Create and/or update is used to post data, get for reading/listing data, and delete to remove data.
</p>
<p>
RESTful is composed of methods such as; base URL, URL, media types, etc.
</p>
<p>
In this tutorial, we will learn how to create a RESTful API using Node.js.
</p>
<h3 id="tools">
 Tools:
</h3>
<ul>
<li>Node.js</li>
<li>MongoDB</li>
<li>Text editor (Atom, Sublime, etc) 
<em>
(Read more: 
<a href="https://www.codementor.io/mattgoldspink/tutorials/best-text-editor-atom-sublime-vim-visual-studio-code-du10872i7" target="_blank" rel="nofollow">
Best Text Editor? Atom vs Sublime vs Visual Studio Code vs Vim
</a>
)
</em>
</li>
<li>
<a href="https://www.getpostman.com/" title="Postman" target="_blank" rel="nofollow">
Postman
</a>
</li>
</ul>
<h2 id="getting-started">

<a class="header-anchor" href="#getting-started" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Getting started
</h2>
<p>
For the purpose of this tutorial, I’ll work you through creating a RESTful API. To achieve this, we will create a 
<a href="https://github.com/generalgmt/RESTfulAPITutorial" target="_blank" rel="nofollow">
RESTful todo list API
</a>
 (i.e. endpoints that will create a task, get or read list of all tasks, read a particular task, delete a task, and update a task).
</p>
<h3 id="assumptions">

<a class="header-anchor" href="#assumptions" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Assumptions
</h3>
<p>
I presume that you already have your environment set up (i.e 
<a href="https://www.codementor.io/mercurial/tutorials/how-to-install-node-js-on-macos-sierra-mphz41ekk" title="Beginners Guide to Node.js: Installing Node on MacOS Sierra" target="_blank" rel="nofollow">
Node.js
</a>
 and MongoDB is installed).
</p>
<p>
Kindly run 
<code>
npm -v
</code>
 and 
<code>
mongo --version
</code>
 as these will show you the version of NPM and MongoDB installed on your machine.
</p>
<p>
If you don’t have it installed, kindly go through this 
<a href="https://nodejs.org/en/download/package-manager/" target="_blank" rel="nofollow">
link
</a>
 on how to install it in order for us to create a server in Node and 
<a href="https://docs.mongodb.com/manual/installation/" target="_blank" rel="nofollow">
Mongodb
</a>
.
</p>
<p>
If you do have Node and MongoDB installed, let's begin the tutorial with the following basic steps.
</p>
<p>
Open your terminal and kindly follow the following steps
</p>
<ol>
<li><p>
Create a Folder name todoListApi - 
<code>
mkdir todoListApi
</code>

</p></li>
<li><p>
Navigate to the root of your newly created folder - 
<code>
cd todoListApi
</code>

</p></li>
<li><p>
Create a package.json file -  
<code>
npm init
</code>

<br>

Package.json is a file that gives the necessary information to npm which allows it to identify the project as well as handle the project's dependencies.
<br>

npm init will prompt you to enter some information such as the app name, description, version, author, keyword and also ask if what you see is what you like.
<br>

You should have something like this eventually.  
<img src="https://process.filestackapi.com/cache=expiry:max/mPxbjkhSyGL5UeQh4p8r">

<br>

Kindly type yes and press enter to complete the creation of our package.json.
<br>

Having done all these, your folder structure should look like this:
<br>
<img src="https://process.filestackapi.com/cache=expiry:max/gpa5sf7jSLaSNaWejgLT">

</p></li>
<li><p>
Create a file called server.js - 
<code>
touch server.js
</code>
.
<br>

In this server, we will writing the protocols to create our server.
</p></li>
<li><p>
Create a folder called api - 
<code>
mkdir api
</code>

<br>

Inside this folder called api, create three separate folders called models, routes, and controllers by running 
<code>
mkdir api/controllers api/models api/routes
</code>

<br>
<img src="https://process.filestackapi.com/cache=expiry:max/wle7h8qgRUmerGD5rvH1">

</p></li>
<li><p>
Create todoListController.js in the api/controller folder, todoListRoutes.js in the routes folder, and todoListModel in the model folder - 
<code>
touch api/controllers/todoListController.js api/models/todoListModel.js api/routes/todoListRoutes.js
</code>

</p></li>
</ol>
<p>
Our folder structure should look like this now:
<br>
<img src="https://process.filestackapi.com/cache=expiry:max/aQE9GO2JQWWBuckE1HZh">

</p>
<h2 id="server-setup">

<a class="header-anchor" href="#server-setup" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Server setup
</h2>
<p>
Let's install express and nodmon, express will be used to create the server while nodmon will help us to keep track of changes to our application by watching changed files and automatically restart the server.
</p>
<p>

<code>
npm install --save-dev nodemon
</code>

</p>
<p>

<code>
npm install express --save
</code>

</p>
<p>
On successful installation, your package.json file will be modified to have the two newly installed packages.
</p>
<ol>
<li>Open the package.json file and add this task to the script</li>
</ol>
<blockquote>
<p>
&quot;start&quot;: &quot;nodemon server.js&quot;
<br>
<img src="https://process.filestackapi.com/cache=expiry:max/CeA6dsyeRayf3J2p4myM">

</p>
</blockquote>
<ol start="2">
<li>Open the server.js file and type/copy the code below into it</li>
</ol>
<pre>

<code>
var express = require('express'),
  app = express(),
  port = process.env.PORT || 3000;

app.listen(port);

console.log('todo list RESTful API server started on: ' + port);
</code>

</pre>
<p>

<img src="https://process.filestackapi.com/cache=expiry:max/yjlM1FQIQtOYF3zYBmUA">

</p>
<p>
3.On your terminal, run 
<code>
npm run start
</code>
 this will start the server and then you will see
</p>
<blockquote>
<p>
todo list RESTful API server started on: 3000
</p>
</blockquote>
<h3 id="setting-up-the-schema">

<a class="header-anchor" href="#setting-up-the-schema" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Setting up the schema
</h3>
<p>
Firsr of all, let’s install mongoose - 
<code>
npm install mongoose --save
</code>

</p>
<h4 id="why-mongoose">

<a class="header-anchor" href="#why-mongoose" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Why Mongoose?
</h4>
<p>
Mongoose is what we will use to interact with a MongoDB(Database) instance.
<br>

After installation, open the todoListModel.js file in your api/models folder and type the following code into the file and save.
</p>
<pre>

<code>

'use strict';
var mongoose = require('mongoose');
var Schema = mongoose.Schema;
var TaskSchema = new Schema({
  name: {
    type: String,
    required: 'Kindly enter the name of the task'
  },
  Created_date: {
    type: Date,
    default: Date.now
  },
  status: {
    type: [{
      type: String,
      enum: ['pending', 'ongoing', 'completed']
    }],
    default: ['pending']
  }
});

module.exports = mongoose.model('Tasks', TaskSchema);

</code>

</pre>
<p>
From the code above, we required the mongoose in our file and then, we create a model of how our collection should look like.
<br>

As you can see, it the task collection(table) will contain a name: a string, and the date it was created. It also contains task status which we have defined as pending - a default value for every task created.
</p>
<h3 id="setting-up-the-routes">

<a class="header-anchor" href="#setting-up-the-routes" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Setting up the routes
</h3>
<p>
Routing refers to determining how an application responds to a client request for a specific endpoint, which is a URI (or path) and a specific HTTP request method (GET, POST, and so on).
<br>

Each of our routes has different route handler functions, which are executed when the route is matched.
<br>

Below we have defined two basic routes(‘/tasks’, and ‘/tasks/taskId’) with different methods
<br>

‘/tasks’ has to methods(‘GET’ and ‘POST’), while ‘/tasks/taskId’ has GET, PUT and DELETE.
<br>

As you can see, we required the controller so each of the routes methods can call it’s respective handler function.
</p>
<p>
To do this, open the todoListRoutes.js file in the route folder and paste the code snippet below into
</p>
<pre>

<code>
'use strict';
module.exports = function(app) {
  var todoList = require('../controllers/todoListController');

  // todoList Routes
  app.route('/tasks')
    .get(todoList.list_all_tasks)
    .post(todoList.create_a_task);
  app.route('/tasks/:taskId')
    .get(todoList.read_a_task)
    .put(todoList.update_a_task)
    .delete(todoList.delete_a_task);
};
</code>

</pre>
<h2 id="setting-up-the-controller">

<a class="header-anchor" href="#setting-up-the-controller" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Setting up the controller
</h2>
<p>
Open todoListController.js file with your text editor( Sublime, Atom e.t.c) and let’s deep dive into coding.
</p>
<p>
In this controller, we would be writing five(5) different functions namely: list_all_tasks,  create_a_task, read_a_task, update_a_task, delete_a_task. We will exported each of the functions for us to use in our routes.
<br>

Each of these functions uses different mongoose methods such as find, findById, findOneAndUpdate, save and remove.
</p>
<pre>

<code>
'use strict';
var mongoose = require('mongoose'),
  Task = mongoose.model('Tasks');

exports.list_all_tasks = function(req, res) {
  Task.find({}, function(err, task) {
    if (err)
      res.send(err);
    res.json(task);
  });
};


exports.create_a_task = function(req, res) {
  var new_task = new Task(req.body);
  new_task.save(function(err, task) {
    if (err)
      res.send(err);
    res.json(task);
  });
};
exports.read_a_task = function(req, res) {
  Task.findById(req.params.taskId, function(err, task) {
    if (err)
      res.send(err);
    res.json(task);
  });
};
exports.update_a_task = function(req, res) {
  Task.findOneAndUpdate({_id: req.params.taskId}, req.body, {new: true}, function(err, task) {
    if (err)
      res.send(err);
    res.json(task);
  });
};
exports.delete_a_task = function(req, res) {
  Task.remove({
    _id: req.params.taskId
  }, function(err, task) {
    if (err)
      res.send(err);
    res.json({ message: 'Task successfully deleted' });
  });
};


</code>

</pre>
<h2 id="putting-everything-together">

<a class="header-anchor" href="#putting-everything-together" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Putting everything together
</h2>
<p>
Earlier on, we had a minimal code for our server to be up and running in the server.js file.
<br>

In this section we will be connecting our handlers(controllers), database, the created models, body parser and the created routes together.
</p>
<p>
Open the server.js file created awhile ago and follow the following steps to put everything together.
<br>

Essentially, you will be replacing the code in your server.js with the code snippet from this section
</p>
<ol>
<li>Connect your database by adding a url to the mongoose instance connection</li>
<li>Load the created model - task</li>
<li>Install bodyParser and use
<br>

bodyParser Parse incoming request bodies in a middleware before your handlers, available under the req.body property.
<br>

It exposes various factories to create middlewares. All middlewares will populate the req.bodyproperty with the parsed body, or an empty object ({}) if there was no body to parse (or an error was returned).</li>
<li>Register our created routes in the server</li>
</ol>
<pre>

<code>
var express = require('express'),
  app = express(),
  port = process.env.PORT || 3000,
  mongoose = require('mongoose'),
  Task = require('./api/models/todoListModel'), //created model loading here
  bodyParser = require('body-parser');
  
// mongoose instance connection url connection
mongoose.Promise = global.Promise;
mongoose.connect('mongodb://localhost/Tododb'); 
app.use(bodyParser.urlencoded({ extended: true }));
app.use(bodyParser.json());
var routes = require('./api/routes/todoListRoutes'); //importing route
routes(app); //register the route
app.listen(port);
console.log('todo list RESTful API server started on: ' + port);
</code>

</pre>
<p>
5.Start MongoDB Server
</p>
<p>
Open your terminal and run 
<code>
mongod
</code>

</p>
<p>
This will start your MongoDB server and then, node server could connect to the MongoDB instance. Once your MongoDB server is running, restart your node server by running: 
<code>
rs
</code>
 on your nodemon running terminal.
</p>
<h2 id="testing-via-postman">

<a class="header-anchor" href="#testing-via-postman" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Testing via Postman
</h2>
<p>
Now that everything is now connected, let’s test each of the routes and the respective methods.
</p>
<p>
Open your postman and type:
</p>
<ol>
<li>
<a href="http://localhost:3000/tasks" target="_blank" rel="nofollow">
http://localhost:3000/tasks
</a>
 in the enter request URL section and press enter.
<br>
<img src="https://process.filestackapi.com/cache=expiry:max/od4XNJbDSBq6QzE2nNBR">

<br>

On enter, you should see “[]” because there is nothing in the database yet.</li>
<li>On the same address, change the method to POST, click body and select “x-www-form-urlencoded”.
<br>

Then, enter name as the key and the corresponding task name as value.
<br>

After this, click on send button.
<br>

This should give you a response 200 ok</li>
</ol>
<p>

<img src="https://process.filestackapi.com/cache=expiry:max/zjDlUAGWSdaZeonyxgkV">

</p>
<h2 id="adding-a-middleware">

<a class="header-anchor" href="#adding-a-middleware" aria-hidden="true">

<i class="fa fa-link" aria-hidden="true">

</i>

</a>
 Adding a middleware
</h2>
<p>
Having done all these, what happens if we entered a wrong route? say you entered 'http://localhost:3000/task', It responds with a message “Cannot GET /task”. Let’s add express middleware which could be used to return more interactive messages.
</p>
<p>
Middlewares basically intercepts incoming http request and as such you can use them to perform several operations ranging from authentication to validations etc.
</p>
<p>
To do this, open your server.js file and paste the code snippet into it.
</p>
<pre>

<code>
app.use(function(req, res) {
  res.status(404).send({url: req.originalUrl + ' not found'})
});

</code>

</pre>
<p>
The snippet above helps to redirect and respond whenever a wrong route is entered on the site.
</p>

<br>
<br><br><br><br><br>
<script>
  $(function() {
    var toc = $('#toc>ul');

    function makeLi(text, href) {
      return $('<li><a href="' + href + '" target="_self">' + text + '</a></li>');
    }

    $('h2,h3').each(function(i) {
      var chapter = $(this), chapterNumber = i + 1;
      toc.append(
        makeLi(chapter.text(), '#chapter-' + chapterNumber)
      );
      chapter.attr('id', 'chapter-' + chapterNumber);
    });

  });
</script>
</body>
</html>
