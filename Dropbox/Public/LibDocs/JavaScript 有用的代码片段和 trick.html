<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="submaincss.css">
<style>
ol{list-style-type:none;}
</style>

</head>
<body>

<h2>JavaScript 有用的代码片段和 trick</h2>


<blockquote>https://segmentfault.com/a/1190000011557368</blockquote>


<h4>浮点数取整</h4>
<pre>
<ol>
<li>const x = 123.4545;
</li><li>x &gt;&gt; 0; // 123
</li><li>~~x; // 123
</li><li>x | 0; // 123
</li><li>Math.floor(x); // 123
</li></ol></pre><blockquote>

注意：前三种方法只适用于32个位整数，对于负数的处理上和 <code>
<span>
Math.floor</span>
</code>
是不同的。
</blockquote>
<pre>
<ol>
<li>Math.floor(-12.53); // -13
</li><li>-12.53 | 0; // -12
</li></ol></pre>
<h4>生成6位数字验证码</h4>
<pre>
<ol>
<li>// 方法一
</li><li>('000000' + Math.floor(Math.random() * &nbsp;999999)).slice(-6);
</li>
<li>// 方法二
</li><li>Math.random().toString().slice(-6);
</li>
<li>// 方法三
</li><li>Math.random().toFixed(6).slice(-6);
</li>
<li>// 方法四
</li><li>'' + Math.floor(Math.random() * 999999);
</li></ol></pre>
<h4>16进制颜色代码生成</h4>
<pre>
<ol>
<li>(function() {
</li><li> &nbsp;return '#'+('00000'+
</li><li> &nbsp; &nbsp;(Math.random()*0x1000000&lt;&lt;0).toString(16)).slice(-6);
</li><li>}
)();
</li></ol></pre>
<h4>驼峰命名转下划线</h4>
<pre>
<ol>
<li>'componentMapModelRegistry'.match(/^[a-z][a-z0-9]+|[A-Z][a-z0-9]*/g).join('_').toLowerCase(); // component_map_model_registry
</li></ol></pre>
<h4>url查询参数转json格式</h4>
<pre>
<ol>
<li>// ES6
</li><li>const query = (search = '') =&gt; ((querystring = '') =&gt; (q =&gt; (querystring.split('&amp;').forEach(item =&gt; (kv =&gt; kv[0] &amp;&amp; (q[kv[0]] = kv[1]))(item.split('='))), q))({}
))(search.split('?')[1]);
</li>
<li>// 对应ES5实现
</li><li>var query = function(search) {
</li><li> &nbsp;if (search === void 0) { search = ''; }

</li><li> &nbsp;return (function(querystring) {
</li><li> &nbsp; &nbsp;if (querystring === void 0) { querystring = ''; }

</li><li> &nbsp; &nbsp;return (function(q) {
</li><li> &nbsp; &nbsp; &nbsp;return (querystring.split('&amp;').forEach(function(item) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return (function(kv) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return kv[0] &amp;&amp; (q[kv[0]] = kv[1]);
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;}
)(item.split('='));
</li><li> &nbsp; &nbsp; &nbsp;}
), q);
</li><li> &nbsp; &nbsp;}
)({}
);
</li><li> &nbsp;}
)(search.split('?')[1]);
</li><li>}
;
</li>
<li>query('?key1=value1&amp;key2=value2'); // es6.html:14 {key1: "value1", key2: "value2"}

</li></ol></pre>
<h4>获取URL参数</h4>
<pre>
<ol>
<li>function getQueryString(key){
</li><li> &nbsp;var reg = new RegExp("(^|&amp;)"+ key +"=([^&amp;]*)(&amp;|$)");
</li><li> &nbsp;var r = window.location.search.substr(1).match(reg);
</li><li> &nbsp;if(r!=null){
</li><li> &nbsp; &nbsp; &nbsp;return &nbsp;unescape(r[2]);
</li><li> &nbsp;}

</li><li> &nbsp;return null;
</li><li>}

</li></ol></pre>
<h4>n维数组展开成一维数组</h4>
<pre>
<ol>
<li>var foo = [1, [2, 3], ['4', 5, ['6',7,[8]]], [9], 10];
</li>
<li>// 方法一
</li><li>// 限制：数组项不能出现`,`，同时数组项全部变成了字符数字
</li><li>foo.toString().split(','); // ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]
</li>
<li>// 方法二
</li><li>// 转换后数组项全部变成数字了
</li><li>eval('[' + foo + ']'); // [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
</li>
<li>// 方法三，使用ES6展开操作符
</li><li>// 写法太过麻烦，太过死板
</li><li>[1, ...[2, 3], ...['4', 5, ...['6',7,...[8]]], ...[9], 10]; // [1, 2, 3, "4", 5, "6", 7, 8, 9, 10]
</li>
<li>// 方法四
</li><li>JSON.parse(`[${JSON.stringify(foo).replace(/\[|]/g, '')}
]`); // [1, 2, 3, "4", 5, "6", 7, 8, 9, 10]
</li>
<li>// 方法五
</li><li>const flatten = (ary) =&gt; ary.reduce((a, b) =&gt; a.concat(Array.isArray(b) ? flatten(b) : b), []);
</li><li>flatten(foo); // [1, 2, 3, "4", 5, "6", 7, 8, 9, 10]
</li>
<li>// 方法六
</li><li>function flatten(a) {
</li><li> &nbsp;return Array.isArray(a) ? [].concat(...a.map(flatten)) : a;
</li><li>}

</li><li>flatten(foo); // [1, 2, 3, "4", 5, "6", 7, 8, 9, 10]
</li></ol></pre><blockquote>

注：更多方法请参考《How to flatten nested array in JavaScript?》
</blockquote>

<h4>日期格式化</h4>
<pre>
<ol>
<li>// 方法一
</li><li>function format1(x, y) {
</li><li> &nbsp;var z = {
</li><li> &nbsp; &nbsp;y: x.getFullYear(),
</li><li> &nbsp; &nbsp;M: x.getMonth() + 1,
</li><li> &nbsp; &nbsp;d: x.getDate(),
</li><li> &nbsp; &nbsp;h: x.getHours(),
</li><li> &nbsp; &nbsp;m: x.getMinutes(),
</li><li> &nbsp; &nbsp;s: x.getSeconds()
</li><li> &nbsp;}
;
</li><li> &nbsp;return y.replace(/(y+|M+|d+|h+|m+|s+)/g, function(v) {
</li><li> &nbsp; &nbsp;return ((v.length &gt; 1 ? "0" : "") + eval('z.' + v.slice(-1))).slice(-(v.length &gt; 2 ? v.length : 2))
</li><li> &nbsp;}
);
</li><li>}

</li>
<li>format1(new Date(), 'yy-M-d h:m:s'); // 17-10-14 22:14:41
</li>
<li>// 方法二
</li><li>Date.prototype.format = function (fmt) { 
</li><li> &nbsp;var o = {
</li><li> &nbsp; &nbsp;"M+": this.getMonth() + 1, //月份 
</li><li> &nbsp; &nbsp;"d+": this.getDate(), //日 
</li><li> &nbsp; &nbsp;"h+": this.getHours(), //小时 
</li><li> &nbsp; &nbsp;"m+": this.getMinutes(), //分 
</li><li> &nbsp; &nbsp;"s+": this.getSeconds(), //秒 
</li><li> &nbsp; &nbsp;"q+": Math.floor((this.getMonth() + 3) / 3), //季度 
</li><li> &nbsp; &nbsp;"S": this.getMilliseconds() //毫秒 
</li><li> &nbsp;}
;
</li><li> &nbsp;if (/(y+)/.test(fmt)){
</li><li> &nbsp; &nbsp;fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
</li><li> &nbsp;}
 
</li><li> &nbsp;for (var k in o){
</li><li> &nbsp; &nbsp;if (new RegExp("(" + k + ")").test(fmt)){
</li><li> &nbsp; &nbsp; &nbsp;fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
</li><li> &nbsp; &nbsp;}

</li><li> &nbsp;}
 &nbsp; &nbsp; 
</li><li> &nbsp;return fmt;
</li><li>}

</li>
<li>new Date().format('yy-M-d h:m:s'); // 17-10-14 22:18:17
</li></ol></pre>
<h4>统计文字个数</h4>
<pre>
<ol>
<li>function wordCount(data) {
</li><li> &nbsp;var pattern = /[a-zA-Z0-9_\u0392-\u03c9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g;
</li><li> &nbsp;var m = data.match(pattern);
</li><li> &nbsp;var count = 0;
</li><li> &nbsp;if( m === null ) return count;
</li><li> &nbsp;for (var i = 0; i &lt; m.length; i++) {
</li><li> &nbsp; &nbsp;if (m[i].charCodeAt(0) &gt;= 0x4E00) {
</li><li> &nbsp; &nbsp; &nbsp;count += m[i].length;
</li><li> &nbsp; &nbsp;}
 else {
</li><li> &nbsp; &nbsp; &nbsp;count += 1;
</li><li> &nbsp; &nbsp;}

</li><li> &nbsp;}

</li><li> &nbsp;return count;
</li><li>}

</li>
<li>var text = '贷款买房，也意味着你能给自己的资产加杠杆，能够撬动更多的钱，来孳生更多的财务性收入。';
</li><li>wordCount(text); // 38
</li></ol></pre>
<h4>特殊字符转义</h4>
<pre>
<ol>
<li>function htmlspecialchars (str) {
</li><li> &nbsp;var str = str.toString().replace(/&amp;/g, "&amp;amp;").replace(/&lt;/g, "&amp;lt;").replace(/&gt;/g, "&amp;gt;").replace(/"/g, '&amp;quot;');
</li><li> &nbsp;return str;
</li><li>}

</li>
<li>htmlspecialchars('&amp;jfkds&lt;&gt;'); // "&amp;amp;jfkds&amp;lt;&amp;gt;"
</li></ol></pre>
<h4>动态插入js</h4>
<pre>
<ol>
<li>function injectScript(src) {
</li><li> &nbsp; &nbsp;var s, t;
</li><li> &nbsp; &nbsp;s = document.createElement('script');
</li><li> &nbsp; &nbsp;s.type = 'text/javascript';
</li><li> &nbsp; &nbsp;s.async = true;
</li><li> &nbsp; &nbsp;s.src = src;
</li><li> &nbsp; &nbsp;t = document.getElementsByTagName('script')[0];
</li><li> &nbsp; &nbsp;t.parentNode.insertBefore(s, t);
</li><li>}

</li></ol></pre>
<h4>格式化数量</h4>
<pre>
<ol>
<li>// 方法一
</li><li>function formatNum (num, n) {
</li><li> &nbsp;if (typeof num == "number") {
</li><li> &nbsp; &nbsp;num = String(num.toFixed(n || 0));
</li><li> &nbsp; &nbsp;var re = /(-?\d+)(\d{3}
)/;
</li><li> &nbsp; &nbsp;while (re.test(num)) num = num.replace(re, "$1,$2");
</li><li> &nbsp; &nbsp;return num;
</li><li> &nbsp;}

</li><li> &nbsp;return num;
</li><li>}

</li>
<li>formatNum(2313123, 3); // "2,313,123.000"
</li>
<li>// 方法二
</li><li>'2313123'.replace(/\B(?=(\d{3}
)+(?!\d))/g, ','); // "2,313,123"
</li>
<li>// 方法三
</li><li>function formatNum(str) {
</li><li> &nbsp;return str.split('').reverse().reduce((prev, next, index) =&gt; {
</li><li> &nbsp; &nbsp;return ((index % 3) ? next : (next + ',')) + prev
</li><li> &nbsp;}
);
</li><li>}

</li>
<li>formatNum('2313323'); // "2,313,323"
</li></ol></pre>
<h4>身份证验证</h4>
<pre>
<ol>
<li>function chechCHNCardId(sNo) {
</li><li> &nbsp;if (!this.regExpTest(sNo, /^[0-9]{17}
[X0-9]$/)) {
</li><li> &nbsp; &nbsp;return false;
</li><li> &nbsp;}

</li><li> &nbsp;sNo = sNo.toString();
</li>
<li> &nbsp;var a, b, c;
</li><li> &nbsp;a = parseInt(sNo.substr(0, 1)) * 7 + parseInt(sNo.substr(1, 1)) * 9 + parseInt(sNo.substr(2, 1)) * 10;
</li><li> &nbsp;a = a + parseInt(sNo.substr(3, 1)) * 5 + parseInt(sNo.substr(4, 1)) * 8 + parseInt(sNo.substr(5, 1)) * 4;
</li><li> &nbsp;a = a + parseInt(sNo.substr(6, 1)) * 2 + parseInt(sNo.substr(7, 1)) * 1 + parseInt(sNo.substr(8, 1)) * 6;
</li><li> &nbsp;a = a + parseInt(sNo.substr(9, 1)) * 3 + parseInt(sNo.substr(10, 1)) * 7 + parseInt(sNo.substr(11, 1)) * 9;
</li><li> &nbsp;a = a + parseInt(sNo.substr(12, 1)) * 10 + parseInt(sNo.substr(13, 1)) * 5 + parseInt(sNo.substr(14, 1)) * 8;
</li><li> &nbsp;a = a + parseInt(sNo.substr(15, 1)) * 4 + parseInt(sNo.substr(16, 1)) * 2;
</li><li> &nbsp;b = a % 11;
</li>
<li> &nbsp;if (b == 2) {
</li><li> &nbsp; &nbsp;c = sNo.substr(17, 1).toUpperCase();
</li><li> &nbsp;}
 else {
</li><li> &nbsp; &nbsp;c = parseInt(sNo.substr(17, 1));
</li><li> &nbsp;}

</li>
<li> &nbsp;switch (b) {
</li><li> &nbsp; &nbsp;case 0:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 1) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 1:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 0) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 2:
</li><li> &nbsp; &nbsp; &nbsp;if (c != "X") {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 3:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 9) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 4:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 8) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 5:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 7) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 6:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 6) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 7:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 5) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 8:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 4) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 9:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 3) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}

</li><li> &nbsp; &nbsp; &nbsp;break;
</li><li> &nbsp; &nbsp;case 10:
</li><li> &nbsp; &nbsp; &nbsp;if (c != 2) {
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;return false;
</li><li> &nbsp; &nbsp; &nbsp;}
;
</li><li> &nbsp;}

</li><li> &nbsp;return true;
</li><li>}

</li></ol></pre>
<h4>测试质数</h4>
<pre>
<ol>
<li>function isPrime(n) {
</li><li> &nbsp;return !(/^.?$|^(..+?)\1+$/).test('1'.repeat(n))
</li><li>}

</li></ol></pre>
<h4>统计字符串中相同字符出现的次数</h4>
<pre>
<ol>
<li>var arr = 'abcdaabc';
</li>
<li>var info = arr
</li><li> &nbsp; &nbsp;.split('')
</li><li> &nbsp; &nbsp;.reduce((p, k) =&gt; (p[k]++ || (p[k] = 1), p), {}
);
</li>
<li>console.log(info); //{ a: 3, b: 2, c: 2, d: 1 }

</li></ol></pre>
<h4>使用&nbsp;<code>
<span>
void0</span>
</code>
来解决&nbsp;<code>
<span>
undefined</span>
</code>
被污染问题</h4>
<pre>
<ol>
<li>undefined = 1;
</li><li>!!undefined; // true
</li><li>!!void(0); // false
</li></ol></pre>
<h4>单行写一个评级组件</h4>
<pre>
<ol>
<li>"★★★★★☆☆☆☆☆".slice(5 - rate, 10 - rate); 
</li></ol></pre>
<h4>JavaScript 错误处理的方式的正确姿势</h4>
<pre>
<ol>
<li>try {
</li><li> &nbsp; &nbsp;something
</li><li>}
 catch (e) {
</li><li> &nbsp; &nbsp;window.location.href =
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;"http://stackoverflow.com/search?q=[js]+" +
</li><li> &nbsp; &nbsp; &nbsp; &nbsp;e.message;
</li><li>}

</li></ol></pre>
<h4>匿名函数自执行写法</h4>
<pre>
<ol>
<li>( function() {}
() );
</li><li>( function() {}
 )();
</li><li>[ function() {}
() ];
</li>
<li>~ function() {}
();
</li><li>! function() {}
();
</li><li>+ function() {}
();
</li><li>- function() {}
();
</li>
<li>delete function() {}
();
</li><li>typeof function() {}
();
</li><li>void function() {}
();
</li><li>new function() {}
();
</li><li>new function() {}
;
</li>
<li>var f = function() {}
();
</li>
<li>1, function() {}
();
</li><li>1 ^ function() {}
();
</li><li>1 &gt; function() {}
();
</li></ol></pre>
<h4>两个整数交换数值</h4>
<pre>
<ol>
<li>var a = 20, b = 30;
</li><li>a ^= b;
</li><li>b ^= a;
</li><li>a ^= b;
</li>
<li>a; // 30
</li><li>b; // 20
</li></ol></pre>
<h4>数字字符转数字</h4>
<pre>
<ol>
<li>var a = '1';
</li><li>+a; // 1
</li></ol></pre>
<h4>最短的代码实现数组去重</h4>
<pre>
<ol>
<li>[...new Set([1, "1", 2, 1, 1, 3])]; // [1, "1", 2, 3]
</li></ol></pre>
<h4>用最短的代码实现一个长度为m(6)且值都n(8)的数组</h4>
<pre>
<ol>
<li>Array(6).fill(8); // [8, 8, 8, 8, 8, 8]
</li></ol></pre>
<h4>将argruments对象转换成数组</h4>
<pre>
<ol>
<li>var argArray = Array.prototype.slice.call(arguments);
</li>
<li>// ES6：
</li><li>var argArray = Array.from(arguments)
</li>
<li>// or
</li><li>var argArray = [...arguments];
</li></ol></pre>
<h4>获取日期时间缀</h4>
<pre>
<ol>
<li>// 获取指定时间的时间缀
</li><li>new Date().getTime();
</li><li>(new Date()).getTime();
</li><li>(new Date).getTime();
</li><li>// 获取当前的时间缀
</li><li>Date.now();
</li><li>// 日期显示转换为数字
</li><li>+new Date();
</li></ol></pre>
<h4>使用&nbsp;<code>
<span>
~x.indexOf('y')</span>
</code>
来简化&nbsp;<code>
<span>
x.indexOf('y')&gt;-1</span>
</code>
</h4>
<pre>
<ol>
<li>var str = 'hello world';
</li><li>if (str.indexOf('lo') &gt; -1) {
</li><li> &nbsp;// ...
</li><li>}

</li>
<li>if (~str.indexOf('lo')) {
</li><li> &nbsp;// ...
</li><li>}

</li></ol></pre>
<h4><code>
<span>
parseInt()</span>
</code>
&nbsp;or&nbsp;<code>
<span>
Number()</span>
</code>
</h4>

两者的差别之处在于<strong style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">
解析</strong>和<strong style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">
转换</strong>两者之间的理解。

解析<strong style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">
允许</strong>字符串中含有非数字字符，解析按从左到右的顺序，如果遇到非数字字符就停止。而转换<strong style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">
不允许</strong>出现非数字字符，否者会失败并返回NaN。
<pre>
<ol>
<li>var a = '520';
</li><li>var b = '520px';
</li>
<li>Number(a); // 520
</li><li>parseInt(a); // 520
</li>
<li>Number(b); // NaN
</li><li>parseInt(b); // 520
</li></ol></pre>
<code>
<span>
parseInt</span>
</code>
方法第二个参数用于指定转换的基数，ES5默认为10进制。
<pre>
<ol>
<li>parseInt('10', 2); // 2
</li><li>parseInt('10', 8); // 8
</li><li>parseInt('10', 10); // 10
</li><li>parseInt('10', 16); &nbsp;// 16
</li></ol></pre>
对于网上 <code>
<span>
parseInt(0.0000008)</span>
</code>
的结果为什么为8，原因在于0.0000008转换成字符为"8e-7"，然后根据 <code>
<span>
parseInt</span>
</code>
的解析规则自然得到"8"这个结果。

<h4>+ 拼接操作，+x or String(x)？</h4>

+运算符可用于数字加法，同时也可以用于字符串拼接。如果+的其中一个操作符是字符串(或者通过 隐式强制转换可以得到字符串)，则执行字符串拼接；否者执行数字加法。

需要注意的时对于数组而言，不能通过 <code>
<span>
valueOf()</span>
</code>
方法得到简单基本类型值，于是转而调用 <code>
<span>
toString()</span>
</code>
方法。
<pre>
<ol>
<li>[1,2] + [3, 4]; // "1,23,4"
</li></ol></pre>
对于对象同样会先调用 <code>
<span>
valueOf()</span>
</code>
方法，然后通过 <code>
<span>
toString()</span>
</code>
方法返回对象的字符串表示。
<pre>
<ol>
<li>var a = {}
;
</li><li>a + 123; // "[object Object]123"
</li></ol></pre>
对于 <code>
<span>
a+""</span>
</code>
隐式转换和 <code>
<span>
String(a)</span>
</code>
显示转换有一个细微的差别： <code>
<span>
a+''</span>
</code>
会对a调用 <code>
<span>
valueOf()</span>
</code>
方法，而 <code>
<span>
String()</span>
</code>
直接调用 <code>
<span>
toString()</span>
</code>
方法。大多数情况下我们不会考虑这个问题，除非真遇到。
<pre>
<ol>
<li>var a &nbsp;= {
</li><li> &nbsp;valueOf: function() { return 42; }
,
</li><li> &nbsp;toString: function() { return 4; }

</li><li>}

</li>
<li>a + ''; // 42
</li><li>String(a); // 4
</li></ol></pre>
<h4>判断对象的实例</h4>
<pre>
<ol>
<li>// 方法一: ES3
</li><li>function Person(name, age) {
</li><li> &nbsp;if (!(this instanceof Person)) {
</li><li> &nbsp; &nbsp;return new Person(name, age);
</li><li> &nbsp;}

</li><li> &nbsp;this.name = name;
</li><li> &nbsp;this.age = age;
</li><li>}

</li>
<li>// 方法二: ES5
</li><li>function Person(name, age) {
</li><li> &nbsp;var self = this instanceof Person ? this : Object.create(Person.prototype);
</li><li> &nbsp;self.name = name;
</li><li> &nbsp;self.age = age;
</li>
<li> &nbsp;return self;
</li><li>}

</li>
<li>// 方法三：ES6
</li><li>function Person(name, age) {
</li><li> &nbsp;if (!new.target) {
</li><li> &nbsp; &nbsp;throw 'Peron must called with new';
</li><li> &nbsp;}

</li><li> &nbsp;this.name = name;
</li><li> &nbsp;this.age = age;
</li><li>}

</li></ol></pre>
<h4>数据安全类型检查</h4>
<pre>
<ol>
<li>// 对象
</li><li>function isObject(value) {
</li><li> &nbsp;return Object.prototype.toString.call(value).slice(8, -1) === 'Object'';
</li><li>}

</li>
<li>// 数组
</li><li>function isArray(value) {
</li><li> &nbsp;return Object.prototype.toString.call(value).slice(8, -1) === 'Array';
</li><li>}

</li>
<li>// 函数
</li><li>function isFunction(value) {
</li><li> &nbsp;return Object.prototype.toString.call(value).slice(8, -1) === 'Function';
</li><li>}

</li></ol></pre>
<h4>让数字的字面值看起来像对象</h4>
<pre>
<ol>
<li>2.toString(); // Uncaught SyntaxError: Invalid or unexpected token
</li>
<li>2..toString(); // 第二个点号可以正常解析
</li><li>2 .toString(); // 注意点号前面的空格
</li><li>(2).toString(); // 2先被计算
</li></ol></pre>
<h4>对象可计算属性名(仅在ES6中)</h4>
<pre>
<ol>
<li>var suffix = ' name';
</li><li>var person = {
</li><li> &nbsp;['first' + suffix]: 'Nicholas',
</li><li> &nbsp;['last' + suffix]: 'Zakas'
</li><li>}

</li>
<li>person['first name']; // "Nicholas"
</li><li>person['last name']; // "Zakas"
</li></ol></pre>
