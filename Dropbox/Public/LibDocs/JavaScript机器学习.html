<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="submaincss.css">
<style>
code{font-size:18px;}
.pun{color:gray;}
</style>

</head>
<body>

<h2>JavaScript机器学习</h2>

本文向你展示了如何使用 deeplearn.js 在 JavaScript 上为机器学习构建神经网络。<br><br>

近日，来自德国的 Robin Wieruch 发布了一系列使用 JavaScript 构建机器学习的教程，本文将主要介绍使用 JavaScript 实现神经网络的方法。<br><br>

原作者发表了一系列有关在 JavaScript 上实现人工智能和机器学习算法的文章，其中包括：<br><br>

线性回归和梯度下降：<br>
https://www.robinwieruch.de/linear-regression-gradient-descent-javascript/<br><br>
正规方程线性回归：<br>
https://www.robinwieruch.de/multivariate-linear-regression-normal-equation-javascript/<br><br>
逻辑回归和梯度下降：<br>https://www.robinwieruch.de/logistic-regression-gradient-descent-classification-javascript/<br><br>


这些机器学习算法的实现是基于 math.js 库的线性代数（如矩阵运算）和微分的，你可以在 GitHub 上找到所有这些算法：
GitHub 链接：<br>https://github.com/javascript-machine-learning

<br><br>


我发现实现这些机器学习算法在某种程度上是一个非常具有挑战性的任务。<br><br>
特别是当你需要在 JavaScript 上实现神经网络的前向和反向传播的时候。<br><br>
现在我选择了谷歌发布的 deeplearn.js 来进行此项工作。<br><br>
在本文中，我将分享使用 deeplearn.js 和 JavaScript 实现神经网络从而解决现实世界问题的方式——在 web 环境上。<br><br>

首先，我强烈推荐读者先学习一下深度学习著名学者吴恩达的《机器学习》课程。<br><br>
本文不会详细解释机器学习算法，只会展示它在 JavaScript 上的用法。<br><br>
另一方面，该系列课程在算法的细节和解释上有着令人惊叹的高质量。<br><br>

本文实现的神经网络需要通过选择与背景颜色相关的适当字体颜色来改善网页可访问性。<br><br>
比如，深蓝色背景中的字体应该是白色，而浅黄色背景中的字体应该是黑色。<br><br>

我很快在 Stack Overflow 找到了该问题的解决办法，并根据我的需求做了调整，以适应 RGB 空间中的颜色。<br><br>

<span style="color: white;">

<code>

<span style="color: orange;">
function
</span>

<span>
 getAccessibleColor
</span>

<span class="pun">
(
</span>

<span>
rgb
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;let 
</span>

<span class="pun">
[
</span>

<span>
 r
</span>

<span class="pun">
,
</span>

<span>
 g
</span>

<span class="pun">
,
</span>

<span>
 b 
</span>

<span class="pun">
]
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 rgb
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;let colors 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
r 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
,
</span>

<span>
 g 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
,
</span>

<span>
 b 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;let c 
</span>

<span class="pun">
=
</span>

<span>
 colors
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
((
</span>

<span>
col
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
if
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
col 
</span>

<span class="pun">
&lt;=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.03928
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 col 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
12.92
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Math
</span>

<span class="pun">
.
</span>

<span>
pow
</span>

<span class="pun">
((
</span>

<span>
col 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.055
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1.055
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2.4
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;let L 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.2126
</span>

<span>
 
</span>

<span class="pun">
*
</span>

<span>
 c
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
])
</span>

<span>
 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.7152
</span>

<span>
 
</span>

<span class="pun">
*
</span>

<span>
 c
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
])
</span>

<span>
 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.0722
</span>

<span>
 
</span>

<span class="pun">
*
</span>

<span>
 c
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
L 
</span>

<span class="pun">
&gt;
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.179
</span>

<span class="pun">
)
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
?
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span>
 
</span>

<span class="pun">
]
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span>
 
</span>

<span class="pun">
];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


当已经有一个编程的方法可以解决该问题的时候，使用神经网络对于该现实世界问题价值并不大，没有必要使用一个机器训练的算法。<br><br>
然而，由于可通过编程解决这一问题，所以验证神经网络的性能也变得很简单，这也许能够解决我们的问题。<br><br>
查看该 GitHub 库（https://github.com/javascript-machine-learning/color-accessibility-neural-network-deeplearnjs）中的动图，了解它最终表现如何，以及本教程中你将构建什么。<br><br>
如果你熟悉机器学习，也许你已经注意到这个任务是一个分类问题。<br><br>
算法应根据输入（背景颜色）决定二进制输出（字体颜色：白色或黑色）。<br><br>
在使用神经网络训练算法的过程中，最终会根据输入的背景颜色输出正确的字体颜色。<br><br>

</span>




下文将从头开始指导你设置神经网络的所有部分，并由你决定把文件/文件夹设置中的部分合在一起。<br><br>
但是你可以整合以前引用的 GitHub 库以获取实现细节。<br><br>

</span>




<strong>
JavaScript 中的数据集生成
</strong>




机器学习中的训练集由输入数据点和输出数据点（标签）组成。<br><br>
它被用来训练为训练集（例如测试集）之外的新输入数据点预测输出的算法。<br><br>
在训练阶段，由神经网络训练的算法调整其权重以预测输入数据点的给定标签。<br><br>
总之，已训练算法是一个以数据点作为输入并近似输出标签的函数。<br><br>

</span>




该算法经过神经网络的训练后，可以为不属于训练集的新背景颜色输出字体颜色。<br><br>
因此，稍后你将使用测试集来验证训练算法的准确率。<br><br>
由于我们正在处理颜色，因此为神经网络生成输入颜色的样本数据集并不困难。<br><br>

</span>
</span>


<span style="color: white;">

<code>

<span style="color: orange;">
function
</span>

<span>
 generateRandomRgbColors
</span>

<span class="pun">
(
</span>

<span>
m
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 rawInputs 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
[];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
for
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
let i 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
;
</span>

<span>
 i 
</span>

<span class="pun">
&lt;
</span>

<span>
 m
</span>

<span class="pun">
;
</span>

<span>
 i
</span>

<span class="pun">
++)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;rawInputs
</span>

<span class="pun">
.
</span>

<span>
push
</span>

<span class="pun">
(
</span>

<span>
generateRandomRgbColor
</span>

<span class="pun">
());
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 rawInputs
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}

</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">

</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
function
</span>

<span>
 generateRandomRgbColor
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="pun">
[
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;randomIntFromInterval
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
),
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;randomIntFromInterval
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
),
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;randomIntFromInterval
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
),
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}

</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">

</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
function
</span>

<span>
 randomIntFromInterval
</span>

<span class="pun">
(
</span>

<span>
min
</span>

<span class="pun">
,
</span>

<span>
 max
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Math
</span>

<span class="pun">
.
</span>

<span>
floor
</span>

<span class="pun">
(
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Math
</span>

<span class="pun">
.
</span>

<span>
random
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
*
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
max 
</span>

<span class="pun">
-
</span>

<span>
 min 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
+
</span>

<span>
 min
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


<span style="color: rgb(136, 136, 136);">
generateRandomRgbColors()
</span>

 函数创建给定大小为 m 的部分数据集。<br><br>
数据集中的数据点是 RGB 颜色空间中的颜色。<br><br>
每种颜色在矩阵中被表征为一行，而每一列是颜色的特征。<br><br>
特征是 RGB 空间中的 R、G、B 编码值。<br><br>
数据集还没有任何标签，所以训练集并不完整，因为它只有输入值而没有输出值。<br><br>

</span>




由于基于已知颜色生成可使用字体颜色的编程方法是已知的，因此可以使用调整后的功能版本以生成训练集（以及稍后的测试集）的标签。<br><br>
这些标签针对二分类问题进行了调整，并在 RGB 空间中隐含地反映了黑白的颜色。<br><br>
因此，对于黑色，标签是 [0,1]；对于白色，标签是 [1,0]。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
function
</span>

<span>
 getAccessibleColor
</span>

<span class="pun">
(
</span>

<span>
rgb
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;let 
</span>

<span class="pun">
[
</span>

<span>
 r
</span>

<span class="pun">
,
</span>

<span>
 g
</span>

<span class="pun">
,
</span>

<span>
 b 
</span>

<span class="pun">
]
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 rgb
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;let color 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
r 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
,
</span>

<span>
 g 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
,
</span>

<span>
 b 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;let c 
</span>

<span class="pun">
=
</span>

<span>
 color
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
((
</span>

<span>
col
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
if
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
col 
</span>

<span class="pun">
&lt;=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.03928
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 col 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
12.92
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Math
</span>

<span class="pun">
.
</span>

<span>
pow
</span>

<span class="pun">
((
</span>

<span>
col 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.055
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1.055
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2.4
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;let L 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.2126
</span>

<span>
 
</span>

<span class="pun">
*
</span>

<span>
 c
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
])
</span>

<span>
 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.7152
</span>

<span>
 
</span>

<span class="pun">
*
</span>

<span>
 c
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
])
</span>

<span>
 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.0722
</span>

<span>
 
</span>

<span class="pun">
*
</span>

<span>
 c
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
L 
</span>

<span class="pun">
&gt;
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.179
</span>

<span class="pun">
)
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
?
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span>
 
</span>

<span class="pun">
]
</span>

<span>
 
</span>

<span class="com" style="color: rgb(125, 122, 104);">
// black
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span>
 
</span>

<span class="pun">
];
</span>

<span>
 
</span>

<span class="com" style="color: rgb(125, 122, 104);">
// white
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


现在你已经准备好一切用于生成（背景）颜色的随机数据集（训练集、测试集），它被分类为黑色或白色（字体）颜色。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
function
</span>

<span>
 generateColorSet
</span>

<span class="pun">
(
</span>

<span>
m
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 rawInputs 
</span>

<span class="pun">
=
</span>

<span>
 generateRandomRgbColors
</span>

<span class="pun">
(
</span>

<span>
m
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 rawTargets 
</span>

<span class="pun">
=
</span>

<span>
 rawInputs
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
getAccessibleColor
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
 rawInputs
</span>

<span class="pun">
,
</span>

<span>
 rawTargets 
</span>

<span class="pun">
};
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>


</pre>



使神经网络中底层算法更好的另一步操作是特征缩放。<br><br>
在特征缩放的简化版本中，你希望 RGB 通道的值在 0 和 1 之间。<br><br>
由于你知道最大值，因此可以简单地推导出每个颜色通道的归一化值。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
function
</span>

<span>
 normalizeColor
</span>

<span class="pun">
(
</span>

<span>
rgb
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 rgb
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
v 
</span>

<span class="pun">
=&gt;
</span>

<span>
 v 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>


</pre>



你可以把这个功能放在你的神经网络模型中，或者作为单独的效用函数。<br><br>
下一步我将把它放在神经网络模型中。<br><br>

</span>




<strong>
JavaScript 神经网络模型的设置阶段
</strong>




现在你可以使用 JavaScript 实现一个神经网络了。<br><br>
在开始之前，你需要先安装 deeplearn.js 库：一个适合 JavaScript 神经网络的框架。<br><br>
官方宣传中说：「deeplearn.js 是一个开源库，将高效的机器学习构造块带到 web 中，允许在浏览器中训练神经网络或在推断模式下运行预训练模型。<br><br>
」本文，你将训练自己的模型，然后在推断模式中运行该模型。<br><br>
使用该库有两个主要优势：
</span>




首先，它使用本地电脑的 GPU 加速机器学习算法中的向量计算。<br><br>
这些机器学习计算与图解计算类似，因此使用 GPU 的计算比使用 CPU 更加高效。<br><br>

</span>




其次，deeplearn.js 的结构与流行的 TensorFlow 库类似（TensorFlow 库也是谷歌开发的，不过它使用的是 Python 语言）。<br><br>
因此如果你想在使用 Python 的机器学习中实现飞跃，那么 deeplearn.js 可提供通向 JavaScript 各领域的捷径。<br><br>

</span>




现在回到你的项目。<br><br>
如果你想用 npm 来设置，那么你只需要在命令行中安装 deeplearn.js。<br><br>
也可以查看 deeplearn.js 项目的官方安装说明文档。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span>
npm install deeplearn
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


我没有构建过大量神经网络，因此我按照构建神经网络的一般实践进行操作。<br><br>
在 JavaScript 中，你可以使用 JavaScript ES6 class 来推进它。<br><br>
该类可以通过定义神经网络特性和类方法为你的神经网络提供完美的容器。<br><br>
例如，你的颜色归一化函数可以在类别中找到一个作为方法的点。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;normalizeColor
</span>

<span class="pun">
(
</span>

<span>
rgb
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 rgb
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
v 
</span>

<span class="pun">
=&gt;
</span>

<span>
 v 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


或许那也是你的函数生成数据集的地方。<br><br>
在我的案例中，我仅将类别归一化作为分类方法，让数据集生成独立于类别之外。<br><br>
你可以认为未来有不同的方法来生成数据集，不应该在神经网络模型中进行定义。<br><br>
不管怎样，这只是一个实现细节。<br><br>

</span>




训练和推断阶段都在机器学习的涵盖性术语会话（session）之下。<br><br>
你可以在神经网络类别中设置会话。<br><br>
首先，你可以输入来自 deeplearn.js 的 NDArrayMathGPU 类别，帮助你以计算高效的方式在 GPU 上进行数学运算。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 math 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


第二，声明分类方法类设置会话。<br><br>
其函数签名使用训练集作为参数，成为从先前实现的函数中生成训练集的完美 consumer。<br><br>
第三步，会话初始化空的图。<br><br>
之后，图将反映神经网络的架构。<br><br>
你可以随意定义其特性。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;setupSession
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 graph 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
..
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


第四步，你用张量的形式定义图中输入和输出数据点的形态。<br><br>
张量是具备不同维度的数组，它可以是向量、矩阵，或更高维度的矩阵。<br><br>
神经网络将这些张量作为输入和输出。<br><br>
在我们的案例中，有三个输入单元（每个颜色通道有一个输入单元）和两个输出单元（二分类，如黑白）。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;setupSession
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 graph 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'input RGB value'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'output classifier'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


第五步，神经网络包含隐藏层。<br><br>
奇迹如何发生目前仍是黑箱。<br><br>
基本上，神经网络提出自己的交叉计算参数（在会话中经过训练）。<br><br>
不过，你可以随意定义隐藏层的维度（每个单元大小、层大小）。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;setupSession
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 graph 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'input RGB value'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'output classifier'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
64
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
32
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
16
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;createConnectedLayer
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;inputLayer
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;layerIndex
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;units
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


根据层的数量，你可以变更图来扩展出更多层。<br><br>
创建连接层的分类方法需要图、变异连接层（mutated connected layer）、新层的索引，以及单元数量。<br><br>
图的层属性可用于返回由名称确定的新张量。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;setupSession
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 graph 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'input RGB value'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'output classifier'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
64
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
32
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
16
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;createConnectedLayer
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;inputLayer
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;layerIndex
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;units
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
layers
</span>

<span class="pun">
.
</span>

<span>
dense
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
`
</span>

<span>
fully_connected_$
</span>

<span class="pun">
{
</span>

<span>
layerIndex
</span>

<span class="pun">
}`,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;inputLayer
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;units
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



神经网络中的每一个神经元必须具备一个定义好的激活函数。<br><br>
它可以是 logistic 激活函数。<br><br>
你或许已经从 logistic 回归中了解到它，它成为神经网络中的 logistic 单元。<br><br>
在我们的案例中，神经网络默认使用修正线性单元。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;setupSession
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 graph 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'input RGB value'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'output classifier'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
64
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
32
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
16
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;createConnectedLayer
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;inputLayer
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;layerIndex
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;units
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;activationFunction
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
layers
</span>

<span class="pun">
.
</span>

<span>
dense
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
`
</span>

<span>
fully_connected_$
</span>

<span class="pun">
{
</span>

<span>
layerIndex
</span>

<span class="pun">
}`,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;inputLayer
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;units
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;activationFunction 
</span>

<span class="pun">
?
</span>

<span>
 activationFunction 
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
x
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
relu
</span>

<span class="pun">
(
</span>

<span>
x
</span>

<span class="pun">
)
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


第六步，创建输出二分类的层。<br><br>
它有两个输出单元，每一个表示一个离散的值（黑色、白色）。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predictionTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;setupSession
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 graph 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'input RGB value'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'output classifier'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
64
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
32
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
16
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
predictionTensor 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


第七步，声明一个代价张量（cost tensor），以定义损失函数。<br><br>
在这个案例中，代价张量是均方误差。<br><br>
它使用训练集的目标张量（标签）和训练算法得到的预测张量来计算代价。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predictionTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;costTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;setupSession
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 graph 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'input RGB value'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'output classifier'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
64
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
32
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
16
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
predictionTensor 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
costTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
meanSquaredCost
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
predictionTensor
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


最后但并非不重要的一步，设置架构图的相关会话。<br><br>
之后，你就可以开始准备为训练阶段导入训练集了。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Session
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;session
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predictionTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;costTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;setupSession
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 graph 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'input RGB value'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
placeholder
</span>

<span class="pun">
(
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'output classifier'
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
64
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
32
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;connectedLayer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
16
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
predictionTensor 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
createConnectedLayer
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 connectedLayer
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
3
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
costTensor 
</span>

<span class="pun">
=
</span>

<span>
 graph
</span>

<span class="pun">
.
</span>

<span>
meanSquaredCost
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
predictionTensor
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
session 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Session
</span>

<span class="pun">
(
</span>

<span>
graph
</span>

<span class="pun">
,
</span>

<span>
 math
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
prepareTrainingSet
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;prepareTrainingSet
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



不过目前在准备神经网络的训练集之前，设置还没完成。<br><br>
首先，你可以在 GPU 数学计算环境中使用回调函数（callback function）来支持计算，但这并不是强制性的，可自主选择。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Session
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 math 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;session
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predictionTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;costTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;prepareTrainingSet
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;math
</span>

<span class="pun">
.
</span>

<span>
scope
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


其次，你可以解构训练集的输入和输出（标签，也称为目标）以将其转换成神经网络可读的格式。<br><br>
deeplearn.js 的数学计算使用内置的 NDArrays。<br><br>
你可以把它们理解为数组矩阵中的简单数组或向量。<br><br>
此外，输入数组的颜色被归一化以提高神经网络的性能。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Session
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 math 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;session
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predictionTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;costTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;prepareTrainingSet
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;math
</span>

<span class="pun">
.
</span>

<span>
scope
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
 rawInputs
</span>

<span class="pun">
,
</span>

<span>
 rawTargets 
</span>

<span class="pun">
}
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 trainingSet
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 inputArray 
</span>

<span class="pun">
=
</span>

<span>
 rawInputs
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
v 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
new
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
normalizeColor
</span>

<span class="pun">
(
</span>

<span>
v
</span>

<span class="pun">
)));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 targetArray 
</span>

<span class="pun">
=
</span>

<span>
 rawTargets
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
v 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
new
</span>

<span class="pun">
(
</span>

<span>
v
</span>

<span class="pun">
));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



第三，shuffle 输入和目标阵列。<br><br>
shuffle 的时候，deeplearn.js 提供的 shuffler 将二者保存在 sync 中。<br><br>
每次训练迭代都会出现 shuffle，以馈送不同的输入作为神经网络的 batch。<br><br>
整个 shuffle 流程可以改善训练算法，因为它更可能通过避免过拟合来实现泛化。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InCPUMemoryShuffledInputProviderBuilder
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Session
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 math 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;session
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predictionTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;costTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;prepareTrainingSet
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;math
</span>

<span class="pun">
.
</span>

<span>
scope
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
 rawInputs
</span>

<span class="pun">
,
</span>

<span>
 rawTargets 
</span>

<span class="pun">
}
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 trainingSet
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 inputArray 
</span>

<span class="pun">
=
</span>

<span>
 rawInputs
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
v 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
new
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
normalizeColor
</span>

<span class="pun">
(
</span>

<span>
v
</span>

<span class="pun">
)));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 targetArray 
</span>

<span class="pun">
=
</span>

<span>
 rawTargets
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
v 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
new
</span>

<span class="pun">
(
</span>

<span>
v
</span>

<span class="pun">
));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 shuffledInputProviderBuilder 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InCPUMemoryShuffledInputProviderBuilder
</span>

<span class="pun">
([
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;inputArray
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;targetArray
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="pun">
[
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;inputProvider
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;targetProvider
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
]
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 shuffledInputProviderBuilder
</span>

<span class="pun">
.
</span>

<span>
getInputProviders
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



最后，馈送条目（feed entries）是训练阶段中神经网络前馈算法的最终输入。<br><br>
它匹配数据和张量（根据设置阶段的形态而定义）。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InCPUMemoryShuffledInputProviderBuilder
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Session
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 math 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;session
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predictionTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;costTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;feedEntries
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;prepareTrainingSet
</span>

<span class="pun">
(
</span>

<span>
trainingSet
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;math
</span>

<span class="pun">
.
</span>

<span>
scope
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
 rawInputs
</span>

<span class="pun">
,
</span>

<span>
 rawTargets 
</span>

<span class="pun">
}
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 trainingSet
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 inputArray 
</span>

<span class="pun">
=
</span>

<span>
 rawInputs
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
v 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
new
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
normalizeColor
</span>

<span class="pun">
(
</span>

<span>
v
</span>

<span class="pun">
)));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 targetArray 
</span>

<span class="pun">
=
</span>

<span>
 rawTargets
</span>

<span class="pun">
.
</span>

<span>
map
</span>

<span class="pun">
(
</span>

<span>
v 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
new
</span>

<span class="pun">
(
</span>

<span>
v
</span>

<span class="pun">
));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 shuffledInputProviderBuilder 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InCPUMemoryShuffledInputProviderBuilder
</span>

<span class="pun">
([
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;inputArray
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;targetArray
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
]);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="pun">
[
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;inputProvider
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;targetProvider
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
]
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 shuffledInputProviderBuilder
</span>

<span class="pun">
.
</span>

<span>
getInputProviders
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
feedEntries 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
[
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
{
</span>

<span>
 tensor
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor
</span>

<span class="pun">
,
</span>

<span>
 data
</span>

<span class="pun">
:
</span>

<span>
 inputProvider 
</span>

<span class="pun">
},
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
{
</span>

<span>
 tensor
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
targetTensor
</span>

<span class="pun">
,
</span>

<span>
 data
</span>

<span class="pun">
:
</span>

<span>
 targetProvider 
</span>

<span class="pun">
},
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


这样，神经网络的设置就结束了。<br><br>
神经网络的所有层和单元都实现了，训练集也准备好进行训练了。<br><br>
现在只需要添加两个配置神经网络行为的超参数，它们适用于下个阶段：训练阶段。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InCPUMemoryShuffledInputProviderBuilder
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Session
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
SGDOptimizer
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 math 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;session
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;optimizer
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;batchSize 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
300
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;initialLearningRate 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.06
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;inputTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;targetTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predictionTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;costTensor
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;feedEntries
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;constructor
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
optimizer 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
SGDOptimizer
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
initialLearningRate
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


第一个参数是学习速率（learning rate）。<br><br>
学习速率决定算法的收敛速度，以最小化成本。<br><br>
我们应该假定它的数值很高，但实际上不能太高了。<br><br>
否则梯度下降就不会收敛，因为找不到局部最优值。<br><br>

</span>




第二个参数是批尺寸（batch size）。<br><br>
它定义每个 epoch（迭代）里有多少个训练集的数据点通过神经网络。<br><br>
一个 epoch 等于一批数据点的一次正向传播和一次反向传播。<br><br>
以批次的方式训练神经网络有两个好处：第一，这样可以防止密集计算，因为算法训练时使用了内存中的少量数据点；第二，这样可以让神经网络更快地进行批处理，因为每个 epoch 中权重会随着每个批次的数据点进行调整——而不是等到整个数据集训练完之后再进行改动。<br><br>

</span>




<strong>
训练阶段
</strong>




设置阶段结束后就到了训练阶段了。<br><br>
不需要太多实现，因为所有的基础都已在设置阶段完成。<br><br>
首先，训练阶段可以用分类方法来定义。<br><br>
然后在 deeplearn.js 的数学环境中再次执行。<br><br>
此外，它还使用神经网络实例所有的预定义特性来训练算法。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;train
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;math
</span>

<span class="pun">
.
</span>

<span>
scope
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
session
</span>

<span class="pun">
.
</span>

<span>
train
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
costTensor
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
feedEntries
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
batchSize
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
optimizer
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



训练方法是 1 个 epoch 的神经网络训练。<br><br>
因此，从外部调用时，调用必须是迭代的。<br><br>
此外，训练只需要 1 个 epoch。<br><br>
为了多批次训练算法，你必须将该训练方法进行多次迭代运行。<br><br>

</span>




这就是基础的训练阶段。<br><br>
但是根据时间调整学习率可以改善训练。<br><br>
学习率最初很高，但是当算法在每一步过程中逐渐收敛时，学习率会出现下降趋势。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;train
</span>

<span class="pun">
(
</span>

<span>
step
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let learningRate 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
initialLearningRate 
</span>

<span class="pun">
*
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Math
</span>

<span class="pun">
.
</span>

<span>
pow
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.90
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Math
</span>

<span class="pun">
.
</span>

<span>
floor
</span>

<span class="pun">
(
</span>

<span>
step 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
50
</span>

<span class="pun">
));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
optimizer
</span>

<span class="pun">
.
</span>

<span>
setLearningRate
</span>

<span class="pun">
(
</span>

<span>
learningRate
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;math
</span>

<span class="pun">
.
</span>

<span>
scope
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
session
</span>

<span class="pun">
.
</span>

<span>
train
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
costTensor
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
feedEntries
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
batchSize
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
optimizer
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



在我们的情况中，学习率每 50 步下降 10%。<br><br>
下面，我们需要获取训练阶段的损失，来验证它是否随着时间下降。<br><br>
损失可在每一次迭代时返回，不过这样会导致较低的计算效率。<br><br>
神经网络每次请求返回损失，就必须通过 GPU 才能实现返回请求。<br><br>
因此，我们在多次迭代后仅要求返回一次损失来验证其是否下降。<br><br>
如果没有请求返回损失，则训练的损失下降常量被定义为 NONE（之前默认设置）。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InCPUMemoryShuffledInputProviderBuilder
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Graph
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Session
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
SGDOptimizer
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
NDArrayMathGPU
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
CostReduction
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'deeplearn'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;train
</span>

<span class="pun">
(
</span>

<span>
step
</span>

<span class="pun">
,
</span>

<span>
 computeCost
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let learningRate 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
initialLearningRate 
</span>

<span class="pun">
*
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Math
</span>

<span class="pun">
.
</span>

<span>
pow
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0.90
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Math
</span>

<span class="pun">
.
</span>

<span>
floor
</span>

<span class="pun">
(
</span>

<span>
step 
</span>

<span class="pun">
/
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
50
</span>

<span class="pun">
));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
optimizer
</span>

<span class="pun">
.
</span>

<span>
setLearningRate
</span>

<span class="pun">
(
</span>

<span>
learningRate
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let costValue
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;math
</span>

<span class="pun">
.
</span>

<span>
scope
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 cost 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
session
</span>

<span class="pun">
.
</span>

<span>
train
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
costTensor
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
feedEntries
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
batchSize
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
optimizer
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;computeCost 
</span>

<span class="pun">
?
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
CostReduction
</span>

<span class="pun">
.
</span>

<span>
MEAN 
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
CostReduction
</span>

<span class="pun">
.
</span>

<span>
NONE
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
if
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
computeCost
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;costValue 
</span>

<span class="pun">
=
</span>

<span>
 cost
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
get
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 costValue
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


最后，这就是训练阶段。<br><br>
现在仅需要在训练集上进行会话设置后从外部进行迭代执行。<br><br>
外部的执行取决于训练方法是否返回损失。<br><br>

</span>




<strong>
推断阶段
</strong>




最后一个阶段是推断阶段，该阶段使用测试集来验证训练算法的性能。<br><br>
输入是背景颜色中的 RGB 颜色，输出是算法为字体颜色是黑是白进行的 [ 0, 1 ] 或 [ 1, 0 ] 分类预测。<br><br>
由于输入数据点经过归一化，因此不要忘记在这一步也对颜色进行归一化。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;predict
</span>

<span class="pun">
(
</span>

<span>
rgb
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;let classifier 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
[];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;math
</span>

<span class="pun">
.
</span>

<span>
scope
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 mapping 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
[{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;tensor
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
inputTensor
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;data
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array1D
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
new
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
normalizeColor
</span>

<span class="pun">
(
</span>

<span>
rgb
</span>

<span class="pun">
)),
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
}];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;classifier 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
session
</span>

<span class="pun">
.
</span>

<span style="color: orange;">
eval
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
predictionTensor
</span>

<span class="pun">
,
</span>

<span>
 mapping
</span>

<span class="pun">
).
</span>

<span>
getValues
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
});
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
 
</span>

<span class="pun">
...
</span>

<span>
classifier 
</span>

<span class="pun">
];
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


该方法在数学环境中再次运行性能关键部分，需要定义一个映射，该映射最终可作为会话评估的输入。<br><br>
记住，预测方法不是一定得在训练阶段后运行。<br><br>
它可以在训练阶段中使用，来输出测试集的验证。<br><br>

</span>




至此，神经网络已经经历了设置、训练和推断阶段。<br><br>

</span>




<strong>
在 JavaScript 中可视化学习神经网络
</strong>




现在是时候使用神经网络进行训练和验证/测试了。<br><br>
简单的过程为建立一个神经网络，使用一个训练集运行训练阶段，代价函数取得最小值之后，使用一个测试集进行预测。<br><br>
所有的过程只需要使用网页浏览器上的开发者控制台的几个 console.log statements 就可以完成。<br><br>
然而，由于该神经网络是关于颜色预测的，并且 deeplearn.js 是在浏览器上运行，从而可以轻松地对神经网络的训练阶段和测试阶段进行可视化。<br><br>

</span>




至此，你可以自主决定你运行中的神经网络的可视化方式。<br><br>
使用一个 canvas 和 repuestAnimationFrame API 可以使 JavaScript 代码更简单。<br><br>
但就这篇文章来说，我会使用 React.js 进行展示，因为我在博客上写过 React.js。<br><br>

</span>




因此在使用 create-react-app 设置完项目后，App 组件可成为我们可视化的进入点。<br><br>
首先，导入神经网络类别和函数，从你的文件中生成数据集。<br><br>
进而，为训练集大小、测试集大小和训练迭代次数添加若干个常量。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
React
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Component
</span>

<span>
 
</span>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'react'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'./App.css'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 generateColorSet from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'./data'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'./neuralNetwork'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 ITERATIONS 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
750
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 TRAINING_SET_SIZE 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1500
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 TEST_SET_SIZE 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
10
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span>
 extends 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Component
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


App 的组件包括生成数据集（训练集和测试集）、通过传递训练集建立神经网络会话、定义组件的初始状态。<br><br>
在训练阶段的时间内，代价函数的值和迭代次数会在控制台上显示，它也表示了组件的状态。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
React
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Component
</span>

<span>
 
</span>

<span class="pun">
}
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'react'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'./App.css'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 generateColorSet from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'./data'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
import
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span>
 from 
</span>

<span class="str" style="color: rgb(96, 172, 57);">
'./neuralNetwork'
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 ITERATIONS 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
750
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 TRAINING_SET_SIZE 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1500
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 TEST_SET_SIZE 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
10
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span>
 extends 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Component
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;testSet
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;trainingSet
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;colorAccessibilityModel
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;constructor
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;super
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
testSet 
</span>

<span class="pun">
=
</span>

<span>
 generateColorSet
</span>

<span class="pun">
(
</span>

<span>
TEST_SET_SIZE
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
trainingSet 
</span>

<span class="pun">
=
</span>

<span>
 generateColorSet
</span>

<span class="pun">
(
</span>

<span>
TRAINING_SET_SIZE
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
colorAccessibilityModel 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
new
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorAccessibilityModel
</span>

<span class="pun">
();
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
colorAccessibilityModel
</span>

<span class="pun">
.
</span>

<span>
setupSession
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
trainingSet
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
state 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;currentIteration
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;cost
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="pun">
-
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
42
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
};
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


接下来，设置了神经网络会话之后，就可以迭代地训练神经网络了。<br><br>
最简单的版本只需要一直运行 React 的一个 for 循环就可以了。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span>
 extends 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Component
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;componentDidMount 
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
for
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
let i 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
;
</span>

<span>
 i 
</span>

<span class="pun">
&lt;=
</span>

<span>
 ITERATIONS
</span>

<span class="pun">
;
</span>

<span>
 i
</span>

<span class="pun">
++)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
colorAccessibilityModel
</span>

<span class="pun">
.
</span>

<span>
train
</span>

<span class="pun">
(
</span>

<span>
i
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
};
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


然而，以上代码不会在 React 的训练阶段提供（render）输出，因为组件不会在神经网络阻塞单个 JavaScript 线程的时候 reRender。<br><br>
这也正是 React 使用 requestAnimationFrame 的时候。<br><br>
与其自己定义一个 for 循环，每一个请求的浏览器的动画帧都可以被用于运行一次训练迭代。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span>
 extends 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Component
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;componentDidMount 
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;requestAnimationFrame
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
tick
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
};
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;tick 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
setState
</span>

<span class="pun">
((
</span>

<span>
state
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
({
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;currentIteration
</span>

<span class="pun">
:
</span>

<span>
 state
</span>

<span class="pun">
.
</span>

<span>
currentIteration 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
}));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
if
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
state
</span>

<span class="pun">
.
</span>

<span>
currentIteration 
</span>

<span class="pun">
&lt;
</span>

<span>
 ITERATIONS
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;requestAnimationFrame
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
tick
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
colorAccessibilityModel
</span>

<span class="pun">
.
</span>

<span>
train
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
state
</span>

<span class="pun">
.
</span>

<span>
currentIteration
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
};
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


此外，代价函数可以每 5 步进行一次计算。<br><br>
如前所述，需要访问 GPU 来检索代价函数。<br><br>
因此需要防止神经网络训练过快。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span>
 extends 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Component
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;componentDidMount 
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;requestAnimationFrame
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
tick
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
};
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;tick 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
setState
</span>

<span class="pun">
((
</span>

<span>
state
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
({
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;currentIteration
</span>

<span class="pun">
:
</span>

<span>
 state
</span>

<span class="pun">
.
</span>

<span>
currentIteration 
</span>

<span class="pun">
+
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
}));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
if
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
state
</span>

<span class="pun">
.
</span>

<span>
currentIteration 
</span>

<span class="pun">
&lt;
</span>

<span>
 ITERATIONS
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;requestAnimationFrame
</span>

<span class="pun">
(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
tick
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;let computeCost 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
!(
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
state
</span>

<span class="pun">
.
</span>

<span>
currentIteration 
</span>

<span class="pun">
%
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
5
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;let cost 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
colorAccessibilityModel
</span>

<span class="pun">
.
</span>

<span>
train
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
state
</span>

<span class="pun">
.
</span>

<span>
currentIteration
</span>

<span class="pun">
,
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;computeCost
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
if
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
cost 
</span>

<span class="pun">
&gt;
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
setState
</span>

<span class="pun">
(()
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

<span>
 
</span>

<span class="pun">
({
</span>

<span>
 cost 
</span>

<span class="pun">
}));
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
};
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


一旦组件装载好训练阶段就可以开始运行。<br><br>
现在是使用程序化计算输出和预测输出提供测试集的时候了。<br><br>
经过时间推移，预测输出应该变得和程序化计算输出一样。<br><br>
而训练集本身并未被可视化。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
class
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span>
 extends 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Component
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
...
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;render
</span>

<span class="pun">
()
</span>

<span>
 
</span>

<span class="pun">
{
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
 currentIteration
</span>

<span class="pun">
,
</span>

<span>
 cost 
</span>

<span class="pun">
}
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
state
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span style="color: orange;">
return
</span>

<span>
 
</span>

<span class="pun">
(
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div className
</span>

<span class="pun">
=
</span>

<span class="str" style="color: rgb(96, 172, 57);">
"app"
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
h1
</span>

<span class="pun">
&gt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Neural
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Network
</span>

<span>
 
</span>

<span style="color: orange;">
for
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Font
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Color
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Accessibility
</span>

<span class="pun">
&lt;/
</span>

<span>
h1
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Iterations
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
currentIteration
</span>

<span class="pun">
}&lt;/
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Cost
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="pun">
{
</span>

<span>
cost
</span>

<span class="pun">
}&lt;/
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div className
</span>

<span class="pun">
=
</span>

<span class="str" style="color: rgb(96, 172, 57);">
"content"
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div className
</span>

<span class="pun">
=
</span>

<span class="str" style="color: rgb(96, 172, 57);">
"content-item"
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ActualTable
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;testSet
</span>

<span class="pun">
={
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
testSet
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
/&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div className
</span>

<span class="pun">
=
</span>

<span class="str" style="color: rgb(96, 172, 57);">
"content-item"
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InferenceTable
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;model
</span>

<span class="pun">
={
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
colorAccessibilityModel
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;testSet
</span>

<span class="pun">
={
</span>

<span style="color: orange;">
this
</span>

<span class="pun">
.
</span>

<span>
testSet
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
/&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
);
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ActualTable
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
({
</span>

<span>
 testSet 
</span>

<span class="pun">
})
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Programmatically
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Computed
</span>

<span class="pun">
&lt;/
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InferenceTable
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
({
</span>

<span>
 testSet
</span>

<span class="pun">
,
</span>

<span>
 model 
</span>

<span class="pun">
})
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Neural
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Network
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Computed
</span>

<span class="pun">
&lt;/
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
export
</span>

<span>
 
</span>

<span style="color: orange;">
default
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
App
</span>

<span class="pun">
;
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


实际的表格会随着测试集的不断输入不断地展示每一个输入和输出的颜色。<br><br>
测试集包括输入颜色（背景颜色）和输出颜色（字体颜色）。<br><br>
由于生成数据集的时候输出颜色被分类为黑色 [0,1] 和白色 [1,0] 向量，它们需要再次被转换为真实的颜色。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ActualTable
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
({
</span>

<span>
 testSet 
</span>

<span class="pun">
})
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Programmatically
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Computed
</span>

<span class="pun">
&lt;/
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
{
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array
</span>

<span class="pun">
(
</span>

<span>
TEST_SET_SIZE
</span>

<span class="pun">
).
</span>

<span>
fill
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
).
</span>

<span>
map
</span>

<span class="pun">
((
</span>

<span>
v
</span>

<span class="pun">
,
</span>

<span>
 i
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorBox
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;key
</span>

<span class="pun">
={
</span>

<span>
i
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;rgbInput
</span>

<span class="pun">
={
</span>

<span>
testSet
</span>

<span class="pun">
.
</span>

<span>
rawInputs
</span>

<span class="pun">
[
</span>

<span>
i
</span>

<span class="pun">
]}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;rgbTarget
</span>

<span class="pun">
={
</span>

<span>
fromClassifierToRgb
</span>

<span class="pun">
(
</span>

<span>
testSet
</span>

<span class="pun">
.
</span>

<span>
rawTargets
</span>

<span class="pun">
[
</span>

<span>
i
</span>

<span class="pun">
])}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
/&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
)}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 fromClassifierToRgb 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
classifier
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;classifier
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
]
</span>

<span>
 
</span>

<span class="pun">
&gt;
</span>

<span>
 classifier
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
]
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
?
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
255
</span>

<span>
 
</span>

<span class="pun">
]
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
:
</span>

<span>
 
</span>

<span class="pun">
[
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
,
</span>

<span>
 
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span>
 
</span>

<span class="pun">
]
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


ColorBox 组件是一个通用组件，以输入颜色（背景颜色）和目标颜色（字体颜色）为输入。<br><br>
它能简单地用一个矩形展示输入颜色的类型、输入颜色的 RGB 代码字符串，并用字体的 RGB 代码将给定的目标颜色上色。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorBox
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
({
</span>

<span>
 rgbInput
</span>

<span class="pun">
,
</span>

<span>
 rgbTarget 
</span>

<span class="pun">
})
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div className
</span>

<span class="pun">
=
</span>

<span class="str" style="color: rgb(96, 172, 57);">
"color-box"
</span>

<span>
 style
</span>

<span class="pun">
={{
</span>

<span>
 backgroundColor
</span>

<span class="pun">
:
</span>

<span>
 getRgbStyle
</span>

<span class="pun">
(
</span>

<span>
rgbInput
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
}}&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
span style
</span>

<span class="pun">
={{
</span>

<span>
 color
</span>

<span class="pun">
:
</span>

<span>
 getRgbStyle
</span>

<span class="pun">
(
</span>

<span>
rgbTarget
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
}}&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
RgbString
</span>

<span>
 rgb
</span>

<span class="pun">
={
</span>

<span>
rgbInput
</span>

<span class="pun">
}
</span>

<span>
 
</span>

<span class="pun">
/&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
span
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
RgbString
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
({
</span>

<span>
 rgb 
</span>

<span class="pun">
})
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
`
</span>

<span>
rgb
</span>

<span class="pun">
(
</span>

<span>
$
</span>

<span class="pun">
{
</span>

<span>
rgb
</span>

<span class="pun">
.
</span>

<span>
toString
</span>

<span class="pun">
()})`
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 getRgbStyle 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
(
</span>

<span>
rgb
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
`
</span>

<span>
rgb
</span>

<span class="pun">
(
</span>

<span>
$
</span>

<span class="pun">
{
</span>

<span>
rgb
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
]},
</span>

<span>
 $
</span>

<span class="pun">
{
</span>

<span>
rgb
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
1
</span>

<span class="pun">
]},
</span>

<span>
 $
</span>

<span class="pun">
{
</span>

<span>
rgb
</span>

<span class="pun">
[
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
2
</span>

<span class="pun">
]})`
</span>

</code>

</span>

</span>

<br>


</pre>



</span>


最后但重要的是，在推理表格中可视化预测颜色的激动人心的部分。<br><br>
它使用的也是 color box，但提供了一些不同的小道具。<br><br>

</span>





</span>


<span style="color: white;">

<code>

<span style="color: orange;">
const
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
InferenceTable
</span>

<span>
 
</span>

<span class="pun">
=
</span>

<span>
 
</span>

<span class="pun">
({
</span>

<span>
 testSet
</span>

<span class="pun">
,
</span>

<span>
 model 
</span>

<span class="pun">
})
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Neural
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Network
</span>

<span>
 
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Computed
</span>

<span class="pun">
&lt;/
</span>

<span>
p
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
{
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
Array
</span>

<span class="pun">
(
</span>

<span>
TEST_SET_SIZE
</span>

<span class="pun">
).
</span>

<span>
fill
</span>

<span class="pun">
(
</span>

<span class="lit" style="color: rgb(182, 86, 17);">
0
</span>

<span class="pun">
).
</span>

<span>
map
</span>

<span class="pun">
((
</span>

<span>
v
</span>

<span class="pun">
,
</span>

<span>
 i
</span>

<span class="pun">
)
</span>

<span>
 
</span>

<span class="pun">
=&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
&lt;
</span>

<span class="typ" style="color: rgb(102, 132, 225);">
ColorBox
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;key
</span>

<span class="pun">
={
</span>

<span>
i
</span>

<span class="pun">
}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;rgbInput
</span>

<span class="pun">
={
</span>

<span>
testSet
</span>

<span class="pun">
.
</span>

<span>
rawInputs
</span>

<span class="pun">
[
</span>

<span>
i
</span>

<span class="pun">
]}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp; &nbsp;rgbTarget
</span>

<span class="pun">
={
</span>

<span>
fromClassifierToRgb
</span>

<span class="pun">
(
</span>

<span>
model
</span>

<span class="pun">
.
</span>

<span>
predict
</span>

<span class="pun">
(
</span>

<span>
testSet
</span>

<span class="pun">
.
</span>

<span>
rawInputs
</span>

<span class="pun">
[
</span>

<span>
i
</span>

<span class="pun">
]))}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp; &nbsp;
</span>

<span class="pun">
/&gt;
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp; &nbsp;
</span>

<span class="pun">
)}
</span>

</code>

</span>

</span>

<br>
<span style="color: white;">

<code>

<span>
 &nbsp;
</span>

<span class="pun">
&lt;/
</span>

<span>
div
</span>

<span class="pun">
&gt;
</span>

</code>

</span>

</span>

</pre>

输入颜色仍然是测试集中定义的颜色，但目标颜色并不是测试集中的目标色。<br><br>
任务的关键是利用神经网络的预测方法预测目标颜色——它需要输入的颜色，并应在训练阶段预测目标颜色。<br><br>
最后，当你开启应用时，你需要观察神经网络是否被启用。<br><br>
而实际的表格从开始就在使用固定测试集，在训练阶段推理表格应该改变它的字体颜色。<br><br>
事实上，当 ActualTable 组件显示实际测试集时，InferenceTable 显示测试集的输入数据点，但输出是使用神经网络预测的。<br><br>
