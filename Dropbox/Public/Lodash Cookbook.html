
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style>
body { margin: 10%; font-size: 22px; background-color: #000000; color: #10A0A0;}
a { text-decoration: none; color: #60C8B8;} 
a:visited {	color: #38D098;} 
a:hover { color: yellow;} 
a:focus { color: red;}
code { color: #78E0E0; background-color: #001030}
pre { color: gray; background-color: #001010}
.bord {
    color: white;
    border: 1px solid GoldenRod;
  	border-radius: 4px;
    font-size: 200%;
    padding: 1px;
}
</style>

</head>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $('h2').click(function(){
    parent.history.back();
    return false;
    });
});
</script>

<h1>Lodash</h1>
<h2>Table of Contents</h2>
<ol class="toc">
<ul class="toc no-parts">
  <li>
    <a href="#leanpub-auto-introduction"><span class="section-number">1. </span>Introduction</a>
    <ul>
      <li>
        <a href="#leanpub-auto-installation"><span class="section-number">1.1 </span>Installation</a>
        <ul>
          <li>
            <a href="#leanpub-auto-web"><span class="section-number">1.1.1 </span>Web</a>
          </li>
          <li>
            <a href="#leanpub-auto-nodejs"><span class="section-number">1.1.2 </span>NodeJS</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-lodash-features"><span class="section-number">1.2 </span>Lodash features</a>
      </li>
      <li>
        <a href="#leanpub-auto-code-sample-convention"><span class="section-number">1.3 </span>Code sample convention</a>
      </li>
      <li>
        <a href="#leanpub-auto-about-this-book"><span class="section-number">1.4 </span>About this book</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#leanpub-auto-common-concepts"><span class="section-number">2. </span>Common concepts</a>
    <ul>
      <li>
        <a href="#leanpub-auto-truthy-and-falsy"><span class="section-number">2.1 </span>Truthy and falsy</a>
      </li>
      <li>
        <a href="#leanpub-auto-samevaluezero"><span class="section-number">2.2 </span>SameValueZero</a>
      </li>
      <li>
        <a href="#leanpub-auto-predicates"><span class="section-number">2.3 </span>Predicates</a>
        <ul>
          <li>
            <a href="#leanpub-auto-matches"><span class="section-number">2.3.1 </span><code>_.matches</code></a>
          </li>
          <li>
            <a href="#leanpub-auto-matchesproperty"><span class="section-number">2.3.2 </span><code>_.matchesProperty</code></a>
          </li>
          <li>
            <a href="#leanpub-auto-property"><span class="section-number">2.3.3 </span><code>_.property</code></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-iteratees"><span class="section-number">2.4 </span>Iteratees</a>
        <ul>
          <li>
            <a href="#leanpub-auto-v4-iteratee-shorthand"><span class="section-number">2.4.1 </span><strong>[v4]</strong> Iteratee shorthand</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-v3-this-binding"><span class="section-number">2.5 </span><strong>[v3]</strong> <code>this</code> binding</a>
      </li>
      <li>
        <a href="#leanpub-auto-v4-this-binding"><span class="section-number">2.6 </span><strong>[v4]</strong> <code>this</code> binding</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#leanpub-auto-collections"><span class="section-number">3. </span>Collections</a>
    <ul>
      <li>
        <a href="#leanpub-auto-every-and-some"><span class="section-number">3.1 </span>Every and some</a>
      </li>
      <li>
        <a href="#leanpub-auto-filter-and-reject"><span class="section-number">3.2 </span>Filter and reject</a>
      </li>
      <li>
        <a href="#leanpub-auto-v3-where"><span class="section-number">3.3 </span><strong>[v3]</strong> Where</a>
      </li>
      <li>
        <a href="#leanpub-auto-size"><span class="section-number">3.4 </span>Size</a>
      </li>
      <li>
        <a href="#leanpub-auto-v3-pluck"><span class="section-number">3.5 </span><strong>[v3]</strong> Pluck</a>
      </li>
      <li>
        <a href="#leanpub-auto-at"><span class="section-number">3.6 </span>At</a>
      </li>
      <li>
        <a href="#leanpub-auto-includes"><span class="section-number">3.7 </span>Includes</a>
      </li>
      <li>
        <a href="#leanpub-auto-sample"><span class="section-number">3.8 </span>Sample</a>
      </li>
      <li>
        <a href="#leanpub-auto-shuffle"><span class="section-number">3.9 </span>Shuffle</a>
      </li>
      <li>
        <a href="#leanpub-auto-partition"><span class="section-number">3.10 </span>Partition</a>
      </li>
      <li>
        <a href="#leanpub-auto-count-by"><span class="section-number">3.11 </span>Count by</a>
      </li>
      <li>
        <a href="#leanpub-auto-group-by-and-index-by"><span class="section-number">3.12 </span>Group by and index by</a>
      </li>
      <li>
        <a href="#leanpub-auto-v3-invoke"><span class="section-number">3.13 </span><strong>[v3]</strong> Invoke</a>
      </li>
      <li>
        <a href="#leanpub-auto-map-and-reduce"><span class="section-number">3.14 </span>Map and reduce</a>
        <ul>
          <li>
            <a href="#leanpub-auto-map"><span class="section-number">3.14.1 </span>Map</a>
          </li>
          <li>
            <a href="#leanpub-auto-reduce"><span class="section-number">3.14.2 </span>Reduce</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-search"><span class="section-number">3.15 </span>Search</a>
        <ul>
          <li>
            <a href="#leanpub-auto-generic-search"><span class="section-number">3.15.1 </span>Generic search</a>
          </li>
          <li>
            <a href="#leanpub-auto-sort"><span class="section-number">3.15.2 </span>Sort</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-v4-flat-map"><span class="section-number">3.16 </span><strong>[v4]</strong> Flat map</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#leanpub-auto-string-templates"><span class="section-number">4. </span>String templates</a>
    <ul>
      <li>
        <a href="#leanpub-auto-interpolate"><span class="section-number">4.1 </span>interpolate</a>
      </li>
      <li>
        <a href="#leanpub-auto-escape"><span class="section-number">4.2 </span>escape</a>
      </li>
      <li>
        <a href="#leanpub-auto-evaluate"><span class="section-number">4.3 </span>evaluate</a>
      </li>
      <li>
        <a href="#leanpub-auto-imports"><span class="section-number">4.4 </span>imports</a>
      </li>
      <li>
        <a href="#leanpub-auto-data-object-name"><span class="section-number">4.5 </span>Data object name</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#leanpub-auto-recipes"><span class="section-number">5. </span>Recipes</a>
    <ul>
      <li>
        <a href="#leanpub-auto-v3-filter-an-objects-properties"><span class="section-number">5.1 </span><strong>[v3]</strong> Filter an object’s properties</a>
        <ul>
          <li>
            <a href="#leanpub-auto-scenario"><span class="section-number">5.1.1 </span>Scenario</a>
          </li>
          <li>
            <a href="#leanpub-auto-solution"><span class="section-number">5.1.2 </span>Solution</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-v3-push-an-array-of-elements-into-an-array"><span class="section-number">5.2 </span><strong>[v3]</strong> Push an array of elements into an array</a>
        <ul>
          <li>
            <a href="#leanpub-auto-scenario-1"><span class="section-number">5.2.1 </span>Scenario</a>
          </li>
          <li>
            <a href="#leanpub-auto-solution-1"><span class="section-number">5.2.2 </span>Solution</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-v3-process-data-for-c3js-pie-chart"><span class="section-number">5.3 </span><strong>[v3]</strong> Process data for C3.js pie chart</a>
        <ul>
          <li>
            <a href="#leanpub-auto-scenario-2"><span class="section-number">5.3.1 </span>Scenario</a>
          </li>
          <li>
            <a href="#leanpub-auto-solution-2"><span class="section-number">5.3.2 </span>Solution</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-v3-create-a-unique-array-of-objects"><span class="section-number">5.4 </span><strong>[v3]</strong> Create a unique array of objects</a>
        <ul>
          <li>
            <a href="#leanpub-auto-scenario-3"><span class="section-number">5.4.1 </span>Scenario</a>
          </li>
          <li>
            <a href="#leanpub-auto-solution-3"><span class="section-number">5.4.2 </span>Solution</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#leanpub-auto-convert-an-array-to-an-object"><span class="section-number">5.5 </span>Convert an array to an object</a>
        <ul>
          <li>
            <a href="#leanpub-auto-scenario-4"><span class="section-number">5.5.1 </span>Scenario</a>
          </li>
          <li>
            <a href="#leanpub-auto-solution-4"><span class="section-number">5.5.2 </span>Solution</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <a href="#leanpub-auto-thank-you"><span class="section-number">6. </span>Thank you</a>
  </li>
  <li>
    <a href="#leanpub-endnotes">Notes</a>
  </li>
</ul>

</ol>
</div>
<div id="leanpub-main" class="kramdown">
<h2 id="leanpub-auto-introduction">
<span class="section-number">1. </span>Introduction</h2>

<p>This book is about popular JavaScript utilities library <a href="http://lodash.com/">lodash</a>. Before we discuss lodash, we need to understand why we need a JavaScript utilities library. With the prevalence of <a href="http://en.wikipedia.org/wiki/Web_2.0">Web 2.0</a>, <a href="http://en.wikipedia.org/wiki/Ajax_(programming)">Ajax</a> and <a href="http://nodejs.org">NodeJS</a>, JavaScript has become a very important programming language in both browser and server side. Besides of the bad parts<sup id="fnref-fn1"><a href="#fn-fn1" rel="footnote">1</a></sup> of JavaScript language, JavaScript itself doesn’t have a rich set of high-level API for developers to use, which makes common programming tasks hard to complete.</p>

<p>For example, it’s a very common task to iterate an array and process items in this array in sequence. In some old browsers, JavaScript <code>Array</code> object doesn’t have the method <code>forEach</code>. To iterate an array, <code>for</code> loop is required as in Listing 1.1.</p>

<figure class="code">
  <figcaption>Listing 1.1: Traditional approach to iterate an array</figcaption>

<div class="highlight"><pre><code></code><code class="k">for</code> <code class="p">(</code><code class="kd">var</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">n</code> <code class="o">=</code> <code class="nx">array</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">n</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
  <code class="nx">process</code><code class="p">(</code><code class="nx">array</code><code class="p">[</code><code class="nx">i</code><code class="p">]);</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>When using <code>forEach</code> method, Listing 1.1 can be simplified as in Listing 1.2.</p>

<figure class="code">
  <figcaption>Listing 1.2: Use <code>forEach</code> to iterate an array</figcaption>

<div class="highlight"><pre><code></code><code class="nx">array</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">process</code><code class="p">);</code>
</pre></div>

</figure>

<p>Comparing code snippets in Listing 1.1 and Listing 1.2, it’s very obvious that Listing 1.2 is much simpler to understand and easier to write and maintain. That’s why developers want more high-level APIs. JavaScript itself is evolving to add more language features and APIs, but the process is not fast enough. <a href="http://en.wikipedia.org/wiki/ECMAScript">ECMAScript</a>, the specification behind JavaScript, includes nine new methods for searching and manipulating array contents in <a href="http://www.ecma-international.org/ecma-262/5.1/">5th edition</a>. This means developers can use <code>forEach</code> method when JavaScript engine supports ECMAScript 5. But some old browsers, like IE 8, don’t support ECMAScript 5, which means developers need to consider about cross-platform compatibility issues if supporting old browsers is required. <a href="http://www.ecma-international.org/ecma-262/6.0/">ECMAScript 6</a> specification is published in June 2015 with a lot of new features and enhancements.</p>

<aside class="information blurb">
    <p>See a comprehensive ECMAScript 5 &amp; 6 compatibility table at <a href="http://kangax.github.io/compat-table/es5/">here</a> and <a href="http://kangax.github.io/compat-table/es6/">here</a>.</p>

</aside>

<p>Developers rely on JavaScript libraries to make daily development easier. The goal of libraries is to become the bridge between JavaScript runtime and developers. Developers can enjoy the high-level APIs provided by libraries. Libraries handle underlying implementation details about how to use low-level JavaScript APIs efficiently.</p>

<p>You may have heard about or even used another JavaScript utilities library <a href="http://underscorejs.org/">Underscore</a>. Underscore provides a rich set of common APIs in namespace <code>_</code>. Lodash also uses namespace <code>_</code> and it’s a drop-in replacement of Underscore with more features and performance improvements. If you already use Underscore, you can replace the Underscore with lodash, everything should just work.</p>

<p>This book contains content for lodash version 3.10.1 and 4.17.4. Lodash v4 introduced some breaking changes which have compatibility issues with v3. Those changes will be documented clearly in this book. Since most of the users of lodash are still using v3, the main content of this book is based on v3.</p>

<h3 id="leanpub-auto-installation">
<span class="section-number">1.1 </span>Installation</h3>

<p>Lodash is just a plain old JavaScript library, so it’s very easy to install and use.</p>

<h4 id="leanpub-auto-web">
<span class="section-number">1.1.1 </span>Web</h4>

<p>In a web application, just download lodash release JavaScript file and include in the HTML page, then use <code>_</code> in the JavaScript code.</p>

<figure class="code">
  <figcaption>Listing 1.3: Install lodash in HTML page</figcaption>

<div class="highlight"><pre><code></code><code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"lodash.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
</pre></div>

</figure>

<p>You can also use links provided by CDN servers to load lodash. CDN servers usually have different versions of lodash to choose. Listing 1.4 shows how to use <a href="https://cdnjs.com/libraries/lodash.js">cdnjs</a> to load lodash.</p>

<figure class="code">
  <figcaption>Listing 1.4. Load lodash from cdnjs</figcaption>

<div class="highlight"><pre><code></code><code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"//cdnjs.cloudflare.com/ajax/libs/lodash.js/4.3.0/lodash.js"</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
</pre></div>

</figure>

<p><a href="http://bower.io">Bower</a> can be used to install lodash.</p>

<figure class="code">
  <figcaption>Listing 1.5: Install lodash using Bower</figcaption>

<div class="highlight"><pre><code></code>$ bower install lodash --save
</pre></div>

</figure>

<aside class="warning blurb">
    <h5 id="leanpub-auto-no-bower-support-in-v4">No Bower support in v4</h5>

  <p>Bower support has been removed in v4 in favor of npm. But we can still use Bower to download lodash v4.</p>

</aside>

<h4 id="leanpub-auto-nodejs">
<span class="section-number">1.1.2 </span>NodeJS</h4>

<p>In NodeJS, install lodash using <a href="http://npmjs.org">npm</a>,</p>

<figure class="code">
  <figcaption>Listing 1.6: Install lodash using npm</figcaption>

<div class="highlight"><pre><code></code>$ npm install --save lodash

$ npm install --save lodash@3.10.1
</pre></div>

</figure>

<p>Then use <code>require</code> to import lodash package,</p>

<figure class="code">
  <figcaption>Listing 1.7: Use lodash in NodeJS</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">_</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'lodash'</code><code class="p">);</code> <code class="c1">// Require the whole lodash package</code>

<code class="kd">var</code> <code class="nx">forEach</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'lodash/forEach'</code><code class="p">);</code> <code class="c1">// Require only forEach (v4)</code>

<code class="kd">var</code> <code class="nx">forEach</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'lodash/collection/forEach'</code><code class="p">);</code> <code class="c1">// Require only forEach (v3)</code>
</pre></div>

</figure>

<aside class="warning blurb">
    <h5 id="leanpub-auto-removed-category-names-from-module-paths-in-v4">Removed category names from module paths in v4</h5>

  <p>When using <code>require</code> to load separate modules, category names have been removed from module paths. For example, path of module <code>forEach</code> is <code>lodash/collection/forEach</code> in v3, but the path is <code>lodash/forEach</code> in v4.</p>

</aside>

<p>It’s recommended to only install NodeJS modules of actually used modules. For example, if the code only uses <code>_.forEach</code> method, then install the <code>lodash.foreach</code> module only.</p>

<figure class="code">
  <figcaption>Listing 1.8: Use lodash modules</figcaption>

<div class="highlight"><pre><code></code><code class="nx">$</code> <code class="nx">npm</code> <code class="nx">install</code> <code class="o">--</code><code class="nx">save</code> <code class="nx">lodash</code><code class="p">.</code><code class="nx">foreach</code>

<code class="kd">var</code> <code class="nx">forEach</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'lodash.foreach'</code><code class="p">);</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-lodash-features">
<span class="section-number">1.2 </span>Lodash features</h3>

<p>Lodash focuses on providing core features that are frequently used for JavaScript built-in objects, including:</p>

<ul>
  <li>Arrays</li>
  <li>Objects</li>
  <li>Functions</li>
  <li>Strings</li>
</ul>

<p>Some of those features may have been included in latest version of ECMAScript specification. Some platforms may have also implemented extra features. If the underlying platform already supports a certain feature, lodash just uses the native feature to improve performance.</p>

<h3 id="leanpub-auto-code-sample-convention">
<span class="section-number">1.3 </span>Code sample convention</h3>

<p>All code samples in this book are written in plain old ECMAScript 5 JavaScript syntax. For each statement, the result of execution is provided below the actual code line as a comment.</p>

<figure class="code">
  <figcaption>Listing 1.9: Code sample convention</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">min</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]);</code>
<code class="c1">// -&gt; 1</code>
</pre></div>

</figure>

<p>As in the Listing 1.9 above, <code>_.min([1, 2, 3]);</code> is the actual code, <code>1</code> after <code>// -&gt;</code> is the execution result.</p>

<h3 id="leanpub-auto-about-this-book">
<span class="section-number">1.4 </span>About this book</h3>

<p>Lodash is a well-documented JavaScript library with comprehensive <a href="https://lodash.com/docs">official documentation</a>. This book is a simple and concise guide on how to use lodash in practice. It covers core features and most frequently used functions.</p>


<h2 id="leanpub-auto-common-concepts">
<span class="section-number">2. </span>Common concepts</h2>

<p>Before diving into details of lodash’s functions, let’s introduce some common concepts in lodash first.</p>

<h3 id="leanpub-auto-truthy-and-falsy">
<span class="section-number">2.1 </span>Truthy and falsy</h3>

<p>Truthy and falsy values are very important when using lodash predicates. <code>false</code>, <code>0</code>, <code>""</code>(empty string), <code>null</code>, <code>undefined</code> and <code>NaN</code> are falsy values in JavaScript. All other values are truthy values.</p>

<h3 id="leanpub-auto-samevaluezero">
<span class="section-number">2.2 </span>SameValueZero</h3>

<p><em><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-samevaluezero">SameValueZero</a></em> is the algorithm of how to compare two values in lodash. It’s similar with JavaScript “strict equality comparison” (<code>===</code>), except the handling of <code>NaN</code>. Because <code>NaN === NaN</code> returns false, it causes confusion to developers. <em>SameValueZero</em> removes that confusion, so <code>NaN</code> is same to <code>NaN</code> in <em>SameValueZero</em> algorithm.</p>

<h3 id="leanpub-auto-predicates">
<span class="section-number">2.3 </span>Predicates</h3>

<p>Predicate functions only return truthy or falsy values. They are used frequently in lodash. For example, when filtering a collection, a predicate function is required to determine what kind of elements should be filtered.</p>

<p>Predicate functions can be written directly by developers as plain old JavaScript functions. Lodash provides some helper functions to generate predicate functions for common use cases.</p>

<h4 id="leanpub-auto-matches">
<span class="section-number">2.3.1 </span><code>_.matches</code>
</h4>

<p><code>_.matches(source)</code> takes a source object and creates a new function which performs a deep comparison between given object and the source object. <code>_.matches</code> supports comparison of different types of data, including booleans, numbers, string, <code>Date</code> objects, <code>RegExp</code> objects, <code>Object</code> objects and arrays.</p>

<figure class="code">
  <figcaption>Listing 2.1: Match by object comparison</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">f</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">matches</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">);</code>
<code class="nx">f</code><code class="p">(</code><code class="s1">'world'</code><code class="p">);</code>
<code class="c1">// -&gt; false</code>
<code class="nx">f</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">);</code>
<code class="c1">// -&gt; true</code>

<code class="nx">f</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">matches</code><code class="p">([{</code><code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">},</code> <code class="p">{</code><code class="nx">b</code><code class="o">:</code> <code class="mi">2</code><code class="p">}]);</code>
<code class="nx">f</code><code class="p">([{</code><code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">},</code> <code class="p">{</code><code class="nx">b</code><code class="o">:</code> <code class="mi">3</code><code class="p">}]);</code>
<code class="c1">// -&gt; false</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-matchesproperty">
<span class="section-number">2.3.2 </span><code>_.matchesProperty</code>
</h4>

<p><code>_.matchesProperty(path, value)</code> takes a property path and expected value of this property path to create a new function which checks if given object’s value of the same property path matches the expected value.</p>

<figure class="code">
  <figcaption>Listing 2.2: Match by comparing property value</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">f</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">matchesProperty</code><code class="p">(</code><code class="s1">'name'</code><code class="p">,</code> <code class="s1">'Alex'</code><code class="p">);</code>
<code class="nx">f</code><code class="p">({</code><code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">});</code>
<code class="c1">// -&gt; true</code>

<code class="nx">f</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">matchesProperty</code><code class="p">(</code><code class="s1">'length'</code><code class="p">,</code> <code class="mi">5</code><code class="p">);</code>
<code class="nx">f</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">);</code>
<code class="c1">// -&gt; true</code>

<code class="kd">var</code> <code class="nx">f</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">matchesProperty</code><code class="p">(</code><code class="s1">'user.name'</code><code class="p">,</code> <code class="s1">'Alex'</code><code class="p">);</code>
<code class="nx">f</code><code class="p">({</code><code class="nx">user</code><code class="o">:</code> <code class="p">{</code><code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">}});</code>
<code class="c1">// -&gt; true</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-property">
<span class="section-number">2.3.3 </span><code>_.property</code>
</h4>

<p><code>_.property(path)</code> takes a property path and creates a new function which returns the value of this property path in given object. <code>_.property</code> can be used to create predicate functions with property value converted to truthy or falsy value.</p>

<figure class="code">
  <figcaption>Listing 2.3: Match by property’s own value</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">f</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">property</code><code class="p">(</code><code class="s1">'name'</code><code class="p">);</code>
<code class="nx">f</code><code class="p">({</code><code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">});</code>
<code class="c1">// -&gt; 'Alex'</code>
</pre></div>

</figure>

<p>For lodash functions which accept predicates, e.g. <code>_.find</code>, <code>_.filter</code>, predicates can be specified using functions, strings, and objects.</p>

<ul>
  <li>If a function is provided, it’s used directly.</li>
  <li>If only a string is provided, it’s used to create a function using <code>_.property</code> as the predicate.</li>
  <li>If a string and a value are provided, they are used to create a function using <code>_matchesProperty</code> as the predicate.</li>
  <li>If an object is provided, it’s used to create a function using <code>_.matches</code> as the predicate.</li>
</ul>

<aside class="warning blurb">
    <h5 id="leanpub-auto-matchesproperty-shorthand-in-v4">
<code>_.matchesProperty</code> shorthand in v4</h5>

  <p>In v4, an array of the string and value needs to be used to be treated as <code>_.matchesProperty</code>. So instead of using <code>_.find(users, 'name', 'Alex')</code>, <code>_.find(users, ['name', 'Alex'])</code> should be used in v4.</p>

</aside>

<p>For example, given an array as in Listing 2.4:</p>

<figure class="code">
  <figcaption>Listing 2.4: Example input array</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">users</code> <code class="o">=</code> <code class="p">[</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">,</code>
    <code class="nx">age</code><code class="o">:</code> <code class="mi">30</code><code class="p">,</code>
    <code class="nx">is_premium</code><code class="o">:</code> <code class="kc">false</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Bob'</code><code class="p">,</code>
    <code class="nx">age</code><code class="o">:</code> <code class="mi">20</code><code class="p">,</code>
    <code class="nx">is_premium</code><code class="o">:</code> <code class="kc">true</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Mary'</code><code class="p">,</code>
    <code class="nx">age</code><code class="o">:</code> <code class="mi">25</code><code class="p">,</code>
    <code class="nx">is_premium</code><code class="o">:</code> <code class="kc">false</code>
  <code class="p">}</code>
<code class="p">];</code>
</pre></div>

</figure>

<p>A JavaScript function can be used as the predicate to <code>_.find</code>. Listing 2.5 returns objects in <code>users</code> array with <code>age</code> greater than <code>18</code>.</p>

<figure class="code">
  <figcaption>Listing 2.5: Find using a function</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">find</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">user</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">user</code><code class="p">.</code><code class="nx">age</code> <code class="o">&gt;</code> <code class="mi">18</code><code class="p">;</code>
<code class="p">});</code>
</pre></div>

</figure>

<p>If a string is passed as the predicate, it’s treated as a property name of objects in the array. Listing 2.6 returns objects in the array with truthy value of property <code>is_premium</code>. The actual used predicate is <code>_.property('is_premium')</code>.</p>

<figure class="code">
  <figcaption>Listing 2.6: Find using a property value</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">find</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="s1">'is_premium'</code><code class="p">);</code>
</pre></div>

</figure>

<p>If an object is passed as the predicate, it’s treated as a search example. Objects in returned results must have exactly the same value for the same property provided in the search example. Listing 2.7 returns objects in the array with the value of <code>name</code> property equals to <code>Alex</code>. The actual used predicate is <code>_.matches({ name: 'Alex' })</code>.</p>

<figure class="code">
  <figcaption>Listing 2.7: Find using an object</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">find</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="p">{</code> <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code> <code class="p">});</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p>If a lodash function’s argument name is <code>predicate</code>, it means this argument supports predicate syntax described above.</p>

</aside>

<h3 id="leanpub-auto-iteratees">
<span class="section-number">2.4 </span>Iteratees</h3>

<p>Iteratees are used by lodash functions which require iterating through a collection. Iteratee is invoked for each element in the collection and the result is used instead of the element. Iteratees are used to transform collections. A typical usage of iteratee is in lodash <code>_.map</code> function. The second argument of <code>_.map</code> is the iteratee. The result of applying iteratee to each element in the collection is collected and returned.</p>

<figure class="code">
  <figcaption>Listing 2.8: <code>map</code> using an iterate function</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">n</code> <code class="o">*</code> <code class="mi">3</code><code class="p">;</code>
<code class="p">})</code>
<code class="c1">// -&gt; [3, 6, 9]</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p>If a lodash function’s argument name is <code>iteratee</code>, it means this argument is an iteratee function.</p>

</aside>

<h4 id="leanpub-auto-v4-iteratee-shorthand">
<span class="section-number">2.4.1 </span><strong>[v4]</strong> Iteratee shorthand</h4>

<p>In v4, when iteratee functions are required, we can also use the similar syntax as predicate functions to quickly create them. These iteratee shorthands use <code>_.matches</code>, <code>_.matchesProperty</code> or <code>_.property</code> methods behind the scene.</p>

<p>In the second line of using <code>_.map</code> of Listing 2.9, the second argument of <code>_.map</code> must be an array to indicate that it uses <code>_.matchesProperty</code>.</p>

<figure class="code">
  <figcaption>Listing 2.9. <code>map</code> using an iteratee shorthand</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="p">{</code><code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">});</code> <code class="c1">// Use _.matches</code>
<code class="c1">// -&gt; [true, false, false]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="p">[</code><code class="s1">'name'</code><code class="p">,</code> <code class="s1">'Alex'</code><code class="p">]);</code> <code class="c1">// Use _.matchesProperty</code>
<code class="c1">// -&gt; [true, false, false]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">);</code> <code class="c1">// Use _.property</code>
<code class="c1">// -&gt; ["Alex", "Bob", "Mary"]</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-v3-this-binding">
<span class="section-number">2.5 </span><strong>[v3]</strong> <code>this</code> binding</h3>

<p>When using predicates and iteratees, an optional object can be passed as the bound value of <code>this</code> keyword when invoked. This is very handy when predicates and iteratees reside in other objects and need to access properties in those objects.</p>

<figure class="code">
  <figcaption>Listing 2.10: <code>map</code> with <code>this</code> binding</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">obj</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">val</code><code class="o">:</code> <code class="mi">10</code><code class="p">,</code>
  <code class="nx">add</code><code class="o">:</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">val</code> <code class="o">+</code> <code class="nx">n</code><code class="p">;</code>
  <code class="p">}</code>
<code class="p">};</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="nx">obj</code><code class="p">.</code><code class="nx">add</code><code class="p">,</code> <code class="nx">obj</code><code class="p">);</code>
<code class="c1">// -&gt; [11, 12, 13]</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p>If a lodash function’s argument name is <code>thisArg</code>, then this function supports binding <code>this</code> value.</p>

</aside>

<h3 id="leanpub-auto-v4-this-binding">
<span class="section-number">2.6 </span><strong>[v4]</strong> <code>this</code> binding</h3>

<p>In v4, <code>thisArg</code> argument in most methods have been removed. To specify the binding object, <code>_.bind</code> should be used explicitly.</p>

<figure class="code">
  <figcaption>Listing 2.11: <code>map</code> with <code>this</code> binding using <code>_.bind</code></figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">obj</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">val</code><code class="o">:</code> <code class="mi">10</code><code class="p">,</code>
  <code class="nx">add</code><code class="o">:</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">val</code> <code class="o">+</code> <code class="nx">n</code><code class="p">;</code>
  <code class="p">}</code>
<code class="p">};</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="nx">_</code><code class="p">.</code><code class="nx">bind</code><code class="p">(</code><code class="nx">obj</code><code class="p">.</code><code class="nx">add</code><code class="p">,</code> <code class="nx">obj</code><code class="p">));</code>
<code class="c1">// -&gt; [11, 12, 13]</code>
</pre></div>

</figure>

<p>Listing 2.11 works in both v3 and v4, but Listing 2.10 only works in v3.</p>


<h2 id="leanpub-auto-collections">
<span class="section-number">3. </span>Collections</h2>

<p>A collection is an object which contains iterable elements. In lodash, collections can be arrays, objects, and strings. Lodash has a rich set of functions to work with collections.</p>

<h3 id="leanpub-auto-every-and-some">
<span class="section-number">3.1 </span>Every and some</h3>

<p><code>_.every(collection, [predicate=_.identity], [thisArg])</code> checks if <strong>all</strong> elements in the collection satisfy given condition. The condition is specified using predicate.</p>

<figure class="code">
  <figcaption>Listing 3.1: Check if all elements match certain condition</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">every</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">n</code> <code class="o">%</code> <code class="mi">2</code> <code class="o">===</code> <code class="mi">0</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; false</code>

<code class="kd">var</code> <code class="nx">fruits</code> <code class="o">=</code> <code class="p">[</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'apple'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">1.99</code><code class="p">,</code>
    <code class="nx">onSale</code><code class="o">:</code> <code class="kc">true</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'orange'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">0.99</code><code class="p">,</code>
    <code class="nx">onSale</code><code class="o">:</code> <code class="kc">true</code>
  <code class="p">}</code>
<code class="p">];</code>
<code class="nx">_</code><code class="p">.</code><code class="nx">every</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="s1">'onSale'</code><code class="p">,</code> <code class="kc">true</code><code class="p">);</code>
<code class="c1">// -&gt; true</code>

<code class="kd">var</code> <code class="nx">obj</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">3</code>
<code class="p">};</code>
<code class="nx">_</code><code class="p">.</code><code class="nx">every</code><code class="p">(</code><code class="nx">obj</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">n</code> <code class="o">%</code> <code class="mi">2</code> <code class="o">===</code> <code class="mi">0</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; false</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p><code>_.all</code> is an alias of <code>_.every</code> in v3. <code>_.all</code> is removed in v4.</p>

</aside>

<p><code>_.some(collection, [predicate=_.identity], [thisArg])</code> is the opposite of <code>_.every</code> which checks if <strong>any</strong> element in the collection satisfies given condition. The condition is also specified using a predicate. <code>_.some</code> doesn’t need to iterate the entire collection and the iteration exits as soon as a matching element is found.</p>

<figure class="code">
  <figcaption>Listing 3.2: Check if any element matches certain condition</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">some</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">n</code> <code class="o">%</code> <code class="mi">2</code> <code class="o">===</code> <code class="mi">0</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; true</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">some</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">c</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">c</code> <code class="o">===</code> <code class="s1">'h'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; true</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p><code>_.any</code> is an alias of <code>_.some</code> in v3. <code>_.any</code> is removed in v4.</p>

</aside>

<h3 id="leanpub-auto-filter-and-reject">
<span class="section-number">3.2 </span>Filter and reject</h3>

<p><code>_.filter(collection, [predicate=_.identity], [thisArg])</code> filters a collection by returning elements matching given predicate. <code>_.reject(collection, [predicate=_.identity], [thisArg])</code> is the opposite of <code>_.filter</code>, which returns elements <strong>not</strong> matching given predicate. When <code>_.filter</code> is used to filter objects, only values of matching properties are returned. If you want to keep the original object structure, use <code>_.pick</code> and <code>_.omit</code> instead. When <code>_.filter</code> is used on strings, matching characters are returned in array.</p>

<figure class="code">
  <figcaption>Listing 3.3: Filter a collection</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">filter</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="kr">char</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="kr">char</code> <code class="o">&gt;</code> <code class="s1">'b'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; ['c']</code>

<code class="kd">var</code> <code class="nx">obj</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">3</code>
<code class="p">};</code>
<code class="nx">_</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="nx">obj</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">n</code> <code class="o">&gt;</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; [2, 3]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">c</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">c</code> <code class="o">!==</code> <code class="s1">'l'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; ['h', 'e', 'o']</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">reject</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="kr">char</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="kr">char</code> <code class="o">&gt;</code> <code class="s1">'b'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; ['a', 'b']</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p><code>_.filter</code> and <code>_.reject</code> always return a new array. Input collection is not modified, a new array of filtered or rejected elements, object property values or characters are returned.</p>

</aside>

<aside class="information blurb">
    <p><code>_.select</code> is an alias of <code>_.filter</code> in v3 <code>_.select</code> is removed in v4.</p>

</aside>

<h3 id="leanpub-auto-v3-where">
<span class="section-number">3.3 </span><strong>[v3]</strong> Where</h3>

<p><code>_.where(collection, source)</code> filters a collection by performing a deep comparison between each element and the given object. The actual filtering predicate is generated using <code>_.matches</code>.</p>

<figure class="code">
  <figcaption>Listing 3.4: Filter a collection by comparing objects</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">users</code> <code class="o">=</code> <code class="p">[</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">,</code>
    <code class="nx">email</code><code class="o">:</code> <code class="s1">'alex@example.org'</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Bob'</code><code class="p">,</code>
    <code class="nx">email</code><code class="o">:</code> <code class="s1">'bob@example.org'</code>
  <code class="p">}</code>
<code class="p">];</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">where</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="p">{</code>
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code>
<code class="p">});</code>
<code class="c1">// -&gt; [{name: 'Alex', email: 'alex@example.org'}]</code>
</pre></div>

</figure>

<aside class="warning blurb">
    <h5 id="leanpub-auto-where-removed-in-v4">
<code>_.where</code> removed in v4</h5>

  <p><code>_.where</code> is removed in v4, we can use <code>_.filter</code> with iteratee shorthand. So all <code>_.where</code> methods in Listing 3.6 can be replaced with <code>_.filter</code>.</p>

</aside>

<h3 id="leanpub-auto-size">
<span class="section-number">3.4 </span>Size</h3>

<p><code>_.size(collection)</code> gets the size of a collection. For arrays, the size is the array’s length, same as the array’s <code>length</code> property. For objects, the size is the number of own enumerable properties, i.e. the length of the array returned by <code>_.keys</code>. For strings, the size is the string’s length.</p>

<figure class="code">
  <figcaption>Listing 3.5: Get the size of a collection</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">size</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]);</code>
<code class="c1">// -&gt; 2</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">size</code><code class="p">({</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">3</code>
<code class="p">});</code>
<code class="c1">// -&gt; 3</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">size</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">);</code>
<code class="c1">// -&gt; 5</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-v3-pluck">
<span class="section-number">3.5 </span><strong>[v3]</strong> Pluck</h3>

<p><code>_.pluck(collection, key)</code> gets all values of the same property key from all elements in the collection. The values are returned in a new array.</p>

<figure class="code">
  <figcaption>Listing 3.6: Get all values of the same property key</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">fruits</code> <code class="o">=</code> <code class="p">[</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'apple'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">1.99</code><code class="p">,</code>
    <code class="nx">onSale</code><code class="o">:</code> <code class="kc">true</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'orange'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">0.99</code><code class="p">,</code>
    <code class="nx">onSale</code><code class="o">:</code> <code class="kc">true</code>
  <code class="p">}</code>
<code class="p">];</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">pluck</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">);</code>
<code class="c1">// -&gt; ['apple', 'orange']</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">pluck</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="s1">'prop'</code><code class="p">);</code>
<code class="c1">// -&gt; [undefined, undefined]</code>

<code class="kd">var</code> <code class="nx">obj</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">a</code><code class="o">:</code> <code class="p">{</code>
    <code class="nx">value</code><code class="o">:</code> <code class="mi">0</code>
  <code class="p">},</code>
  <code class="nx">b</code><code class="o">:</code> <code class="p">{</code>
    <code class="nx">value</code><code class="o">:</code> <code class="mi">1</code>
  <code class="p">}</code>
<code class="p">};</code>
<code class="nx">_</code><code class="p">.</code><code class="nx">pluck</code><code class="p">(</code><code class="nx">obj</code><code class="p">,</code> <code class="s1">'value'</code><code class="p">);</code>
<code class="c1">// -&gt; [0, 1]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">pluck</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="s1">'length'</code><code class="p">);</code>
<code class="c1">// -&gt; [1, 1, 1, 1, 1]</code>
</pre></div>

</figure>

<aside class="warning blurb">
    <h5 id="leanpub-auto-pluck-removed-in-v4">
<code>_.pluck</code> removed in v4</h5>

  <p><code>_.pluck</code> is removed in v4, we can use <code>_.map</code> with iteratee shorthand. So all <code>_.pluck</code> methods in Listing 3.6 can be replaced with <code>_.map</code>.</p>

</aside>

<h3 id="leanpub-auto-at">
<span class="section-number">3.6 </span>At</h3>

<p><code>_.at(collection, [props])</code> gets values from a collection by given property keys or array indexes.</p>

<figure class="code">
  <figcaption>Listing 3.7: Get values from a collection by keys or indexes</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">at</code><code class="p">({</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">3</code>
<code class="p">},</code> <code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">]);</code>
<code class="c1">// -&gt; [1, 3]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">at</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]);</code>
<code class="c1">// -&gt; ['e', 'l']</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-includes">
<span class="section-number">3.7 </span>Includes</h3>

<p><code>_.includes(collection, target, [fromIndex=0])</code> checks if a collection contains given value. An optional index can be provided as the starting position to search. If the collection is an object, values of this object’s properties, i.e. result of <code>_.values</code>, are searched instead. <code>_.includes</code> uses <code>SameAsZero</code> algorithm to check equality.</p>

<figure class="code">
  <figcaption>Listing 3.8: Check if a collection contains given value</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">includes</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">],</code> <code class="s1">'a'</code><code class="p">);</code>
<code class="c1">// -&gt; true</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">includes</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">],</code> <code class="s1">'a'</code><code class="p">,</code> <code class="mi">1</code><code class="p">);</code>
<code class="c1">// -&gt; false</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">includes</code><code class="p">({</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">3</code>
<code class="p">},</code> <code class="mi">1</code><code class="p">);</code>
<code class="c1">// -&gt; true</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">includes</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="s1">'h'</code><code class="p">);</code>
<code class="c1">// -&gt; true</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p><code>_.include</code> and <code>_.contains</code> are aliases of <code>_.includes</code> in v3. <code>_.include</code> and <code>_.contains</code> are removed in v4.</p>

</aside>

<h3 id="leanpub-auto-sample">
<span class="section-number">3.8 </span>Sample</h3>

<p>In v3, <code>_.sample(collection, [n])</code> gets random elements from a collection. By default, it only returns one random element. A number of random elements can be provided. For objects, random properties’ values are returned. For strings, random characters are returned.</p>

<p>In v4, <code>_.sample</code>’s functionality is split into two methods, <code>_.sample</code> and <code>_.sampleSize</code>. <code>_.sample</code> only gets a single random element from a collection. <code>_.sampleSize</code> allows specifying the number of elements to get.</p>

<figure class="code">
  <figcaption>Listing 3.9: Get random elements from a collection</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">sample</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">]);</code> <code class="c1">// v3</code>
<code class="c1">// -&gt; 'a'</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">sample</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">],</code> <code class="mi">2</code><code class="p">);</code> <code class="c1">// v3</code>
<code class="c1">// -&gt; ['a', 'b']</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">sample</code><code class="p">({</code> <code class="c1">// v3</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">3</code>
<code class="p">});</code>
<code class="c1">// -&gt; 1</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">sample</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="mi">2</code><code class="p">);</code> <code class="c1">// v3</code>
<code class="c1">// -&gt; ['h', 'l']</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">sampleSize</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code> <code class="c1">// v4</code>
<code class="c1">// -&gt; ['h', 'l']</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-shuffle">
<span class="section-number">3.9 </span>Shuffle</h3>

<p><code>_.shuffle(collection)</code> shuffles a collection by generating a random permutation. <a href="https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle">Fisher-Yates shuffle</a> is the algorithm used in lodash.</p>

<figure class="code">
  <figcaption>Listing 3.10: Shuffle a collection</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">shuffle</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">]);</code>
<code class="c1">// -&gt; ['b', 'c', 'a']</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">shuffle</code><code class="p">({</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">3</code>
<code class="p">});</code>
<code class="c1">// -&gt; [1, 2, 3]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">shuffle</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">);</code>
<code class="c1">// -&gt; ['l', 'l', 'o', 'h', 'e']</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p>Due to the random nature of <code>_.sample</code> and <code>_.shuffle</code>, most likely the result will be different when running Listing 3.10 on your local machine.</p>

</aside>

<h3 id="leanpub-auto-partition">
<span class="section-number">3.10 </span>Partition</h3>

<p><code>_.partition(collection, [predicate=_.identity], [thisArg])</code> splits a collection into two groups based on the result of invoking a predicate on each element. The first group contains elements for which the predicate returns truthy value, while the second group contains elements for which predicate returns falsy value.</p>

<figure class="code">
  <figcaption>Listing 3.11: Split a collection into two groups</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">partition</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="kr">char</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="kr">char</code> <code class="o">&gt;</code> <code class="s1">'a'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; [['b', 'c'], ['a']]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">partition</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="s1">'onSale'</code><code class="p">);</code>
<code class="c1">// -&gt; [[{ name: 'apple', price: 1.99, onSale: true },</code>
<code class="c1">//      { name: 'orange', price: 0.99, onSale: true }],</code>
<code class="c1">//     []]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">partition</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="kr">char</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="kr">char</code> <code class="o">&gt;</code> <code class="s1">'l'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; [['o'], ['h', 'e', 'l', 'l']]</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-count-by">
<span class="section-number">3.11 </span>Count by</h3>

<p><code>_.countBy(collection, [iteratee=_.identity], [thisArg])</code> applies a function to each element in the collection and counts the number of occurrences of each result. Counting result is returned as an object.</p>

<figure class="code">
  <figcaption>Listing 3.12: Count the number of occurrences of function invocation results</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">countBy</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">n</code> <code class="o">&gt;</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {false: 1, true: 2}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">countBy</code><code class="p">({</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">2</code>
<code class="p">},</code> <code class="kd">function</code><code class="p">(</code><code class="nx">val</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">val</code> <code class="o">/</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {1: 1, 0.5: 2}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">countBy</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="kr">char</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="kr">char</code> <code class="o">===</code> <code class="s1">'l'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {false: 3, true: 2}</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-group-by-and-index-by">
<span class="section-number">3.12 </span>Group by and index by</h3>

<p><code>_.groupBy(collection, [iteratee=_.identity], [thisArg])</code> applies a function to each element in the collection and groups the elements by the result. Elements have the same result will be in the same group. The grouping result is returned as an object. The keys in the object are the results, the values are arrays of elements which generate the corresponding result.</p>

<figure class="code">
  <figcaption>Listing 3.13: Group elements by function invocation results</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">groupBy</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">n</code> <code class="o">&gt;</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {false: [1], true: [2, 3]}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">groupBy</code><code class="p">({</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">b</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">c</code><code class="o">:</code> <code class="mi">2</code>
<code class="p">},</code> <code class="kd">function</code><code class="p">(</code><code class="nx">val</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">val</code> <code class="o">/</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {0.5: [1, 1], 1: [2]}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">groupBy</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="kr">char</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="kr">char</code> <code class="o">===</code> <code class="s1">'l'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {fasle: ['h', 'e', o], true: ['l', 'l']}</code>
</pre></div>

</figure>

<p>The difference between <code>_.countBy</code> and <code>_.groupBy</code> is that <code>_.countBy</code> only returns the number of grouped elements.</p>

<p>In v3, <code>_.indexBy(collection, [iteratee=_.identity], [thisArg])</code>’s behavior is similar with <code>_.groupBy</code>, but <code>_.indexBy</code> only keeps last element for each result.</p>

<figure class="code">
  <figcaption>Listing 3.14: Get last element of function invocation results</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">indexBy</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">n</code> <code class="o">&gt;</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {false: 1, true: 3}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">indexBy</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="kr">char</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="kr">char</code> <code class="o">===</code> <code class="s1">'l'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {false: 'o', true: 'l'}</code>
</pre></div>

</figure>

<aside class="warning blurb">
    <h5 id="leanpub-auto-indexby-renamed-to-keyby-in-v4">
<code>_.indexBy</code> renamed to <code>_.keyBy</code> in v4</h5>

  <p>In v4, <code>_.indexBy</code> is renamed to <code>_.keyBy</code> with the same functionality.</p>

</aside>

<h3 id="leanpub-auto-v3-invoke">
<span class="section-number">3.13 </span><strong>[v3]</strong> Invoke</h3>

<p>In v3, <code>_.invoke(collection, methodName, [args])</code> invokes a method on each element in the collection and returns results in an array. The method to invoke is provided by name, so only element’s own or inherited methods are allowed. Additional arguments can also be provided as arguments for method invocation.</p>

<figure class="code">
  <figcaption>Listing 3.15: Invoke a method on each element in the collection</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">invoke</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">],</code> <code class="s1">'toUpperCase'</code><code class="p">);</code>
<code class="c1">// -&gt; ['A', 'B', 'C']</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">invoke</code><code class="p">([[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">],</code> <code class="p">[</code><code class="s1">'c'</code><code class="p">,</code> <code class="s1">'d'</code><code class="p">]],</code> <code class="s1">'join'</code><code class="p">,</code> <code class="s1">''</code><code class="p">);</code>
<code class="c1">// -&gt; ['ab', 'cd']</code>
</pre></div>

</figure>

<aside class="warning blurb">
    <h5 id="leanpub-auto-invoke-renamed-to-invokemap-in-v4">
<code>_.invoke</code> renamed to <code>_.invokeMap</code> in v4</h5>

  <p>In v4, <code>_.invoke</code> from v3 is renamed to <code>_.invokeMap</code>. <code>_.invoke</code> in v4 is a different method working on objects, which will be covered in Chapter 5.</p>

</aside>

<h3 id="leanpub-auto-map-and-reduce">
<span class="section-number">3.14 </span>Map and reduce</h3>

<p>Map and reduce are common operations when processing collections. <code>map</code> transforms a collection into another collection by applying an operation to each element in the collection. <code>reduce</code> transforms a collection into a single value by accumulating result of applying an operation to each element. The result of the last operation is used as the input of the current operation.</p>

<h4 id="leanpub-auto-map">
<span class="section-number">3.14.1 </span>Map</h4>

<p><code>_.map(collection, [iteratee=_.identity], [thisArg])</code> is the generic map function provided by lodash.</p>

<p>Listing 3.15 uses a function to transform input array.</p>

<figure class="code">
  <figcaption>Listing 3.16: Generic map function</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">value</code> <code class="o">*</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; [2, 4, 6]</code>
</pre></div>

</figure>

<p>If <code>_.map</code> is used on collections of objects, property name and value can also be passed. This is the same syntax as using predicates in other lodash functions.</p>

<figure class="code">
  <figcaption>Listing 3.17: Map by property name and value</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">users</code> <code class="o">=</code> <code class="p">[</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Bob'</code>
  <code class="p">}</code>
<code class="p">];</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">);</code>
<code class="c1">// -&gt; ['Alex', 'Bob']</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">,</code> <code class="s1">'Alex'</code><code class="p">);</code> <code class="c1">// Only works in v3</code>
<code class="c1">// -&gt; [true, false]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="p">{</code><code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">});</code>
<code class="c1">// -&gt; [true, false]</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-reduce">
<span class="section-number">3.14.2 </span>Reduce</h4>

<p><code>_.reduce(collection, [iteratee=_.identity], [accumulator], [thisArg])</code> has similar arguments list with <code>_.map</code>,  except it accepts a value as the initial input of the first reduce operation. If the initial value is not provided, the first element in the collection is used. The provided iteratee function will be invoked with four arguments, <code>accumulator</code>, <code>value</code>, <code>index</code>/<code>key</code> and <code>collection</code>. <code>accumulator</code> is the current reduced value. Returned result of iteratee function invocation is passed as the <code>accumulator</code> value of next invocation.</p>

<p>Below is a simple example shows how to use <code>_.reduce</code> to sum the values in an array.</p>

<figure class="code">
  <figcaption>Listing 3.18: Use <code>_.reduce</code> to sum the values in an array</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">reduce</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">accumulator</code><code class="p">,</code> <code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">accumulator</code> <code class="o">+</code> <code class="nx">value</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; 6</code>
</pre></div>

</figure>

<p>Following example is similar to example above, but initial value <code>100</code> is provided.</p>

<figure class="code">
  <figcaption>Listing 3.19: Reduce with initial value</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">reduce</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">accumulator</code><code class="p">,</code> <code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">accumulator</code> <code class="o">+</code> <code class="nx">value</code><code class="p">;</code>
<code class="p">},</code> <code class="mi">100</code><code class="p">);</code>
<code class="c1">// -&gt; 106</code>
</pre></div>

</figure>

<p><code>_.reduceRight(collection, [iteratee=_.identity], [accumulator], [thisArg])</code> is similar with <code>_.reduce</code> except <code>_.reduceRight</code> iterates elements from right to left.</p>

<figure class="code">
  <figcaption>Listing 3.20: Reduce elements from right to left</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">reduceRight</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">accumulator</code><code class="p">,</code> <code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">accumulator</code><code class="p">.</code><code class="nx">toUpperCase</code><code class="p">()</code> <code class="o">+</code> <code class="nx">value</code><code class="p">;</code>
<code class="p">})</code>
<code class="c1">// -&gt; 'OLLEh'</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">reduce</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">accumulator</code><code class="p">,</code> <code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">accumulator</code><code class="p">.</code><code class="nx">toUpperCase</code><code class="p">()</code> <code class="o">+</code> <code class="nx">value</code><code class="p">;</code>
<code class="p">})</code>
<code class="c1">// -&gt; 'HELLo'</code>
</pre></div>

</figure>

<aside class="information blurb">
    <p>In v3, <code>_.collect</code> is an alias of <code>_.map</code>, <code>_.inject</code> and <code>_.foldl</code> are aliases of <code>_.reduce</code>. <code>_.foldr</code> is an alias of <code>_.reduceRight</code>. In v4, <code>_.collect</code>, <code>_.inject</code>, <code>_.foldl</code> and <code>_.foldr</code> are removed.</p>

</aside>

<h3 id="leanpub-auto-search">
<span class="section-number">3.15 </span>Search</h3>

<p>Search is a very common task in programming. Search is performed on iterable target collections with given conditions. The return result is the first element in the collection matching the condition or <code>undefined</code> is no matching element is found. Below is the input array used in following Listing.</p>

<figure class="code">
  <figcaption>Listing 3.21: Example input array</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">fruits</code> <code class="o">=</code> <code class="p">[</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'apple'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">0.99</code><code class="p">,</code>
    <code class="nx">onSale</code><code class="o">:</code> <code class="kc">true</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'orange'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">1.99</code><code class="p">,</code>
    <code class="nx">onSale</code><code class="o">:</code> <code class="kc">false</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'passion fruit'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">4.99</code><code class="p">,</code>
    <code class="nx">onSale</code><code class="o">:</code> <code class="kc">false</code>
  <code class="p">}</code>
<code class="p">];</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-generic-search">
<span class="section-number">3.15.1 </span>Generic search</h4>

<h5 id="leanpub-auto-find">
<span class="section-number">3.15.1.1 </span><code>_.find</code>
</h5>

<p><code>_.find(collection, [predicate=_.identity], [thisArg])</code> is the generic function to search in collections. When invoking <code>_.find</code>, the collection itself and search condition should be provided. <code>_.find</code> supports different types of arguments combinations. The first argument is always the collection to search in, i.e. arrays, objects or strings. If the second argument is a function, the function is invoked for each element in the array until this function returns truthy value. This function is invoked with three arguments: currently iterated element, index or key of this element and the collection itself.</p>

<figure class="code">
  <figcaption>Listing 3.22: Find using a predicate function</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">find</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">fruit</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">fruit</code><code class="p">.</code><code class="nx">price</code> <code class="o">&lt;=</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; {name: 'apple', price: 0.99, onSale: true}</code>
</pre></div>

</figure>

<p><code>_.find</code> can use the same predicate syntax as other lodash functions.</p>

<figure class="code">
  <figcaption>Listing 3.23: Find using different predicate syntax</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">find</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="s1">'onSale'</code><code class="p">);</code>
<code class="c1">// -&gt; {name: 'apple', price: 0.99, onSale: true}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">find</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">,</code> <code class="s1">'apple'</code><code class="p">);</code>
<code class="c1">// -&gt; {name: 'apple', price: 0.99, onSale: true}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">find</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="p">{</code>
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'apple'</code><code class="p">,</code>
  <code class="nx">onSale</code><code class="o">:</code> <code class="kc">true</code>
<code class="p">});</code>
<code class="c1">// -&gt; {name: 'apple', price: 0.99, onSale: true}</code>
</pre></div>

</figure>

<p>When invoking <code>_.find</code>, an object can always be added as the last argument for the <code>this</code> binding of invoking predicate.</p>

<aside class="information blurb">
    <p><code>_.detect</code> is an alias of <code>_.find</code> in v3. <code>_.detect</code> is removed in v4.</p>

</aside>

<h5 id="leanpub-auto-findlast">
<span class="section-number">3.15.1.2 </span><code>_.findLast</code>
</h5>

<p><code>_.findLast</code> is similar with <code>_.find</code>, but <code>_.findLast</code> iterates over elements of collection in reverse order. For arrays, it searches from the last element. For strings, it searches from the last character. For objects, it searches from the last element of an array of property names returned by <code>_.keys</code>.</p>

<figure class="code">
  <figcaption>Listing 3.24: Find in reverse order</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">findLast</code><code class="p">(</code><code class="s1">'hello'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="kr">char</code><code class="p">){</code>
  <code class="k">return</code> <code class="kr">char</code> <code class="o">&lt;</code> <code class="s1">'f'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; 'e'</code>
</pre></div>

</figure>

<h5 id="leanpub-auto-v3-findwhere">
<span class="section-number">3.15.1.3 </span><strong>[v3]</strong> <code>_.findWhere</code>
</h5>

<p><code>_.findWhere</code> is a simpler format of passing an object as the second argument of <code>_.find</code> function.</p>

<figure class="code">
  <figcaption>Listing 3.25: Find by comparing objects</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">findWhere</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="p">{</code>
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'apple'</code><code class="p">,</code>
  <code class="nx">onSale</code><code class="o">:</code> <code class="kc">true</code>
<code class="p">});</code>
<code class="c1">// -&gt; {name: 'apple', price: 0.99, onSale: true}</code>
</pre></div>

</figure>

<p><code>_.findWhere</code> doesn’t allow providing <code>this</code> binding for invoking predicates.</p>

<aside class="warning blurb">
    <h5 id="leanpub-auto-findwhere-removed-in-v3">
<code>_.findWhere</code> removed in v3</h5>

  <p><code>_.findWhere</code> is removed in v4, <code>_.find</code> should be used instead.</p>

</aside>

<h4 id="leanpub-auto-sort">
<span class="section-number">3.15.2 </span>Sort</h4>

<p><code>_.sortBy(collection, [iteratee=_.identity], [thisArg])</code> sorts a collection in ascending order with results after applying iteratee function to each element in the collection. The sort is stable, which means it preserves original order for equal elements.</p>

<figure class="code">
  <figcaption>Listing 3.26: Sort a collection</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">sortBy</code><code class="p">([</code><code class="mi">3</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">]);</code>
<code class="c1">// -&gt; [1, 2, 3]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">sortBy</code><code class="p">([</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code> <code class="kd">function</code><code class="p">(</code><code class="nx">val</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nb">Math</code><code class="p">.</code><code class="nx">abs</code><code class="p">(</code><code class="nx">val</code><code class="p">);</code>
<code class="p">});</code>
<code class="c1">// -&gt; [1, 2, -3]</code>
</pre></div>

</figure>

<p>In v3, <code>_.sortByAll(collection, props)</code> is similar with <code>_.sort</code>, except <code>_.sortByAll</code> sorts collection by multiple property names. Multiple property names can be provided as sort conditions. If multiple elements in the collection have the same value for the first property name, those elements are sorted using second property name, and so on.</p>

<figure class="code">
  <figcaption>Listing 3.27: Sort a collection by multiple property names</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">users</code> <code class="o">=</code> <code class="p">[</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'David'</code><code class="p">,</code>
    <code class="nx">age</code><code class="o">:</code> <code class="mi">28</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">,</code>
    <code class="nx">age</code><code class="o">:</code> <code class="mi">30</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Bob'</code><code class="p">,</code>
    <code class="nx">age</code><code class="o">:</code> <code class="mi">28</code>
  <code class="p">}</code>
<code class="p">];</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">sortByAll</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">);</code>
<code class="c1">// -&gt; [{name: 'Alex', age: 30}, {name: 'Bob', age: 28}, {name: 'David', age: 28}]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">sortByAll</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="p">[</code><code class="s1">'age'</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">])</code>
<code class="c1">// -&gt; [{name: 'Bob', age: 30, {name: 'David', age: 28}, {name: 'Alex', age: 30}}]</code>
</pre></div>

</figure>

<p>In v4, functionality of original <code>_.sortByAll</code> in v3 is integrated into <code>_.sortBy</code> method, so <code>_.sortByAll</code> can be replaced with <code>_.sortBy</code> in v4.</p>

<p>In v3, <code>_.sortByOrder(collection, props, orders)</code> is similar with <code>_.sortByAll</code>, except that <code>_.sortByOrder</code> allows to specify the sort order for each sort condition, ascending or descending. The order is specified using the third argument, truthy value means ascending order and falsy value means descending order. For multiple property names, use an array with values for corresponding sort order.</p>

<figure class="code">
  <figcaption>Listing 3.28: Sort by multiple property names in different orders</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">sortByOrder</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">,</code> <code class="kc">false</code><code class="p">);</code>
<code class="c1">// -&gt; [{name: 'David', age: 28}, {name: 'Bob', age: 28}, {name: 'Alex', age: 30}]</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">sortByOrder</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="p">[</code><code class="s1">'age'</code><code class="p">,</code> <code class="s1">'name'</code><code class="p">],</code> <code class="p">[</code><code class="kc">true</code><code class="p">,</code> <code class="kc">true</code><code class="p">]);</code>
<code class="c1">// -&gt; [{name: 'Alex', age: 30}, {name: 'Bob', age: 28}, {name: 'David', age: 28}]</code>
</pre></div>

</figure>

<p>In v4, <code>_.sortByOrder</code> is renamed to <code>_.orderBy</code>.</p>

<h3 id="leanpub-auto-v4-flat-map">
<span class="section-number">3.16 </span><strong>[v4]</strong> Flat map</h3>

<p><code>_.flatMap(collection, [iteratee=_.identity])</code> invokes an iteratee function to each element in a collection. The result of each iteratee function invocation is an array. All result arrays are concatenated and flattened into a single array as the final result.</p>

<figure class="code">
  <figcaption>Listing 3.29: Example of <code>_.flatMap</code></figcaption>

<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">map</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">[</code><code class="nx">value</code> <code class="o">+</code> <code class="mi">1</code><code class="p">,</code> <code class="nx">value</code> <code class="o">-</code> <code class="mi">1</code><code class="p">];</code>
<code class="p">}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">flatMap</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code> <code class="nx">map</code><code class="p">);</code>
<code class="c1">// -&gt; [2, 0, 3, 1]</code>
</pre></div>

</figure>

<p><code>_.flatMapDeep(collection, [iteratee=_.identity])</code> is similar with <code>_.flatMap</code> except that <code>_.flatMapDeep</code> recursively flattens the result array until it’s completely flattened. <code>_.flatMapDepth(collection, [iteratee=_.identity], [depth=1])</code> is similar with <code>_.flatMapDeep</code> except that it only flattens the result given times. The default value of <code>depth</code> is <code>1</code>, so <code>_.flatMapDepth(array, iteratee)</code> is the same as <code>_.flatMap(array, iteratee)</code>.</p>


<h2 id="leanpub-auto-string-templates">
<span class="section-number">4. </span>String templates</h2>

<p>If you want to generate strings from a template, <code>_.template([string=''], [options])</code> is a simple yet powerful function to do that. It can be used by libraries and applications to avoid long string concatenations. Grunt uses <code>_.template</code> to allow using templates in <a href="http://gruntjs.com/api/grunt.template">configuration file</a>. It can also be used in applications to generate HTML markups, messages, emails and more.</p>

<figure class="code">
  <figcaption>Listing 10.1: Basic usage of string template</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">tpl</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">template</code><code class="p">(</code><code class="s1">'Hello, &lt;%= name %&gt;. Current time is &lt;%= new Date() %&gt;.'</code><code class="p">);</code>
<code class="nx">tpl</code><code class="p">({</code>
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code>
<code class="p">});</code>
<code class="c1">// -&gt; 'Hello, Alex. Current time is Sat Jun 27 2015 20:28:05 GMT+1200 (NZST).'</code>
</pre></div>

</figure>

<p>In Listing 10.1, the input argument of <code>_.template</code> method is the template itself. In the template, <code>&lt;%=</code> and <code>%&gt;</code> are the delimiters to wrap variables to be evaluated at runtime. <code>_.template</code> method returns a new function. After invoking the returned function with a context object contains actual values of template variables, it returns the actual generated string. If no value is assigned to a variable, an empty string will be used.</p>

<p><code>_.template</code> supports three types of delimiters, <em>interpolate</em>, <em>escape</em> and <em>evaluate</em>.</p>

<h3 id="leanpub-auto-interpolate">
<span class="section-number">4.1 </span>interpolate</h3>

<p><em>interpolate</em> delimiters allow to interpolate variables. The default regular expression pattern to declare interpolated variables is <code>/&lt;%=([\s\S]+?)%&gt;/g</code>. Simple variables and complex expressions can both be used. The regular expression pattern of <em>interpolate</em> delimiters can be customized by <code>interpolate</code> of options object.</p>

<figure class="code">
  <figcaption>Listing 10.2: Use interpolate delimiters</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">tpl</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">template</code><code class="p">(</code><code class="s1">'Hello, &lt;%= name %&gt;, the total amount is &lt;%= order.amount +\</code>
<code class="s1"> 10 %&gt;.'</code><code class="p">);</code>
<code class="nx">tpl</code><code class="p">({</code>
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">,</code>
  <code class="nx">order</code><code class="o">:</code> <code class="p">{</code>
    <code class="nx">amount</code><code class="o">:</code> <code class="mi">100</code>
  <code class="p">}</code>
<code class="p">});</code>
<code class="c1">// -&gt; 'Hello, Alex, the total amount is 110.'</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-escape">
<span class="section-number">4.2 </span>escape</h3>

<p>It’s common to use <code>_.template</code> to generate HTML markups. <em>escape</em> delimiters allow to interpolate variables and escape result value. The default regular expression pattern to declare escaped variables is <code>/&lt;%-([\s\S]+?)%&gt;/g</code>. The pattern can be customized by <code>escape</code> of options object.</p>

<figure class="code">
  <figcaption>Listing 10.3: Use escape delimiters</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">tpl</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">template</code><code class="p">(</code><code class="s1">'&lt;div&gt;&lt;%- markup %&gt;&lt;/div&gt;'</code><code class="p">);</code>
<code class="nx">tpl</code><code class="p">({</code>
  <code class="nx">markup</code><code class="o">:</code> <code class="s1">'&lt;span&gt;Hello&lt;/span&gt;'</code>
<code class="p">});</code>
<code class="c1">// -&gt; '&lt;div&gt;&amp;lt;span&amp;gt;Hello&amp;lt;/span&amp;gt;&lt;/div&gt;'</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-evaluate">
<span class="section-number">4.3 </span>evaluate</h3>

<p><em>evaluate</em> delimiters allow to execute JavaScript code. This kind of delimiters is useful when adding logic to templates, e.g. adding condition checks or loops to the template. The default regular expression pattern to declare JavaScript code is <code>/&lt;%([\s\S]+?)%&gt;/g</code>. The pattern can be customized by <code>evaluate</code> of options object.</p>

<figure class="code">
  <figcaption>Listing 10.4: Use evaluate delimiters</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">tpl</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">template</code><code class="p">(</code><code class="s1">'&lt;% if (a &gt; 0) { %&gt; Good! &lt;% } else { %&gt; Bad! &lt;% } %&gt;'</code><code class="p">);</code>
<code class="nx">tpl</code><code class="p">({</code>
  <code class="nx">a</code><code class="o">:</code> <code class="mi">1</code>
<code class="p">});</code>
<code class="c1">// -&gt; ' Good! '</code>
<code class="nx">tpl</code><code class="p">({</code>
  <code class="nx">a</code><code class="o">:</code> <code class="o">-</code><code class="mi">1</code>
<code class="p">});</code>
<code class="c1">// -&gt; ' Bad! '</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-imports">
<span class="section-number">4.4 </span>imports</h3>

<p>Besides from the context object passed to the function created by <code>_.template</code> method, a default object can also to passed to <code>_.template</code> as an additional source when evaluating variables. The object is specified using <code>imports</code> of options object.</p>

<figure class="code">
  <figcaption>Listing 10.5: Use extra imports</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">tpl</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">template</code><code class="p">(</code><code class="s1">'Hi, &lt;%= user %&gt;, you should pay &lt;%= amount * discount %&gt;.'</code><code class="p">,</code>
  <code class="p">{</code>
    <code class="nx">imports</code><code class="o">:</code> <code class="p">{</code>
      <code class="nx">discount</code><code class="o">:</code> <code class="mf">0.8</code>
  <code class="p">}</code>
<code class="p">});</code>
<code class="nx">tpl</code><code class="p">({</code>
  <code class="nx">user</code><code class="o">:</code> <code class="s1">'Alex'</code><code class="p">,</code>
  <code class="nx">amount</code><code class="o">:</code> <code class="mi">100</code>
<code class="p">});</code>
<code class="c1">// -&gt; 'Hi, Alex, you should pay 80.'</code>
<code class="nx">tpl</code><code class="p">({</code>
  <code class="nx">user</code><code class="o">:</code> <code class="s1">'Bob'</code><code class="p">,</code>
  <code class="nx">amount</code><code class="o">:</code> <code class="mi">100</code><code class="p">,</code>
  <code class="nx">discount</code><code class="o">:</code> <code class="mf">0.9</code>
<code class="p">});</code>
<code class="c1">// -&gt; 'Hi, Bob, you should pay 90.'</code>
</pre></div>

</figure>

<p>The default imports object contains only lodash object itself with key <code>_</code>, so lodash methods can be used directly in the expressions.</p>

<h3 id="leanpub-auto-data-object-name">
<span class="section-number">4.5 </span>Data object name</h3>

<p>By default, when evaluating variables in the template, the variables use the same name as in the context object. <code>variable</code> of <code>_.template</code>’s options object can be used to set a name to the context object, then variable names should be changed accordingly.</p>

<figure class="code">
  <figcaption>Listing 10.6: Use different variable object name</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">tpl</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">template</code><code class="p">(</code><code class="s1">'Hello, &lt;%= user.name %&gt;.'</code><code class="p">,</code> <code class="p">{</code>
  <code class="nx">variable</code><code class="o">:</code> <code class="s1">'user'</code>
<code class="p">});</code>
<code class="nx">tpl</code><code class="p">({</code>
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'Alex'</code>
<code class="p">});</code>
<code class="c1">// -&gt; 'Hello, Alex.'</code>
</pre></div>

</figure>

<p>In Listing 10.6, the context object’s name is set to <code>user</code>, so <code>user.name</code> accesses <code>name</code> property of the argument object.</p>


<h2 id="leanpub-auto-recipes">
<span class="section-number">5. </span>Recipes</h2>

<h3 id="leanpub-auto-v3-filter-an-objects-properties">
<span class="section-number">5.1 </span><strong>[v3]</strong> Filter an object’s properties</h3>

<h4 id="leanpub-auto-scenario">
<span class="section-number">5.1.1 </span>Scenario</h4>

<p>Filter a given object by removing certain properties.</p>

<h4 id="leanpub-auto-solution">
<span class="section-number">5.1.2 </span>Solution</h4>

<p>Although <code>_.filter</code> and <code>_.reject</code> can be applied to objects, they cannot be used for this scenario, because <code>_.filter</code> and <code>_.reject</code> return an array of property values after filtering. <code>_.pick</code> and <code>_.omit</code> should be used instead.</p>

<figure class="code">
  <figcaption>Listing 11.1: Filter a given object by removing certain properties</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">fruits</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">apple</code><code class="o">:</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Apple'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">2.99</code>
  <code class="p">},</code>
  <code class="nx">orange</code><code class="o">:</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Orange'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">1.99</code>
  <code class="p">},</code>
  <code class="nx">banana</code><code class="o">:</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Banana'</code><code class="p">,</code>
    <code class="nx">price</code><code class="o">:</code> <code class="mf">0.5</code>
  <code class="p">}</code>
<code class="p">};</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">pick</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">fruit</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">fruit</code><code class="p">.</code><code class="nx">price</code> <code class="o">&gt;</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; { apple: { name: 'Apple', price: 2.99 } }</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">pick</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">fruit</code><code class="p">,</code> <code class="nx">key</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">key</code> <code class="o">!=</code> <code class="s1">'apple'</code><code class="p">;</code>
<code class="p">});</code>
<code class="c1">// -&gt; { orange: { name: 'Orange', price: 1.99 }, banana: { name: 'Banana', price\</code>
<code class="o">:</code> <code class="mf">0.5</code> <code class="p">}</code> <code class="p">}</code>

<code class="nx">_</code><code class="p">.</code><code class="nx">pick</code><code class="p">(</code><code class="nx">fruits</code><code class="p">,</code> <code class="s1">'apple'</code><code class="p">);</code>
<code class="c1">// -&gt; { apple: { name: 'Apple', price: 2.99 } }</code>
</pre></div>

</figure>

<p>When a predicate function is passed to <code>_.pick</code> or <code>_.omit</code>, it’s invoked with three arguments: property value, property name and the object itself.</p>

<h3 id="leanpub-auto-v3-push-an-array-of-elements-into-an-array">
<span class="section-number">5.2 </span><strong>[v3]</strong> Push an array of elements into an array</h3>

<h4 id="leanpub-auto-scenario-1">
<span class="section-number">5.2.1 </span>Scenario</h4>

<p>Given an array of elements, push those elements into another array.</p>

<h4 id="leanpub-auto-solution-1">
<span class="section-number">5.2.2 </span>Solution</h4>

<p>If using <code>Array</code>’s <code>push</code> method, the whole array will be pushed as a single element.</p>

<figure class="code">
  <figcaption>Listing 11.2: Use <code>Array</code>’s <code>push</code> method</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">];</code>
<code class="nx">array</code><code class="p">.</code><code class="nx">push</code><code class="p">([</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">array</code><code class="p">);</code>
<code class="c1">// -&gt; [1, 2, 3, [4, 5, 6]]</code>
</pre></div>

</figure>

<p>The first solution is to use <code>_.spread</code> to wrap <code>push</code> method to accept arrays as arguments.</p>

<figure class="code">
  <figcaption>Listing 11.3: Use <code>_.spread</code> to wrap <code>push</code> method</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">];</code>
<code class="kd">var</code> <code class="nx">push</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">bind</code><code class="p">(</code><code class="nx">_</code><code class="p">.</code><code class="nx">spread</code><code class="p">(</code><code class="nb">Array</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">push</code><code class="p">),</code> <code class="nx">array</code><code class="p">);</code>
<code class="nx">push</code><code class="p">([</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">array</code><code class="p">);</code>
<code class="c1">// -&gt; [1, 2, 3, 4, 5, 6]</code>
</pre></div>

</figure>

<p>The second solution is to push the array first, then use <code>_.flatten</code> to flatten the array.</p>

<figure class="code">
  <figcaption>Listing 11.4: Use <code>_.flatten</code> to flatten the array</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">];</code>
<code class="nx">array</code><code class="p">.</code><code class="nx">push</code><code class="p">([</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]);</code>
<code class="nx">_</code><code class="p">.</code><code class="nx">flatten</code><code class="p">(</code><code class="nx">array</code><code class="p">);</code>
<code class="c1">// -&gt; [1, 2, 3, 4, 5, 6]</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-v3-process-data-for-c3js-pie-chart">
<span class="section-number">5.3 </span><strong>[v3]</strong> Process data for C3.js pie chart</h3>

<h4 id="leanpub-auto-scenario-2">
<span class="section-number">5.3.1 </span>Scenario</h4>

<p><a href="http://c3js.org/">C3.js</a> is a popular chart library based on <a href="http://d3js.org/">d3.js</a>. C3.js can create <a href="http://c3js.org/samples/chart_pie.html">pie chart</a> based on data input. But when there are many items in the data set, the pie chart itself becomes very hard to read.</p>

<p>Listing 11.5 is the basic code to create a pie chart with <code>100</code> items.</p>

<figure class="code">
  <figcaption>Listing 11.5: Basic code of create a pie chart</figcaption>

<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">generateData</code><code class="p">(</code><code class="nx">num</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">data</code> <code class="o">=</code> <code class="p">[];</code>
    <code class="k">for</code> <code class="p">(</code><code class="kd">var</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">num</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">data</code><code class="p">.</code><code class="nx">push</code><code class="p">([</code><code class="s1">'data'</code> <code class="o">+</code> <code class="nx">i</code><code class="p">,</code> <code class="p">(</code><code class="nx">i</code> <code class="o">&lt;=</code> <code class="mi">20</code> <code class="o">?</code> <code class="mi">1000</code> <code class="o">:</code> <code class="mi">0</code><code class="p">)</code> <code class="o">+</code>  <code class="nb">Math</code><code class="p">.</code><code class="nx">random</code><code class="p">()</code> <code class="o">*</code> <code class="mi">10</code><code class="p">]);</code>
    <code class="p">}</code>
    <code class="k">return</code> <code class="nx">data</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">chart</code> <code class="o">=</code> <code class="nx">c3</code><code class="p">.</code><code class="nx">generate</code><code class="p">({</code>
    <code class="nx">bindto</code><code class="o">:</code> <code class="s1">'#chart'</code><code class="p">,</code>
    <code class="nx">data</code><code class="o">:</code> <code class="p">{</code>
      <code class="nx">columns</code><code class="o">:</code> <code class="nx">generateData</code><code class="p">(</code><code class="mi">100</code><code class="p">),</code>
      <code class="nx">type</code><code class="o">:</code> <code class="s1">'pie'</code>
    <code class="p">}</code>
<code class="p">});</code>
</pre></div>

</figure>

<p>Below is how this chart looks like.</p>


<figure class="image center">
  <img src="/site_images/lodashcookbook/original_pie_chart.png" alt="Unreadable pie chart with 100 items">
  <figcaption>Unreadable pie chart with 100 items</figcaption>
</figure>


<h4 id="leanpub-auto-solution-2">
<span class="section-number">5.3.2 </span>Solution</h4>

<p>One solution is to process the data set first by limiting the number of items. For example, we can only get top <code>20</code> items from the data set and all the rest items are summed into a new item called <code>Others</code>. By doing this, the created chart will be more readable.</p>

<p>In Listing 11.6, use <code>_.sortByOrder</code> to sort the <code>data</code> array first based on the second element of the item array. Items in the <code>data</code> array are all arrays, <code>[1]</code> can be used to access the second element in the item array. After the <code>data</code> array is sorted, use <code>_.take</code> to find the top <code>20</code> items in the sorted array, then use <code>_.last</code> to find the last one. This last item is used as the threshold to partition the <code>data</code> array. Then use <code>partition</code> to divide the <code>data</code> array into two groups. The first group <code>groups[0]</code> contains items we want to keep, the second group <code>groups[1]</code> contains items we want to merge. For the second group, use <code>_.sum</code> to calculate the sum of all the items to merge. The merged item is pushed to the result data array with name <code>Others</code> and sum.</p>

<figure class="code">
  <figcaption>Listing 11.6: Use lodash to process data</figcaption>

<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">processData</code><code class="p">(</code><code class="nx">data</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">threshold</code> <code class="o">=</code> <code class="nx">_</code><code class="p">(</code><code class="nx">data</code><code class="p">).</code><code class="nx">sortByOrder</code><code class="p">(</code><code class="s1">'[1]'</code><code class="p">,</code> <code class="kc">false</code><code class="p">).</code><code class="nx">take</code><code class="p">(</code><code class="mi">20</code><code class="p">).</code><code class="nx">last</code><code class="p">();</code>
    <code class="k">if</code> <code class="p">(</code><code class="nx">threshold</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">groups</code> <code class="o">=</code> <code class="nx">_</code><code class="p">.</code><code class="nx">partition</code><code class="p">(</code><code class="nx">data</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">item</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">return</code> <code class="nx">item</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code> <code class="o">&gt;=</code> <code class="nx">threshold</code><code class="p">[</code><code class="mi">1</code><code class="p">];</code>
        <code class="p">});</code>
        <code class="k">if</code> <code class="p">(</code><code class="nx">_</code><code class="p">.</code><code class="nx">size</code><code class="p">(</code><code class="nx">groups</code><code class="p">[</code><code class="mi">1</code><code class="p">])</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">groups</code><code class="p">[</code><code class="mi">0</code><code class="p">].</code><code class="nx">push</code><code class="p">([</code><code class="s1">'Others'</code><code class="p">,</code> <code class="nx">_</code><code class="p">.</code><code class="nx">sum</code><code class="p">(</code><code class="nx">groups</code><code class="p">[</code><code class="mi">1</code><code class="p">],</code> <code class="s1">'[1]'</code><code class="p">)]);</code>
        <code class="p">}</code>
        <code class="k">return</code> <code class="nx">groups</code><code class="p">[</code><code class="mi">0</code><code class="p">];</code>
    <code class="p">}</code>
    <code class="k">return</code> <code class="nx">data</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>After using Listing 11.6 code to process the data first, the chart is much easier to read, see below.</p>


<figure class="image center">
  <img src="/site_images/lodashcookbook/merged_pie_chart.png" alt="Pie chart with items merged">
  <figcaption>Pie chart with items merged</figcaption>
</figure>


<h3 id="leanpub-auto-v3-create-a-unique-array-of-objects">
<span class="section-number">5.4 </span><strong>[v3]</strong> Create a unique array of objects</h3>

<h4 id="leanpub-auto-scenario-3">
<span class="section-number">5.4.1 </span>Scenario</h4>

<p>Given an array of objects in Listing 11.7, remove duplicate values from the array.</p>

<figure class="code">
  <figcaption>Listing 11.7: An array of objects with duplicate values</figcaption>

<div class="highlight"><pre><code></code><code class="p">[</code>
  <code class="p">{</code>
    <code class="s2">"name"</code><code class="o">:</code> <code class="s2">"Alex"</code><code class="p">,</code>
    <code class="s2">"age"</code><code class="o">:</code> <code class="mi">30</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="s2">"name"</code><code class="o">:</code> <code class="s2">"Bob"</code><code class="p">,</code>
    <code class="s2">"age"</code><code class="o">:</code> <code class="mi">28</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="s2">"name"</code><code class="o">:</code> <code class="s2">"Alex"</code><code class="p">,</code>
    <code class="s2">"age"</code><code class="o">:</code> <code class="mi">30</code>
  <code class="p">}</code>
<code class="p">]</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-solution-3">
<span class="section-number">5.4.2 </span>Solution</h4>

<p><code>_.uniq</code> function can be used to remove duplicate values from an array, but it only uses <em>SameAsZero</em> algorithm to compare values. To perform the deep comparison for elements in the array of Listing 11.7, we need to convert each element into a single value. For example, if <code>name</code> property is the unique key for each element, use <code>_.uniq(array, 'name')</code>. If there is no unique key, you can convert the element into a JSON string.</p>

<figure class="code">
  <figcaption>Listing 11.8: Compare array elements as JSON strings</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">uniq</code><code class="p">(</code><code class="nx">array</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">element</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">element</code><code class="p">);</code>
<code class="p">});</code>
</pre></div>

</figure>

<p>JSON serialization may generate different results for objects with the same value due to undermined property enumeration order. For a more consistent result, create your own object serialization format. Listing 11.9 concatenates <code>name</code> and <code>age</code> properties as the serialization format to determine uniqueness.</p>

<figure class="code">
  <figcaption>Listing 11.9: Compare array elements using custom serialization format</figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">uniq</code><code class="p">(</code><code class="nx">array</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">element</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">element</code><code class="p">.</code><code class="nx">name</code> <code class="o">+</code> <code class="nx">element</code><code class="p">.</code><code class="nx">age</code><code class="p">;</code>
<code class="p">});</code>
</pre></div>

</figure>

<h3 id="leanpub-auto-convert-an-array-to-an-object">
<span class="section-number">5.5 </span>Convert an array to an object</h3>

<h4 id="leanpub-auto-scenario-4">
<span class="section-number">5.5.1 </span>Scenario</h4>

<p>Given an array of objects with IDs, convert the array to an object with IDs as the keys and array elements as the values.</p>

<p>For example, given an array in Listing 11.10, convert it to an object shown in Listing 11.11.</p>

<figure class="code">
  <figcaption>List 11.10: An array of objects with IDs</figcaption>

<div class="highlight"><pre><code></code><code class="p">[</code>
  <code class="p">{</code>
    <code class="s2">"id"</code><code class="o">:</code> <code class="s2">"user001"</code><code class="p">,</code>
    <code class="s2">"name"</code><code class="o">:</code> <code class="s2">"Alex"</code>
  <code class="p">},</code>
  <code class="p">{</code>
    <code class="s2">"id"</code><code class="o">:</code> <code class="s2">"user002"</code><code class="p">,</code>
    <code class="s2">"name"</code><code class="o">:</code> <code class="s2">"Bob"</code>
  <code class="p">}</code>
<code class="p">]</code>
</pre></div>

</figure>

<figure class="code">
  <figcaption>List 11.11: Conversion result of Listing 11.10</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
  <code class="s2">"user001"</code><code class="o">:</code> <code class="p">{</code>
    <code class="s2">"id"</code><code class="o">:</code> <code class="s2">"user001"</code><code class="p">,</code>
    <code class="s2">"name"</code><code class="o">:</code> <code class="s2">"Alex"</code>
  <code class="p">},</code>
  <code class="s2">"user002"</code><code class="o">:</code> <code class="p">{</code>
    <code class="s2">"id"</code><code class="o">:</code> <code class="s2">"user002"</code><code class="p">,</code>
    <code class="s2">"name"</code><code class="o">:</code> <code class="s2">"Bob"</code>
  <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-solution-4">
<span class="section-number">5.5.2 </span>Solution</h4>

<p>One solution is to use <code>_.each</code> to iterate the array and set each property in the result object, see Listing 11.12.</p>

<figure class="code">
  <figcaption>List 11.12: Solution to use <code>_.each</code></figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">result</code> <code class="o">=</code> <code class="p">{};</code>
<code class="nx">_</code><code class="p">.</code><code class="nx">each</code><code class="p">(</code><code class="nx">array</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">obj</code><code class="p">)</code> <code class="p">{</code>
  <code class="nx">result</code><code class="p">[</code><code class="nx">obj</code><code class="p">.</code><code class="nx">id</code><code class="p">]</code> <code class="o">=</code> <code class="nx">obj</code><code class="p">;</code>
<code class="p">});</code>
</pre></div>

</figure>

<p>A better solution is to use <code>_.reduce</code>, see Listing 11.13.</p>

<figure class="code">
  <figcaption>List 11.13: Solution to use <code>_.reduce</code></figcaption>

<div class="highlight"><pre><code></code><code class="nx">_</code><code class="p">.</code><code class="nx">reduce</code><code class="p">(</code><code class="nx">array</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">result</code><code class="p">,</code> <code class="nx">obj</code><code class="p">)</code> <code class="p">{</code>
  <code class="nx">result</code><code class="p">[</code><code class="nx">obj</code><code class="p">.</code><code class="nx">id</code><code class="p">]</code> <code class="o">=</code> <code class="nx">obj</code><code class="p">;</code>
  <code class="k">return</code> <code class="nx">result</code><code class="p">;</code>
<code class="p">},</code> <code class="p">{});</code>
</pre></div>

</figure>

</body></html>
