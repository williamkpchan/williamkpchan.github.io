
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
body { margin: 10%; font-size: 24px; background-color: #000000; color: #109030;}
a { text-decoration: none; color: #28B8B8;}
  A:hover { color: yellow }
  A:focus { color: red }
 #newtype { color: pink}
 #redword { color: red}
 #yellowword { color: yellow}
 #greenword { color: green}
 #orangeword { color: orange}
 #whiteword { color: white}
 #grayword { color: gray}
 .highlight { 
    color: gray;
    background-color: #101A08
  }
 #brownword { color: #ff8000}
}
</STYLE>
</head>
<body>


<a name=top></a>

<p align="center"><b>
PHP/MySQL Tutorial<br>
Part 1 - Introduction</b></p>

<a name=1></a>
<ul>
<li><b>Part 1 - Introduction</b></li>
<li><a href="#2">Part 2 - Setting Up The Database</a></li>
<li><a href="#3">Part 3 - Inserting Information</a></li>
<li><a href="#4">Part 4 - Displaying Data</a></li>
<li><a href="#5">Part 5 - More Outputs</a></li>
<li><a href="#6">Part 6 - Single Records & Error Trapping</a></li>
<li><a href="#7">Part 7 - Updating & Deleting</a></li>
<li><a href="#8">Part 8 - Finishing The Script</a></li></ul>

<p>
<big><b>Introduction</b></big><br />
<br />
For many people, the main reson for learning a scripting language like PHP is because of the interaction with databases it can offer. In this tutorial I will show you how to use PHP and the MySQL database to store information on the web and include it into your website. Before you read this tutorial you should have at least a basic knowledge of how to use PHP. If you do not yet know PHP, I suggest that you read our PHP tutorial before continuing.<br />
<br />
<big><b>Why Would I Want A Database?</b></big><br />
<br />
It is actually surprising how useful a database can be when used with a website. There are a huge variety of things you can do when you interact the two, from displaying simple lists to running a complete website from a database. Some examples of PHP and MySQL being used together are:<br />
<ul>
<li>Banner Rotation. On this site, where each banner is, a PHP script is called. This opens a database and picks a random banner from it to show the visitor. It also counts the number of times the banner has been viewed and could, with a few changes, track clicks too. To add, change or edit the banners all I have to do is change the database and the script will pick the correct banners for all the pages on the site.</li>
<li>Forums. Hundreds of forums (message boards) on the internet are run using PHP and MySQL. These are much more efficent than other systems that create a page for each message and offer a wide variety of options. All the pages in the forum can be updated by changing one script.</li>
<li>Databases. One quite obvious example is sites which get all there information from a database. For example Script Avenue is run by a few scripts, which gain all their information from a large database. All the different script categories can be accessed in one script by just changing the URL to access a different part of the database.</li>
<li>Websites. If you have a large website and you want to change the design it can take a very long time to update and upload all the pages. With PHP and MySQL your whole website could be just one or two PHP scripts. These would access a MySQL database to get the information for the pages. To update the website&#039;s design you would just have to change one page.</li></ul><br />
<big><b>What Do I Need?</b></big><br />
<br />
You only really need three things to run PHP scripts which access MySQL databases. <br /><br />
Firstly, you will, of course, need a webserver. This can either be on a computer of your own or on a web host. Any web server software should work with PHP and MySQL but the best to use is Apache, which is free.<br />
<br />
PHP also needs to be installed on the server. If it is not already installed you can install it (or ask your web host to install it). It can be downloaded from PHP.net and is also free. If you are not sure if you have PHP installed I will show you a way to check it later.<br />
<br />
Finally, you will also require MySQL. This is the actual database software. You can also use most other types of database (SQL, Oracle etc.) but as this is a PHP/MySQL tutorial I will deal just now with the MySQL database (although the commands used here will also work with SQL databases). As with the other software you need, MySQL is free and can be downloaded from the MySQL homepage. If you are not sure if you have MySQL installed, I will show you how to check later.<br />
<br />
If you cannot install (or your web host won&#039;t allow) PHP and MySQL you can still use another web host. Freedom2Surf are a free (banner supported) web host and support PHP and have MySQL installed. HostRocket are an excellent web host and can offer you 300MB of space with PHP, MySQL and loads of other extras for under $10 a month.<br />
<br />
<big><b>Testing For PHP and MySQL</b></big><br />
<br />
There is a simple test for both PHP and MySQL. Open a text editor and type in the following:<br />
<font color="#0088AA"><br />
&lt;?<br />
phpinfo();<br />
?&gt;<br />
<br />
and save it as phpinfo.php<br />
<br />
Now upload this to your webspace and go to it in your browser. If you have PHP installed you will see a huge page with all the details of your PHP installation on it. Next, scroll down through all this information. If you find a section about MySQL then you will know that MySQL is installed.<br />
<br />
<big><b>Managing Databases</b></big><br />
<br />
Although all the database administrative options can be done through PHP scripts, I strongly suggest installing a copy of PHPMyAdmin on your server. It is an excellent free set of scripts that will provide you with an administrative interface for your MySQL database(s). You can add, remove, edit, backup and view your databases using this and it is especially useful when troubleshooting your databases.<br />

<a href=https://www.phpmyadmin.net/downloads/>PHPMyAdmin</a>

<br />
<big><b>This Tutorial</b></big><br />
<br />
Throughout this tutorial I will be showing you some of the basics of using PHP and MySQL together. To do this I will be using an example all the way through. As you use this tutorial, you will learn how to create a web based contact management program. It will allow you to store names with their addresses, e-mail and phone numbers. You will be able to update records and search the database. There will even be an option which allows you to send an e-mail out to all the people in the database (please note: this system should not be used for spam or unsolicited e-mail).<br />
<br />
After creating this system you should have enough knowledge to go on and create nearly any type of database enabled site you want to.<br />
<br />

<a name=2></a>
<a href="#top">Top</a><br>
Part 2 - Setting Up The Database
<br>
<p>
<big><b>Introduction</b></big><br />
<br />
Before you actually start building your database scripts, you must have a database to place information into and read it from. In this section I will show you how to create a database in MySQL and prepare it for the data. I will also begin to show you how to create the contacts management database.<br />
<br />
<big><b>Database Construction</b></big><br />
<br />
MySQL databases have a standard setup. They are made up of a database, in which is contained tables. Each of these tables is quite separate and can have different fields etc. even though it is part of one database. Each table contains records which are made up of fields.<br />
<br />
<big><b>Databases And Logins</b></big><br />
<br />
The process of setting up a MySQL database varies from host to host, you will however end up with a database name, a user name and a password. This information will be required to log in to the database.<br />
<br />
If you have PHPMyAdmin (or a similar program) installed you can just go to it to log in with your user name and password. If not you must do all your database administration using PHP scripts.<br />
<br />
<big><b>Creating A Table</b></big><br />
<br />
Before you can do anything with your database, you must create a table. A table is a section of the database for storing related information. In a table you will set up the different fields which will be used in that table. Because of this construction, nearly all of a site&#039;s database needs can be satisfied using just one database.<br />
<br />
Creating a table in PHPMyAdmin is simple, just type the name, select the number of fields and click the button. You will then be taken to a setup screen where you must create the fields for the database. If you are using a PHP script to create your database, the whole creation and setup will be done in one command.<br />
<br />
<big><b>Fields</b></big><br />
<br />
There are a wide variety of fields and attributes available in MySQL and I will cover a few of these here:<br />
<table border="0"><tr><td><b>Field Type</b></td><td><b>Description</b></td></tr><tr><td>TINYINT</td><td>Small Integer Number </td></tr><tr><td>SMALLINT</td><td>Small Integer Number </td></tr><tr><td>MEDIUMINT</td><td>Integer Number </td></tr><tr><td>INT</td><td>Integer Number </td></tr><tr><td>VARCHAR</td><td>Text (maximum 256 characters) </td></tr><tr><td>TEXT</td><td>Text </td></tr></table><br />
<br />
These are just a few of the fields which are available. A search on the internet will provide lists of all the field types allowed.<br />
<br />
<big><b>Creating A Table With PHP</b></big><br />
<br />
To create a table in PHP is slightly more difficult than with MySQL. It takes the following format:<br />
<font color="#0088AA"><br />
CREATE TABLE tablename {<br />
<br />
Fields<br />
<br />
}<br />
<br />
The fields are defined as follows:<br />
<font color="#0088AA"><br />
fieldname type(length) extra info,<br />
<br />
The final field entered should not have a comma after it.<br />
<br />
I will give full an example of using these later in the section.<br />
<br />
<big><b>The Contacts Database</b></big><br />
<br />
The contacts database will contain all the conact information for the people you enter and the information will be able to be edited and viewed on the internet. The following fields will be used in the database:<br />
<br />
<table width="100%" border="0" cellspacing="2" cellpadding="2">  <tr> <th><div align="left"><b><font face="Arial, Helvetica, sans-serif">Name</b></div></th><th> <div align="left"><b><font face="Arial, Helvetica, sans-serif">Type</b></div></th><th> <div align="left"><b><font face="Arial, Helvetica, sans-se<br />
rif">Length</b></div></th><th> <div align="left"><b><font face="Arial, Helvetica, sans-serif">Description</b></div></th></tr><tr> <td><font face="Arial, Helvetica, sans-serif">id</td><td><font face="Arial, Helvetica, sans-serif">INT</td><td><font face="Arial, Helvetica, sans-serif">6</td><td><font face="Arial, Helvetica, sans-serif">A unique identifier for each record</td></tr><tr> <td><font face="Arial, Helvetica, sans-serif">first</td><td><font face="Arial, Helvetica, sans-serif">VARCHAR</td><td><font face="Arial, Helvetica, sans-serif">15</td><td><font face="Arial, Helvetica, sans-serif">The person&#039;s first name</td></tr><tr> <td><font face="Arial, Helvetica, sans-serif">last</td><td><font face="Arial, Helvetica, sans-serif">VARCHAR</td><td><font face="Arial, Helvetica, sans-serif">15</td><td><font face="Arial, Helvetica, sans-serif">The person&#039;s last name</td></tr><tr> <td><font face="Arial, Helvetica, sans-serif">phone</td><td><font face="Arial, Helvetica, sans-serif">VARCHAR</td><td><font face="Arial, Helvetica, sans-serif">20</td><td><font face="Arial, Helvetica, sans-serif">The person&#039;s phone number</td></tr><tr> <td><font face="Arial, Helvetica, sans-serif">mobile</td><td><font face="Arial, Helvetica, sans-serif">VARCHAR</td><td><font face="Arial, Helvetica, sans-serif">20</td><td><font face="Arial, Helvetica, sans-serif">The person&#039;s mobile number</td></tr><tr> <td><font face="Arial, Helvetica, sans-serif">fax</td><td><font face="Arial, Helvetica, sans-serif">VARCHAR</td><td><font face="Arial, Helvetica, sans-serif">20</td><td><font face="Arial, Helvetica, sans-serif">The person&#039;s fax number</td></tr><tr> <td><font face="Arial, Helvetica, sans-serif">email</td><td><font face="Arial, Helvetica, sans-serif">VARCHAR</td><td><font face="Arial, Helvetica, sans-serif">30</td><td><font face="Arial, Helvetica, sans-serif">The person&#039;s e-mail address</td></tr><tr> <td><font face="Arial, Helvetica, sans-serif">web</td><td><font face="Arial, Helvetica, sans-serif">VARCHAR</td><td><font face="Arial, Helvetica, sans-serif">30</td><td><font face="Arial, Helvetica, sans-serif">The person&#039;s web address</td></tr></table><br />
<br />
You may be wondering why I have used VARCHAR fields for the phone/fax numbers even though they are made up of digits. You could use INT fields but I prefer to use VARCHAR as it will allow dashes and spaces in the number, as well as textual numbers (like 1800-COMPANY) and as we will not be initiating phone calls from the web it is not a problem.<br />
<br />
There is one other thing you should be aware of in this database. The id field will also be set as PRIMARY, INDEX, UNIQUE and will be set to auto_increment (found under Extra in PH<br />
PMyAdmin). The reason for this is that this will be the field identifier (primary and index) and so must be unique. The auto increment setting means that whenever you add a record, as long as you don&#039;t specify an id, it will be given the next number.<br />
<br />
If you are using PHPMyAdmin or a management program you can now create this in a table called contacts.<br />
<br />
<big><b>Creating The Table In PHP</b></big><br />
<br />
The following code should be used to create this table in PHP. Some of the code has not been covered yet but I will explain it fully in the next part.<br />
<font color="#0088AA"><br />
&lt;?<br />
$user=&quot;username&quot;;<br />
$password=&quot;password&quot;;<br />
$database=&quot;database&quot;;<br />
mysql_connect(localhost,$user,$password);<br />
@mysql_select_db($database) or die( &quot;Unable to select database&quot;);<br />
$query=&quot;CREATE TABLE contacts (id int(6) NOT NULL auto_increment,first varchar(15) NOT NULL,last varchar(15) NOT NULL,phone varchar(20) NOT NULL,mobile varchar(20) NOT NULL,fax varchar(20) NOT NULL,email varchar(30) NOT NULL,web varchar(30) NOT NULL,PRIMARY KEY (id),UNIQUE id (id),KEY id_2 (id))&quot;;<br />
mysql_query($query);<br />
mysql_close();<br />
?&gt;<br />
<br />
Enter your database, MySQL username and MySQL password in the appropriate positions on the first three lines above.<br />
<br />

<a name=3></a>
<a href="#top">Top</a><br>
Part 3 - Inserting Information<br>
<p>
<big><b>Introduction</b></big><br />
<br />
Over the past two parts I have explained what I am planning to do in this tutorial and have shown you how to create a database to use with the tutorial. In this part I will be showing you how to insert some information into your database so that it is more useful.<br />
<br />
<big><b>Connecting To The Database</b></big><br />
<br />
The first thing you must do before you can do any work at all is to connect to the MySQL database. This is an extremely important step as, if you are not connected, your commands to the database will fail.<br />
<br />
Good practice for using databases is to specify the username, password and database name first so that if you change any of them at a later date you will only have to change one line:<br />
<font color="#0088AA"><br />
$username=&quot;username&quot;;<br />
$password=&quot;password&quot;;<br />
$database=&quot;your_database&quot;;<br />
<br />
At this point you may be wondering if it is a security risk, keeping your password in the file. You don&#039;t need to worry, though, because the PHP scource code is processed aby the server before being sent to the browser so it is impossible for the user to see the script&#039;s source.<br />
<br />
Next, you will need to issue the command to start a database connection:<br />
<font color="#0088AA"><br />
mysql_connect(localhost,$username,$password);<br />
<br />
This line tells PHP to connect to the MySQL database server at &#039;localhost&#039; (localhost means the server that the site is running one. Unless you web host tells you otherwise you should use localhost. If you are given a server address (such as sql.myserver.com you should replace localhost with &quot;sql.myserver.com&quot; (including the quotes)) using the username stored in $username and the password in $password.<br />
<br />
Before I show you how to work with the database, I will show you one more command:<br />
<font color="#0088AA"><br />
mysql_close();<br />
<br />
This is a very important command as it closes the connection to the database server. Your script will still run if you do not include this command but too many open MySQL connections can cause problems for a web host. It is good practice to always include this line once you have issued all your commands to the database, to keep the server running well.<br />
<br />
<big><b>Selecting The Database</b></big><br />
<br />
After you have connected to the database server you must then select the database you wish to use. This must be a database to which your username has access. The following command:<br />
<font color="#0088AA"><br />
@mysql_select_db($database) or die( &quot;Unable to select database&quot;);<br />
<br />
is used to do this. This tells PHP to select the database stored in the variable $database (which you set earlier). If it cannot connect it will stop executing the script and output the text:<br />
<font color="#0088AA"><br />
Unable to select database<br />
<br />
This extra &#039;or die&#039; part is good to leave in as it provides a little error control but it is not essential.<br />
<br />
<big><b>Executing Commands</b></big><br />
<br />
Now you have connected to the server and selected the database you want to work with you can begin executing commands on the server.<br />
<br />
There are two ways of executing a command. One is to just enter the command in PHP. This way is used if there will be no results from the operation.<br />
<br />
The other way is to define the command as a variable. This will set the variable with the results of the operation.<br />
<br />
In this part of the tutorial we will use the first way as we are not expecting a response from the database. The command will look like this:<br />
<font color="#0088AA"><br />
mysql_query($query);<br />
<br />
The useful thing about using this form of the command is that you can just repeat the same command over and over again without learning new ones. All you need to do is to change the variable.<br />
<br />
<big><b>Inserting Data</b></big><br />
<br />
For this part of the tutorial I will return to the contacts database which we created in the last part. We will now add our first information to the database:<br />
<br />
First: John<br />
Last: Smith<br />
Phone: 01234 567890<br />
Mobile: 00112 334455<br />
Fax: 01234 567891<br />
E-<br />
mail: johnsmith@gowansnet.com<br />
Web: http://www.gowansnet.com<br />
<br />
This will all be put in with one command:<br />
<font color="#0088AA"><br />
$query = &quot;INSERT INTO contacts VALUES (&#039;&#039;,&#039;John&#039;,&#039;Smith&#039;,&#039;01234 567890&#039;,&#039;00112 334455&#039;,&#039;01234 567891&#039;,&#039;johnsmith@gowansnet.com&#039;,&#039;http://www.gowansnet.com&#039;)&quot;;<br />
<br />
This may look a little confusing at first so I will explain what it all means.<br />
<br />
Firstly $query= is there because we are assigning this to the variable $query (see the section above). The next part:<br />
<font color="#0088AA"><br />
INSERT INTO contacts VALUES<br />
<br />
is quite easy to understand. It tells the PHP to insert into the table called contacts the values in the brackets which follow.<br />
<br />
The part in the brackets contains all the information to add. It uses all the fields in order and inserts the information from between the quotes. For example:<br />
<font color="#0088AA"><br />
John<br />
<br />
will be inserted into the 2nd field which, in this table, is the &#039;first&#039; field.<br />
<br />
You may have noticed that you are not inserting any value into the first field in the database (id). This is because this field is going to act as an index field. No two records in the database will have the same ID. Because of this, when we set up the database we set ID to &#039;Auto Increment&#039;. This means that if you assign it no value it will take the next number in the series. This means that this first record will have the ID 1.<br />
<br />

<a name=4></a>
<a href="#top">Top</a><br>
Part 4 - Displaying Data<br>
<p>
<big><b>Introduction</b></big><br />
<br />
So far in this tutorial, you have created a database and put information into it. In this part I will show you how to create an input page for your database, and how to display the whole contents.<br />
<br />
<big><b>HTML Input</b></big><br />
<br />
Inputing the data using HTML pages is almost identical to inserting it using a PHP script. The benefit, though, is that you do not need to change the script for each piece of data you want to input and you can also allow your users to input their own data.<br />
<br />
The following code will show an HTML page with textboxes to enter the appropriate details:<br />
<font color="#0088AA"><br />
&lt;form action=&quot;insert.php&quot; method=&quot;post&quot;&gt;<br />
First Name: &lt;input type=&quot;text&quot; name=&quot;first&quot;&gt;&lt;br&gt;<br />
Last Name: &lt;input type=&quot;text&quot; name=&quot;last&quot;&gt;&lt;br&gt;<br />
Phone: &lt;input type=&quot;text&quot; name=&quot;phone&quot;&gt;&lt;br&gt;<br />
Mobile: &lt;input type=&quot;text&quot; name=&quot;mobile&quot;&gt;&lt;br&gt;<br />
Fax: &lt;input type=&quot;text&quot; name=&quot;fax&quot;&gt;&lt;br&gt;<br />
E-mail: &lt;input type=&quot;text&quot; name=&quot;email&quot;&gt;&lt;br&gt;<br />
Web: &lt;input type=&quot;text&quot; name=&quot;web&quot;&gt;&lt;br&gt;<br />
&lt;input type=&quot;Submit&quot;&gt;<br />
&lt;/form&gt;<br />
<br />
This page could, of course, be formatted and have other changes made to it. It is just a basic form to get you started. Next you will need to edit the script from last week. Instead of using information to input into the database, you will instead use variables:<br />
<font color="#0088AA">&lt;?<br />
$username=&quot;username&quot;;<br />
$password=&quot;password&quot;;<br />
$database=&quot;your_database&quot;;<br />
<br />
$first=$_POST[&#039;first&#039;];<br />
$last=$_POST[&#039;last&#039;];<br />
$phone=$_POST[&#039;phone&#039;];<br />
$mobile=$_POST[&#039;mobile&#039;];<br />
$fax=$_POST[&#039;fax&#039;];<br />
$email=$_POST[&#039;email&#039;];<br />
$web=$_POST[&#039;web&#039;];<br />
<br />
mysql_connect(localhost,$username,$password);<br />
@mysql_select_db($database) or die( &quot;Unable to select database&quot;);<br />
<br />
$query = &quot;INSERT INTO contacts VALUES (&#039;&#039;,&#039;$first&#039;,&#039;$last&#039;,&#039;$phone&#039;,&#039;$mobile&#039;,&#039;$fax&#039;,&#039;$email&#039;,&#039;$web&#039;)&quot;;<br />
mysql_query($query);<br />
<br />
mysql_close();<br />
?&gt;<br />
<br />
This script should then be saved as insert.php so that it can be called by the HTML form. It works because, instead of the data being entered locally, it is being entered into the form and stored in variables which are then passed to the PHP.<br />
<br />
You could also add to this script a message confirming the data input. This is basic PHP, though, and you should read the PHP tutorial if you do not know how to do this.<br />
<br />
<big><b>Outputting Data</b></big><br />
<br />
Now you have at least one record, if not many more, in your database you will be wanting to know how you can output this data using PHP. Before beginning, though you should be familiar with loops in PHP (you can find out about them in the tutorial on Free Webmaster Help) as they are used for this way of outputting data.<br />
<br />
The first command you will need to use is a MySQL query made up like this:<br />
<font color="#0088AA"><br />
SELECT * FROM contacts<br />
<br />
This is a basic MySQL command which will tell the script to select all the records in the contacts table. Because there will be output from this command it must be executed with the results being assigned to a variable:<br />
<font color="#0088AA"><br />
$query=&quot;SELECT * FROM contacts&quot;;<br />
$result=mysql_query($query);<br />
<br />
In this case the whole contents of the database is now contained in a special array with the name $result. Before you can output this data you must change each piece into a separate variable. There are two stages to this.<br />
<br />
<big><b>Counting Rows</b></big><br />
<br />
Before you can go through the data in your result variable, you must know how many database rows there are. You could, of course, just type this into your code but it is not a very good solution as the whole script would need to be changed every time a new row was added. Instead you can use the command:<br />
<br />
<font color="#0088AA">$num=mysql_numrows($result);<br />
<br />
This will set the value of $num to be the number of rows stored in $result (the output you got from the database). This can then be used in a loop to get all the data and output it on the screen.<br />
<br />
<big><b>Setting Up The Loop</b></big><br />
<br />
<br />
nYou must now set up a loop to take each row of the result and print out the data held there. By using $num, which you created above, you can loop through all the rows quite easily. In the code below, $i is the number of times the loop has run and is used to make sure the loop stops at the end of the results so there are no errors.<br />
<font color="#0088AA"><br />
$i=0;<br />
while ($i &lt; $num) {<br />
<br />
CODE<br />
<br />
$i++;<br />
}<br />
<br />
This is a basic PHP loop and will execute the code the correct number of times. Each time $i will be one greater than the time before. This is useful, as $i can be used to tell the script which line of the results should be read. As the first line in MySQL output is 0, this will work correctly.<br />
<br />
<big><b>Assigning The Data To Variables</b></big><br />
<br />
The final part of this output script is to assign each piece of data to its own variable. The following code is used to do this:<br />
<font color="#0088AA"><br />
$variable=mysql_result($result,$i,&quot;fieldname&quot;);<br />
<br />
So to take each individual piece of data in our database we would use the following:<br />
<font color="#0088AA"><br />
$first=mysql_result($result,$i,&quot;first&quot;);<br />
$last=mysql_result($result,$i,&quot;last&quot;);<br />
$phone=mysql_result($result,$i,&quot;phone&quot;);<br />
$mobile=mysql_result($result,$i,&quot;mobile&quot;);<br />
$fax=mysql_result($result,$i,&quot;fax&quot;);<br />
$email=mysql_result($result,$i,&quot;email&quot;);<br />
$web=mysql_result($result,$i,&quot;web&quot;);<br />
<br />
We do not need to get the ID field (although we could have done) because we have no use for it in the current output page.<br />
<br />
<big><b>Combining The Script</b></big><br />
<br />
We can now write a full script to output the data. In this script the data is not formatted when it is output:<br />
<font color="#0088AA"><br />
&lt;?<br />
$username=&quot;username&quot;;<br />
$password=&quot;password&quot;;<br />
$database=&quot;your_database&quot;;<br />
<br />
mysql_connect(localhost,$username,$password);<br />
@mysql_select_db($database) or die( &quot;Unable to select database&quot;);<br />
$query=&quot;SELECT * FROM contacts&quot;;<br />
$result=mysql_query($query);<br />
<br />
$num=mysql_numrows($result);<br />
<br />
mysql_close();<br />
<br />
echo &quot;&lt;b&gt;&lt;center&gt;Database Output&lt;/center&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;&quot;;<br />
<br />
$i=0;<br />
while ($i &lt; $num) {<br />
<br />
$first=mysql_result($result,$i,&quot;first&quot;);<br />
$last=mysql_result($result,$i,&quot;last&quot;);<br />
$phone=mysql_result($result,$i,&quot;phone&quot;);<br />
$mobile=mysql_result($result,$i,&quot;mobile&quot;);<br />
$fax=mysql_result($result,$i,&quot;fax&quot;);<br />
$email=mysql_result($result,$i,&quot;email&quot;);<br />
$web=mysql_result($result,$i,&quot;web&quot;);<br />
<br />
echo &quot;&lt;b&gt;$first $last&lt;/b&gt;&lt;br&gt;Phone: $phone&lt;br&gt;Mobile: $mobile&lt;br&gt;Fax: $fax&lt;br&gt;E-mail: $email&lt;br&gt;Web: $web&lt;br&gt;&lt;hr&gt;&lt;br&gt;&quot;;<br />
<br />
$i++;<br />
}<br />
<br />
?&gt;<br />
<br />

<a name=5></a>
<a href="#top">Top</a><br>
Part 5 - More Outputs<br>
<p>
<big><b>Introduction</b></big><br />
<br />
Throughout this tutorial you have learnt how to create a database and table, insert information and display the database information. In this part I will show you more ways of displaying and outputting the information in the database.<br />
<br />
<big><b>Formatting Output</b></big><br />
<br />
In the last part of the tutorial we output a list of all the people stored in the database. This just gave us a very basic output, though and is not particularly useful for a working website. Instead, it would be better if we could format it into a table and display it like this.<br />
<br />
Doing this formatting is not particularly complicated. All you need to do is use PHP to output HTML and include your variables in the correct spaces. The easiest way to do this is by closing your PHP tag and entering the HTML normally. When you reach a variable position, include it as follows:<br />
<font color="#0088AA"><br />
&lt;? echo $variablename; ?&gt;<br />
<br />
in the correct position in your code.<br />
<br />
You can also use the PHP loop to repeat the appropriate code and include it as part of a larger table. For example, using a section of the code from part 4 which looped to output the database you can format it to display it in one large table:<br />
<font color="#0088AA"><br />
&lt;table border=&quot;0&quot; cellspacing=&quot;2&quot; cellpadding=&quot;2&quot;&gt;<br />
&lt;tr&gt;<br />
&lt;th&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;Name&lt;/font&gt;&lt;/th&gt;<br />
&lt;th&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;Phone&lt;/font&gt;&lt;/th&gt;<br />
&lt;th&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;Mobile&lt;/font&gt;&lt;/th&gt;<br />
&lt;th&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;Fax&lt;/font&gt;&lt;/th&gt;<br />
&lt;th&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;E-mail&lt;/font&gt;&lt;/th&gt;<br />
&lt;th&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;Website&lt;/font&gt;&lt;/th&gt;<br />
&lt;/tr&gt;<br />
<br />
&lt;?<br />
$i=0;<br />
while ($i &lt; $num) {<br />
<br />
$first=mysql_result($result,$i,&quot;first&quot;);<br />
$last=mysql_result($result,$i,&quot;last&quot;);<br />
$phone=mysql_result($result,$i,&quot;phone&quot;);<br />
$mobile=mysql_result($result,$i,&quot;mobile&quot;);<br />
$fax=mysql_result($result,$i,&quot;fax&quot;);<br />
$email=mysql_result($result,$i,&quot;email&quot;);<br />
$web=mysql_result($result,$i,&quot;web&quot;);<br />
?&gt;<br />
<br />
&lt;tr&gt;<br />
&lt;td&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;&lt;? echo $first.&quot; &quot;.$last; ?&gt;&lt;/font&gt;&lt;/td&gt;<br />
&lt;td&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;&lt;? echo $phone; ?&gt;&lt;/font&gt;&lt;/td&gt;<br />
&lt;td&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;&lt;? echo $mobile; ?&gt;&lt;/font&gt;&lt;/td&gt;<br />
&lt;td&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;&lt;? echo $fax; ?&gt;&lt;/font&gt;&lt;/td&gt;<br />
&lt;td&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;&lt;a href=&quot;mailto:&lt;? echo $email; ?&gt;&quot;&gt;E-mail&lt;/a&gt;&lt;/font&gt;&lt;/td&gt;<br />
&lt;td&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;&lt;a href=&quot;&lt;? echo $web; ?&gt;&quot;&gt;Website&lt;/a&gt;&lt;/font&gt;&lt;/td&gt;<br />
&lt;/tr&gt;<br />
<br />
&lt;?<br />
$i++;<br />
}<br />
<br />
<br />
echo &quot;&lt;/table&gt;&quot;;<br />
<br />
This code will print out table headers, then add an extra row for each record in the database, formatting the data as it is output.<br />
<br />
As long as you are familiar with PHP and HTML the code is probably pretty self explanatory but I will just point out the last two lines in the table, for example:<br />
<font color="#0088AA"><br />
&lt;a href=&quot;mailto:&lt;? echo $email; ?&gt;&quot;&gt;E-mail&lt;/a&gt;<br />
<br />
This shows one of the useful features of using PHP to include MySQL data as you can use it to output parts of your code and make pages fully dynamic.<br />
<br />
<big><b>Selecting Pieces of Data</b></big><br />
<br />
As well as showing the whole database, PHP can be used to select individual records, or records which match certian criteria. To do this you must use a variation of the SELECT query. To display the whole table we used the query:<br />
<font color="#0088AA"><br />
SELECT * FROM contacts<br />
<br />
If we just wanted to select ones who had the first name &#039;John&#039; you would use the following query:<br />
<font color="#0088AA"><br />
SELECT * FROM contacts WHERE first=&#039;john&#039;<br />
<br />
As with other MySQL queries, it is almost like plain english. In the same way you could select records based on any field in the database. You can also select ones with more than one field by adding more:<br />
<font color="#0088AA"><br />
field=&#039;value&#039;<br />
<br />
sections onto the query.<br />
<br />
Although I won&#039;t go int<br />
o great depth about it in this section, you can also use variables to give the database criteria. For example, if you had a search form you could get the last name people wanted to search for and store it in a variable called $searchlast. Then you could execute the following piece of code:<br />
<font color="#0088AA"><br />
$query=&quot;SELECT * FROM contacts WHERE last=&#039;$searchlast&#039;&quot;;<br />
$result=mysql_query($query);<br />
<br />
Please note that at the end of the first line there is a &#039; followed by a &quot; before the semicolon.<br />
<br />
<big><b>Security</b></big><br />
<br />
At this point it should be noted that you must be very careful in using the technique given above. Without correct secuirty measures, it would be very easy for someone to access data on your server, or even make changes to the database. This can occur if the user sets the variable to a value which edits the SQL string being generated in such a way that it can be used for their own purposes. I won&#039;t go into full details here, but there are many websites which give full details (search for &#039;sql injection attack&#039;).<br />
<br />
This security hole is easy to plug with a bit of work. Always check input data for invalid chanracters and use PHP&#039;s built in functions to remove control characters and HTML code etc. Again, there are many websites which go into this in depth.<br />
<br />

<a name=6></a>
<a href="#top">Top</a><br>
Part 6 - Single Records & Error Trapping<br>
<p>
<big><b>Introduction</b></big><br />
<br />
In the past two parts of this tutorial I have shown you how to take data out of the database and display it on screen. In this part I will enter into the final aspect of this data displaying, selecting one piece of data and stopping errors from happening when you output data.<br />
<br />
<big><b>Error Trapping</b></big><br />
<br />
By outputting all the information from the database, it is quite unlikely that there will be no data, but if you allow updating and deleting of records, it is certainly a possibility. Luckily, with PHP and MySQL, there is an easy way round this using:<br />
<font color="#0088AA"><br />
$num=mysql_numrows($result);<br />
<br />
where $result contains the result of a query on the database (like selecting all the records). As I expalined before, this will set the value of $num as the number of rows in the result (and it was used in a loop in part 4). Because of this you can make a simple error trap using an IF statement:<br />
<font color="#0088AA"><br />
if ($num==0) {<br />
echo &quot;The database contains no contacts yet&quot;;<br />
} else {<br />
Output Loop<br />
}<br />
<br />
You can expand on this more by making it more user friendly (for example by providing a link to the Add Data page if no contacts exist).<br />
<br />
<big><b>Ordering Data</b></big><br />
<br />
Not only can you output data based on the contents of a field, but you can also order the output based on a field (for example placing users in alphabetical order). By default, the output from your queries will be in order of the id field, going from 1 upwards. You can sort it on any field, though.<br />
<br />
For example, a useful sort would be to place all the users in alphabetical order based on their last name. For those not familiar with standard databases, this would be in Ascending order as it goes from A to Z. (Ascending order is also for 1-10 etc. and descending order provides Z to A and 10-1). To do this you would use the following query:<br />
<font color="#0088AA"><br />
SELECT * FROM contacts ORDER BY last ASC<br />
<br />
You could also use DESC to order the data in Descending order.<br />
<br />
<big><b>More Uses Of mysql_numrows and Sorting</b></big><br />
<br />
The value you have assigned to $num is very imiportant as, apart from error trapping and loops, it has many other uses. An example of this would be to print out only the last 5 records added to a database. Firstly, they would need to be placed into order based on the id field (as the one with the latest ID would have been added last. This would require them to be in Descending order.<br />
<br />
Now you have them in order of newest to oldest but this does not restrict the script to only showing the first 5. To do this, you would need to set your loop to run to 5 instead of $num (as this would only run the loop 5 times so only 5 records would be output).<br />
<br />
Of course, before doing this, it would be important to check that $num was greater than 5, as if you ran the loop 5 times and there were only 3 rows you would get an error. This is easy to do though and the following code is an example of the sort of thing you would want to have:<br />
<font color="#0088AA"><br />
if ($num&gt;5) {<br />
$to=5;<br />
}else{<br />
$to=$num;<br />
}<br />
<br />
$i=0;<br />
while ($i &lt; $to) {<br />
REST OF CODE<br />
<br />
This code would check if there were more than 5 rows in the database. If there were, the loop would be set to run 5 times. If there were less than 5 rows the loop would run the correct number of times to output the whole database.<br />
<br />
<big><b>The ID Field</b></big><br />
<br />
If you remember back to creating the database for the contacts at the beginning of this tutorial, you will remember that we included a numerical field called id. This field was set as auto_increment as well as being the primary field. I have already explained how this field is unique for every single record in the database, but I will now take this a stage further by explaining how this can be used to select an individual record from a database.<br />
<br />
<big><b>Selecting A Single Record</b></big><br />
<br />
At the end of the last part of this tutorial, I s<br />
howed you how to select records from the database based on the contents of partiular fields using:<br />
<font color="#0088AA"><br />
SELECT * FROM contacts WHERE field=&#039;value&#039;<br />
<br />
Now, by using the unique ID field we can select any record from our database using:<br />
<font color="#0088AA"><br />
SELECT * FROM contacts WHERE id=&#039;$id&#039;<br />
<br />
Where $id is a variable holding a number of a record. This may seem to be a little worthless as it is, but you can use this very effectively in a number of different ways. For example, if you wanted to have a dynamically generated site run through a database and a single PHP script, you could write the script to include the database data into the design. Then, using the id field, you could select each individual page and put it into the output. You can even use the page&#039;s URL to specify the record you want e.g.<br />
<font color="#0088AA"><br />
http://www.yoursite.com/news/items.php?item=7393<br />
<br />
And then have the PHP script look up the record with the id corresponding to $item, which in this case would be 7393<br />
<br />
<big><b>Links For Single Records</b></big><br />
<br />
Using this method of choosing a record using the URL to select the record can be expanded further by generating the URL dynamically. This sounds a bit complicated so I will elaborate. In the contacts script we are writing, I will be showing you how to create an Update page where the user can update the contact details.<br />
<br />
To do this, another column will be included in the output column, with an Update link in it. This update link will point to a page allowing the user to update the record. To select the record in this page, we will put:<br />
<font color="#0088AA"><br />
?id=$id<br />
<br />
By getting the id of the record along with the other information when we are outputting the information from the database, this code will create a link which has each record&#039;s ID number in it. Then, on the update page, there can be code to just select this item.<br />
<br />

<a name=7></a>
<a href="#top">Top</a><br>
Part 7 - Updating & Deleting<br>
<p>
<big><b>Introduction</b></big><br />
<br />
So far you have learnt how to put information into your MySQL database, view the information in it and select which information you would like to view. In this part I will show you how to do the two final actions, updating your database and deleting records from it.<br />
<br />
<big><b>The Update Script</b></big><br />
<br />
Last week I explained how to create a link for each record to point to your update script. By using the $id variable you output links which would pass the correct ID to the script so that it can update the database. Using this you can then create the update script, which will actually have two sections to it.<br />
<br />
<big><b>Displaying The Update Page</b></big><br />
<br />
The first part of the update script uses the single record selection from last week but adds a little HTML to it to make it more useful. First of all, we connect to the database and select the appropriate record.<br />
<font color="#0088AA"><br />
$id=$_GET[&#039;id&#039;];<br />
$username=&quot;username&quot;;<br />
$password=&quot;password&quot;;<br />
$database=&quot;your_database&quot;;<br />
mysql_connect(localhost,$username,$password);<br />
<br />
$query=&quot; SELECT * FROM contacts WHERE id=&#039;$id&#039;&quot;;<br />
$result=mysql_query($query);<br />
$num=mysql_numrows($result);<br />
mysql_close();<br />
<br />
$i=0;<br />
while ($i &lt; $num) {<br />
$first=mysql_result($result,$i,&quot;first&quot;);<br />
$last=mysql_result($result,$i,&quot;last&quot;);<br />
$phone=mysql_result($result,$i,&quot;phone&quot;);<br />
$mobile=mysql_result($result,$i,&quot;mobile&quot;);<br />
$fax=mysql_result($result,$i,&quot;fax&quot;);<br />
$email=mysql_result($result,$i,&quot;email&quot;);<br />
$web=mysql_result($result,$i,&quot;web&quot;);<br />
<br />
Space For Code<br />
<br />
++$i;<br />
}<br />
<br />
Where &#039;Space For Code&#039; is in this script is where the code for the update page will go. This is, in fact, just HTML formatting for the output:<br />
<font color="#0088AA"><br />
&lt;form action=&quot;updated.php&quot; method=&quot;post&quot;&gt;<br />
&lt;input type=&quot;hidden&quot; name=&quot;ud_id&quot; value=&quot;&lt;? echo $id; ?&gt;&quot;&gt;<br />
First Name: &lt;input type=&quot;text&quot; name=&quot;ud_first&quot; value=&quot;&lt;? echo $first; ?&gt;&quot;&gt;&lt;br&gt;<br />
Last Name: &lt;input type=&quot;text&quot; name=&quot;ud_last&quot; value=&quot;&lt;? echo $last; ?&gt;&quot;&gt;&lt;br&gt;<br />
Phone Number: &lt;input type=&quot;text&quot; name=&quot;ud_phone&quot; value=&quot;&lt;? echo $phone; ?&gt;&quot;&gt;&lt;br&gt;<br />
Mobile Number: &lt;input type=&quot;text&quot; name=&quot;ud_mobile&quot; value=&quot;&lt;? echo $mobile; ?&gt;&quot;&gt;&lt;br&gt;<br />
Fax Number: &lt;input type=&quot;text&quot; name=&quot;ud_fax&quot; value=&quot;&lt;? echo $fax; ?&gt;&quot;&gt;&lt;br&gt;<br />
E-mail Address: &lt;input type=&quot;text&quot; name=&quot;ud_email&quot; value=&quot;&lt;? echo $email; ?&gt;&quot;&gt;&lt;br&gt;<br />
Web Address: &lt;input type=&quot;text&quot; name=&quot;ud_web&quot; value=&quot;&lt;? echo $web; ?&gt;&quot;&gt;&lt;br&gt;<br />
&lt;input type=&quot;Submit&quot; value=&quot;Update&quot;&gt;<br />
&lt;/form&gt;<br />
<br />
As you can see, this code will output a standard form, but instead of having blank boxes like on the form for inserting a new record, this one already has the current information from the database inserted into it. This makes it much more effective for an update script.<br />
<br />
<big><b>Updating The Database</b></big><br />
<br />
The next stage of this script is to actually update the database. This is a simple operation and just involves a new query for the database:<br />
<font color="#0088AA"><br />
$query = &quot;UPDATE contacts SET first = &#039;$ud_first&#039;, last = &#039;$ud_last&#039;, phone = &#039;$ud_phone&#039;, mobile = &#039;$ud_mobile&#039;, fax = &#039;$ud_fax&#039;, email = &#039;$ud_email&#039;, web = &#039;$ud_web&#039; WHERE id = &#039;$ud_id&#039;&quot;;<br />
<br />
This query tells the database to update the contacts table where the ID is the same as the value stored in $ud_id (which as you can see from the form on the previous page was set as the id of the record we are updating) and to set the following fields to the specified values (which were set using the form on the previous page).<br />
<br />
This query could then be integrated into a simple script:<br />
<font color="#0088AA"><br />
$ud_id=$_POST[&#039;ud_id&#039;];<br />
$ud_first=$_POST[&#039;ud_first&#039;];<br />
$ud_last=$_POST[&#039;ud_last&#039;];<br />
$ud_phone=$_POST[&#039;ud_phone&#039;];<br />
$ud_mobile=$_POST[&#039;ud_mobile&#039;];<br />
$ud_fax=$_POST[&#039;ud_fax&#039;];<br />
$ud_email=$_POST[&#039;ud_email&#039;];<br />
$ud_web=$_POST[&#039;ud_web&#039;];<br />
<br />
$username=&quot;username&quot;;<br />
$password=&quot;password&quot;;<br />
$database=&quot;your_database&quot;;<br />
mysql_connect(localhost,$username,$password);<br />
<br />
<br />
$query=&quot;UPDATE contacts SET first=&#039;$ud_first&#039;, last=&#039;$ud_last&#039;, phone=&#039;$ud_phone&#039;, mobile=&#039;$ud_mobile&#039;, fax=&#039;$ud_fax&#039;, email=&#039;$ud_email&#039;, web=&#039;$ud_web&#039; WHERE id=&#039;$ud_id&#039;&quot;;<br />
mysql_query($query);<br />
echo &quot;Record Updated&quot;;<br />
mysql_close();<br />
<br />
This code would update the database and give the user a confirmation.<br />
<br />
<big><b>Deleting Records</b></big><br />
<br />
The final part of the contacts database which needs to be created is a page to delete records. As with the Update page, this should have a record ID sent to it in the URL e.g.:<br />
<font color="#0088AA"><br />
delete.php?id=9<br />
<br />
The code to do this is the same as to update the database, except with a slightly different MySQL query. Instead of the UPDATE query you should use:<br />
<font color="#0088AA"><br />
DELETE FROM contacts WHERE id=&#039;$id&#039;<br />
<br />
This would then be used with the connection and confirmation code as above.<br />
<br />
<big><b>Loops</b></big><br />
<br />
At this time it seems appropriate to mention another use of loops with a database. As well as using a loop to get information from a database as we have before, you can also use loops to execute queries. For example, if you wanted to change all the records in the database with the last name Smith to have the website www.smith.com:<br />
<font color="#0088AA"><br />
Standard Database Connection Code<br />
<br />
$query=&quot; SELECT * FROM contacts WHERE last=&#039;Smith&#039;&quot;;<br />
$result=mysql_query($query);<br />
$num=mysql_numrows($result);<br />
<br />
$i=0;<br />
while ($i &lt; $num) {<br />
$id=mysql_result($result,$i,&quot;id&quot;);<br />
$query1=&quot;UPDATE contacts SET web=&#039;http://www.smith.com&#039; WHERE id=&#039;$id&#039;&quot;;<br />
mysql_query($query);<br />
++$i;<br />
}<br />
<br />
mysql_close();<br />
<br />
Of course, this could have been achived far easier and quicker using:<br />
<font color="#0088AA"><br />
$query1=&quot;UPDATE contacts SET web=&#039;http://www.smith.com&#039; WHERE last=&#039;Smith&#039;&quot;;<br />
<br />
and no loop.<br />
 <br />

<a name=8></a>
<a href="#top">Top</a><br>
Part 8 - Finishing The Script<br>
<p>
<big><b>Introduction</b></big><br />
<br />
Throughout this tutorial I have taught you how to use PHP to interact with a MySQL (or SQL) database and how to use the most common commands available. I have, throughout this tutorial, also shown you how to create a basic contacts management system to illustrate some of the options you can use. In this part I will show you some final MySQL tips and will give you a final version of the script.<br />
<br />
<big><b>Saving Time</b></big><br />
<br />
When creating complex scripts using databases you will find that the most common thing you are doing is connecting to a database. Because of this, you can actually save time by creating either a username/password file or a connection file. For example for a username/password file you would create a file called:<br />
<font color="#0088AA"><br />
dbinfo.inc.php<br />
<br />
and put the following in it:<br />
<font color="#0088AA"><br />
&lt;?<br />
$username=&quot;databaseusername&quot;;<br />
$password=&quot;databasepassword&quot;;<br />
$database=&quot;databasename&quot;;<br />
?&gt;<br />
<br />
Replacing the appropriate sections. Then in your php files use the following code:<br />
<font color="#0088AA"><br />
include(&quot;dbinfo.inc.php&quot;);<br />
<br />
or<br />
<font color="#0088AA"><br />
include(&quot;/full/path/to/file/dbinfo.inc.php&quot;);<br />
<br />
at the beginning. Then, you can use the variables $username, $password and $database throughout your scripts without having to define them every time. Also, if you ever change this information, for example if you move to another web host, there is only one file to change.<br />
<br />
You can use the same principal to connect to the database, by putting the connection code in the file, but you must always be sure to close the connection in each file or you may have problems with your MySQL server.<br />
<br />
<big><b>Searching</b></big><br />
<br />
A limited form of searching can also be performed on your database using a built in MySQL function. This is by using the LIKE function as follows:<br />
<font color="#0088AA"><br />
SELECT * FROM tablename WHERE fieldname LIKE &#039;%$string%&#039;<br />
<br />
To explain furhter, LIKE tells the database to perform its &#039;searching&#039; feature. The % signs mean that any other data could appear in their place and $string would hold your search string. In this place could be a word or number as well e.g.:<br />
<font color="#0088AA"><br />
LIKE &#039;%piano%&#039;<br />
<br />
which would output any rows with piano in the specified field.<br />
<br />
Similarly, you can leave out one of the % signs so that you can specify the position of the string e.g.:<br />
<font color="#0088AA"><br />
LIKE &#039;piano%&#039;<br />
<br />
Will only output rows where the specified field begins with piano, so:<br />
<font color="#0088AA"><br />
The piano is next to the table.<br />
<br />
Would not show up.<br />
<br />
<big><b>The Finished Script</b></big><br />
<br />
Throughout this tutorial I have given you pieces of code to make a contacts database script. You can download the full script as a zip file so that you can examine the code (see Related Links).<br />
<br />
<big><b>Conclusion</b></big><br />
<br />
From this tutorial you should now know the basics of using PHP and MySQL together to create database-enabled websites and programs. Using databases with the web opens up a huge new selection of things you can do and can make a simple website much more powerful, saving time updating the site, allowing user interaction and feedback and much more.</p>
