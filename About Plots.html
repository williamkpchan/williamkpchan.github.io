<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css" target=_blank>a {text-decoration: none}</style>
</head>
<body bgcolor="#000000" text="#109030" leftmargin="150" topmargin="10" marginwidth="150" link="#00CCCC" vlink="#CC66CC" alink="#FFFF00" target=_blank>
<FONT size=3>

<h1 class="row">Questions About Plots</h1>


<p>R allows you to create different plot types, ranging from the basic graph types like density plots, dot plots, bar charts, line charts, pie charts, boxplots and scatter plots, to the more statistically complex types of graphs such as probability plots, mosaic plots and correlograms.
In addition, R is pretty known for its data visualization capabilities: it allows you to go from producing basic graphs with little customization to plotting advanced graphs with full-blown customization in combination with interactive graphics. Nevertheless, not always do we get the results that we want for our R plots: <a href="http://stackoverflow.com/" target="_blank">Stack Overflow</a> is flooded with our questions on plots, with many recurring questions.
This is why DataCamp decided to put all the frequently asked questions and their top rated answers together in a blog post, completed with additional, short explanations that could be of use for R beginners.

If you are rather interested in learning how to plot with R, you might consider reading our <a href="http://blog.datacamp.com/make-histogram-basic-r/" target="_blank">tutorial on histograms</a>, which covers basic R, ggplot2 and ggvis, or <a href="http://www.harding.edu/fmccown/r/" target="_blank">this shorter tutorial</a> which offers an overview of simple graphs in R. However, if you're looking to learn everything on creating stunning and informative graphical visualizations, our <a href="https://www.datacamp.com/courses/ggvis-data-visualization-r-tutorial?questions_plots&amp;utm_medium=blog&amp;utm_campaign=questions_plots" target="_blank">interactive course</a> on (interactive) data visualization with <a href="http://www.rdocumentation.org/packages/ggvis" target="_blank">ggvis</a> will definitely interest you!</p>

<p></p>

<p></p>

<h2>1. How To Draw An Empty R Plot?</h2>

<p></p>

<p></p>

<h3>How To Open A New Plot Frame</h3>

<p>
You can open an empty plot frame and activate the graphics device in R as follows:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot.new() # or frame()
</code></pre>

<p><strong>Note</strong> that the <code>plot.new()</code> and <code>frame()</code> functions define a new plot frame without it having any axes, labels, or outlining. It indicates that a new plot is to be made: a new graphics window will open if you don't have one open yet, otherwise the existing window is prepared to hold the new plot. You can read up on these functions <a href="http://www.rdocumentation.org/packages/graphics/functions/frame" target="_blank">here</a>.</p>

<p></p>

<p></p>

<ul>
	<li>
	<a href="http://www.rdocumentation.org/packages/grDevices/functions/x11"><code>x11()</code></a> can also opens a new windows device in R for the X Window System (version 11)!</li>
	
	<li>
	<a href="http://www.rdocumentation.org/packages/grDevices/functions/quartz"><code>quartz()</code></a> starts a graphics device driver for the OS X System.</li>
	
	<li>
	<a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/frame.html"><code>windows()</code></a> starts a new graphics device for Windows.</li>
	
	
	 
</ul>

<p></p>

<p></p>

<h3>How To Set Up The Measurements Of The Graphics Window</h3>

<p>
You can also use the <a href="http://www.rdocumentation.org/packages/graphics/functions/plot.window"><code>plot.window()</code></a> function to set the horizontal and vertical dimensions of the empty plot you just made:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">pWidth = 3
pHeight = 2
plot.window(c(0,pWidth),
            c(0,pHeight))
</code></pre>

<p></p>

<p></p>

<h3>How To Draw An Actual Empty Plot</h3>

<p>
You can draw an empty plot with the <a href="http://www.rdocumentation.org/packages/graphics/functions/plot"><code>plot()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot(5,
     5,
     type="n",
     axes=FALSE,
     ann=FALSE,
     xlim=c(0, 10),
     ylim = c(0,10))
</code></pre>

<p>
You give the coordinates (5,5) for the plot, but that you don't show any plotting by putting the <code>type</code> argument to <code>"n"</code>.
(<strong>Tip</strong>: try to put this argument to <code>"p"</code> or <code>"b"</code> and see what happens!)
What's more, you don't annotate the plot, but you do put limits from <code>0</code> to <code>10</code> on the x- and y-axis. Next, you can fill up your empty plot with axes, axes labels and a title with the following commands:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">mtext("x-axis",
      side=1) #Add text to the x-axis
mtext("y-axis",
      side=2)
title("An R Plot") #Add a title
</code></pre>

<p><strong>Note</strong> that if you want to know more about the <code>side</code> argument, you can just keep on reading! It will be discussed in more detail below, in question 3 about R plots.
Lastly, you may choose to draw a box around your plot by using the <a href="http://www.rdocumentation.org/packages/graphics/functions/box"><code>box()</code></a> function and add some points to it with the <a href="http://www.rdocumentation.org/packages/graphics/functions/points.html"><code>points()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">box() #Draw a box
points(5,  #Put (red) point in the plot at (5,5)
       5,
       col="red")
points(5,
       7,
       col="orange",
       pch=3,
       cex=2)
points(c(0, 0, 1),
       c(2, 4, 6),
       col="green",
       pch=4)
</code></pre>

<p><strong>Note</strong> that you can put your x-coordinates and y-coordinates in vectors to plot multiple points at once. The <code>pch</code> argument allows you to select a symbol, while the <code>cex</code> argument has a value assigned to it that indicates how much the plotted text and symbols should be scaled with respect to the default.<strong>Tip</strong>: if you want to see what number links to what symbol, click <a href="http://web.mit.edu/r_v3.0.1/lib/R/library/graphics/html/points.html" target="_blank">here</a>.</p>

<p></p>

<p></p>

<h2>2. How To Set The Axis Labels And Title Of The R Plots?</h2>

<p>
The axes of the R plots make up one of the most popular topics of Stack Overflow questions; The questions related to this topic are very diverse. Keep on reading to find out what type of questions DataCamp has found to be quite common!</p>

<p></p>

<p></p>

<h3>How To Name Axes (With Up- Or Subscripts) And Put A Title To An R Plot?</h3>

<p>
You can easily name the axes and put a title in place to make your R plot more specific and understandable for your audience.
This can be easily done by adding the arguments <code>main</code> for the main title, <code>sub</code> for the subtitle, <code>xlab</code> for the label of the x-axis and <code>ylab</code> for the label of the y-axis:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     main="main title",
     sub="sub-title",
     xlab="x-axis label",
     ylab="y-axis label")
</code></pre>

<p><strong>Note</strong> that if you want to have a title with up-or subscripts, you can easily add these with the following commands:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot(1,
     1,
     main=expression("title"^2)) #Upscript
plot(1,
     1,
     main=expression("title"[2])) #Subscript
</code></pre>

<p>
This all combined gives you the following plot:<a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot1.png"><img alt="Rplot1" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot1.png" width="694"></a><br><br><br><strong>Good to know:</strong> for those who want to have Greek letters in your axis labels, the following code can be executed:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     xlab = expression(paste("Greek letter ", phi)),
     ylab = expression(paste("Greek letter ",mu)))
</code></pre>

<p></p>

<p></p>

<h3>How To Adjust The Appearance Of The Axes' Labels</h3>

<p>
To adjust the appearance of the x-and y-axis labels, you can use the arguments <code>col.lab</code> and <code>cex.lab</code>. The first argument is used to change the color of the x-and y-axis labels, while the second argument is used to determine the size of the x-and y-axis labels, relative to the (default) setting of <code>cex</code>.</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     main=expression("main title"^2),
     sub=expression("sub-title"[2]),
     xlab="x-axis label",
     ylab="y-axis label",
     col.lab="blue",
     cex.lab=0.75)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot2.png"><img alt="Rplot2" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot2.png" width="694"></a><br><br><br>
For more information on these arguments, go to <a href="http://www.rdocumentation.org/packages/graphics/functions/par" target="_blank">this page</a>.</p>

<p></p>

<p></p>

<h3>How To Remove A Plot's Axis Labels And Annotations</h3>

<p>
If you want to get rid of the axis values of a plot, you can first add the arguments <code>xaxt</code> and <code>yaxt</code>, set as <code>"n"</code>. These arguments are assigned a character which specifies the x-axis type. If you put in an <code>"n"</code>, like in the command below, you can suppress the plotting of the axis.<strong>Note</strong> that by giving any other character to the <code>xaxt</code> and <code>yaxt</code> arguments, the x-and y-axes are plotted.
Next, you can add the annotation argument <code>ann</code> and set it to <code>FALSE</code> to make sure that any axis labels are removed.</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     xaxt="n",
     yaxt="n",
     ann=FALSE)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot3.png"><img alt="Rplot3" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot3.png" width="694"></a><br><br><br><strong>Tip:</strong> not the information you are looking for? Go to <a href="http://www.rdocumentation.org/packages/graphics/functions/par" target="_blank">this page</a>.</p>

<p></p>

<p></p>

<h3>How To Rotate A Plot's Axis Labels</h3>

<p>
You can add the <code>las</code> argument to the <a href="http://www.rdocumentation.org/packages/graphics/functions/axis" target="_blank"><code>axis()</code></a> function to rotate the numbers that correspond to each axis:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     axes=FALSE)
box()
axis(2,
     las=2)
axis(1,
     las=0)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot4.png"><img alt="Rplot4" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot4.png" width="694"></a><br><br><br><strong>Note</strong> how this actually requires you to add an argument to the <a href="http://www.rdocumentation.org/packages/graphics/functions/plot" target="_blank"><code>plot()</code></a> function that basically says that there are no axes to be plotted (yet): this is the task of the two <code>axis()</code> function that come next.
The <code>las</code> argument can have three values attributed to it. According to whichever option you choose, the placement of the label will differ: if you choose <code>0</code>, the label will always be parallel to the axis (which is the default); If you choose <code>1</code>, the label will be put horizontally. Pick <code>2</code> if you want it to be perpendicular to the axis and <code>3</code> if you want it to be placed vertically.
But there is more. If you want to know more about the possibilities of the <a href="http://www.rdocumentation.org/packages/graphics/functions/axis" target="_blank"><code>axis()</code></a> function, keep on reading!</p>

<p></p>

<p></p>

<h3>How To Move The Axis Labels Of Your R Plot</h3>

<p>
So, you want to move your axes' labels around?
No worries, you can do this with the <a href="http://www.rdocumentation.org/packages/graphics/functions/axis" target="_blank"><code>axis()</code></a> function; As you may have noticed before in this tutorial, this function allows you to first specify where you want to draw the axes. Let's say you want to draw the x-axis above the plot area and the y-axis to the right of it.<strong>Remember</strong> that if you pass <code>1</code> or <code>2</code> to the <a href="http://www.rdocumentation.org/packages/graphics/functions/axis" target="_blank"><code>axis()</code></a> function, your axis will be drawn on the bottom and on the left of the plot area. Scroll a bit up to see an example of this in the previous piece of code!
This means that you will want to pass <code>3</code> and <code>4</code> to the <a href="http://www.rdocumentation.org/packages/graphics/functions/axis" target="_blank"><code>axis()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x&lt;-seq(0,2*pi,0.1)
y&lt;-sin(x)
plot(x,
     y,
     axes=FALSE, # Do not plot any axes
     ann=FALSE) # Do not plot any annotations
axis(3)   # Draw the x-axis above the plot area
axis(4)   # Draw the y-axis to the right of the plot area
box()
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot5.png"><img alt="Rplot5" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot5.png" width="694"></a><br><br><br>
As you can see, at first, you basically plot <code>x</code> and <code>y</code>, but you leave out the axes and annotations. Then, you add the axes that you want to see and specify their location with respect to the plot.
The flexibility that the <a href="http://www.rdocumentation.org/packages/graphics/functions/axis" target="_blank"><code>axis()</code></a> function creates for you keeps on growing! Check out the next frequently asked question to see what else you can solve by using this basic R function.<strong>Tip:</strong> go to the last question to see more on how to move around text in the axis labels with <code>hjust</code> and <code>vjust</code>!</p>

<p></p>

<p></p>

<h2>3. How To Add And Change The Spacing Of The Tick Marks Of Your R Plot</h2>

<p></p>

<p></p>

<h3>How To Change The Spacing Of The Tick Marks Of Your R Plot</h3>

<p>
Letting R determine the tick marks of your plot can be quite annoying and there might come a time when you will want to adjust these.<strong>1. Using The <code>axis()</code> Function To Determine The Tick Marks Of Your Plot</strong>
Consider the following piece of code:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">v1 &lt;- c(0,pi/2,pi,3*pi/2,2*pi) # -&gt; defines position of tick marks.
v2 &lt;- c("0","Pi/2","Pi","3*Pi/2","2*Pi") # defines labels of tick marks.
x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     xaxt = "n")
axis(side = 1,
     at = v1,
     labels = v2,
     tck=-.05)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot6.png"><img alt="Rplot6" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot6.png" width="694"></a><br><br><br>
As you can see, you first define the position of the tick marks and their labels. Then, you draw your plot, specifying the x axis type as <code>"n"</code>, suppressing the plotting of the axis.
Then, the real work starts:</p>

<p></p>

<p></p>

<ul>
	<li>The <a href="http://www.rdocumentation.org/packages/graphics/functions/axis" target="_blank"><code>axis()</code></a> function allows you to specify the side of the plot on which the axis is to be drawn. In this case, the argument is completed with <code>1</code>, which means that the axis is to be drawn below. If the value was <code>2</code>, the axis would be drawn on the left and if the value was <code>3</code> or <code>4</code>, the axis would be drawn above or to the right, respectively;</li>
	
	<li>The <code>at</code> argument allows you to indicate the points at which tick marks are to be drawn. In this case, you use the positions that were defined in <code>V1</code>;</li>
	
	<li>Likewise, the <code>labels</code> that you want to use are the ones that were specified in <code>V2</code>;</li>
	
	<li>You adjust the direction of the ticks through <code>tck</code>: by giving this argument a negative value, you specify that the ticks should appear below the axis.</li>
	
	
	 
</ul>

<p><strong>Tip:</strong> try passing a positive value to the <code>tck</code> argument and see what happens!
You can further specify the size of the ticks through <code>tcl</code> and the appearance of the tick labels is controlled with <code>cex.axis</code>, <code>col.axis</code> and <code>font.axis</code>.</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">v1 &lt;- c(0,pi/2,pi,3*pi/2,2*pi) # -&gt; defines position of tick marks.
v2 &lt;- c("0","Pi/2","Pi","3*Pi/2","2*Pi") # defines labels of tick marks.
x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     xaxt = "n")
axis(side = 1,
     at = v1,
     labels = v2,
     tck=-.1,
     tcl = -0.5,
     cex.axis=1.05,
     col.axis="blue",
     font.axis=5)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot7.png"><img alt="Rplot7" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot7.png" width="694"></a><br><br><br><strong>2. Using Other Functions To Determine The Tick Marks Of Your R Plot</strong>
You can also use the <a href="http://www.rdocumentation.org/packages/graphics/functions/par" target="_blank"><code>par()</code></a> and <a href="http://www.rdocumentation.org/packages/graphics/functions/plot" target="_blank"><code>plot()</code></a> functions to define the positions of tickmarks and the number of intervals between them.<strong>Note</strong> that then you use the argument <code>xaxp</code> to which you pass the position of the tick marks that are located at the extremes of the x-axis, followed by the number of intervals between the tick marks:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     xaxp = c(0, 2*pi, 5))
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot8.png"><img alt="Rplot8" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot8.png" width="694"></a><br><br><br></p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r"># Or
x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     xaxt="n")
par(xaxp= c(0, 2*pi, 2))
axis(1)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot8b1.png"><img alt="Rplot8b" class="aligncenter wp-image-661 size-full" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot8b1.png" width="694"></a><br><br><br><strong>Note</strong> that this works only if you use no logarithmic scale. If the log coordinates set as true, or, in other words, if <code>par(xlog=T)</code>, the three values that you pass to <code>xaxp</code> have a different meaning: for a small range, n is negative. Otherwise, n is in 1:3, specifying a case number, and x1 and x2 are the lowest and highest power of 10 inside the user coordinates, 10 ^ par(“usr”)[1:2].
An example:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">n &lt;- 1
x &lt;- seq(0, 10000, 1)
y &lt;- exp(n)/(exp(n)+x)
par(xlog=TRUE,
    xaxp= c(1, 4, 3))
plot(x,
     y,
     log="x")
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot9.png"><img alt="Rplot9" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot9.png" width="694"></a><br><br><br>
In this example, you use the <a href="http://www.rdocumentation.org/packages/graphics/functions/par" target="_blank"><code>par()</code></a> function: you set <code>xlog</code> to <code>TRUE</code> and add the <code>xaxp</code> argument to give the coordinates of the extreme tick marks and the number of intervals between them. In this case, you set the minimal value to <code>1</code>, the maximal value to <code>4</code> and you add that the number of intervals between each tick mark should be <code>3</code>.
Then, you plot <code>x</code> and <code>y</code>, adding the <code>log</code> argument to specify whether to plot the x-or y-axis or both on a log scale. You can pass <code>"x"</code>, <code>"y"</code>, and <code>"xy"</code> as values to the log arguments to do this.
An example with both axes in logarithmic scale is:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">n &lt;- 1
x &lt;- seq(0, 20, 1)
y &lt;- exp(x)/(x)
par(xlog=TRUE,
    xaxp= c(1, 4, 3))
par(ylog=TRUE,
    yaxp= c(1, 11, 2))
plot(x,
     y,
     log="xy")
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot10.png"><img alt="Rplot10" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot10.png" width="694"></a><br><br><br></p>

<p></p>

<p></p>

<h3>How To Add Minor Tick Marks To An R Plot</h3>

<p>
You can quickly add minor tick marks to your plot with the <a href="http://www.rdocumentation.org/packages/Hmisc/functions/minor.tick" target="_blank"><code>minor.tick()</code></a> function from the <a href="http://www.rdocumentation.org/packages/Hmisc" target="_blank"><code>Hmisc</code></a> package:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot.new()
library(Hmisc)
minor.tick(nx = 1.5,
           ny = 2,
           tick.ratio=0.75)</code></pre>

<p></p>

<p></p>

<ul>
	<li>The <code>nx</code> argument allows you to specify the number of intervals in which you want to divide the area between the major tick marks on the axis. If you pass the value <code>1</code> to it, the minor tick marks will be suppressed;</li>
	
	<li>
	<code>ny</code> allows you to do the same as <code>nx</code>, but then for the y-axis;</li>
	
	<li>The <code>tick.ratio</code> indicates the ratio of lengths of minor tick marks to major tick marks. The length of the latter is retrieved from <code>par(tck=x)</code>.</li>
	
	
	 
</ul>

<p></p>

<p></p>

<h2>4. How To Create Two Different X- or Y-axes</h2>

<p>
The first option is to create a first plot and to execute the <a href="http://www.rdocumentation.org/packages/graphics/functions/par" target="_blank"><code>par()</code></a> function with the <code>new</code> argument put to <code>TRUE</code> to prevent R from clearing the graphics device:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">set.seed(101)
x &lt;- 1:10
y &lt;- rnorm(10)
z &lt;- runif(10, min=1000, max=10000)
plot(x, y)
par(new = TRUE)
</code></pre>

<p>
Then, you create the second plot with <a href="http://www.rdocumentation.org/packages/graphics/functions/plot" target="_blank"><code>plot()</code></a>. You make one of the type</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot(x,
     z,
     type = "l", #Plot with lines
     axes = FALSE, #No axes
     bty = "n", #Box about plot is suppressed
     xlab = "",  #No labels on x-and y-axis
     ylab = "")</code></pre>

<p><strong>Note</strong> that the with <code>axes</code> argument has been put to <code>FALSE</code>, while you also lave the x- and y-labels blank.
You also add a new axis on the right-hand side by adding the argument <code>side</code> and assigning it the value <code>4</code>.
Next, you specify the the <code>at</code> argument to indicate the points at which tick-marks need to be drawn. In this case, you compute a sequence of n+1 equally spaced “round” values which cover the range of the values in <code>z</code> with the <code>pretty()</code> function. This ensures that you actually have the numbers from the y-axis from your second plot, which you named <code>z</code>.
Lastly, you add an axis label on the right-hand side:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">axis(side=4,
     at = pretty(range(z)))
mtext("z",
      side=4,
      line=3)
</code></pre>

<p><strong>Note</strong> that the <code>side</code> argument can have three values assigned to it: <code>1</code> to place the text to the bottom, <code>2</code> for a left placement, <code>3</code> for a top placement and <code>4</code> to put the text to the right. The <code>line</code> argument indicates on which margin line the text starts.
The end result will be like this:<a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot11.png"><img alt="Rplot11" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot11.png" width="694"></a><br><br><br><strong>Tip:</strong> Try constructing an R plot with two different x-axes! You can find the solution below:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot.new()
set.seed(101)
x &lt;- 1:10
y &lt;- rnorm(10)
z &lt;- runif(10, min=1000, max=10000)
par(mar = c(5, 4, 4, 4) + 0.3)</code>
<code class="r">plot(x, y)
par(new = TRUE)
plot(z, y, type = "l", axes = FALSE, bty = "n", xlab = "", ylab = "")
axis(side=3, at = pretty(range(z)))
mtext("z", side=3, line=3)</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot12.png"><img alt="Rplot12" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot12.png" width="694"></a><br><br><br><strong>Note</strong> that <a href="http://www.rdocumentation.org/packages/plotrix/functions/twoord.plot" target="_blank"><code>twoord.plot()</code></a> of the plotrix package and <a href="http://www.rdocumentation.org/packages/latticeExtra/functions/doubleYScale" target="_blank"><code>doubleYScale()</code></a> of the latticeExtra package automate this process:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(latticeExtra)
chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
Age &lt;- chol$AGE
Chol &lt;- chol$CHOL
Smoke &lt;- chol$SMOKE
State &lt;- chol$MORT
a &lt;- xyplot(Chol ~ Age|State)
b &lt;- xyplot(Smoke ~ Age|State)
doubleYScale(a, b, style1 = 0, style2 = 3, add.ylab2 = TRUE, columns=3)</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot13.png"><img alt="Rplot13" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot13.png" width="694"></a><br><br><br><strong>Note</strong> that the example above is made with <a href="https://s3.amazonaws.com/assets.datacamp.com/blog_assets/chol.txt" target="_blank">this dataset</a>. If you're not sure how you can import your data, check out our tutorial on <a href="http://blog.datacamp.com/r-data-import-tutorial/" target="_blank">importing data in R</a>.</p>

<p></p>

<p></p>

<h2>5. How To Add Or Change The R Plot's Legend?</h2>

<p></p>

<p></p>

<h3>Adding And Changing An R Plot's Legend With Basic R</h3>

<p>
You can easily add a legend to your R plot with the <a href="http://www.rdocumentation.org/packages/graphics/functions/legend" target="_blank"><code>legend()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,pi,0.1)
y1 &lt;- cos(x)
y2 &lt;- sin(x)
plot(c(0,3), c(0,3), type="n", xlab="x", ylab="y")
lines(x, y1, col="red", lwd=2)
lines(x, y2, col="blue", lwd=2)
legend("topright",
       inset=.05,
       cex = 1,
       title="Legend",
       c("Cosinus","Sinus"),
       horiz=TRUE,
       lty=c(1,1),
       lwd=c(2,2),
       col=c("red","blue"),
       bg="grey96")
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot14.png"><img alt="Rplot14" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot14.png" width="694"></a><br><br><br><strong>Note</strong> that the arguments <code>pt.cex</code> and <code>title.cex</code> that are described in the documentation of <code>legend()</code> don't really work. There are some workarounds:
1.Put the title or the labels of the legend in a different font with <code>text.font</code></p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,pi,0.1)
y1 &lt;- cos(x)
y2 &lt;- sin(x)
plot(c(0,3), c(0,3), type="n", xlab="x", ylab="y")
lines(x, y1, col="red", lwd=2)
lines(x, y2, col="blue", lwd=2)
legend("topright",
       inset=.05,
       cex = 1,
       title="Legend",
       c("Cosinus","Sinus"),
       horiz=TRUE,
       lty=c(1,1),
       lwd=c(2,2),
       col=c("red","blue"),
       bg="grey96",
       text.font=3)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot15.png"><img alt="Rplot15" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot15.png" width="694"></a><br><br><br>
2. Draw the legend twice with different <code>cex</code> values</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,pi,0.1)
y1 &lt;- cos(x)
y2 &lt;- sin(x)
plot(c(0,3), c(0,3), type="n", xlab="x", ylab="y")
lines(x, y1, col="red", lwd=2)
lines(x, y2, col="blue", lwd=2)
legend("topright",
       inset=.05,
       c("Cosinus","Sinus"),
       title="",
       horiz=TRUE,
       lty=c(1,1),
       lwd=c(2,2),
       col=c("red","blue"))
legend(2.05, 2.97,
       inset=.05,
       c("",""),
       title="Legend",
       cex=1.15,
       bty="n")
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot16.png"><img alt="Rplot16" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot16.png" width="694"></a><br><br><br><strong>Tip:</strong> if you're interested in knowing more about the colors that you can use in R, check out <a href="http://www.stat.columbia.edu/%7Etzheng/files/Rcolor.pdf" target="_blank">this</a> very helpful PDF document.</p>

<p></p>

<p></p>

<h3>How To Add And Change An R Plot's Legend And Labels In <code>ggplot2</code>
</h3>

<p>
Adding a legend to your ggplot2 plot is fairly easy. You can just execute the following:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
library(ggplot2)
ggplot(chol, aes(x=chol$WEIGHT, y=chol$HEIGHT)) +
  geom_point(aes(colour = factor(chol$MORT), shape=chol$SMOKE)) +
  xlab("Weight") +
  ylab("Height")
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot17.png"><img alt="Rplot17" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot17.png" width="694"></a><br><br><br>
And it gives you a default legend. But, in most cases, you will want to adjust the appearance of the legend some more.
There are two ways of changing the legend title and labels in <a href="http://www.rdocumentation.org/packages/ggplot2" target="_blank"><code>ggplot2</code></a>:
1. If you have specified arguments such as <code>colour</code> or <code>shape</code>, or other aesthetics, you need to change the names and labels through <code>scale_color_discrete</code> and <code>scale_shape_discrete</code>, respectively:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
library(ggplot2)
ggplot(chol, aes(x=chol$WEIGHT, y=chol$HEIGHT)) +
  geom_point(aes(colour = factor(chol$MORT),
                 shape = chol$SMOKE)) +
  xlab("Weight") +
  ylab("Height") +
  theme(legend.position=c(1,0.5),
        legend.justification=c(1,1)) +
  scale_color_discrete(name ="Condition",
                       labels=c("Alive", "Dead")) +
  scale_shape_discrete(name="Smoker",
                       labels=c("Non-smoker", "Sigare", "Pipe" ))
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot18.png"><img alt="Rplot18" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot18.png" width="694"></a><br><br><br><strong>Note</strong> that you can create two legends if you add the argument <code>shape</code> into the <a href="http://www.rdocumentation.org/packages/ggplot2/functions/geom_point" target="_blank"><code>geom_point()</code></a> function and into the <code>labels</code> arguments!
If you want to move the legend to the bottom of the plot, you can specify the <code>legend.position</code> as <code>"bottom"</code>. The <code>legend.justification</code> argument, on the other hand, allows you to position the legend inside the plot.<strong>Tip:</strong> check out all kinds of scales that could be used to let ggplot know that other names and labels should be used <a href="http://www.cookbook-r.com/Graphs/Legends_%28ggplot2%29/" target="_blank">here</a>.
2. Change the data frame so that the factor has the desired form. For example:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
levels(chol$SMOKE)[levels(chol$SMOKE)=="Non-smoker"] &lt;- "Non-smoker"
levels(chol$SMOKE)[levels(chol$SMOKE)=="Sigare"] &lt;- "Sigare"
levels(chol$SMOKE)[levels(chol$SMOKE)=="Pipe"] &lt;- "Pipe"
names(chol)[names(chol)=="SMOKE"]  &lt;- "Smoker"
</code></pre>

<p>
You can then use the new factor names to make your plot in <a href="http://www.rdocumentation.org/packages/ggplot2" target="_blank">ggplot2</a>, avoiding the “hassle” of changing the names and labels with extra lines of code in your plotting.<strong>Tip:</strong> for a complete cheat sheet on ggplot2, you can go <a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/" target="_blank">here</a>.</p>

<p></p>

<p></p>

<h2>6. How To Draw A Grid In Your R Plot?</h2>

<p></p>

<p></p>

<h3>Drawing A Grid In Your R Plot With Basic R</h3>

<p>
For some purposes, you might find it necessary to include a grid in your plot. You can easily add a grid to your plot by using the <a href="http://www.rdocumentation.org/packages/graphics/functions/grid" target="_blank"><code>grid()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- c(1,2,3,4,5)
y &lt;- 2*x
plot(x,y)
grid(10,10)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot19.png"><img alt="Rplot19" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot19.png" width="694"></a><br><br><br></p>

<p></p>

<p></p>

<h3>Drawing A Grid In An R Plot With <code>ggplot2</code>
</h3>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
library(ggplot2)
ggplot(chol, aes(x=chol$WEIGHT, y=chol$HEIGHT)) +
  geom_point(aes(colour = factor(chol$MORT), shape = chol$SMOKE)) +
  xlab("Weight") +
  ylab("Height") +
  scale_color_discrete(name ="Condition", labels=c("Alive", "Dead")) +
  scale_shape_discrete(name="Smoker", labels=c("Non-smoker", "Sigare", "Pipe" )) +
  theme(legend.position=c(1,0.5),
        legend.justification=c(1,1),
        panel.grid.major = element_line(colour = "grey40"),
        panel.grid.minor = element_line(colour = "grey40"))
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot20.png"><img alt="Rplot20" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot20.png" width="694"></a><br><br><br><strong>Tip:</strong> if you don't want to have the minor grid lines, just pass <a href="http://www.rdocumentation.org/packages/ggplot2/functions/element_blank" target="_blank"><code>element_blank()</code></a> to <code>panel.grid.minor</code>. If you want to fill the background up with a color, add the <code>panel.background = element_rect(fill = "navy")</code> to your code, just like this:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(ggplot2)
ggplot(chol, aes(x=chol$WEIGHT, y=chol$HEIGHT)) +
  geom_point(aes(colour = factor(chol$MORT), shape = chol$SMOKE)) +
  xlab("Weight") +
  ylab("Height") +
  scale_color_discrete(name ="Condition", labels=c("Alive", "Dead")) +
  scale_shape_discrete(name="Smoker", labels=c("Non-smoker", "Sigare", "Pipe" )) +
  theme(legend.position=c(1,0.5),
        legend.justification=c(1,1),
        panel.grid.major = element_line(colour = "grey40"),
        panel.grid.minor = element_line(colour = "grey40"),
        panel.background = element_rect(fill = "navy")
        )
</code></pre>

<p></p>

<p></p>

<h2>7. How To Draw A Plot With A PNG As Background?</h2>

<p>
You can quickly draw a plot with a .png as a background with the help of the <a href="http://www.rdocumentation.org/packages/png" target="_blank"><code>png</code></a> package. You install the package if you need to, activate it for use in your workspace through the library function <code>library()</code> and you can start plotting!</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">install.packages("png")
library(png)
</code></pre>

<p>
First, you want to load in the image. Use the <a href="http://www.rdocumentation.org/packages/png/functions/readPNG" target="_blank"><code>readPNG()</code></a> function to specify the path to the picture!</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">image &lt;- readPNG("&lt;path to your picture&gt;")
</code></pre>

<p><strong>Tip:</strong> you can check where your working directory is set at and change it by executing the following commands:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">getwd()
setwd("&lt;path to a folder&gt;")
</code></pre>

<p>
If your picture is saved in your working directory, you can just specify <code>readPNG("picture.png")</code> instead of passing the whole path.
Next, you want to set up the plot area:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot(1:2, type='n', main="Plotting Over an Image", xlab="x", ylab="y")
</code></pre>

<p>
And you want to call the <code>par()</code> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">lim &lt;- par()
</code></pre>

<p>
You can use the <code>par()</code> function to set the graphical parameters in <a href="http://www.rdocumentation.org/packages/graphics/functions/rasterImage" target="_blank"><code>rasterImage()</code></a>. You use the argument <code>usr</code> to define the extremes of the user coordinates of the plotting region. In this case, you put <code>1</code>, <code>3</code>, <code>2</code> and <code>4</code>:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">rasterImage(image, lim$usr[1], lim$usr[3], lim$usr[2], lim$usr[4])
</code></pre>

<p>
Next, you draw a grid and add some lines:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">grid()
lines(c(1, 1.2, 1.4, 1.6, 1.8, 2.0), c(1, 1.3, 1.7, 1.6, 1.7, 1.0), type="b", lwd=5, col="red")
</code></pre>

<p>
This can give you the following result if you use the DataCamp logo:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(png)
image &lt;- readPNG("datacamp.png")
plot(1:2, type="n", main="Plotting Over an Image", xlab="x", ylab="y", asp=1)
lim &lt;- par()
rasterImage(image, lim$usr[1], lim$usr[3], lim$usr[2], lim$usr[4])
lines(c(1, 1.2, 1.4, 1.6, 1.8, 2.0), c(1.5, 1.3, 1.7, 1.6, 1.7, 1.0), type="b", lwd=5, col="red")
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot21.png"><img alt="Rplot21" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot21.png" width="694"></a><br><br><br><strong>Note</strong> that you need to give a .png file as input to <code>readPNG()</code>!</p>

<p></p>

<p></p>

<h2>8. How To Adjust The Size Of Points In An R Plot?</h2>

<p></p>

<p></p>

<h3>Adjusting The Size Of Points In An R Plot With Basic R</h3>

<p>
To adjust the size of the points with basic R, you might just simply use the <code>cex</code> argument:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- c(1,2,3,4,5)
y &lt;- c(6,7,8,9,10)
plot(x,y,cex=2,col="red")
</code></pre>

<p><strong>Remember</strong>, however, that that R allows you to have much more control over your symbols through the function <a href="http://www.rdocumentation.org/packages/graphics/functions/symbols" target="_blank"><code>symbols()</code></a>:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">df &lt;- data.frame(x1=1:10,
                 x2=sample(10:99, 10),
                 x3=10:1)
symbols(x=df$x1,
        y=df$x2,
        circles=df$x3,
        inches=1/3,
        ann=F,
        bg="steelblue2",
        fg=NULL)
</code></pre>

<p>
The circles of this plot receive the values of <code>df$x3</code> as the radii, while the argument <code>inches</code> controls the size of the symbols. When this argument receives a positive number as input, the symbols are scaled to make largest dimension this size in inches.</p>

<p></p>

<p></p>

<h3>Adjusting The Size Of Points In Your R Plot With <code>ggplot2</code>
</h3>

<p>
In this case, you will want to adjust the size of the points in your scatterplot. You can do this with the <code>size</code> argument:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
ggplot(chol,
       aes(x=chol$WEIGHT, y=chol$HEIGHT),
       size = 2) +
  geom_point()
#or
ggplot(chol,
       aes(x=chol$WEIGHT, y=chol$HEIGHT)) +
  geom_point(size = 2)
</code></pre>

<p></p>

<p></p>

<h2>9. How To Fit A Smooth Curve To Your R Data</h2>

<p>
The <a href="http://www.rdocumentation.org/packages/stats/functions/loess" target="_blank"><code>loess()</code></a> function is probably every R programmer's favorite solution for this kind of question. It actually “fits a polynomial surface determined by one or more numerical predictors, using local fitting”.
In short, you have your data:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- 1:10
y &lt;- c(2,4,6,8,7,12,14,16,18,20)
</code></pre>

<p>
And you use the <a href="http://www.rdocumentation.org/packages/stats/functions/loess" target="_blank"><code>loess()</code></a> function, in which you correlate y and x. Through this, you specify the numeric response and one to four numeric predictors:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">lo &lt;- loess(y~x) ### estimations between data
</code></pre>

<p>
You plot x and y:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot(x,y)
</code></pre>

<p>
And you plot lines in the original plot where you predict the values of <code>lo</code>:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">lines(predict(lo))
</code></pre>

<p>
Which gives you the following plot:<a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot22.png"><img alt="Rplot22" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot22.png" width="694"></a><br><br><br></p>

<p></p>

<p></p>

<h2>10. How To Add Error Bars In An R Plot</h2>

<p></p>

<p></p>

<h3>Drawing Error Bars With Basic R</h3>

<p>
The bad news: R can't draw error bars just like that. The good news: you can still draw the error bars without needing to install extra packages!</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">#Load the data
chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
#Calculate some statistics for the chol dataset
library(Rmisc)
cholc &lt;- summarySE(chol,
                   measurevar="CHOL",
                   groupvars=c("MORT","SMOKE"))
#Plot the data
plot(cholc$N,
     cholc$CHOL,
     ylim=range(c(cholc$CHOL-cholc$sd, cholc$CHOL+cholc$sd)),
     pch=19,
     xlab="Cholesterol Measurements",
     ylab="Cholesterol Mean +/- SD",
     main="Scatterplot With sd Error Bars"
)

#Draw arrows of a "special" type
arrows(cholc$N,
       cholc$CHOL-cholc$sd,
       cholc$N,
       cholc$CHOL+cholc$sd,
       length=0.05,
       angle=90,
       code=3)
</code></pre>

<p>
If you want to read up on all the arguments that <code>arrows()</code> can take, go <a href="http://www.rdocumentation.org/packages/graphics/functions/arrows" target="_blank">here</a>.</p>

<p></p>

<p></p>

<h3>Drawing Error Bars With <code>ggplot2</code>
</h3>

<p></p>

<p></p>

<h4>Error Bars Representing Standard Error Of Mean</h4>

<p>
First summarize your data with the <a href="http://www.rdocumentation.org/packages/Rmisc/functions/summarySE" target="_blank"><code>summarySE()</code></a> function from the <a href="http://www.rdocumentation.org/packages/Rmisc" target="_blank">Rmisc</a> package:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">#Load in the data
chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
#Calculate some statistics for the chol dataset
library(Rmisc)
cholc &lt;- summarySE(chol,
                   measurevar="CHOL",
                   groupvars=c("MORT","SMOKE"))
</code></pre>

<p>
Then, you can use the resulting dataframe to plot some of the variables, drawing error bars for them at the same time, with, for example, the standard error of mean:<a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot23.png"><img alt="Rplot23" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot23.png" width="694"></a><br><br><br>
If you want to change the position of the error bars, for example, when they overlap, you might consider using the <a href="http://www.rdocumentation.org/packages/ggplot2/functions/position_dodge" target="_blank"><code>position_dodge()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">#Load in the data
chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
#Calculate some statistics for the chol dataset
library(Rmisc)
cholc &lt;- summarySE(chol,
                   measurevar="CHOL",
                   groupvars=c("MORT","SMOKE"))
#Plot the cholc dataset
library(ggplot2)
pd &lt;- position_dodge(0.1)
ggplot(cholc, aes(x=SMOKE, y=CHOL, colour=MORT)) +
    geom_errorbar(aes(ymin=CHOL-se, ymax=CHOL+se, group=MORT),
                  width=.1,
                  position=pd) +
    geom_line(aes(group=MORT)) +
    geom_point()
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot24.png"><img alt="Rplot24" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot24.png" width="694"></a><br><br><br><strong>Tip:</strong> if you get an error like “geom_path: Each group consist of only one observation. Do you need to adjust the group aesthetic?”, it usually requires you to adjust the group aesthetic.</p>

<p></p>

<p></p>

<h4>Error Bars Representing Confidence Intervals</h4>

<p>
Continuing from the summary of your data that you made with the <a href="http://www.rdocumentation.org/packages/Rmisc/functions/summarySE" target="_blank"><code>summarySE()</code></a> function, you can also draw error bars that represent confidence intervals. In this case, a plot with error bars of 95% confidence are plotted.</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">#Load in the data
chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
#Calculate some statistics for the chol dataset
library(Rmisc)
cholc &lt;- summarySE(chol,
                   measurevar="CHOL",
                   groupvars=c("MORT","SMOKE"))
#Plot the cholc dataset
library(ggplot2)
pd &lt;- position_dodge(0.1)
ggplot(cholc, aes(x=SMOKE, y=CHOL, colour=MORT)) +
    geom_errorbar(aes(ymin=CHOL-ci, ymax=CHOL+ci, group=MORT),
                  width=.1,
                  colour="black",
                  position=pd) +
    geom_line(aes(group=MORT)) +
    geom_point()
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot25.png"><img alt="Rplot25" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot25.png" width="694"></a><br><br><br><strong>Note</strong> how the color of the error bars is now set to black with the <code>colour</code> argument.</p>

<p></p>

<p></p>

<h4>Error Bars Representing The Standard Deviation</h4>

<p>
Lastly, you can also use the results of the <a href="http://www.rdocumentation.org/packages/Rmisc/functions/summarySE" target="_blank"><code>summarySE()</code></a> function to plot error bars that represent the standard deviation. Specifically, you would just have to adjust the <code>ymin</code> and <code>ymax</code> arguments that you pass to <code>geom_errorbar()</code>:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">#Load in the data
chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
#Calculate some statistics for the chol dataset
library(Rmisc)
cholc &lt;- summarySE(chol,
                   measurevar="CHOL",
                   groupvars=c("MORT","SMOKE"))
#Plot the cholc dataset
library(ggplot2)
pd &lt;- position_dodge(0.1)
ggplot(cholc, aes(x=SMOKE, y=CHOL, colour=MORT)) +
    geom_errorbar(aes(ymin=CHOL-sd, ymax=CHOL+sd, group=MORT),
                  width=.1,
                  position=pd) +
    geom_line(aes(group=MORT)) +
    geom_point()
</code></pre>

<p><strong>Big tip:</strong> also take a look at <a href="http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_%28ggplot2%29/" target="_blank">this</a> for more detailed examples on how to plot means and error bars.</p>

<p></p>

<p></p>

<h2>11. How To Save A Plot As An Image On Disc</h2>

<p>
You can use <a href="http://www.rdocumentation.org/packages/grDevices/functions/dev2" target="_blank">dev.copy()</a> to copy your graph, made in the current graphics device to the device or folder specified by yourself.</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,y)
dev.copy(jpeg,
         filename="&lt;path to your file/name.jpg&gt;");
dev.off();
(x)
(y)
</code></pre>

<p></p>

<p></p>

<h2>12. How To Plot Two R Plots Next To Each Other?</h2>

<p></p>

<p></p>

<h3>How To Plot Two Plots Side By Side Using Basic R</h3>

<p>
You can do this with basic R commands:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">d0 &lt;- matrix(rnorm(15), ncol=3)
d1 &lt;- matrix(rnorm(15), ncol=3)

limits &lt;- range(d0,d1) #Set limits

par(mfrow = c(1, 2))
boxplot(d0,
        ylim=limits)
boxplot(d1,
        ylim=limits)
</code></pre>

<p>
By adding the <a href="http://www.rdocumentation.org/packages/graphics/functions/par" target="_blank"><code>par()</code></a> function with the <code>mfrow</code> argument, you specify a vector, which in this case contains 1 and 2: all figures will then be drawn in a 1-by-2 array on the device by rows (<code>mfrow</code>). In other words, the boxplots from above will be printed in one row inside two columns.</p>

<p></p>

<p></p>

<h3>How To Plot Two Plots Next To Each Other Using <code>ggplot2</code>
</h3>

<p>
If you want to put plots side by side and if you don't want to specify limits, you can consider using the <a href="http://www.rdocumentation.org/packages/ggplot2" target="_blank"><code>ggplot2</code></a> package to draw your plots side-by-side:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">#Load in the data
chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
#Calculate some statistics for the chol dataset
library(Rmisc)
cholc &lt;- summarySE(chol,
                   measurevar="CHOL",
                   groupvars=c("MORT","SMOKE"))
#Plot the cholc dataset
library(ggplot2)
ggplot(cholc, aes(x=SMOKE, y=CHOL, colour=MORT)) +
  geom_errorbar(aes(ymin=CHOL-sd, ymax=CHOL+sd, group=MORT),
                width=.1,
                position=pd) +
  geom_line(aes(group=MORT)) +
  geom_point() +
  facet_grid(. ~ MORT)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot26.png"><img alt="Rplot26" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot26.png" width="694"></a><br><br><br><strong>Note</strong> how you just add the <a href="http://www.rdocumentation.org/packages/ggplot2/functions/facet_grid" target="_blank"><code>facet_grid()</code></a> function to indicate that you want two plots next to each other. The element that is used to determine how the plots are drawn, is <code>MORT</code>, as you can well see above!</p>

<p></p>

<p></p>

<h3>How To Plot More Plots Side By Side Using <code>gridExtra</code>
</h3>

<p>
To get plots printed side by side, you can use the <a href="http://www.rdocumentation.org/packages/gridExtra" target="_blank"><code>gridExtra</code></a> package; Make sure you have the package installed and activated in your workspace and then execute something like this:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(gridExtra)
plot1 &lt;- qplot(1)
plot2 &lt;- qplot(1)
grid.arrange(plot1,
             plot2,
             ncol=2)
</code></pre>

<p><strong>Note</strong> how here again you determine how the two plots will appear to you thanks to the <code>ncol</code> argument.</p>

<p></p>

<p></p>

<h3>How To Plot More Plots Side By Side Using <code>lattice</code>
</h3>

<p>
Just like the solution with <a href="http://www.rdocumentation.org/packages/ggplot2" target="_blank"><code>ggplot2</code></a> package, the <a href="http://www.rdocumentation.org/packages/caret/functions/lattice" target="_blank"><code>lattice</code></a> package also doesn't require you to specify limits or the way you want your plots printed next to each other.
Instead, you use <a href="http://www.rdocumentation.org/packages/lattice/functions/xyplot" target="_blank"><code>bwplot()</code></a> to make trellis graphs with the graph type of a box plot. <strong>Trellis graphs</strong> display a variable or the relationship between variables, conditioned on one or more other variables.
In this case, if you're using the <code>chol</code> data set (which you can find <a href="https://s3.amazonaws.com/assets.datacamp.com/blog_assets/chol.txt" target="_blank">here</a> or load in with the <code>read.table()</code> function given below), you display the variable <code>CHOL</code> separately for every combination of factor <code>SMOKE</code> and <code>MORT</code> levels:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">#Load in the data
chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
#Plot two plots side by side
library(lattice)
bwplot(~ CHOL|SMOKE+MORT,
       chol)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot27.png"><img alt="Rplot27" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot27.png" width="694"></a><br><br><br></p>

<p></p>

<p></p>

<h3>Plotting Plots Next To Each Other With <code>gridBase</code>
</h3>

<p>
Another way even to put two plots next to each other is by using the <a href="http://www.rdocumentation.org/packages/gridBase" target="_blank"><code>gridBase</code></a> package, which takes care of the “integration of base and grid graphics”. This could be handy when you want to put a basic R plot and a ggplot next to each other.
You work as follows: first, you activate the necessary packages in your workspace. In this case, you want to have <a href="http://www.rdocumentation.org/packages/gridBase" target="_blank"><code>gridBase</code></a> ready to put the two plots next to each other and <a href="http://www.rdocumentation.org/packages/grid" target="_blank"><code>grid</code></a> and <a href="http://www.rdocumentation.org/packages/ggplot2" target="_blank"><code>ggplot2</code></a> to actually make your plots:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(grid)
library(gridBase)
library(ggplot2)
plot.new()
gl &lt;- grid.layout(nrow=1,
                  ncol=2)
vp.1 &lt;- viewport(layout.pos.col=1,
                 layout.pos.row=1)
vp.2 &lt;- viewport(layout.pos.col=2,
                 layout.pos.row=1)
pushViewport(viewport(layout=gl))
pushViewport(vp.1)
par(new=TRUE,
    fig=gridFIG())
plot(x = 1:10,
     y = 10:1)
popViewport()
pushViewport(vp.2)
ggplotted &lt;- qplot(x=1:10,y=10:1, 'point')
print(ggplotted, newpage = FALSE)
popViewport(1)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot28.png"><img alt="Rplot28" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot28.png" width="694"></a><br><br><br>
If you want and need it, you can start an empty plot:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">plot.new()
</code></pre>

<p>
To then set up the layout:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">gl &lt;- grid.layout(nrow=1,
                  ncol=2)
</code></pre>

<p><strong>Note</strong> that since you want the two plots to be generated next to each other, this requires you to make a grid layout consisting of one row and two columns.
Now, you want to fill up the cells of the grid with viewports. These define rectangular regions on your graphics device with the help of coordinates within those regions. In this case, it's much more handy to use the specifications of the grid that have just been described above rather than real x-or y-coordinates. That is why you should use the <code>layout.pos.col</code> and <code>layout.pos.row</code> arguments:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">vp.1 &lt;- viewport(layout.pos.col=1,
                 layout.pos.row=1)
vp.2 &lt;- viewport(layout.pos.col=2,
                 layout.pos.row=1)
</code></pre>

<p><strong>Note</strong> again that since you want the two plots to be generated next to each other, you want to put one plot in the first column and the other in the second column, both located on the first row.
Since the viewports are only descriptions or definitions, these kinds of objects need to be pushed onto the viewport tree before you can see any effect on the drawing. You want to use the <a href="http://www.rdocumentation.org/packages/grid/functions/viewports.html" target="_blank"><code>pushViewport()</code></a> function to accomplish this:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">pushViewport(viewport(layout=gl))
</code></pre>

<p><strong>Note</strong> the <a href="http://www.rdocumentation.org/packages/grid/functions/viewports.html" target="_blank"><code>pushViewport()</code></a> function takes the <a href="http://www.rdocumentation.org/packages/grid/functions/viewport" target="_blank"><code>viewport()</code></a> function, which in itself contains a <code>layout</code> argument. This last argument indicates “a grid layout object which splits the viewport into subregions”.<strong>Remember</strong> that you started out making one of those objects.
Now you can proceed to adding the first rectangular region <code>vp.1</code> to the ViewPort tree:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">pushViewport(vp.1)
</code></pre>

<p>
After which you tell R with <a href="http://www.rdocumentation.org/packages/gridBase/functions/gridOMI" target="_blank"><code>gridFig()</code></a> to draw a base plot within a grid viewport (<code>vp.1</code>, that is). The <code>fig</code> argument normally takes the coordinates of the figure region in the display region of the device. In this case, you use the <code>fig</code> argument to start a new plot, adding it to an existing plot use by adding <code>new = TRUE</code> in the <a href="http://www.rdocumentation.org/packages/graphics/functions/par" target="_blank"><code>par()</code></a> function as well. You plot the base graphic and remove the viewport from the tree:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">par(new=TRUE,
    fig=gridFIG())
plot(x = 1:10,
     y = 10:1)
popViewport()
</code></pre>

<p><strong>Note</strong> that you can specify in the <a href="http://www.rdocumentation.org/packages/grid/functions/viewports.html" target="_blank"><code>popViewport()</code></a> function an argument to indicate how many viewports you want to remove from the tree. If this value is 0, this indicates that you want to remove the viewports right up to the root viewport. The default value of this argument is 1.
Go to add the second rectangular region <code>vp.2</code> to the ViewPort tree. You can then make the ggplot and remove the viewport from the tree.</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">pushViewport(vp.2)
ggplotted &lt;- qplot(x=1:10,
                   y=10:1,
                   'point')
print(ggplotted,
      newpage = FALSE)
popViewport(1)
</code></pre>

<p><strong>Note</strong> that you need to print to print the graphics object made by <a href="http://www.rdocumentation.org/packages/evir/functions/qplot" target="_blank"><code>qplot()</code></a> in order to actually draw it and get it displayed. At the same time, you also want to specify <code>newpage = FALSE</code>, otherwise you'll only see the <a href="http://www.rdocumentation.org/packages/evir/functions/qplot" target="_blank"><code>qplot()</code></a>…
Also <strong>remember</strong> that the default value of viewports to remove in the function <a href="http://www.rdocumentation.org/packages/grid/functions/viewports.html" target="_blank"><code>popViewport()</code></a> is set at 1. This makes it kind of redundant to put <code>popViewport(1)</code> in the code.</p>

<p></p>

<p></p>

<h2>13. How To Plot Multiple Lines Or Points?</h2>

<p></p>

<p></p>

<h3>Using Basic R To Plot Multiple Lines Or Points In The Same R Plot</h3>

<p>
To plot two or more graphs in the same plot, you basically start by making a usual basic plot in R. An example of this could be:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,pi,0.1)
y1 &lt;- cos(x)
plot(x,
     y1,
     type="l",
     col = "red")
</code></pre>

<p>
Then, you start adding more lines or points to the plot. In this case, you add more lines to the plot, so you'll define more y axes:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">y2 &lt;- sin(x)
y3 &lt;- tan(x)
y4 &lt;- log(x)
</code></pre>

<p>
Then, you plot these y axes with the use of the <a href="http://www.rdocumentation.org/packages/compositions/functions/lines" target="_blank"><code>lines()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">lines(x,y2,col="green")
lines(x,y2,col="green")
lines(x,y3,col="black")
lines(x,y4,col="blue")
</code></pre>

<p>
This gives the following result:<a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot29.png"><img alt="Rplot29" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot29.png" width="694"></a><br><br><br><strong>Note</strong> that the <a href="http://www.rdocumentation.org/packages/compositions/functions/lines" target="_blank"><code>lines()</code></a> function takes in three arguments: the x-axis and the y-axis that you want to plot and the color (represented with the argument <code>col</code>) in which you want to plot them. You can also include the following features:</p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<table>
	<thead>
		<tr>
			<th>Feature</th>
			<th>Argument</th>
			<th>Input</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Line type</td>
			<td><code>lty</code></td>
			<td>Integer or character string</td>
		</tr>
		<tr>
			<td>Line width</td>
			<td><code>lwd</code></td>
			<td>Integer</td>
		</tr>
		<tr>
			<td>Plot type</td>
			<td><code>pch</code></td>
			<td>Integer or single character</td>
		</tr>
		<tr>
			<td>Line end style</td>
			<td><code>lend</code></td>
			<td>Integer or string</td>
		</tr>
		<tr>
			<td>Line join style</td>
			<td><code>ljoin</code></td>
			<td>Integer or string</td>
		</tr>
		<tr>
			<td>Line mitre limit</td>
			<td><code>lmitre</code></td>
			<td>Integer &lt; 1</td>
		</tr>
	</tbody>
</table>

<p>
Here are some examples:</p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">lines(x,y2,col="green", lty = 2, lwd = 3)
lines(x,y2,col="green", lty = 5, lwd = 2, pch = 2)
lines(x,y3,col="black", lty = 3, lwd = 5, pch = 3, lend = 0, ljoin = 2)
lines(x,y4,col="blue", lty = 1, lwd = 2, pch = 3, lend = 2, ljoin = 1, lmitre = 2)
</code></pre>

<p><strong>Note</strong> that the <code>pch</code> argument does not function all that well with the <a href="http://www.rdocumentation.org/packages/compositions/functions/lines" target="_blank"><code>lines()</code></a> function and that it's best to use it only with <a href="http://www.rdocumentation.org/packages/graphics/functions/points" target="_blank"><code>points()</code></a>.<strong>Tip:</strong> if you want to plot points in the same graph, you can use the <a href="http://www.rdocumentation.org/packages/graphics/functions/points" target="_blank"><code>points()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">y5 &lt;- x^3
points(x,
       y5,
       col="yellow")
</code></pre>

<p>
You can add the same arguments to the <a href="http://www.rdocumentation.org/packages/graphics/functions/points" target="_blank"><code>points()</code></a> function as you did with the <a href="http://www.rdocumentation.org/packages/compositions/functions/lines" target="_blank"><code>lines()</code></a> function and that are listed above. There are some additions, though:</p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<table>
	<thead>
		<tr>
			<th>Feature</th>
			<th>Argument</th>
			<th>Input</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Background (fill) color</td>
			<td><code>bg</code></td>
			<td>Only if <code>pch = 21:25</code>
</td>
		</tr>
		<tr>
			<td>Character (or symbol) expansion</td>
			<td><code>cex</code></td>
			<td>Integer</td>
		</tr>
	</tbody>
</table>

<p>
Code examples of these arguments are the following:</p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">points(x,y4,col="blue", pch=21, bg = "red")
points(x, y5, col="yellow", pch = 5, bg = "blue")
</code></pre>

<p>
If you incorporate these changes into the plot that you see above, you will get the following result:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,pi,0.1)
y1 &lt;- cos(x)
plot(x,y1,type="l" ,col = "red") #basic graphical object
y2 &lt;- sin(x)
y3 &lt;- tan(x)
y4 &lt;- log(x)
y5 &lt;- x^3
lines(x,y2,col="green", lty = 1, lwd = 3) #first layer
lines(x,y2,col="green", lty = 3, lwd = 2, pch = 2) #second layer
lines(x,y3,col="black", lty = 2, lwd = 1, pch = 3, lend = 0, ljoin = 2) #third layer
points(x,y4,col="blue", pch=21, bg = "red") #fourth layer
points(x, y5, col="yellow", pch = 24, bg = "blue") #fifth layer
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot30.png"><img alt="Rplot30" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot30.png" width="694"></a><br><br><br></p>

<p></p>

<p></p>

<h3>Using <code>ggplot2</code> To Plot Multiple Lines Or Points In One R Plot</h3>

<p>
The <a href="http://www.rdocumentation.org/packages/ggplot2" target="_blank"><code>ggplot2</code></a> package conveniently allows you to also create layers, which allows you to basically plot two or more graphs into the same R plot without any difficulties and pretty easily:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(ggplot2)
x &lt;- 1:10
y1 &lt;- c(2,4,6,8,7,12,14,16,18,20)
y2 &lt;- rnorm(10, mean = 5)
df &lt;- data.frame(x, y1, y2)
ggplot(df, aes(x)) +  # basic graphical object
  geom_line(aes(y=y1),
            colour="red") +  # first layer
  geom_line(aes(y=y2),      # second layer
            colour="green")  </code></pre>

<p></p>

<p></p>

<h2>14. How To Fix The Aspect Ratio For Your R Plots</h2>

<p>
If you want to put your R plot to be saved as an image where the axes are proportional to their size, it's a sign that you want to fix the aspect ratio.</p>

<p></p>

<p></p>

<h3>Adjusting The Aspect Ratio With Basic R</h3>

<p>
When you're working with basic R commands to produce your plots, you can add the argument <code>asp</code> of the <a href="http://www.rdocumentation.org/packages/graphics/functions/plot" target="_blank"><code>plot()</code></a> function, completed with an integer, to set your aspect ratio. Look at this first example without a defined aspect ratio:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,y)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot31.png"><img alt="Rplot31" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot31.png" width="694"></a><br><br><br>
And compare this now to the plot where the aspect ratio is defined with the argument <code>asp</code>:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">x &lt;- seq(0,2*pi,0.1)
y &lt;- sin(x)
plot(x,
     y,
     asp=2)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot32.png"><img alt="Rplot32" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot32.png" width="694"></a><br><br><br></p>

<p></p>

<p></p>

<h3>Adjusting The Aspect Ratio For Your Plots With <code>ggplot2</code>
</h3>

<p>
To fix the aspect ratio for ggplot2 plots, you just add the function <a href="http://www.rdocumentation.org/packages/ggplot2/functions/coord_fixed" target="_blank"><code>coord_fixed()</code></a>, which provides a “fixed scale coordinate system [that] forces a specified ratio between the physical representation of data units on the axes”.
In other words, this function allows you to specify a number of units on the y-axis which is equivalent to one unit on the x-axis. The default is always set at 1, which means that one unit on the x-axis has the same length as one unit on the y-axis. If your ratio is set at a higher value, the units on the y-axis are longer than units on the x-axis and vice versa.
Compare the following examples:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(ggplot2)
df &lt;- data.frame(
  x = runif(100, 0, 5),
  y = runif(100, 0, 5))

ggplot(df, aes(x=x, y=y)) + geom_point()
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot33.png"><img alt="Rplot33" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot33.png" width="694"></a><br><br><br>
versus</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(ggplot2)
df &lt;- data.frame(
  x = runif(100, 0, 5),
  y = runif(100, 0, 5))

ggplot(df, aes(x=x, y=y)) +
  geom_point() +
  coord_fixed(ratio=1)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot34.png"><img alt="Rplot34" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot34.png" width="694"></a><br><br><br></p>

<p></p>

<p></p>

<h3>Adjusting The Aspect Ratio For Your Plots With <code>MASS</code>
</h3>

<p>
You can also consider using the <a href="http://www.rdocumentation.org/packages/MASS" target="_blank">MASS</a> package, which encompasses the <a href="http://www.rdocumentation.org/packages/MASS/functions/eqscplot" target="_blank"><code>eqscplot()</code></a> function: it produces plots with geometrically equal scales. It does this for scatterplots:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">chol &lt;- read.table(url("http://assets.datacamp.com/blog_assets/chol.txt"), header = TRUE)
library(MASS)
x = chol$HEIGHT
y = chol$WEIGHT
z = as.numeric(chol$MORT)

eqscplot(x,
         y,
         ratio = 1,
         col=c("red", "green"),
         pch=c(1,2))
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot35.png"><img alt="Rplot35" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot35.png" width="694"></a><br><br><br><strong>Tip:</strong> you might do well starting a new plot frame before executing the code above!<strong>Note</strong> that you can give additional arguments to the <a href="http://www.rdocumentation.org/packages/MASS/functions/eqscplot" target="_blank"><code>eqscplot()</code></a> function to customize the scatterplot's look!</p>

<p></p>

<p></p>

<h2>15. What Is The Function Of <code>hjust</code> And <code>vjust</code> In <code>ggplot2</code>?</h2>

<p>
Well, you basically use these arguments when you want to set the position of text in your ggplot. <code>hjust</code> allows you to define the horizontal justification, while <code>vjust</code> is meant to control the vertical justification. See the documentation on <a href="http://www.rdocumentation.org/packages/ggplot2/functions/geom_text" target="_blank"><code>geom_text()</code></a> for more information.
To demonstrate what exactly happens, you can create a data frame from all combinations of factors with the <a href="http://www.rdocumentation.org/packages/base/functions/expand.grid" target="_blank"><code>expand.grid()</code></a> function:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">hjustvjust &lt;- expand.grid(hjust=c(0, 0.5, 1),
                          vjust=c(0, 0.5, 1),
                          angle=c(0, 45, 90),
                          text="Text"
                          )
</code></pre>

<p><strong>Note</strong> that <code>hjust</code> and <code>vjust</code> can only take values between <code>0</code> and <code>1</code>.</p>

<p></p>

<p></p>

<ul>
	<li>
	<code>0</code> means that the text is left-justified; In other words, all text is aligned to the left margin. This is usually what you see when working with text editors such as Word.</li>
	
	<li>
	<code>1</code> means that the text is right-justified: all text is aligned to the right margin.</li>
	
	
	 
</ul>

<p>
Then, you can plot the data frame that you have just made above with the <a href="http://www.rdocumentation.org/packages/ggplot2/functions/ggplot" target="_blank"><code>ggplot()</code></a> function, defining the x-and y-axis as “hjust” and “vjust” respectively:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">library(ggplot2)
ggplot(hjustvjust, aes(x=hjust, y=vjust)) +
    geom_point() +
    geom_text(aes(label=text,
                  angle=angle,
                  hjust=hjust,
                  vjust=vjust)) +
    facet_grid(~angle) +
    scale_x_continuous(breaks=c(0, 0.5, 1),
                       expand=c(0, 0.2)) +
    scale_y_continuous(breaks=c(0, 0.5, 1),
                       expand=c(0, 0.2))
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot36.png"><img alt="Rplot36" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot36.png" width="694"></a><br><br><br>
Also <strong>note</strong> how the <code>hjust</code> and <code>vjust</code> arguments are added to <code>geom_text()</code>, which takes care of the textual annotations to the plot.
In the plot above you see that the text at the point (0,0) is left-aligned, horizontally as well as vertically. On the other hand, the text at point (1,1) is right-aligned in horizontal as well as vertical direction. The point (0.5,0.5) is right in the middle: it's not really left-aligned nor right-aligned for what concerns the horizontal and vertical directions.<strong>Note</strong> that when these arguments are defined to change the axis text, the horizontal alignment for axis text is defined in relation to the entire plot, not to the x-axis!</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">DF &lt;- data.frame(x=LETTERS[1:3],
                 y=1:3)
p &lt;- ggplot(DF, aes(x,y)) +
  geom_point() +
  ylab("Very long label for y") +
  theme(axis.title.y=element_text(angle=0))


p1 &lt;- p + theme(axis.title.x=element_text(hjust=0)) + xlab("X-axis at hjust=0")
p2 &lt;- p + theme(axis.title.x=element_text(hjust=0.5)) + xlab("X-axis at hjust=0.5")
p3 &lt;- p + theme(axis.title.x=element_text(hjust=1)) + xlab("X-axis at hjust=1")

library(gridExtra)
grid.arrange(p1, p2, p3)
</code></pre>

<p><a href="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot37.png"><img alt="Rplot37" class="wp-image-620 size-full aligncenter" height="396" src="http://blog.datacamp.com/wp-content/uploads/2015/07/Rplot37.png" width="694"></a><br><br><br>
Also try for yourself what defining the <code>vjust</code> agument to change the axis text does to the representation of your plot:</p>

<p></p>

<p></p>

<pre class="pre-no-padding">
<code class="r">DF &lt;- data.frame(x=c("a\na","b","cdefghijk","l"),
                 y=1:4)
p &lt;- ggplot(DF, aes(x,y)) + geom_point()

p1 &lt;- p + theme(axis.text.x=element_text(vjust=0, colour="red")) +
        xlab("X-axis labels aligned with vjust=0")
p2 &lt;- p + theme(axis.text.x=element_text(vjust=0.5, colour="red")) +
        xlab("X-axis labels aligned with vjust=0.5")
p3 &lt;- p + theme(axis.text.x=element_text(vjust=1, colour="red")) +
        xlab("X-axis labels aligned with vjust=1")


library(gridExtra)
grid.arrange(p1,p2,p3)
</code></pre>

<p>
To go to the original excellent discussion, from which the code above was adopted, click <a href="http://stackoverflow.com/questions/7263849/what-do-hjust-and-vjust-do-when-making-a-plot-using-ggplot" target="_blank">here</a>.</p>

<p></p>

<p></p>

<h2>As A Last Note…</h2>

<p>
It's really worth checking out <a href="http://blog.revolutionanalytics.com/2009/01/10-tips-for-making-your-r-graphics-look-their-best.html" target="_blank">this article</a>, which lists 10 tips for making your R graphics look their best!
Also, if you want to know more about data visualization, you might consider checking out DataCamp's interactive <a href="https://www.datacamp.com/courses/ggvis-data-visualization-r-tutorial" target="_blank">course on data visualization with ggvis</a>, given by Garrett Grolemund, author of Hands on Programming with R, as well as Data Science with R.
Or maybe our <a href="https://www.datacamp.com/courses/reporting-with-r-markdown" target="_blank">course on reporting with R Markdown</a> can interest you!</p>
