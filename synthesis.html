<html><head><meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<base target=_blank>
<style>
body { margin: 10%; font-size: 24px; background-color: #000000; color: #109030;}
a { text-decoration: none; color: #28B8B8;}
a:visited { color: #389898;}
A:hover { color: yellow;}
A:focus { color: red;}
code { color: pink; background-color: #001500}
pre { color: gray; background-color: #001010; font-size: 24px; }
</style>
<h1 class="post-title">Learning D3 Part 1: Selections, Properties, Data</h1>
<p>
<img src="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-08-at-11.47.12-PM1.png"
></p>
<div class="alert alert-info">

<p><strong>Selections</strong></p>

<p>jQuery &#8211; select all paragraphs:</p>

<div style="position:relative;"><table><tr><td class="code"><pre>  $<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span></pre></td></tr></table><p class="theCode" style="display:none;">  $('p')</p></div>

<p>D3 &#8211; select all paragraphs:</p>

<div style="position:relative;"><table><tr><td class="code"><pre>  d3.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span></pre></td></tr></table><p class="theCode" style="display:none;">  d3.selectAll('p')</p></div>

<p>In this way, D3 is declarative. Instead of manually finding and looping through arrays of DOM nodes, you specify what you want to operate on, then operate on the entire selection at once</p>
<p><strong>Dynamic Properties</strong></p>
<p>Styles, attributes, and other properties of the DOM can be specified as functions of data in D3, as opposed to simple constants.</p>
<p>Set the color style of all paragraphs to a simple value:</p>

<div style="position:relative;"><table><tr><td class="code"><pre>  d3.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;p&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;color&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;white&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">  d3.selectAll(&quot;p&quot;).style(&quot;color&quot;, &quot;white&quot;);</p></div>

<p>Set the color style of all paragraphs to alternating shades of gray:</p>

<div style="position:relative;"><table><tr><td class="code"><pre>  d3.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;p&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;color&quot;</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #339933;">,</span> i<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
    <span style="color: #208066; font-weight: bold;">return</span> i <span style="color: #339933;">%</span> <span style="color: #CC0000;">2</span> <span style="color: #339933;">?</span> <span style="color: #3366CC;">&quot;#fff&quot;</span> <span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;#eee&quot;</span><span style="color: #339933;">;</span>
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">  d3.selectAll(&quot;p&quot;).style(&quot;color&quot;, function(d, i) {
    return i % 2 ? &quot;#fff&quot; : &quot;#eee&quot;;
  });</p></div>

<p><strong>Bound Data</strong></p>
<p>Dynamic, aka computed properties, often refer to data. The .data() method binds data to elements.</p>
<p>You might bind an array of numbers to list items. You can use these to compute dynamic font sizes</p>

<div style="position:relative;"><table><tr><td class="code"><pre>  d3.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;li&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">8</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">4</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">7</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">12</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">18</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;font-size&quot;</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> d <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;px&quot;</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">  d3.selectAll(&quot;li&quot;)
    .data([8, 4, 7, 12, 18])
    .style(&quot;font-size&quot;, function(d) { return d + &quot;px&quot;; });</p></div>

<p>I&#8217;ll continue tomorrow and start to build up some basic visuals with these components.</p>
<p>Continue with the D3 Series:</p>
<ul>
<li>Learning D3 Part 1: Selections, Properties, Data</li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/09/learning-d3-part-2" title="Learning D3 Part 2: Enter and Exit">Learning D3 Part 2: Enter and Exit</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/10/learning-d3-part-3-animation-interaction" title="Learning D3 Part 3: Animation &#038; Interaction">Learning D3 Part 3: Animation &#038; Interaction</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/11/learning-d3-part-4-intro-to-svg-graphics" title="Learning D3 Part 4: Intro to SVG Graphics">Learning D3 Part 4: Intro to SVG Graphics</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/15/learning-d3-part-5-axes" title="Learning D3 Part 5: Axes">Learning D3 Part 5: Axes</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/16/learning-d3-part-6-scales-colors" title="Learning D3 Part 6: Scales &#038; Colors">Learning D3 Part 6: Scales &#038; Colors</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/18/learning-d3-part-7-choropleth-maps" title="Learning D3 Part 7: Choropleth Maps">Learning D3 Part 7: Choropleth Maps</a></li>
</ul>
      <p>&nbsp;</p>
      
<br><br>
      <aside>July 9, 2012</aside><h1 class="post-title">Learning D3 Part 2: Enter and Exit</h1>
      <div class="alert alert-info">
<strong>Update:</strong> I&#8217;m releasing a series of screencast tutorials on D3 at <strong><a href="https://deveo.tv" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://deveo.tv', 'deveo.tv']);" >deveo.tv</a></strong>. Check it out and let me know what you think!
</div>
<p>In<U+00A0><a title="Learning D3, Part 1" href="http://synthesis.sbecker.net/articles/2012/07/08/learning-d3-part-1">Learning D3, Part 1</a> I went over some basic concepts of D3 &#8211; selections, dynamic properties, and bound data. I&#8217;m going to pick back up with data binding, and discuss how new data gets on the page.</p>
<p><strong>Enter and Exit</strong></p>
<p>Let&#8217;s say you have some data. It&#8217;s in the form of an array of numbers. Each of the numbers represent something, perhaps it&#8217;s the number of miles you ran each time you&#8217;ve gone for a run so far this month:</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #208066; font-weight: bold;">var</span> distances <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #CC0000;">2.23</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.39</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.59</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.77</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">var distances = [2.23, 2.39, 2.59, 2.77];</p></div>

<p>So we have four distances. In our first go at this, we&#8217;ll bind these to all the paragraphs on the page.</p>

<div style="position:relative;"><table><tr><td class="code"><pre>d3.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>distances<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">d3.selectAll('p')
  .data(distances);</p></div>

<p>If we have some paragraphs already in the document, then great, we can go about updating them to represent our data.</p>

<div style="position:relative;"><table><tr><td class="code"><pre>d3.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>distances<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="">String</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// set the paragraph text to the data values</span></pre></td></tr></table><p class="theCode" style="display:none;">d3.selectAll('p')
  .data(distances)
  .text(String) // set the paragraph text to the data values</p></div>

<p>This is simply passing String as a callback function to text(). String will be called for each of the data items or &#8220;datums&#8221;. The value returned (the number, converted to a string) is rendered as the text node of the element.</p>
<p>But lets say to begin with, we just have a blank page, with no paragraphs. How do we get new paragraphs on the page, representing the data? Enter <strong>.enter()</strong>. When we call enter() on an existing selection, we switch to a sub-selection representing the data that is yet to be mapped to an element, because there is not yet enough of them on the page to represent all of the current dataset. In other words, if there are more datums in our dataset than elements on the page, the &#8220;enter&#8221; sub-selection represents the yet-to-be-added elements.</p>

<div style="position:relative;"><table><tr><td class="code"><pre>d3.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>distances<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="">String</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// switch to yet-to-be-added elements selection</span></pre></td></tr></table><p class="theCode" style="display:none;">d3.selectAll('p')
  .data(distances)
  .text(String)
  .enter() // switch to yet-to-be-added elements selection</p></div>

<p>Following .enter(), we declare how these elements should come into being. Should they appended at the end of the current selection, or inserted at the beginning? In most cases, probably append. Also notice I added .select(&#8216;body&#8217;) before selecting all paragraphs. This is there because we need a parent element to append new elements within.</p>

<div style="position:relative;"><table><tr><td class="code"><pre>d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'body'</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>distances<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="">String</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> 
    .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// append a paragraph node for each new datum</span>
    .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="">String</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// and set its text value</span></pre></td></tr></table><p class="theCode" style="display:none;">d3.select('body').selectAll('p')
  .data(distances)
  .text(String)
  .enter() 
    .append('p') // append a paragraph node for each new datum
    .text(String); // and set its text value</p></div>

<p>Now, new paragraph elements will be rendered for all datums which don&#8217;t yet have a matching paragraph element. D3 also supports the reverse, handling how to remove extra DOM nodes that no longer are needed to represent the entire dataset. In order to do this, you must first set the overall selection to a variable, then call enter and exit on it separately.</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #006600; font-style: italic;">// Update existing paragraphs</span>
<span style="color: #208066; font-weight: bold;">var</span> p <span style="color: #339933;">=</span> d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'body'</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span>
         .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>distances<span style="color: #009900;">&#41;</span>
         .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="">String</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// Add any new paragraphs needed</span>
p.<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> 
  .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="">String</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// Remove any paragraphs no longer needed</span>
p.<span style="color: #668066;">exit</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">remove</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">// Update existing paragraphs
var p = d3.select('body').selectAll('p')
         .data(distances)
         .text(String);

// Add any new paragraphs needed
p.enter() 
  .append('p')
  .text(String);

// Remove any paragraphs no longer needed
p.exit()
  .remove();</p></div>

<p>That works, but it&#8217;s <a href="http://jsfiddle.net/sbecker/jEGLb/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/sbecker/jEGLb/', 'not much to look at']);" >not much to look at</a>. How easy would it be to convert it into a bar chart? Pretty simple:</p>

<div style="position:relative;"><table><tr><td class="code"><pre>  d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'body'</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'div'</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>distances<span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'div'</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'width'</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> <span style="color: #009900;">&#40;</span>d <span style="color: #339933;">*</span> <span style="color: #CC0000;">120</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'px'</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> d <span style="color: #339933;">+</span> <span style="color: #3366CC;">' miles'</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">  d3.select('body').selectAll('div')
    .data(distances)
    .enter()
      .append('div')
      .style('width', function(d) { return (d * 120) + 'px'; })
      .text(function(d) { return d + ' miles'; });</p></div>

<p>Here we just switched the selection to all divs on the page. We style the width using a function which multiples the miles datum by a factor of 120 pixels. and we set the text to &#8220;{x} miles&#8221;. Add a little CSS, and you get something like this:</p>
<p><a href="http://jsfiddle.net/sbecker/SFNka/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/sbecker/SFNka/', '']);" ><img class="alignnone size-full wp-image-247" title="Screen Shot 2012-07-09 at 11.17.56 PM" src="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-09-at-11.17.56-PM.png" alt="" width="365" height="164" srcset="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-09-at-11.17.56-PM.png 365w, http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-09-at-11.17.56-PM-300x134.png 300w" sizes="(max-width: 365px) 100vw, 365px" /></a></p>
<p>Here&#8217;s a <a href="http://jsfiddle.net/sbecker/SFNka/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/sbecker/SFNka/', 'running example']);" >running example</a> you can play with. Try changing the data values, or rendering it in a different way. Bar charts might not be the best way to represent a series of running times.</p>
<p>In tomorrow&#8217;s post I&#8217;ll go over animated transitions and possibly get into interaction. In the meantime, check out this slick D3-powered<U+00A0><a href="http://www.cedexis.com/country-reports/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://www.cedexis.com/country-reports/', 'visualization of cloud providers']);" >visualization of cloud providers</a> from my friend <a href="https://twitter.com/alexwenckus" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://twitter.com/alexwenckus', 'Alex Wenckus']);" >Alex Wenckus</a> at Cedexis.</p>
<p>Continue with the D3 Series:</p>
<ul>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/08/learning-d3-part-1" title="Learning D3 Part 1: Selections, Properties, Data">Learning D3 Part 1: Selections, Properties, Data</a></li>
<li>Learning D3 Part 2: Enter and Exit</li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/10/learning-d3-part-3-animation-interaction" title="Learning D3 Part 3: Animation &#038; Interaction">Learning D3 Part 3: Animation &#038; Interaction</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/11/learning-d3-part-4-intro-to-svg-graphics" title="Learning D3 Part 4: Intro to SVG Graphics">Learning D3 Part 4: Intro to SVG Graphics</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/15/learning-d3-part-5-axes" title="Learning D3 Part 5: Axes">Learning D3 Part 5: Axes</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/16/learning-d3-part-6-scales-colors" title="Learning D3 Part 6: Scales &#038; Colors">Learning D3 Part 6: Scales &#038; Colors</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/18/learning-d3-part-7-choropleth-maps" title="Learning D3 Part 7: Choropleth Maps">Learning D3 Part 7: Choropleth Maps</a></li>
</ul>
      <p>&nbsp;</p>
      
<br><br>
      <aside>July 10, 2012</aside><h1 class="post-title">Learning D3 Part 3: Animation &#038; Interaction</h1>
      <div class="alert alert-info">
<strong>Update:</strong> I&#8217;m releasing a series of screencast tutorials on D3 at <strong><a href="https://deveo.tv" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://deveo.tv', 'deveo.tv']);" >deveo.tv</a></strong>. Check it out and let me know what you think!
</div>
<p><img class="alignnone size-full wp-image-266" title="D3 Animation and Interaction" src="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-10-at-11.28.05-PM.png" alt="" width="487" height="198" srcset="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-10-at-11.28.05-PM.png 487w, http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-10-at-11.28.05-PM-300x121.png 300w" sizes="(max-width: 487px) 100vw, 487px" /></p>
<p>In <a title="Learning D3, Part 2" href="http://synthesis.sbecker.net/articles/2012/07/09/learning-d3-part-2">Learning D3 Part 2</a>, I went over how to bind datasets to the DOM, and get elements on and off the page with enter and exit sub-selections. This time I&#8217;ll go over how to add some basic animation and interaction.</p>
<p><strong>Transitions</strong></p>
<p>You specify animations (or other transitions) with the .transition() method, followed by a chain describing the end result. This can include any DOM transformation, such as updates to the width or background color. D3 conveniently calculates the &#8220;tween&#8221; values for distances and colors, which saves a huge amount of time. You just worry about the values to transition from and to, the duration of the animation, and any delay that should happen before the animation starts.</p>
<p>If you&#8217;re drawing a horizontal bar chart of running distances, it might help to convey distance a bit more by animating the growth of each bar horizontally.</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #208066; font-weight: bold;">var</span> distances <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #CC0000;">2.23</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.39</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.59</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.77</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">3.05</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
&nbsp;
d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'body'</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'div'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>distances<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'div'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">html</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'.'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'width'</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">'10px'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'opacity'</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">transition</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">delay</span><span style="color: #009900;">&#40;</span><span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #339933;">,</span> i<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> i <span style="color: #339933;">*</span> <span style="color: #CC0000;">1000</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">duration</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">1000</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'width'</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> <span style="color: #009900;">&#40;</span>d <span style="color: #339933;">*</span> <span style="color: #CC0000;">150</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'px'</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'opacity'</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> d <span style="color: #339933;">+</span> <span style="color: #3366CC;">' miles'</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">var distances = [2.23, 2.39, 2.59, 2.77, 3.05];

d3.select('body').selectAll('div')
  .data(distances)
  .enter()
  .append('div')
  .html('.')
  .style('width', '10px')
  .style('opacity', 0)
  .transition()
    .delay(function(d, i) { return i * 1000 })
    .duration(1000)
    .style('width', function(d) { return (d * 150) + 'px'; })
    .style('opacity', 1)
    .text(function(d) { return d + ' miles'; });</p></div>

<p>I&#8217;m throwing in a few things at once. <a href="http://jsfiddle.net/sbecker/wL5xg/1/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/sbecker/wL5xg/1/', 'See it run here']);" >See it run here</a>. What&#8217;s happening? A div is appended for each distance, and initially set to a small width of 10px, the text of &#8220;.&#8221; and an opacity of 0. It&#8217;s invisible! But only for a moment. Then we set up the transition. Each item is delayed 1 second later than the previous using a function returning a multiple of the item index. The duration is set to 1 second with .duration(1000). With this combo, each bar appears in succession. The rest is familiar, setting the full width, label text, and full opacity.</p>
<p><strong>Interaction</strong></p>
<p>Now let&#8217;s add some basic user interaction to it, by highlighting the current run when you mouse over it.</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #208066; font-weight: bold;">var</span> distances <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #CC0000;">2.23</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.39</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.59</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2.77</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">3.05</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
&nbsp;
d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'body'</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'div'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>distances<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'div'</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">html</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'...'</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'width'</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">'10px'</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'opacity'</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">on</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;mouseover&quot;</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #208066; font-weight: bold;">this</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">transition</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">duration</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">300</span><span style="color: #009900;">&#41;</span>
        .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;background-color&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;#FFD700&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">on</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;mouseout&quot;</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #208066; font-weight: bold;">this</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">transition</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">duration</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">300</span><span style="color: #009900;">&#41;</span>
        .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;background-color&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;#333&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">transition</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">delay</span><span style="color: #009900;">&#40;</span><span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #339933;">,</span> i<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> i <span style="color: #339933;">*</span> <span style="color: #CC0000;">300</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">duration</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">300</span><span style="color: #009900;">&#41;</span>    
      .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'width'</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> <span style="color: #009900;">&#40;</span>d <span style="color: #339933;">*</span> <span style="color: #CC0000;">150</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">'px'</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'opacity'</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> d <span style="color: #339933;">+</span> <span style="color: #3366CC;">' miles'</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">var distances = [2.23, 2.39, 2.59, 2.77, 3.05];

d3.select('body').selectAll('div')
  .data(distances)
  .enter()
    .append('div')
    .html('...')
    .style('width', '10px')
    .style('opacity', 0)
    .on(&quot;mouseover&quot;, function(){
      d3.select(this).transition().duration(300)
        .style(&quot;background-color&quot;, &quot;#FFD700&quot;);
    })
    .on(&quot;mouseout&quot;, function(){
      d3.select(this).transition().duration(300)
        .style(&quot;background-color&quot;, &quot;#333&quot;);
    })
    .transition()
      .delay(function(d, i) { return i * 300 })
      .duration(300)    
      .style('width', function(d) { return (d * 150) + 'px'; })
      .style('opacity', 1)
      .text(function(d) { return d + ' miles'; });</p></div>

<p>Here&#8217;s the <a href="http://jsfiddle.net/sbecker/wL5xg/3/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/sbecker/wL5xg/3/', 'running example']);" >running example</a>. Notice the .on(&#8220;mouseover&#8221;) and .on(&#8220;mouseout&#8221;) events, describing another transition/animation to fade the background color to yellow and back. The events pass the current context as &#8220;this&#8221;, which you can again select with d3.select() and apply transitions to.</p>
<p>That&#8217;s the basic idea. These basic building blocks are all you really need to build up complex visualizations. I haven&#8217;t touched on SVG yet, so that&#8217;ll be up next.</p>
<p>Continue with the D3 Series:</p>
<ul>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/08/learning-d3-part-1" title="Learning D3 Part 1: Selections, Properties, Data">Learning D3 Part 1: Selections, Properties, Data</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/09/learning-d3-part-2" title="Learning D3 Part 2: Enter and Exit">Learning D3 Part 2: Enter and Exit</a></li>
<li>Learning D3 Part 3: Animation &#038; Interaction</li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/11/learning-d3-part-4-intro-to-svg-graphics" title="Learning D3 Part 4: Intro to SVG Graphics">Learning D3 Part 4: Intro to SVG Graphics</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/15/learning-d3-part-5-axes" title="Learning D3 Part 5: Axes">Learning D3 Part 5: Axes</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/16/learning-d3-part-6-scales-colors" title="Learning D3 Part 6: Scales &#038; Colors">Learning D3 Part 6: Scales &#038; Colors</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/18/learning-d3-part-7-choropleth-maps" title="Learning D3 Part 7: Choropleth Maps">Learning D3 Part 7: Choropleth Maps</a></li>
</ul>
      <p>&nbsp;</p>
      
<br><br>
      <aside>July 11, 2012</aside><h1 class="post-title">Learning D3 Part 4: Intro to SVG Graphics</h1>
      <div class="alert alert-info">
<strong>Update:</strong> I&#8217;m releasing a series of screencast tutorials on D3 at <strong><a href="https://deveo.tv" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://deveo.tv', 'deveo.tv']);" >deveo.tv</a></strong>. Check it out and let me know what you think!
</div>
<p>In <a title="Learning D3, Part 3: Animation &amp; Interaction" href="http://synthesis.sbecker.net/articles/2012/07/10/learning-d3-part-3-animation-interaction">Learning D3 Part 3</a>, I went over how to add some basic animation and interactivity. This time I&#8217;ll go over a big component of D3 and other javascript visualization tools &#8211; SVG or Scalable Vector Graphics.</p>
<p><strong>Scalable Vector Graphics</strong></p>
<p><a href="http://en.wikipedia.org/wiki/SVG" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://en.wikipedia.org/wiki/SVG', 'SVG']);" >SVG</a> is an XML based, 2 dimensional open-standard that&#8217;s been around since 1999. Since SVG graphics are vector based, they can be zoomed or scaled to any resolution without quality loss.</p>
<p>What can you do with it? SVG has a lot of <a href="http://en.wikipedia.org/wiki/SVG#Functionality" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://en.wikipedia.org/wiki/SVG#Functionality', 'functionality']);" >functionality</a>: paths, basic shapes, vertical text, text on a curve, gradient fills, masks, etc.</p>
<p><strong>Canvas</strong></p>
<p>Another tool for adding visuals to the web is the recently added HTML5<U+00A0><a href="http://en.wikipedia.org/wiki/Canvas_element" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://en.wikipedia.org/wiki/Canvas_element', 'Canvas']);" >Canvas</a><U+00A0>element. SVG and Canvas are not the same thing. Whereas SVG is vector based, Canvas uses raster graphics. SVG elements remain live and addressable in a <a href="http://en.wikipedia.org/wiki/Scene_graph" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://en.wikipedia.org/wiki/Scene_graph', 'scene graph']);" >scene graph</a> (the DOM) after they&#8217;ve been rendered to the screen, so you can update them after rendering. Canvas uses a procedural approach &#8211; rather than declaring elements with XML, commands are only executed via scripts.<U+00A0>In canvas, once an object has been drawn to the screen, it&#8217;s forgotten. If you need to move that object, you need to re-render the entire scene.</p>
<p><strong>SVG in D3</strong></p>
<p>So to get started &#8211; we need to learn some more basics of SVG. The axis starts in the top left corner of a root SVG element and counts up as you move down and towards the right. If you have a 500&#215;500 region, the point [0,0] is in the upper left, and [500,500] is in the bottom right.</p>
<p>Here&#8217;s a chart to illustrate SVG&#8217;s coordinate space, followed by the code to draw the chart.</p>
<p><a href="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-11-at-11.19.04-PM.png"><img class="alignnone size-full wp-image-285" title="Screen Shot 2012-07-11 at 11.19.04 PM" src="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-11-at-11.19.04-PM.png" alt="" width="486" height="323" srcset="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-11-at-11.19.04-PM.png 486w, http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-11-at-11.19.04-PM-300x199.png 300w" sizes="(max-width: 486px) 100vw, 486px" /></a></p>
<p>Now the code:</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #006600; font-style: italic;">// Define linear scales representing the pixel dimensions</span>
<span style="color: #208066; font-weight: bold;">var</span> x <span style="color: #339933;">=</span> d3.<span style="color: #668066;">scale</span>.<span style="color: #668066;">linear</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">domain</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">450</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">range</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">450</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #208066; font-weight: bold;">var</span> y <span style="color: #339933;">=</span> d3.<span style="color: #668066;">scale</span>.<span style="color: #668066;">linear</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
     .<span style="color: #668066;">domain</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">300</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
     .<span style="color: #668066;">range</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">300</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// define an SVG element to hold our chart</span>
<span style="color: #208066; font-weight: bold;">var</span> chart <span style="color: #339933;">=</span> d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;body&quot;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;svg&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;chart&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;width&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">490</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// more space to accomodate our axis labels</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;height&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">320</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// moar space!</span>
  .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;g&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;transform&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;translate(20,15)&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// move base coordinates over/down a bit so lines start at 0,0</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// draw the X grid lines</span>
chart.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line.x&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>x.<span style="color: #668066;">ticks</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">10</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;x&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x1&quot;</span><span style="color: #339933;">,</span> x<span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x2&quot;</span><span style="color: #339933;">,</span> x<span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y1&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y2&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">300</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;stroke&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;#ccc&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// draw the Y axis grid lines</span>
chart.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line.y&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>y.<span style="color: #668066;">ticks</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">10</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;y&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x1&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x2&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">450</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y1&quot;</span><span style="color: #339933;">,</span> y<span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y2&quot;</span><span style="color: #339933;">,</span> y<span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;stroke&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;#ccc&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// add the X axis labels </span>
chart.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;.rule&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>x.<span style="color: #668066;">ticks</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">10</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;text&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x&quot;</span><span style="color: #339933;">,</span> x<span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;dy&quot;</span><span style="color: #339933;">,</span> <span style="color: #339933;">-</span><span style="color: #CC0000;">3</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;text-anchor&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;middle&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="">String</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// add the Y axis labels</span>
chart.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;.rule&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>y.<span style="color: #668066;">ticks</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">10</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;text&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y&quot;</span><span style="color: #339933;">,</span> y<span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;dy&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">3</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// shift down slightly</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;dx&quot;</span><span style="color: #339933;">,</span> <span style="color: #339933;">-</span><span style="color: #CC0000;">3</span><span style="color: #009900;">&#41;</span>  <span style="color: #006600; font-style: italic;">// and to the left</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;text-anchor&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;end&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// align right</span>
    .<span style="color: #668066;">text</span><span style="color: #009900;">&#40;</span><span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #208066; font-weight: bold;">return</span> d <span style="color: #339933;">==</span> <span style="color: #CC0000;">0</span> <span style="color: #339933;">?</span> <span style="color: #3366CC;">''</span> <span style="color: #339933;">:</span> d<span style="color: #339933;">;</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// add the darker X axis line</span>
chart.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x1&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x2&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">450</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;stroke&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;#000&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// add the darker Y axis line</span>
chart.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y1&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y2&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">300</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;stroke&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;#000&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">// Define linear scales representing the pixel dimensions
var x = d3.scale.linear()
    .domain([0, 450])
    .range([0, 450]);

var y = d3.scale.linear()
     .domain([0,300])
     .range([0, 300]);

// define an SVG element to hold our chart
var chart = d3.select(&quot;body&quot;).append(&quot;svg&quot;)
    .attr(&quot;class&quot;, &quot;chart&quot;)
    .attr(&quot;width&quot;, 490) // more space to accomodate our axis labels
    .attr(&quot;height&quot;, 320) // moar space!
  .append(&quot;g&quot;)
    .attr(&quot;transform&quot;, &quot;translate(20,15)&quot;); // move base coordinates over/down a bit so lines start at 0,0

// draw the X grid lines
chart.selectAll(&quot;line.x&quot;)
    .data(x.ticks(10))
  .enter().append(&quot;line&quot;)
    .attr(&quot;class&quot;, &quot;x&quot;)
    .attr(&quot;x1&quot;, x)
    .attr(&quot;x2&quot;, x)
    .attr(&quot;y1&quot;, 0)
    .attr(&quot;y2&quot;, 300)
    .style(&quot;stroke&quot;, &quot;#ccc&quot;);

// draw the Y axis grid lines
chart.selectAll(&quot;line.y&quot;)
    .data(y.ticks(10))
  .enter().append(&quot;line&quot;)
    .attr(&quot;class&quot;, &quot;y&quot;)
    .attr(&quot;x1&quot;, 0)
    .attr(&quot;x2&quot;, 450)
    .attr(&quot;y1&quot;, y)
    .attr(&quot;y2&quot;, y)
    .style(&quot;stroke&quot;, &quot;#ccc&quot;);

// add the X axis labels 
chart.selectAll(&quot;.rule&quot;)
    .data(x.ticks(10))
  .enter().append(&quot;text&quot;)
    .attr(&quot;x&quot;, x)
    .attr(&quot;y&quot;, 0)
    .attr(&quot;dy&quot;, -3)
    .attr(&quot;text-anchor&quot;, &quot;middle&quot;)
    .text(String);

// add the Y axis labels
chart.selectAll(&quot;.rule&quot;)
    .data(y.ticks(10))
  .enter().append(&quot;text&quot;)
    .attr(&quot;x&quot;, 0)
    .attr(&quot;y&quot;, y)
    .attr(&quot;dy&quot;, 3) // shift down slightly
    .attr(&quot;dx&quot;, -3)  // and to the left
    .attr(&quot;text-anchor&quot;, &quot;end&quot;) // align right
    .text(function(d) { return d == 0 ? '' : d;});

// add the darker X axis line
chart.append(&quot;line&quot;)
    .attr(&quot;x1&quot;, 0)
    .attr(&quot;x2&quot;, 450)
    .style(&quot;stroke&quot;, &quot;#000&quot;);

// add the darker Y axis line
chart.append(&quot;line&quot;)
    .attr(&quot;y1&quot;, 0)
    .attr(&quot;y2&quot;, 300)
    .style(&quot;stroke&quot;, &quot;#000&quot;);</p></div>

<p>That&#8217;s a bit long, eh? Here is the <a href="http://jsfiddle.net/sbecker/v2NX5/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/sbecker/v2NX5/', 'whole example']);" >whole example</a>. D3 actually has more convenient <a href="https://github.com/mbostock/d3/wiki/SVG-Axes" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/mbostock/d3/wiki/SVG-Axes', 'functions for drawing axis lines']);" >functions for drawing axis lines</a>, I&#8217;ll leave those for another time. That&#8217;s all for tonight!</p>
<p>Continue with the D3 Series:</p>
<ul>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/08/learning-d3-part-1" title="Learning D3 Part 1: Selections, Properties, Data">Learning D3 Part 1: Selections, Properties, Data</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/09/learning-d3-part-2" title="Learning D3 Part 2: Enter and Exit">Learning D3 Part 2: Enter and Exit</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/10/learning-d3-part-3-animation-interaction" title="Learning D3 Part 3: Animation &#038; Interaction">Learning D3 Part 3: Animation &#038; Interaction</a></li>
<li>Learning D3 Part 4: Intro to SVG Graphics</li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/15/learning-d3-part-5-axes" title="Learning D3 Part 5: Axes">Learning D3 Part 5: Axes</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/16/learning-d3-part-6-scales-colors" title="Learning D3 Part 6: Scales &#038; Colors">Learning D3 Part 6: Scales &#038; Colors</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/18/learning-d3-part-7-choropleth-maps" title="Learning D3 Part 7: Choropleth Maps">Learning D3 Part 7: Choropleth Maps</a></li>
</ul>
      <p>&nbsp;</p>
      
<br><br>
      <aside>July 15, 2012</aside><h1 class="post-title">Learning D3 Part 5: Axes</h1>
      <div class="alert alert-info">
<strong>Update:</strong> I&#8217;m releasing a series of screencast tutorials on D3 at <strong><a href="https://deveo.tv" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://deveo.tv', 'deveo.tv']);" >deveo.tv</a></strong>. Check it out and let me know what you think!
</div>
<p>In<U+00A0><a title="Learning D3, Part 4: Intro to SVG Graphics" href="http://synthesis.sbecker.net/articles/2012/07/11/learning-d3-part-4-intro-to-svg-graphics">Learning D3 Part 4</a>, I <em>briefly</em> introduced SVG, the differences between SVG and Canvas, and drew a chart grid to illustrate how SVG&#8217;s canvas goes from top/left to bottom/right.</p>
<p>D3 has a nice <a href="http://bl.ocks.org/1166403" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://bl.ocks.org/1166403', 'axis component']);" >axis component</a> for drawing reference lines, tick marks, and labels, which cleans up some of the code from the previous example. Here&#8217;s another <a href="http://alignedleft.com/tutorials/d3/axes/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://alignedleft.com/tutorials/d3/axes/', 'good tutorial']);" >good tutorial</a><U+00A0>on it. Here&#8217;s the previous example, now drawn using d3.axis.</p>
<p><a href="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-15-at-10.11.58-PM.png"><img class="alignnone size-full wp-image-335" title="Screen Shot 2012-07-15 at 10.11.58 PM" src="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-15-at-10.11.58-PM.png" alt="" width="490" height="324" srcset="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-15-at-10.11.58-PM.png 490w, http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-15-at-10.11.58-PM-300x198.png 300w" sizes="(max-width: 490px) 100vw, 490px" /></a></p>
<p>This example also contains tick marks as part of the axis lines. Might be unnecessary chart-junk depending on the situation, but they&#8217;re easily removed if you don&#8217;t need them.</p>
<p>Code:</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #006600; font-style: italic;">// Define identity (1:1) scales</span>
<span style="color: #208066; font-weight: bold;">var</span> x <span style="color: #339933;">=</span> d3.<span style="color: #668066;">scale</span>.<span style="color: #668066;">identity</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">domain</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">450</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #208066; font-weight: bold;">var</span> y <span style="color: #339933;">=</span> d3.<span style="color: #668066;">scale</span>.<span style="color: #668066;">identity</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">domain</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">300</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// Define container</span>
<span style="color: #208066; font-weight: bold;">var</span> chart <span style="color: #339933;">=</span> d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;body&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;svg&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;chart&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;width&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">490</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;height&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">330</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;g&quot;</span><span style="color: #009900;">&#41;</span>
      <span style="color: #006600; font-style: italic;">// move 0,0 slightly down and right to accomodate axes</span>
     .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;transform&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;translate(30,20)&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// Draw X-axis grid lines</span>
chart.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line.x&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>x.<span style="color: #668066;">ticks</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">10</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;x&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x1&quot;</span><span style="color: #339933;">,</span> x<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x2&quot;</span><span style="color: #339933;">,</span> x<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y1&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y2&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">300</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;stroke&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;#ccc&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// Draw Y-axis grid lines</span>
chart.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line.y&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>y.<span style="color: #668066;">ticks</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">10</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;line&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;y&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x1&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;x2&quot;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">450</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y1&quot;</span><span style="color: #339933;">,</span> y<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;y2&quot;</span><span style="color: #339933;">,</span> y<span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">style</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;stroke&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;#ccc&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// Define stock x and y axis</span>
<span style="color: #208066; font-weight: bold;">var</span> xAxis <span style="color: #339933;">=</span> d3.<span style="color: #668066;">svg</span>.<span style="color: #668066;">axis</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">scale</span><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span>.<span style="color: #668066;">orient</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'top'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #208066; font-weight: bold;">var</span> yAxis <span style="color: #339933;">=</span> d3.<span style="color: #668066;">svg</span>.<span style="color: #668066;">axis</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">scale</span><span style="color: #009900;">&#40;</span>y<span style="color: #009900;">&#41;</span>.<span style="color: #668066;">orient</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'left'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
chart.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'g'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;axis&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">call</span><span style="color: #009900;">&#40;</span>xAxis<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
chart.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'g'</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;axis&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">call</span><span style="color: #009900;">&#40;</span>yAxis<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">// Define identity (1:1) scales
var x = d3.scale.identity().domain([0,450]);
var y = d3.scale.identity().domain([0,300]);

// Define container
var chart = d3.select(&quot;body&quot;)
  .append(&quot;svg&quot;)
    .attr(&quot;class&quot;, &quot;chart&quot;)
    .attr(&quot;width&quot;, 490)
    .attr(&quot;height&quot;, 330)
    .append(&quot;g&quot;)
      // move 0,0 slightly down and right to accomodate axes
     .attr(&quot;transform&quot;, &quot;translate(30,20)&quot;);

// Draw X-axis grid lines
chart.selectAll(&quot;line.x&quot;)
  .data(x.ticks(10))
  .enter().append(&quot;line&quot;)
  .attr(&quot;class&quot;, &quot;x&quot;)
  .attr(&quot;x1&quot;, x)
  .attr(&quot;x2&quot;, x)
  .attr(&quot;y1&quot;, 0)
  .attr(&quot;y2&quot;, 300)
  .style(&quot;stroke&quot;, &quot;#ccc&quot;);

// Draw Y-axis grid lines
chart.selectAll(&quot;line.y&quot;)
  .data(y.ticks(10))
  .enter().append(&quot;line&quot;)
  .attr(&quot;class&quot;, &quot;y&quot;)
  .attr(&quot;x1&quot;, 0)
  .attr(&quot;x2&quot;, 450)
  .attr(&quot;y1&quot;, y)
  .attr(&quot;y2&quot;, y)
  .style(&quot;stroke&quot;, &quot;#ccc&quot;);

// Define stock x and y axis
var xAxis = d3.svg.axis().scale(x).orient('top');
var yAxis = d3.svg.axis().scale(y).orient('left');

chart.append('g')
  .attr(&quot;class&quot;, &quot;axis&quot;)
  .call(xAxis);

chart.append('g')
  .attr(&quot;class&quot;, &quot;axis&quot;)
  .call(yAxis);</p></div>

<p>Here is the <a href="http://jsfiddle.net/sbecker/co2vykp2/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/sbecker/co2vykp2/', 'complete working example']);" >complete working example</a>, with css that cleans up the tick marks.<br />
Still not much to see yet, but I&#8217;m establishing the foundation on which to build. <f0><U+009F><U+0099><U+0082></p>
<p>Continue with the D3 Series:</p>
<ul>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/08/learning-d3-part-1" title="Learning D3 Part 1: Selections, Properties, Data">Learning D3 Part 1: Selections, Properties, Data</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/09/learning-d3-part-2" title="Learning D3 Part 2: Enter and Exit">Learning D3 Part 2: Enter and Exit</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/10/learning-d3-part-3-animation-interaction" title="Learning D3 Part 3: Animation &#038; Interaction">Learning D3 Part 3: Animation &#038; Interaction</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/11/learning-d3-part-4-intro-to-svg-graphics" title="Learning D3 Part 4: Intro to SVG Graphics">Learning D3 Part 4: Intro to SVG Graphics</a></li>
<li>Learning D3 Part 5: Axes</li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/16/learning-d3-part-6-scales-colors" title="Learning D3 Part 6: Scales &#038; Colors">Learning D3 Part 6: Scales &#038; Colors</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/18/learning-d3-part-7-choropleth-maps" title="Learning D3 Part 7: Choropleth Maps">Learning D3 Part 7: Choropleth Maps</a></li>
</ul>
      <p>&nbsp;</p>
      
<br><br>
      <aside>July 16, 2012</aside><h1 class="post-title">Learning D3 Part 6: Scales &#038; Colors</h1>
      <div class="alert alert-info">
<strong>Update:</strong> I&#8217;m releasing a series of screencast tutorials on D3 at <strong><a href="https://deveo.tv" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://deveo.tv', 'deveo.tv']);" >deveo.tv</a></strong>. Check it out and let me know what you think!
</div>
<p>In <a title="Learning D3, Part 5: Axes" href="http://synthesis.sbecker.net/articles/2012/07/15/learning-d3-part-5-axes">Learning D3 Part 5</a>, I waxed poetic about D3&#8217;s functions for drawing axis lines and labels. This time I&#8217;ll talk about scales. Here&#8217;s a pretty graph to go with it. This is similar to the earlier examples, but now drawn with SVG, using axes and scales. Ooh la la.</p>
<p><a href="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-16-at-10.59.26-PM.png"><img class="alignnone size-full wp-image-383" title="July Runs" src="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-16-at-10.59.26-PM.png" alt="" width="495" height="307" srcset="http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-16-at-10.59.26-PM.png 495w, http://synthesis.sbecker.net/wp-content/uploads/2012/07/Screen-Shot-2012-07-16-at-10.59.26-PM-300x186.png 300w" sizes="(max-width: 495px) 100vw, 495px" /></a></p>
<p><strong>What are scales?</strong></p>
<p>According to the ol&#8217; wikipedia, a scale is &#8220;a graduated range of values forming a standard system for measuring or grading something&#8221;. In D3 though, scales are functions. &#8220;Functions that map from an input domain to an output range&#8221;.</p>
<p>In other words, scales are what tell you how many pixels high a bar chart should be with a value of 1 vs 5 vs 7. If you wanted to draw a very tiny bar chart, you could just use those values, and draw bars that are only 1, 5, and 7 pixels high. But if you really want to make your point, you&#8217;d probably do better drawing bigger bars.</p>
<p>D3 has some built in scales you can use for convenience.<U+00A0>The most common type of scale in D3 is the linear scale.</p>
<p style="padding-left: 30px;"><U+00A0><em>linear</em>: arranged in or extending along a straight or nearly straight line<br />
<em>scale</em>: a graduated range of values forming a standard system for measuring or grading something</p>
<p>So a linear scale is a scale which the output value increases or decreases in constant proportion to the input value.</p>
<p>The simplest possible scale is a 1:1 scale.</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #208066; font-weight: bold;">var</span> scale <span style="color: #339933;">=</span> d3.<span style="color: #668066;">scale</span>.<span style="color: #668066;">linear</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
scale<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// 1</span>
scale<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">2</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// 2</span></pre></td></tr></table><p class="theCode" style="display:none;">var scale = d3.scale.linear();

scale(1) // 1
scale(2) // 2</p></div>

<p><strong>Domain</strong></p>
<p>The domain is the range of possible <em>input</em> values in the scale. So I have a series of distances [2.23, 2.39, 2.59, 2.77, 3.05] I might want the domain to range from 0 to 4 or so, to capture the complete range of input values.</p>
<p><strong>Range</strong></p>
<p>The range is the range (again) of possible <em>output</em> values in the scale. Your output values might be in pixels. If you have a 400 pixel wide graph, <U+00A0>you&#8217;d want to have a range on the x-axis from 0 to 400.</p>
<p>So, just remember domain means input, range means output.</p>
<p>Say we want to draw a very tall bar chart. We might want each input unit to equate to 100 pixels in height. So we&#8217;d need a 1:100 scale. Our input values range from 0 to 10, so thats our domain, and our graph is 1000 pixels tall, to accomodate these giant bars, so our output values range from 0 to 1000.</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #208066; font-weight: bold;">var</span> scale <span style="color: #339933;">=</span> d3.<span style="color: #668066;">scale</span>.<span style="color: #668066;">linear</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">domain</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">10</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">range</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span><span style="color: #CC0000;">1000</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
scale<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// 0</span>
scale<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// 100</span>
scale<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">2</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// 200</span></pre></td></tr></table><p class="theCode" style="display:none;">var scale = d3.scale.linear()
  .domain([0, 10])
  .range([0,1000]);

scale(0) // 0
scale(1) // 100
scale(2) // 200</p></div>

<p>You can also invert them. This is how you get 0 on the bottom of the Y axis with SVG.</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #208066; font-weight: bold;">var</span> scale <span style="color: #339933;">=</span> d3.<span style="color: #668066;">scale</span>.<span style="color: #668066;">linear</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">domain</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">10</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">range</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">1000</span><span style="color: #339933;">,</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
scale<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// 1000 - for the y axis, all the way at the bottom</span>
scale<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// 900 - a little higher</span>
scale<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">2</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// 800 - even higher now</span></pre></td></tr></table><p class="theCode" style="display:none;">var scale = d3.scale.linear()
  .domain([0, 10])
  .range([1000,1]);

scale(0) // 1000 - for the y axis, all the way at the bottom
scale(1) // 900 - a little higher
scale(2) // 800 - even higher now</p></div>

<p>Linear scales are pretty flexible. You can even use them to create color gradients:</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #208066; font-weight: bold;">var</span> color <span style="color: #339933;">=</span> d3.<span style="color: #668066;">scale</span>.<span style="color: #668066;">linear</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">domain</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #339933;">-</span><span style="color: #CC0000;">1</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">range</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #3366CC;">&quot;red&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;white&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;green&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
color<span style="color: #009900;">&#40;</span><span style="color: #339933;">-</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span>   <span style="color: #006600; font-style: italic;">// &quot;#ff0000&quot; red</span>
color<span style="color: #009900;">&#40;</span><span style="color: #339933;">-</span><span style="color: #CC0000;">0.5</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">// &quot;#ff8080&quot; pinkish</span>
color<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span>    <span style="color: #006600; font-style: italic;">// &quot;#ffffff&quot; white</span>
color<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">0.5</span><span style="color: #009900;">&#41;</span>  <span style="color: #006600; font-style: italic;">// &quot;#80c080&quot; getting greener</span>
color<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">0.7</span><span style="color: #009900;">&#41;</span>  <span style="color: #006600; font-style: italic;">// &quot;#4da64d&quot; almost there..</span>
color<span style="color: #009900;">&#40;</span><span style="color: #CC0000;">1</span><span style="color: #009900;">&#41;</span>    <span style="color: #006600; font-style: italic;">// &quot;#008000&quot; totally green!</span></pre></td></tr></table><p class="theCode" style="display:none;">var color = d3.scale.linear()
    .domain([-1, 0, 1])
    .range([&quot;red&quot;, &quot;white&quot;, &quot;green&quot;]);

color(-1)   // &quot;#ff0000&quot; red
color(-0.5) // &quot;#ff8080&quot; pinkish
color(0)    // &quot;#ffffff&quot; white
color(0.5)  // &quot;#80c080&quot; getting greener
color(0.7)  // &quot;#4da64d&quot; almost there..
color(1)    // &quot;#008000&quot; totally green!</p></div>

<p>This is a <em>polylinear</em><U+00A0>scale (aka multiple linear scales in one) lifted straight out of the <a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/mbostock/d3/wiki/Quantitative-Scales', 'API docs']);" >API docs</a>. The input domain from -1 to 0 maps from red to white, and from 0 to 1 maps from white to green. How cool is that? It calculates the color transitions for you.</p>
<p><strong>Other Kinds of Scales</strong></p>
<p>It doesn&#8217;t stop at linear. Oh no. So many more to choose from.</p>
<p style="padding-left: 30px;"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-identity" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-identity', 'identity']);" >identity</a>: a special kind of linear scale, 1:1, good for pixel values. input == output</p>
<p style="padding-left: 30px;"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-sqrt" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-sqrt', 'power']);" >power</a> and <a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-log" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-log', 'logarithmic']);" >logarithmic</a> scales: sqrt, pow, log &#8211; for exponentially increasing values</p>
<p style="padding-left: 30px;"><a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-quantize" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-quantize', 'quantize']);" >quantize</a> and <a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-quantile" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/mbostock/d3/wiki/Quantitative-Scales#wiki-quantile', 'quantile']);" >quantile</a> scales: for discrete sets of unique possible values for inputs or outputs</p>
<p style="padding-left: 30px;"><a href="https://github.com/mbostock/d3/wiki/Ordinal-Scales" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/mbostock/d3/wiki/Ordinal-Scales', 'ordinal']);" >ordinal</a>: for non quantitative scales, like names, categories, etc.</p>
<p>Here&#8217;s a <a href="http://jsfiddle.net/sbecker/n4xWy/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/sbecker/n4xWy/', 'running example']);" >running example</a> of the graph at the top. I promise to do something other than bar charts of running distances next time. If you need more excitement right now, here&#8217;s a <a href="http://jsfiddle.net/stephenboak/hYuPb/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://jsfiddle.net/stephenboak/hYuPb/', 'randomly generated, animated donut chart']);" >randomly generated, animated donut chart</a>. So crazy.</p>
<p>Bonus question &#8211; what&#8217;s the redundant, non data-ink on the first chart?</p>
<p>Continue with the D3 Series:</p>
<ul>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/08/learning-d3-part-1" title="Learning D3 Part 1: Selections, Properties, Data">Learning D3 Part 1: Selections, Properties, Data</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/09/learning-d3-part-2" title="Learning D3 Part 2: Enter and Exit">Learning D3 Part 2: Enter and Exit</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/10/learning-d3-part-3-animation-interaction" title="Learning D3 Part 3: Animation &#038; Interaction">Learning D3 Part 3: Animation &#038; Interaction</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/11/learning-d3-part-4-intro-to-svg-graphics" title="Learning D3 Part 4: Intro to SVG Graphics">Learning D3 Part 4: Intro to SVG Graphics</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/15/learning-d3-part-5-axes" title="Learning D3 Part 5: Axes">Learning D3 Part 5: Axes</a></li>
<li>Learning D3 Part 6: Scales &#038; Colors</li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/18/learning-d3-part-7-choropleth-maps" title="Learning D3 Part 7: Choropleth Maps">Learning D3 Part 7: Choropleth Maps</a></li>
</ul>
      <p>&nbsp;</p>
      
<br><br>
      <aside>July 18, 2012</aside><h1 class="post-title">Learning D3 Part 7: Choropleth Maps</h1>
      <div class="alert alert-info">
<strong>Update:</strong> I&#8217;m releasing a series of screencast tutorials on D3 at <strong><a href="https://deveo.tv" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://deveo.tv', 'deveo.tv']);" >deveo.tv</a></strong>. Check it out and let me know what you think!
</div>
<p><a href="http://mbostock.github.com/d3/ex/choropleth.html" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://mbostock.github.com/d3/ex/choropleth.html', '']);" ><img class="alignnone size-full wp-image-408" title="Choropleth" src="http://synthesis.sbecker.net/wp-content/uploads/2012/07/choropleth.png" alt="" width="495" height="268" srcset="http://synthesis.sbecker.net/wp-content/uploads/2012/07/choropleth.png 495w, http://synthesis.sbecker.net/wp-content/uploads/2012/07/choropleth-300x162.png 300w" sizes="(max-width: 495px) 100vw, 495px" /></a></p>
<p>Choropleths are maps that indicate variations in data using different shades of color. Turns out you can easily build these using something like D3. How does that work?</p>

<div style="position:relative;"><table><tr><td class="code"><pre><span style="color: #006600; font-style: italic;">// create a geo path - https://github.com/mbostock/d3/wiki/Geo-Paths</span>
<span style="color: #208066; font-weight: bold;">var</span> path <span style="color: #339933;">=</span> d3.<span style="color: #668066;">geo</span>.<span style="color: #668066;">path</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// create an svg element</span>
<span style="color: #208066; font-weight: bold;">var</span> svg <span style="color: #339933;">=</span> d3.<span style="color: #668066;">select</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;#chart&quot;</span><span style="color: #009900;">&#41;</span>
  .<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;svg&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// create a container for counties</span>
<span style="color: #208066; font-weight: bold;">var</span> counties <span style="color: #339933;">=</span> svg.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;g&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;id&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;counties&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;Blues&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// create a container for states</span>
<span style="color: #208066; font-weight: bold;">var</span> states <span style="color: #339933;">=</span> svg.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;g&quot;</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;id&quot;</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;states&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// load the county shape data</span>
d3.<span style="color: #668066;">json</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;../data/us-counties.json&quot;</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>json<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
  <span style="color: #006600; font-style: italic;">// create paths for each county using the json data</span>
  <span style="color: #006600; font-style: italic;">// and the geo path generator to draw the shapes</span>
  counties.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;path&quot;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>json.<span style="color: #668066;">features</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;path&quot;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> data <span style="color: #339933;">?</span> quantize <span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;d&quot;</span><span style="color: #339933;">,</span> path<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// load the state shape data</span>
d3.<span style="color: #668066;">json</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;../data/us-states.json&quot;</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>json<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
  <span style="color: #006600; font-style: italic;">// create paths for each state using the json data</span>
  <span style="color: #006600; font-style: italic;">// and the geo path generator to draw the shapes</span>
  states.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;path&quot;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">data</span><span style="color: #009900;">&#40;</span>json.<span style="color: #668066;">features</span><span style="color: #009900;">&#41;</span>
    .<span style="color: #668066;">enter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #668066;">append</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;path&quot;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;d&quot;</span><span style="color: #339933;">,</span> path<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// load the unemployment by county data</span>
d3.<span style="color: #668066;">json</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;unemployment.json&quot;</span><span style="color: #339933;">,</span> <span style="color: #208066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>json<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
  data <span style="color: #339933;">=</span> json<span style="color: #339933;">;</span>
&nbsp;
  <span style="color: #006600; font-style: italic;">// for each county, set the css class using the quantize function</span>
  <span style="color: #006600; font-style: italic;">// (an external CSS file contains the css classes for each color in the scheme)</span>
  counties.<span style="color: #668066;">selectAll</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;path&quot;</span><span style="color: #009900;">&#41;</span>
      .<span style="color: #668066;">attr</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;class&quot;</span><span style="color: #339933;">,</span> quantize<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">// quantize function takes a data point and returns a number</span>
<span style="color: #006600; font-style: italic;">// between 0 and 8, to indicate intensity, the prepends a 'q'</span>
<span style="color: #006600; font-style: italic;">// and appends '-9'</span>
<span style="color: #208066; font-weight: bold;">function</span> quantize<span style="color: #009900;">&#40;</span>d<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
  <span style="color: #208066; font-weight: bold;">return</span> <span style="color: #3366CC;">&quot;q&quot;</span> <span style="color: #339933;">+</span> <span style="">Math</span>.<span style="color: #668066;">min</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">8</span><span style="color: #339933;">,</span> ~~<span style="color: #009900;">&#40;</span>data<span style="color: #009900;">&#91;</span>d.<span style="color: #668066;">id</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">*</span> <span style="color: #CC0000;">9</span> <span style="color: #339933;">/</span> <span style="color: #CC0000;">12</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">&quot;-9&quot;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre></td></tr></table><p class="theCode" style="display:none;">// create a geo path - https://github.com/mbostock/d3/wiki/Geo-Paths
var path = d3.geo.path();

// create an svg element
var svg = d3.select(&quot;#chart&quot;)
  .append(&quot;svg&quot;);

// create a container for counties
var counties = svg.append(&quot;g&quot;)
    .attr(&quot;id&quot;, &quot;counties&quot;)
    .attr(&quot;class&quot;, &quot;Blues&quot;);

// create a container for states
var states = svg.append(&quot;g&quot;)
    .attr(&quot;id&quot;, &quot;states&quot;);

// load the county shape data
d3.json(&quot;../data/us-counties.json&quot;, function(json) {
  // create paths for each county using the json data
  // and the geo path generator to draw the shapes
  counties.selectAll(&quot;path&quot;)
      .data(json.features)
    .enter().append(&quot;path&quot;)
      .attr(&quot;class&quot;, data ? quantize : null)
      .attr(&quot;d&quot;, path);
});

// load the state shape data
d3.json(&quot;../data/us-states.json&quot;, function(json) {
  // create paths for each state using the json data
  // and the geo path generator to draw the shapes
  states.selectAll(&quot;path&quot;)
      .data(json.features)
    .enter().append(&quot;path&quot;)
      .attr(&quot;d&quot;, path);
});

// load the unemployment by county data
d3.json(&quot;unemployment.json&quot;, function(json) {
  data = json;

  // for each county, set the css class using the quantize function
  // (an external CSS file contains the css classes for each color in the scheme)
  counties.selectAll(&quot;path&quot;)
      .attr(&quot;class&quot;, quantize);
});

// quantize function takes a data point and returns a number
// between 0 and 8, to indicate intensity, the prepends a 'q'
// and appends '-9'
function quantize(d) {
  return &quot;q&quot; + Math.min(8, ~~(data[d.id] * 9 / 12)) + &quot;-9&quot;;
}</p></div>

<p>And the CSS classes for each shade of blue:</p>

<div style="position:relative;"><table><tr><td class="code"><pre class="css"><span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q0-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">247</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">251</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">255</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span>
<span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q1-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">222</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">235</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">247</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span>
<span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q2-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">198</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">219</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">239</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span>
<span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q3-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">158</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">202</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">225</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span>
<span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q4-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">107</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">174</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">214</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span>
<span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q5-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">66</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">146</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">198</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span>
<span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q6-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">33</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">113</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">181</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span>
<span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q7-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">81</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">156</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span>
<span style="color: #6666ff;">.Blues</span> <span style="color: #6666ff;">.q8-9</span><span style="color: #00AA00;">&#123;</span><span style="color: #000000; font-weight: bold;">fill</span><span style="color: #00AA00;">:</span><span style="color: #9932cc;">rgb</span><span style="color: #00AA00;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">48</span><span style="color: #00AA00;">,</span><span style="color: #cc66cc;">107</span><span style="color: #00AA00;">&#41;</span><span style="color: #00AA00;">&#125;</span></pre></td></tr></table><p class="theCode" style="display:none;">.Blues .q0-9{fill:rgb(247,251,255)}
.Blues .q1-9{fill:rgb(222,235,247)}
.Blues .q2-9{fill:rgb(198,219,239)}
.Blues .q3-9{fill:rgb(158,202,225)}
.Blues .q4-9{fill:rgb(107,174,214)}
.Blues .q5-9{fill:rgb(66,146,198)}
.Blues .q6-9{fill:rgb(33,113,181)}
.Blues .q7-9{fill:rgb(8,81,156)}
.Blues .q8-9{fill:rgb(8,48,107)}</p></div>

<p>Continue with the D3 Series:</p>
<ul>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/08/learning-d3-part-1" title="Learning D3 Part 1: Selections, Properties, Data">Learning D3 Part 1: Selections, Properties, Data</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/09/learning-d3-part-2" title="Learning D3 Part 2: Enter and Exit">Learning D3 Part 2: Enter and Exit</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/10/learning-d3-part-3-animation-interaction" title="Learning D3 Part 3: Animation &#038; Interaction">Learning D3 Part 3: Animation &#038; Interaction</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/11/learning-d3-part-4-intro-to-svg-graphics" title="Learning D3 Part 4: Intro to SVG Graphics">Learning D3 Part 4: Intro to SVG Graphics</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/15/learning-d3-part-5-axes" title="Learning D3 Part 5: Axes">Learning D3 Part 5: Axes</a></li>
<li><a href="http://synthesis.sbecker.net/articles/2012/07/16/learning-d3-part-6-scales-colors" title="Learning D3 Part 6: Scales &#038; Colors">Learning D3 Part 6: Scales &#038; Colors</a></li>
<li>Learning D3 Part 7: Choropleth Maps</li>
</ul>
      <p>&nbsp;</p>
      
<br><br>
